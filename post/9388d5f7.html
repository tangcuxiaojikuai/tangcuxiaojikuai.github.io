<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon_small.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="RnN18ZogmZl_dLVpxZ6y8kjKL73Mu9VLVEkw9d3qrq0" />
  <meta name="msvalidate.01" content="DC3050AD55F30DDF75AAB78517714910" />
  <meta name="baidu-site-verification" content="codeva-PPofu3dNxe" />

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-loading-bar.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"tangcuxiaojikuai.xyz","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="记录一下这周做到的几道赛题。">
<meta property="og:type" content="article">
<meta property="og:title" content="2024-corCTF&amp;DeadsecCTF-wp-crypto">
<meta property="og:url" content="https://tangcuxiaojikuai.xyz/post/9388d5f7.html">
<meta property="og:site_name" content="糖醋小鸡块的blog">
<meta property="og:description" content="记录一下这周做到的几道赛题。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-07-28T03:00:47.000Z">
<meta property="article:modified_time" content="2024-07-29T04:19:18.557Z">
<meta property="article:author" content="糖醋小鸡块">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://tangcuxiaojikuai.xyz/post/9388d5f7.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>2024-corCTF&DeadsecCTF-wp-crypto | 糖醋小鸡块的blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">糖醋小鸡块的blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-友链">

    <a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tangcuxiaojikuai.xyz/post/9388d5f7.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/image.png">
      <meta itemprop="name" content="糖醋小鸡块">
      <meta itemprop="description" content=""追风赶月莫停留，平芜尽处是春山"">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="糖醋小鸡块的blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2024-corCTF&DeadsecCTF-wp-crypto
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-07-28 11:00:47" itemprop="dateCreated datePublished" datetime="2024-07-28T11:00:47+08:00">2024-07-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-07-29 12:19:18" itemprop="dateModified" datetime="2024-07-29T12:19:18+08:00">2024-07-29</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/wp-crypto/" itemprop="url" rel="index"><span itemprop="name">wp-crypto</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/post/9388d5f7.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/post/9388d5f7.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>记录一下这周做到的几道赛题。</p>
<span id="more"></span>
<h2 id="corCTF"><a href="#corCTF" class="headerlink" title="corCTF"></a>corCTF</h2><h3 id="steps"><a href="#steps" class="headerlink" title="steps"></a>steps</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Alice and Bob have taken steps to communicate securely.</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha512</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">Pair = <span class="built_in">tuple</span>[<span class="built_in">int</span>, <span class="built_in">int</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">apply</span>(<span class="params">x: Pair, y: Pair</span>) -&gt; Pair:</span><br><span class="line">    z0 = x[<span class="number">0</span>] * y[<span class="number">1</span>] + x[<span class="number">1</span>] * y[<span class="number">0</span>] - x[<span class="number">0</span>] * y[<span class="number">0</span>]</span><br><span class="line">    z1 = x[<span class="number">0</span>] * y[<span class="number">0</span>] + x[<span class="number">1</span>] * y[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> z0 % p, z1 % p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calculate</span>(<span class="params">n: <span class="built_in">int</span></span>) -&gt; Pair:</span><br><span class="line">    out = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    base = <span class="number">1</span>, <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> n &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> n &amp; <span class="number">1</span> == <span class="number">1</span>: out = apply(out, base)</span><br><span class="line">        n &gt;&gt;= <span class="number">1</span></span><br><span class="line">        base = apply(base, base)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">step</span>(<span class="params">x: Pair, n: <span class="built_in">int</span></span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;Performs n steps to x.&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> apply(x, calculate(n))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">a: <span class="built_in">bytes</span>, b: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(i ^ j <span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">zip</span>(a, b))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>() -&gt; <span class="literal">None</span>:</span><br><span class="line">    g = <span class="built_in">tuple</span>(randint(<span class="number">0</span>, p - <span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>))</span><br><span class="line">    a = randint(<span class="number">0</span>, p)</span><br><span class="line">    b = randint(<span class="number">0</span>, p)</span><br><span class="line"></span><br><span class="line">    A = step(g, a)</span><br><span class="line">    B = step(g, b)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(p)</span><br><span class="line">    <span class="built_in">print</span>(g)</span><br><span class="line">    <span class="built_in">print</span>(A)</span><br><span class="line">    <span class="built_in">print</span>(B)</span><br><span class="line"></span><br><span class="line">    shared = step(A, b)</span><br><span class="line">    <span class="keyword">assert</span> shared == step(B, a)</span><br><span class="line"></span><br><span class="line">    pad = sha512(<span class="built_in">str</span>(shared).encode()).digest()</span><br><span class="line">    <span class="built_in">print</span>(xor(FLAG, pad))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>output.txt：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">140323158913416495607520736187548995477774864895449373468435168606940894555091715325755245563618777520381345121826124291879072024129139794758353829170487152290036863771427918014687523291663877491666410660298255515196964873944928956895167652588843616727666115196647426152811435167407394960435891152283442366721</span></span><br><span class="line">(<span class="number">96065253104055475368515351480749372850658086665031683689391433619786525841252022013348418216780129963411710917302022475212035579772549622047772413277044476931991100469638284113901919733675144788049607999711496364391389612383885735460390196619821411998848060208912802838145365054170790882835846039461477718592</span>, <span class="number">99241616571709523646659145402511086659276737895777010655080069795289409091105858433710404513588065826008320709508748555232998727290258965620812790826701703542423766306117851146140634247906095481346444357123297761881438234083584836393572339820023598801127329326758926529813665950889866710376403818615042210724</span>)</span><br><span class="line">(<span class="number">70755695722452190644681854912493449110123792967984325777144153291795297730471865203878351550134745747839905472832417565386100721034554991782211134122667955909129461935072670637104557733518048519759925441567454988894610693095988261459294358350906447578625319131211019007537053689563772428590632011546870587548</span>, <span class="number">67209626648557152207459211543890871397518255584981755641031188457446084495247511864090204533159666638951190009379067537952490757956859052998865712873197974689323985952177932343928382624951392835548222455898153557185369330197085287972647654361464363270469055087587755117442462138962625643131163131541853061105</span>)</span><br><span class="line">(<span class="number">112356264561144892053527289833892910675229600209578481387952173298070535545532140474473984252645999236867287593260325203405225799985387664655169620807429202440801811880698414710903311724048492305357174522756960623684589130082192061927190750200168319419891243856185874901350055033712921163239281745750477183871</span>, <span class="number">53362886892304808290625786352337191943295467155122569556336867663859530697649464591551819415844644455424276970213068575695727349121464360678240605137740996864232092508175716627306324344248722088013523622985501843963007084915323781694266339448976475002289825133821073110606693351553820493128680615728977879615</span>)</span><br><span class="line"><span class="string">b&#x27;\xbaH\xca[V\xdf\xbb0d2jN&quot;\x9d$e\xec\xe0M\x00\xdb\xf0\x8f\x99f\xc5\n\x8a\xc2h\xa7\xa7&#x27;</span></span><br></pre></td></tr></table></figure>
<p>题目基于一个比较奇怪的DH密钥交换，其中主要的两个函数是apply和calculate，分别作用为(运算皆在模p下)：</p>
<ul>
<li><p>apply：接受两个向量$(x_0,x_1),(y_0,y_1)$作为输入，输出为：</p>
<script type="math/tex; mode=display">
z_0 = x_0y_1 + x_1y_0 - x_0y_0</script><script type="math/tex; mode=display">
z_1 = x_0y_0 + x_1y_1</script></li>
<li><p>calculate：显然是一个矩阵快速幂，对于输入的数字n，得到的结果是：</p>
<script type="math/tex; mode=display">
out = 
\left(\begin{matrix}
0&1\\
1&1\\
\end{matrix}\right)
^n 
\left(\begin{matrix}
0\\
1\\
\end{matrix}\right)</script></li>
</ul>
<p>然后利用这两个函数商议了用于密钥交换的函数step，对于给定的向量g和私钥x，其得到的结果为apply(g,calculate(x))。然后A、B就利用step函数分别生成自己的密钥，并计算共享密钥：</p>
<script type="math/tex; mode=display">
A = apply(g, calculate(a))</script><script type="math/tex; mode=display">
B = apply(g, calculate(b))</script><script type="math/tex; mode=display">
shared = step(A,b) = step(B,a)</script><p>给出g、A、B，要求计算shared来解密flag。</p>
<p>由于有g、A和B，所以由apply函数用resultant或者groebner可以轻松计算出calculate(a)和calculate(b)的值，而其实计算shared也就是在A的基础上继续计算(B也同理)：</p>
<script type="math/tex; mode=display">
shared = apply(A, calculate(b))</script><p>所以就很容易算出shared来了，因为并不需要解出a、b是多少，只需要知道calculate(a)和calculate(b)就行。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha512</span><br><span class="line"></span><br><span class="line">p = <span class="number">140323158913416495607520736187548995477774864895449373468435168606940894555091715325755245563618777520381345121826124291879072024129139794758353829170487152290036863771427918014687523291663877491666410660298255515196964873944928956895167652588843616727666115196647426152811435167407394960435891152283442366721</span></span><br><span class="line">g = (<span class="number">96065253104055475368515351480749372850658086665031683689391433619786525841252022013348418216780129963411710917302022475212035579772549622047772413277044476931991100469638284113901919733675144788049607999711496364391389612383885735460390196619821411998848060208912802838145365054170790882835846039461477718592</span>, <span class="number">99241616571709523646659145402511086659276737895777010655080069795289409091105858433710404513588065826008320709508748555232998727290258965620812790826701703542423766306117851146140634247906095481346444357123297761881438234083584836393572339820023598801127329326758926529813665950889866710376403818615042210724</span>)</span><br><span class="line">A = (<span class="number">70755695722452190644681854912493449110123792967984325777144153291795297730471865203878351550134745747839905472832417565386100721034554991782211134122667955909129461935072670637104557733518048519759925441567454988894610693095988261459294358350906447578625319131211019007537053689563772428590632011546870587548</span>, <span class="number">67209626648557152207459211543890871397518255584981755641031188457446084495247511864090204533159666638951190009379067537952490757956859052998865712873197974689323985952177932343928382624951392835548222455898153557185369330197085287972647654361464363270469055087587755117442462138962625643131163131541853061105</span>)</span><br><span class="line">B = (<span class="number">112356264561144892053527289833892910675229600209578481387952173298070535545532140474473984252645999236867287593260325203405225799985387664655169620807429202440801811880698414710903311724048492305357174522756960623684589130082192061927190750200168319419891243856185874901350055033712921163239281745750477183871</span>, <span class="number">53362886892304808290625786352337191943295467155122569556336867663859530697649464591551819415844644455424276970213068575695727349121464360678240605137740996864232092508175716627306324344248722088013523622985501843963007084915323781694266339448976475002289825133821073110606693351553820493128680615728977879615</span>)</span><br><span class="line">c = <span class="string">b&#x27;\xbaH\xca[V\xdf\xbb0d2jN&quot;\x9d$e\xec\xe0M\x00\xdb\xf0\x8f\x99f\xc5\n\x8a\xc2h\xa7\xa7&#x27;</span></span><br><span class="line"></span><br><span class="line">PR.&lt;a0,a1&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">f1 = g[<span class="number">0</span>] * a1 + g[<span class="number">1</span>] * a0 - g[<span class="number">0</span>] * a0 - A[<span class="number">0</span>]</span><br><span class="line">f2 = g[<span class="number">0</span>] * a0 + g[<span class="number">1</span>] * a1 - A[<span class="number">1</span>]</span><br><span class="line">res = Ideal([f1,f2]).groebner_basis()</span><br><span class="line">a0 = -res[<span class="number">0</span>].coefficients()[<span class="number">1</span>]</span><br><span class="line">a1 = -res[<span class="number">1</span>].coefficients()[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">L = Matrix(Zmod(p),[</span><br><span class="line">    [<span class="number">0</span>,<span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>,<span class="number">1</span>]</span><br><span class="line">])</span><br><span class="line">v0 = vector(Zmod(p),[<span class="number">0</span>,<span class="number">1</span>])</span><br><span class="line">a = vector(Zmod(p),[a0,a1])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Pair = <span class="built_in">tuple</span>[<span class="built_in">int</span>, <span class="built_in">int</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">apply</span>(<span class="params">x: Pair, y: Pair</span>) -&gt; Pair:</span><br><span class="line">    z0 = x[<span class="number">0</span>] * y[<span class="number">1</span>] + x[<span class="number">1</span>] * y[<span class="number">0</span>] - x[<span class="number">0</span>] * y[<span class="number">0</span>]</span><br><span class="line">    z1 = x[<span class="number">0</span>] * y[<span class="number">0</span>] + x[<span class="number">1</span>] * y[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> z0 % p, z1 % p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calculate</span>(<span class="params">n: <span class="built_in">int</span></span>) -&gt; Pair:</span><br><span class="line">    out = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    base = <span class="number">1</span>, <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> n &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> n &amp; <span class="number">1</span> == <span class="number">1</span>: out = apply(out, base)</span><br><span class="line">        n &gt;&gt;= <span class="number">1</span></span><br><span class="line">        base = apply(base, base)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">step</span>(<span class="params">x: Pair, n: <span class="built_in">int</span></span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;Performs n steps to x.&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> apply(x, calculate(n))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">a: <span class="built_in">bytes</span>, b: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(i ^^ j <span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">zip</span>(a, b))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">AB = apply(B, [a0,a1])</span><br><span class="line">pad = sha512(<span class="built_in">str</span>(AB).encode()).digest()</span><br><span class="line"><span class="built_in">print</span>(xor(c, pad))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#corctf&#123;w4it_i7&#x27;s_4ll_f1b0n4cci?&#125;</span></span><br></pre></td></tr></table></figure>
<p>然而真的想求出a、b其实也并不是一定没有办法，由于刚刚说了calculate实际上是个如下形式的快速幂：</p>
<script type="math/tex; mode=display">
out = 
\left(\begin{matrix}
0&1\\
1&1\\
\end{matrix}\right)
^n 
\left(\begin{matrix}
0\\
1\\
\end{matrix}\right)</script><p>所以对于calculate(a)来说就是：</p>
<script type="math/tex; mode=display">
calculate(a) = 
\left(\begin{matrix}
0&1\\
1&1\\
\end{matrix}\right)
^a 
\left(\begin{matrix}
0\\
1\\
\end{matrix}\right)</script><p>所以实际上是求一个矩阵DLP。</p>
<p><br></p>
<p><br></p>
<h3 id="monkfish"><a href="#monkfish" class="headerlink" title="monkfish"></a>monkfish</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Hmm... smells like a fishy proof of knowledge...</span><br><span class="line"></span><br><span class="line">(Part 1 out of 2)</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;I caught a monkfish in the sea! &quot;</span>)</span><br><span class="line">sys.stdout.flush()</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> SystemRandom</span><br><span class="line"><span class="keyword">import</span> ast</span><br><span class="line"></span><br><span class="line">n = <span class="number">100</span></span><br><span class="line">m = <span class="number">100</span></span><br><span class="line">q = <span class="number">5</span></span><br><span class="line">FF.&lt;x&gt; = GF(q)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">apply</span>(<span class="params">F, v</span>):</span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        out.append((v.T * F[i] * v)[<span class="number">0</span>, <span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> matrix(FF, m, <span class="number">1</span>, out)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">apply_verif_info</span>(<span class="params">F, a, b</span>):</span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        out.append((a.T * (F[i] + F[i].T) * b)[<span class="number">0</span>, <span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> matrix(FF, m, <span class="number">1</span>, out)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_pok</span>(<span class="params">v, s, F</span>):</span><br><span class="line">    t = matrix(FF, n, <span class="number">1</span>, [FF.random_element() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line">    com = apply(F, t)</span><br><span class="line">    verif = apply_verif_info(F, t, s)</span><br><span class="line">    a = <span class="built_in">list</span>(FF)[sha256(<span class="built_in">bytes</span>([<span class="built_in">list</span>(FF).index(i[<span class="number">0</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(com) + <span class="built_in">list</span>(v) + <span class="built_in">list</span>(verif)])).digest()[<span class="number">0</span>] % <span class="built_in">len</span>(<span class="built_in">list</span>(FF))]</span><br><span class="line">    <span class="keyword">return</span> (com, t - a * s, verif)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verif_pok</span>(<span class="params">v, F, pi</span>):</span><br><span class="line">    com = pi[<span class="number">0</span>]</span><br><span class="line">    resp = pi[<span class="number">1</span>]</span><br><span class="line">    verif = pi[<span class="number">2</span>]</span><br><span class="line">    a = <span class="built_in">list</span>(FF)[sha256(<span class="built_in">bytes</span>([<span class="built_in">list</span>(FF).index(i[<span class="number">0</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(com) + <span class="built_in">list</span>(v) + <span class="built_in">list</span>(verif)])).digest()[<span class="number">0</span>] % <span class="built_in">len</span>(<span class="built_in">list</span>(FF))]</span><br><span class="line">    out1 = apply(F, resp)</span><br><span class="line">    out2 = com + (a * a) * v - a * verif</span><br><span class="line">    <span class="keyword">return</span> out1 == out2</span><br><span class="line"></span><br><span class="line">rng = SystemRandom()</span><br><span class="line">gen_seed = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">    gen_seed.append(rng.randint(<span class="number">0</span>, <span class="number">255</span>))</span><br><span class="line"></span><br><span class="line">init_seed = gen_seed</span><br><span class="line">gen_seed = <span class="built_in">bytes</span>(gen_seed)</span><br><span class="line"></span><br><span class="line">F = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    cur = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        cur.append([])</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            cur[-<span class="number">1</span>].append(<span class="built_in">list</span>(FF)[sha256(gen_seed).digest()[<span class="number">0</span>] % <span class="built_in">len</span>(<span class="built_in">list</span>(FF))])</span><br><span class="line">            gen_seed = sha256(gen_seed).digest()</span><br><span class="line">    F.append(matrix(FF, n, n, cur))</span><br><span class="line"></span><br><span class="line">s = random_matrix(FF, n, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">v = apply(F, s)</span><br><span class="line"></span><br><span class="line">pok = create_pok(v, s, F)</span><br><span class="line"><span class="keyword">assert</span> verif_pok(v, F, pok)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;m0 =&quot;</span>, [<span class="built_in">list</span>(FF).index(i[<span class="number">0</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(pok[<span class="number">0</span>])])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;m1 =&quot;</span>, [<span class="built_in">list</span>(FF).index(i[<span class="number">0</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(pok[<span class="number">1</span>])])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;m2 =&quot;</span>, [<span class="built_in">list</span>(FF).index(i[<span class="number">0</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(pok[<span class="number">2</span>])])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Can you catch a monkfish? &quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;seed =&quot;</span>, [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> init_seed])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;v =&quot;</span>, [<span class="built_in">list</span>(FF).index(i[<span class="number">0</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> v])</span><br><span class="line">m0 = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> ast.literal_eval(<span class="built_in">input</span>(<span class="string">&quot;m0 = &quot;</span>))]</span><br><span class="line">m1 = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> ast.literal_eval(<span class="built_in">input</span>(<span class="string">&quot;m1 = &quot;</span>))]</span><br><span class="line">m2 = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> ast.literal_eval(<span class="built_in">input</span>(<span class="string">&quot;m2 = &quot;</span>))]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(m0 != [<span class="built_in">list</span>(FF).index(i[<span class="number">0</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(pok[<span class="number">0</span>])])</span><br><span class="line"><span class="keyword">assert</span>(m1 != [<span class="built_in">list</span>(FF).index(i[<span class="number">0</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(pok[<span class="number">1</span>])])</span><br><span class="line"><span class="keyword">assert</span>(m2 != [<span class="built_in">list</span>(FF).index(i[<span class="number">0</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(pok[<span class="number">2</span>])])</span><br><span class="line"></span><br><span class="line">m0 = matrix(FF, m, <span class="number">1</span>, [<span class="built_in">list</span>(FF)[i] <span class="keyword">for</span> i <span class="keyword">in</span> m0])</span><br><span class="line">m1 = matrix(FF, n, <span class="number">1</span>, [<span class="built_in">list</span>(FF)[i] <span class="keyword">for</span> i <span class="keyword">in</span> m1])</span><br><span class="line">m2 = matrix(FF, m, <span class="number">1</span>, [<span class="built_in">list</span>(FF)[i] <span class="keyword">for</span> i <span class="keyword">in</span> m2])</span><br><span class="line">pi = (m0, m1, m2)</span><br><span class="line"></span><br><span class="line">res = verif_pok(v, F, pi)</span><br><span class="line"><span class="keyword">assert</span> res == <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="built_in">print</span>(f.read())</span><br></pre></td></tr></table></figure>
<p>题目基于一个矩阵zkp(运算皆在模5下)，在连接上靶机后，靶机会按顺序完成以下几个步骤：</p>
<ul>
<li><p>随机生成64个0-255的整数当作seed</p>
</li>
<li><p>利用seed生成m个nxn的矩阵，并组成列表F</p>
</li>
<li><p>随机生成一个长为n的向量s</p>
</li>
<li><p>对F中每个矩阵Fi，进行如下计算：</p>
<script type="math/tex; mode=display">
out_i = s^TF_is</script><p>并将结果拼接在一起，得到长度为m的向量v</p>
</li>
</ul>
<p>做完上面这些后就进入createpok过程，其输入为 $(v,s,F)$，具体操作是：</p>
<ul>
<li><p>随机生成长度为n的向量t</p>
</li>
<li><p>对F中每个矩阵Fi，进行如下计算：</p>
<script type="math/tex; mode=display">
out_i = t^TF_it</script><p>并将结果拼接在一起，得到长度为m的向量com(这个操作和上面得到v的操作一样，也就是apply函数)</p>
</li>
<li><p>对F中每个矩阵Fi，进行如下计算：</p>
<script type="math/tex; mode=display">
out_i = t^T(F_i + F_i^T)s</script><p>并将结果拼接在一起，得到长度为m的向量verif</p>
</li>
<li><p>将com、v、verif一起做哈希并模5得到数字a</p>
</li>
<li><p>返回三元组 $pok = (com, t - as, verif)$</p>
</li>
</ul>
<p>之后是verify的过程，其输入为 $(v,F,pok)$，具体操作是：</p>
<ul>
<li><p>先解包pok得到com，resp和verify</p>
</li>
<li><p>由com，v和verify计算哈希得到a</p>
</li>
<li><p>out1是apply(F,resp)得到的值</p>
</li>
<li><p>out2为：</p>
<script type="math/tex; mode=display">
com + a^2v - a\cdot verif</script></li>
<li><p>out1与out2完全相等则能够通过verify</p>
</li>
</ul>
<p>我们的任务是，给定seed、v和一个pok，要求产生另一个pok，其中每个向量均与给出的pok不相等，并且通过verify。</p>
<p>这很简单，由于只需要通过一次就有flag，而a只有0-4这几个值，所以随机到a=0的时候就压根不需要在意verify是什么了。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Pwn4Sage.pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> SystemRandom</span><br><span class="line"><span class="keyword">import</span> ast</span><br><span class="line"></span><br><span class="line">n = <span class="number">100</span></span><br><span class="line">m = <span class="number">100</span></span><br><span class="line">q = <span class="number">5</span></span><br><span class="line">FF.&lt;x&gt; = GF(q)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">apply</span>(<span class="params">F, v</span>):</span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        out.append((v.T * F[i] * v)[<span class="number">0</span>, <span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> matrix(FF, m, <span class="number">1</span>, out)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">apply_verif_info</span>(<span class="params">F, a, b</span>):</span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        out.append((a.T * (F[i] + F[i].T) * b)[<span class="number">0</span>, <span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> matrix(FF, m, <span class="number">1</span>, out)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_pok</span>(<span class="params">v, s, F</span>):</span><br><span class="line">    t = matrix(FF, n, <span class="number">1</span>, [FF.random_element() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line">    com = apply(F, t)</span><br><span class="line">    verif = apply_verif_info(F, t, s)</span><br><span class="line">    a = <span class="built_in">list</span>(FF)[sha256(<span class="built_in">bytes</span>([<span class="built_in">list</span>(FF).index(i[<span class="number">0</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(com) + <span class="built_in">list</span>(v) + <span class="built_in">list</span>(verif)])).digest()[<span class="number">0</span>] % <span class="built_in">len</span>(<span class="built_in">list</span>(FF))]</span><br><span class="line">    <span class="keyword">return</span> (com, t - a * s, verif)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verif_pok</span>(<span class="params">v, F, pi</span>):</span><br><span class="line">    com = pi[<span class="number">0</span>]</span><br><span class="line">    resp = pi[<span class="number">1</span>]</span><br><span class="line">    verif = pi[<span class="number">2</span>]</span><br><span class="line">    <span class="comment">#a = list(FF)[sha256(bytes([list(FF).index(i[0]) for i in list(com) + list(v) + list(verif)])).digest()[0] % len(list(FF))]</span></span><br><span class="line">    a = <span class="number">0</span></span><br><span class="line">    out1 = apply(F, resp)</span><br><span class="line">    out2 = com + (a * a) * v - a * verif</span><br><span class="line">    <span class="keyword">return</span> out1 == out2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">###################################################################### part1 get data</span></span><br><span class="line">sh = remote(<span class="string">&quot;be.ax&quot;</span>, <span class="number">31105</span>)</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;m0 =&quot;</span>)</span><br><span class="line">m0 = ast.literal_eval(sh.recvline().strip().decode())</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;m1 =&quot;</span>)</span><br><span class="line">m1 = ast.literal_eval(sh.recvline().strip().decode())</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;m2 =&quot;</span>)</span><br><span class="line">m2 = ast.literal_eval(sh.recvline().strip().decode())</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;seed =&quot;</span>)</span><br><span class="line">init_seed = ast.literal_eval(sh.recvline().strip().decode())</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;v =&quot;</span>)</span><br><span class="line">v = ast.literal_eval(sh.recvline().strip().decode())</span><br><span class="line">v = Matrix(FF,v).T</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">###################################################################### part2 gen</span></span><br><span class="line">gen_seed = <span class="built_in">bytes</span>(init_seed)</span><br><span class="line">F = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    cur = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        cur.append([])</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            cur[-<span class="number">1</span>].append(<span class="built_in">list</span>(FF)[sha256(gen_seed).digest()[<span class="number">0</span>] % <span class="built_in">len</span>(<span class="built_in">list</span>(FF))])</span><br><span class="line">            gen_seed = sha256(gen_seed).digest()</span><br><span class="line">    F.append(matrix(FF, n, n, cur))</span><br><span class="line">t = matrix(FF, n, <span class="number">1</span>, [FF.random_element() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line">com = apply(F, t)</span><br><span class="line">ver = random_matrix(FF, m, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">###################################################################### part3 get flag</span></span><br><span class="line">sh.recvuntil(<span class="string">b&quot;m0 =&quot;</span>)</span><br><span class="line">sh.sendline(<span class="built_in">str</span>([i <span class="keyword">for</span> i <span class="keyword">in</span> com]).encode())</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;m1 =&quot;</span>)</span><br><span class="line">sh.sendline(<span class="built_in">str</span>([i <span class="keyword">for</span> i <span class="keyword">in</span> t]).encode())</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;m2 =&quot;</span>)</span><br><span class="line">sh.sendline(<span class="built_in">str</span>([i <span class="keyword">for</span> i <span class="keyword">in</span> ver]).encode())</span><br><span class="line"><span class="built_in">print</span>(sh.recvline())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#corctf&#123;dont_forget_the_soundness_error&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="anglerfish"><a href="#anglerfish" class="headerlink" title="anglerfish"></a>anglerfish</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">The devil of the sea strikes back!</span><br><span class="line"></span><br><span class="line">(Part 2 out of 2)</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;I caught an anglerfish in the sea! &quot;</span>)</span><br><span class="line">sys.stdout.flush()</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> SystemRandom</span><br><span class="line"><span class="keyword">import</span> ast</span><br><span class="line"></span><br><span class="line">n = <span class="number">100</span></span><br><span class="line">m = <span class="number">100</span></span><br><span class="line">q = <span class="number">5</span></span><br><span class="line">FF.&lt;x&gt; = GF(q)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">apply</span>(<span class="params">F, v</span>):</span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        out.append((v.T * F[i] * v)[<span class="number">0</span>, <span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> matrix(FF, m, <span class="number">1</span>, out)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">apply_verif_info</span>(<span class="params">F, a, b</span>):</span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        out.append((a.T * (F[i] + F[i].T) * b)[<span class="number">0</span>, <span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> matrix(FF, m, <span class="number">1</span>, out)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_pok</span>(<span class="params">v, s, F</span>):</span><br><span class="line">    proofs = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        t = matrix(FF, n, <span class="number">1</span>, [FF.random_element() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line">        com = apply(F, t)</span><br><span class="line">        verif = apply_verif_info(F, t, s)</span><br><span class="line">        a = <span class="built_in">list</span>(FF)[sha256(<span class="built_in">bytes</span>([<span class="built_in">list</span>(FF).index(i[<span class="number">0</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(com) + <span class="built_in">list</span>(v) + <span class="built_in">list</span>(verif)])).digest()[<span class="number">0</span>] % <span class="built_in">len</span>(<span class="built_in">list</span>(FF))]</span><br><span class="line">        proofs.append((com, t - a * s, verif))</span><br><span class="line">    <span class="keyword">return</span> proofs</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verif_pok</span>(<span class="params">v, F, pis</span>):</span><br><span class="line">    coms = []</span><br><span class="line">    <span class="keyword">for</span> pi <span class="keyword">in</span> pis:</span><br><span class="line">        com = pi[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">assert</span> com <span class="keyword">not</span> <span class="keyword">in</span> coms</span><br><span class="line">        coms.append(com)</span><br><span class="line">        resp = pi[<span class="number">1</span>]</span><br><span class="line">        verif = pi[<span class="number">2</span>]</span><br><span class="line">        a = <span class="built_in">list</span>(FF)[sha256(<span class="built_in">bytes</span>([<span class="built_in">list</span>(FF).index(i[<span class="number">0</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(com) + <span class="built_in">list</span>(v) + <span class="built_in">list</span>(verif)])).digest()[<span class="number">0</span>] % <span class="built_in">len</span>(<span class="built_in">list</span>(FF))]</span><br><span class="line">        out1 = apply(F, resp)</span><br><span class="line">        out2 = com + (a * a) * v - a * verif</span><br><span class="line">        <span class="keyword">assert</span> out1 == out2</span><br><span class="line"></span><br><span class="line">rng = SystemRandom()</span><br><span class="line">gen_seed = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">    gen_seed.append(rng.randint(<span class="number">0</span>, <span class="number">255</span>))</span><br><span class="line"></span><br><span class="line">init_seed = gen_seed</span><br><span class="line">gen_seed = <span class="built_in">bytes</span>(gen_seed)</span><br><span class="line"></span><br><span class="line">F = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    cur = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        cur.append([])</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            cur[-<span class="number">1</span>].append(<span class="built_in">list</span>(FF)[sha256(gen_seed).digest()[<span class="number">0</span>] % <span class="built_in">len</span>(<span class="built_in">list</span>(FF))])</span><br><span class="line">            gen_seed = sha256(gen_seed).digest()</span><br><span class="line">    F.append(matrix(FF, n, n, cur))</span><br><span class="line"></span><br><span class="line">s = random_matrix(FF, n, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">v = apply(F, s)</span><br><span class="line"></span><br><span class="line">pok = create_pok(v, s, F)</span><br><span class="line">verif_pok(v, F, pok)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> pi <span class="keyword">in</span> pok:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;m0 =&quot;</span>, [<span class="built_in">list</span>(FF).index(i[<span class="number">0</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(pi[<span class="number">0</span>])])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;m1 =&quot;</span>, [<span class="built_in">list</span>(FF).index(i[<span class="number">0</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(pi[<span class="number">1</span>])])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;m2 =&quot;</span>, [<span class="built_in">list</span>(FF).index(i[<span class="number">0</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(pi[<span class="number">2</span>])])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Can you catch an anglerfish? &quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;seed =&quot;</span>, [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> init_seed])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;v =&quot;</span>, [<span class="built_in">list</span>(FF).index(i[<span class="number">0</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> v])</span><br><span class="line"></span><br><span class="line">pis = []</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">    m0 = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> ast.literal_eval(<span class="built_in">input</span>(<span class="string">&quot;m0 = &quot;</span>))]</span><br><span class="line">    m1 = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> ast.literal_eval(<span class="built_in">input</span>(<span class="string">&quot;m1 = &quot;</span>))]</span><br><span class="line">    m2 = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> ast.literal_eval(<span class="built_in">input</span>(<span class="string">&quot;m2 = &quot;</span>))]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> pi <span class="keyword">in</span> pok:</span><br><span class="line">        <span class="keyword">assert</span>(m0 != [<span class="built_in">list</span>(FF).index(i[<span class="number">0</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(pi[<span class="number">0</span>])])</span><br><span class="line">        <span class="keyword">assert</span>(m1 != [<span class="built_in">list</span>(FF).index(i[<span class="number">0</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(pi[<span class="number">1</span>])])</span><br><span class="line">        <span class="keyword">assert</span>(m2 != [<span class="built_in">list</span>(FF).index(i[<span class="number">0</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(pi[<span class="number">2</span>])])</span><br><span class="line"></span><br><span class="line">    m0 = matrix(FF, m, <span class="number">1</span>, [<span class="built_in">list</span>(FF)[i] <span class="keyword">for</span> i <span class="keyword">in</span> m0])</span><br><span class="line">    m1 = matrix(FF, n, <span class="number">1</span>, [<span class="built_in">list</span>(FF)[i] <span class="keyword">for</span> i <span class="keyword">in</span> m1])</span><br><span class="line">    m2 = matrix(FF, m, <span class="number">1</span>, [<span class="built_in">list</span>(FF)[i] <span class="keyword">for</span> i <span class="keyword">in</span> m2])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span> m0 <span class="keyword">not</span> <span class="keyword">in</span> [pi[<span class="number">0</span>] <span class="keyword">for</span> pi <span class="keyword">in</span> pok]</span><br><span class="line">    <span class="keyword">assert</span> m1 <span class="keyword">not</span> <span class="keyword">in</span> [pi[<span class="number">1</span>] <span class="keyword">for</span> pi <span class="keyword">in</span> pok]</span><br><span class="line">    <span class="keyword">assert</span> m2 <span class="keyword">not</span> <span class="keyword">in</span> [pi[<span class="number">2</span>] <span class="keyword">for</span> pi <span class="keyword">in</span> pok]</span><br><span class="line"></span><br><span class="line">    pi = (m0, m1, m2)</span><br><span class="line">    pis.append(pi)</span><br><span class="line"></span><br><span class="line">verif_pok(v, F, pis)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="built_in">print</span>(f.read())</span><br></pre></td></tr></table></figure>
<p>和上一题比起来，这题需要通过64次才行，所以纯碰0显然是不行了。</p>
<p>但是目的仍然只有一个，并不需要特别理解这个zkp里verify的细节，我们只需要让verify中out1=out2，仅此而已。</p>
<p>而verify的可操作性相当大，除了给定的v和F，整个pok都是我们可以自行输入的，只要不与给定的那个pok相等就行。那么不妨按如下步骤操作：</p>
<ul>
<li>随机输入一个resp，得到out1</li>
<li>随机输入一个com，之后在0-4爆破a1，并由out1=out2这个式子计算出verify</li>
<li>计算出对应的verify之后，计算哈希值a2</li>
<li>如果a1=a2，就找到了符合要求的碰撞了</li>
</ul>
<p>如果0-4都不符合条件，就重新随机取就行。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Pwn4Sage.pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> ast</span><br><span class="line"></span><br><span class="line">n = <span class="number">100</span></span><br><span class="line">m = <span class="number">100</span></span><br><span class="line">q = <span class="number">5</span></span><br><span class="line">FF.&lt;x&gt; = GF(q)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">apply</span>(<span class="params">F, v</span>):</span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        out.append((v.T * F[i] * v)[<span class="number">0</span>, <span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> matrix(FF, m, <span class="number">1</span>, out)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">###################################################################### part1 get data</span></span><br><span class="line">sh = remote(<span class="string">&quot;be.ax&quot;</span>, <span class="number">31106</span>)</span><br><span class="line"></span><br><span class="line">poks = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">64</span>):</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;m0 =&quot;</span>)</span><br><span class="line">    m0 = ast.literal_eval(sh.recvline().strip().decode())</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;m1 =&quot;</span>)</span><br><span class="line">    m1 = ast.literal_eval(sh.recvline().strip().decode())</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;m2 =&quot;</span>)</span><br><span class="line">    m2 = ast.literal_eval(sh.recvline().strip().decode())</span><br><span class="line">    poks.append([m0,m1,m2])</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">b&quot;seed =&quot;</span>)</span><br><span class="line">init_seed = ast.literal_eval(sh.recvline().strip().decode())</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;v =&quot;</span>)</span><br><span class="line">v = ast.literal_eval(sh.recvline().strip().decode())</span><br><span class="line">v = Matrix(FF,v).T</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">###################################################################### part2 gen F</span></span><br><span class="line">gen_seed = <span class="built_in">bytes</span>(init_seed)</span><br><span class="line">F = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    cur = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        cur.append([])</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            cur[-<span class="number">1</span>].append(<span class="built_in">list</span>(FF)[sha256(gen_seed).digest()[<span class="number">0</span>] % <span class="built_in">len</span>(<span class="built_in">list</span>(FF))])</span><br><span class="line">            gen_seed = sha256(gen_seed).digest()</span><br><span class="line">    F.append(matrix(FF, n, n, cur))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">###################################################################### part3 get flag</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">64</span>):</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">        FIND = <span class="number">0</span></span><br><span class="line">        t = matrix(FF, n, <span class="number">1</span>, [FF.random_element() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line">        out1 = apply(F, t)</span><br><span class="line">        com = out1</span><br><span class="line">        <span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">            <span class="keyword">if</span>(a == <span class="number">0</span>):</span><br><span class="line">                ver = random_matrix(FF, m, <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                ver = (com + (a * a) * v - out1) * inverse(a,<span class="number">5</span>)</span><br><span class="line">            aa = <span class="built_in">list</span>(FF)[sha256(<span class="built_in">bytes</span>([<span class="built_in">list</span>(FF).index(i[<span class="number">0</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(com) + <span class="built_in">list</span>(v) + <span class="built_in">list</span>(ver)])).digest()[<span class="number">0</span>] % <span class="built_in">len</span>(<span class="built_in">list</span>(FF))]</span><br><span class="line">            <span class="keyword">if</span>(aa == a):</span><br><span class="line">                FIND = <span class="number">1</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span>(FIND == <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;m0 =&quot;</span>)</span><br><span class="line">    sh.sendline(<span class="built_in">str</span>([i <span class="keyword">for</span> i <span class="keyword">in</span> com]).encode())</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;m1 =&quot;</span>)</span><br><span class="line">    sh.sendline(<span class="built_in">str</span>([i <span class="keyword">for</span> i <span class="keyword">in</span> t]).encode())</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;m2 =&quot;</span>)</span><br><span class="line">    sh.sendline(<span class="built_in">str</span>([i <span class="keyword">for</span> i <span class="keyword">in</span> ver]).encode())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(sh.recvline())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#corctf&#123;extra_equations_means_extra_information_isnt_zk&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="roots"><a href="#roots" class="headerlink" title="roots"></a>roots</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Check out this cool cryptosystem! Can you break it without the key?</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"><span class="keyword">from</span> decimal <span class="keyword">import</span> Decimal, getcontext</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"></span><br><span class="line">N = <span class="number">3</span></span><br><span class="line">MSIZE = <span class="number">64</span></span><br><span class="line">PSIZE = <span class="number">128</span></span><br><span class="line"></span><br><span class="line">getcontext().prec = <span class="number">2024</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chunk</span>(<span class="params">inp: <span class="built_in">bytes</span>, n: <span class="built_in">int</span></span>) -&gt; <span class="built_in">list</span>[<span class="built_in">bytes</span>]:</span><br><span class="line">    <span class="keyword">return</span> [inp[i:i + n] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(inp), n)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate</span>() -&gt; <span class="built_in">list</span>[<span class="built_in">int</span>]:</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sorted</span>(getPrime(PSIZE) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(N))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">otp</span>(<span class="params">data: <span class="built_in">int</span></span>) -&gt; <span class="built_in">list</span>[<span class="built_in">int</span>]:</span><br><span class="line">    key = [getrandbits(MSIZE) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(N - <span class="number">1</span>)]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Apply multiple times for extra security! ;)</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> key:</span><br><span class="line">        data ^= k</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> key + [data]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">data: <span class="built_in">int</span>, key: <span class="built_in">list</span>[<span class="built_in">int</span>]</span>) -&gt; Decimal:</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span>(a * Decimal(p).sqrt() <span class="keyword">for</span> a, p <span class="keyword">in</span> <span class="built_in">zip</span>(otp(data), key))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">plaintext: <span class="built_in">bytes</span>, key: <span class="built_in">list</span>[<span class="built_in">int</span>]</span>) -&gt; Decimal:</span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> pt <span class="keyword">in</span> chunk(plaintext, MSIZE // <span class="number">8</span>):</span><br><span class="line">        out.append(enc(bytes_to_long(pt), key))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>() -&gt; <span class="literal">None</span>:</span><br><span class="line">    key = generate()</span><br><span class="line">    ct = encrypt(FLAG, key)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(ct)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>output.txt：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[Decimal(<span class="string">&#x27;613865483278018068252699664344014709603.51690674693116605142775061636120046870769083140402021865687508441855022441399605307934286489840179576316516207824661811160477759304066064291205730622145206447227404607082151753919361349868545307462428210932437992623119255718054243534096986413211959304171135887211540587436459888779324151143025499619973135708235491605216411394962317959813656209629567607308778163987166821943423002154894970121188451784354115735408809579052563235078363998602200794840158081619720701643652284259066561050115602486569569690456649269369511972329349611423116985630502303784458447333880791258687570760036481989066910025496948546865951981177430643941260666483918647746947170525925083317666875914436471646901318749705595856856883346891726769074746650987330068104292614480104709810601198864073890537548001433033723615776224146304045036932985711688197452123005099236554526727107165691391180111605054039864164377438525310672107170437281478322426514683178129245151967154583110424925964982504343607726182942419964058684010006450471850408468724523024702559055514056791838218373955386876710426728739081458827252802226359687030921900842002785720726229892098824084346436742345912593840934579190526250607721076769764172513184565791506300616867803697312829413891917781663107526096475492046133891964020871514785931302212911910422061349227840920633130097807344731335384126657969326959305179863489255473137828869343169464391631468853227921632272791516165605848151467308601405844760824881338357444888188035204000407673339331919346899410420054651077086850532999310419256243385542853597931278472451318309939063364567112084455650629429599265528219435289213175349567467961574398181095962343974433190931067322110878499680729907288265465620467270493396020598011075090015918395921964211257921275263305336676548841001128867189130080538627211844161021733430009452985356108168888790283056201446152044771750329866340679923824523137794621308627512829896733426062792367679307468573465298446962647695970868442917945963296248995830871462803&#x27;</span>), Decimal(<span class="string">&#x27;245036407881857959287329830175942706463.41676802782442994887934627742200369945701412601647195354905097451178257098540606801565385675107318120460650888047274089786443222032370562593772359240722830861471549006005870906901656856743873456596259047367300567575908527230366385292440919562964298317812232800102576149495809413427952810634193186781922614214268017709482845572771078220390794231892763512491653218636267112852524278614145782738125962122310806946368712582799445479001874840170209715004731276988049273955290890839588161009103614134479683822558461311134193156291806539774288015592213012944114677791107334704048050248067790961044976635609645113466054839476916586971455181287563116833537875679872852426596500045916084590678852453213603747411621009244578584574321606967288315507350789499360210767971560504476491167021056575773203913674206412928683729647182751865762672106362511792516860263344700590671316013798899626125150168033775577935989491544189330151349377248071416776567110915867894841003988715963213282301539772548019203054604324657682585086974883293993693364621477765424253486620846417121914627069652179323747638053294808478946841684842391124370675090921956558456987438962361101647423473932215595029566302891192438202103166531605890363352381011015329475002801933772777494625189852526005526409489415563470356698119177369784245367090617016832725703245455210343971981483284742666226075984764682029024194412093587469973865623264825887838718407665448451327538641035583414835042280186524871430174844859199371418365330179156143049238655596474961217964906635309020982967098088279871772621354935094165104148277851308675528401723829872589324051699054275878133606165491429811386740566384976019587172015296076695877847670182335353621529186538640618471230538158759335554894682026973199860563823746052413212330496106907455577991532192244914548792485371507973770044500533179391911148716837049004674981572325374669719464763272448641196278444851808838959425053174592256179039838611577554410785172685506776747109456418706054407235309341&#x27;</span>), Decimal(<span class="string">&#x27;137345167246666152708695783992412451677.21558050568623481295196376367975242130555102201515580316330966697148890411534221923225952905285897183010922406175094262069208074739275097805536185634560982617648832780575658021059502299936366800046975825224832714908010519763833830348421655509168881358855533351044140363192436142763626456404652383592376546952793513967937938636543810723145564947948780573116974908526774605955951469943187865644596524139107481653386681950240101520692953876806620084423038367388560905871875836530739404184303742718262418117805718036122357051928716596276399762849629107495322882675719409051073299089695124393278836941013272789785477953131515760862594743832917404252472431732912434480355250761546326425334589230931109133966112698705631064298540629644087174339495451233415165784208154862632994746999100506080852291240231466075807689137982406781289386109243195384399444517321654449447540787541127685794368775611662723601685545144635953407926414192981817325925467123186823453700610674338813375219959042008201960857405988222431762449068615565770592161380029925528004633925411749903272512805896758350376028759094075163759541252996218647962921737695225607000672827355712319484834139082006323871120783473891599300315829557138141744616522321981481762618665822002496867084381222827633659627360022043393386819320488647893458122132426243653269827396864109912568570075611460793016682214280860824555257535036669613199445516497725227349649115460430628789851678786053832488469704975290639037623666238775508475503615248256142687325810589424170821237702234472583990907852983428072024771329547328770035145579513303770469872758505372515800860236159229593770017270383301142993264982903473737872532789578999358701823743117676045641159467315897055924399632998579024195194906804156820621748747515175782908138772828776041903750590418332731770693214602115172315637279313855936478443754676804416808777432960976763034716998360016818363826448918529745873789717604991019505220078545941396511331142324037841720139678985890298577830351331&#x27;</span>), Decimal(<span class="string">&#x27;248598813941244564314190366976956238846.21287154177193010973910605580779261210365984174749796180419923931211513873961571752231238459134695223104083276961569452018392982079324317136535206452261881826873414602629594471707660157457896214988591398626491707261264840694400878016171848489165321633160306766022332706508213328119352706170273262931280561423851178335709726505935522918272264480451898981178517451201483151591554008657960692345350455891365321593940275460890295306738282405071381298895783171740603832308867778448785711118127825021180253182388515151158156028351993831870085534975634188825697876813579914222802552156594566015228528827397850794636185597567790199750813063356917626291927109597628605896564415404785475255907843090500284371578116809505806089285850503289523274957689703557226650819188753255887580294403919233020671057076485044952433816771965385673494711771474126428651980119604119559562596188714862777544919355156232243652718517709528203262205358442941280815388198987743628689516005444663613668047007886122931571139930784688640045996582570962554713967405406762001906063378302125401898155550603489814135391137430186059041384496922239998747587303366147421038091369722510204804734395780572006815615350115111367222110517089689188974108653902029376056551397900019653419884380778042660817204485470749571339982927039079734483080043934563757326484950182811230031559346385457298240850154178951900739178353564235216322232791700369486112525607172179782914690610012323349746725297341069764127541218762893367556754429312136345943483494236203659704464226488931565438262759788872114208783818792121079840366002113316654063450919686404664767226446116187197107156555434824485171863955895656710114494285915504850382199832564322800850387423097212704670656698969249945269974571051395109564672354772654744585684053379753599154369914818372119637829894516195738013893515476266773802929361065238109305019468285763072333229080155510459572404321239788374283507107268753407976278020430629150787678790300001623259645896920037795093793915002&#x27;</span>)]</span><br></pre></td></tr></table></figure>
<p>题目先生成3个128bit的素数p1、p2、p3，并按顺序排列好当作key。然后将flag按8字节拆成一个分组，记为mi，并计算：</p>
<script type="math/tex; mode=display">
c_i = 
(k_{i1},k_{i2},k_{i1} \oplus k_{i2} \oplus m_i)
\left(\begin{matrix}
\sqrt{p_1}\\
\sqrt{p_2}\\
\sqrt{p_3}\\
\end{matrix}\right)</script><p>明文共有四组，也就是有四个密文值，其中ki1、ki2是每次计算随机产生的64位nonce，并且计算精度为<code>getcontext().prec = 2024</code>，要求还原flag</p>
<p>首先，如果把四组明文拼接在一起，就成了一个矩阵乘法：</p>
<script type="math/tex; mode=display">
\left(\begin{matrix}
k_{11} & k_{12} & k_{11} \oplus k_{12} \oplus m_1\\
k_{21} & k_{22} & k_{21} \oplus k_{22} \oplus m_2\\
k_{31} & k_{32} & k_{31} \oplus k_{32} \oplus m_3\\
k_{41} & k_{42} & k_{41} \oplus k_{42} \oplus m_4\\
\end{matrix}\right)
\left(\begin{matrix}
\sqrt{p_1}\\
\sqrt{p_2}\\
\sqrt{p_3}\\
\end{matrix}\right)
=
\left(\begin{matrix}
c_1\\
c_2\\
c_3\\
c_4\\
\end{matrix}\right)</script><p>而如果同乘一个大系数T，就可以把含小数的计算转到整数下，也就是：</p>
<script type="math/tex; mode=display">
\left(\begin{matrix}
k_{11} & k_{12} & k_{11} \oplus k_{12} \oplus m_1\\
k_{21} & k_{22} & k_{21} \oplus k_{22} \oplus m_2\\
k_{31} & k_{32} & k_{31} \oplus k_{32} \oplus m_3\\
k_{41} & k_{42} & k_{41} \oplus k_{42} \oplus m_4\\
\end{matrix}\right)
\left(\begin{matrix}
T\sqrt{p_1}\\
T\sqrt{p_2}\\
T\sqrt{p_3}\\
\end{matrix}\right)
=
\left(\begin{matrix}
Tc_1\\
Tc_2\\
Tc_3\\
Tc_4\\
\end{matrix}\right)</script><p>而由于精度固定，所以进行运算时也会产生一定误差，因此整个式子实际上是：</p>
<script type="math/tex; mode=display">
\left(\begin{matrix}
k_{11} & k_{12} & k_{11} \oplus k_{12} \oplus m_1\\
k_{21} & k_{22} & k_{21} \oplus k_{22} \oplus m_2\\
k_{31} & k_{32} & k_{31} \oplus k_{32} \oplus m_3\\
k_{41} & k_{42} & k_{41} \oplus k_{42} \oplus m_4\\
\end{matrix}\right)
\left(\begin{matrix}
T\sqrt{p_1}\\
T\sqrt{p_2}\\
T\sqrt{p_3}\\
\end{matrix}\right)
+
\left(\begin{matrix}
\delta_1\\
\delta_2\\
\delta_3\\
\delta_4\\
\end{matrix}\right)
=
\left(\begin{matrix}
Tc_1\\
Tc_2\\
Tc_3\\
Tc_4\\
\end{matrix}\right)</script><p>所以其实整个式子就抽象成了：</p>
<script type="math/tex; mode=display">
Ax + e = b</script><p>看上去像个LWE问题，但是问题在于我们只知道c而已。然而这个式子显然有个额外信息，就是除了e以外，A也是很小的，所有值都是64bit的数量级。因此可以用正交格的思路来考虑：</p>
<ul>
<li><p>找到短向量u，使得u与b近似正交，也就是ub的结果小</p>
</li>
<li><p>由于u是短向量，因此ue结果也小</p>
</li>
<li><p>又因为x是大向量，所以要使得下面式子继续成立的话：</p>
<script type="math/tex; mode=display">
uAx + ue = ub</script><p>有理由相信此时下面的式子成立：</p>
<script type="math/tex; mode=display">
uAx = 0</script></li>
<li><p>而由于A也比较小，所以在u的右核中规约就有机会找到A了</p>
</li>
</ul>
<p>而这样操作下了，实际上找到的并不是A，而是A中向量的线性组合，但是简单爆破一下线性组合就可以找到原始的A，之后做异或就能得到flag。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> decimal <span class="keyword">import</span> Decimal, getcontext</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">N = <span class="number">3</span></span><br><span class="line">MSIZE = <span class="number">64</span></span><br><span class="line">PSIZE = <span class="number">128</span></span><br><span class="line"></span><br><span class="line">getcontext().prec = <span class="built_in">int</span>(<span class="number">2024</span>)</span><br><span class="line"></span><br><span class="line">c = [Decimal(<span class="string">&#x27;613865483278018068252699664344014709603.51690674693116605142775061636120046870769083140402021865687508441855022441399605307934286489840179576316516207824661811160477759304066064291205730622145206447227404607082151753919361349868545307462428210932437992623119255718054243534096986413211959304171135887211540587436459888779324151143025499619973135708235491605216411394962317959813656209629567607308778163987166821943423002154894970121188451784354115735408809579052563235078363998602200794840158081619720701643652284259066561050115602486569569690456649269369511972329349611423116985630502303784458447333880791258687570760036481989066910025496948546865951981177430643941260666483918647746947170525925083317666875914436471646901318749705595856856883346891726769074746650987330068104292614480104709810601198864073890537548001433033723615776224146304045036932985711688197452123005099236554526727107165691391180111605054039864164377438525310672107170437281478322426514683178129245151967154583110424925964982504343607726182942419964058684010006450471850408468724523024702559055514056791838218373955386876710426728739081458827252802226359687030921900842002785720726229892098824084346436742345912593840934579190526250607721076769764172513184565791506300616867803697312829413891917781663107526096475492046133891964020871514785931302212911910422061349227840920633130097807344731335384126657969326959305179863489255473137828869343169464391631468853227921632272791516165605848151467308601405844760824881338357444888188035204000407673339331919346899410420054651077086850532999310419256243385542853597931278472451318309939063364567112084455650629429599265528219435289213175349567467961574398181095962343974433190931067322110878499680729907288265465620467270493396020598011075090015918395921964211257921275263305336676548841001128867189130080538627211844161021733430009452985356108168888790283056201446152044771750329866340679923824523137794621308627512829896733426062792367679307468573465298446962647695970868442917945963296248995830871462803&#x27;</span>), Decimal(<span class="string">&#x27;245036407881857959287329830175942706463.41676802782442994887934627742200369945701412601647195354905097451178257098540606801565385675107318120460650888047274089786443222032370562593772359240722830861471549006005870906901656856743873456596259047367300567575908527230366385292440919562964298317812232800102576149495809413427952810634193186781922614214268017709482845572771078220390794231892763512491653218636267112852524278614145782738125962122310806946368712582799445479001874840170209715004731276988049273955290890839588161009103614134479683822558461311134193156291806539774288015592213012944114677791107334704048050248067790961044976635609645113466054839476916586971455181287563116833537875679872852426596500045916084590678852453213603747411621009244578584574321606967288315507350789499360210767971560504476491167021056575773203913674206412928683729647182751865762672106362511792516860263344700590671316013798899626125150168033775577935989491544189330151349377248071416776567110915867894841003988715963213282301539772548019203054604324657682585086974883293993693364621477765424253486620846417121914627069652179323747638053294808478946841684842391124370675090921956558456987438962361101647423473932215595029566302891192438202103166531605890363352381011015329475002801933772777494625189852526005526409489415563470356698119177369784245367090617016832725703245455210343971981483284742666226075984764682029024194412093587469973865623264825887838718407665448451327538641035583414835042280186524871430174844859199371418365330179156143049238655596474961217964906635309020982967098088279871772621354935094165104148277851308675528401723829872589324051699054275878133606165491429811386740566384976019587172015296076695877847670182335353621529186538640618471230538158759335554894682026973199860563823746052413212330496106907455577991532192244914548792485371507973770044500533179391911148716837049004674981572325374669719464763272448641196278444851808838959425053174592256179039838611577554410785172685506776747109456418706054407235309341&#x27;</span>), Decimal(<span class="string">&#x27;137345167246666152708695783992412451677.21558050568623481295196376367975242130555102201515580316330966697148890411534221923225952905285897183010922406175094262069208074739275097805536185634560982617648832780575658021059502299936366800046975825224832714908010519763833830348421655509168881358855533351044140363192436142763626456404652383592376546952793513967937938636543810723145564947948780573116974908526774605955951469943187865644596524139107481653386681950240101520692953876806620084423038367388560905871875836530739404184303742718262418117805718036122357051928716596276399762849629107495322882675719409051073299089695124393278836941013272789785477953131515760862594743832917404252472431732912434480355250761546326425334589230931109133966112698705631064298540629644087174339495451233415165784208154862632994746999100506080852291240231466075807689137982406781289386109243195384399444517321654449447540787541127685794368775611662723601685545144635953407926414192981817325925467123186823453700610674338813375219959042008201960857405988222431762449068615565770592161380029925528004633925411749903272512805896758350376028759094075163759541252996218647962921737695225607000672827355712319484834139082006323871120783473891599300315829557138141744616522321981481762618665822002496867084381222827633659627360022043393386819320488647893458122132426243653269827396864109912568570075611460793016682214280860824555257535036669613199445516497725227349649115460430628789851678786053832488469704975290639037623666238775508475503615248256142687325810589424170821237702234472583990907852983428072024771329547328770035145579513303770469872758505372515800860236159229593770017270383301142993264982903473737872532789578999358701823743117676045641159467315897055924399632998579024195194906804156820621748747515175782908138772828776041903750590418332731770693214602115172315637279313855936478443754676804416808777432960976763034716998360016818363826448918529745873789717604991019505220078545941396511331142324037841720139678985890298577830351331&#x27;</span>), Decimal(<span class="string">&#x27;248598813941244564314190366976956238846.21287154177193010973910605580779261210365984174749796180419923931211513873961571752231238459134695223104083276961569452018392982079324317136535206452261881826873414602629594471707660157457896214988591398626491707261264840694400878016171848489165321633160306766022332706508213328119352706170273262931280561423851178335709726505935522918272264480451898981178517451201483151591554008657960692345350455891365321593940275460890295306738282405071381298895783171740603832308867778448785711118127825021180253182388515151158156028351993831870085534975634188825697876813579914222802552156594566015228528827397850794636185597567790199750813063356917626291927109597628605896564415404785475255907843090500284371578116809505806089285850503289523274957689703557226650819188753255887580294403919233020671057076485044952433816771965385673494711771474126428651980119604119559562596188714862777544919355156232243652718517709528203262205358442941280815388198987743628689516005444663613668047007886122931571139930784688640045996582570962554713967405406762001906063378302125401898155550603489814135391137430186059041384496922239998747587303366147421038091369722510204804734395780572006815615350115111367222110517089689188974108653902029376056551397900019653419884380778042660817204485470749571339982927039079734483080043934563757326484950182811230031559346385457298240850154178951900739178353564235216322232791700369486112525607172179782914690610012323349746725297341069764127541218762893367556754429312136345943483494236203659704464226488931565438262759788872114208783818792121079840366002113316654063450919686404664767226446116187197107156555434824485171863955895656710114494285915504850382199832564322800850387423097212704670656698969249945269974571051395109564672354772654744585684053379753599154369914818372119637829894516195738013893515476266773802929361065238109305019468285763072333229080155510459572404321239788374283507107268753407976278020430629150787678790300001623259645896920037795093793915002&#x27;</span>)]</span><br><span class="line"></span><br><span class="line">L = block_matrix(ZZ,[</span><br><span class="line">    [<span class="number">1</span>,Matrix(ZZ,[<span class="built_in">int</span>(i*<span class="built_in">int</span>(<span class="number">10</span>^<span class="number">2000</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> c]).T]</span><br><span class="line">])</span><br><span class="line">L = L.LLL()</span><br><span class="line">res = L[<span class="number">0</span>][:<span class="built_in">len</span>(c)]</span><br><span class="line">L = Matrix(Matrix(ZZ,res).right_kernel().basis())</span><br><span class="line">A = L.LLL()</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">vecs = [A[<span class="number">0</span>],A[<span class="number">1</span>],A[<span class="number">2</span>]]</span><br><span class="line">valid_vecs = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product([i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">5</span>,<span class="number">5</span>)],repeat=<span class="number">3</span>):</span><br><span class="line">    i1 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        i1 += i[j] * vecs[j]</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">all</span>(tt &gt; <span class="number">0</span> <span class="keyword">and</span> tt &lt; <span class="number">2</span>^<span class="number">64</span> <span class="keyword">for</span> tt <span class="keyword">in</span> i1) <span class="keyword">and</span> i1 <span class="keyword">not</span> <span class="keyword">in</span> valid_vecs):</span><br><span class="line">        valid_vecs.append(i1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> combinations(valid_vecs,<span class="number">3</span>):</span><br><span class="line">    i1,i2,i3 = <span class="built_in">list</span>(i)</span><br><span class="line"></span><br><span class="line">    flag = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        flag += long_to_bytes(<span class="built_in">abs</span>(<span class="built_in">int</span>(i1[j])^^<span class="built_in">int</span>(i2[j])^^<span class="built_in">int</span>(i3[j])))</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">b&quot;corctf&#123;&quot;</span> <span class="keyword">in</span> flag):</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#corctf&#123;I&#x27;m_r00t1ng_f0R_U!!!!!!!&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="other"><a href="#other" class="headerlink" title="other"></a>other</h3><p>此外还有两个题目，一个是区块链一个是量子，都没接触过，之后有机会再说吧，不过感觉大概率不太会去了解太多XD。</p>
<p><br></p>
<p><br></p>
<h2 id="Deadsec-CTF"><a href="#Deadsec-CTF" class="headerlink" title="Deadsec CTF"></a>Deadsec CTF</h2><p>这比赛被Zima拉着一起看了看，其中有一个题目还比较有趣，所以还是记录下。</p>
<h3 id="Flag-killer"><a href="#Flag-killer" class="headerlink" title="Flag killer"></a>Flag killer</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Is it enough obfuscation?</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> hexlify</span><br><span class="line"></span><br><span class="line">flag = hexlify(<span class="string">b&#x27;DEAD&#123;test&#125;&#x27;</span>).decode()</span><br><span class="line"></span><br><span class="line">index = <span class="number">0</span></span><br><span class="line">output = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">FLAG_KILLER</span>(<span class="params">value</span>):</span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    temp = []</span><br><span class="line">    output = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> value &gt; <span class="number">0</span>:</span><br><span class="line">        temp.append(<span class="number">2</span> - (value % <span class="number">4</span>) <span class="keyword">if</span> value % <span class="number">2</span> != <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span>)</span><br><span class="line">        value = (value - temp[index])/<span class="number">2</span></span><br><span class="line">        index += <span class="number">1</span></span><br><span class="line">    temp = temp[::-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(temp)):</span><br><span class="line">        output += temp[index] * <span class="number">3</span> ** (<span class="built_in">len</span>(temp) - index - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> index &lt; <span class="built_in">len</span>(flag):</span><br><span class="line">    output += <span class="string">&#x27;%05x&#x27;</span> % <span class="built_in">int</span>(FLAG_KILLER(<span class="built_in">int</span>(flag[index:index+<span class="number">3</span>],<span class="number">16</span>)))</span><br><span class="line">    index += <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(output)</span><br></pre></td></tr></table></figure>
<p>enc.txt：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0e98b103240e99c71e320dd330dd430de2629ce326a4a2b6b90cd201030926a090cfc5269f904f740cd1001c290cd10002900cd100ee59269a8269a026a4a2d05a269a82aa850d03a2b6b900883</span><br></pre></td></tr></table></figure>
<p>不用细看步骤，看最下面的while就知道实际上就是把flag的每三位16进制的值用某个5位十六进制表示，所以建个表然后查就好了。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">FLAG_KILLER</span>(<span class="params">value</span>):</span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    temp = []</span><br><span class="line">    output = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> value &gt; <span class="number">0</span>:</span><br><span class="line">        temp.append(<span class="number">2</span> - (value % <span class="number">4</span>) <span class="keyword">if</span> value % <span class="number">2</span> != <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span>)</span><br><span class="line">        value = (value - temp[index])/<span class="number">2</span></span><br><span class="line">        index += <span class="number">1</span></span><br><span class="line">    temp = temp[::-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(temp)):</span><br><span class="line">        output += temp[index] * <span class="number">3</span> ** (<span class="built_in">len</span>(temp) - index - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">hex</span>(<span class="built_in">int</span>(output))[<span class="number">2</span>:].zfill(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">c = <span class="string">&quot;0e98b103240e99c71e320dd330dd430de2629ce326a4a2b6b90cd201030926a090cfc5269f904f740cd1001c290cd10002900cd100ee59269a8269a026a4a2d05a269a82aa850d03a2b6b900883&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span>):</span><br><span class="line">    dic = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">2</span>**<span class="number">24</span>):</span><br><span class="line">        dic[FLAG_KILLER(i)] = <span class="built_in">hex</span>(i)[<span class="number">2</span>:].zfill(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">    flag = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="built_in">len</span>(c)//<span class="number">5</span>):</span><br><span class="line">        flag += dic[c[i*<span class="number">5</span>:i*<span class="number">5</span>+<span class="number">5</span>]]</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="string">&quot;444541447b323633663837316538383065396463376432343031303030333034666336306539386337633538387d&quot;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#DEAD&#123;263f871e880e9dc7d2401000304fc60e98c7c588&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="Raul-Rosas"><a href="#Raul-Rosas" class="headerlink" title="Raul Rosas"></a>Raul Rosas</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;I say weird stuff all the time.&quot;</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> nextprime</span><br><span class="line"></span><br><span class="line">p1 = <span class="built_in">bin</span>(getPrime(<span class="number">1024</span>))[<span class="number">2</span>:]</span><br><span class="line">p2 = p1[:<span class="number">605</span>]</span><br><span class="line">p2 = p2 + (<span class="string">&#x27;0&#x27;</span>*(<span class="built_in">len</span>(p1)-<span class="built_in">len</span>(p2)))</span><br><span class="line"></span><br><span class="line">p1 = <span class="built_in">int</span>(p1,<span class="number">2</span>)</span><br><span class="line">p2 = nextprime(<span class="built_in">int</span>(p2,<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">q1 = getPrime(<span class="number">300</span>)</span><br><span class="line">q2 = getPrime(<span class="number">300</span>)</span><br><span class="line"></span><br><span class="line">n1 = p1*p1*q1 </span><br><span class="line">n2 = p2*p2*q2 </span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span> </span><br><span class="line">flag = bytes_to_long(<span class="string">b&#x27;REDACTED&#x27;</span>)</span><br><span class="line">c1 = <span class="built_in">pow</span>(flag,e,n1)</span><br><span class="line">c2 = <span class="built_in">pow</span>(flag,e,n2)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n1=&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n2=&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c1=&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c2=&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n1=33914684861748025775039281034732118800210172226202865626649257734640860626122496857824722482435571212266837521062975265470108636677204118801674455876175256919094583111702086440374440069720564836535455468886946320281180036997133848753476194808776154286740338853149382219104098930424628379244203425638143586895732678175237573473771798480275214400819978317207532566320561087373402673942574292313462136068626729114505686759701305592972367260477978324301469299251420212283758756993372112866755859599750559165005003201133841030574381795101573167606659158769490361449603797836102692182242091338045317594471059984757228202609971840405638858696334676026230362235521239830379389872765912383844262135900613776738814453</span></span><br><span class="line"><span class="string">n2=45676791074605066998943099103364315794006332282441283064976666268034083630735700946472676852534025506807314001461603559827433723291528233236210007601454376876234611894686433890588598497194981540553814858726066215204034517808726230108550384400665772370055344973309767254730566845236167460471232855535131280959838577294392570538301153645042892860893604629926657287846345355440026453883519493151299226289819375073507978835796436834205595029397133882344120359631326071197504087811348353107585352525436957117561997040934067881585416375733220284897170841715716721313708208669285280362958902914780961119036511592607473063247721427765849962400322051875888323638189434117452309193654141881914639294164650898861297303</span></span><br><span class="line"><span class="string">c1=5901547799381070840359392038174495588170513247847714273595411167296183629412915012222227027356430642556122066895371444948863326101566394976530551223412292667644441453331065752759544619792554573114517925105448879969399346787436142706971884168511458472259984991259195488997495087540800463362289424481986635322685691583804462882482621269852340750338483349943910768394808039522826196641550659069967791745064008046300108627004744686494254057929843770761235779923141642086541365488201157760211440185514437408144860842733403640608261720306139244013974182714767738134497204545868435961883422098094282377180143072849852529146164709312766146939608395412424617384059645917698095750364523710239164016515753752257367489</span></span><br><span class="line"><span class="string">c2=3390569979784056878736266202871557824004856366694719533085092616630555208111973443587439052592998102055488632207160968490605754861061546019836966349190018267098889823086718042220586285728994179393183870155266933282043334755304139243271973119125463775794806745935480171168951943663617953860813929121178431737477240925668994665543833309966378218572247768170043609879504955562993281112055931542971553613629203301798161781786253559679002805820092716314906043601765180455118897800232982799905604384587625502913096329061269176369601390578862509347479694697409545495592160695530037113884443071693090949908858172105089597051790694863761129626857737468493438459158669342430468741236573321658187309329276080990875017</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>难得见到这么亲切的RSA题目，熟悉的味道。</p>
<p>题目先生成1024bit的素数p1。然后保留p1的高605位，并把低位全部抹掉之后，取nextprime得到p2，之后计算：</p>
<script type="math/tex; mode=display">
n_1 = p_1^2q_1</script><script type="math/tex; mode=display">
n_2 = p_2^2q_2</script><p>其中q1、q2是300bit的小素数。给出n1、n2，并给出分别用n1、n2加密flag得到的c1、c2，要求还原明文。</p>
<p>由于p2低位仅有一个nextprime的小量，也就是他可以写成：</p>
<script type="math/tex; mode=display">
p_2 = 2^{419}p_h + \delta</script><p>所以n2就是：</p>
<script type="math/tex; mode=display">
n_2 = (2^{419}p_h + \delta)^2q_2</script><p>展开一下：</p>
<script type="math/tex; mode=display">
n_2 = (2^{838}p_h^2 + 2^{419+1}p_h\delta + \delta^2)q_2</script><p>可以看出其实n2的低位其实是：</p>
<script type="math/tex; mode=display">
\delta^2q_2</script><p>所以爆破一下delta就可以得到q2了，之后就很容易。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">t = <span class="built_in">int</span>(<span class="string">&quot;11100110111010000010101011000000011010100111100000010000101011001001011100001111111101100011100100011011111110000001110110010010111111001100111100011010101000010001100100000010000111010011010001101111011101101011111011111000000111100001001100001100111011110011011010001000110111110000101010110010111000111010010111&quot;</span>,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">n1=<span class="number">33914684861748025775039281034732118800210172226202865626649257734640860626122496857824722482435571212266837521062975265470108636677204118801674455876175256919094583111702086440374440069720564836535455468886946320281180036997133848753476194808776154286740338853149382219104098930424628379244203425638143586895732678175237573473771798480275214400819978317207532566320561087373402673942574292313462136068626729114505686759701305592972367260477978324301469299251420212283758756993372112866755859599750559165005003201133841030574381795101573167606659158769490361449603797836102692182242091338045317594471059984757228202609971840405638858696334676026230362235521239830379389872765912383844262135900613776738814453</span></span><br><span class="line">n2=<span class="number">45676791074605066998943099103364315794006332282441283064976666268034083630735700946472676852534025506807314001461603559827433723291528233236210007601454376876234611894686433890588598497194981540553814858726066215204034517808726230108550384400665772370055344973309767254730566845236167460471232855535131280959838577294392570538301153645042892860893604629926657287846345355440026453883519493151299226289819375073507978835796436834205595029397133882344120359631326071197504087811348353107585352525436957117561997040934067881585416375733220284897170841715716721313708208669285280362958902914780961119036511592607473063247721427765849962400322051875888323638189434117452309193654141881914639294164650898861297303</span></span><br><span class="line">c1=<span class="number">5901547799381070840359392038174495588170513247847714273595411167296183629412915012222227027356430642556122066895371444948863326101566394976530551223412292667644441453331065752759544619792554573114517925105448879969399346787436142706971884168511458472259984991259195488997495087540800463362289424481986635322685691583804462882482621269852340750338483349943910768394808039522826196641550659069967791745064008046300108627004744686494254057929843770761235779923141642086541365488201157760211440185514437408144860842733403640608261720306139244013974182714767738134497204545868435961883422098094282377180143072849852529146164709312766146939608395412424617384059645917698095750364523710239164016515753752257367489</span></span><br><span class="line">c2=<span class="number">3390569979784056878736266202871557824004856366694719533085092616630555208111973443587439052592998102055488632207160968490605754861061546019836966349190018267098889823086718042220586285728994179393183870155266933282043334755304139243271973119125463775794806745935480171168951943663617953860813929121178431737477240925668994665543833309966378218572247768170043609879504955562993281112055931542971553613629203301798161781786253559679002805820092716314906043601765180455118897800232982799905604384587625502913096329061269176369601390578862509347479694697409545495592160695530037113884443071693090949908858172105089597051790694863761129626857737468493438459158669342430468741236573321658187309329276080990875017</span></span><br><span class="line">q2 = GCD(t,n2)</span><br><span class="line"></span><br><span class="line">p2 = iroot(n2 // q2,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(p2)</span><br><span class="line">phi2 = p2*(p2-<span class="number">1</span>)*(q2-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c2,inverse(<span class="number">65537</span>,phi2),n2)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#DEAD&#123;Rual_R0s4s_Chiweweiner!!&#125;</span></span><br></pre></td></tr></table></figure>
<p>不过其实p2、q2是300bit，以及p1、q1高位相同，这些信息明显是指向copper的，比如AGCD。</p>
<p><br></p>
<p><br></p>
<h3 id="SSP"><a href="#SSP" class="headerlink" title="SSP"></a>SSP</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Sometimes it requires GPU to compute huge amount of operation... like $O(2^100)$..? Nah, you&#x27;ll use better algorithm, $O(2^50)$ seems fair huh?</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">MAX_N = <span class="number">100</span></span><br><span class="line">RAND_MAX = <span class="number">10</span> ** <span class="number">200</span> <span class="comment"># You can&#x27;t even solve with knapsack method</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, MAX_N + <span class="number">1</span>):</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Stage <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    arr = [ randrange(<span class="number">0</span>, RAND_MAX) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n) ]</span><br><span class="line">    counts = randrange(<span class="number">0</span>, n + <span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    used = <span class="built_in">set</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"></span><br><span class="line">        idx = randrange(<span class="number">0</span>, n)</span><br><span class="line">        used.add(idx)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(used) &gt;= counts:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> idx <span class="keyword">in</span> used:</span><br><span class="line">        s += arr[idx]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> arr:</span><br><span class="line">        <span class="built_in">print</span>(a, end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line">    answer = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>().split()))</span><br><span class="line"></span><br><span class="line">    user_sum = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> answer:</span><br><span class="line">        user_sum += arr[i]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> user_sum != s:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;You are wrong!&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Stage <span class="subst">&#123;n&#125;</span> Clear&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Long time waiting... Here&#x27;s your flag.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./flag&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="built_in">print</span>(f.read())</span><br></pre></td></tr></table></figure>
<p>题目还专门说了背包没法彻底解决，然而就用背包做完全没遇到障碍TT，并且也没看出有什么特殊点。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Pwn4Sage.pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">MAX_N = <span class="number">100</span></span><br><span class="line">RAND_MAX = <span class="number">10</span> ** <span class="number">200</span> <span class="comment"># You can&#x27;t even solve with knapsack method</span></span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&quot;35.188.216.251&quot;</span>,<span class="number">32222</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> trange(<span class="number">1</span>, MAX_N + <span class="number">1</span>):</span><br><span class="line">    sh.recvline()</span><br><span class="line">    arr = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>,(<span class="built_in">list</span>(sh.recvline().strip().decode().split(<span class="string">&quot; &quot;</span>)))))</span><br><span class="line">    s = arr[-<span class="number">1</span>]</span><br><span class="line">    arr = arr[:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    L = block_matrix(ZZ,[</span><br><span class="line">        [<span class="number">1</span>,Matrix(ZZ,arr).T],</span><br><span class="line">        [Matrix.zero(<span class="number">1</span>, <span class="built_in">len</span>(arr)),-s]</span><br><span class="line">    ])</span><br><span class="line">    L[:,-<span class="number">1</span>:] *= RAND_MAX</span><br><span class="line">    res = L.LLL()[<span class="number">0</span>][:-<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line">    ans = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(res)):</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">abs</span>(res[i]) == <span class="number">1</span>):</span><br><span class="line">            ans += (<span class="built_in">str</span>(i) + <span class="string">&quot; &quot;</span>)</span><br><span class="line">    sh.sendline(ans.encode())</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;Clear&quot;</span>)</span><br><span class="line">    sh.recvline()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(sh.recvline())</span><br><span class="line"><span class="built_in">print</span>(sh.recvline())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#DEAD&#123;T00_B1g_Number_Causes_Pr0blem...&#125;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>后来想了想他说的不能用的背包解法也许是指算法里的。。。</p>
</blockquote>
<p><br></p>
<p><br></p>
<h3 id="Password-Guesser"><a href="#Password-Guesser" class="headerlink" title="Password Guesser"></a>Password Guesser</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Can you figure out my password, I lost it</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;&lt;REDACTED&gt;&#x27;</span></span><br><span class="line">P = <span class="number">13</span>**<span class="number">37</span></span><br><span class="line">password = <span class="string">b&#x27;&lt;REDACTED&gt;&#x27;</span></span><br><span class="line">pl = <span class="built_in">list</span>(password)</span><br><span class="line">pl = <span class="built_in">sorted</span>(pl)</span><br><span class="line"><span class="keyword">assert</span> math.prod(pl) % P == <span class="built_in">sum</span>(pl) % P</span><br><span class="line">password2 = <span class="built_in">bytes</span>(pl)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;counts = <span class="subst">&#123;[cnt <span class="keyword">for</span> _, cnt <span class="keyword">in</span> Counter(password2).items()]&#125;</span>&quot;</span>)</span><br><span class="line">cipher = AES.new(hashlib.sha256(password2).digest(), AES.MODE_CBC)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;cipher.encrypt(pad(flag, <span class="number">16</span>))&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;iv = <span class="subst">&#123;cipher.iv&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">counts = [5, 4, 7, 5, 5, 8, 9, 4, 5, 7, 4, 4, 7, 5, 7, 8, 4, 2, 5, 5, 4, 3, 10, 4, 5, 7, 4, 4, 4, 6, 5, 12, 5, 5, 5, 8, 7, 9, 2, 3, 2, 5, 8, 6, 4, 4, 7, 2, 4, 5, 7, 9, 4, 9, 7, 4, 7, 8, 4, 2, 4, 4, 4, 4, 3, 3, 7, 4, 6, 9, 4, 4, 4, 6, 7, 4, 4, 4, 1, 3, 5, 8, 4, 9, 11, 7, 4, 2, 4]</span></span><br><span class="line"><span class="string">c = b&#x27;q[\n\x05\xad\x99\x94\xfb\xc1W9\xcb`\x96\xb9|CA\xb8\xb5\xe0v\x93\xff\x85\xaa\xa7\x86\xeas#c&#x27;</span></span><br><span class="line"><span class="string">iv = b&#x27;+\xd5&#125;\xd8\xa7K\x88j\xb5\xf7\x8b\x95)n53&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>这个题目挺有意思，他先是从printable里面选取了一些字符记作password，这个password满足：</p>
<script type="math/tex; mode=display">
\prod{p_i} = \sum{p_i} \quad(mod\;13^{37})</script><p>将他排序好之后得到password2，给出password2里面每个元素的count，要求还原password2来解AES得到flag。</p>
<p>首先就是，printable里面有100个字符，然而count中只有89个，所以如果直接爆破的话，需要爆破$C_{100}^{89}$这么多种，虽然说用c++加多进程并不是做不到，但是显然有点太粗糙了。</p>
<p>而且可以发现，这个思路有一个很大的弊端，就是仅仅把上面给出的这个条件：</p>
<script type="math/tex; mode=display">
\prod{p_i} = \sum{p_i} \quad(mod\;13^{37})</script><p>当作检验爆破正确的结果在使用，然而这个条件本身肯定是解题的关键。</p>
<p>对于sum来说，由于所有字符都是printable里的，值都小于128，所以结合count的实际情况来看，这个sum最大也就几万，是远远小于13^37的，而prod则很轻松就能超过13^37。</p>
<p>那么不妨记这个sum值为c，那么其实就有：</p>
<script type="math/tex; mode=display">
c = \prod{p_i} + 13^{37}k</script><p>而仔细想想这个等式会发现，13^37其实带来了很大的特殊性，由于c最多只有几万，所以一定有：</p>
<script type="math/tex; mode=display">
c = \prod{p_i} + 13^{37}k < 13^5</script><p>那么对于prod，如果其中因子含13的字符超过了4个，那么就一定不符合上面的式子了，这是因为若有：</p>
<script type="math/tex; mode=display">
\prod{p_i} = 13^jt,\quad j>4</script><p>则：</p>
<script type="math/tex; mode=display">
\prod{p_i} + 13^{37}k = 13^jt + 13^{37}k = 13^jr, \quad j>4</script><p>所以说，password里面其实根本就没几个因子含13的字符，不然他们的prod在模13^37下一定会大于他们的sum，所以就大大减小了爆破范围，因此较短时间内就能找到解。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">P = <span class="number">13</span>**<span class="number">37</span></span><br><span class="line">table = <span class="built_in">sorted</span>([<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> string.printable])</span><br><span class="line">counts = [<span class="number">5</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">t1,t2</span>):</span><br><span class="line">    tt = <span class="number">1</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(t1) == <span class="built_in">len</span>(t2)</span><br><span class="line">    <span class="keyword">for</span> i,j <span class="keyword">in</span> <span class="built_in">zip</span>(t1,t2):</span><br><span class="line">        tt *= i**j</span><br><span class="line">        tt = tt % P</span><br><span class="line">    <span class="keyword">return</span> tt % P</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dot</span>(<span class="params">t1,t2</span>):</span><br><span class="line">    tt = <span class="number">0</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(t1) == <span class="built_in">len</span>(t2)</span><br><span class="line">    <span class="keyword">for</span> i,j <span class="keyword">in</span> <span class="built_in">zip</span>(t1,t2):</span><br><span class="line">        tt += i*j</span><br><span class="line">    <span class="keyword">return</span> tt % P</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span>):</span><br><span class="line">    <span class="keyword">for</span> kkk <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">        <span class="keyword">if</span>(kkk == <span class="number">2</span>):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        tt = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> string.printable <span class="keyword">if</span> <span class="built_in">ord</span>(i) % <span class="number">13</span> != <span class="number">0</span>]</span><br><span class="line">        tt = [<span class="number">13</span>*kkk] + tt</span><br><span class="line">        tt = <span class="built_in">sorted</span>(tt)</span><br><span class="line">        idx_kkk = tt.index(<span class="number">13</span>*kkk)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> tqdm(combinations(<span class="built_in">range</span>(<span class="built_in">len</span>(tt)), <span class="built_in">len</span>(tt) - <span class="built_in">len</span>(counts)),total=math.comb(<span class="built_in">len</span>(tt),<span class="built_in">len</span>(counts))):</span><br><span class="line">            temp = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tt))]</span><br><span class="line">            idxx = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tt)):</span><br><span class="line">                <span class="keyword">if</span>(j <span class="keyword">not</span> <span class="keyword">in</span> i):</span><br><span class="line">                    temp[j] = counts[idxx]</span><br><span class="line">                    idxx += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(temp[idx_kkk] &gt; <span class="number">4</span>):</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span>(dot(tt,temp) == mul(tt,temp)):</span><br><span class="line">                <span class="built_in">print</span>(temp)</span><br><span class="line"></span><br><span class="line">temp = [<span class="number">5</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">4</span>]</span><br><span class="line">tt = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> string.printable <span class="keyword">if</span> <span class="built_in">ord</span>(i) % <span class="number">13</span> != <span class="number">0</span>]</span><br><span class="line">tt = [<span class="number">13</span>*<span class="number">1</span>] + tt</span><br><span class="line">tt = <span class="built_in">sorted</span>(tt)</span><br><span class="line"></span><br><span class="line">password = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(temp)):</span><br><span class="line">    password += (temp[i] * <span class="built_in">chr</span>(tt[i])).encode()</span><br><span class="line"><span class="built_in">print</span>(password)</span><br><span class="line">pl = <span class="built_in">list</span>(password)</span><br><span class="line">pl = <span class="built_in">sorted</span>(pl)</span><br><span class="line"><span class="keyword">assert</span> math.prod(pl) % P == <span class="built_in">sum</span>(pl) % P</span><br><span class="line">password2 = <span class="built_in">bytes</span>(pl)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = <span class="string">b&#x27;q[\n\x05\xad\x99\x94\xfb\xc1W9\xcb`\x96\xb9|CA\xb8\xb5\xe0v\x93\xff\x85\xaa\xa7\x86\xeas#c&#x27;</span></span><br><span class="line">iv = <span class="string">b&#x27;+\xd5&#125;\xd8\xa7K\x88j\xb5\xf7\x8b\x95)n53&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;counts = <span class="subst">&#123;[cnt <span class="keyword">for</span> _, cnt <span class="keyword">in</span> Counter(password2).items()]&#125;</span>&quot;</span>)</span><br><span class="line">cipher = AES.new(hashlib.sha256(password2).digest(), AES.MODE_CBC, iv)</span><br><span class="line">flag = cipher.decrypt(c)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#DEAD&#123;y0u_Gu3ssEd_mY_p4s5w0rD&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="Password-Guesser-Revenge"><a href="#Password-Guesser-Revenge" class="headerlink" title="*Password Guesser Revenge"></a>*Password Guesser Revenge</h3><p>这题现在还做不来，先放在这里，各位师傅也可以看看有没啥思路，我学会了就更新</p>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;&lt;redacted&gt;&#x27;</span></span><br><span class="line">P = <span class="number">13</span>**<span class="number">37</span></span><br><span class="line">password = <span class="string">b&#x27;&lt;redacted&gt;&#x27;</span> <span class="comment"># password charset is string.printable</span></span><br><span class="line">pl = <span class="built_in">list</span>(password)</span><br><span class="line">pl = <span class="built_in">sorted</span>(pl)</span><br><span class="line"><span class="keyword">assert</span> math.prod(pl) % P == <span class="built_in">sum</span>(pl) % P</span><br><span class="line">password2 = <span class="built_in">bytes</span>(pl)</span><br><span class="line"><span class="comment">#print(password2)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;counts = <span class="subst">&#123;[cnt <span class="keyword">for</span> _, cnt <span class="keyword">in</span> Counter(password).items()]&#125;</span>&quot;</span>)</span><br><span class="line">cipher = AES.new(hashlib.sha256(password2).digest(), AES.MODE_CBC)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;cipher.encrypt(pad(flag, <span class="number">16</span>))&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;iv = <span class="subst">&#123;cipher.iv&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">counts = [2, 4, 14, 7, 3, 2, 5, 3, 1, 3, 1, 4, 3, 3, 2, 10, 2, 6, 4, 1, 3, 4, 3, 2, 4, 3, 6, 1, 1, 4, 2, 21, 8, 8, 2, 4, 1, 9, 3, 4, 8, 3, 1, 2, 2, 5, 8, 2, 7, 2, 9, 2, 2, 6, 6, 3, 3, 9, 1, 3, 6, 6, 2, 4, 5, 3, 3, 8, 5, 1, 1, 9, 2, 8, 4, 1, 4, 9, 4, 1, 3, 4, 3, 4, 6, 4]</span></span><br><span class="line"><span class="string">c = b&#x27;\xfb\x9e\xda\x81\xa6\xdf.\xc9zw\xb6t\x9e\x05\xb7\xdb\x84\xe5\x01\x97\xfb\xd2\x04 i\xa5\x13d\xfd\x89c\x0b&#x27;</span></span><br><span class="line"><span class="string">iv = b&#x27;\xd4\xa6\xbc\xae\t/\xd3\x85YY\xb5\xda\xcf\xcaX\xb3&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>可以看出这一题中，给出的不再是password2的counter，而是password的，这就导致刚才的方法完全没法用了，因为还需要爆破一个置换，复杂度奇高无比。</p>
<p>我大致的思路是，由于sum也还是几万那个数量级，是爆破允许的复杂度范围内的，因此先假设他已知，就记为c。那么就只用sum的话，其实整个式子可以看作一个背包，虽然并不知道counter中每个量具体是谁的，但是可以用noisecrt的类似思路来做。</p>
<p>这个思路弊端也很明显：</p>
<ul>
<li>noisecrt造的格太大了，并且c也要爆破，复杂度不允许</li>
<li>printable的字符值都是连续量，规约肯定有多解的</li>
<li>根本没利用上prod</li>
</ul>
<p>如果要利用prod，可以找到一个生成元g，然后用dlp转到指数上去做背包，此时可以避免printable的字符值都是连续量这个问题，然而也有几个缺陷：</p>
<ul>
<li>仍然要利用noisecrt，c仍然要爆破</li>
<li>模13^37根本找不到生成元</li>
</ul>
<p>所以不会了。</p>
<p><br></p>
<p><br></p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>糖醋小鸡块
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://tangcuxiaojikuai.xyz/post/9388d5f7.html" title="2024-corCTF&amp;DeadsecCTF-wp-crypto">https://tangcuxiaojikuai.xyz/post/9388d5f7.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sacreative/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SACREATIVE</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/post/6956167f.html" rel="prev" title="2024-ImaginaryCTF-wp-crypto">
      <i class="fa fa-chevron-left"></i> 2024-ImaginaryCTF-wp-crypto
    </a></div>
      <div class="post-nav-item">
    <a href="/post/8c874679.html" rel="next" title="2024-TFCCTF&crewCTF-wp-crypto">
      2024-TFCCTF&crewCTF-wp-crypto <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#corCTF"><span class="nav-number">1.</span> <span class="nav-text">corCTF</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#steps"><span class="nav-number">1.1.</span> <span class="nav-text">steps</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#monkfish"><span class="nav-number">1.2.</span> <span class="nav-text">monkfish</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#anglerfish"><span class="nav-number">1.3.</span> <span class="nav-text">anglerfish</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#roots"><span class="nav-number">1.4.</span> <span class="nav-text">roots</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#other"><span class="nav-number">1.5.</span> <span class="nav-text">other</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Deadsec-CTF"><span class="nav-number">2.</span> <span class="nav-text">Deadsec CTF</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Flag-killer"><span class="nav-number">2.1.</span> <span class="nav-text">Flag killer</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Raul-Rosas"><span class="nav-number">2.2.</span> <span class="nav-text">Raul Rosas</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SSP"><span class="nav-number">2.3.</span> <span class="nav-text">SSP</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Password-Guesser"><span class="nav-number">2.4.</span> <span class="nav-text">Password Guesser</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Password-Guesser-Revenge"><span class="nav-number">2.5.</span> <span class="nav-text">*Password Guesser Revenge</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="糖醋小鸡块"
      src="/images/image.png">
  <p class="site-author-name" itemprop="name">糖醋小鸡块</p>
  <div class="site-description" itemprop="description">"追风赶月莫停留，平芜尽处是春山"</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">115</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/tangcuxiaojikuai" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;tangcuxiaojikuai" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/1142381085@qq.com" title="E-Mail → 1142381085@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/6394335993" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;6394335993" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">糖醋小鸡块</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>
  <script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'UPEMA7DyYbIIEyOW72ohgytU-gzGzoHsz',
      appKey     : 'M7rXAfeP3JOslroay2n0Jv2R',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
<!-- 引入jQuery -->
<script type="text/javascript" src="//libs.baidu.com/jquery/1.8.3/jquery.min.js"></script>
<!-- 雪花特效2 -->
<script type="text/javascript" src="/js/snow2.js"></script>
