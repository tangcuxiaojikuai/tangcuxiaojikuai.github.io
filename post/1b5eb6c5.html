<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon_small.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="RnN18ZogmZl_dLVpxZ6y8kjKL73Mu9VLVEkw9d3qrq0" />
  <meta name="msvalidate.01" content="DC3050AD55F30DDF75AAB78517714910" />
  <meta name="baidu-site-verification" content="codeva-PPofu3dNxe" />

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-loading-bar.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"tangcuxiaojikuai.xyz","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="这个比赛也没有参加，要到了附件写写wp。">
<meta property="og:type" content="article">
<meta property="og:title" content="2023-ISCTF-wp-crypto">
<meta property="og:url" content="https://tangcuxiaojikuai.xyz/post/1b5eb6c5.html">
<meta property="og:site_name" content="糖醋小鸡块的blog">
<meta property="og:description" content="这个比赛也没有参加，要到了附件写写wp。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-11-29T05:58:54.000Z">
<meta property="article:modified_time" content="2023-11-29T13:35:26.000Z">
<meta property="article:author" content="糖醋小鸡块">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://tangcuxiaojikuai.xyz/post/1b5eb6c5.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>2023-ISCTF-wp-crypto | 糖醋小鸡块的blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">糖醋小鸡块的blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tangcuxiaojikuai.xyz/post/1b5eb6c5.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/image.png">
      <meta itemprop="name" content="糖醋小鸡块">
      <meta itemprop="description" content=""追风赶月莫停留，平芜尽处是春山"">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="糖醋小鸡块的blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2023-ISCTF-wp-crypto
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2023-11-29 13:58:54 / 修改时间：21:35:26" itemprop="dateCreated datePublished" datetime="2023-11-29T13:58:54+08:00">2023-11-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/wp-crypto/" itemprop="url" rel="index"><span itemprop="name">wp-crypto</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/post/1b5eb6c5.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/post/1b5eb6c5.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>这个比赛也没有参加，要到了附件写写wp。</p>
<span id="more"></span>
<h3 id="夹里夹气"><a href="#夹里夹气" class="headerlink" title="夹里夹气"></a>夹里夹气</h3><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">嘤嘤？嘤嘤？ 嘤嘤？嘤嘤？嘤嘤？ 嘤嘤嘤嘤嘤？嘤嘤嘤嘤嘤？ 嘤嘤嘤 嘤嘤？嘤嘤？嘤嘤嘤嘤嘤？ 嘤嘤嘤嘤嘤嘤嘤嘤嘤嘤嘤嘤嘤嘤？嘤嘤嘤嘤嘤嘤 嘤嘤？嘤嘤？嘤嘤？嘤嘤？ 嘤嘤？嘤嘤？嘤嘤？ 嘤嘤嘤嘤嘤？嘤嘤？嘤嘤？ 嘤嘤嘤嘤嘤？嘤嘤？ 嘤嘤？嘤嘤？嘤嘤？嘤嘤？ 嘤嘤？嘤嘤？嘤嘤嘤嘤嘤嘤嘤嘤？嘤嘤嘤 嘤嘤？嘤嘤？嘤嘤？ 嘤嘤？嘤嘤？嘤嘤嘤嘤嘤？ 嘤嘤？嘤嘤嘤嘤嘤嘤嘤嘤嘤 嘤嘤？嘤嘤？嘤嘤嘤嘤嘤嘤嘤嘤？嘤嘤嘤 嘤嘤？嘤嘤嘤嘤嘤嘤嘤嘤嘤 嘤嘤嘤嘤嘤？嘤嘤？ 嘤嘤嘤嘤嘤？ 嘤嘤？嘤嘤？嘤嘤嘤嘤嘤？ 嘤嘤？嘤嘤嘤嘤嘤嘤嘤嘤嘤 嘤嘤？嘤嘤？嘤嘤嘤嘤嘤嘤嘤嘤？嘤嘤嘤 嘤嘤嘤嘤嘤？嘤嘤？ 嘤嘤？嘤嘤嘤嘤嘤嘤嘤嘤嘤 嘤嘤嘤嘤嘤？ 嘤嘤？嘤嘤？嘤嘤嘤嘤嘤？ 嘤嘤？嘤嘤嘤嘤嘤嘤嘤嘤嘤 嘤嘤嘤嘤嘤？嘤嘤？ 嘤嘤嘤嘤嘤嘤 嘤嘤嘤嘤嘤嘤嘤嘤嘤嘤嘤嘤嘤嘤嘤嘤嘤？嘤嘤嘤</span><br></pre></td></tr></table></figure>
<p>和moectf的猫言喵语一样，按照如下方式做替换：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">嘤嘤？ -&gt; .</span><br><span class="line">嘤嘤嘤 -&gt; -</span><br></pre></td></tr></table></figure>
<p>得到：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.. ... -.-. - ..-. ----.-- .... ... -... -.. .... ..--.- ... ..-. .--- ..--.- .--- -.. -. ..-. .--- ..--.- -.. .--- -. ..-. .--- -.. -- -----.-</span><br></pre></td></tr></table></figure>
<p>然后解摩斯密码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ISCTFHSBDH_SFJ_JDNFJ_DJNFJDM</span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="signin"><a href="#signin" class="headerlink" title="signin"></a>signin</h3><p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genKey</span>(<span class="params">nbits</span>):</span><br><span class="line">    p = getPrime(nbits)</span><br><span class="line">    q = getPrime(nbits)</span><br><span class="line">    </span><br><span class="line">    N = p*p*q</span><br><span class="line">    d = inverse(N, (p-<span class="number">1</span>)*(q-<span class="number">1</span>)//GCD(p-<span class="number">1</span>, q-<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> N,d</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">message,N</span>):</span><br><span class="line">    m = bytes_to_long(flag)</span><br><span class="line">    c = <span class="built_in">pow</span>(m, N, N)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">nbits = <span class="number">1024</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">N,d = genKey(nbits)</span><br><span class="line">c = encrypt(m,N)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;N =&#x27;</span>, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;d =&#x27;</span>, d)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">c = 29897791365314067508830838449733707533227957127276785142837008063510003132596050393885548439564070678838696563164574990811756434599732001622138564176327233154381380717648392357672642893142367607369679906940371540867456654151408884171467638060523066406441697453971996011548195499549200103123841556085936672833238264876038160712793697159776332101536779874757463509294968879216810485825310481778472384531442206034564488532399171243463881900578407746982324779260941957792455217641883334131366614310644607114128868153897806362954456585661855569432513785225453501792356175649676419772626548071916379318631677869452985829916084336045071072493567871623113923140668031380684940109024609167449291380675124701557542736834722898328082888430566229322840781411336263268594978558564310744076581639469210462567543585251718744340216155557606004995449505782302864725856877289388008819135023371948017425832082773421030256964953984562211638060</span></span><br><span class="line"><span class="string">N = 3231913372897424708803097969843687520868057190788284975066875241636436021279559026753076528399891936983240045179193386905918743759145596242896507856007669217275515235051689758768735530529408948098860529277921046146065473333357110158008648799207873976745048714516868561754202543130629713461365314627535982379718931633528922076268531363809414255082933615667770491818402126891370106045838695484124212397783571579791558324350069782623908757815983802849109451590357380624488436968737140312471089662428308113246310588336044438265822574558816510054763215983649467009345458480077882624118620789015758507736272402998721366662352794082495441303895025585316667229865533166614969641012195668280586477033200418153345241668242651407009849656745509386158276185301334443855737552801531617549980843398648751032649895403939319648954908487619711555700124294191702406981128355348449748466449951568451135718146828444185238617155432417897711198169</span></span><br><span class="line"><span class="string">d = 220908195398117048628110042133057032501548264225985823161565460390793825899523662424732910718579350524590368287207857059670558852106434615134645183432670023784725430385048028248108677670095524205518013647694485975996499747580966911259433184798952372110628624294686853944766950244209186984164963987120416687012811346656498861438432610431705868541829977481875385468143747334359481673214618931159403123892213161430602430294790913847722073762999311674428134241956293914716183107414340330449465142849402354034926378025006749405210014879947411570380433942279355488861684317611066949685697268714760755591128598654573304969</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>Schemidt-Samoa密码，不了解原理的话搜一搜就好了。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = <span class="number">29897791365314067508830838449733707533227957127276785142837008063510003132596050393885548439564070678838696563164574990811756434599732001622138564176327233154381380717648392357672642893142367607369679906940371540867456654151408884171467638060523066406441697453971996011548195499549200103123841556085936672833238264876038160712793697159776332101536779874757463509294968879216810485825310481778472384531442206034564488532399171243463881900578407746982324779260941957792455217641883334131366614310644607114128868153897806362954456585661855569432513785225453501792356175649676419772626548071916379318631677869452985829916084336045071072493567871623113923140668031380684940109024609167449291380675124701557542736834722898328082888430566229322840781411336263268594978558564310744076581639469210462567543585251718744340216155557606004995449505782302864725856877289388008819135023371948017425832082773421030256964953984562211638060</span></span><br><span class="line">n = <span class="number">3231913372897424708803097969843687520868057190788284975066875241636436021279559026753076528399891936983240045179193386905918743759145596242896507856007669217275515235051689758768735530529408948098860529277921046146065473333357110158008648799207873976745048714516868561754202543130629713461365314627535982379718931633528922076268531363809414255082933615667770491818402126891370106045838695484124212397783571579791558324350069782623908757815983802849109451590357380624488436968737140312471089662428308113246310588336044438265822574558816510054763215983649467009345458480077882624118620789015758507736272402998721366662352794082495441303895025585316667229865533166614969641012195668280586477033200418153345241668242651407009849656745509386158276185301334443855737552801531617549980843398648751032649895403939319648954908487619711555700124294191702406981128355348449748466449951568451135718146828444185238617155432417897711198169</span></span><br><span class="line">d = <span class="number">220908195398117048628110042133057032501548264225985823161565460390793825899523662424732910718579350524590368287207857059670558852106434615134645183432670023784725430385048028248108677670095524205518013647694485975996499747580966911259433184798952372110628624294686853944766950244209186984164963987120416687012811346656498861438432610431705868541829977481875385468143747334359481673214618931159403123892213161430602430294790913847722073762999311674428134241956293914716183107414340330449465142849402354034926378025006749405210014879947411570380433942279355488861684317611066949685697268714760755591128598654573304969</span></span><br><span class="line"></span><br><span class="line">pq = GCD(<span class="built_in">pow</span>(<span class="number">2</span>,n*d,n)-<span class="number">2</span>,n)</span><br><span class="line">p = n//pq</span><br><span class="line">q = pq//p</span><br><span class="line">phi_n = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,p*q)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment">#ISCTF&#123;aeb8be10-ff19-42cf-8cfd-2ce71ac418e8&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="1zRSA"><a href="#1zRSA" class="headerlink" title="1zRSA"></a>1zRSA</h3><p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genKey</span>(<span class="params">nbits</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        p1 = getPrime(<span class="number">3</span>*nbits)</span><br><span class="line">        p2 = gmpy2.next_prime(p1)</span><br><span class="line">        q1 = getPrime(nbits)</span><br><span class="line">        q2 = getPrime(nbits)</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">abs</span>((p1 - p2)*q1*q2 / p2) &lt; <span class="number">0.5</span>)</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">abs</span>((p1 - p2)*q1*q2 / p2) &lt; <span class="number">0.5</span>):</span><br><span class="line">            n1 = p1 * q1</span><br><span class="line">            n2 = p2 * q2</span><br><span class="line">            <span class="keyword">return</span> n1,n2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">message,e,n</span>):</span><br><span class="line">    m = bytes_to_long(message)</span><br><span class="line">    cipher = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">    <span class="keyword">return</span> cipher</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">nbits = <span class="number">512</span></span><br><span class="line">N1,N2 = genKey(nbits)</span><br><span class="line">c = encrypt(flag,e,N1)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;N1 =&quot;</span>,N1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;N2 =&quot;</span>,N2)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">c = 10514867898770499427284608506159580569755258729683776720082395249877529851029152305989048383470182992945743997295638334301128554841767619528809377736651238576700664675871769469687466885347209033023021132575700436470105289467423655742323143373578268184141573237433927498143740155552829633601489926767185335051352605346248971754473960051955670785777007641909166041398566067524811394639822575661469340152913706417365065683835945980239268665146900957692685590242386540944646586739158427428484471978559453954674292300496568823382513505511940062159025700312492163454304120916055466108498000990408937265075788135466153131436</span></span><br><span class="line"><span class="string">N1 = 29306627985861300819651846356448043523015086509329909246911330574896611830331438353458702041787309531570626136669100576501108581024502570212983369979387658041578384466200573362881060761873478590684611265249166591510948597798713864127744488747451815919677861684787135464097885906630772472111899455047125676738720391327331161464894360886214160668909531050207033060523194208723151015702926842472554933849380343375654696115359960495727909221926251630408376527033291123026893207722440649867394971680316008434251667567174806214522621693042164997381729300075394393372808917061813346794422821819494227772694592990703688149467</span></span><br><span class="line"><span class="string">N2 = 18405525902524887428651801489049128242565457677879715229456940729064725933277139190670749899959483734341103740185991771024797037242681566772189045321838652668819112989587974866361063424698215713773139281840970499871668796770682692589505769008516630604297570518689639885716307469568821629424402742264467677407820449195383921766157185602677665872353099155904715047452319853202981674101731121033360393547940246101864940155160699277417096395998766928213545196492031975135121409309520198853066288180944871441224241681478164494169741263236267316380581883196836731872676312125837497320438964940186318916950049777255612191899</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>题目给出了N1，N2，分别有：</p>
<script type="math/tex; mode=display">
N_1 = p_1q_1</script><script type="math/tex; mode=display">
N_2 = p_2q_2</script><p>并且：</p>
<script type="math/tex; mode=display">
p_1 \approx p_2</script><p>所以有：</p>
<script type="math/tex; mode=display">
\frac{N_1}{N_2} = \frac{p_1q_1}{p_2q_2} \approx \frac{q_1}{q_2}</script><p>因此可以用连分数展开N1/N2得到q1/q2，而事实上，题目的这段代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">abs</span>((p1 - p2)*q1*q2 / p2) &lt; <span class="number">0.5</span></span><br></pre></td></tr></table></figure>
<p>就是在用勒让德理论保证能够连分数展开得到q1，q2。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = <span class="number">10514867898770499427284608506159580569755258729683776720082395249877529851029152305989048383470182992945743997295638334301128554841767619528809377736651238576700664675871769469687466885347209033023021132575700436470105289467423655742323143373578268184141573237433927498143740155552829633601489926767185335051352605346248971754473960051955670785777007641909166041398566067524811394639822575661469340152913706417365065683835945980239268665146900957692685590242386540944646586739158427428484471978559453954674292300496568823382513505511940062159025700312492163454304120916055466108498000990408937265075788135466153131436</span></span><br><span class="line">N1 = <span class="number">29306627985861300819651846356448043523015086509329909246911330574896611830331438353458702041787309531570626136669100576501108581024502570212983369979387658041578384466200573362881060761873478590684611265249166591510948597798713864127744488747451815919677861684787135464097885906630772472111899455047125676738720391327331161464894360886214160668909531050207033060523194208723151015702926842472554933849380343375654696115359960495727909221926251630408376527033291123026893207722440649867394971680316008434251667567174806214522621693042164997381729300075394393372808917061813346794422821819494227772694592990703688149467</span></span><br><span class="line">N2 = <span class="number">18405525902524887428651801489049128242565457677879715229456940729064725933277139190670749899959483734341103740185991771024797037242681566772189045321838652668819112989587974866361063424698215713773139281840970499871668796770682692589505769008516630604297570518689639885716307469568821629424402742264467677407820449195383921766157185602677665872353099155904715047452319853202981674101731121033360393547940246101864940155160699277417096395998766928213545196492031975135121409309520198853066288180944871441224241681478164494169741263236267316380581883196836731872676312125837497320438964940186318916950049777255612191899</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">continuedFra</span>(<span class="params">x, y</span>):</span><br><span class="line">    cF = []</span><br><span class="line">    <span class="keyword">while</span> y:</span><br><span class="line">        cF += [x // y]</span><br><span class="line">        x, y = y, x % y</span><br><span class="line">    <span class="keyword">return</span> cF</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Simplify</span>(<span class="params">ctnf</span>):</span><br><span class="line">    numerator = <span class="number">0</span></span><br><span class="line">    denominator = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> ctnf[::-<span class="number">1</span>]:</span><br><span class="line">        numerator, denominator = denominator, x * denominator + numerator</span><br><span class="line">    <span class="keyword">return</span> (numerator, denominator)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getit</span>(<span class="params">c</span>):</span><br><span class="line">    cf = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(c)):</span><br><span class="line">        cf.append(Simplify(c[:i]))</span><br><span class="line">    <span class="keyword">return</span> cf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cf = continuedFra(N1, N2)</span><br><span class="line"><span class="keyword">for</span> (q2, q1) <span class="keyword">in</span> getit(cf):</span><br><span class="line">    <span class="keyword">if</span> (N1 % q1 == <span class="number">0</span> <span class="keyword">and</span> q1 != <span class="number">1</span>):</span><br><span class="line">        p1 = N1 // q1</span><br><span class="line">        phi = (p1-<span class="number">1</span>)*(q1-<span class="number">1</span>)</span><br><span class="line">        d = inverse(e,phi)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,N1)))</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"><span class="comment">#ISCTF&#123;6f3af9a9-2727-4d48-afb4-9ca82de893f3&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="EasyAES"><a href="#EasyAES" class="headerlink" title="EasyAES"></a>EasyAES</h3><p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag,key</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(flag)==<span class="number">39</span>)</span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(key)==<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">padding</span>(<span class="params">msg</span>):</span><br><span class="line">    tmp = <span class="number">16</span> - <span class="built_in">len</span>(msg)%<span class="number">16</span></span><br><span class="line">    pad = <span class="built_in">hex</span>(tmp)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>.fromhex(pad*tmp)+msg</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">message,key,iv</span>):</span><br><span class="line">    aes = AES.new(key,AES.MODE_CBC,iv=iv)</span><br><span class="line">    enc = aes.encrypt(message)</span><br><span class="line">    <span class="keyword">return</span> enc</span><br><span class="line"></span><br><span class="line">iv = os.urandom(<span class="number">16</span>)</span><br><span class="line">message = padding(flag)</span><br><span class="line">hint = bytes_to_long(key)^bytes_to_long(message[:<span class="number">16</span>])</span><br><span class="line">enc = encrypt(message,key,iv)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(enc)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(hint))</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">b&#x27;bsF\xb6m\xcf\x94\x9fg1\xfaxG\xd4\xa3\x04\xfb\x9c\xac\xed\xbe\xc4\xc0\xb5\x899|u\xbf9e\xe0\xa6\xdb5\xa8x\x84\x95(\xc6\x18\xfe\x07\x88\x02\xe1v&#x27;</span></span><br><span class="line"><span class="string">0x47405a4847405a48470000021a0f2870</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>注意到题目的padding填充在了flag串前面，为9字节的b”\x09”，再加上flag头”ISCTF{“的六字节，我们只需要爆破一字节就可以得到message的前十六个字节，从而用hint还原出key。</p>
<p>还原出key后，一个block一个block解密就可以得到flag。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"></span><br><span class="line">enc = <span class="string">b&#x27;bsF\xb6m\xcf\x94\x9fg1\xfaxG\xd4\xa3\x04\xfb\x9c\xac\xed\xbe\xc4\xc0\xb5\x899|u\xbf9e\xe0\xa6\xdb5\xa8x\x84\x95(\xc6\x18\xfe\x07\x88\x02\xe1v&#x27;</span></span><br><span class="line">hint = <span class="number">0x47405a4847405a48470000021a0f2870</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    prefix = <span class="string">b&quot;\x09&quot;</span> * <span class="number">9</span> + <span class="string">b&quot;ISCTF&#123;&quot;</span> + long_to_bytes(i)</span><br><span class="line">    key = long_to_bytes(bytes_to_long(prefix) ^ hint)</span><br><span class="line">    aes1 = AES.new(key,AES.MODE_ECB)</span><br><span class="line"></span><br><span class="line">    iv = xor(aes1.decrypt(enc[:<span class="number">16</span>]) , prefix)</span><br><span class="line">    aes = AES.new(key,AES.MODE_CBC,iv=iv)</span><br><span class="line">    m = <span class="built_in">str</span>(aes.decrypt(enc))</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">len</span>(m) &lt; <span class="number">70</span>):</span><br><span class="line">        <span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ISCTF&#123;1b106cea3fb848e7bea310c9851f15c1&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="七七的欧拉"><a href="#七七的欧拉" class="headerlink" title="七七的欧拉"></a>七七的欧拉</h3><p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag=<span class="string">b&#x27;ISCTF&#123;*************&#125;&#x27;</span></span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">p=libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">e=libnum.generate_prime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line">output = <span class="built_in">open</span>(<span class="string">&#x27;output1.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;e=&#x27;</span> + <span class="built_in">str</span>(e) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;n=&#x27;</span> + <span class="built_in">str</span>(n) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;c=&#x27;</span> + <span class="built_in">str</span>(c) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.close()</span><br><span class="line"></span><br><span class="line">e=<span class="number">8401285423075497989963572888601376313375827722858883767564499066473101615084214973041844878664837606157257039358849583049856161628241418012475432529735909</span></span><br><span class="line">n=<span class="number">4321524416983780646994834778612486851863709339970595612409550086067211224407144019110798099401660010305645681548980160563216101786447875231976835115531375372678886339587480251211072894186558627897353793098608766868067029578667171419890150599640781594755080391489447462042167529203389236065727274166091741227068469987681083794139925327545810024038937132463518225611578727737940746784891867532498184642892826569777559107609493212332054559366409007685504768163376250281644004067745087899653778023414105973047620041288118404657934689253192043728590231618132716567084621670074256312939305265244486145758609971249077639085204680923108132415216543541472534580414274250979940330459551536830268428508217821060604260805109071534457808355664329902779603050878055690772430842865701249378096775899778255848773171108341331128673249899037133851535556515961699925809139476576825524135111237249709241579903807179252011010794867269715170739895392375920757559721516050680666658719990497863646989338960261844762127142439486275294670858114079687572243312184222126710967744971775585723045524467708387051034760208768956889939050498139189352842087278125173957182804116052402778416216669522309692266036094371308166663738284209615212016564171075874421472070422416318901926525719485991792111414333398004433143751908199358861514725313334333703539239414806773743941986164981642517673117412666430463318509571757766510835600758060976848374353352239044908034501477295696684294816091801944163877509558909040753907584672390823893991672246726026216973013330313971007514064831801564703364591696610900089228302936595848024616691878437618798864186634802647568239526771151323609650598156701595265876736712670677452013054393336294483452480213271032488201259990782289047132105989846972462094302132564809025802421057537091870932014884606863807260521123084423689494401900014232257381801590783735595575258160274248494498550583673688754220860142413631521279464318987425447302135444093663034598455694901199312497459228254746451233078954904159983269585883146959928222698672413648364391121696092287848931565798557217897678221379451042304811449415982434055522599829843482810025780349284547491767219221510351411192251236517341826619338084348136539121415210345488359563985046136632077665460793346345051213014836088333266911684271237227766588616771431226302155269893547077232087387411935345207081799500649921586279416751311277417949192360648342427657867424947189027886922112452681434778850977010752230391327878892161</span></span><br><span class="line">c=<span class="number">1319666577538961333645698288755316431847498788803191213042970951363587036899021668814931340784440773619019635330248746606532233949080268712626456845590851812018539646705520729734738948568349756255640832936325965096602018372418260009779997764653043892043725224481361578258532294625476542003357969893609762981355267857532927948279737945466285738730414948695579002627741734690862181161919734547857550654813379550806374778412603233570494684223057004866601064851006909940259029023083838730497564657690493780040030061594915385886594845808342023634855913932575150487723897981518504381563064479784253539091893925934095008385592529031453149337783826491324308222762190756839839091742536583068791632135883271750510776330897598323339568926234205068941397524390446254057404779041850572848212437589629794980799894974937730065394307284096622814438575278571743516485062058882794531407454597341604166586040406867868323002258035737328450923576878935675998377134860357842547595516243737449809845708319003744144753130977649201725370898918939022097783844477196723482879094829249203949784703408369396219233552019108990900029123063369670129291960293576115301371071209198455299007327352602249399500334424934488528506773472420414119617828578424633182320749576697196936762283306228974126242434663703609495003656244194067493769815032134577138807799395279843708630774412341952691146906264694889245375545635688534662371202213660012977431598746482601668122679279419039288257069843297770840263002870206849857995148396439717143553611140228607531647245352254251824086797704561756363448681983654454393569932173970943157225527780067126895832370645456372127507057750232257828579628856504832975775855059816283684123444984393171125206440588627925736223222718784319209561804023835238526792966229582251575475514349566824846911411659740321154272534589694497411065971714157409318007179403833025337349924938487211920583780456897879801099476865645416182025930390267064170271613760577949655548949317295792361772032185463678410983568470647837758657058230086368185901572658482084202212103405161775243930901117532775865963215971025744893777631306256061896284125630451368067313753222195227231131526000755922331413457862253392530308284156400411897252674398583100198330007779643967156773216464341590817951828849769679134515304258819218015083183653130972243262400248230445031327719507314015062447355358100770763425336581258193908638241498461735819218673116282476452340137513156421147748432605954889277898079292196216</span></span><br></pre></td></tr></table></figure>
<p>factordb分解后可以发现n是一个素数的8次方，因此其欧拉函数值为：</p>
<script type="math/tex; mode=display">
\phi(n) = (p-1)p^7</script><p>然后求解d进行解密即可。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"></span><br><span class="line">e=<span class="number">8401285423075497989963572888601376313375827722858883767564499066473101615084214973041844878664837606157257039358849583049856161628241418012475432529735909</span></span><br><span class="line">n=<span class="number">4321524416983780646994834778612486851863709339970595612409550086067211224407144019110798099401660010305645681548980160563216101786447875231976835115531375372678886339587480251211072894186558627897353793098608766868067029578667171419890150599640781594755080391489447462042167529203389236065727274166091741227068469987681083794139925327545810024038937132463518225611578727737940746784891867532498184642892826569777559107609493212332054559366409007685504768163376250281644004067745087899653778023414105973047620041288118404657934689253192043728590231618132716567084621670074256312939305265244486145758609971249077639085204680923108132415216543541472534580414274250979940330459551536830268428508217821060604260805109071534457808355664329902779603050878055690772430842865701249378096775899778255848773171108341331128673249899037133851535556515961699925809139476576825524135111237249709241579903807179252011010794867269715170739895392375920757559721516050680666658719990497863646989338960261844762127142439486275294670858114079687572243312184222126710967744971775585723045524467708387051034760208768956889939050498139189352842087278125173957182804116052402778416216669522309692266036094371308166663738284209615212016564171075874421472070422416318901926525719485991792111414333398004433143751908199358861514725313334333703539239414806773743941986164981642517673117412666430463318509571757766510835600758060976848374353352239044908034501477295696684294816091801944163877509558909040753907584672390823893991672246726026216973013330313971007514064831801564703364591696610900089228302936595848024616691878437618798864186634802647568239526771151323609650598156701595265876736712670677452013054393336294483452480213271032488201259990782289047132105989846972462094302132564809025802421057537091870932014884606863807260521123084423689494401900014232257381801590783735595575258160274248494498550583673688754220860142413631521279464318987425447302135444093663034598455694901199312497459228254746451233078954904159983269585883146959928222698672413648364391121696092287848931565798557217897678221379451042304811449415982434055522599829843482810025780349284547491767219221510351411192251236517341826619338084348136539121415210345488359563985046136632077665460793346345051213014836088333266911684271237227766588616771431226302155269893547077232087387411935345207081799500649921586279416751311277417949192360648342427657867424947189027886922112452681434778850977010752230391327878892161</span></span><br><span class="line">c=<span class="number">1319666577538961333645698288755316431847498788803191213042970951363587036899021668814931340784440773619019635330248746606532233949080268712626456845590851812018539646705520729734738948568349756255640832936325965096602018372418260009779997764653043892043725224481361578258532294625476542003357969893609762981355267857532927948279737945466285738730414948695579002627741734690862181161919734547857550654813379550806374778412603233570494684223057004866601064851006909940259029023083838730497564657690493780040030061594915385886594845808342023634855913932575150487723897981518504381563064479784253539091893925934095008385592529031453149337783826491324308222762190756839839091742536583068791632135883271750510776330897598323339568926234205068941397524390446254057404779041850572848212437589629794980799894974937730065394307284096622814438575278571743516485062058882794531407454597341604166586040406867868323002258035737328450923576878935675998377134860357842547595516243737449809845708319003744144753130977649201725370898918939022097783844477196723482879094829249203949784703408369396219233552019108990900029123063369670129291960293576115301371071209198455299007327352602249399500334424934488528506773472420414119617828578424633182320749576697196936762283306228974126242434663703609495003656244194067493769815032134577138807799395279843708630774412341952691146906264694889245375545635688534662371202213660012977431598746482601668122679279419039288257069843297770840263002870206849857995148396439717143553611140228607531647245352254251824086797704561756363448681983654454393569932173970943157225527780067126895832370645456372127507057750232257828579628856504832975775855059816283684123444984393171125206440588627925736223222718784319209561804023835238526792966229582251575475514349566824846911411659740321154272534589694497411065971714157409318007179403833025337349924938487211920583780456897879801099476865645416182025930390267064170271613760577949655548949317295792361772032185463678410983568470647837758657058230086368185901572658482084202212103405161775243930901117532775865963215971025744893777631306256061896284125630451368067313753222195227231131526000755922331413457862253392530308284156400411897252674398583100198330007779643967156773216464341590817951828849769679134515304258819218015083183653130972243262400248230445031327719507314015062447355358100770763425336581258193908638241498461735819218673116282476452340137513156421147748432605954889277898079292196216</span></span><br><span class="line"></span><br><span class="line">p = iroot(n,<span class="number">8</span>)[<span class="number">0</span>]</span><br><span class="line">phi = (p-<span class="number">1</span>)*p**<span class="number">7</span></span><br><span class="line">d = inverse(e,phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#ISCTF&#123;3237saq-21se82-3s74f8-8h84ps7-9qw45v7-6bs531-s26h23-c7iu01&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="ezRSA"><a href="#ezRSA" class="headerlink" title="ezRSA"></a>ezRSA</h3><p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag,key</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint,getrandbits</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> factorial <span class="keyword">as</span> factor</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> is_prime <span class="keyword">as</span> is_strongPrime</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> s2n</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">step1</span>(<span class="params">m</span>):</span><br><span class="line">	p,q = getPrime(<span class="number">1024</span>),getPrime(<span class="number">1024</span>)</span><br><span class="line">	n=p*q</span><br><span class="line">	e=getPrime(<span class="number">512</span>)</span><br><span class="line">	phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">	<span class="keyword">while</span> gcd(e,phi) != <span class="number">1</span>:</span><br><span class="line">		e=getPrime(<span class="number">512</span>)</span><br><span class="line">	d = <span class="built_in">pow</span>(e,-<span class="number">1</span>,phi)</span><br><span class="line">	k = randint(<span class="number">800</span>,<span class="number">1500</span>)</span><br><span class="line">	f = factor(k)</span><br><span class="line">	<span class="comment"># print(f&quot;\n\n\n\n&#123;k=&#125;\n\n\n\n&quot;)</span></span><br><span class="line">	leak = (<span class="built_in">pow</span>(e, <span class="number">2</span>) + (e*d - <span class="number">1</span>)*f)*getPrime(<span class="number">256</span>) + k</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n=&#125;</span>&quot;</span>)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;leak=&#125;</span>&quot;</span>)</span><br><span class="line">	e = <span class="number">65537</span></span><br><span class="line">	c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">	<span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">step2</span>(<span class="params">m</span>):</span><br><span class="line">	<span class="comment">#the key number is three part </span></span><br><span class="line">	<span class="keyword">assert</span> key &lt; <span class="number">10</span>**<span class="number">9</span></span><br><span class="line">	<span class="keyword">assert</span> (is_prime(key) <span class="keyword">and</span> <span class="keyword">not</span> is_strongPrime(key))</span><br><span class="line"></span><br><span class="line">	p,q = getPrime(<span class="number">512</span>),getPrime(<span class="number">512</span>)</span><br><span class="line">	n=p*q</span><br><span class="line">	leak1 = <span class="built_in">pow</span>(p,q,n) + <span class="built_in">pow</span>(q,p,n)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n=&#125;</span>&quot;</span>)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;leak1=&#125;</span>&quot;</span>)</span><br><span class="line">	e=<span class="number">0x10001</span></span><br><span class="line">	c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">	seed = getrandbits(<span class="number">64</span>)</span><br><span class="line">	a = getPrime(<span class="number">256</span>)</span><br><span class="line">	b = getPrime(<span class="number">256</span>)</span><br><span class="line">	leak2 = []</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">		leak2.append(seed := (seed * a + b) % p)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;leak2 = &#125;</span>&quot;</span>)</span><br><span class="line">	seed = (seed * a + b) % p</span><br><span class="line">	base = key ^ seed</span><br><span class="line">	final = []</span><br><span class="line">	<span class="keyword">while</span> c &gt; <span class="number">0</span>:</span><br><span class="line">		final.append(c % base)</span><br><span class="line">		c //= base</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> final</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># def most(lis):</span></span><br><span class="line"><span class="comment"># 	return lis.count(True) &gt; lis.count(False)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_prime</span>(<span class="params">p</span>):</span><br><span class="line">	check = [<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">23</span>,<span class="number">29</span>,<span class="number">31</span>,<span class="number">37</span>,<span class="number">41</span>,<span class="number">43</span>,<span class="number">47</span>,<span class="number">53</span>,<span class="number">59</span>,<span class="number">61</span>,<span class="number">67</span>,<span class="number">71</span>,<span class="number">73</span>,<span class="number">79</span>,<span class="number">83</span>,<span class="number">89</span>,<span class="number">97</span>]</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">all</span>([<span class="built_in">pow</span>(i,p-<span class="number">1</span>,p)==<span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> check])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">	<span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">2</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;step1:&quot;</span>)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>,step1(s2n(flag[<span class="number">0</span>])))</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;step2:&quot;</span>)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;final =&quot;</span>,step2(s2n(flag[<span class="number">1</span>])))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>
<p>题目套了四个问题，所以我也就分成四个问题分别阐述一下思路。</p>
<h4 id="step1"><a href="#step1" class="headerlink" title="step1"></a>step1</h4><p>这个问题可以参考我这一篇里的2048bit e一题：</p>
<p><a href="https://tangcuxiaojikuai.xyz/post/ea445335.html">Crypto趣题-RSA(一) | 糖醋小鸡块的blog (tangcuxiaojikuai.xyz)</a></p>
<h4 id="step2"><a href="#step2" class="headerlink" title="step2"></a>step2</h4><p>这个部分对应着剩下的三个小问题。</p>
<h5 id="1、leak1"><a href="#1、leak1" class="headerlink" title="1、leak1"></a>1、leak1</h5><p>给出如下式子：</p>
<script type="math/tex; mode=display">
leak_1 = p^q + q^p \quad(mod\;n)</script><p>要求恢复p(不过其实不用这个，也可以用后面的LCG求出p来，但这里就按出题人的思路走一遍吧)。</p>
<p>这一部分思路是这样的，首先对于：</p>
<script type="math/tex; mode=display">
t_1 = p^q \quad(mod\;n)</script><p>在模p和模q下分别有：</p>
<script type="math/tex; mode=display">
t_1 = 0 \quad(mod\;p)</script><script type="math/tex; mode=display">
t_1 = p \quad(mod\;q)</script><p>CRT组合可以得到：</p>
<script type="math/tex; mode=display">
t_1 = p*p*inverse(p,q) = p*(1+kq) = p + kn</script><p>所以就有：</p>
<script type="math/tex; mode=display">
t_1 \equiv p \quad(mod\;n)</script><p>也就是说：</p>
<script type="math/tex; mode=display">
p^q \equiv p \quad(mod\;n)</script><p>对于q^p也是同理，所以leak1其实也就等于p+q，与n=pq联立解方程就可以解出p和q了。</p>
<h5 id="2、LCG"><a href="#2、LCG" class="headerlink" title="2、LCG"></a>2、LCG</h5><p>没有什么好讲.</p>
<h5 id="3、求key"><a href="#3、求key" class="headerlink" title="3、求key"></a>3、求key</h5><p>如果直接用他给的这个函数爆破的话，相信马上会发现需要的时间很长，不太合理，因此需要尽可能减少爆破时间。</p>
<p>而注意到key的几个限制如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#the key number is three part </span></span><br><span class="line"><span class="keyword">assert</span> key &lt; <span class="number">10</span>**<span class="number">9</span></span><br><span class="line"><span class="keyword">assert</span> (is_prime(key) <span class="keyword">and</span> <span class="keyword">not</span> is_strongPrime(key))</span><br></pre></td></tr></table></figure>
<p>其中，is_prime函数是：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">is_prime</span>(<span class="params">p</span>):</span><br><span class="line">	check = [<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">23</span>,<span class="number">29</span>,<span class="number">31</span>,<span class="number">37</span>,<span class="number">41</span>,<span class="number">43</span>,<span class="number">47</span>,<span class="number">53</span>,<span class="number">59</span>,<span class="number">61</span>,<span class="number">67</span>,<span class="number">71</span>,<span class="number">73</span>,<span class="number">79</span>,<span class="number">83</span>,<span class="number">89</span>,<span class="number">97</span>]</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">all</span>([<span class="built_in">pow</span>(i,p-<span class="number">1</span>,p)==<span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> check])</span><br></pre></td></tr></table></figure>
<p>这其实是在说key是一个对100以内素数均成立的费马伪素数。</p>
<p>而费马伪素数定义是指，对某个底数a，如果一个数n满足如下式子却又不是素数，则称他为以a为底的费马伪素数：</p>
<script type="math/tex; mode=display">
a^{n-1} \equiv 1 \quad(mod\;n)</script><p>费马伪素数的数量是很少的，因此，我们可以不完全check100以内的所有素数，而只在以2为底的费马伪素数中找key就好，就可以大大节省时间。</p>
<p>完整exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> factorial</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot,powmod</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#part1 get flag1</span></span><br><span class="line">n=<span class="number">11947241219140615237486309604628973391930339499486798714294498785973885463922548820705069266901903036359254530976927762175262118185159625298369758973935607721381080656199430417818042316007700805008489750740972102287526203064312544340176751751266738219862839022892152635044837041435349904947659346174437695051460882295109851494351994498403791853684239883961766735230202016890875913906900424655711952381425165331389205409282026144667620577946333963601349932905443037145145394667138672752796990411249984169798953060016353748467221154507518574580014882822860853751863757579945329482337792853278715658322366578632817369803</span></span><br><span class="line">leak=<span class="number">4825516411405566882589539973300777582630401687252523937619475044718073214792109569356301252345907914527064817796240727881691399437316660502564323688151311441558823720142071322647007043253626474853010585775710666373651910201889816367922377400970334479040370865879692204764210349607801862666059991789964453439198722962928173197103040385999540054988070333338229570681105393323319767364566644771731595597298210924296456293443125736685469259629163687986114207231233692023613120260155832741199446052855856512791809968963821161765216500389495853488545132008219841635172896843241988125093920217328861507191614658581776695350233593334984646128341640512614300048002219790302478025661133721688232990437685571940604588227022076092857294647830142309441330515812342199940466483115991318018705011472671758063610572930560763516803732693572940939851140384123593105367117155740563057395940645038058194280259524467405820813428765139386968927021061208348111646257434870000866555555283176852834141906387086839051793789126474095527358879630274092172435022326207193319806666865704778907868548658370890623182731938070419969709739233504224100413506514936517272134494776127809327563935813198793891897000404156963455000732616317276241867836699641699825594195079194154957636030485909612033254350828892222046169586844737908349421869385194421981553067305581842171364022745759111602699744161574724372962242132415149146766136601016174658042678857388889036814591399168640678928083442174651493660991088328784105160030857387096251561933704301600695757426945716557961698202485226605485682131045560193822624290720243852434254301324766198129736640005205530445739302632191151740246117208267182630330046600955724262084795763080838384593939971523865769318326101179866187596006185138294477350533316908592086441208575935282494961976691089358976722199557082176285926812134290542838960814502829473372780200310674359645482281037654052483716329497333729594792122297988611883754886634452292313599416610842690057657285337854049766320641249317238780428383587602425132767334811708075065922641191109650660427678019567095309270443930385437292172296652003394183918270707887845018685247162812541929998945735270109736669595830167257239265204520272132384023622231518288514767919183916561550558812478144292894132331163501566746036390319663066054892756826660841952717280005731719082266616429646501565960817772663658546555336959754321712751857740551378987853931613973604348308746819562341219749677392565068390386908064199536445684309718116754288299091975226013592388160308117145043236992250577771659408413506586402897189336742792418163003231783947003853396754144599319566763313339145462208172531322682800226151072022731913191728047323245146556315571396082728252085753230639541374982105041248659074695696205654079837224195868428271353983820725017250413714060967825638577327604252122887136259380946072629481202720339169708229866846597577227829317443910036825722430374711816074735238082313198164126791797947010044130222158124667234003098164746100341636238823175289796896896408971518797835906067939914494546110471749352544064300485882179448030898818405400902242119590645639910708635188342567159795613212660990908765619684401061336405049960091659288716162966504703741105477420409053115823924764680153604215949521605456710353305498258615912458036292507652321420277318757146737030628878096962452278346772976364597137682209395761868224382621093921689415088745975049380393255899867417274843474628482169247388041616142896804170033688742622605192409970919836724035274730923747265191248135577704760607590</span></span><br><span class="line">c = <span class="number">4058526944014006069084945174812818814825704864122299028618329411106188952604728150732223145114766938864644072527523082946069975859381918224872075058517683896020489424720005770218969436595364473179601299857281520204212872074837132357469599147175121200219338329188718982224238281009625352190581095607599976922610436817213692622671732783554216636941121695116377777616027462234472833366922829073660312229117800995468022619934881890343086653577149166193139948443894324239522101581089953817527886638425552917578146958961373353776642091545344162923084513872918786615317499139918810812014781753970806739855831453833956364967</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#确定k</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">800</span>,<span class="number">1500</span>):</span><br><span class="line">    t = factorial(i)</span><br><span class="line">    ae2 = <span class="built_in">int</span>((leak-i) % t)</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">len</span>(<span class="built_in">bin</span>(ae2)[<span class="number">2</span>:]) &gt; <span class="number">256</span>+<span class="number">512</span>+<span class="number">512</span>):</span><br><span class="line">        k = i-<span class="number">1</span></span><br><span class="line">        <span class="built_in">print</span>(k)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">ae2 = <span class="built_in">int</span>((leak-k) % factorial(k))</span><br><span class="line">temp = leak // factorial(k)</span><br><span class="line">a = GCD(ae2,leak-k-ae2)</span><br><span class="line">e = iroot(ae2//a,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">d = <span class="built_in">int</span>((((leak - k)//a - e**<span class="number">2</span>) // factorial(k) + <span class="number">1</span>) // e)</span><br><span class="line"></span><br><span class="line">kphin = e*d-<span class="number">1</span></span><br><span class="line">d = inverse(<span class="number">65537</span>,kphin)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#part2 get flag2</span></span><br><span class="line">n=<span class="number">138222025039224144545251830624229986468723531196582463907557734108529994926504669875900898789473948111199016914847829105939167293515822413866727879262875702026534563930475309506834431656926222982363543666448736091756871792887144283877167509418070979449484508499296324616988840431116233637168977730122017878289</span></span><br><span class="line">leak1=<span class="number">23535059927033628406212169278224758389583882623183004031205822980722154537430761635153622180505243837027568034322858038302626132200979370182327110682738910</span></span><br><span class="line">leak2 = [<span class="number">362437850887271063413256292444148642949623196635276044583204094265607936120337004605360832421011</span>, <span class="number">1932915843524327487337992118762711929552569713433223514001673251237692307587356544615955431611435994003602897830069566867051943572065473955405337889221398</span>, <span class="number">11222178024143398739150445814520244630341642052876364179793404105841311693968292227072031763726153574031884490677131749512430325919668649359617953965112844</span>, <span class="number">5408933876805830533113961512210040977462510675785228477646978801328722923647434079128879371684477664804744431834418916837956820965870203842552250165916773</span>, <span class="number">1447143741705069323823257922715038721270982554690635708441585728089036094805730054505696492295730683300002193478561819037345041940787115528445592303142510</span>, <span class="number">3707657531268843465369646969917923274507341341483950204025637357600814449263032574496424566705812439915548150679438579110456264431525526309588664326456861</span>, <span class="number">9263925820149827740182684692442727161206242182976684575667062235695526783971703826794731732152445051579616121306722939129265340347908823003172137299057843</span>, <span class="number">207494591333501391015462321304802957885928775185602834554977737560856036337667840127810136802887548047878444936730742505483927963807357904024967768148122</span>, <span class="number">7052936859446617933917872361389151092893299250603966165472023802877016733939957851026719428770748111897050866474067880613419756475700748999497496482278608</span>, <span class="number">1169538791889404037461397919075674424569430764451305755000680272926397357803359328850780774937432248011264334398346178303234064891680342161511829008635621</span>]</span><br><span class="line">final = [<span class="number">2268617516274900905319941795987877533673889507146326516564545408684476960310333170888941124460992562245780101836116975666368936099249664924148379487909122</span>, <span class="number">1445275952377746701088629016221431744592935398639655895336779954310077866709012082302847692239730041591520169244063854849129773530127510048494782550102381</span>, <span class="number">7</span>]</span><br><span class="line"><span class="comment">#LCG -&gt; get p</span></span><br><span class="line">c1,c2,c3,c4,c5 = leak2[:<span class="number">5</span>]</span><br><span class="line">t1 = c2-c1</span><br><span class="line">t2 = c3-c2</span><br><span class="line">t3 = c4-c3</span><br><span class="line">t4 = c5-c4</span><br><span class="line">T1 = t4*t2 - t3*t3</span><br><span class="line">T2 = t3*t1 - t2*t2</span><br><span class="line">p = GCD(T1,T2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">1000</span>):</span><br><span class="line">    <span class="keyword">while</span>(p % i == <span class="number">0</span>):</span><br><span class="line">        p //= i</span><br><span class="line">q = n // p</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(<span class="number">65537</span>,phi)</span><br><span class="line"><span class="comment">#求a,b</span></span><br><span class="line">a = inverse((c2-c1),p)*(c3-c2) % p</span><br><span class="line">b = (-a*c2 + c3) % p</span><br><span class="line">seed = (leak2[-<span class="number">1</span>]*a+b)%p</span><br><span class="line"></span><br><span class="line"><span class="comment">#get key</span></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> is_prime <span class="keyword">as</span> is_strongPrime</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_prime</span>(<span class="params">p</span>):</span><br><span class="line">	<span class="keyword">return</span> powmod(<span class="number">2</span>,p-<span class="number">1</span>,p)==<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#check</span></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> trange(<span class="number">1</span>,<span class="number">10</span>**<span class="number">9</span>,<span class="number">2</span>):   </span><br><span class="line">    <span class="keyword">if</span>(is_prime(key) <span class="keyword">and</span> <span class="keyword">not</span> is_strongPrime(key)) :  </span><br><span class="line">        base = key ^ seed</span><br><span class="line">        flag2 = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(final)):</span><br><span class="line">            flag2 += (base**i) * final[i]</span><br><span class="line">        flag2 = powmod(flag2,d,n)</span><br><span class="line">        temp = <span class="built_in">str</span>(long_to_bytes(flag2))</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">r&quot;\x&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> temp):</span><br><span class="line">            <span class="built_in">print</span>(temp)</span><br><span class="line">            exit()</span><br><span class="line"></span><br><span class="line"><span class="comment">#ISCTF&#123;yOu_kn0W_RSAgcd_and_g0Od_at_LCG_also_like_Carmichael_number&#125;</span></span><br></pre></td></tr></table></figure>
<p>不过看解出来的flag中，提示key是一个Carmichael_number，也就是卡迈克尔数。</p>
<p>卡迈克尔数是在费马伪素数的基础上定义的。一个数n被称作卡迈克尔数，需要他是以任意与n互素的a为底的费马伪素数。</p>
<p>听上去有点绕，其实也就是要求n对任意与他互素的a都满足：</p>
<script type="math/tex; mode=display">
a^{n-1} \equiv 1 \quad(mod\;n)</script><p>那么结合flag内容应该可以猜到，出题人的预期应该是去OEIS上找3个因子的卡迈克尔数的数列，从而减小爆破复杂度。</p>
<p>但是，这样其实是不太合理的。因为就按照题目提示来说，满足要求的key并不一定就是卡迈克尔数。因为check只用了100以内的素数，不能保证key对任意与他互素的a都满足</p>
<script type="math/tex; mode=display">
a^{key-1} \equiv 1 \quad(mod\;key)</script><p>具体来说，比如key与100以内的素数都满足上面的式子，他就可以通过check；但是如果key与100以上的素数(比如101)不满足上面的式子，他依然是满足题目要求的key，但是他不是卡迈克尔数。所以用卡迈克尔数严格来说可能会漏掉不少符合要求的key，因此用以2为底的费马伪素数来爆破key更加合理。</p>
<p><br></p>
<p><br></p>
<h3 id="baby-group"><a href="#baby-group" class="headerlink" title="baby_group"></a>baby_group</h3><p>task.py：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Per <span class="keyword">import</span> P,Block</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> s2n</span><br><span class="line"></span><br><span class="line">mask = P(<span class="number">256</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(mask**<span class="number">2</span>)</span><br><span class="line">mask_hash = hashlib.sha512(<span class="built_in">str</span>(mask).encode()).hexdigest()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;the mask hash is:&quot;</span> + mask_hash)</span><br><span class="line"></span><br><span class="line">mul = P(<span class="number">256</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;mul=&#125;</span>&quot;</span>)</span><br><span class="line">temp = hashlib.sha512(<span class="built_in">str</span>(mask * mul).encode()).hexdigest()</span><br><span class="line"></span><br><span class="line">msg = s2n(flag) ^ <span class="built_in">int</span>(temp,<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">worker = Block()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;pubkey(q,h):<span class="subst">&#123;worker.getPublicKey()&#125;</span>&quot;</span>)</span><br><span class="line">c = worker.enc(msg)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c=&#125;</span>&quot;</span>)</span><br><span class="line">dec = worker.dec(c)</span><br></pre></td></tr></table></figure>
<p>Per.py：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert,sqrt,gcd</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">P</span>:</span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, data</span>):</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">type</span>(data) <span class="keyword">is</span> <span class="built_in">int</span>:</span><br><span class="line">			self.size = data</span><br><span class="line">			self._<span class="built_in">list</span> = [i+<span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.size)]</span><br><span class="line">			self._initialize()			</span><br><span class="line">		<span class="keyword">elif</span> <span class="built_in">type</span>(data) <span class="keyword">is</span> <span class="built_in">list</span>:</span><br><span class="line">			self._<span class="built_in">list</span> = data</span><br><span class="line">			self.size = <span class="built_in">len</span>(self._<span class="built_in">list</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">__mul__</span>(<span class="params">self, other</span>):</span><br><span class="line">		<span class="keyword">return</span> P(self._iterList(self.getList(),other.getList()))</span><br><span class="line"></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">str</span>(self._<span class="built_in">list</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">len</span>(self._<span class="built_in">list</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">__pow__</span>(<span class="params">self, other</span>):</span><br><span class="line">		tempList = self._<span class="built_in">list</span></span><br><span class="line">		<span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,other):</span><br><span class="line">			tempList = self._iterList(tempList, tempList)</span><br><span class="line">		<span class="keyword">return</span> P(tempList)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">str</span>(self._<span class="built_in">list</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">getList</span>(<span class="params">self</span>):</span><br><span class="line">		<span class="keyword">return</span> self._<span class="built_in">list</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">_initialize</span>(<span class="params">self</span>):</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">			random.shuffle(self._<span class="built_in">list</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">_iterList</span>(<span class="params">self, List1,List2</span>):</span><br><span class="line">		new_list = []</span><br><span class="line">		<span class="keyword">for</span> elem <span class="keyword">in</span> List1:</span><br><span class="line">			new_list.append(List2[elem - <span class="number">1</span>])</span><br><span class="line">		<span class="keyword">return</span> new_list</span><br><span class="line"></span><br><span class="line"><span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Block</span>():</span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">		<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">			self.q = random.getrandbits(<span class="number">2048</span>)</span><br><span class="line">			self.f = random.randint(<span class="number">1</span>, sqrt(self.q // <span class="number">2</span>))</span><br><span class="line">			self.g = random.randint(sqrt(self.q // <span class="number">4</span>), sqrt(self.q // <span class="number">2</span>))</span><br><span class="line">			<span class="keyword">if</span> gcd(self.f, self.q * self.g) == <span class="number">1</span>:</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">		self.h = invert(self.f, self.q) * self.g % self.q</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">getPublicKey</span>(<span class="params">self</span>):</span><br><span class="line">		<span class="keyword">return</span> (<span class="built_in">int</span>(self.q), <span class="built_in">int</span>(self.h))</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">self, m</span>):</span><br><span class="line">		<span class="keyword">assert</span> m &lt; sqrt(self.q//<span class="number">4</span>)</span><br><span class="line">		r = random.randint(<span class="number">1</span>, sqrt(self.q // <span class="number">2</span>))</span><br><span class="line">		e = (r * self.h + m) % self.q</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">int</span>(e)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">dec</span>(<span class="params">self, e</span>):</span><br><span class="line">		a = self.f * e % self.q</span><br><span class="line">		b = invert(self.f, self.g) * a % self.g</span><br><span class="line">		<span class="keyword">return</span> b</span><br></pre></td></tr></table></figure>
<p>output.txt：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">82</span>, <span class="number">237</span>, <span class="number">32</span>, <span class="number">83</span>, <span class="number">30</span>, <span class="number">200</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">4</span>, <span class="number">147</span>, <span class="number">171</span>, <span class="number">152</span>, <span class="number">193</span>, <span class="number">19</span>, <span class="number">170</span>, <span class="number">136</span>, <span class="number">186</span>, <span class="number">8</span>, <span class="number">124</span>, <span class="number">159</span>, <span class="number">225</span>, <span class="number">6</span>, <span class="number">180</span>, <span class="number">125</span>, <span class="number">74</span>, <span class="number">14</span>, <span class="number">255</span>, <span class="number">60</span>, <span class="number">187</span>, <span class="number">132</span>, <span class="number">222</span>, <span class="number">121</span>, <span class="number">56</span>, <span class="number">79</span>, <span class="number">57</span>, <span class="number">229</span>, <span class="number">87</span>, <span class="number">27</span>, <span class="number">72</span>, <span class="number">197</span>, <span class="number">201</span>, <span class="number">191</span>, <span class="number">75</span>, <span class="number">38</span>, <span class="number">135</span>, <span class="number">177</span>, <span class="number">165</span>, <span class="number">149</span>, <span class="number">17</span>, <span class="number">172</span>, <span class="number">173</span>, <span class="number">59</span>, <span class="number">210</span>, <span class="number">108</span>, <span class="number">31</span>, <span class="number">142</span>, <span class="number">163</span>, <span class="number">227</span>, <span class="number">178</span>, <span class="number">226</span>, <span class="number">73</span>, <span class="number">256</span>, <span class="number">190</span>, <span class="number">12</span>, <span class="number">103</span>, <span class="number">238</span>, <span class="number">129</span>, <span class="number">157</span>, <span class="number">219</span>, <span class="number">131</span>, <span class="number">67</span>, <span class="number">28</span>, <span class="number">68</span>, <span class="number">236</span>, <span class="number">168</span>, <span class="number">209</span>, <span class="number">245</span>, <span class="number">93</span>, <span class="number">61</span>, <span class="number">122</span>, <span class="number">208</span>, <span class="number">137</span>, <span class="number">49</span>, <span class="number">94</span>, <span class="number">111</span>, <span class="number">18</span>, <span class="number">161</span>, <span class="number">106</span>, <span class="number">54</span>, <span class="number">175</span>, <span class="number">70</span>, <span class="number">16</span>, <span class="number">110</span>, <span class="number">5</span>, <span class="number">218</span>, <span class="number">81</span>, <span class="number">233</span>, <span class="number">45</span>, <span class="number">91</span>, <span class="number">188</span>, <span class="number">151</span>, <span class="number">104</span>, <span class="number">148</span>, <span class="number">184</span>, <span class="number">228</span>, <span class="number">248</span>, <span class="number">150</span>, <span class="number">176</span>, <span class="number">167</span>, <span class="number">35</span>, <span class="number">130</span>, <span class="number">242</span>, <span class="number">126</span>, <span class="number">156</span>, <span class="number">42</span>, <span class="number">169</span>, <span class="number">232</span>, <span class="number">102</span>, <span class="number">50</span>, <span class="number">214</span>, <span class="number">179</span>, <span class="number">205</span>, <span class="number">9</span>, <span class="number">235</span>, <span class="number">97</span>, <span class="number">84</span>, <span class="number">246</span>, <span class="number">36</span>, <span class="number">76</span>, <span class="number">240</span>, <span class="number">52</span>, <span class="number">144</span>, <span class="number">98</span>, <span class="number">86</span>, <span class="number">99</span>, <span class="number">21</span>, <span class="number">64</span>, <span class="number">217</span>, <span class="number">15</span>, <span class="number">202</span>, <span class="number">206</span>, <span class="number">55</span>, <span class="number">244</span>, <span class="number">65</span>, <span class="number">23</span>, <span class="number">53</span>, <span class="number">250</span>, <span class="number">78</span>, <span class="number">22</span>, <span class="number">215</span>, <span class="number">25</span>, <span class="number">66</span>, <span class="number">143</span>, <span class="number">107</span>, <span class="number">195</span>, <span class="number">80</span>, <span class="number">196</span>, <span class="number">254</span>, <span class="number">174</span>, <span class="number">33</span>, <span class="number">162</span>, <span class="number">252</span>, <span class="number">141</span>, <span class="number">153</span>, <span class="number">43</span>, <span class="number">185</span>, <span class="number">211</span>, <span class="number">220</span>, <span class="number">115</span>, <span class="number">127</span>, <span class="number">216</span>, <span class="number">251</span>, <span class="number">139</span>, <span class="number">95</span>, <span class="number">146</span>, <span class="number">48</span>, <span class="number">239</span>, <span class="number">241</span>, <span class="number">37</span>, <span class="number">199</span>, <span class="number">13</span>, <span class="number">160</span>, <span class="number">90</span>, <span class="number">223</span>, <span class="number">123</span>, <span class="number">181</span>, <span class="number">120</span>, <span class="number">164</span>, <span class="number">118</span>, <span class="number">112</span>, <span class="number">128</span>, <span class="number">192</span>, <span class="number">249</span>, <span class="number">39</span>, <span class="number">2</span>, <span class="number">207</span>, <span class="number">71</span>, <span class="number">182</span>, <span class="number">145</span>, <span class="number">62</span>, <span class="number">3</span>, <span class="number">92</span>, <span class="number">183</span>, <span class="number">194</span>, <span class="number">100</span>, <span class="number">24</span>, <span class="number">133</span>, <span class="number">10</span>, <span class="number">117</span>, <span class="number">234</span>, <span class="number">29</span>, <span class="number">11</span>, <span class="number">140</span>, <span class="number">166</span>, <span class="number">85</span>, <span class="number">224</span>, <span class="number">230</span>, <span class="number">134</span>, <span class="number">189</span>, <span class="number">63</span>, <span class="number">46</span>, <span class="number">58</span>, <span class="number">231</span>, <span class="number">247</span>, <span class="number">47</span>, <span class="number">154</span>, <span class="number">44</span>, <span class="number">77</span>, <span class="number">89</span>, <span class="number">101</span>, <span class="number">69</span>, <span class="number">40</span>, <span class="number">26</span>, <span class="number">243</span>, <span class="number">253</span>, <span class="number">41</span>, <span class="number">51</span>, <span class="number">105</span>, <span class="number">155</span>, <span class="number">138</span>, <span class="number">1</span>, <span class="number">212</span>, <span class="number">20</span>, <span class="number">203</span>, <span class="number">213</span>, <span class="number">198</span>, <span class="number">158</span>, <span class="number">88</span>, <span class="number">109</span>, <span class="number">34</span>, <span class="number">119</span>, <span class="number">221</span>, <span class="number">113</span>, <span class="number">96</span>, <span class="number">204</span>, <span class="number">7</span>]</span><br><span class="line"></span><br><span class="line">the mask <span class="built_in">hash</span> <span class="keyword">is</span>:91881f508f08fbafec1a6879fc3a1f215135c94c78f03fae8534d54dc05bd4a122a4e4508d32b9e02be08fbbb42a9e3335fc433c20e2da2e012d11b7324f6952</span><br><span class="line"></span><br><span class="line">mul=[<span class="number">114</span>, <span class="number">189</span>, <span class="number">92</span>, <span class="number">56</span>, <span class="number">252</span>, <span class="number">161</span>, <span class="number">202</span>, <span class="number">250</span>, <span class="number">131</span>, <span class="number">9</span>, <span class="number">111</span>, <span class="number">226</span>, <span class="number">223</span>, <span class="number">24</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">99</span>, <span class="number">208</span>, <span class="number">195</span>, <span class="number">216</span>, <span class="number">141</span>, <span class="number">116</span>, <span class="number">167</span>, <span class="number">34</span>, <span class="number">5</span>, <span class="number">129</span>, <span class="number">15</span>, <span class="number">158</span>, <span class="number">178</span>, <span class="number">197</span>, <span class="number">4</span>, <span class="number">187</span>, <span class="number">27</span>, <span class="number">200</span>, <span class="number">144</span>, <span class="number">76</span>, <span class="number">74</span>, <span class="number">154</span>, <span class="number">86</span>, <span class="number">249</span>, <span class="number">93</span>, <span class="number">112</span>, <span class="number">46</span>, <span class="number">104</span>, <span class="number">25</span>, <span class="number">248</span>, <span class="number">40</span>, <span class="number">225</span>, <span class="number">38</span>, <span class="number">98</span>, <span class="number">186</span>, <span class="number">169</span>, <span class="number">64</span>, <span class="number">118</span>, <span class="number">33</span>, <span class="number">88</span>, <span class="number">26</span>, <span class="number">106</span>, <span class="number">183</span>, <span class="number">43</span>, <span class="number">201</span>, <span class="number">198</span>, <span class="number">242</span>, <span class="number">135</span>, <span class="number">110</span>, <span class="number">218</span>, <span class="number">244</span>, <span class="number">120</span>, <span class="number">83</span>, <span class="number">212</span>, <span class="number">192</span>, <span class="number">185</span>, <span class="number">148</span>, <span class="number">142</span>, <span class="number">11</span>, <span class="number">45</span>, <span class="number">232</span>, <span class="number">107</span>, <span class="number">18</span>, <span class="number">170</span>, <span class="number">60</span>, <span class="number">130</span>, <span class="number">247</span>, <span class="number">67</span>, <span class="number">65</span>, <span class="number">211</span>, <span class="number">182</span>, <span class="number">213</span>, <span class="number">134</span>, <span class="number">254</span>, <span class="number">70</span>, <span class="number">191</span>, <span class="number">210</span>, <span class="number">176</span>, <span class="number">145</span>, <span class="number">217</span>, <span class="number">82</span>, <span class="number">229</span>, <span class="number">125</span>, <span class="number">193</span>, <span class="number">155</span>, <span class="number">41</span>, <span class="number">113</span>, <span class="number">103</span>, <span class="number">49</span>, <span class="number">231</span>, <span class="number">133</span>, <span class="number">75</span>, <span class="number">109</span>, <span class="number">238</span>, <span class="number">126</span>, <span class="number">245</span>, <span class="number">163</span>, <span class="number">233</span>, <span class="number">227</span>, <span class="number">181</span>, <span class="number">51</span>, <span class="number">12</span>, <span class="number">143</span>, <span class="number">234</span>, <span class="number">239</span>, <span class="number">59</span>, <span class="number">240</span>, <span class="number">209</span>, <span class="number">42</span>, <span class="number">205</span>, <span class="number">230</span>, <span class="number">253</span>, <span class="number">203</span>, <span class="number">219</span>, <span class="number">23</span>, <span class="number">136</span>, <span class="number">32</span>, <span class="number">87</span>, <span class="number">102</span>, <span class="number">94</span>, <span class="number">85</span>, <span class="number">62</span>, <span class="number">172</span>, <span class="number">236</span>, <span class="number">124</span>, <span class="number">100</span>, <span class="number">256</span>, <span class="number">196</span>, <span class="number">50</span>, <span class="number">101</span>, <span class="number">206</span>, <span class="number">150</span>, <span class="number">89</span>, <span class="number">29</span>, <span class="number">61</span>, <span class="number">69</span>, <span class="number">246</span>, <span class="number">237</span>, <span class="number">16</span>, <span class="number">37</span>, <span class="number">184</span>, <span class="number">90</span>, <span class="number">162</span>, <span class="number">22</span>, <span class="number">36</span>, <span class="number">10</span>, <span class="number">31</span>, <span class="number">52</span>, <span class="number">190</span>, <span class="number">17</span>, <span class="number">55</span>, <span class="number">115</span>, <span class="number">251</span>, <span class="number">77</span>, <span class="number">214</span>, <span class="number">122</span>, <span class="number">1</span>, <span class="number">255</span>, <span class="number">151</span>, <span class="number">157</span>, <span class="number">241</span>, <span class="number">224</span>, <span class="number">3</span>, <span class="number">44</span>, <span class="number">48</span>, <span class="number">175</span>, <span class="number">194</span>, <span class="number">138</span>, <span class="number">179</span>, <span class="number">159</span>, <span class="number">160</span>, <span class="number">53</span>, <span class="number">80</span>, <span class="number">73</span>, <span class="number">8</span>, <span class="number">35</span>, <span class="number">156</span>, <span class="number">117</span>, <span class="number">58</span>, <span class="number">140</span>, <span class="number">221</span>, <span class="number">180</span>, <span class="number">72</span>, <span class="number">123</span>, <span class="number">147</span>, <span class="number">95</span>, <span class="number">228</span>, <span class="number">97</span>, <span class="number">71</span>, <span class="number">204</span>, <span class="number">39</span>, <span class="number">149</span>, <span class="number">2</span>, <span class="number">19</span>, <span class="number">173</span>, <span class="number">139</span>, <span class="number">146</span>, <span class="number">54</span>, <span class="number">96</span>, <span class="number">220</span>, <span class="number">79</span>, <span class="number">66</span>, <span class="number">57</span>, <span class="number">127</span>, <span class="number">243</span>, <span class="number">188</span>, <span class="number">165</span>, <span class="number">47</span>, <span class="number">235</span>, <span class="number">119</span>, <span class="number">7</span>, <span class="number">199</span>, <span class="number">30</span>, <span class="number">177</span>, <span class="number">63</span>, <span class="number">78</span>, <span class="number">105</span>, <span class="number">207</span>, <span class="number">153</span>, <span class="number">28</span>, <span class="number">132</span>, <span class="number">168</span>, <span class="number">84</span>, <span class="number">166</span>, <span class="number">171</span>, <span class="number">108</span>, <span class="number">21</span>, <span class="number">215</span>, <span class="number">164</span>, <span class="number">174</span>, <span class="number">121</span>, <span class="number">128</span>, <span class="number">91</span>, <span class="number">68</span>, <span class="number">20</span>, <span class="number">222</span>, <span class="number">81</span>, <span class="number">137</span>, <span class="number">13</span>, <span class="number">152</span>]</span><br><span class="line"></span><br><span class="line">pubkey(q,h):(<span class="number">18172777775303192159727657832771688633216215598877965158949208820296023901084764760222881725262986702478735713462424007788959106272018399708244805316198640706589775789778454299532286932532522325791791312289833643271330941006206604894333175027113622330874626579800679513666624938603337561309816936129926352661091319564303604867093095700819543458178063985869752612663625872468653351930763784372987474747809415652595112648835928004343413910248386752899307068129610089712815257479121368111201632430687614657790581254030567845143865728745079851692195657361359959987504557281840928862881924309178036648485188421874327022341</span>, <span class="number">392638098592460228418508462226385074690422702429214284385732305774317959159895775092251586043956914155602546821559652111400517952111932579557319610857122515237088379905875982863782386657213421074126519458271560586678974481499715849371311979995450766948182818105567819897007307737370051632369390705725712223883589110699340619034611462216676501782567065261228166297471411589579035544131060706331012337024260046692910523900152236991203944000276133732456285962825434272960749340504092014446362862600803570698206213069473248298100863523331832957430305801141935737006263947843411592717969844892834332104365594346376118846</span>)</span><br><span class="line">c=<span class="number">4605640253217003331334964510174592254013178259349707648547335080743845433538772185582533054930473399495034133342299169373655297635370654237814250924077096784419954824350471683280656146814012837777204413608581553756866045890045788846665715321962704221105416079118007959490372975054302058194463432668018727266982561600329852084442818715440190956213811944269576719501924787366260795121132011879061730892865163591549129768412164655406373350666250339077746317309673325358941772202710386313434421388779073207650619564862431076222163014501544922959835509589742031678624743915535537547452120771609556012990490607104696154771</span></span><br></pre></td></tr></table></figure>
<p>题目第二部分是一个NTRU，没有太多好讲，主要问题在于第一部分。</p>
<p>而第一部分的问题可以抽象为：已知一个置换的平方，如何还原这个置换？</p>
<p>这个问题可以见我写的这篇中的sqrt一题，我详细解释了还原方法：</p>
<p><a href="https://tangcuxiaojikuai.xyz/post/97bbcbc9.html">Crypto趣题-其他 | 糖醋小鸡块的blog (tangcuxiaojikuai.xyz)</a></p>
<p>相比起sqrt，ISCTF的这个题目的置换拆分出的环简单很多，需要考虑的情况很少，复杂度就比较低。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> combinations</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Per</span>:</span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, data</span>):</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">type</span>(data) <span class="keyword">is</span> <span class="built_in">int</span>:</span><br><span class="line">			self.size = data</span><br><span class="line">			self._<span class="built_in">list</span> = [i+<span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.size)]</span><br><span class="line">			self._initialize()			</span><br><span class="line">		<span class="keyword">elif</span> <span class="built_in">type</span>(data) <span class="keyword">is</span> <span class="built_in">list</span>:</span><br><span class="line">			self._<span class="built_in">list</span> = data</span><br><span class="line">			self.size = <span class="built_in">len</span>(self._<span class="built_in">list</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">__mul__</span>(<span class="params">self, other</span>):</span><br><span class="line">		<span class="keyword">return</span> Per(self._iterList(self.getList(),other.getList()))</span><br><span class="line"></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">str</span>(self._<span class="built_in">list</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">len</span>(self._<span class="built_in">list</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">__pow__</span>(<span class="params">self, other</span>):</span><br><span class="line">		tempList = self._<span class="built_in">list</span></span><br><span class="line">		<span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,other):</span><br><span class="line">			tempList = self._iterList(tempList, tempList)</span><br><span class="line">		<span class="keyword">return</span> Per(tempList)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">str</span>(self._<span class="built_in">list</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">getList</span>(<span class="params">self</span>):</span><br><span class="line">		<span class="keyword">return</span> self._<span class="built_in">list</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">_initialize</span>(<span class="params">self</span>):</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">			random.shuffle(self._<span class="built_in">list</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">_iterList</span>(<span class="params">self, List1,List2</span>):</span><br><span class="line">		new_list = []</span><br><span class="line">		<span class="keyword">for</span> elem <span class="keyword">in</span> List1:</span><br><span class="line">			new_list.append(List2[elem - <span class="number">1</span>])</span><br><span class="line">		<span class="keyword">return</span> new_list</span><br><span class="line"></span><br><span class="line"><span class="comment">#part1 get mask</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span>):</span><br><span class="line">    P2 = [<span class="number">82</span>, <span class="number">237</span>, <span class="number">32</span>, <span class="number">83</span>, <span class="number">30</span>, <span class="number">200</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">4</span>, <span class="number">147</span>, <span class="number">171</span>, <span class="number">152</span>, <span class="number">193</span>, <span class="number">19</span>, <span class="number">170</span>, <span class="number">136</span>, <span class="number">186</span>, <span class="number">8</span>, <span class="number">124</span>, <span class="number">159</span>, <span class="number">225</span>, <span class="number">6</span>, <span class="number">180</span>, <span class="number">125</span>, <span class="number">74</span>, <span class="number">14</span>, <span class="number">255</span>, <span class="number">60</span>, <span class="number">187</span>, <span class="number">132</span>, <span class="number">222</span>, <span class="number">121</span>, <span class="number">56</span>, <span class="number">79</span>, <span class="number">57</span>, <span class="number">229</span>, <span class="number">87</span>, <span class="number">27</span>, <span class="number">72</span>, <span class="number">197</span>, <span class="number">201</span>, <span class="number">191</span>, <span class="number">75</span>, <span class="number">38</span>, <span class="number">135</span>, <span class="number">177</span>, <span class="number">165</span>, <span class="number">149</span>, <span class="number">17</span>, <span class="number">172</span>, <span class="number">173</span>, <span class="number">59</span>, <span class="number">210</span>, <span class="number">108</span>, <span class="number">31</span>, <span class="number">142</span>, <span class="number">163</span>, <span class="number">227</span>, <span class="number">178</span>, <span class="number">226</span>, <span class="number">73</span>, <span class="number">256</span>, <span class="number">190</span>, <span class="number">12</span>, <span class="number">103</span>, <span class="number">238</span>, <span class="number">129</span>, <span class="number">157</span>, <span class="number">219</span>, <span class="number">131</span>, <span class="number">67</span>, <span class="number">28</span>, <span class="number">68</span>, <span class="number">236</span>, <span class="number">168</span>, <span class="number">209</span>, <span class="number">245</span>, <span class="number">93</span>, <span class="number">61</span>, <span class="number">122</span>, <span class="number">208</span>, <span class="number">137</span>, <span class="number">49</span>, <span class="number">94</span>, <span class="number">111</span>, <span class="number">18</span>, <span class="number">161</span>, <span class="number">106</span>, <span class="number">54</span>, <span class="number">175</span>, <span class="number">70</span>, <span class="number">16</span>, <span class="number">110</span>, <span class="number">5</span>, <span class="number">218</span>, <span class="number">81</span>, <span class="number">233</span>, <span class="number">45</span>, <span class="number">91</span>, <span class="number">188</span>, <span class="number">151</span>, <span class="number">104</span>, <span class="number">148</span>, <span class="number">184</span>, <span class="number">228</span>, <span class="number">248</span>, <span class="number">150</span>, <span class="number">176</span>, <span class="number">167</span>, <span class="number">35</span>, <span class="number">130</span>, <span class="number">242</span>, <span class="number">126</span>, <span class="number">156</span>, <span class="number">42</span>, <span class="number">169</span>, <span class="number">232</span>, <span class="number">102</span>, <span class="number">50</span>, <span class="number">214</span>, <span class="number">179</span>, <span class="number">205</span>, <span class="number">9</span>, <span class="number">235</span>, <span class="number">97</span>, <span class="number">84</span>, <span class="number">246</span>, <span class="number">36</span>, <span class="number">76</span>, <span class="number">240</span>, <span class="number">52</span>, <span class="number">144</span>, <span class="number">98</span>, <span class="number">86</span>, <span class="number">99</span>, <span class="number">21</span>, <span class="number">64</span>, <span class="number">217</span>, <span class="number">15</span>, <span class="number">202</span>, <span class="number">206</span>, <span class="number">55</span>, <span class="number">244</span>, <span class="number">65</span>, <span class="number">23</span>, <span class="number">53</span>, <span class="number">250</span>, <span class="number">78</span>, <span class="number">22</span>, <span class="number">215</span>, <span class="number">25</span>, <span class="number">66</span>, <span class="number">143</span>, <span class="number">107</span>, <span class="number">195</span>, <span class="number">80</span>, <span class="number">196</span>, <span class="number">254</span>, <span class="number">174</span>, <span class="number">33</span>, <span class="number">162</span>, <span class="number">252</span>, <span class="number">141</span>, <span class="number">153</span>, <span class="number">43</span>, <span class="number">185</span>, <span class="number">211</span>, <span class="number">220</span>, <span class="number">115</span>, <span class="number">127</span>, <span class="number">216</span>, <span class="number">251</span>, <span class="number">139</span>, <span class="number">95</span>, <span class="number">146</span>, <span class="number">48</span>, <span class="number">239</span>, <span class="number">241</span>, <span class="number">37</span>, <span class="number">199</span>, <span class="number">13</span>, <span class="number">160</span>, <span class="number">90</span>, <span class="number">223</span>, <span class="number">123</span>, <span class="number">181</span>, <span class="number">120</span>, <span class="number">164</span>, <span class="number">118</span>, <span class="number">112</span>, <span class="number">128</span>, <span class="number">192</span>, <span class="number">249</span>, <span class="number">39</span>, <span class="number">2</span>, <span class="number">207</span>, <span class="number">71</span>, <span class="number">182</span>, <span class="number">145</span>, <span class="number">62</span>, <span class="number">3</span>, <span class="number">92</span>, <span class="number">183</span>, <span class="number">194</span>, <span class="number">100</span>, <span class="number">24</span>, <span class="number">133</span>, <span class="number">10</span>, <span class="number">117</span>, <span class="number">234</span>, <span class="number">29</span>, <span class="number">11</span>, <span class="number">140</span>, <span class="number">166</span>, <span class="number">85</span>, <span class="number">224</span>, <span class="number">230</span>, <span class="number">134</span>, <span class="number">189</span>, <span class="number">63</span>, <span class="number">46</span>, <span class="number">58</span>, <span class="number">231</span>, <span class="number">247</span>, <span class="number">47</span>, <span class="number">154</span>, <span class="number">44</span>, <span class="number">77</span>, <span class="number">89</span>, <span class="number">101</span>, <span class="number">69</span>, <span class="number">40</span>, <span class="number">26</span>, <span class="number">243</span>, <span class="number">253</span>, <span class="number">41</span>, <span class="number">51</span>, <span class="number">105</span>, <span class="number">155</span>, <span class="number">138</span>, <span class="number">1</span>, <span class="number">212</span>, <span class="number">20</span>, <span class="number">203</span>, <span class="number">213</span>, <span class="number">198</span>, <span class="number">158</span>, <span class="number">88</span>, <span class="number">109</span>, <span class="number">34</span>, <span class="number">119</span>, <span class="number">221</span>, <span class="number">113</span>, <span class="number">96</span>, <span class="number">204</span>, <span class="number">7</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(P2)):</span><br><span class="line">        P2[i] -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#拆环</span></span><br><span class="line">    lenlist = []</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(P2)):</span><br><span class="line">        <span class="built_in">len</span> = <span class="number">1</span></span><br><span class="line">        t = <span class="number">0</span></span><br><span class="line">        loc = P2[i]</span><br><span class="line">        chain = [loc]</span><br><span class="line">        <span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">            t = P2[loc]</span><br><span class="line">            loc = t</span><br><span class="line">            chain.append(loc)</span><br><span class="line">            <span class="built_in">len</span> += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span>(t == i):</span><br><span class="line">                <span class="comment">#print(i,&quot;,&quot;,len)</span></span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">len</span> == <span class="number">2</span>):</span><br><span class="line">                    <span class="built_in">print</span>(chain)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="comment">#print(lenlist.count(2))</span></span><br><span class="line">    <span class="comment">#64*2 + 29*2 + 20*2 + 9*2 + 4*2 + 3*1 + 1</span></span><br><span class="line"></span><br><span class="line">    chain64 = [[<span class="number">81</span>, <span class="number">136</span>, <span class="number">63</span>, <span class="number">11</span>, <span class="number">151</span>, <span class="number">65</span>, <span class="number">237</span>, <span class="number">104</span>, <span class="number">227</span>, <span class="number">76</span>, <span class="number">244</span>, <span class="number">212</span>, <span class="number">139</span>, <span class="number">201</span>, <span class="number">91</span>, <span class="number">15</span>, <span class="number">135</span>, <span class="number">20</span>, <span class="number">224</span>, <span class="number">46</span>, <span class="number">164</span>, <span class="number">42</span>, <span class="number">74</span>, <span class="number">167</span>, <span class="number">219</span>, <span class="number">62</span>, <span class="number">189</span>, <span class="number">111</span>, <span class="number">241</span>, <span class="number">211</span>, <span class="number">10</span>, <span class="number">170</span>, <span class="number">215</span>, <span class="number">223</span>, <span class="number">246</span>, <span class="number">157</span>, <span class="number">253</span>, <span class="number">95</span>, <span class="number">80</span>, <span class="number">207</span>, <span class="number">9</span>, <span class="number">146</span>, <span class="number">249</span>, <span class="number">33</span>, <span class="number">78</span>, <span class="number">60</span>, <span class="number">72</span>, <span class="number">67</span>, <span class="number">156</span>, <span class="number">195</span>, <span class="number">206</span>, <span class="number">132</span>, <span class="number">97</span>, <span class="number">44</span>, <span class="number">134</span>, <span class="number">98</span>, <span class="number">90</span>, <span class="number">69</span>, <span class="number">130</span>, <span class="number">51</span>, <span class="number">58</span>, <span class="number">177</span>, <span class="number">240</span>, <span class="number">0</span>],[<span class="number">236</span>, <span class="number">50</span>, <span class="number">172</span>, <span class="number">138</span>, <span class="number">14</span>, <span class="number">169</span>, <span class="number">126</span>, <span class="number">245</span>, <span class="number">197</span>, <span class="number">181</span>, <span class="number">159</span>, <span class="number">32</span>, <span class="number">55</span>, <span class="number">141</span>, <span class="number">54</span>, <span class="number">30</span>, <span class="number">221</span>, <span class="number">57</span>, <span class="number">226</span>, <span class="number">43</span>, <span class="number">37</span>, <span class="number">26</span>, <span class="number">254</span>, <span class="number">203</span>, <span class="number">193</span>, <span class="number">38</span>, <span class="number">71</span>, <span class="number">27</span>, <span class="number">59</span>, <span class="number">225</span>, <span class="number">153</span>, <span class="number">106</span>, <span class="number">149</span>, <span class="number">214</span>, <span class="number">84</span>, <span class="number">110</span>, <span class="number">129</span>, <span class="number">239</span>, <span class="number">137</span>, <span class="number">216</span>, <span class="number">229</span>, <span class="number">100</span>, <span class="number">150</span>, <span class="number">24</span>, <span class="number">73</span>, <span class="number">235</span>, <span class="number">40</span>, <span class="number">200</span>, <span class="number">2</span>, <span class="number">31</span>, <span class="number">120</span>, <span class="number">178</span>, <span class="number">36</span>, <span class="number">86</span>, <span class="number">160</span>, <span class="number">161</span>, <span class="number">251</span>, <span class="number">220</span>, <span class="number">45</span>, <span class="number">176</span>, <span class="number">238</span>, <span class="number">154</span>, <span class="number">194</span>, <span class="number">1</span>]]</span><br><span class="line">    chain29 = [[<span class="number">29</span>, <span class="number">131</span>, <span class="number">143</span>, <span class="number">64</span>, <span class="number">102</span>, <span class="number">147</span>, <span class="number">77</span>, <span class="number">92</span>, <span class="number">109</span>, <span class="number">34</span>, <span class="number">56</span>, <span class="number">162</span>, <span class="number">140</span>, <span class="number">205</span>, <span class="number">23</span>, <span class="number">124</span>, <span class="number">96</span>, <span class="number">232</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">18</span>, <span class="number">123</span>, <span class="number">234</span>, <span class="number">252</span>, <span class="number">112</span>, <span class="number">125</span>, <span class="number">83</span>, <span class="number">93</span>, <span class="number">4</span>],[<span class="number">113</span>, <span class="number">155</span>, <span class="number">79</span>, <span class="number">121</span>, <span class="number">204</span>, <span class="number">99</span>, <span class="number">187</span>, <span class="number">163</span>, <span class="number">152</span>, <span class="number">142</span>, <span class="number">243</span>, <span class="number">202</span>, <span class="number">182</span>, <span class="number">89</span>, <span class="number">174</span>, <span class="number">145</span>, <span class="number">52</span>, <span class="number">209</span>, <span class="number">233</span>, <span class="number">242</span>, <span class="number">19</span>, <span class="number">158</span>, <span class="number">173</span>, <span class="number">94</span>, <span class="number">217</span>, <span class="number">133</span>, <span class="number">85</span>, <span class="number">17</span>, <span class="number">7</span>]]</span><br><span class="line">    chain20 = [[<span class="number">6</span>, <span class="number">115</span>, <span class="number">168</span>, <span class="number">114</span>, <span class="number">41</span>, <span class="number">190</span>, <span class="number">127</span>, <span class="number">35</span>, <span class="number">228</span>, <span class="number">88</span>, <span class="number">53</span>, <span class="number">107</span>, <span class="number">175</span>, <span class="number">47</span>, <span class="number">148</span>, <span class="number">21</span>, <span class="number">5</span>, <span class="number">199</span>, <span class="number">61</span>, <span class="number">255</span>],[<span class="number">108</span>, <span class="number">166</span>, <span class="number">210</span>, <span class="number">28</span>, <span class="number">186</span>, <span class="number">119</span>, <span class="number">213</span>, <span class="number">165</span>, <span class="number">184</span>, <span class="number">122</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">82</span>, <span class="number">48</span>, <span class="number">16</span>, <span class="number">185</span>, <span class="number">180</span>, <span class="number">12</span>, <span class="number">192</span>, <span class="number">248</span>]]</span><br><span class="line">    chain9 = [[<span class="number">68</span>, <span class="number">218</span>, <span class="number">188</span>, <span class="number">117</span>, <span class="number">101</span>, <span class="number">103</span>, <span class="number">183</span>, <span class="number">222</span>, <span class="number">230</span>],[<span class="number">39</span>, <span class="number">196</span>, <span class="number">70</span>, <span class="number">66</span>, <span class="number">128</span>, <span class="number">75</span>, <span class="number">208</span>, <span class="number">116</span>, <span class="number">231</span>]]</span><br><span class="line">    chain4 = [[<span class="number">179</span>, <span class="number">198</span>, <span class="number">144</span>, <span class="number">22</span>],[<span class="number">171</span>, <span class="number">250</span>, <span class="number">118</span>, <span class="number">49</span>]]</span><br><span class="line">    chain3 = [[<span class="number">105</span>, <span class="number">247</span>, <span class="number">87</span>]]</span><br><span class="line"></span><br><span class="line">    <span class="comment">#p1 : 191 -&gt; 191</span></span><br><span class="line">    locdic = &#123;&#125;</span><br><span class="line">    locdic[<span class="number">191</span>] = <span class="number">191</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#chain3</span></span><br><span class="line">    chain3r = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        chain3r[<span class="number">2</span>*i%<span class="number">3</span>] = chain3[<span class="number">0</span>][i]</span><br><span class="line">    <span class="comment">#添加入位置字典</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        locdic[chain3r[i]] = chain3r[(i+<span class="number">1</span>)%<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">#处理偶环插入</span></span><br><span class="line">    <span class="comment">#chain4</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="comment">#造一个副本</span></span><br><span class="line">        locdic1 = locdic</span><br><span class="line">        chain4r = [<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)]</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            <span class="keyword">if</span>(j % <span class="number">2</span> == <span class="number">0</span>):</span><br><span class="line">                chain4r[j] = chain4[<span class="number">0</span>][j//<span class="number">2</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                chain4r[j] = chain4[<span class="number">1</span>][(j//<span class="number">2</span> + i) % <span class="number">4</span>] </span><br><span class="line">        <span class="comment">#添加入位置字典</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            locdic1[chain4r[i]] = chain4r[(i+<span class="number">1</span>)%<span class="number">8</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">#chain9</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">            <span class="comment">#造一个副本</span></span><br><span class="line">            locdic2 = locdic1</span><br><span class="line">            chain18r = [<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">118</span>)]</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">                <span class="keyword">if</span>(j % <span class="number">2</span> == <span class="number">0</span>):</span><br><span class="line">                    chain18r[j] = chain9[<span class="number">0</span>][j//<span class="number">2</span>]</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    chain18r[j] = chain9[<span class="number">1</span>][(j//<span class="number">2</span> + i) % <span class="number">9</span>] </span><br><span class="line">            <span class="comment">#添加入位置字典</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">                locdic2[chain18r[i]] = chain18r[(i+<span class="number">1</span>)%<span class="number">18</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment">#chain20</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">20</span>):</span><br><span class="line">                <span class="comment">#造一个副本</span></span><br><span class="line">                locdic3 = locdic2</span><br><span class="line">                chain40r = [<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>)]</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">                    <span class="keyword">if</span>(j % <span class="number">2</span> == <span class="number">0</span>):</span><br><span class="line">                        chain40r[j] = chain20[<span class="number">0</span>][j//<span class="number">2</span>]</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        chain40r[j] = chain20[<span class="number">1</span>][(j//<span class="number">2</span> + i) % <span class="number">20</span>] </span><br><span class="line">                <span class="comment">#添加入位置字典</span></span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">                    locdic3[chain40r[i]] = chain40r[(i+<span class="number">1</span>)%<span class="number">40</span>]</span><br><span class="line">                </span><br><span class="line"></span><br><span class="line">                <span class="comment">#chain29</span></span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">29</span>):</span><br><span class="line">                    <span class="comment">#造一个副本</span></span><br><span class="line">                    locdic4 = locdic3</span><br><span class="line">                    chain58r = [<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">58</span>)]</span><br><span class="line">                    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">58</span>):</span><br><span class="line">                        <span class="keyword">if</span>(j % <span class="number">2</span> == <span class="number">0</span>):</span><br><span class="line">                            chain58r[j] = chain29[<span class="number">0</span>][j//<span class="number">2</span>]</span><br><span class="line">                        <span class="keyword">else</span>:</span><br><span class="line">                            chain58r[j] = chain29[<span class="number">1</span>][(j//<span class="number">2</span> + i) % <span class="number">29</span>] </span><br><span class="line">                    <span class="comment">#添加入位置字典</span></span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">58</span>):</span><br><span class="line">                        locdic4[chain58r[i]] = chain58r[(i+<span class="number">1</span>)%<span class="number">58</span>]</span><br><span class="line">                    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    <span class="comment">#chain64</span></span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">                        <span class="comment">#造一个副本</span></span><br><span class="line">                        locdic5 = locdic4</span><br><span class="line">                        chain128r = [<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>)]</span><br><span class="line">                        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">                            <span class="keyword">if</span>(j % <span class="number">2</span> == <span class="number">0</span>):</span><br><span class="line">                                chain128r[j] = chain64[<span class="number">0</span>][j//<span class="number">2</span>]</span><br><span class="line">                            <span class="keyword">else</span>:</span><br><span class="line">                                chain128r[j] = chain64[<span class="number">1</span>][(j//<span class="number">2</span> + i) % <span class="number">64</span>] </span><br><span class="line">                        <span class="comment">#添加入位置字典</span></span><br><span class="line">                        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">                            locdic5[chain128r[i]] = chain128r[(i+<span class="number">1</span>)%<span class="number">128</span>]</span><br><span class="line">                        </span><br><span class="line">                        P = [locdic5[j] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)]</span><br><span class="line">                        tt = [<span class="number">0</span> <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)]</span><br><span class="line">                        <span class="keyword">for</span> op <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">                            tt[op] = P[P[op]]</span><br><span class="line">                        <span class="keyword">if</span>(tt != P2):</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">&quot;Bad!&quot;</span>)</span><br><span class="line">                        P = [locdic5[j]+<span class="number">1</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)]  </span><br><span class="line">                        check = hashlib.sha512(<span class="built_in">str</span>(P).encode()).hexdigest()</span><br><span class="line">                        <span class="keyword">if</span>(check == <span class="string">&quot;91881f508f08fbafec1a6879fc3a1f215135c94c78f03fae8534d54dc05bd4a122a4e4508d32b9e02be08fbbb42a9e3335fc433c20e2da2e012d11b7324f6952&quot;</span>):</span><br><span class="line">                            <span class="built_in">print</span>(P)</span><br><span class="line">                            exit()</span><br><span class="line"></span><br><span class="line">mask = Per([<span class="number">87</span>, <span class="number">245</span>, <span class="number">52</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">166</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">154</span>, <span class="number">38</span>, <span class="number">221</span>, <span class="number">36</span>, <span class="number">20</span>, <span class="number">16</span>, <span class="number">170</span>, <span class="number">42</span>, <span class="number">94</span>, <span class="number">159</span>, <span class="number">19</span>, <span class="number">246</span>, <span class="number">214</span>, <span class="number">251</span>, <span class="number">146</span>, <span class="number">135</span>, <span class="number">243</span>, <span class="number">216</span>, <span class="number">81</span>, <span class="number">48</span>, <span class="number">156</span>, <span class="number">190</span>, <span class="number">59</span>, <span class="number">75</span>, <span class="number">215</span>, <span class="number">244</span>, <span class="number">193</span>, <span class="number">1</span>, <span class="number">171</span>, <span class="number">254</span>, <span class="number">118</span>, <span class="number">70</span>, <span class="number">186</span>, <span class="number">33</span>, <span class="number">11</span>, <span class="number">25</span>, <span class="number">66</span>, <span class="number">182</span>, <span class="number">187</span>, <span class="number">115</span>, <span class="number">145</span>, <span class="number">140</span>, <span class="number">32</span>, <span class="number">97</span>, <span class="number">167</span>, <span class="number">63</span>, <span class="number">168</span>, <span class="number">203</span>, <span class="number">242</span>, <span class="number">121</span>, <span class="number">208</span>, <span class="number">111</span>, <span class="number">123</span>, <span class="number">31</span>, <span class="number">252</span>, <span class="number">205</span>, <span class="number">177</span>, <span class="number">184</span>, <span class="number">240</span>, <span class="number">117</span>, <span class="number">201</span>, <span class="number">104</span>, <span class="number">96</span>, <span class="number">130</span>, <span class="number">99</span>, <span class="number">56</span>, <span class="number">231</span>, <span class="number">2</span>, <span class="number">164</span>, <span class="number">85</span>, <span class="number">144</span>, <span class="number">60</span>, <span class="number">161</span>, <span class="number">169</span>, <span class="number">18</span>, <span class="number">61</span>, <span class="number">84</span>, <span class="number">82</span>, <span class="number">248</span>, <span class="number">109</span>, <span class="number">206</span>, <span class="number">41</span>, <span class="number">15</span>, <span class="number">153</span>, <span class="number">8</span>, <span class="number">253</span>, <span class="number">28</span>, <span class="number">210</span>, <span class="number">151</span>, <span class="number">236</span>, <span class="number">148</span>, <span class="number">98</span>, <span class="number">71</span>, <span class="number">100</span>, <span class="number">67</span>, <span class="number">155</span>, <span class="number">88</span>, <span class="number">250</span>, <span class="number">211</span>, <span class="number">54</span>, <span class="number">143</span>, <span class="number">73</span>, <span class="number">58</span>, <span class="number">134</span>, <span class="number">30</span>, <span class="number">17</span>, <span class="number">83</span>, <span class="number">219</span>, <span class="number">197</span>, <span class="number">199</span>, <span class="number">22</span>, <span class="number">178</span>, <span class="number">65</span>, <span class="number">256</span>, <span class="number">174</span>, <span class="number">53</span>, <span class="number">86</span>, <span class="number">21</span>, <span class="number">13</span>, <span class="number">223</span>, <span class="number">68</span>, <span class="number">3</span>, <span class="number">80</span>, <span class="number">101</span>, <span class="number">126</span>, <span class="number">74</span>, <span class="number">127</span>, <span class="number">162</span>, <span class="number">196</span>, <span class="number">92</span>, <span class="number">173</span>, <span class="number">90</span>, <span class="number">220</span>, <span class="number">35</span>, <span class="number">122</span>, <span class="number">172</span>, <span class="number">125</span>, <span class="number">107</span>, <span class="number">188</span>, <span class="number">120</span>, <span class="number">34</span>, <span class="number">45</span>, <span class="number">46</span>, <span class="number">110</span>, <span class="number">147</span>, <span class="number">228</span>, <span class="number">132</span>, <span class="number">138</span>, <span class="number">39</span>, <span class="number">124</span>, <span class="number">43</span>, <span class="number">137</span>, <span class="number">64</span>, <span class="number">183</span>, <span class="number">93</span>, <span class="number">160</span>, <span class="number">200</span>, <span class="number">108</span>, <span class="number">142</span>, <span class="number">49</span>, <span class="number">136</span>, <span class="number">27</span>, <span class="number">23</span>, <span class="number">202</span>, <span class="number">235</span>, <span class="number">24</span>, <span class="number">29</span>, <span class="number">238</span>, <span class="number">179</span>, <span class="number">241</span>, <span class="number">119</span>, <span class="number">128</span>, <span class="number">165</span>, <span class="number">141</span>, <span class="number">129</span>, <span class="number">62</span>, <span class="number">191</span>, <span class="number">149</span>, <span class="number">78</span>, <span class="number">40</span>, <span class="number">222</span>, <span class="number">181</span>, <span class="number">192</span>, <span class="number">229</span>, <span class="number">158</span>, <span class="number">77</span>, <span class="number">217</span>, <span class="number">102</span>, <span class="number">47</span>, <span class="number">50</span>, <span class="number">185</span>, <span class="number">131</span>, <span class="number">139</span>, <span class="number">163</span>, <span class="number">247</span>, <span class="number">103</span>, <span class="number">175</span>, <span class="number">230</span>, <span class="number">226</span>, <span class="number">69</span>, <span class="number">233</span>, <span class="number">176</span>, <span class="number">44</span>, <span class="number">51</span>, <span class="number">6</span>, <span class="number">79</span>, <span class="number">255</span>, <span class="number">207</span>, <span class="number">113</span>, <span class="number">232</span>, <span class="number">55</span>, <span class="number">152</span>, <span class="number">112</span>, <span class="number">76</span>, <span class="number">204</span>, <span class="number">198</span>, <span class="number">10</span>, <span class="number">212</span>, <span class="number">195</span>, <span class="number">249</span>, <span class="number">133</span>, <span class="number">209</span>, <span class="number">189</span>, <span class="number">234</span>, <span class="number">26</span>, <span class="number">95</span>, <span class="number">91</span>, <span class="number">213</span>, <span class="number">239</span>, <span class="number">105</span>, <span class="number">157</span>, <span class="number">37</span>, <span class="number">227</span>, <span class="number">14</span>, <span class="number">57</span>, <span class="number">237</span>, <span class="number">225</span>, <span class="number">194</span>, <span class="number">106</span>, <span class="number">89</span>, <span class="number">150</span>, <span class="number">180</span>, <span class="number">12</span>, <span class="number">218</span>, <span class="number">72</span>, <span class="number">224</span>, <span class="number">9</span>])</span><br><span class="line">mul = Per([<span class="number">114</span>, <span class="number">189</span>, <span class="number">92</span>, <span class="number">56</span>, <span class="number">252</span>, <span class="number">161</span>, <span class="number">202</span>, <span class="number">250</span>, <span class="number">131</span>, <span class="number">9</span>, <span class="number">111</span>, <span class="number">226</span>, <span class="number">223</span>, <span class="number">24</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">99</span>, <span class="number">208</span>, <span class="number">195</span>, <span class="number">216</span>, <span class="number">141</span>, <span class="number">116</span>, <span class="number">167</span>, <span class="number">34</span>, <span class="number">5</span>, <span class="number">129</span>, <span class="number">15</span>, <span class="number">158</span>, <span class="number">178</span>, <span class="number">197</span>, <span class="number">4</span>, <span class="number">187</span>, <span class="number">27</span>, <span class="number">200</span>, <span class="number">144</span>, <span class="number">76</span>, <span class="number">74</span>, <span class="number">154</span>, <span class="number">86</span>, <span class="number">249</span>, <span class="number">93</span>, <span class="number">112</span>, <span class="number">46</span>, <span class="number">104</span>, <span class="number">25</span>, <span class="number">248</span>, <span class="number">40</span>, <span class="number">225</span>, <span class="number">38</span>, <span class="number">98</span>, <span class="number">186</span>, <span class="number">169</span>, <span class="number">64</span>, <span class="number">118</span>, <span class="number">33</span>, <span class="number">88</span>, <span class="number">26</span>, <span class="number">106</span>, <span class="number">183</span>, <span class="number">43</span>, <span class="number">201</span>, <span class="number">198</span>, <span class="number">242</span>, <span class="number">135</span>, <span class="number">110</span>, <span class="number">218</span>, <span class="number">244</span>, <span class="number">120</span>, <span class="number">83</span>, <span class="number">212</span>, <span class="number">192</span>, <span class="number">185</span>, <span class="number">148</span>, <span class="number">142</span>, <span class="number">11</span>, <span class="number">45</span>, <span class="number">232</span>, <span class="number">107</span>, <span class="number">18</span>, <span class="number">170</span>, <span class="number">60</span>, <span class="number">130</span>, <span class="number">247</span>, <span class="number">67</span>, <span class="number">65</span>, <span class="number">211</span>, <span class="number">182</span>, <span class="number">213</span>, <span class="number">134</span>, <span class="number">254</span>, <span class="number">70</span>, <span class="number">191</span>, <span class="number">210</span>, <span class="number">176</span>, <span class="number">145</span>, <span class="number">217</span>, <span class="number">82</span>, <span class="number">229</span>, <span class="number">125</span>, <span class="number">193</span>, <span class="number">155</span>, <span class="number">41</span>, <span class="number">113</span>, <span class="number">103</span>, <span class="number">49</span>, <span class="number">231</span>, <span class="number">133</span>, <span class="number">75</span>, <span class="number">109</span>, <span class="number">238</span>, <span class="number">126</span>, <span class="number">245</span>, <span class="number">163</span>, <span class="number">233</span>, <span class="number">227</span>, <span class="number">181</span>, <span class="number">51</span>, <span class="number">12</span>, <span class="number">143</span>, <span class="number">234</span>, <span class="number">239</span>, <span class="number">59</span>, <span class="number">240</span>, <span class="number">209</span>, <span class="number">42</span>, <span class="number">205</span>, <span class="number">230</span>, <span class="number">253</span>, <span class="number">203</span>, <span class="number">219</span>, <span class="number">23</span>, <span class="number">136</span>, <span class="number">32</span>, <span class="number">87</span>, <span class="number">102</span>, <span class="number">94</span>, <span class="number">85</span>, <span class="number">62</span>, <span class="number">172</span>, <span class="number">236</span>, <span class="number">124</span>, <span class="number">100</span>, <span class="number">256</span>, <span class="number">196</span>, <span class="number">50</span>, <span class="number">101</span>, <span class="number">206</span>, <span class="number">150</span>, <span class="number">89</span>, <span class="number">29</span>, <span class="number">61</span>, <span class="number">69</span>, <span class="number">246</span>, <span class="number">237</span>, <span class="number">16</span>, <span class="number">37</span>, <span class="number">184</span>, <span class="number">90</span>, <span class="number">162</span>, <span class="number">22</span>, <span class="number">36</span>, <span class="number">10</span>, <span class="number">31</span>, <span class="number">52</span>, <span class="number">190</span>, <span class="number">17</span>, <span class="number">55</span>, <span class="number">115</span>, <span class="number">251</span>, <span class="number">77</span>, <span class="number">214</span>, <span class="number">122</span>, <span class="number">1</span>, <span class="number">255</span>, <span class="number">151</span>, <span class="number">157</span>, <span class="number">241</span>, <span class="number">224</span>, <span class="number">3</span>, <span class="number">44</span>, <span class="number">48</span>, <span class="number">175</span>, <span class="number">194</span>, <span class="number">138</span>, <span class="number">179</span>, <span class="number">159</span>, <span class="number">160</span>, <span class="number">53</span>, <span class="number">80</span>, <span class="number">73</span>, <span class="number">8</span>, <span class="number">35</span>, <span class="number">156</span>, <span class="number">117</span>, <span class="number">58</span>, <span class="number">140</span>, <span class="number">221</span>, <span class="number">180</span>, <span class="number">72</span>, <span class="number">123</span>, <span class="number">147</span>, <span class="number">95</span>, <span class="number">228</span>, <span class="number">97</span>, <span class="number">71</span>, <span class="number">204</span>, <span class="number">39</span>, <span class="number">149</span>, <span class="number">2</span>, <span class="number">19</span>, <span class="number">173</span>, <span class="number">139</span>, <span class="number">146</span>, <span class="number">54</span>, <span class="number">96</span>, <span class="number">220</span>, <span class="number">79</span>, <span class="number">66</span>, <span class="number">57</span>, <span class="number">127</span>, <span class="number">243</span>, <span class="number">188</span>, <span class="number">165</span>, <span class="number">47</span>, <span class="number">235</span>, <span class="number">119</span>, <span class="number">7</span>, <span class="number">199</span>, <span class="number">30</span>, <span class="number">177</span>, <span class="number">63</span>, <span class="number">78</span>, <span class="number">105</span>, <span class="number">207</span>, <span class="number">153</span>, <span class="number">28</span>, <span class="number">132</span>, <span class="number">168</span>, <span class="number">84</span>, <span class="number">166</span>, <span class="number">171</span>, <span class="number">108</span>, <span class="number">21</span>, <span class="number">215</span>, <span class="number">164</span>, <span class="number">174</span>, <span class="number">121</span>, <span class="number">128</span>, <span class="number">91</span>, <span class="number">68</span>, <span class="number">20</span>, <span class="number">222</span>, <span class="number">81</span>, <span class="number">137</span>, <span class="number">13</span>, <span class="number">152</span>])</span><br><span class="line">temp = hashlib.sha512(<span class="built_in">str</span>(mask * mul).encode()).hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#part2 get flag</span></span><br><span class="line">q,h = (<span class="number">18172777775303192159727657832771688633216215598877965158949208820296023901084764760222881725262986702478735713462424007788959106272018399708244805316198640706589775789778454299532286932532522325791791312289833643271330941006206604894333175027113622330874626579800679513666624938603337561309816936129926352661091319564303604867093095700819543458178063985869752612663625872468653351930763784372987474747809415652595112648835928004343413910248386752899307068129610089712815257479121368111201632430687614657790581254030567845143865728745079851692195657361359959987504557281840928862881924309178036648485188421874327022341</span>, <span class="number">392638098592460228418508462226385074690422702429214284385732305774317959159895775092251586043956914155602546821559652111400517952111932579557319610857122515237088379905875982863782386657213421074126519458271560586678974481499715849371311979995450766948182818105567819897007307737370051632369390705725712223883589110699340619034611462216676501782567065261228166297471411589579035544131060706331012337024260046692910523900152236991203944000276133732456285962825434272960749340504092014446362862600803570698206213069473248298100863523331832957430305801141935737006263947843411592717969844892834332104365594346376118846</span>)</span><br><span class="line">c=<span class="number">4605640253217003331334964510174592254013178259349707648547335080743845433538772185582533054930473399495034133342299169373655297635370654237814250924077096784419954824350471683280656146814012837777204413608581553756866045890045788846665715321962704221105416079118007959490372975054302058194463432668018727266982561600329852084442818715440190956213811944269576719501924787366260795121132011879061730892865163591549129768412164655406373350666250339077746317309673325358941772202710386313434421388779073207650619564862431076222163014501544922959835509589742031678624743915535537547452120771609556012990490607104696154771</span></span><br><span class="line">L = Matrix(ZZ, [[<span class="number">1</span>, h],</span><br><span class="line">                [<span class="number">0</span>, q]])</span><br><span class="line">f, g = L.LLL()[<span class="number">0</span>]</span><br><span class="line">f,g = <span class="built_in">abs</span>(f),<span class="built_in">abs</span>(g)</span><br><span class="line">m = (f*c) % q % g * inverse(f, g) % g</span><br><span class="line"></span><br><span class="line">flag = long_to_bytes(m ^^ <span class="built_in">int</span>(temp,<span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ISCTF&#123;You_can_very_good_at_permutation_and_lattice_base&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="Beyond-hex-meet-heptadecimal"><a href="#Beyond-hex-meet-heptadecimal" class="headerlink" title="Beyond hex,meet heptadecimal"></a>Beyond hex,meet heptadecimal</h3><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ID71QI6UV7NRV5ULVJDJ1PTVJDVINVBQUNT</span><br></pre></td></tr></table></figure>
<p>说实话，不会。到时候偷看一下其他师傅的wp再补。</p>
<p><br></p>
<p><br></p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>糖醋小鸡块
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://tangcuxiaojikuai.xyz/post/1b5eb6c5.html" title="2023-ISCTF-wp-crypto">https://tangcuxiaojikuai.xyz/post/1b5eb6c5.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sacreative/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SACREATIVE</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/post/6f77578c.html" rel="prev" title="2023-极客大挑战-wp-crypto">
      <i class="fa fa-chevron-left"></i> 2023-极客大挑战-wp-crypto
    </a></div>
      <div class="post-nav-item">
    <a href="/post/7be264c5.html" rel="next" title="2023-NBCTF-wp-crypto">
      2023-NBCTF-wp-crypto <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%B9%E9%87%8C%E5%A4%B9%E6%B0%94"><span class="nav-number">1.</span> <span class="nav-text">夹里夹气</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#signin"><span class="nav-number">2.</span> <span class="nav-text">signin</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1zRSA"><span class="nav-number">3.</span> <span class="nav-text">1zRSA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EasyAES"><span class="nav-number">4.</span> <span class="nav-text">EasyAES</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%83%E4%B8%83%E7%9A%84%E6%AC%A7%E6%8B%89"><span class="nav-number">5.</span> <span class="nav-text">七七的欧拉</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ezRSA"><span class="nav-number">6.</span> <span class="nav-text">ezRSA</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#step1"><span class="nav-number">6.1.</span> <span class="nav-text">step1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#step2"><span class="nav-number">6.2.</span> <span class="nav-text">step2</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1%E3%80%81leak1"><span class="nav-number">6.2.1.</span> <span class="nav-text">1、leak1</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2%E3%80%81LCG"><span class="nav-number">6.2.2.</span> <span class="nav-text">2、LCG</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3%E3%80%81%E6%B1%82key"><span class="nav-number">6.2.3.</span> <span class="nav-text">3、求key</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#baby-group"><span class="nav-number">7.</span> <span class="nav-text">baby_group</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Beyond-hex-meet-heptadecimal"><span class="nav-number">8.</span> <span class="nav-text">Beyond hex,meet heptadecimal</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="糖醋小鸡块"
      src="/images/image.png">
  <p class="site-author-name" itemprop="name">糖醋小鸡块</p>
  <div class="site-description" itemprop="description">"追风赶月莫停留，平芜尽处是春山"</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">54</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="/1142381085@qq.com" title="E-Mail → 1142381085@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/6394335993" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;6394335993" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">糖醋小鸡块</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>
  <script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'UPEMA7DyYbIIEyOW72ohgytU-gzGzoHsz',
      appKey     : 'M7rXAfeP3JOslroay2n0Jv2R',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
<!-- 引入jQuery -->
<script type="text/javascript" src="//libs.baidu.com/jquery/1.8.3/jquery.min.js"></script>
<!-- 雪花特效2 -->
<script type="text/javascript" src="/js/snow2.js"></script>
