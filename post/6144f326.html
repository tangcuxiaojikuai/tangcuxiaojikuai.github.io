<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon_small.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="RnN18ZogmZl_dLVpxZ6y8kjKL73Mu9VLVEkw9d3qrq0" />
  <meta name="msvalidate.01" content="DC3050AD55F30DDF75AAB78517714910" />
  <meta name="baidu-site-verification" content="codeva-PPofu3dNxe" />

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-loading-bar.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"tangcuxiaojikuai.xyz","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="包含四个赛题的题解。">
<meta property="og:type" content="article">
<meta property="og:title" content="2023-DASCTFX0psu3十一月挑战赛-wp-crypto">
<meta property="og:url" content="https://tangcuxiaojikuai.xyz/post/6144f326.html">
<meta property="og:site_name" content="糖醋小鸡块的blog">
<meta property="og:description" content="包含四个赛题的题解。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-11-25T07:06:18.000Z">
<meta property="article:modified_time" content="2023-11-26T04:15:06.000Z">
<meta property="article:author" content="糖醋小鸡块">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://tangcuxiaojikuai.xyz/post/6144f326.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>2023-DASCTFX0psu3十一月挑战赛-wp-crypto | 糖醋小鸡块的blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">糖醋小鸡块的blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-友链">

    <a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tangcuxiaojikuai.xyz/post/6144f326.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/image.png">
      <meta itemprop="name" content="糖醋小鸡块">
      <meta itemprop="description" content=""追风赶月莫停留，平芜尽处是春山"">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="糖醋小鸡块的blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2023-DASCTFX0psu3十一月挑战赛-wp-crypto
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-11-25 15:06:18" itemprop="dateCreated datePublished" datetime="2023-11-25T15:06:18+08:00">2023-11-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-11-26 12:15:06" itemprop="dateModified" datetime="2023-11-26T12:15:06+08:00">2023-11-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/wp-crypto/" itemprop="url" rel="index"><span itemprop="name">wp-crypto</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/post/6144f326.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/post/6144f326.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>包含四个赛题的题解。</p>
<span id="more"></span>
<h3 id="GeneratePrime"><a href="#GeneratePrime" class="headerlink" title="GeneratePrime"></a>GeneratePrime</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">尝试分解一下素数吧</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, isPrime, bytes_to_long</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> 0psu3_The_best(sz, d):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = getPrime(sz)</span><br><span class="line">        pp = <span class="built_in">sum</span>([p**i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(d)])</span><br><span class="line">        <span class="keyword">if</span> isPrime(pp):</span><br><span class="line">            <span class="keyword">return</span> p, pp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p, q = 0psu3_The_best(<span class="number">512</span>, <span class="number">5</span>)</span><br><span class="line">r = getPrime(<span class="number">512</span> * <span class="number">5</span>)</span><br><span class="line">n = p * q * r</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">flag=<span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>).read().strip()</span><br><span class="line">flag1=flag+os.urandom(<span class="number">128</span>)</span><br><span class="line">m=bytes_to_long(flag1)</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;e = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#n=43090231453250894711427929679917165532091051269639380881822679198388872373018031295429558758883298138388596507242928145888959963579111847255588834248367032580980272245414738073179172684104908272069503607376171584936239696444309039211273376010193165083254209608051430794825261116490356392215410064858020176711199543381037420111454942356936721487016187240237683725310306748046587503625096246489043270381153251813360521583717685413070481576320194446237522118380283335294528606720928637529817170809666802598938788405154468683850385277659812316577873886708164549255359514776884765904417881419804464020855420288884972204146588152412816874161445668955639456202226751519881834234916642218078966066353317917939418964763844067220460513388433020071277477619189495465483910271310025371745344364984826481983188861624474015117761898377237745775289039922285111681410319016537270412509750339539020876501534842403407208957382830000761065368861209033791387480377889838737241326116532852335478193204425626487166234964754732945953080086117315162916374952094149599597509405176646068341218684523765974759907645226607364627690026025662221036766148813918691578120023886400197652148214238256715089883892069133754778609710846757189987335827693169644541734443763194942694587436469448973201513131503797898892822373949177030567791519349220158287318717788746060997955057747930375117780320371517616412423571775682868481089431670802944047375824503353609019686495670630728618082254293585479431369645935654024149490741245953271830453426444847467908952699660750809490650479987</span></span><br><span class="line"><span class="comment">#e=65537</span></span><br><span class="line"><span class="comment">#c=30862228874892553476569860337345503267926249096036551213683005116620750680365154103242717714230966827288361499342464202425467642950081816675486231250411347472976482409360391136808439034217688010072648722396312121758844966972323513456884732046270240934002095706243044210312663525491282667971502534420245427643076262414036655243117610886157895994101178663474990136516153062956803591842233732498519246731337518545018734984319536536205092573418457928952414660837594265802406473201400259189950484841504227372735345451459452313825309333631615286962304963039625162366186574440146535361888708570569938418676320446653266676364765870547213167058713058609788316647593834008151805692510044158607162858906528913516242904419457446211348504248317409844426309455978985314882123424453618672960876022996245213882467954521212481418830104602302179759479012618982228223244131619557639469872139485197176384683400796204681045965981417650462297978265085323342772310690638049411549216990505001950512428646871875659468885490055363436412364532718888124906227240501145227269727887236864060558999336443165765870556727793253297515155026234234422303238380776900105115890363548589834345888430695886678231459920101695996112312269637459823479947618045447071359886515163416153117176539752947700226596291435270282598638974889205601333097978743387412651687356072223691445472690647184292120882095587563356691450107194982597794937293154289560470269606300576216128045797481404606810315677962659136641943747123985144899464108823536597185386155005111274476874957827391438859327653936</span></span><br></pre></td></tr></table></figure>
<p>题目是根据ImaginaryCTF 2023的sus题目改的，具体推导可以见我这一篇文章：</p>
<p><a href="https://tangcuxiaojikuai.xyz/post/ea445335.html">Crypto趣题-RSA(一) | 糖醋小鸡块的blog (tangcuxiaojikuai.xyz)</a></p>
<p>在sus一题与本题中，q分别为：</p>
<script type="math/tex; mode=display">
q = 1 + p + p^2</script><script type="math/tex; mode=display">
q = 1 + p + p^2 + p^3 + p^4</script><p>而这其实并没有多大区别，因为他们分别满足如下因式分解：</p>
<script type="math/tex; mode=display">
p^3-1 = (p-1)(1 + p + p^2) = (p-1)q</script><script type="math/tex; mode=display">
p^5 - 1 = (p-1)(1 + p + p^2 + p^3 + p^4) = (p-1)q</script><p>所以推导过程可以说是完全一样的，参考上面那篇文章即可，而这个题目本身我觉得是非常有意思的，所以我强烈推荐弄明白原理。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n=<span class="number">43090231453250894711427929679917165532091051269639380881822679198388872373018031295429558758883298138388596507242928145888959963579111847255588834248367032580980272245414738073179172684104908272069503607376171584936239696444309039211273376010193165083254209608051430794825261116490356392215410064858020176711199543381037420111454942356936721487016187240237683725310306748046587503625096246489043270381153251813360521583717685413070481576320194446237522118380283335294528606720928637529817170809666802598938788405154468683850385277659812316577873886708164549255359514776884765904417881419804464020855420288884972204146588152412816874161445668955639456202226751519881834234916642218078966066353317917939418964763844067220460513388433020071277477619189495465483910271310025371745344364984826481983188861624474015117761898377237745775289039922285111681410319016537270412509750339539020876501534842403407208957382830000761065368861209033791387480377889838737241326116532852335478193204425626487166234964754732945953080086117315162916374952094149599597509405176646068341218684523765974759907645226607364627690026025662221036766148813918691578120023886400197652148214238256715089883892069133754778609710846757189987335827693169644541734443763194942694587436469448973201513131503797898892822373949177030567791519349220158287318717788746060997955057747930375117780320371517616412423571775682868481089431670802944047375824503353609019686495670630728618082254293585479431369645935654024149490741245953271830453426444847467908952699660750809490650479987</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">c=<span class="number">30862228874892553476569860337345503267926249096036551213683005116620750680365154103242717714230966827288361499342464202425467642950081816675486231250411347472976482409360391136808439034217688010072648722396312121758844966972323513456884732046270240934002095706243044210312663525491282667971502534420245427643076262414036655243117610886157895994101178663474990136516153062956803591842233732498519246731337518545018734984319536536205092573418457928952414660837594265802406473201400259189950484841504227372735345451459452313825309333631615286962304963039625162366186574440146535361888708570569938418676320446653266676364765870547213167058713058609788316647593834008151805692510044158607162858906528913516242904419457446211348504248317409844426309455978985314882123424453618672960876022996245213882467954521212481418830104602302179759479012618982228223244131619557639469872139485197176384683400796204681045965981417650462297978265085323342772310690638049411549216990505001950512428646871875659468885490055363436412364532718888124906227240501145227269727887236864060558999336443165765870556727793253297515155026234234422303238380776900105115890363548589834345888430695886678231459920101695996112312269637459823479947618045447071359886515163416153117176539752947700226596291435270282598638974889205601333097978743387412651687356072223691445472690647184292120882095587563356691450107194982597794937293154289560470269606300576216128045797481404606810315677962659136641943747123985144899464108823536597185386155005111274476874957827391438859327653936</span></span><br><span class="line">k = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">R = Zmod(n)[<span class="string">&quot;x&quot;</span>]</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    Q = R.quo(R.random_element(k))</span><br><span class="line">    pp = gcd(ZZ(<span class="built_in">list</span>(Q.random_element() ^ n)[<span class="number">1</span>]), n)</span><br><span class="line">    <span class="keyword">if</span> pp != <span class="number">1</span>:</span><br><span class="line">        qq = <span class="built_in">sum</span>([pp**i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k)])</span><br><span class="line">        rr = n // (pp * qq)</span><br><span class="line">        <span class="keyword">assert</span> n == pp * qq * rr</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">phi = (pp - <span class="number">1</span>) * (qq - <span class="number">1</span>) * (rr - <span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#DASCTF&#123;just_a_very_very_easy_task_with_your_talent_is_not&#125;</span></span><br></pre></td></tr></table></figure>
<p><br><br></p>
<h3 id="FindPrime"><a href="#FindPrime" class="headerlink" title="FindPrime"></a>FindPrime</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">利用你的所学知识看看这个素数有啥能分解的吧</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">P=getPrime(<span class="built_in">int</span>(<span class="number">512</span>))</span><br><span class="line">p_list=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">    q=getPrime(<span class="number">1024</span>)</span><br><span class="line">    r=getPrime(<span class="number">450</span>)</span><br><span class="line">    l=q*P+r</span><br><span class="line">    p_list.append(l)</span><br><span class="line">path1=<span class="string">&quot;D:/CTF题目\密码\出题1/&quot;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>,<span class="string">&#x27;w&#x27;</span>)<span class="keyword">as</span> f1:</span><br><span class="line">    <span class="keyword">for</span> val <span class="keyword">in</span> p_list:</span><br><span class="line">        f1.write(<span class="built_in">str</span>(val))</span><br><span class="line">        f1.write(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Q=getPrime(<span class="number">512</span>)</span><br><span class="line">N=P*Q</span><br><span class="line">e=e1*e2</span><br><span class="line">m=bytes_to_long(flag2)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,N)</span><br><span class="line"><span class="keyword">assert</span> m&lt;N</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;N=&quot;</span>,N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e=&quot;</span>,e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#N=68770027076980723946939075792572969610228738501865973895618044035550466673326811210718966610231582633896160130057212343512606374318082678735227998163020559923237005947682357783487924911009663067842443440348588088325506801639924926097944176357432282915587075930988972621730524537492705984723766652062305363027</span></span><br><span class="line"><span class="comment">#e=30899846873</span></span><br><span class="line"><span class="comment">#c=46935517038224473812546067305866276864169387205589347201858550096671613860700878462369638807831295923952343159795466895818221029692119135003812788250010552362110290387383510093277209478665971066986914981717774698233220968427990066291572377851164878122374241804989577737820368814455456808941766309324614067608</span></span><br></pre></td></tr></table></figure>
<p>output.txt：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">833477371577037248671393488796841448323259324097064076319628420817885469255000583369058481944985769427996156459681454706589776988919309994624061437098895355604275125815197436256702258179251584180213654099283298392635474661213568306075241588048132336078444076126820420463425993589637558750777268224105474567279804292533669526701194763687939785229766307504441712413449981891561774806156665751819904294472651269669748332928431198159353146128591296262185405972439546</span></span><br><span class="line"><span class="number">1417152335984227895861976535021216841448579442747465060823276117342707242036009501153174353498039264338222617085495976550068103477774948724127741741708784215760734847758354594318769717406990462644647262705257356458710337592960428524874926699201316728348581862499570079314933543886720367661160716082695676780397728399987054072186527533287843688129609522799869815936639832013954440499639010333786645953413907919333585387641086968778447914208830518647808481101744324</span></span><br><span class="line"><span class="number">825367446328428514387697995916336764546268230407927332717623008352471527800278723584639057096612354365560873809150001125278412400474409061202793883535179571174914202587885962179015715680607289928464406578658800580951213697647205960790337310924484411796444362107897902280992396479162688010814408461729223033123136202693070960903215433774294632728389327422670143968868682620853783857921514241013093770504123459537458692492751810710800714011831621269113360518146466</span></span><br><span class="line"><span class="number">1117038639337471846829376079962481193398932800977268229076827506371401256669800316726321224468793029294472485026921632948383102312056921521024306059345938460478459700466054808539783394230282753938588089881925678699530435751913189427180282771396540962548369034354743885813399454493710302493578739515264505177658100751453455496774147005531958801283461861649229880608818211044433598649395832661445740364729368315801371639810397211894031768657378216033361397549366256</span></span><br><span class="line"><span class="number">789053897304615315337175819738966271887736346682171450497097040086498239540377384986209739979046088390348561630505449064375395941971263831832121567291403546039845417362378013959087178137950071886621154078491546369789131036116261508976173752711978857719619406789313307878001096869325696238380891433568872331290007330722088030578583205858796182940602367954524757711316167615101597446309984571234377671932653365183502569671856918490864417200211766344072222998027822</span></span><br><span class="line"><span class="number">966501879970742600511208788258526900344376522075501649104033255633597034935664368131875660642155019813129246919011772829055632548744997359467600623938236900630865127499099427610462066513843467274429222012089690015994012152596196816130406746915460387848239967901760618640583349703983484157317741929002569740058587411590431911493390093995968210910735353154523490679129412378481195890371227907180147669889684430126196556931405955478955081021596778423861644605413220</span></span><br><span class="line"><span class="number">1016206715544805616785448447890465545186987897028556564304636789980188990657954923931006415294723182820924206335074345389566219429933493040648600433401610217090975900023234793427998610379251762559967019400728297780551725015583666086666516418087030343203101010021703209197523343693860658825737224551153658921423547727162107463031046748406971820610714074184196091161013509824451242098842170379050555049206021603159062400839577538179369013207264237775294267243450954</span></span><br><span class="line"><span class="number">1404676392176442693280296127342987494550957043392635386494042054010991321501621533741338727100112185013038167221974051488817482793170202879408486718454210845858736679832294483147175210110615257817394064543261586158156967750121198092580348602468647683129797260957074060274292680433931960236168813016297052791985451576121114558772154532080435223066720081665556076765698304139098057592135203163250240567852578238243023714328048303989363646868600166520437611843612270</span></span><br><span class="line"><span class="number">1059935376878480441729492697632030905525885607048323279059128530919559830128835302912470726619568501417529071921932168803344700381721474676777308027068110306949314839450395796653187838326332784828777724424199917441151240196726745672383847672313980284416050202584142927770763591075702102605031237345472147341910472151710788810979403340565238113975573870517570875437842746448994428058467668823003473072579180637652269984142354411576575917646079583753495367912839960</span></span><br><span class="line"><span class="number">1005093213315393709159231593860148335197371021667176710985282901155843124491374058148746111824100113560244085276326910991515846365967838636201323200445828413058675197551700929939472848246171263835605578862722270129746740782455909536537801517982606803080616613461318236425458449709297715347210050402550612702295502040273916918213837452195992544090277434980077570231118874818252862234141519024564669607765367582670314778517944498054666016737330861609379025113166836</span></span><br><span class="line"><span class="number">1150913477976579544984692837814166801393210199102413166293610666053242980149249488331633577850447467218914394901012296132704736775926309440233035822531930858429680280993777507984535655970890119429824895156920369805049543936219472734491318222718258425842787941873957417289878296856278156476011010315934177086137347319511037491948179006778146455912868593940481149704105685035076511248645882008350000735358430584727064929886184048893752594473105588170689002436016108</span></span><br><span class="line"><span class="number">857193622046369532956303858593915920091597899231114606099376840455498815291882249441316031657223227886408063256997935928852293829363958674748941423482637958097945036015119524003003529012562728663880039779300828455495173066579528840884504820474127764155580431575882153799727366954172244998949884163037173049989089510830676034565100786578569157931828330719618855553013985973380333255988458270286090135439085358705855985243464480891415621448009851959125608913493532</span></span><br><span class="line"><span class="number">1419578626166241608187446985031580512168477481811085359150685095484793334202527830547034879761867782041173504320112039187155606674603450932756995974373876322714100270829493513464972910926435502039913170224956912694142741662642933933999326460268175383410342841997236283906971159882088557842024632266062183163485549556384032497107858373981463088429364943651132002706286010784023366937866234587219007880761583742149766841528701425809927531187141310911172872261081554</span></span><br><span class="line"><span class="number">1423307551896161786512215827022870175063222208925704901852746235904119084039916057601838636424593528597732181049081326600492333908289646434972432345182913892750533744008053671953421431434597081933354887626263497175824523966651302503840039576819802476809108477323831817268200363982401889960974708148391285217560833905198935711219683992300641182176074206804052011439366948577435309990620316268332718916966656229306271202312539205394104903494149703983927691925961516</span></span><br><span class="line"><span class="number">1069265966773937257631872597134275941869000423525218346298953174309119163656802514364762827970811943823322783323544774161909912819104162037918592559755759727802379584211756666220390164620318222455038057141982239560186314721987573168524609661531811062780873728149065735480981514675551011108026831374118214638064879015553515680470205182650594449751838511561327123626559699654094872484543517115161758221449091000937429591410504791574788100186059349155083786419613988</span></span><br><span class="line"><span class="number">831148147986562981791013717502074816164601486662234983507966683328069824638956245030085039811926151437560846491877574422999497174702970871296076127174453588302182188721507427887567381409439635539917087082067644108875952649408453213360856014406755455108299274821574752919390362497642562228427600660772449168728269926257473086706554589045581733254050007519858892294855483686774455623885320336684432867276583162311340077829209990043173980972300187928518697070468996</span></span><br><span class="line"><span class="number">1060215801514866437791578461943164279568483386789993575867096166399913145757365274111449830143103702894903474975107260334611369797180083953487741737332574140747385704887635319337486677976105307482884560294301804144637587975284507874965537158616927633258097477908378619667507726945262801827614898172498864286618016886780599217315916737039861994816080123912315759399718579272542333762041003203117571903424905897895075980290484851700374387581704764700965380523937384</span></span><br><span class="line"><span class="number">781091525507779642711326285949957135768416312540473458004826675463286165819993139313925660301906465620702047089275138672820378421253204240781265329432875735662337192627962915666835147070204317859550070788071012843576716384257903873190222648029535907200699656878148226246737118274387636720703171556741875336295000147639281610425042988056231377739897286002888061410424070947134810253831248291474809964810500480145096273639189318730677716644586929346741481028849444</span></span><br><span class="line"><span class="number">1000420794160323381465286272924907081961177232118898862965676160439914918853816569540590330975399562542538562217824507501553504589733186132049002465442973481767435841400506558652776030791348947276372954395223847310907860192022126889997704182301444242825957397694694175288178630795916340670104158948380603567806637680418989366332578973787776100772021232347138831066306752739345057342554253191209826039573536968306043954523568935672995825503153742080761151720958080</span></span><br><span class="line"><span class="number">1390016626099589721822437523076448285233691358379392393624472327387856568209362766591898878685863618557197554162328337468229522280514039414396633848448296586219419765849020276433023903652652412492851487848312684816496638349984873821757508758697182082304973747729555560960228384420607427506098293404730536234563973694006283617426627569010655455194337811387636304887127393676532817790742243125362945418311906880230114221372499795708508332449178073693991253458082484</span></span><br><span class="line"><span class="number">1122288214684138128045560504834990165115198801984427072594181143306901500950590187776379574689495482136096068249216028920952710651644889210417742065718895811780497758959877358223202667478525949518062312582242750630096329784082213922579901068453269279004979747616755939107868519324046403154579862061083838756607314620110166338539041798180260555261874058608020379554468792976830979136219822396526295418332356089431286982911441215127244346866155288164625077359308004</span></span><br><span class="line"><span class="number">854219930286542650194778372394729765545724795545625499667712705396741231238154066225715320705089120454428253483326821962608884433030674113396036505205901904590975146903798466233732562408855582658923922888851843457352917824900907468283044606105085633454999350372446346717104937912248079085945481290350047046401131197624600858115042151578988645720195101597908767427980099015460999299497664803069451020989406603431092460240575099805048212121659198359430888560420530</span></span><br><span class="line"><span class="number">1261246726587000362729848817491358224445427130674846683109855771271784258738270381893062012086287925404579042835019929714007922138797108267615062424106738007375969588556945028273292357534874334394559105897377313432215150380276038982361813917606245227819396956432322423539752376843139826022256376073193508742877189060653254866350843737326176879196191475635611541907034926709247231688084402947052579795253419078171522152205668769459934912444378065643336984512256510</span></span><br><span class="line"><span class="number">780005508238107005510509836164223921044666224377795828300947099004376047921297990104219560023931231544557425302962325823558355900892882299464095079477243512600395329393929433066337627770466856971216745972567107777542454459794788994082656375517952090947435032095975802440249446822905679764921479374476012984113061606729178052755920566745765263071374238824807176195606628435580933430936024369686481134598592521694905828278700764250389138158322517166164903110462066</span></span><br><span class="line"><span class="number">834799737552815677831798522362625860596892201502022185844378591082958406477419172921654896757875405183086406434404225150230262695935863148513479885969629873319695009143111892260623329502065862550214444719008796670081827784609604579428514248627354706668126809110671124178198186811125900071655584768626832096925022227356630218156381176772308734257457537817001018805235898378868627574202721946548461064601775049784378572171485995538251505183100361230932774104113886</span></span><br><span class="line"><span class="number">1230354787119889904130004260312617342046984097670154079163135854064969865113190324348119675476237316262686294350627172354890689274930817167624993628390737307161796902310467648048386829948452708247676789045543782438901802270769347272010191682095244937698392905818612050761277135396311948902097043823148956081626916920627192798739825601839432604187237055718281674145748307536137649013956588543777095899224536339005889759573853087326251934159121656192827774098420940</span></span><br><span class="line"><span class="number">1505535414534190519011469998285555000238244986597578956112990806890571190453736860174536272278446860616858845440508028155234910705669527551829296796080027218571688908621955909972704725652740860021573473274351639662540234966346159883709126580826995877842546489458754554203501599927945093781077874845767570010299166664000368788758489425472501371633784295879764995261886049824765928665855217956032386533213447186797947009285536832189249090672043664338787191516222120</span></span><br><span class="line"><span class="number">1108608754874636819606953570379050124347612193212871087598239782497649261015061942949326283639937696469385672493423787042424357528691789815826436103378090788068218845067894058320662612843530270943740973098392758144983074073402148927374612245493513909739508460186786819413110394835403394504084365191534631972095994805201815972552250717633204430679782393268400868097740091447107412703287949906822406811035970720756685565762862913129733272075332752340578144448720784</span></span><br><span class="line"><span class="number">1131647287528070724203713102778052490316099871590834868624734105618338848313087840928325888054073846131653868923766386491093594772565755900508543864529795874036311465143137316619735289760162754882929413472373067876900610363336052337922039206955881985467787893431759390247420924718719504483973516607450198508745716692746495798702835409095202216367012138474718689897382066678960480816075024508154560762120732187038314684780936340478907270415029703147268421316351874</span></span><br><span class="line"><span class="number">830497759980729705914224051104334162195664514518858237593098625409691796348328838055145107246075750180679786726928482494826051254000298370330008697134860935299858341071632392187887898796558384238650778286360693065159921427410587126453021406241902512144392153147013515487170166739678977696280729438759368787150359599597145133628344404040467791698202996366424396693955985890540382037841163140927737324582659777001878325588502674474406848265729886219896148230970980</span></span><br></pre></td></tr></table></figure>
<p>这个题目就没太多可说的了，第一部分AGCD，第二部分AMM或者有限域开根后CRT组合就好。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">N=<span class="number">68770027076980723946939075792572969610228738501865973895618044035550466673326811210718966610231582633896160130057212343512606374318082678735227998163020559923237005947682357783487924911009663067842443440348588088325506801639924926097944176357432282915587075930988972621730524537492705984723766652062305363027</span></span><br><span class="line">e=<span class="number">30899846873</span></span><br><span class="line">c=<span class="number">46935517038224473812546067305866276864169387205589347201858550096671613860700878462369638807831295923952343159795466895818221029692119135003812788250010552362110290387383510093277209478665971066986914981717774698233220968427990066291572377851164878122374241804989577737820368814455456808941766309324614067608</span></span><br><span class="line">tempc = []</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;E:\题\DASCTF X 0psu3十一月挑战赛\FindPrime\output.txt&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">        tempc.append(<span class="built_in">int</span>(f.readline()))</span><br><span class="line"></span><br><span class="line"><span class="comment">#AGCD</span></span><br><span class="line">pbits = <span class="number">512</span></span><br><span class="line"></span><br><span class="line">L = Matrix(ZZ,<span class="number">29</span>,<span class="number">29</span>)</span><br><span class="line">L[<span class="number">0</span>,<span class="number">0</span>] = <span class="number">2</span>^<span class="number">450</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">29</span>):</span><br><span class="line">    L[<span class="number">0</span>,i] = tempc[i]</span><br><span class="line">    L[i,i] = tempc[<span class="number">0</span>]</span><br><span class="line">res = L.LLL()</span><br><span class="line">k0 = <span class="built_in">abs</span>(res[<span class="number">0</span>][<span class="number">0</span>]) // L[<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">p = <span class="built_in">abs</span>(tempc[<span class="number">0</span>]) // k0</span><br><span class="line">q = N // p</span><br><span class="line"></span><br><span class="line">e = [<span class="number">7</span>,<span class="number">191</span>,<span class="number">23111329</span>]</span><br><span class="line"></span><br><span class="line">d1 = inverse(e[<span class="number">2</span>],(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">c = <span class="built_in">pow</span>(c,d1,N)</span><br><span class="line"></span><br><span class="line"><span class="comment">#p</span></span><br><span class="line">dp1 = inverse(<span class="number">191</span>,p-<span class="number">1</span>)</span><br><span class="line">cp = <span class="built_in">pow</span>(c,dp1,p)</span><br><span class="line">PR.&lt;x&gt; = Zmod(p)[]</span><br><span class="line">f = x^<span class="number">7</span> - cp</span><br><span class="line">resp = f.roots()</span><br><span class="line"></span><br><span class="line"><span class="comment">#q</span></span><br><span class="line">PR.&lt;x&gt; = Zmod(q)[]</span><br><span class="line">f = x^(<span class="number">191</span>*<span class="number">7</span>) - c</span><br><span class="line">resq = f.roots()</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"><span class="comment">#M = crt(n,c)[0]</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> resp:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> resq:</span><br><span class="line">        ti = <span class="built_in">int</span>(i[<span class="number">0</span>])</span><br><span class="line">        tj = <span class="built_in">int</span>(j[<span class="number">0</span>])</span><br><span class="line">        n = [p,q]</span><br><span class="line">        c = [ti,tj]</span><br><span class="line">        m = crt(n,c)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">b&quot;DASCTF&quot;</span> <span class="keyword">in</span> long_to_bytes(<span class="built_in">int</span>(m))):</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#DASCTF&#123;VERY_VERY_EASY_AND_TAKE_THE_NEXT_TIME&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="MathFactor1"><a href="#MathFactor1" class="headerlink" title="MathFactor1"></a>MathFactor1</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">简单利用你的知识观察即可</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p=getPrime(<span class="number">512</span>)</span><br><span class="line">q=getPrime(<span class="number">512</span>)</span><br><span class="line">n=p*q</span><br><span class="line">d=(p**<span class="number">21</span>+q**<span class="number">17</span>)</span><br><span class="line">d1=d&amp;(<span class="number">2</span>**<span class="number">300</span>-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">flag=<span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>).read().strip()</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">flag=flag+os.urandom(<span class="number">60</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;e = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#n=89049581381915401856270440494182068395799559452947499744642830361236578373835725708887668528820916651578050248209041339369091828040992115394942524278397293747808840107939504743946806866214713225533666120894844131211241905215662457238793580469827973839976134854993162976454283311566973255659612267446150515233</span></span><br><span class="line"><span class="comment">#e=65537</span></span><br><span class="line"><span class="comment">#c=16305239798028293699632813396005973660370581911030264211210444559974188415332021689054795983319112132645051076901780239982290095820283651929773925636804434706351474493000010749679965744672518110692104573489299874390925347271040454693791271882869477780584606934066152476594086178041874762147934091597942667138</span></span><br><span class="line"><span class="comment">#d1=1253867202722198232827428701701674148965306906567632781415318063046179456643047348348144258</span></span><br></pre></td></tr></table></figure>
<p>题目要求分解RSA的公钥n，为此给了我们一个额外信息：</p>
<script type="math/tex; mode=display">
d = p^{21} + q^{17}</script><p>但是这个额外信息并不是完整的，而只给了我们低300位。利用这个信息推导的过程如下，首先同乘p^17：</p>
<script type="math/tex; mode=display">
p^{17}d = p^{17}(p^{21} + q^{17}) = p^{38} + n^{17}</script><p>那么在模2^300的意义下就有：</p>
<script type="math/tex; mode=display">
d_1p^{17} \equiv p^{38} + n^{17} \quad(mod \; 2^{300})</script><p>那么解这个模方程就能解出可能的p的低300位，然后copper高位恢复p就有n的分解。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n=<span class="number">89049581381915401856270440494182068395799559452947499744642830361236578373835725708887668528820916651578050248209041339369091828040992115394942524278397293747808840107939504743946806866214713225533666120894844131211241905215662457238793580469827973839976134854993162976454283311566973255659612267446150515233</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">c=<span class="number">16305239798028293699632813396005973660370581911030264211210444559974188415332021689054795983319112132645051076901780239982290095820283651929773925636804434706351474493000010749679965744672518110692104573489299874390925347271040454693791271882869477780584606934066152476594086178041874762147934091597942667138</span></span><br><span class="line">d1=<span class="number">1253867202722198232827428701701674148965306906567632781415318063046179456643047348348144258</span></span><br><span class="line"></span><br><span class="line">maybe_p = []</span><br><span class="line">p = var(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">p0 = solve_mod([p^<span class="number">38</span> - d1*p^<span class="number">17</span> + n^<span class="number">17</span>  == <span class="number">0</span>], <span class="number">2</span>^<span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> p0:</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    f = x*<span class="number">2</span>^<span class="number">300</span> + <span class="built_in">int</span>(i[<span class="number">0</span>])</span><br><span class="line">    f = f.monic()</span><br><span class="line">    res = f.small_roots(X = <span class="number">2</span>^<span class="number">215</span>,beta=<span class="number">0.4</span>)</span><br><span class="line">    <span class="keyword">if</span>(res != []):</span><br><span class="line">        p = <span class="built_in">int</span>(<span class="built_in">int</span>(res[<span class="number">0</span>])*<span class="number">2</span>^<span class="number">300</span> + <span class="built_in">int</span>(i[<span class="number">0</span>]))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">q = n // p</span><br><span class="line"></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(<span class="number">65537</span>,phi)</span><br><span class="line">flag = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(flag)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#DASCTF&#123;0psu3_is_the_most_Greatest_army&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="MathFactor"><a href="#MathFactor" class="headerlink" title="MathFactor"></a>MathFactor</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">尝试利用你学过的知识来解决吧</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">key, message, mask</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(<span class="number">64901</span>, message^^mask, key)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_Prime_leak</span>(<span class="params">bits,t1</span>):</span><br><span class="line">    x,y=<span class="number">0</span>,<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        </span><br><span class="line">        u=randint(<span class="number">1</span>,<span class="number">200</span>)</span><br><span class="line">        v=randint(<span class="number">1</span>,<span class="number">200</span>)</span><br><span class="line">        x,y=u*x+t1*v*y,v*x-u*y</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">int</span>(x).bit_length()&lt;=bits//<span class="number">2</span>:</span><br><span class="line">            p=x^<span class="number">2</span>+t1*y^<span class="number">2</span>|<span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> isPrime(<span class="built_in">int</span>(p)) <span class="keyword">and</span> <span class="built_in">int</span>(p).bit_length()&gt;=bits:</span><br><span class="line">                <span class="keyword">return</span> p</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            x,y=<span class="number">0</span>,<span class="number">1</span></span><br><span class="line">t1=getPrime(<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;t1=<span class="subst">&#123;t1&#125;</span>&quot;</span>)</span><br><span class="line">p=get_Prime_leak(<span class="number">512</span>,t1)</span><br><span class="line">q=get_Prime_leak(<span class="number">512</span>,t1)</span><br><span class="line"><span class="keyword">assert</span> p&gt;q</span><br><span class="line">n=p*q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n=<span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line">flag=bytes_to_long(flag)</span><br><span class="line">messages = [getRandomNBitInteger(flag.bit_length()) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200</span>)]</span><br><span class="line">enc = [encrypt(p, message, flag) <span class="keyword">for</span> message <span class="keyword">in</span> messages]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>,<span class="string">&#x27;w&#x27;</span>)<span class="keyword">as</span> f2:</span><br><span class="line">    f2.write(<span class="string">f&#x27;message = <span class="subst">&#123;messages&#125;</span>\n&#x27;</span>)</span><br><span class="line">    f2.write(<span class="string">f&#x27;enc = <span class="subst">&#123;enc&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#t1=39041</span></span><br><span class="line"><span class="comment">#n=31757681951092898377241647622353350811555571588021442714393002561722357855033517882719102833176105251763057313366942759802483366389547670310504898517419619177075155149247837212852121269080431969095421646338619498652624131319645919876504536274428562199882910834700167991957991646691071345200388502034841600000001</span></span><br></pre></td></tr></table></figure>
<p>output.txt太长了，需要的师傅可以找我要。</p>
<p>回到题目，题目分为两部分，第一部分基于一个奇怪的get_Prime_leak函数生成了两个大素数p、q；第二部分将flag放在指数上，然后做一个有掩码的加密。这也就是说，第一部分应该是让我们获得素数p，从而能够求解第二部分的离散对数问题。</p>
<p>但是其实第二部分是N1CTF的e2D1p一题，在这个题目中是可以直接用第二部分恢复p的，详细推导可以见：</p>
<p><a href="https://tangcuxiaojikuai.xyz/post/9b40da15.html">Crypto趣题-Lattice | 糖醋小鸡块的blog (tangcuxiaojikuai.xyz)</a></p>
<p>我也是直接从第二部分尝试入手的。但实际实施会发现，这个题目中flag有183比特，但是e2D1p中仅有159比特，而就是这样一个flag的比特长度差异，导致我们需要的左核中规约出的短向量长度依然很大，没有办法在有限时间内进行幂乘运算(不太明白我在说什么的师傅可以先去看看e2D1p我的题解)。具体来说，e2D1p中规约出的短向量数量级是下面这样：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(-<span class="number">28</span>, -<span class="number">58</span>, -<span class="number">136</span>, -<span class="number">183</span>, <span class="number">73</span>, <span class="number">41</span>, -<span class="number">45</span>, -<span class="number">37</span>, -<span class="number">75</span>, <span class="number">129</span>, <span class="number">89</span>, -<span class="number">14</span>, <span class="number">23</span>, <span class="number">31</span>, -<span class="number">31</span>, <span class="number">6</span>, <span class="number">46</span>, -<span class="number">79</span>, <span class="number">15</span>, <span class="number">53</span>, <span class="number">82</span>, <span class="number">16</span>, -<span class="number">10</span>, <span class="number">6</span>, -<span class="number">8</span>, <span class="number">102</span>, <span class="number">114</span>, -<span class="number">58</span>, <span class="number">7</span>, <span class="number">90</span>, <span class="number">51</span>, <span class="number">62</span>, <span class="number">21</span>, -<span class="number">49</span>, -<span class="number">140</span>, <span class="number">209</span>, <span class="number">21</span>, <span class="number">90</span>, <span class="number">17</span>, -<span class="number">27</span>, <span class="number">60</span>, -<span class="number">123</span>, -<span class="number">64</span>, -<span class="number">65</span>, <span class="number">72</span>, -<span class="number">159</span>, -<span class="number">124</span>, <span class="number">72</span>, -<span class="number">88</span>, <span class="number">101</span>, -<span class="number">64</span>, -<span class="number">11</span>, -<span class="number">139</span>, <span class="number">169</span>, -<span class="number">18</span>, -<span class="number">93</span>, -<span class="number">49</span>, -<span class="number">66</span>, <span class="number">27</span>, -<span class="number">2</span>, <span class="number">111</span>, -<span class="number">68</span>, -<span class="number">87</span>, <span class="number">41</span>, -<span class="number">103</span>, <span class="number">2</span>, -<span class="number">176</span>, <span class="number">61</span>, -<span class="number">41</span>, <span class="number">93</span>, -<span class="number">92</span>, -<span class="number">60</span>, -<span class="number">64</span>, <span class="number">38</span>, -<span class="number">40</span>, <span class="number">156</span>, <span class="number">79</span>, <span class="number">141</span>, <span class="number">103</span>, -<span class="number">12</span>, <span class="number">25</span>, <span class="number">1</span>, <span class="number">158</span>, -<span class="number">18</span>, -<span class="number">36</span>, <span class="number">8</span>, <span class="number">63</span>, <span class="number">164</span>, <span class="number">15</span>, -<span class="number">101</span>, -<span class="number">160</span>, <span class="number">64</span>, -<span class="number">66</span>, <span class="number">23</span>, <span class="number">105</span>, -<span class="number">70</span>, <span class="number">71</span>, -<span class="number">38</span>, <span class="number">41</span>, <span class="number">37</span>, <span class="number">2</span>, -<span class="number">85</span>, <span class="number">72</span>, -<span class="number">107</span>, -<span class="number">41</span>, -<span class="number">77</span>, -<span class="number">117</span>, <span class="number">77</span>, -<span class="number">250</span>, -<span class="number">55</span>, <span class="number">13</span>, -<span class="number">148</span>, -<span class="number">34</span>, -<span class="number">36</span>, -<span class="number">119</span>, -<span class="number">44</span>, -<span class="number">117</span>, <span class="number">98</span>, -<span class="number">101</span>, <span class="number">23</span>, <span class="number">154</span>, <span class="number">32</span>, -<span class="number">11</span>, -<span class="number">17</span>, -<span class="number">52</span>, -<span class="number">29</span>, <span class="number">81</span>, <span class="number">182</span>, <span class="number">26</span>, <span class="number">45</span>, <span class="number">162</span>, -<span class="number">29</span>, <span class="number">71</span>, <span class="number">114</span>, <span class="number">44</span>, -<span class="number">21</span>, <span class="number">11</span>, -<span class="number">37</span>, <span class="number">6</span>, -<span class="number">119</span>, <span class="number">19</span>, -<span class="number">22</span>, -<span class="number">76</span>, -<span class="number">41</span>, -<span class="number">41</span>, <span class="number">17</span>, <span class="number">146</span>, <span class="number">73</span>, -<span class="number">82</span>, <span class="number">41</span>, -<span class="number">52</span>, -<span class="number">91</span>, <span class="number">130</span>, -<span class="number">25</span>, -<span class="number">6</span>, <span class="number">24</span>, -<span class="number">2</span>, -<span class="number">39</span>, <span class="number">16</span>, -<span class="number">76</span>, -<span class="number">59</span>, <span class="number">15</span>, <span class="number">64</span>, -<span class="number">118</span>, <span class="number">40</span>, -<span class="number">155</span>, <span class="number">141</span>, -<span class="number">32</span>, <span class="number">143</span>, -<span class="number">67</span>, <span class="number">78</span>, -<span class="number">43</span>, -<span class="number">58</span>, <span class="number">18</span>, <span class="number">131</span>, <span class="number">55</span>, -<span class="number">34</span>, -<span class="number">24</span>, <span class="number">27</span>, -<span class="number">20</span>, <span class="number">128</span>, -<span class="number">172</span>, -<span class="number">3</span>, -<span class="number">3</span>, <span class="number">38</span>, <span class="number">14</span>, <span class="number">189</span>, <span class="number">128</span>, <span class="number">158</span>, -<span class="number">164</span>, <span class="number">107</span>, -<span class="number">53</span>, <span class="number">70</span>, -<span class="number">67</span>, -<span class="number">32</span>, <span class="number">4</span>, <span class="number">18</span>, <span class="number">36</span>, -<span class="number">81</span>, -<span class="number">117</span>)</span><br></pre></td></tr></table></figure>
<p>但是本题规约出的是下面这样：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="number">615531</span>, <span class="number">820840</span>, <span class="number">1843883</span>, -<span class="number">988269</span>, <span class="number">1428114</span>, <span class="number">1582152</span>, <span class="number">1858592</span>, <span class="number">416398</span>, <span class="number">1347348</span>, -<span class="number">1249922</span>, <span class="number">493164</span>, -<span class="number">13983</span>, <span class="number">1130024</span>, <span class="number">1207762</span>, -<span class="number">83772</span>, -<span class="number">1709002</span>, -<span class="number">3710981</span>, <span class="number">1039779</span>, -<span class="number">3519123</span>, <span class="number">907341</span>, -<span class="number">2290927</span>, <span class="number">1126688</span>, -<span class="number">1249423</span>, -<span class="number">628301</span>, <span class="number">1916755</span>, <span class="number">521537</span>, <span class="number">73886</span>, -<span class="number">186219</span>, -<span class="number">219367</span>, -<span class="number">1906389</span>, <span class="number">1594946</span>, -<span class="number">120368</span>, <span class="number">166749</span>, -<span class="number">1244087</span>, <span class="number">134738</span>, -<span class="number">538176</span>, -<span class="number">668121</span>, -<span class="number">1056203</span>, -<span class="number">559497</span>, -<span class="number">34191</span>, <span class="number">2611364</span>, <span class="number">4432570</span>, -<span class="number">1553761</span>, -<span class="number">2032445</span>, -<span class="number">1084508</span>, <span class="number">10039</span>, -<span class="number">3117250</span>, <span class="number">1811906</span>, -<span class="number">2528854</span>, -<span class="number">1267546</span>, <span class="number">723272</span>, <span class="number">209526</span>, <span class="number">518286</span>, -<span class="number">131043</span>, -<span class="number">2547708</span>, -<span class="number">1392536</span>, -<span class="number">3286900</span>, <span class="number">1086367</span>, <span class="number">559683</span>, -<span class="number">3090238</span>, <span class="number">3206757</span>, <span class="number">697813</span>, <span class="number">2242044</span>, -<span class="number">371728</span>, -<span class="number">957366</span>, <span class="number">3591511</span>, <span class="number">3179698</span>, -<span class="number">879907</span>, -<span class="number">3571962</span>, -<span class="number">69278</span>, -<span class="number">2108676</span>, -<span class="number">244744</span>, -<span class="number">808858</span>, -<span class="number">628418</span>, <span class="number">992696</span>, -<span class="number">1803330</span>, -<span class="number">803533</span>, -<span class="number">1487603</span>, <span class="number">1611449</span>, -<span class="number">2704640</span>, -<span class="number">2402337</span>, -<span class="number">210044</span>, <span class="number">3150751</span>, -<span class="number">32136</span>, -<span class="number">255605</span>, <span class="number">1362843</span>, -<span class="number">218480</span>, <span class="number">1148073</span>, -<span class="number">1481245</span>, <span class="number">1778748</span>, <span class="number">3009486</span>, -<span class="number">2402629</span>, -<span class="number">2055140</span>, -<span class="number">233379</span>, <span class="number">475049</span>, <span class="number">190266</span>, -<span class="number">2005899</span>, -<span class="number">196650</span>, <span class="number">770396</span>, <span class="number">979739</span>, <span class="number">3141171</span>, -<span class="number">491714</span>, -<span class="number">146091</span>, -<span class="number">128110</span>, -<span class="number">1281062</span>, <span class="number">260650</span>, -<span class="number">380974</span>, -<span class="number">39241</span>, -<span class="number">1018453</span>, <span class="number">47184</span>, <span class="number">597919</span>, <span class="number">2378194</span>, -<span class="number">105102</span>, -<span class="number">56783</span>, <span class="number">1635534</span>, -<span class="number">2230566</span>, -<span class="number">684866</span>, <span class="number">649656</span>, -<span class="number">909431</span>, <span class="number">412454</span>, -<span class="number">2314462</span>, -<span class="number">173275</span>, -<span class="number">516860</span>, <span class="number">6333941</span>, -<span class="number">968605</span>, -<span class="number">398729</span>, -<span class="number">754797</span>, <span class="number">352076</span>, <span class="number">1182197</span>, -<span class="number">539564</span>, -<span class="number">152936</span>, <span class="number">384461</span>, <span class="number">143728</span>, -<span class="number">2349008</span>, -<span class="number">1065335</span>, -<span class="number">2770792</span>, <span class="number">2956471</span>, -<span class="number">720375</span>, <span class="number">874597</span>, -<span class="number">1971207</span>, -<span class="number">2306567</span>, -<span class="number">2043739</span>, -<span class="number">3030757</span>, <span class="number">3705855</span>, <span class="number">3554038</span>, -<span class="number">188858</span>, -<span class="number">880846</span>, -<span class="number">1461827</span>, <span class="number">776425</span>, -<span class="number">1640892</span>, -<span class="number">2061636</span>, <span class="number">1561268</span>, <span class="number">447146</span>, <span class="number">1784411</span>, <span class="number">800767</span>, <span class="number">590142</span>, <span class="number">1506176</span>, -<span class="number">885787</span>, <span class="number">186370</span>, -<span class="number">3483445</span>, <span class="number">3071150</span>, -<span class="number">1020290</span>, -<span class="number">1274281</span>, -<span class="number">756202</span>, -<span class="number">1208553</span>, <span class="number">616290</span>, <span class="number">432768</span>, <span class="number">2234865</span>, <span class="number">3184408</span>, -<span class="number">1384911</span>, <span class="number">1993714</span>, <span class="number">1300044</span>, -<span class="number">2446183</span>, <span class="number">1265363</span>, -<span class="number">542953</span>, <span class="number">142733</span>, <span class="number">1177658</span>, <span class="number">1691082</span>, <span class="number">578373</span>, -<span class="number">798776</span>, <span class="number">2288770</span>, <span class="number">355350</span>, <span class="number">2204661</span>, <span class="number">536178</span>, <span class="number">1373409</span>, <span class="number">1436493</span>, -<span class="number">254000</span>, -<span class="number">704253</span>, <span class="number">2164140</span>, -<span class="number">3300946</span>, -<span class="number">376660</span>, <span class="number">459460</span>, -<span class="number">1819436</span>, <span class="number">2012068</span>, -<span class="number">846015</span>, <span class="number">1651051</span>, <span class="number">1783145</span>, <span class="number">2637474</span>, -<span class="number">1493120</span>, -<span class="number">3108069</span>)</span><br></pre></td></tr></table></figure>
<p>所以直接从第二部分恢复p的尝试就宣告破产了，因此还是要从第一部分入手。</p>
<p>然后看第一部分素数p的产生过程，其实可以发现他的产生过程其实是一个线性的迭代，因此都可以写成矩阵形式。具体来说，第一次迭代为：</p>
<script type="math/tex; mode=display">
\left(
 \begin{matrix}
   x_1 \\
   y_1  \\
  \end{matrix}
  \right)
  =
 \left(
 \begin{matrix}
   u_1 & 39041v_1\\
   v_1 & -u_1 \\
  \end{matrix}
  \right)
    \left(
 \begin{matrix}
   0 \\
   1  \\
  \end{matrix}
  \right)</script><p>第二次迭代就是：</p>
<script type="math/tex; mode=display">
\left(
 \begin{matrix}
   x_2 \\
   y_2  \\
  \end{matrix}
  \right)
  =
 \left(
 \begin{matrix}
   u_2 & 39041v_2\\
   v_2 & -u_2 \\
  \end{matrix}
  \right)
    \left(
 \begin{matrix}
   x_1 \\
   y_1  \\
  \end{matrix}
  \right)
  =
   \left(
 \begin{matrix}
   u_2 & 39041v_2\\
   v_2 & -u_2 \\
  \end{matrix}
  \right)
   \left(
 \begin{matrix}
   u_1 & 39041v_1\\
   v_1 & -u_1 \\
  \end{matrix}
  \right)
    \left(
 \begin{matrix}
   0 \\
   1  \\
  \end{matrix}
  \right)</script><p>其实就可以发现规律了，不妨令：</p>
<script type="math/tex; mode=display">
L_i = 
   \left(
 \begin{matrix}
   u_i & 39041v_i\\
   v_i & -u_i \\
  \end{matrix}
  \right)</script><p>那么其实n次迭代后得到的xn，yn其实就是：</p>
<script type="math/tex; mode=display">
\left(
 \begin{matrix}
   x_n \\
   y_n  \\
  \end{matrix}
  \right)
  =
\prod_{i=1}^{n}L_i
    \left(
 \begin{matrix}
   0 \\
   1  \\
  \end{matrix}
  \right)</script><p>而根据数量级或者测试可以知道，要生成512bit的素数，题目一共会进行18次迭代，所以最后得到的p其实是：</p>
<script type="math/tex; mode=display">
p = (x_{18}^2 + 39041y_{18}^2) \;|\; 1</script><p>那么问题就在于如何由刚才的矩阵表示形式推出p的值，我们简单观察一下前几次累乘矩阵得到的结果：</p>
<script type="math/tex; mode=display">
\left(
 \begin{matrix}
   u_2 & 39041v_2\\
   v_2 & -u_2 \\
  \end{matrix}
  \right)
   \left(
 \begin{matrix}
   u_1 & 39041v_1\\
   v_1 & -u_1 \\
  \end{matrix}
  \right)
  =
     \left(
 \begin{matrix}
   u_1u_2 + 39041v_1v_2 & 39041v_1u_2 - 39041v_2u_1\\
   u_1v_2-v_1u_2 & 39041v_1v_2 + u_1u_2 \\
  \end{matrix}
  \right)</script><p>有没有发现什么，我们可以把这个结果矩阵写成如下形式：</p>
<script type="math/tex; mode=display">
\prod_{i=1}^{2}L_i
=
\left(
 \begin{matrix}
   A & 39041B\\
   -B & A \\
  \end{matrix}
  \right)
  =
     \left(
 \begin{matrix}
   u_1u_2 + 39041v_1v_2 & 39041v_1u_2 - 39041v_2u_1\\
   u_1v_2-v_1u_2 & 39041v_1v_2 + u_1u_2 \\
  \end{matrix}
  \right)</script><p>而如果再进行一次迭代，累乘矩阵的符号又会变成如下形式：</p>
<script type="math/tex; mode=display">
\prod_{i=1}^{3}L_i
=
\left(
 \begin{matrix}
   A' & 39041B'\\
   B' & -A' \\
  \end{matrix}
  \right)</script><p>因此，18次迭代后，累乘矩阵的符号表示为：</p>
<script type="math/tex; mode=display">
\prod_{i=1}^{18}L_i
=
\left(
 \begin{matrix}
   A'' & 39041B''\\
   -B'' & A'' \\
  \end{matrix}
  \right)</script><p>所以有：</p>
<script type="math/tex; mode=display">
\left(
 \begin{matrix}
   x_{18} \\
   y_{18}  \\
  \end{matrix}
  \right)
  =
\left(
 \begin{matrix}
   A'' & 39041B''\\
   -B'' & A'' \\
  \end{matrix}
  \right)
    \left(
 \begin{matrix}
   0 \\
   1  \\
  \end{matrix}
  \right)
  =
     \left(
 \begin{matrix}
   39041B'' \\
   A''  \\
  \end{matrix}
  \right)</script><p>所以p就等于：</p>
<script type="math/tex; mode=display">
p = ((39041B'')^2 + 39041A''^2) \;|\; 1</script><p>而接下来就是最重要的一点就是注意到：</p>
<script type="math/tex; mode=display">
A''^2 + 39041B''^2 = det(\prod_{i=1}^{18}L_i)</script><p>而累乘矩阵的行列式又等于每个矩阵的行列式乘积，所以就有：</p>
<script type="math/tex; mode=display">
A''^2 + 39041B''^2 = |\prod_{i=1}^{18}det(L_i)|</script><p>这个时候你应该明白了，这其实说的就是A’’^2 + 39041B’’^2是由若干个如下的小因子组成的：</p>
<script type="math/tex; mode=display">
det(L_i) = u_i^2 + 39041v_i^2</script><p>这其实还说明了一个信息，就是p的表达式的末尾的或运算其实只能写成：</p>
<script type="math/tex; mode=display">
p = ((39041B'')^2 + 39041A''^2) + 1
=
39041(A''^2 + 39041B''^2) + 1</script><p>否则p一定不是一个素数，因为如果不加1，前面这一部分肯定是一个合数。</p>
<p>那么题目就很显然了：p-1是一个光滑数，并且他的所有可能的因子就只有一个39041以及：</p>
<script type="math/tex; mode=display">
u_i^2 + 39041v_i^2</script><p>所以我们把所有这样的因子乘起来，就可能可以覆盖所有p-1和q-1的因子，也就是说我们就拥有了kphi，然后就可以用kphi分解n了，而之所以说是可能可以覆盖所有p-1和q-1的因子，是因为只乘一遍的话，若有因子重复可能会覆盖不到。但是这种情况可以想到概率非常低，因为其实素数p和q的生成过程是从200x200种组合中随机抽取了18+18个，所以这36种组合均不相同的概率是很大的。</p>
<p>得到n的分解后，其实第二部分已经没有难度了，因为p-1是光滑数所以可以直接选一组求dlp后与message异或得到flag，而并不需要像N1CTF那道题目一样逐比特恢复。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> powmod</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> output <span class="keyword">import</span> message,enc</span><br><span class="line"></span><br><span class="line">t1=<span class="number">39041</span></span><br><span class="line">n=<span class="number">31757681951092898377241647622353350811555571588021442714393002561722357855033517882719102833176105251763057313366942759802483366389547670310504898517419619177075155149247837212852121269080431969095421646338619498652624131319645919876504536274428562199882910834700167991957991646691071345200388502034841600000001</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#get p</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span>):</span><br><span class="line">    possible_factors = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">201</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">201</span>):</span><br><span class="line">            possible_factors.append((i**<span class="number">2</span> + t1*j**<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">    t = prod(possible_factors)*t1</span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> t % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        s += <span class="number">1</span></span><br><span class="line">        t //= <span class="number">2</span></span><br><span class="line">    found = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, s):</span><br><span class="line">        c1 = powmod(<span class="number">2</span>, powmod(<span class="number">2</span>, i-<span class="number">1</span>, n)*t, n)</span><br><span class="line">        c2 = powmod(<span class="number">2</span>, powmod(<span class="number">2</span>, i, n)*t, n)</span><br><span class="line">        <span class="keyword">if</span> c1 != <span class="number">1</span> <span class="keyword">and</span> c1 != (-<span class="number">1</span> % n) <span class="keyword">and</span> c2 == <span class="number">1</span>:</span><br><span class="line">            p = GCD(c1 - <span class="number">1</span>, n)</span><br><span class="line">            q = n // p</span><br><span class="line">            <span class="keyword">if</span>(p &lt; q):</span><br><span class="line">                p = q</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="comment">#p = 851426256549592873082727423545889441110074820054059061952308788642530493828078879678106440812002682564381088139664528922266220966196398184854034841600000001</span></span><br><span class="line"></span><br><span class="line">x=discrete_log(mod(enc[<span class="number">0</span>],p),mod(<span class="number">64901</span>,p))</span><br><span class="line">flag = x ^^ message[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(flag))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#DASCTF&#123;0psu3G0d3Best_%&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>糖醋小鸡块
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://tangcuxiaojikuai.xyz/post/6144f326.html" title="2023-DASCTFX0psu3十一月挑战赛-wp-crypto">https://tangcuxiaojikuai.xyz/post/6144f326.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sacreative/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SACREATIVE</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/post/5505a29b.html" rel="prev" title="Crypto趣题-DLP">
      <i class="fa fa-chevron-left"></i> Crypto趣题-DLP
    </a></div>
      <div class="post-nav-item">
    <a href="/post/df537e5d.html" rel="next" title="2023-TPCTF-wp-crypto">
      2023-TPCTF-wp-crypto <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#GeneratePrime"><span class="nav-number">1.</span> <span class="nav-text">GeneratePrime</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#FindPrime"><span class="nav-number">2.</span> <span class="nav-text">FindPrime</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MathFactor1"><span class="nav-number">3.</span> <span class="nav-text">MathFactor1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MathFactor"><span class="nav-number">4.</span> <span class="nav-text">MathFactor</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="糖醋小鸡块"
      src="/images/image.png">
  <p class="site-author-name" itemprop="name">糖醋小鸡块</p>
  <div class="site-description" itemprop="description">"追风赶月莫停留，平芜尽处是春山"</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">76</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="/1142381085@qq.com" title="E-Mail → 1142381085@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/6394335993" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;6394335993" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">糖醋小鸡块</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>
  <script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'UPEMA7DyYbIIEyOW72ohgytU-gzGzoHsz',
      appKey     : 'M7rXAfeP3JOslroay2n0Jv2R',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
<!-- 引入jQuery -->
<script type="text/javascript" src="//libs.baidu.com/jquery/1.8.3/jquery.min.js"></script>
<!-- 雪花特效2 -->
<script type="text/javascript" src="/js/snow2.js"></script>
