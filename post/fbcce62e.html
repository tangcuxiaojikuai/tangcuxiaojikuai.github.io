<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon_small.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="RnN18ZogmZl_dLVpxZ6y8kjKL73Mu9VLVEkw9d3qrq0" />
  <meta name="msvalidate.01" content="DC3050AD55F30DDF75AAB78517714910" />
  <meta name="baidu-site-verification" content="codeva-PPofu3dNxe" />

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-loading-bar.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"tangcuxiaojikuai.xyz","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="不管怎么说还是打了这场，所以还是记录一下吧。">
<meta property="og:type" content="article">
<meta property="og:title" content="2024-ASISCTF-Quals-wp-crypto">
<meta property="og:url" content="https://tangcuxiaojikuai.xyz/post/fbcce62e.html">
<meta property="og:site_name" content="糖醋小鸡块的blog">
<meta property="og:description" content="不管怎么说还是打了这场，所以还是记录一下吧。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-09-24T02:18:53.000Z">
<meta property="article:modified_time" content="2024-09-24T08:52:18.105Z">
<meta property="article:author" content="糖醋小鸡块">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://tangcuxiaojikuai.xyz/post/fbcce62e.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>2024-ASISCTF-Quals-wp-crypto | 糖醋小鸡块的blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">糖醋小鸡块的blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-友链">

    <a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tangcuxiaojikuai.xyz/post/fbcce62e.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/image.png">
      <meta itemprop="name" content="糖醋小鸡块">
      <meta itemprop="description" content=""追风赶月莫停留，平芜尽处是春山"">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="糖醋小鸡块的blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2024-ASISCTF-Quals-wp-crypto
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-09-24 10:18:53 / 修改时间：16:52:18" itemprop="dateCreated datePublished" datetime="2024-09-24T10:18:53+08:00">2024-09-24</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/wp-crypto/" itemprop="url" rel="index"><span itemprop="name">wp-crypto</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/post/fbcce62e.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/post/fbcce62e.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>不管怎么说还是打了这场，所以还是记录一下吧。</p>
<span id="more"></span>
<h3 id="Ataa"><a href="#Ataa" class="headerlink" title="Ataa"></a>Ataa</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cryptography challenges, like the Atta, require creativity and constructive thinking to unravel their complexities and secure sensitive information.</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> p, flag</span><br><span class="line">	</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">die</span>(<span class="params">*args</span>):</span><br><span class="line">	pr(*args)</span><br><span class="line">	quit()</span><br><span class="line">	</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pr</span>(<span class="params">*args</span>):</span><br><span class="line">	s = <span class="string">&quot; &quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, args))</span><br><span class="line">	sys.stdout.write(s + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">	sys.stdout.flush()</span><br><span class="line">	</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sc</span>(): </span><br><span class="line">	<span class="keyword">return</span> sys.stdin.buffer.readline()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">u, v, w, x, y, z, k, p</span>):</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">set</span>([u, v, w, x, y, z])) == <span class="number">6</span>:</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">all</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> t: t % p != <span class="number">0</span>, [u, v, w, x, y, z, k])):</span><br><span class="line">			<span class="keyword">if</span> gcd(u, v, w, x, y, z, k, p) == <span class="number">1</span>:</span><br><span class="line">				<span class="keyword">if</span> (<span class="built_in">pow</span>(u, k, p) + v * w * x * y * z) % p + (<span class="built_in">pow</span>(v, k, p) + u * w * x * y * z) % p + \</span><br><span class="line">				   (<span class="built_in">pow</span>(w, k, p) + v * u * x * y * z) % p + (<span class="built_in">pow</span>(x, k, p) + v * w * u * y * z) % p + \</span><br><span class="line">				   (<span class="built_in">pow</span>(y, k, p) + v * w * x * u * z) % p + (<span class="built_in">pow</span>(z, k, p) + v * w * x * y * u) % p == <span class="number">0</span>:</span><br><span class="line">					<span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">	border = <span class="string">&quot;┃&quot;</span></span><br><span class="line">	pr(        <span class="string">&quot;┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓&quot;</span>)</span><br><span class="line">	pr(border, <span class="string">&quot;.:: Welcome to ATAA task! Your mission is pass only one level! ::.&quot;</span>, border)</span><br><span class="line">	pr(        <span class="string">&quot;┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛&quot;</span>)</span><br><span class="line">	nbit, _b = <span class="number">128</span>, <span class="literal">False</span></span><br><span class="line">	pr(border, <span class="string">f&#x27;p = <span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line">	pr(border, <span class="string">f&quot;Please provide your desired <span class="subst">&#123;nbit&#125;</span>-integers:&quot;</span>)</span><br><span class="line">	inp = sc().decode()</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		u, v, w, x, y, z, k = [<span class="built_in">int</span>(_) <span class="keyword">for</span> _ <span class="keyword">in</span> inp.split(<span class="string">&#x27;,&#x27;</span>)]</span><br><span class="line">		<span class="keyword">if</span> u.bit_length() == v.bit_length() == w.bit_length() == x.bit_length() == \</span><br><span class="line">		   y.bit_length() == z.bit_length() == nbit <span class="keyword">and</span> k.bit_length() &gt;= nbit:</span><br><span class="line">			_b = <span class="literal">True</span></span><br><span class="line">	<span class="keyword">except</span>:</span><br><span class="line">		die(border, <span class="string">f&quot;The input you provided is not valid!&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> _b:</span><br><span class="line">		<span class="keyword">if</span> check(u, v, w, x, y, z, k, p):</span><br><span class="line">			die(border, <span class="string">f&#x27;Congrats, you got the flag: <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			die(border, <span class="string">f&#x27;The input integer is not correct! Bye!!&#x27;</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		die(border, <span class="string">f&quot;Your input does not meet the requirements!!!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>
<p>连接上靶机后，靶机会提供一个128bit的p，要求给出u, v, w, x, y, z, k，使得他们满足：</p>
<ul>
<li><p>u, v, w, x, y, z是128bit，k大于等于128bit</p>
</li>
<li><p>u, v, w, x, y, z互不相同</p>
</li>
<li><p>u, v, w, x, y, z, k均不是p的整数倍</p>
</li>
<li><p>u, v, w, x, y, z, k, p没有公因子</p>
<blockquote>
<p>这一条算是送的，谁能和p有公因子</p>
</blockquote>
</li>
<li><p>下面等式成立：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="built_in">pow</span>(u, k, p) + v * w * x * y * z) % p + (<span class="built_in">pow</span>(v, k, p) + u * w * x * y * z) % p + (<span class="built_in">pow</span>(w, k, p) + v * u * x * y * z) % p + (<span class="built_in">pow</span>(x, k, p) + v * w * u * y * z) % p + (<span class="built_in">pow</span>(y, k, p) + v * w * x * u * z) % p + (<span class="built_in">pow</span>(z, k, p) + v * w * x * y * u) % p == <span class="number">0</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>这条也有点坑，下面说</p>
</blockquote>
</li>
</ul>
<p>然后就能拿到flag。</p>
<p>虽然题目似乎没有明说p是素数，但是实际上测下来p确实是素数，所以最自然的会想到指数k去构造一个p-1，就可以让指数部分都变成1，那么整个式子就会变成：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f = v * w * x * y * z + u * w * x * y * z + v * u * x * y * z + v * w * u * y * z + v * w * x * u * z + v * w * x * y * u + <span class="number">6</span></span><br></pre></td></tr></table></figure>
<p>还剩六个变量，那么似乎随便取其中五个变量（只要满足128bit），然后在模p下解最后一个就可以了。</p>
<p>但是交互过去不太对，然后发现上面需满足条件的最后一个并没有在和的外层模p，也就是说其实我们需要满足的是：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="built_in">pow</span>(u, k, p) + v * w * x * y * z) % p == <span class="number">0</span></span><br><span class="line">(<span class="built_in">pow</span>(v, k, p) + u * w * x * y * z) % p == <span class="number">0</span></span><br><span class="line">(<span class="built_in">pow</span>(w, k, p) + v * u * x * y * z) % p == <span class="number">0</span></span><br><span class="line">(<span class="built_in">pow</span>(x, k, p) + v * w * u * y * z) % p == <span class="number">0</span></span><br><span class="line">(<span class="built_in">pow</span>(y, k, p) + v * w * x * u * z) % p == <span class="number">0</span></span><br><span class="line">(<span class="built_in">pow</span>(z, k, p) + v * w * x * y * u) % p == <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>由于是轮换对称的，所以就看第一个式子，如果需要满足这个式子的话就要：</p>
<script type="math/tex; mode=display">
u^k = - vwxyz \quad(mod\;p)</script><p>右边五个并不是个常数，所以k取p-1应该是不行了，但是有指数肯定要利用费马，那不如就取k=p-2，此时就有：</p>
<script type="math/tex; mode=display">
u^{-1} = - vwxyz \quad(mod\;p)</script><p>也就是：</p>
<script type="math/tex; mode=display">
uvwxyz = -1 \quad(mod\;p)</script><p>所以也就是说我们只要满足以下条件就可以满足题目：</p>
<ul>
<li>k=p-2</li>
<li>uvwxyz乘积模p下为-1</li>
</ul>
<p>所以仍然随机取另外五个，然后求解剩下一个就可以了。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&quot;65.109.192.143&quot;</span>, <span class="number">13731</span>)</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;p = &quot;</span>)</span><br><span class="line">p = <span class="built_in">int</span>(sh.recvline().strip().decode())</span><br><span class="line">k = p-<span class="number">2</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    v,w,x,y,z = [<span class="number">2</span>**<span class="number">127</span> + randint(<span class="number">0</span>,<span class="number">2</span>**<span class="number">127</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]</span><br><span class="line">    u = p - <span class="built_in">pow</span>(v*w*x*y*z,-<span class="number">1</span>,p)</span><br><span class="line">    <span class="keyword">if</span>(u.bit_length() == <span class="number">128</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">msg = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">str</span>,[u, v, w, x, y, z, k]))</span><br><span class="line">msg = <span class="string">&quot;,&quot;</span>.join(msg)</span><br><span class="line"></span><br><span class="line">sh.sendline(msg.encode())</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;you got the flag: &quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(sh.recvline())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#ASIS&#123;ATAA_1n_p4rGaR_M@g!!&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="Avini"><a href="#Avini" class="headerlink" title="Avini"></a>Avini</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The Avini challenge in cryptography involves doubling a point on elliptic curves (ECC); your task is to identify the vulnerability and capture the flag.</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> ECC</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">die</span>(<span class="params">*args</span>):</span><br><span class="line">	pr(*args)</span><br><span class="line">	quit()</span><br><span class="line">	</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pr</span>(<span class="params">*args</span>):</span><br><span class="line">	s = <span class="string">&quot; &quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, args))</span><br><span class="line">	sys.stdout.write(s + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">	sys.stdout.flush()</span><br><span class="line">	</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sc</span>(): </span><br><span class="line">	<span class="keyword">return</span> sys.stdin.buffer.readline()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genon</span>(<span class="params">nbit</span>):</span><br><span class="line">	R = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">1</span>, nbit))</span><br><span class="line">	shuffle(R)</span><br><span class="line">	B = [<span class="string">&#x27;1&#x27;</span>] + [<span class="string">&#x27;0&#x27;</span>] * (nbit - <span class="number">1</span>)</span><br><span class="line">	u = randint(nbit // <span class="number">2</span> + <span class="number">5</span>, <span class="number">2</span> * nbit // <span class="number">3</span>)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, u):</span><br><span class="line">		B[R[i]] = <span class="string">&#x27;1&#x27;</span></span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(B), <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_genon</span>(<span class="params">n, nbit</span>):</span><br><span class="line">	<span class="keyword">return</span> n.bit_length() == nbit <span class="keyword">and</span> <span class="built_in">bin</span>(n)[<span class="number">2</span>:].count(<span class="string">&#x27;1&#x27;</span>) &gt;= nbit // <span class="number">2</span> + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">	border = <span class="string">&quot;┃&quot;</span></span><br><span class="line">	pr(<span class="string">&quot;┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓&quot;</span>)</span><br><span class="line">	pr(<span class="string">&quot;┃ Welcome to AVINI challenge! Here we can double your points on ECC! ┃&quot;</span>)</span><br><span class="line">	pr(<span class="string">&quot;┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛&quot;</span>)</span><br><span class="line"></span><br><span class="line">	nbit = <span class="number">256</span></span><br><span class="line">	key = ECC.generate(curve=<span class="string">&#x27;P-256&#x27;</span>)</span><br><span class="line">	order = ECC._curves[<span class="string">&#x27;NIST P-256&#x27;</span>][<span class="number">2</span>]</span><br><span class="line">	Q = key.pointQ</span><br><span class="line">	O = ECC.EccPoint(Q.x, Q.y, curve=<span class="string">&#x27;p256&#x27;</span>).point_at_infinity()</span><br><span class="line"></span><br><span class="line">	pr(border, <span class="string">f&quot;Please provide your desired integer `n&#x27; or even the binary &quot;</span>)</span><br><span class="line">	pr(border, <span class="string">f&quot;representation of it, [D]ecimal or [B]inary?&quot;</span>)</span><br><span class="line">	</span><br><span class="line">	ans = sc().decode().strip().lower()</span><br><span class="line">	<span class="keyword">if</span> ans == <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">		pr(border, <span class="string">&quot;So send the integer n: &quot;</span>)</span><br><span class="line">		_n = sc().decode()</span><br><span class="line">		<span class="keyword">try</span>:</span><br><span class="line">			_n = <span class="built_in">int</span>(_n)</span><br><span class="line">		<span class="keyword">except</span>:</span><br><span class="line">			die(border, <span class="string">&#x27;Your input is not integer!&#x27;</span>)</span><br><span class="line">		<span class="keyword">if</span> is_genon(_n, nbit):</span><br><span class="line">			R, P, c = O, Q.copy(), <span class="number">0</span></span><br><span class="line">			<span class="keyword">for</span> _b <span class="keyword">in</span> <span class="built_in">bin</span>(_n)[<span class="number">2</span>:][::-<span class="number">1</span>]:</span><br><span class="line">				<span class="keyword">if</span> _b == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">					R = R + P</span><br><span class="line">					c += <span class="number">1</span></span><br><span class="line">				P = P.double()</span><br><span class="line">				c += <span class="number">1</span></span><br><span class="line">				<span class="keyword">if</span> <span class="number">18</span> * c &gt;= <span class="number">19</span> * nbit:</span><br><span class="line">					<span class="keyword">break</span></span><br><span class="line">			<span class="keyword">if</span> R == Q * _n <span class="keyword">and</span> _n &lt; order:</span><br><span class="line">				die(border, <span class="string">f&#x27;Congrats, you got the flag: <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				die(border, <span class="string">f&#x27;The calculations failed! Sorry!!&#x27;</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			die(border, <span class="string">&#x27;Your integer does not satisfy the requirements!&#x27;</span>)</span><br><span class="line">	<span class="keyword">elif</span> ans == <span class="string">&#x27;b&#x27;</span>:</span><br><span class="line">		pr(border, <span class="string">&quot;Now send the binary representation of n separated by comma: &quot;</span>)</span><br><span class="line">		_B = sc().decode()</span><br><span class="line">		<span class="keyword">try</span>:</span><br><span class="line">			_B = [<span class="built_in">int</span>(_) <span class="keyword">for</span> _ <span class="keyword">in</span> _B.split(<span class="string">&#x27;,&#x27;</span>)]</span><br><span class="line">			_flag = <span class="built_in">all</span>(<span class="built_in">abs</span>(_) &lt;= <span class="number">1</span> <span class="keyword">for</span> _ <span class="keyword">in</span> _B) <span class="keyword">and</span> <span class="built_in">len</span>(_B) == nbit</span><br><span class="line">		<span class="keyword">except</span>:</span><br><span class="line">			die(border, <span class="string">&#x27;Your input is not corr3ct!&#x27;</span>)</span><br><span class="line">		<span class="keyword">if</span> _flag:</span><br><span class="line">			R, P, c, i, _n = O, Q.copy(), <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">			<span class="keyword">for</span> _b <span class="keyword">in</span> _B[::-<span class="number">1</span>]:</span><br><span class="line">				<span class="keyword">if</span> _b != <span class="number">0</span>:</span><br><span class="line">					_n += <span class="number">2</span> ** i * _b</span><br><span class="line">					R += P <span class="keyword">if</span> _b &gt; <span class="number">0</span> <span class="keyword">else</span> -P</span><br><span class="line">					c += <span class="number">1</span></span><br><span class="line">				P = P.double()</span><br><span class="line">				c += <span class="number">1</span></span><br><span class="line">				i += <span class="number">1</span></span><br><span class="line">				<span class="keyword">if</span> <span class="number">71</span> * c &gt;= <span class="number">72</span> * nbit:</span><br><span class="line">					<span class="keyword">break</span></span><br><span class="line">			<span class="keyword">if</span> _n.bit_length() == nbit <span class="keyword">and</span> _n &lt; order <span class="keyword">and</span> R == Q * _n:</span><br><span class="line">				die(border, <span class="string">f&#x27;Congrats, you got the flag: <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				die(border, <span class="string">f&#x27;The calculations failed! Sorry!!&#x27;</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			die(border, <span class="string">f&#x27;Your binary representation does not satisfy the requirements!!&#x27;</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		die(border, <span class="string">&quot;Your choice is not correct, Goodbye!!&quot;</span>)	</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>
<p>连接上靶机后，靶机会随机生成一个私钥d，然后在NIST P-256上取dG得到点Q，并取无穷远点作为O，之后我们有一次交互机会，可以选择：</p>
<ul>
<li>输入d，可以输入一个nbit的整数n，靶机会用这个整数n的二进制表示去做快速幂得到Q的n倍点。但是记n的二进制表示中1的个数为t，则：<ul>
<li>若$t &lt; \frac{nbit}{2} + 1$，则不成功</li>
<li>若$18(t + nbit) &gt; 19nbit$，则无法计算完</li>
</ul>
</li>
<li>输入b，可以输入一个长度为nbit的1、0、-1组成的序列，靶机会把这个序列当作二进制表示去做快速幂得到Q的n倍点。但是记序列中非0的个数为t，则：<ul>
<li>若$71(t + nbit) &gt; 72nbit$，则无法计算完</li>
</ul>
</li>
<li>不管选择哪种，其实按题目的内容的话，都是只要能计算完快速幂就符合要求、拿到flag了。</li>
</ul>
<p>上面这两种显然选d的话是没有符合要求的n的，所以只能选b。而选b又没看出什么障碍，只需要序列中非0项小于等于三个就行了，所以发：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,...,<span class="number">0</span>,<span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<p>就可以通过。</p>
<blockquote>
<p>确实是很莫名其妙。。。不知道想考什么</p>
</blockquote>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&quot;65.109.192.143&quot;</span>, <span class="number">33731</span>)</span><br><span class="line"></span><br><span class="line">sh.sendline(<span class="string">b&quot;b&quot;</span>)</span><br><span class="line">sh.recvuntil(<span class="string">b&quot; separated by comma: &quot;</span>)</span><br><span class="line"></span><br><span class="line">t = [<span class="string">&quot;1&quot;</span>] + [<span class="string">&quot;0&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">255</span>)]</span><br><span class="line">msg = <span class="string">&quot;,&quot;</span>.join(t)</span><br><span class="line"></span><br><span class="line">sh.sendline(msg.encode())</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;you got the flag: &quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(sh.recvline())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#ASIS&#123;B1n4rY_r3pRE5enTat!0N_iZ_mAtT3R_YES!!!&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="Heidi"><a href="#Heidi" class="headerlink" title="Heidi"></a>Heidi</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The Heidi challenge employs matrices over finite fields for message encryption, and we are unable to decrypt it.</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genkey</span>(<span class="params">nbit</span>):</span><br><span class="line">	k = nbit &gt;&gt; <span class="number">6</span></span><br><span class="line">	p, l = getPrime(nbit), k &lt;&lt; <span class="number">1</span></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		M = matrix(GF(p), [[randint(<span class="number">0</span>, p) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(l)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(l)])</span><br><span class="line">		<span class="keyword">if</span> M.is_invertible():</span><br><span class="line">			<span class="keyword">return</span> p, M</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m, key</span>):</span><br><span class="line">	p, M = key</span><br><span class="line">	k = M.nrows() // <span class="number">2</span></span><br><span class="line">	u, v = [vector(randint(<span class="number">0</span>, p) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(k)) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&#x27;01&#x27;</span>]</span><br><span class="line">	u[k - <span class="number">1</span>], U = m - <span class="built_in">sum</span>(u[:-<span class="number">1</span>]) % p, []</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">		U += [(v[i] * u[i]) % p, v[i]]</span><br><span class="line">	<span class="keyword">return</span> M.inverse() * vector(U)</span><br><span class="line"></span><br><span class="line">nbit = <span class="number">512</span></span><br><span class="line">key = genkey(nbit)</span><br><span class="line">               </span><br><span class="line">l = <span class="built_in">len</span>(flag)</span><br><span class="line">m1, m2 = bytes_to_long(flag[:l//<span class="number">2</span>]), bytes_to_long(flag[l//<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line">c1 = encrypt(m1, key)</span><br><span class="line">c2 = encrypt(m2, key)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p  = <span class="subst">&#123;key[<span class="number">0</span>]&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;M  = <span class="subst">&#123;key[<span class="number">1</span>]&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c1 = <span class="subst">&#123;c1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c2 = <span class="subst">&#123;c2&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>output.txt：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">p  = <span class="number">11662551575461840475555573447888369258720609981894210736264777774264853865648625517657867646615246309976844738740514906726900361114740532559856817475566473</span></span><br><span class="line">M  = [<span class="number">10545230560563786984855496923683490476026486940118450770549073464506619127566086156979481737376593715745045825762636289092415982636744903849331044561991027</span>  <span class="number">2770939188750070033130610621916886035117116785794649229334263124116641591679503085440969465109194774271112846705097407127243843388526403756695968426109009</span>  <span class="number">2619573780018799165717871194932363681382195058755685389697413459696317181345652738031305734626276043937246461942417061168292200013052156392419647704791164</span>   <span class="number">587417232443753346797644198418305416759457462109079143577396016060144667553797778650678545813120439536811176815061974102688218065080205615873250043107116</span> <span class="number">10008573718827580115910926267965509421082375658923055816094066727441441269064041396205970151224009498359555212699173361494709128355177042420479730419394448</span> <span class="number">11349679238711423769258106365043934702000409190944163962702681143883019805758084841424170235320080645291800442753915444626688538612431448021461815602505084</span>  <span class="number">1259983683982517528624104640769414117508824651587493945567196749864448927207325443584488939350695796817884095062345172996459022692248477865911484976890677</span>  <span class="number">1971222894902770228840252206358781719599149745812922000368000898504324616168136646332199731351703510417591436024000432753085479074932699265728642973361588</span>  <span class="number">6669839659863156841636921153847171255855329714769739014914538022174619476759150740113746210470811794024450238412094230956104104604470512858620052633879456</span>  <span class="number">3802581949594457592828363879108542960813008873564295428591688777471510363950965569917650721412016262056902496806630695062218366384844071135340776983011281</span>  <span class="number">9173775727119267206301111299477830915900809890513063857586668239440017154407086958798891345751914739719483187083090695958175401343040767721933865576481217</span>    <span class="number">63292815796033440929737603098751368679976667448780318616378030386447237785088204452210939061618406699554649740350145149138551040089078412650647821839141</span>  <span class="number">8038110607224698830642667955922921786160643054537840638891553876593127658518422032492194777989543683234482686451247682664202847091088436250018914370900018</span>  <span class="number">4620005466063990313733956207010660049630085668153164585959348477382500378456404909920166091487161042789245349592631307648239193958926571830969290111319341</span>  <span class="number">7723658333415639830236075056074413401601023668675501055777319586393273424696409262534891945899607774752133819166960047216693074083029041571138165980556645</span>  <span class="number">5664967064930741692594553029048945396725847760028601948577302634958037404439063837969135388070885354670837314122255590172068114698277784125117927007981444</span>]</span><br><span class="line">[<span class="number">10848366204360161190201838601526644734443113820650552986437505153450992200056823340141151742674767817453544156749578089227409053031617962097481521776333662</span>   <span class="number">466254183492325668919451039055771698384604100182759674795120489047042278059234019059188153771401000340845808733174674039516485589960062906265173837289198</span> <span class="number">10921271090992004425571514720574041745042089099081078076313350426422014335331996431858633260478331235478857142353555763351914296132631784505192949275079145</span>  <span class="number">7288970492151118783174993220841212730169158970234190580587866740148262474437762345342037679241572371879889945890007329381594422205510662492166668230830371</span>  <span class="number">6397385359643440993129806932869750977092933376572936915587094071677729740486038265010370491070658662538721096098743036356996731964988645692077979419008237</span>  <span class="number">2198594717244053005618379513209796592560948297208995089977741412663997213790188917071972785669240610376695576054681310132025792375692515529669708692557776</span>  <span class="number">9520960910870533443469065059911888759098912524292444208141409544622578579652558232062352363957469988249666511411470457384323777085080349150779715044658869</span>  <span class="number">5351828241184499297116755792921327536999933840192490755205576505604100703750341519511212041115300658003910089291549401398326757430081810294329244505940603</span>  <span class="number">3855931705495057619005445737270622363218757697416337611616587269958811152610940710323990742304040689224722012302853852655935222023866303951215982601062105</span>  <span class="number">3070247580379626252711429295928647357139650798883614629738592755102417062815400596483164617339683156061985035040877071341594280991144503950412416362358308</span>  <span class="number">2683417472616465058329974017360746635441516338768719715437384136210837582777147723356325046733457463592487011165951107735716602545826581670143279580753593</span>  <span class="number">1536629096290006627205200629837814172066314634058009077363019025097136735307946865323796047716398211865675713803243477480940579080522591906205466704816821</span>  <span class="number">5637939891132291367504319761622262297162823730038779206386079671354764898484793785101427217660687218413094891619267298865986676976979649192122591011909059</span> <span class="number">10478772278065088629560760704415663594182193734519737152164133480281058188050258377463704018998238535923058404279515474367650114715916554992541075921549486</span>  <span class="number">7958069612114493895717266295304173860680299751819750966899519332875705791380787758901489436892385222047714306620152588399142040202385467233510334630881914</span>  <span class="number">3272738683607729769409182530657878528660283322890285221536574204115431500290325313334077212566960758636101204287262866480357961886238245198230355741070974</span>]</span><br><span class="line">[  <span class="number">582226298901293853784046922922712143034091186467295125509572059014391374884097946851733617042838793758226602342938908170935669072801977956256441073078611</span>  <span class="number">4765907867467274822446742488572171986244654477423574919405713232657261805958122316957830710710009328386281695299565011072866700039824005518389873960941799</span>  <span class="number">3143259623553180070982026857530260136622534686256534265916447885175003618658210525719825601888384250931307665123092779127552761951592253318665603589128606</span>  <span class="number">4371129160084463383514075567350433656211778917917583221311028136884724968633499747977399004382490520148363863130388925149053819292465197900179286475823967</span>   <span class="number">304759497253189635079227037649211281230323572612289639495215955214697481662290615364852757765929832973577923767210646106937099890668063948535738713418155</span>  <span class="number">4975899645789028840399633935624338794296976491019676401658579790000712803983878522348023375942763685552000404141316655963469909834344056156102309640197309</span> <span class="number">10249228396790540381137408655980472730135869428595540912710818720470342009547171372291184063772414659431658316950240652781186533432205930326612764511737186</span>  <span class="number">4682071696480216227790281256980077056957804829489600661787329342778950746972413739717357942836038283492513591458589646384094950769350009895667726474111369</span>   <span class="number">467992918211696902434792525414892089169451202631727898722177877303207853852897939791256721384191676130870645554444857364488907277851774620717727951202745</span>  <span class="number">7509574849549393172668449881664482943671714872071167457564489413354846333380264310504462388400636855316645201135438167508114609097346833033701548287091429</span>  <span class="number">3154104640113282680173487954114382027303924687606275127463038233678354276584696557013535335760248154447205471394225495365887552866411183281041160725581051</span>  <span class="number">8647200848447854933122748352447500981274999620370242550636428723103786331587498863454746691069690668310558254232665435942736154483501145390286947736501664</span>  <span class="number">1868670041760171524789751730651337641863071579623266492977864408263488646344785489313786705879558501969024623720904841715255889391594972670795160142657221</span>   <span class="number">953035946263548256145304091312762009584175489666343990231188919662261629856254770391615925646077371876074455547493291592166020410227048982050220786949532</span> <span class="number">10573128788230977642012758457578789804291346998738138786716846377122877684194057449075250102216807687911307238975023191027501222036821876725096762292282811</span>  <span class="number">2155325357518630773467734078394913648860434826318018110876265505117445707978827048010369336191242126362342300206772896643892347150708199677967212868096918</span>]</span><br><span class="line">[<span class="number">11127639549383741776054498354419816260512835013668362718670377152120908136734734940373306636815007641832891961513984956005235291181404030755805565704727931</span>  <span class="number">8324282279724260180927293655079098433920297636437222606919983467485581141593105800321397101041601442883299452975113537722604166447130888335484590512582757</span>  <span class="number">3013808685268394146939967050907435395245828606821587178811550068669048573296855283324002011715343306121263363913106433368863178504476306254896246010702929</span>  <span class="number">2744122675476963848176986537452209560371598158060427604578452103702099245350489525461179672877103373917123833756558166966941884539135876644261762720417501</span>  <span class="number">1539702548810185639811350934929332071178828866994736933864881215046035003953149217144670117897724906397932562071592770556757838287984613960491707287295614</span>  <span class="number">6813277606762948078724183097430758496695474893959931124487623394106991509222410688201184506655506229459977792055473944284058387257533192493446512720686728</span>  <span class="number">7485797065393515416532714116593122619387345380299297181904214013793606094543492991563952859346809110217601503689648576294588452729304229384942687565714523</span>   <span class="number">995398470396663151395333299316183567559311362612501353715835204745719570870956155533953079743287266947283226137876179779512195006090849528641871205702964</span>  <span class="number">2452344843090275670485099696728479335462089213487192801940460447337510987595877903512691489546958472040212688824089356462939627479740051887520718163783553</span> <span class="number">10456906547270685444445605656523148021779312414223840511275349724795942313477745207978603163634096312582428755944002640721876968273402807741304526858745591</span> <span class="number">10325155193593525627901770931812351026898199522993990249136460333619451308276298819391233395834417640329426914676504457474508382548598169723637922320858989</span>  <span class="number">2532436360617398385348247449174455616213691528674256426769755726061390969668562927288609698503415427462111086396180875031877068370146411883742692746140928</span>  <span class="number">4978006140463095170025747410618342536948947000802567312599988534270530037319099305791723202332260811382069029630365108620214973367999151983539119628766125</span>  <span class="number">6100944666797890725053854396078638303221360791176295818795054019884203452819936210766409414504687247815168158192425377716294507053892707971146100376830321</span>  <span class="number">1019493096767062379630622444618220830977070206938650925347414944770573104031029086363472255574963960226456901260114850045809261450137475706432844131271750</span>  <span class="number">8009505036998407620697817270797085219922940044674641679844418033113114772011345985625391795611777824264868082028272876630392967459043036201605005284030433</span>]</span><br><span class="line">[  <span class="number">167574730855835707849745296520302353076665725524857213545317686775265910456556682126439887291764983893037312948026733197805968235106123253113876218363586</span> <span class="number">11176418756695933306695694817737432728319314399813785124566265741885943311100368399915863071867299405010829122313929438649358012072217274248198143010327305</span>  <span class="number">1418427879893213616548166272895117059612264261646643436377734760239811369132649199004997299968733699135789505417215590484106777385250260139012383551493741</span>  <span class="number">8286700278702448014138508362804429492791931433232842973229374217574768224600041715228659307925047710500080338585218046515737731274053977330792696333413232</span>  <span class="number">6329536571596686338501324902409706264450872398507489058735683440839641062770525442426080245329455368872627139535664520286679324524935779200744149964458395</span>  <span class="number">3971712711905784542952728985960452711185787177443172195525481038030676470886944139895404570974797677313957330289696837016316935715670031991498534443330780</span> <span class="number">11084065307848051954817914510686335067177573105948552816103797886660975481552070854814728269309326612934554400175818286914245809973275821904672703992853317</span>   <span class="number">533533081373246896481407124493821853427292733682179078944290762993506141575016491330148852545533444283995137103867849780092619782191639568825176213748021</span>  <span class="number">2560587851166426277108975031220111420680617246450294899877556607386534923678382116227678849981182590606935745408515251906985534785346561338705092852298803</span>  <span class="number">8450949764464643296265174771486269337623295830735849834606962962545097916967864887457153113259284296221254408085988442238341186742176791051568310541659875</span>  <span class="number">4329923280677602767091745585577369721910105038285577996262125017089498504182250722469279444131259704182158962353013931641952416175425565736567193474109001</span>  <span class="number">1517870280530826898472645649539617441585057859967174616812993006735610887866309597810189400218413943106870960299769704529223159744214533623014750428157569</span>  <span class="number">5553955673142945094594180123726546883512253378884558445064996406469575819597287088972244454967142929392250497268264459534693036201525226899134428610429023</span>  <span class="number">4775379850783213227183301065450973566845115994780307401231224540555572980984464222254349147598171830235032534146130784084191154007466830115207840268462998</span>  <span class="number">2215813608678496723393696889324157230122242379495098407641329300149501783549232765905075530692975101374102308033809445985637345839673268950307740544845811</span>  <span class="number">2532252446516128875289151781128204608693759321959222867356641665442943219257227905618585192346377773754255186251846832380455372573828395946029262995917597</span>]</span><br><span class="line">[ <span class="number">1569777804566516584463139489969730189552678665175266247769552727762867284638542284297321148646788609716003689617490574100603613477434301059743596796778557</span>  <span class="number">6664605222886709237768068784966122789813072907720297546241145334954363845123077284286016272791971982366876376047162456091792910319044484791420744051490543</span> <span class="number">10832425815716610433246481370262097472186217875110896997789470369392072224884973299478552675057450389739191213009560383805152629596107811281563792059592731</span>  <span class="number">8709265964788185735536477075126990225945553442292745894522654645860962526483048917629022284607009667862815282298964887048049218655106889234890123968050951</span>  <span class="number">2327059244920705974392419822450840425785821124466504048511551069172171135223780828009979443429924253082366339113621136995268720091200973105645136616140656</span> <span class="number">10948726698239127817635296772694385018899917203465506508904176597682516142581415011273068873804479724505934327550110710325068025698342018638110569984785656</span>   <span class="number">914084726397882086006604478549637519223581740934291617971615521242861794202431358323684729365778581105859551842117737083405041772918267292720727568898241</span>  <span class="number">4810161133151954601647221375802135807103513360545635501233268617461442185345098824750638147810716753493720381342614624351019879510596686063812068873325633</span>  <span class="number">1398892356062405528957250427298100633095954503411359040187916350128327450606222428153530768924934431521316524462410140556553292193770120154260332885565196</span> <span class="number">10605649584392103589073422735721462819889862892947844237430851205515184470090747831425134354384001302169376485153477083692413318047792512471654229455307965</span> <span class="number">11381558376032216773430762190331802072967918647300389098304346000601312631281080361915800574822233349256756196523198162329509646178829978843728439480834989</span>   <span class="number">229268940271927035065750842724564535046848809360140056760172532128371526727708744940316072905982103312794889214513462710345447329745675960086840417984175</span>  <span class="number">7548334601373851889936971791868818709604774750955230713291699970772722171357561811910008608321972442656333403501651432512283497423717094645881264611960334</span>  <span class="number">1663891959791989933942000823890586512067020427127602951585079267612128897300487046642207624016994533161183235793201156771458243977696717263890583484151538</span>  <span class="number">6238565998641122375992107927984549724267254523530728319495509947654157820413152952180751106136380940081074646621356621803088237291827989437276423338278258</span>  <span class="number">5147629550348491132131443097519485703202210038633003156299096343285362976217817640303553773775151348542792281085302076649772315233585217050126298270552201</span>]</span><br><span class="line">[ <span class="number">2997850394180081522537889632608287922660804513688293377640760136576623544279323944572461946329526768746944937080029617665094214398497527603893826581181460</span>  <span class="number">6201397226416401143405976231755087097812867827013187150742686100738208571121524218661339727383237720850596926947706370966076456017831947626529496996347243</span>  <span class="number">1797385373736611288058954615242661128844059374951879885326507499484773767575981204560193682472808816914235955784828613891127140731851736132975706218347296</span>  <span class="number">5737899328421802923453335116259806148148574191682536233778713398071565709133845075800805360828239999483981610406489013226074690660125717853762857195379925</span>   <span class="number">943050275382699815241724315751806290661293581664568634666240575612597811004202563736284191054413399280483538265113126848965059819852268208503649926153831</span>  <span class="number">5799363847095819367998521018340097914922146833502274542728716189653075304957830817803874635032212421958140270755872009340433806696940751242212153287240454</span>  <span class="number">4470376378033488827133615017119126437806901071854055115351686456264310156485764152544853172169275863723963964486459185758006884601569516027845808434343751</span>  <span class="number">9530309373273054737702943475726061006289833783159829635635435613617131271639622591730658159080616835067212336368516787856145343877203537140714633901730615</span>  <span class="number">6512944720543072249812709076168588365371588104950409932543359265108825697450190064981330642102809282761950777412952083128863983111624759423745310946390499</span>  <span class="number">2565353866861964643921743759091279576953629167430116965574138823609896094136741125101182425985387646010532483510245881869079735106687418714405811367316683</span> <span class="number">11500254084847996623273787924047101448713229462463270853888791924877537433224878348209119708935511314672442270462445607245623508926651699735789278304966452</span> <span class="number">11342411348667644561239442769607492249069601474173192963475521629473309285776219717816410483546922302539497395529723443297235272336676445224259664247505535</span>  <span class="number">7678819616223149173761517639473769904792044987224858161362557311247363926955023484426341076949597378616802368321512295686222802107266394833607313897455462</span>  <span class="number">3045685894702466453260450775643385530027311381493254841176819650955629280693843201101617292571515556683452889410128970670682088896658787791249268042058836</span>  <span class="number">2609142292129438049128903837629827254201110625629296584228841013086272995740530070498891479376026698701832935934993354471914026951015233388323962092494969</span>  <span class="number">8051728263203562740457142458202227591911986051642644947162282478945627157805772260545384821462168423394674235830607575118875403946473995187735224133146722</span>]</span><br><span class="line">[ <span class="number">1703204925740924784587443478009517085231345257843049275741725641255983471902016460474416455634888753330526361796858840124012745330734540584842103150994779</span> <span class="number">10875822326542710261960848644003004782053711962801242053816940724706963706686016897894920499609450918713272061677454513416412239537537648348067566949859212</span>  <span class="number">7782356817537113159647628753863865797419467611980355509909017533428891204846834243937919759453599174192285993763704548142463271962746160835768606842803333</span>  <span class="number">4273053553305568233828065733589717557322189409469708588742591279966248879958697808735433550535760407186415096646335746373351010784163027627864166170169766</span>  <span class="number">8833589445171251866752559976538620667942689848291552104938006627249611722677579971938918838042697781045672181488508431807654692686259539781648305121600292</span>  <span class="number">5178822824328714980133956234552339881065404607400332482317777022735503644257266963621887838657216462397533691525174814976504981203422650401940594493907921</span>  <span class="number">3666380440055662843676622424606634214466067526312948251267162251835521389318598724686180376279832025646322291497838376148917236084007553924148677121892289</span>   <span class="number">373144740953751270648681474520225008047677125815527635999904473348408774370958697777449296114578791467073793070673311707003316613191018660000349977950282</span>  <span class="number">8901963648583497189632627212796500321304871817592588916380588482465195341314913818181947829896454483159173888068291199617175737614342514409031501375980122</span>  <span class="number">6132055707707518404756496097617548569390088373147941929468670475212178210547556253777479876257890731803759132096234729174446761229167585431837092040168959</span>  <span class="number">2347806225561720070699326440053789444877180743058364488818799333585619215642579709895376043595355682476463396342584285790142902659296280612120478570006005</span>  <span class="number">3978754018730303492109763303325028802176117065980969141201886375065627115542502827448799169775307455172831114517042325792624804538127323833399871220021205</span>  <span class="number">2027313223728585563921035137509042436968140719051899171569946962512047694327356172065170494392026060053520662085564142862144794203167719622251973363513990</span>  <span class="number">4586428701496420088411823995931050828679283453990377872063430183300740587177559703557571031269743915499380717771627572421354719731587500003326790564625097</span>  <span class="number">5585547096995837309114048989432505360096937162634557224811345146847035094346327107961722290061903472194671318911954209399021736564350371098929997960160278</span>  <span class="number">3232531350127885526647309778098711259999972431380519624795077015755655306305827308842525327879656038628344041010529851441621829439928705469137596691421063</span>]</span><br><span class="line">[ <span class="number">9522484805207581147802385521130236167679184670981059197174105314440911718056913668206322140323763494312106036139899163131101904369321425687653280289403021</span>  <span class="number">4683538888864025365788062425440564975261063112941510039767861432500658161361664386396035429151500272908161740612281652247249584780775657022694261351746302</span>  <span class="number">7769087049200987635193800474183806704670000145994190043108324344352470130886346871885613694248649389797580969807333431842427091407198742733119833922793458</span>  <span class="number">1588511535342055765103698908572707902395933948556460262131140101182259556787538415465669287585494644206209911006633114427536309542612024868700982954516052</span>  <span class="number">7486665245715546623170038942506239393396124985006603440438562595416141107980637362828455253666921953722189338321765514036696812051724079045755036432197437</span>  <span class="number">6800536709440474509704270415053440522828704831077738520915449989016092892234464646289761476938996263711569886501528306424044628681984252482309447251395195</span>  <span class="number">6094058913407188850091996293944884374690191713369623297215579845945525085882386872165285116601751740638480734734636417474364616472071522058020693273095569</span>  <span class="number">9617062045845871381673865310728294430930777262555655920316927675687332611445604253136716092748793771666772632603399032450788949451093671621336121615371473</span>  <span class="number">7937290695574516558509341666411119380459929459770426825972068273754801022264849264166062953212675923987398047191200761489310798176423497186650797161039888</span>  <span class="number">8633649583363885138323440452778145020084349724388437438480618872577561446295895344924631277086036290616287111699824111695984473673061974872290159272912146</span>  <span class="number">8888206889061586358275259584044040635208116203311011286596657101515874139040535469104365633804799604902368088761703295586278827354148836041531955514128586</span>   <span class="number">921473805737320344175323191030081320142697317031123504940434537210678193668511077095655113553577471948999428399201772374978332180105433705202705733981524</span>  <span class="number">9897294637536259443877151632405765783593335869979320352038045991239956288242794806048210642500252413929438660791527518352996545328296776632091371099795990</span>  <span class="number">4803884534865939911240420155159645125821505917514567666454729434075524346358636075055432571874467323742537475815036502969443275874173155474857810862499678</span>  <span class="number">3284538323834307744493793702647530943550411407923319793062602535664404624897513493610854742447673404952255366819566912038475604246833397519898758034919664</span>  <span class="number">4235761336259035345133020629783592773894673862467134428375765227870635383772843518348214013935096166564432588833786940742542389630309722215278547429665934</span>]</span><br><span class="line">[ <span class="number">2411333563282420786893855664478224029221254078683836450068782440655517388210560506417465322753272797978974465561530757608788498995046492946806986363125771</span>  <span class="number">3070906070360832095808849642874218631409366402115640276547988432173258539967244274456482486716085736255127617746599019950709607258302047232893915541927409</span>  <span class="number">8694883543679230741623379414026149328005334232935444674535826555784431620289819303690600226476895303283255834427868706743857897270765258616136482579407151</span> <span class="number">10555709010867728190887917845600096795106634239450879472496998297684707447556752706878636130459858354774631938596925204404256558105213530215273811582551829</span>  <span class="number">9409894184909308562322912966147503018893501612935289677931932631869084299203236584318931422615588191836763665762017680136813689443194344457924484672619470</span>  <span class="number">1499182486740577680393380605249559933485025715269079845886856178480859177262942528742995531422016516576102187385039857353292995903745890321779634094995179</span> <span class="number">10751832852934836906628054237784422064993985767250347246348459697631816539271217118278051742665567352699893605858840098893490720795538391381201542474768988</span>  <span class="number">6018537117891320808048016906604497326189753593943474423738460206057469351533589722644252246703905627987852546640010690456310583927068705203501126968179071</span>  <span class="number">4130082105776591706303269371365144099844524435518526033544852989751273550939603502978522161516441086567796134143206974590995621368341783384941653131766468</span>  <span class="number">9130096087099362092611337965696888023996823069353441989784863213409293007023740006257004812130963238024827621927577185782162074038199510357984312956075487</span>  <span class="number">9063407851310386850660568396843024404758091353134029054687836928714864629232680057855530883954759892319193682102184512130984773666250909838803243414078744</span>  <span class="number">8626015035844544370150336616089468767101218983016498247579612355557991180446564833417313810603525319866950416344723747183098585766080954811674972456752874</span>  <span class="number">8391289060874751673653262929399741104666280364248928009579192418830612963385377087618906581701450339006020787262506499283954422235427673282504733686724436</span>  <span class="number">9259298150488309506306137158940724684749389296745820930640103922061126282766880195347952234444796249637081736578281668559812195443185563880405216233246752</span> <span class="number">11656517372345244893441337306389880981837490036689874469745576739700054124964132350254792441044730012548092332748535295170167017079016039707047594295678807</span>  <span class="number">1037921753331909957334249667589721937353366148893069789934217022980032820386768382694745894507748414199388028378516650728757243512201897781100100477953350</span>]</span><br><span class="line">[ <span class="number">1870441265814450197569761244581993635194893244329061536550641823817036286779809792709412565009363133217940225463451974344821852240987994787165508599885367</span>  <span class="number">1780378938789693753903501307382406980073491239939239049417635821031599560241228890087384423232031397888157080753634892366468687004182849733695905338416893</span>  <span class="number">9043997999458244570826057697144520919277791075436586209599833089618051380988926577067195940436749688993478476234853310800724262613981842922113750319123868</span>  <span class="number">8073244239729151608620997635732006072712787906221151258667546610103073972751117746637572568537779469443941278875218038632352175392211894551862952047179694</span>  <span class="number">7339467016122976239727026605963879762518264993728257555607929145393673882627591771372949791988174303305929018781541060889166254388651151435389554176426142</span>  <span class="number">2465783395178081441360804333061413713866813585759988321263090221983898323300869798347463996207472228210320289531804555480226513481563688270678190527472955</span>  <span class="number">6631814738431278439205875884564840157113627841893927054308554354609483872377926468134156122793372337272760064067326265656761087690384370614927075385938205</span>  <span class="number">1294708456352760826427025156414384706258564521364087263617648335591332605528505097643431562435872627808157543152103706263622602852615603842364729817356412</span>  <span class="number">5919124655593726948181324899659731077006438415228547146536138724811766568305369573789194846287463907372515588382737472428302879399652339536640807294672302</span>  <span class="number">4033516428741350950270187793171903513454201729086283456867646256146595210031097556991133802505356810009767130497445059022408461955008925085881488770562447</span>  <span class="number">3287628474670831538118344790677812833002551700091615270560766075292122909817275540511414867600447411424895287707479032209926344202582873378564107848518647</span>  <span class="number">1659114360136013396261107919036705766089228746238821997511969056243137368708365657326846603833333583724876162545142898561994668866171997844858584249684231</span> <span class="number">11523091044895161002439322233363120111992483327781178702891378343195848749088813001388098236917297351110003961844332021273450423444936914123758259948388597</span>  <span class="number">9644959932693987802572070598854222543647821014575844181271949000442783075108945330222729180810118440166157281262184694549841956985843297382497650380358949</span>  <span class="number">9825199257119029411253573677042454272629405863171831703025146521832993361858805819124659178364976734106970589818026460828840899987593769609448927862198728</span>  <span class="number">5966162168774672225865000624710994323850468370956358193204405739976937535849790038443580669597398251504250967294431365605986196246662264088144187465407413</span>]</span><br><span class="line">[<span class="number">11389844625400983111632802117273518527792639607832000487618370196299844739227200590193154747001248363576893580506363192110368419618054050589409215966448050</span>  <span class="number">5907175581194877263147954380363329184256744154721236428476307335184079300630855424168344522057127975861501377177883063337442275864871465228413836933710967</span>  <span class="number">9584573906923183296170838006745027566831313473801821357495402474835794881758716604397549078605684595949026586287607864173531234696019750246884681757617474</span>  <span class="number">4570384233064673596578194878867715071000853928957767381587887062705772320329533068506668520675378265392451410992776799743300161519069437980502715891141811</span> <span class="number">10598121732585238856183256227184675849265162104509613820467207261847845293956656965560010870015582422718321201644945327226369580444802449169792827612441981</span>  <span class="number">9413150163703163097370398217271456299052536491986879973547741619913870269529861209318930745741032360981844936425248805157277241984671670660809812335939166</span> <span class="number">11262028974483920130632787607892841340618171389842623579679124671663094124852999175355056379923320734015532701126140255780430364094606601708620039259085787</span>  <span class="number">7623195189059907926026281270680326819993135087088999036275254711732485169635699253449231899076422641902666152078272216370246368112345525088477966372898954</span>   <span class="number">629090681978038578144567434197511109316116380612480680483747016729583529188967036225779513694233704878308116697082327486479016484669444128245364883493436</span> <span class="number">11584578577436368187314284041550145040102692906614906734889001757902248703974918365017642377546630873065038888939646638143258908812786933859982200321086513</span>  <span class="number">6394511763921016690271883230270961300732030576133530513541038127366740679594113116228983531073837729653115947822106586185869450260002504462520406156945233</span> <span class="number">11450657744623684926938229262598769264548273005776213934879945710026693048080614998749315291038406653507065049869780257998225308270849335915814759133290130</span>  <span class="number">6349016415383796459790615831302652587257801922778877178445489055270136207315023533389791710694998990079297909455024798089571266097111985186986284696099618</span> <span class="number">11256328667277069571395425054076978226830451147562476089698801828354209656537558300034588550868704317328309674637961427360637844026895093485739195206826383</span> <span class="number">10675531209844398408770736626479000683279046948026530059352956168320112070029736724305480461121440828983592554099957306293011983874908502121588587059473992</span>  <span class="number">8666438623320283730063157502753030251505948561850523555032604922230417579084809915585294227716898907238402276411862848306784973845424045141751296026960872</span>]</span><br><span class="line">[ <span class="number">8397646488965352797880344518612026046772901102928359219419241210608166911187498192731111773891406660947985269256478103799126241048003999683657055824372224</span> <span class="number">10021760358718161037465341621518494139551329672260735793381865990611885121611887939409513030011818228371009023839714766694113784152434692881383891782719925</span>  <span class="number">8979421276216568709080021384800936118300649562371355424529521854145777822435072836937283147096002181306822987474555971122283761644609268103755298074436843</span>  <span class="number">5969131421922569216826832018200833342084584098352194403646766085188152224600694785230165030297719540831270321172201097510083317299280216641501067009695143</span> <span class="number">11162750234555322065939938071893430229077867741205104449160649817458219081497809664052344647891144801062740122494542131630076870638930287438707836132614653</span>  <span class="number">9164147641923636697688623106663005485051159750009093264149802041247122154568016861749014596576798595452138143821407199523888526984027535660469552798272924</span>  <span class="number">8617734345111611940044759692065733604166295739393963038087862828352852880564904357289902403234905722392311920387264086703521303176920160632818715367013017</span>  <span class="number">1436571864516090489307370938576765136254485413331710961201046566771938722566508725214492290062525754895801979967774127815691131849758893727912765321602680</span>  <span class="number">1250413226308587843099449692723109990534939031485769809075721561044903754243720697293855292715576325841169394870972873390863461614178562069273135886938648</span>   <span class="number">751236649873176407479291606348103204811747712780196402662023876932128686918398640089825402320324868306854927813800343866105536520410529461119120368650860</span>   <span class="number">453069723222368416881486483911950668138419383121240762354437173547576724613722672983739835564205902295097476150278509062624429607367275626845939772526812</span>  <span class="number">3368084674576560647589203668405924662833057310652059063028436821980773040037895814100878270259671641397928396962893212059678292317434956042604386280157266</span>  <span class="number">6281508974832275870894093563025419893700527972622188924247640162387603121261145239817111815455891711932418174341940771733939402196709085746511661631692447</span>  <span class="number">9683054057946161094749928432683140108475688180124954349286662274813874512632270877456346886261395421259897860015268404568176598554964246409077790063019963</span>  <span class="number">8127645881702485418357641619445522648725237664482414269277005229668763158549519346268574723766608966699504330063008164706481208866638416775922432959368839</span>  <span class="number">9596313955398550252713349388198413314796603687553500013381328884853120125976215186308785303963336227648163637123983281157390312455842733600207439762249946</span>]</span><br><span class="line">[ <span class="number">6897579440485093275440941814484632591048635019693091627380561412961490044638518843085217496740214201158150985451832099028958743646130565166819393292834571</span> <span class="number">11504869974283068414532888675565397162645504054049483321285207192530405172011513354131031857265966312249530939291997822002432126197092567844134300124901848</span>   <span class="number">132627997868381269431524225292682662444179350675646014675341439163585579292768549702101933930954672524528344948088780925695184105352217389006348313110337</span>  <span class="number">2061678209985825522732804114498146316866509540209590336232312019128427472761224763715178065931094937607631760270658950258618082798120754240250576404733796</span>    <span class="number">29444996071058460615393804879974167064648117202658310000138246009475025457016655483775718792808620590657503672266856770843806159522708875085375788755525</span>   <span class="number">196444444980258267816497009861957025298098060503376571056725949649075967620552943295048011668470162192160805378947012122041790679013434453241450230877069</span>   <span class="number">415532069123491794981616735755887405459039412611589653489138512909484122764325531826964252126060894724484958733042866793963128214232365200115145228393178</span> <span class="number">11202220304080308198734799534296956842016864278153646296088788903099924846924765438623875017667675464907336633556100306925424105959497363815292913227040083</span>  <span class="number">3152864554692428645036948099053687725954776916682463021671620178051226047317568195403312010455614780352781174061225890922948584634897984596007796119845871</span>  <span class="number">2703204098736599158365472031931765976385409948168610388016031008022229224802439226051581432550337828714991968502837905394441715808457289809604962046153587</span>   <span class="number">918445635293318673188002192395618663583072712209914118839933822741333508296787730526278449674938486887221768516751104259902111905025729753929988227369328</span>  <span class="number">1447875706869450361598651263332249308488105196829458752972588240713715475437029333944497299442427310314505451227045797968368154550383975173027411300854084</span>  <span class="number">8171387616234798131124673250079198983336444454540484375108694736873832822770326081704347017679968488005494969717313982085654231697952479519241665047254754</span>   <span class="number">897616872912287780414847615233198397225285855684926074710933094055296678639080187389081444179352730892730890384203388761997465477409117384019939171819975</span>  <span class="number">7535958468428611647884576105165744283754487501563136382347710955725638122777473989486775226574840720803179069501727566999307477849922603958190816638064505</span> <span class="number">11648362011405806648312519230479974885052898927958630342136862368068940578544878526380473294387329214351838156778506232539790384514834721848226592656499623</span>]</span><br><span class="line">[ <span class="number">5131405885334035932262234571113811405609428191014843252430658143285836801391272917121643149447787967422040614973013038055969380390135296694590143788259245</span>  <span class="number">4299800458172831580070935059111373225515177641739666376446078374778336826046469286038229762490776893330845992428220222702911045327221717133617311845959931</span>  <span class="number">1073186135675429745206953817046509082099469126865477761364404163139813944324945480653080695499969429276109927808148823024432349821779776222012777630059327</span>  <span class="number">9067476814819929608650021909190280536752720057067461003893233898333116139312379911007723089543887994878129197829157922180418679109160305835756826928481198</span>  <span class="number">8358167354992118639376210506424128839288841602056272696543529708242073457817879770380926455017104031663145712490504038671871944065157375882096092472975051</span>  <span class="number">5224664056690383762723154009842313545840413519029959060930243565098549444980967852204844091435971195148596144039188505068349067662796941245920141273388221</span>  <span class="number">2249143626860619165534840995160580212915599619200678736936791314958831627255389530004515331294447253203673068602733617708683979302279247200887437728313912</span>  <span class="number">8076342246235155189882781398225698730681697221324598022222235756013438590841416172853923048691241086099108713917651711583612488577154665483518093617797944</span>  <span class="number">4958791470803887068193755412283607295421374360138234854606842211840023282054791830866737451931430101612963338855541882274558441086530372885521129736173706</span>  <span class="number">5158610233843471913484001871217853464000889094226012035331250520228041913818785426368476262918699399020992250997162751231492601359700737249187126330681138</span>  <span class="number">1581896428910552081519226674670265455586743884714258618746140934380251097029147337470191713861512704215639806576597824847599739367190628380204239395339603</span>  <span class="number">7724667247511915255454922654331661148309115333919546884341143918322655125539111921648098280825833953929059738575552788245828338300854427822770125450397442</span>  <span class="number">3960489595716495425647663888395730950482903059070577297925636506806601701744807804337278396821360617485792915889739087457473192436719998319111965361288415</span>  <span class="number">6134015209677961098815086314163834841914626133621002593041480845458997870077583829849270716448091073991696433958478909901308666940996441764456681192941310</span>  <span class="number">9495899915191730948016946372195441287345094967787803624633530078429412158625603588848491077965700765128240200136826032588677496386023298686605141873747533</span>  <span class="number">4915609158211969907149021527557793454323638177305197730481659267111500774127276667966464640383884309214971505833204014557838987277951232262696742422290800</span>]</span><br><span class="line">[ <span class="number">6313485820374975246860818228644031125980939305495377386516366585742277167082977191509447761162391460341345647191508937921263241776733279945049222303373775</span>  <span class="number">9445115289233320099392728232739317521778995735623243688682825536292118385291516891419682433210583251749477427330778686981311891881332210340598217025065556</span>  <span class="number">8191886594932320197690206168134110911871921688208216468109519824029103083672667796351171085979077152433376182700596969448040058634093253356041958812879303</span>  <span class="number">9578033582428330866813378005386565603384349791756040521216395116353160406454901744284215823301694199028404288588957389283491004307066719703796947340809917</span>  <span class="number">9482969889043070320403029947789530810539312697547301170109161327261127083973440546623016094249204362933347893171796941149146619375571407445303773331703825</span>  <span class="number">8224539987360979051101159687426683697015188123742820718828857927563555238876237081442960097271377015949080907160002720785299757232074089769839600588194176</span>  <span class="number">2705691002874101971933645182212004165430174861368524142860472839252300504548346169147908980526093986823196980830073444468721880718974370439753178372196315</span>  <span class="number">2609763494203936257328069396755221481156356892280394905624943949760709204289092307426690709372561006022971022530803793416445778855095848319858772634002839</span> <span class="number">10058117298049709223368321763572892376150662995062088818328235184342451794867069434538805489226053549346245767640663292339114561737612613272679674426322210</span>  <span class="number">3750204344710700393263525322284597963116737777486731083842387863016798596533770326500254636417998674081416055130189130382026284995387315387203159974614703</span> <span class="number">10426453382866347989819589705743288597665458677205697338952897650994934168038402737633757945475829500250799666240291760299133671945183212193601169135936326</span> <span class="number">11005118424096139891056602174690293895599463958926434241810568312780035367787522922283140700466316394733324995598465970361059225475702555598455217205310551</span> <span class="number">10673938806271485606255021403473960428706528980451983024674696469094904911023607435695197821415844283375000312149112388533215845657915684251370485967917650</span>  <span class="number">4398840328539709147708139362315643355433822270279575543855001988703316665955128032565661551958496363551067840991254943070538208054602950169872544372514109</span>    <span class="number">42747420965516818941154714037247003833719572583043096473043557949973442371088389260754633589580537962141694599969376716547931143734765210813833586730186</span>  <span class="number">9318840545999061093142299397801391135591542884015241740827434875020014184390667433629300670281188594099508302974529368093003590258401800751626574496975832</span>]</span><br><span class="line">c1 = (<span class="number">3166144113409433580813839031075964666543896435346867530089667515883537394676829565440634835190211114307010012912223822601686448889916897002334562419856150</span>, <span class="number">10930272896342945537739204783295333208495837516324321926979170851729300196271710716278290222755507156341783478160552618068107920037848213689859563140304929</span>, <span class="number">6379294382906040063502382979515406746321050805763801492231038885805768658505261665790627474174574396155133349719104456231931872055400176757859142277938586</span>, <span class="number">4397226929465131626989235057995008131894700605320928902757769427654147508029881204496097908648600342139081339733579419437437611261347032873453734502302070</span>, <span class="number">10006687917554749824127523870087186903098832943183979078977253862182953618886168436175942455681168931455049247294000700777615047812177633384216463375212881</span>, <span class="number">9321528903175051614070436150773481383594117436801678673883753968725160991698004859010169292566405150898656782077869726788230991863332634655159947917337853</span>, <span class="number">11524595593714027829792271088013642169783062061016324650759542861867198708018353842116190557787841379428414029322101828745071816007779642308357182498707100</span>, <span class="number">3188272381186549813302488278983329764885991625209917261939355083764048843300425577092390182426328880903269642151422699815423035997121538747368410215890918</span>, <span class="number">7610544694889030820080872733267332558240673674364968816746504598286389841757328582833296560075950873372082666405744504513879614579909913688553634045250845</span>, <span class="number">1465223179962290139936817702021062368956104853286036934686668101654064560330192726518145736189706334373930794409762488984124447091696433442215169732414895</span>, <span class="number">7025242267860931929401203620461262571571817332118436446169714841907666740181879376388985187361678135766188368485738209951956700783076041228005655652725793</span>, <span class="number">2665234620538688231167407939697346933754977146456580170193130367040949742393963909955559408816394881100545076543913434246925083790524693255847017082367387</span>, <span class="number">8600038730619055635902514545162508151144468789888696406296488651951157822189322145348010655551094806680329595209446924831992722415317667008746582082495675</span>, <span class="number">5542289822291791589715598176945254589111648232497656942612307873723644116486750493489701827783213540500405854206420118306886256549724655800326129898007895</span>, <span class="number">6573102035055801544872080972838984718118985369132207122010762536460412595265165167869412398677958808547838640685170917385093807206098062348143388107030461</span>, <span class="number">894990089240641252427255584481344341276584793315096681055638444558465749972035134569532322393381833391097043773177158869261589289555369898197568077479988</span>)</span><br><span class="line">c2 = (<span class="number">2494767299922768119966304157615544573281840712788050743310815843088606208826506798182423422612207921940191247843274664715522595500311725626787860311905779</span>, <span class="number">2382892837591516109796897578502619296738643486683059699110807061070647166859189870727637960681046613417850607198029130794496709351068093782480286800998312</span>, <span class="number">1938092671564729554410991610167064221338650843766282587438194653554180283448855577553129777267130474546763513710399512542827162548035887348885043284096892</span>, <span class="number">10056275305991735937461320919611368609107706999663414104392795690847294597338193779095228050105708278793597862090819360353804639855761860539119376561636538</span>, <span class="number">5932330661095519477541489017993825757488186784982658176722299977717898047999350995760469796176058082979227588900412665248435726471814698310501937767916848</span>, <span class="number">9674272255243904514628785356944352826058199311974554196761660992556564821545050628111582703612893432116577904974535922839925808445152893994869601237044110</span>, <span class="number">416121676363446620962571546745210868149450177349664715322759306013106618214436850123014365098930655624947877614392478106533783289360220629828711949548935</span>, <span class="number">1353741652212740844105673273558085980677642556949776050496826731304236059184964882227673922119867175097022437189123084120379459278386848690418338375196151</span>, <span class="number">3006871626772781231819888001720781266327049479293607803876487587088207535243116644892632593359322107339179460799063650468928143130800033677808065764573744</span>, <span class="number">784916531617250326992925022015957310339285250090392790736598710698527323713523943874546261817072810796863187183817174542557666498314118508366438566378607</span>, <span class="number">5833649388956828428504159063143421417915264475018821550654308483202441342809930834060051525291450843350208318543444273560349326130493390363249983502511726</span>, <span class="number">3558761440688563821959675021188168744275978189685744824332633745398421189026582096205885594433864178853745824802650832002143622606930736987689799939601193</span>, <span class="number">7043556561389701875853310212783761959226879202877197403227687173033725507323019359495673562666222088557972469469856102954556490294532543627371681455240366</span>, <span class="number">3034929722789552417427593116596567447493798371268181326072733599789255734353372957964532478787763914652720202163546211557367706500320940355978031490492397</span>, <span class="number">99030763885712035359521393349205763705723430110750166632832701106799607821327068761308965990810132567427530648228435398583626878014752326840794229591972</span>, <span class="number">3262108991133706000945565316697095077633537965775913520975580240043868288609456199183795480855854397847657367405787846138551116563298369395227781069106672</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>题目加密流程如下：</p>
<ul>
<li><p>随机生成512bit的素数p以及一个16x16的可逆矩阵M</p>
</li>
<li><p>把flag分成前后两部分，转为整数m1、m2分别进行加密，下面以m1为例</p>
</li>
<li><p>分别生成两个长为8的随机向量u、v，并改变u的最后一个值使得向量u所有值的和为m1</p>
</li>
<li><p>用u、v按如下方式生成向量U：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">U += [(v[i] * u[i]) % p, v[i]]</span><br></pre></td></tr></table></figure>
</li>
<li><p>计算加密向量C：</p>
<script type="math/tex; mode=display">
C = M^{-1}U</script></li>
<li><p>给出p、M、C，要求还原flag</p>
</li>
</ul>
<p>既然给了M，那只需要：</p>
<ul>
<li><p>求出U：</p>
<script type="math/tex; mode=display">
U = MC</script></li>
<li><p>用U求出v，进而求出u</p>
</li>
<li><p>求出u的和即为m</p>
</li>
</ul>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">M = Matrix(Zmod(p),M)</span><br><span class="line">U1 = M*vector(Zmod(p),c1)</span><br><span class="line">U2 = M*vector(Zmod(p),c2)</span><br><span class="line"></span><br><span class="line">U1_ = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    U1_.append(U1[<span class="number">2</span>*i] * inverse(U1[<span class="number">2</span>*i+<span class="number">1</span>], p) % p)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(<span class="built_in">sum</span>(U1_))))</span><br><span class="line"></span><br><span class="line">U2_ = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    U2_.append(U2[<span class="number">2</span>*i] * inverse(U2[<span class="number">2</span>*i+<span class="number">1</span>], p) % p)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(<span class="built_in">sum</span>(U2_))))</span><br><span class="line"></span><br><span class="line"><span class="comment">#CCTF&#123;8uIlD_a_HE_bAs3d_0N_thE_pr!v4Te_keY_3nCrypT1On_5ch3Me!!&#125;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>处理这矩阵的时间都比做题的时间长TT</p>
</blockquote>
<p><br></p>
<p><br></p>
<h3 id="Clement"><a href="#Clement" class="headerlink" title="Clement"></a>Clement</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Welcome to Clement Crypto Challenge, we have gained access to a very powerful supercomputer with high processing capabilities. Try to connect to the app running on this computer and find the flag.</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> signal <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> rapid_factoreal_check, flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">die</span>(<span class="params">*args</span>):</span><br><span class="line">	pr(*args)</span><br><span class="line">	quit()</span><br><span class="line">	</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pr</span>(<span class="params">*args</span>):</span><br><span class="line">	s = <span class="string">&quot; &quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, args))</span><br><span class="line">	sys.stdout.write(s + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">	sys.stdout.flush()</span><br><span class="line">	</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sc</span>():</span><br><span class="line">	<span class="keyword">return</span> sys.stdin.buffer.readline()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TimeoutError</span>(<span class="title class_ inherited__">Exception</span>):</span><br><span class="line">	<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exec_limit</span>(<span class="params">mt</span>):</span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">decorator</span>(<span class="params">func</span>):</span><br><span class="line"><span class="meta">		@wraps(<span class="params">func</span>)</span></span><br><span class="line">		<span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">			<span class="keyword">def</span> <span class="title function_">_handle_timeout</span>(<span class="params">signum, frame</span>):</span><br><span class="line">				<span class="keyword">raise</span> TimeoutError(<span class="string">f&quot;Function execution time exceeded <span class="subst">&#123;mt&#125;</span> seconds.&quot;</span>)</span><br><span class="line">			old_handler = signal(SIGALRM, _handle_timeout)</span><br><span class="line">			alarm(<span class="built_in">int</span>(mt))</span><br><span class="line">			<span class="keyword">try</span>:</span><br><span class="line">				result = func(*args, **kwargs)</span><br><span class="line">			<span class="keyword">except</span> TimeoutError:</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">			<span class="keyword">finally</span>:</span><br><span class="line">				signal(SIGALRM, old_handler)</span><br><span class="line">			<span class="keyword">return</span> result</span><br><span class="line">		<span class="keyword">return</span> wrapper</span><br><span class="line">	<span class="keyword">return</span> decorator</span><br><span class="line"></span><br><span class="line">TIMEOUT = <span class="number">3</span></span><br><span class="line"><span class="meta">@exec_limit(<span class="params">TIMEOUT</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factoreal</span>(<span class="params">n, k, b</span>):</span><br><span class="line">	<span class="keyword">if</span> b: <span class="comment"># When YOU have access to supercomputer!</span></span><br><span class="line">		i, s = <span class="number">1</span>, <span class="number">1</span></span><br><span class="line">		<span class="keyword">while</span> i &lt; n + <span class="number">1</span>:</span><br><span class="line">			s = (s * i) % k</span><br><span class="line">			i += <span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span> (<span class="number">4</span> * s + n + <span class="number">5</span>) % k == <span class="number">0</span>:</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">	<span class="keyword">else</span>: <span class="comment"># Otherwise</span></span><br><span class="line">		<span class="keyword">return</span> rapid_factoreal_check(n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">	<span class="keyword">global</span> secret, border</span><br><span class="line">	border = <span class="string">&quot;┃&quot;</span></span><br><span class="line">	pr(        <span class="string">&quot;┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓&quot;</span>)</span><br><span class="line">	pr(border, <span class="string">&quot;Welcome to Clement Crypto Challenge, we have gained access to a   &quot;</span>, border)</span><br><span class="line">	pr(border, <span class="string">&quot;very powerful supercomputer with high processing capabilities. Try&quot;</span>, border)</span><br><span class="line">	pr(border, <span class="string">&quot;to connect to the app running on this computer and find the flag. &quot;</span>, border)</span><br><span class="line">	pr(        <span class="string">&quot;┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛&quot;</span>)</span><br><span class="line">	b, c, nbit, STEP = <span class="literal">False</span>, <span class="number">0</span>, <span class="number">64</span>, <span class="number">40</span></span><br><span class="line">	<span class="keyword">for</span> level <span class="keyword">in</span> <span class="built_in">range</span>(STEP):</span><br><span class="line">		pr(border, <span class="string">f&quot;Your are at level <span class="subst">&#123;level + <span class="number">1</span>&#125;</span> of <span class="subst">&#123;STEP&#125;</span>&quot;</span>)</span><br><span class="line">		pr(border, <span class="string">f&quot;Please submit an <span class="subst">&#123;nbit&#125;</span>-integer:&quot;</span>)</span><br><span class="line">		_n = sc().decode()</span><br><span class="line">		<span class="keyword">try</span>:</span><br><span class="line">			_n = <span class="built_in">int</span>(_n)</span><br><span class="line">			_k = _n**<span class="number">2</span> + <span class="number">4</span>*_n + <span class="number">3</span></span><br><span class="line">		<span class="keyword">except</span>:</span><br><span class="line">			die(border, <span class="string">&#x27;Your input is not integer! Bye!!&#x27;</span>)</span><br><span class="line">		<span class="keyword">if</span> _n.bit_length() == nbit:</span><br><span class="line">			<span class="keyword">try</span>:</span><br><span class="line">				_b = factoreal(_n, _k, b)</span><br><span class="line">			<span class="keyword">except</span> TimeoutError:</span><br><span class="line">				<span class="keyword">pass</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			die(border, <span class="string">f&quot;Your input integer is NOT <span class="subst">&#123;nbit&#125;</span>-bit! Bye!!&quot;</span>) </span><br><span class="line">		<span class="keyword">if</span> _b:</span><br><span class="line">			c += <span class="number">1</span></span><br><span class="line">			nbit = <span class="built_in">int</span>(<span class="number">1.1</span> * nbit) + getRandomRange(<span class="number">1</span>, <span class="number">12</span>)</span><br><span class="line">			<span class="keyword">if</span> c &gt;= STEP:</span><br><span class="line">				die(border, <span class="string">f&#x27;Congratulation! You got the flag: <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			die(border, <span class="string">&quot;Wrong response! Start again. Bye!!&quot;</span>) </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>
<p>题目需要连续通过19轮挑战（降低过难度），每轮挑战流程是：</p>
<ul>
<li><p>输入一个nbit的整数n，检验其满足：</p>
<script type="math/tex; mode=display">
4n! + n + 5 = 0 \quad(mod\;n^2+4+3)</script></li>
<li><p>提高nbit的值</p>
</li>
</ul>
<p>由同余定理我们可以知道其实每轮需要满足的是：</p>
<script type="math/tex; mode=display">
4n! + n + 5 = 0 \quad(mod\;n+1)</script><script type="math/tex; mode=display">
4n! + n + 5 = 0 \quad(mod\;n+3)</script><p>而既然有阶乘，自然会想到威尔逊定理，比如对于第一条等式，在n+1为素数的时候有：</p>
<script type="math/tex; mode=display">
4n! = -4 \quad(mod\;n+1)</script><p>所以：</p>
<script type="math/tex; mode=display">
4n! + n + 5 = -4 + n+ 5 = 0 \quad(mod\;n+1)</script><p>因此n+1为素数就满足一式。而如果n+1是合数的话有：</p>
<script type="math/tex; mode=display">
4n! = 0 \quad(mod\;n+1)</script><script type="math/tex; mode=display">
4n! + n + 5 = n + 5 = 4 \quad(mod\;n+1)</script><p>所以不满足。</p>
<p>同样的，对于第二个式子也要利用威尔逊定理，所以我们不妨把它写成：</p>
<script type="math/tex; mode=display">
4n!(n+2)(n+1) + (n + 5)(n+2)(n+1) = 0 \quad(mod\;n+1)</script><p>也就是：</p>
<script type="math/tex; mode=display">
4(n+2)! + 2(n+2)(n+1) = 0 \quad(mod\;n+3)</script><p>如果n+3是素数，那么有：</p>
<script type="math/tex; mode=display">
4(n+2)! = -4 \quad(mod\;n+3)</script><script type="math/tex; mode=display">
(n+2)(n+1) = 2 \quad(mod\;n+3)</script><p>也就是：</p>
<script type="math/tex; mode=display">
n^2 + 3n  = 0 \quad(mod\;n+3)</script><p>所以自然满足。</p>
<p>而如果n+3是合数，那么有：</p>
<script type="math/tex; mode=display">
4(n+2)! = 0 \quad(mod\;n+3)</script><script type="math/tex; mode=display">
(n+2)(n+1) = 0 \quad(mod\;n+3)</script><p>而由前面的推论，我们知道n+1一定是素数，所以他和n+3没有公因子。而n+2和n+3又肯定是互素的，所以上面的式子一定不成立。因此满足题目挑战的充要条件就是：</p>
<ul>
<li>n+1和n+3都是素数</li>
</ul>
<p>所以其实就是简单爆一爆找twin primes而已。而由于有3s的timeout，所以用gmpy2的nextprime去找会比较快。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&quot;65.109.192.143&quot;</span>, <span class="number">37771</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">19</span>):</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;Please submit an &quot;</span>)</span><br><span class="line">    nbit = <span class="built_in">int</span>(sh.recvline().strip().decode().split(<span class="string">&quot;-&quot;</span>)[<span class="number">0</span>])</span><br><span class="line">    </span><br><span class="line">    t = getRandomNBitInteger(nbit)</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">        t = next_prime(t)</span><br><span class="line">        n = t - <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(is_prime(t+<span class="number">2</span>)):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    sh.sendline(<span class="built_in">str</span>(n).encode())</span><br><span class="line">    <span class="built_in">print</span>(nbit,sh.recvline())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#ASIS&#123;gg_THeOR3M_0n_Tw!N_PrIm35!&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="Goliver"><a href="#Goliver" class="headerlink" title="Goliver"></a>Goliver</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Welcome to the Goliver World! You can play with ECC points on BTC curve. Your mission is to find the secret key and sweep wallets!</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">die</span>(<span class="params">*args</span>):</span><br><span class="line">	pr(*args)</span><br><span class="line">	quit()</span><br><span class="line">	</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pr</span>(<span class="params">*args</span>):</span><br><span class="line">	s = <span class="string">&quot; &quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, args))</span><br><span class="line">	sys.stdout.write(s + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">	sys.stdout.flush()</span><br><span class="line">	</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sc</span>(): </span><br><span class="line">	<span class="keyword">return</span> sys.stdin.buffer.readline()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ADD</span>(<span class="params">A, B</span>):</span><br><span class="line">	s = (B[<span class="number">1</span>] - A[<span class="number">1</span>]) * inverse(B[<span class="number">0</span>] - A[<span class="number">0</span>], p) % p</span><br><span class="line">	x = (s ** <span class="number">2</span> - A[<span class="number">0</span>] - B[<span class="number">0</span>]) % p</span><br><span class="line">	y = (s * (A[<span class="number">0</span>] - x) - A[<span class="number">1</span>]) % p</span><br><span class="line">	<span class="keyword">return</span> (x, y)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">DOUBLE</span>(<span class="params">A</span>):</span><br><span class="line">	s = ((<span class="number">3</span> * A[<span class="number">0</span>] **<span class="number">2</span> + a) * inverse(<span class="number">2</span> * A[<span class="number">1</span>], p)) % p</span><br><span class="line">	x = (s ** <span class="number">2</span> - <span class="number">2</span> * A[<span class="number">0</span>]) % p</span><br><span class="line">	y = (s * (A[<span class="number">0</span>] - x) - A[<span class="number">1</span>]) % p</span><br><span class="line">	<span class="keyword">return</span> (x, y)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">MUL</span>(<span class="params">A, d</span>):</span><br><span class="line">	_B = <span class="built_in">bin</span>(d)[<span class="number">2</span>:]</span><br><span class="line">	_Q = A</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(_B)):</span><br><span class="line">		_Q = DOUBLE(_Q);</span><br><span class="line">		<span class="keyword">if</span> _B[i] == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">			_Q = ADD(_Q, A);</span><br><span class="line">	<span class="keyword">return</span> _Q</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GENKEY</span>():</span><br><span class="line">	skey = getRandomRange(<span class="number">1</span>, p)</span><br><span class="line">	<span class="keyword">assert</span> (G[<span class="number">1</span>] ** <span class="number">2</span> - G[<span class="number">0</span>] ** <span class="number">3</span> - a * G[<span class="number">0</span>] - b) % p == <span class="number">0</span></span><br><span class="line">	pubkey = MUL(G, skey)</span><br><span class="line">	<span class="keyword">if</span> pubkey[<span class="number">1</span>] % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">		pkey = <span class="string">&quot;02&quot;</span> + <span class="built_in">hex</span>(pubkey[<span class="number">0</span>])[<span class="number">2</span>:].zfill(<span class="number">64</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		pkey = <span class="string">&quot;03&quot;</span> + <span class="built_in">hex</span>(pubkey[<span class="number">0</span>])[<span class="number">2</span>:].zfill(<span class="number">64</span>)</span><br><span class="line">	<span class="keyword">return</span> (pkey, skey)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">	border = <span class="string">&quot;┃&quot;</span></span><br><span class="line">	pr(        <span class="string">&quot;┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓&quot;</span>)</span><br><span class="line">	pr(border, <span class="string">&quot;Welcome to the Goliver World! You can play with ECC points on BTC &quot;</span>, border)</span><br><span class="line">	pr(border, <span class="string">&quot;curve. Your mission is to find the secret key and sweep wallets!  &quot;</span>, border)</span><br><span class="line">	pr(        <span class="string">&quot;┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛&quot;</span>)</span><br><span class="line">	<span class="keyword">global</span> p, a, b, G</span><br><span class="line">	p = <span class="number">0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f</span></span><br><span class="line">	a, b = <span class="number">0</span>, <span class="number">7</span></span><br><span class="line">	n = <span class="number">0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141</span></span><br><span class="line">	x = <span class="number">0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798</span></span><br><span class="line">	y = <span class="number">0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8</span></span><br><span class="line">	G = (x, y)</span><br><span class="line">	pkey, skey = GENKEY()</span><br><span class="line">	level, STEP, _b = <span class="number">0</span>, <span class="number">10</span>, <span class="literal">False</span></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		pr(<span class="string">&quot;| Options: \n|\t[E]ncrypt point \n|\t[G]et the flag \n|\t[P]ublic key \n|\t[Q]uit&quot;</span>)</span><br><span class="line">		ans = sc().decode().strip().lower()</span><br><span class="line">		<span class="keyword">if</span> ans == <span class="string">&#x27;e&#x27;</span>:</span><br><span class="line">			pr(border, <span class="string">f&quot;Please provide your desired point `H` on the Secp256k1 curve:&quot;</span>)</span><br><span class="line">			inp = sc().decode()</span><br><span class="line">			<span class="keyword">try</span>:</span><br><span class="line">				_x, _y = [<span class="built_in">int</span>(_) <span class="keyword">for</span> _ <span class="keyword">in</span> inp.split(<span class="string">&#x27;,&#x27;</span>)]</span><br><span class="line">				<span class="keyword">if</span> (_x**<span class="number">3</span> + a * _x + b - _y**<span class="number">2</span>) % p &lt; <span class="number">0x0f</span>:</span><br><span class="line">					_b = <span class="literal">True</span></span><br><span class="line">			<span class="keyword">except</span>:</span><br><span class="line">				die(border, <span class="string">f&quot;The input point you provided is not valid!&quot;</span>)</span><br><span class="line">			<span class="keyword">if</span> _b:</span><br><span class="line">				_Q = MUL((_x, _y), skey)</span><br><span class="line">				<span class="built_in">print</span>(border, <span class="string">f&quot;skey * H = <span class="subst">&#123;_Q&#125;</span>&quot;</span>)</span><br><span class="line">				<span class="keyword">if</span> level == STEP:</span><br><span class="line">					die(border, <span class="string">f&#x27;You have only <span class="subst">&#123;STEP&#125;</span> rounds to compute.&#x27;</span>)</span><br><span class="line">				<span class="keyword">else</span>:</span><br><span class="line">					level += <span class="number">1</span></span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				die(border, <span class="string">f&#x27;The input point is not on the curve! Bye!!&#x27;</span>)</span><br><span class="line">		<span class="keyword">elif</span> ans == <span class="string">&#x27;g&#x27;</span>:</span><br><span class="line">			pr(border, <span class="string">&#x27;Please send the private key: &#x27;</span>)</span><br><span class="line">			_skey = sc().decode()</span><br><span class="line">			<span class="keyword">try</span>:</span><br><span class="line">				_skey = <span class="built_in">int</span>(_skey)</span><br><span class="line">			<span class="keyword">except</span>:</span><br><span class="line">				die(border, <span class="string">&#x27;The private key is incorrect! Quitting...&#x27;</span>)</span><br><span class="line">			<span class="keyword">if</span> _skey == skey:</span><br><span class="line">				die(border, <span class="string">f&#x27;Congrats, you got the flag: <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				die(border, <span class="string">f&#x27;The private key is incorrect! Quitting...&#x27;</span>)</span><br><span class="line">		<span class="keyword">elif</span> ans == <span class="string">&#x27;p&#x27;</span>:</span><br><span class="line">			pr(border, <span class="string">f&#x27;pubkey = <span class="subst">&#123;pkey&#125;</span>&#x27;</span>)</span><br><span class="line">		<span class="keyword">elif</span> ans == <span class="string">&#x27;q&#x27;</span>:</span><br><span class="line">			die(border, <span class="string">&quot;Quitting...&quot;</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			die(border, <span class="string">&quot;Bye...&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>
<p>题目基于Secp256k1曲线，大体是说靶机有一个私钥sk，我们可以交互最多十次，每次发送一个点H，靶机会计算sk倍的H之后返回。如果我们能在10此以内求出sk并提供给靶机就可以拿到flag。</p>
<p>而题目的这一部分简直是明示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">	_x, _y = [<span class="built_in">int</span>(_) <span class="keyword">for</span> _ <span class="keyword">in</span> inp.split(<span class="string">&#x27;,&#x27;</span>)]</span><br><span class="line">	<span class="keyword">if</span> (_x**<span class="number">3</span> + a * _x + b - _y**<span class="number">2</span>) % p &lt; <span class="number">0x0f</span>:</span><br><span class="line">		_b = <span class="literal">True</span></span><br></pre></td></tr></table></figure>
<p>这里的意思是说，靶机不会严格检查我们发送的点的坐标是不是在Secp256k1曲线上，而允许我们发送的点在：</p>
<script type="math/tex; mode=display">
y^2 = x^3 + b'</script><p>只要其中7-b’在模p下小于15就行。</p>
<p>这就很简单了，我们取b’为0，发送的点就会在一条singular curve上：</p>
<script type="math/tex; mode=display">
y^2 = x^3</script><p>由于singular curve有一个曲线加法群到模p加法群的映射：</p>
<script type="math/tex; mode=display">
(x,y) \rightarrow (\frac{x}{y})</script><p>所以简单求逆就可以拿到sk。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f</span></span><br><span class="line">F = GF(p)</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&quot;65.109.204.171&quot;</span>, <span class="number">17371</span>)</span><br><span class="line">sh.sendline(<span class="string">b&quot;e&quot;</span>)</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;Please provide your desired point `H` on the Secp256k1 curve:&quot;</span>)</span><br><span class="line"></span><br><span class="line">PR.&lt;y&gt; = PolynomialRing(F)</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    x = randint(<span class="number">1</span>,p)</span><br><span class="line">    f = y^<span class="number">2</span> - x^<span class="number">3</span></span><br><span class="line">    res = f.roots()</span><br><span class="line">    <span class="keyword">if</span>(res != []):</span><br><span class="line">        y = <span class="built_in">int</span>(f.roots()[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">H = (x,y)</span><br><span class="line">sh.sendline((<span class="built_in">str</span>(x)+<span class="string">&quot;,&quot;</span>+<span class="built_in">str</span>(y)).encode())</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;skey * H = &quot;</span>)</span><br><span class="line">x1,y1 = <span class="built_in">eval</span>(sh.recvline().strip().decode())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sk = <span class="built_in">int</span>(F(x1)/F(y1)*F(y)/F(x))</span><br><span class="line">sh.sendline(<span class="string">b&quot;g&quot;</span>)</span><br><span class="line">sh.recvuntil(<span class="string">b&#x27;Please send the private key: &#x27;</span>)</span><br><span class="line">sh.sendline(<span class="built_in">str</span>(sk).encode())</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;you got the flag: &quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(sh.recvline())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#ASIS&#123;7w!sT_4tTAck_0n_8itcOin_Ell!ptic_cuRv3!&#125;</span></span><br></pre></td></tr></table></figure>
<p>当然也可以用其他b’去在低阶子群下crt得到sk，结合题目可以最多交互10次来看更像是预期解，但是显然比这个麻烦。</p>
<p><br></p>
<p><br></p>
<h3 id="Gasdeep"><a href="#Gasdeep" class="headerlink" title="*Gasdeep"></a>*Gasdeep</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The Gasdeep challenge utilizes finite fields for message encryption; your objective is to explore potential weaknesses in the system to find a way to break it.</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> params, flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">h</span>(<span class="params">a</span>):</span><br><span class="line">	<span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		g = F.gen()</span><br><span class="line">		<span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">			<span class="keyword">if</span> g ** _ == a:</span><br><span class="line">				<span class="keyword">return</span> _</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">H</span>(<span class="params">M</span>):</span><br><span class="line">	<span class="keyword">assert</span> M.nrows() == M.ncols()</span><br><span class="line">	k, _H = M.nrows(), []</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">			_h = h(M[i, j])</span><br><span class="line">			_H.append(<span class="built_in">bin</span>(_h)[<span class="number">2</span>:].zfill(<span class="number">8</span>))</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(_H)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">M2i</span>(<span class="params">M</span>):</span><br><span class="line">	_H = H(M)</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">int</span>(_H, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">random_oracle</span>(<span class="params">M</span>):</span><br><span class="line">	<span class="keyword">assert</span> M.nrows() == M.ncols()</span><br><span class="line">	k = M.nrows()</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		r = M.order()</span><br><span class="line">	<span class="keyword">except</span>:</span><br><span class="line">		r = k</span><br><span class="line">	<span class="keyword">return</span> H(M ** r)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">XOR</span>(<span class="params">_H, _K</span>):</span><br><span class="line">	<span class="keyword">assert</span> <span class="built_in">len</span>(_H) == <span class="built_in">len</span>(_K)</span><br><span class="line">	X = [<span class="built_in">str</span>(<span class="built_in">int</span>(_h) ^^ <span class="built_in">int</span>(_k)) <span class="keyword">for</span> _h, _k <span class="keyword">in</span> <span class="built_in">zip</span>(_H, _K)]</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(X)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">makey</span>(<span class="params">params</span>):</span><br><span class="line">	u, k, d = params</span><br><span class="line">	A, B = [random_matrix(F, k) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&#x27;01&#x27;</span>]</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		f = PolynomialRing(F, <span class="string">&#x27;x&#x27;</span>).random_element(degree = d)</span><br><span class="line">		<span class="keyword">if</span> f % A.characteristic_polynomial() != <span class="number">0</span>:</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">	m, n = [randint(<span class="number">2</span>, u) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&#x27;01&#x27;</span>]</span><br><span class="line">	R = f(A) ** m * B * f(A) ** n</span><br><span class="line">	pkey = (A, B, R)</span><br><span class="line">	skey = (f, m, n)</span><br><span class="line">	<span class="keyword">return</span>(pkey, skey)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">pkey, msg</span>):</span><br><span class="line">	A, B, R = pkey</span><br><span class="line">	k = A.nrows()</span><br><span class="line">	_m = bytes_to_long(msg)</span><br><span class="line">	_m = <span class="built_in">bin</span>(_m)[<span class="number">2</span>:]</span><br><span class="line">	<span class="keyword">assert</span> <span class="built_in">len</span>(_m) &lt;= <span class="number">8</span> * k**<span class="number">2</span></span><br><span class="line">	_M = _m.zfill(<span class="number">8</span> * k**<span class="number">2</span>)</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		h = PolynomialRing(F, <span class="string">&#x27;x&#x27;</span>).random_element(degree = d)</span><br><span class="line">		<span class="keyword">if</span> h % A.characteristic_polynomial() != <span class="number">0</span>:</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">	m, n = [randint(<span class="number">2</span>, u) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&#x27;01&#x27;</span>]</span><br><span class="line">	C, S = [h(A) ** m * _ * h(A) ** n <span class="keyword">for</span> _ <span class="keyword">in</span> [B, R]]</span><br><span class="line">	D = XOR(random_oracle(S), _M)</span><br><span class="line">	<span class="keyword">return</span>(C, D) </span><br><span class="line"></span><br><span class="line"><span class="keyword">global</span> F, d</span><br><span class="line">F = GF(<span class="number">256</span>)</span><br><span class="line"></span><br><span class="line">u, k, d = params</span><br><span class="line"><span class="keyword">assert</span> u &lt;= <span class="number">1</span> &lt;&lt; <span class="number">64</span></span><br><span class="line">pkey, _ = makey(params)</span><br><span class="line">A, B, R = pkey</span><br><span class="line"></span><br><span class="line">enc = encrypt(pkey, flag)</span><br><span class="line">C, D = enc</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;g = <span class="subst">&#123;F.polynomial()&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;A = <span class="subst">&#123;M2i(A)&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;B = <span class="subst">&#123;M2i(B)&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;R = <span class="subst">&#123;M2i(R)&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;C = <span class="subst">&#123;M2i(C)&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;D = <span class="subst">&#123;<span class="built_in">int</span>(D, <span class="number">2</span>)&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>输出太长就不放在这里了。</p>
<p>题目有点复杂，先理一下加密流程，为：</p>
<ul>
<li><p>密钥生成：</p>
<ul>
<li><p>有秘密参数u、k、d，用于生成密钥</p>
<blockquote>
<p>从后面可以知道u小于等于2^64，k=100，d确实不知道</p>
</blockquote>
</li>
<li><p>生成两个GF(2^8)下的k阶方阵A、B</p>
</li>
<li><p>随机生成度为d的多项式f，要求f不能是A的特征多项式的倍数</p>
<blockquote>
<p>否则有$f(A) = O$</p>
</blockquote>
</li>
<li><p>随机生成两个(2,u)之间的正整数m、n，并计算R：</p>
<script type="math/tex; mode=display">
R = f(A)^mBf(A)^n</script></li>
<li><p>公钥为$(A,B,R)$，私钥为$(f,m,n)$</p>
</li>
</ul>
</li>
<li><p>生成完密钥后进行加密：</p>
<ul>
<li>先把待加密消息m转为01串，并填充长度到8k^2，记为M</li>
<li><p>随机生成度为d的多项式h，同样要求h不能是A的特征多项式的倍数</p>
</li>
<li><p>随机生成两个(2,u)之间的正整数m’、n’，并计算C、S：</p>
<script type="math/tex; mode=display">
C = h(A)^{m'}B h(A)^{n'}</script><script type="math/tex; mode=display">
S = h(A)^{m'}Rh(A)^{n'}</script></li>
<li><p>计算密文D：</p>
<script type="math/tex; mode=display">
D = Oracle(S) \oplus M</script></li>
</ul>
</li>
</ul>
<p>给出A、B、R、C、D，要求还原flag。</p>
<p>先不管题目M2i之类的数据处理，就从密钥生成和加密这两个步骤出发，我们的目标是通过已知的几个矩阵A、B、R、C来求出S，之后自然就能解密出D了。</p>
<p>而S为：</p>
<script type="math/tex; mode=display">
S = h(A)^{m'}f(A)^mBf(A)^nh(A)^{n'}</script><p>我们不知道f、h，也不知道m’、m、n、n’，所以要从已知的信息直接求出S来。</p>
<p>一个很重要的信息在于，既然A自己的任意幂次都是可以交换的，那么所有关于A的多项式当然也都可交换，也就是下面的式子恒成立：</p>
<script type="math/tex; mode=display">
f(A)g(A) = g(A)f(A)</script><p>所以上面S的式子中的f、h也就可以交换，但这种交换越不过中间的B：</p>
<script type="math/tex; mode=display">
S = f(A)^mh(A)^{m'}Bh(A)^{n'}f(A)^n</script><p>我们把R的式子变一下形：</p>
<script type="math/tex; mode=display">
Rf(A)^{-n} = f(A)^mB</script><p>记：</p>
<script type="math/tex; mode=display">
X = f(A)^{-n}</script><script type="math/tex; mode=display">
Y = f(A)^m</script><p>那么就有：</p>
<script type="math/tex; mode=display">
S = YCX^{-1}</script><p>所以如果我们能求出来X、Y，我们就可以直接求出S了。</p>
<p>而X、Y都是k阶方阵，相当于我们一共有2k^2个变量，而上面的这个约束只有k^2条等式，显然不太够：</p>
<script type="math/tex; mode=display">
Rf(A)^{-n} = f(A)^mB</script><p>但是注意到我们还有很重要的约束没有用，那就是X、Y对于A的可交换性：</p>
<script type="math/tex; mode=display">
AX = XA</script><script type="math/tex; mode=display">
BX = XB</script><p>这样又多了2k^2条等式，所以显然可以解出X、Y来，因此就可以求出S来解flag了。</p>
<blockquote>
<p>这其实就是这篇论文对于这种加密体制的攻击情形之一：</p>
<p><a target="_blank" rel="noopener" href="https://eprint.iacr.org/2023/1425.pdf">1425.pdf (iacr.org)</a></p>
<p>赛后factoreal在discord提供了这篇论文，但是他好像没意识到这题0 solve的核心问题不在于找不找得到论文XD</p>
</blockquote>
<p>似乎到这里就结束了，然而我怎么解都解不出这样的X、Y来，而用自己的测试数据发现能做，丢个exp在这：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">h</span>(<span class="params">a</span>):</span><br><span class="line">	<span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		g = F.gen()</span><br><span class="line">		<span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">			<span class="keyword">if</span> g ** _ == a:</span><br><span class="line">				<span class="keyword">return</span> _</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">H</span>(<span class="params">M</span>):</span><br><span class="line">	<span class="keyword">assert</span> M.nrows() == M.ncols()</span><br><span class="line">	k, _H = M.nrows(), []</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">			_h = h(M[i, j])</span><br><span class="line">			_H.append(<span class="built_in">bin</span>(_h)[<span class="number">2</span>:].zfill(<span class="number">8</span>))</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(_H)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">M2i</span>(<span class="params">M</span>):</span><br><span class="line">	_H = H(M)</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">int</span>(_H, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">random_oracle</span>(<span class="params">M</span>):</span><br><span class="line">	<span class="keyword">assert</span> M.nrows() == M.ncols()</span><br><span class="line">	k = M.nrows()</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		r = M.order()</span><br><span class="line">	<span class="keyword">except</span>:</span><br><span class="line">		r = k</span><br><span class="line">	<span class="keyword">return</span> H(M ** r)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">XOR</span>(<span class="params">_H, _K</span>):</span><br><span class="line">	<span class="keyword">assert</span> <span class="built_in">len</span>(_H) == <span class="built_in">len</span>(_K)</span><br><span class="line">	X = [<span class="built_in">str</span>(<span class="built_in">int</span>(_h) ^^ <span class="built_in">int</span>(_k)) <span class="keyword">for</span> _h, _k <span class="keyword">in</span> <span class="built_in">zip</span>(_H, _K)]</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(X)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">makey</span>(<span class="params">params</span>):</span><br><span class="line">	u, k, d = params</span><br><span class="line">	A, B = [random_matrix(F, k) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&#x27;01&#x27;</span>]</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		f = PolynomialRing(F, <span class="string">&#x27;x&#x27;</span>).random_element(degree = d)</span><br><span class="line">		<span class="keyword">if</span> f % A.characteristic_polynomial() != <span class="number">0</span>:</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">	m, n = [randint(<span class="number">2</span>, u) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&#x27;01&#x27;</span>]</span><br><span class="line">	R = f(A) ** m * B * f(A) ** n</span><br><span class="line">	pkey = (A, B, R)</span><br><span class="line">	skey = (f, m, n)</span><br><span class="line">	<span class="keyword">return</span>(pkey, skey)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">pkey, msg</span>):</span><br><span class="line">	A, B, R = pkey</span><br><span class="line">	k = A.nrows()</span><br><span class="line">	_m = bytes_to_long(msg)</span><br><span class="line">	_m = <span class="built_in">bin</span>(_m)[<span class="number">2</span>:]</span><br><span class="line">	<span class="keyword">assert</span> <span class="built_in">len</span>(_m) &lt;= <span class="number">8</span> * k**<span class="number">2</span></span><br><span class="line">	_M = _m.zfill(<span class="number">8</span> * k**<span class="number">2</span>)</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		h = PolynomialRing(F, <span class="string">&#x27;x&#x27;</span>).random_element(degree = d)</span><br><span class="line">		<span class="keyword">if</span> h % A.characteristic_polynomial() != <span class="number">0</span>:</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">	m, n = [randint(<span class="number">2</span>, u) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&#x27;01&#x27;</span>]</span><br><span class="line">	C, S = [h(A) ** m * _ * h(A) ** n <span class="keyword">for</span> _ <span class="keyword">in</span> [B, R]]</span><br><span class="line">	D = XOR(random_oracle(S), _M)</span><br><span class="line">	<span class="keyword">return</span>(C, D, S) </span><br><span class="line"></span><br><span class="line"><span class="keyword">global</span> F, d</span><br><span class="line">F = GF(<span class="number">256</span>)</span><br><span class="line"></span><br><span class="line">u, k, d = <span class="number">2</span>^<span class="number">64</span>,<span class="number">100</span>,<span class="number">40</span></span><br><span class="line">pkey, _ = makey((u, k, d))</span><br><span class="line">A, B, R = pkey</span><br><span class="line">flag = <span class="string">b&quot;CTF&quot;</span></span><br><span class="line">enc = encrypt(pkey, flag)</span><br><span class="line">C, D, S = enc</span><br><span class="line"></span><br><span class="line"><span class="comment">############################################################ part1 handle data</span></span><br><span class="line"><span class="comment"># find that :</span></span><br><span class="line"><span class="comment"># RX = YB</span></span><br><span class="line"><span class="comment"># AX = XA</span></span><br><span class="line"><span class="comment"># AY = YA</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># AX = XA</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span>):</span><br><span class="line">    L = Matrix(F, k^<span class="number">2</span>, k^<span class="number">2</span>)</span><br><span class="line">    R = vector(F, [<span class="number">0</span>]*k^<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">            <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">                L[k*i+j, k*i+t] += A[t,j]</span><br><span class="line">                L[k*i+j, j+k*t] -= A[i,t]</span><br><span class="line">    X = L.solve_right(R)</span><br><span class="line"></span><br><span class="line">    temp = L.right_kernel().basis()[<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">print</span>(L.right_kernel().basis())</span><br><span class="line">    X = Matrix(F,k,k)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">            X[i,j] = temp[k*i+j]</span><br><span class="line">    <span class="built_in">print</span>(X*A == A*X)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># AX = XA and AY = YA and RX = YB</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span>):</span><br><span class="line">    L = Matrix(F, <span class="number">3</span>*k^<span class="number">2</span>, <span class="number">2</span>*k^<span class="number">2</span>)</span><br><span class="line">    Right = vector(F, [<span class="number">0</span>]*<span class="number">3</span>*k^<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#AX = XA</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">            <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">                L[k*i+j, k*i+t] += A[t,j]</span><br><span class="line">                L[k*i+j, j+k*t] -= A[i,t]</span><br><span class="line"></span><br><span class="line">    <span class="comment">#AY = YA</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">            <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">                L[k^<span class="number">2</span>+k*i+j, k^<span class="number">2</span>+k*i+t] += A[t,j]</span><br><span class="line">                L[k^<span class="number">2</span>+k*i+j, k^<span class="number">2</span>+j+k*t] -= A[i,t]</span><br><span class="line"></span><br><span class="line">    <span class="comment">#RX = YB</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">            <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">                L[<span class="number">2</span>*k^<span class="number">2</span>+k*i+j, k^<span class="number">2</span>+k*i+t] -= B[t,j]</span><br><span class="line">                L[<span class="number">2</span>*k^<span class="number">2</span>+k*i+j, j+k*t] += R[i,t]</span><br><span class="line"></span><br><span class="line">    XY = L.right_kernel().basis()[<span class="number">0</span>]</span><br><span class="line">    X = Matrix(F, k, k)</span><br><span class="line">    Y = Matrix(F, k, k)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">            X[i,j] = XY[k*i+j]</span><br><span class="line">            Y[i,j] = XY[k^<span class="number">2</span>+k*i+j]</span><br><span class="line">	</span><br><span class="line">    <span class="built_in">print</span>(A*X == X*A <span class="keyword">and</span> A*Y == Y*A <span class="keyword">and</span> R*X == Y*B)</span><br><span class="line"></span><br><span class="line">    ss = Y*C*X^(-<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(ss == S)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(XOR(random_oracle(ss), D),<span class="number">2</span>)))</span><br></pre></td></tr></table></figure>
<p>所以应该是题目的数据处理函数出了问题。细看了一下发现：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">h</span>(<span class="params">a</span>):</span><br><span class="line">	<span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		g = F.gen()</span><br><span class="line">		<span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">			<span class="keyword">if</span> g ** _ == a:</span><br><span class="line">				<span class="keyword">return</span> _</span><br></pre></td></tr></table></figure>
<p>这个函数对于输入0、1输出的都是0，所以没有办法通过M2i的输出正确的逆回去，得到原来的矩阵A、B、R、C，所以自然也就是0解。</p>
<blockquote>
<p>昨年ASIS Quals我记得也有个做不出来的题目，这下优良传统了XD</p>
</blockquote>
<p><br></p>
<p><br></p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>糖醋小鸡块
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://tangcuxiaojikuai.xyz/post/fbcce62e.html" title="2024-ASISCTF-Quals-wp-crypto">https://tangcuxiaojikuai.xyz/post/fbcce62e.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sacreative/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SACREATIVE</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/post/c2c51200.html" rel="prev" title="2024-ByteCTF-wp-crypto">
      <i class="fa fa-chevron-left"></i> 2024-ByteCTF-wp-crypto
    </a></div>
      <div class="post-nav-item">
    <a href="/post/21418325.html" rel="next" title="2024-NSSCTF-Matrix_challenges-wp-crypto">
      2024-NSSCTF-Matrix_challenges-wp-crypto <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Ataa"><span class="nav-number">1.</span> <span class="nav-text">Ataa</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Avini"><span class="nav-number">2.</span> <span class="nav-text">Avini</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Heidi"><span class="nav-number">3.</span> <span class="nav-text">Heidi</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Clement"><span class="nav-number">4.</span> <span class="nav-text">Clement</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Goliver"><span class="nav-number">5.</span> <span class="nav-text">Goliver</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Gasdeep"><span class="nav-number">6.</span> <span class="nav-text">*Gasdeep</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="糖醋小鸡块"
      src="/images/image.png">
  <p class="site-author-name" itemprop="name">糖醋小鸡块</p>
  <div class="site-description" itemprop="description">"追风赶月莫停留，平芜尽处是春山"</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">117</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/tangcuxiaojikuai" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;tangcuxiaojikuai" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/1142381085@qq.com" title="E-Mail → 1142381085@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/6394335993" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;6394335993" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">糖醋小鸡块</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>
  <script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'UPEMA7DyYbIIEyOW72ohgytU-gzGzoHsz',
      appKey     : 'M7rXAfeP3JOslroay2n0Jv2R',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
<!-- 引入jQuery -->
<script type="text/javascript" src="//libs.baidu.com/jquery/1.8.3/jquery.min.js"></script>
<!-- 雪花特效2 -->
<script type="text/javascript" src="/js/snow2.js"></script>
