<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon_small.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="RnN18ZogmZl_dLVpxZ6y8kjKL73Mu9VLVEkw9d3qrq0" />
  <meta name="msvalidate.01" content="DC3050AD55F30DDF75AAB78517714910" />
  <meta name="baidu-site-verification" content="codeva-PPofu3dNxe" />

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-loading-bar.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"tangcuxiaojikuai.xyz","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="è´¨é‡å¾ˆé«˜çš„é¢˜ç›®ï¼Œè®°å½•ä¸€ä¸‹åšæ³•ï¼Œç¡®å®ä¸å¤ªä¼šå¯¹ç§°æ‰€ä»¥æš‚æ—¶æ²¡æœ‰åštwistè¿™é“ã€‚èµ›ä¸­å®Œå…¨æ²¡æœ‰æ³¨æ„åˆ°MTæ‰€ä»¥æ²¡æœ‰æå®šM4sTeriXï¼Œæœ‰ç‚¹å¯æƒœï¼Œè¿˜æ˜¯å·®äº†ä¸€æ‹›ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="2024-N1CTF-wp-crypto">
<meta property="og:url" content="https://tangcuxiaojikuai.xyz/post/cd7e8e10.html">
<meta property="og:site_name" content="ç³–é†‹å°é¸¡å—çš„blog">
<meta property="og:description" content="è´¨é‡å¾ˆé«˜çš„é¢˜ç›®ï¼Œè®°å½•ä¸€ä¸‹åšæ³•ï¼Œç¡®å®ä¸å¤ªä¼šå¯¹ç§°æ‰€ä»¥æš‚æ—¶æ²¡æœ‰åštwistè¿™é“ã€‚èµ›ä¸­å®Œå…¨æ²¡æœ‰æ³¨æ„åˆ°MTæ‰€ä»¥æ²¡æœ‰æå®šM4sTeriXï¼Œæœ‰ç‚¹å¯æƒœï¼Œè¿˜æ˜¯å·®äº†ä¸€æ‹›ã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-11-11T07:22:27.000Z">
<meta property="article:modified_time" content="2024-11-12T09:53:25.706Z">
<meta property="article:author" content="ç³–é†‹å°é¸¡å—">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://tangcuxiaojikuai.xyz/post/cd7e8e10.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>2024-N1CTF-wp-crypto | ç³–é†‹å°é¸¡å—çš„blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ç³–é†‹å°é¸¡å—çš„blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
        <li class="menu-item menu-item-å‹é“¾">

    <a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>å‹é“¾</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tangcuxiaojikuai.xyz/post/cd7e8e10.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/image.png">
      <meta itemprop="name" content="ç³–é†‹å°é¸¡å—">
      <meta itemprop="description" content=""è¿½é£èµ¶æœˆè«åœç•™ï¼Œå¹³èŠœå°½å¤„æ˜¯æ˜¥å±±"">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ç³–é†‹å°é¸¡å—çš„blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2024-N1CTF-wp-crypto
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2024-11-11 15:22:27" itemprop="dateCreated datePublished" datetime="2024-11-11T15:22:27+08:00">2024-11-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-11-12 17:53:25" itemprop="dateModified" datetime="2024-11-12T17:53:25+08:00">2024-11-12</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/wp-crypto/" itemprop="url" rel="index"><span itemprop="name">wp-crypto</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valineï¼š</span>
    
    <a title="valine" href="/post/cd7e8e10.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/post/cd7e8e10.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>è´¨é‡å¾ˆé«˜çš„é¢˜ç›®ï¼Œè®°å½•ä¸€ä¸‹åšæ³•ï¼Œç¡®å®ä¸å¤ªä¼šå¯¹ç§°æ‰€ä»¥æš‚æ—¶æ²¡æœ‰åštwistè¿™é“ã€‚èµ›ä¸­å®Œå…¨æ²¡æœ‰æ³¨æ„åˆ°MTæ‰€ä»¥æ²¡æœ‰æå®šM4sTeriXï¼Œæœ‰ç‚¹å¯æƒœï¼Œè¿˜æ˜¯å·®äº†ä¸€æ‹›ã€‚</p>
<span id="more"></span>
<h3 id="n0tr5a"><a href="#n0tr5a" class="headerlink" title="n0tr5a"></a>n0tr5a</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">It&#x27;s not RSA!</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>(<span class="params">nbit, m</span>):</span><br><span class="line">    kbit = <span class="built_in">int</span>(nbit * <span class="number">0.4512</span>)</span><br><span class="line">    key = getPrime(kbit)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = getPrime(nbit // <span class="number">2</span> - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> isPrime(p * <span class="number">2</span> + <span class="number">1</span>):</span><br><span class="line">            p = p * <span class="number">2</span> + <span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        q = getPrime(nbit // <span class="number">2</span> - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> isPrime(q * <span class="number">2</span> + <span class="number">1</span>):</span><br><span class="line">            q = q * <span class="number">2</span> + <span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span>   </span><br><span class="line">    n = p * q</span><br><span class="line">    phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    e, k = [], []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        dd = key + <span class="number">2</span> * i + <span class="number">2</span></span><br><span class="line">        ee = inverse(dd, phi)</span><br><span class="line">        kk = (ee * dd - <span class="number">1</span>) // phi</span><br><span class="line">        e.append(ee % <span class="number">2</span> ** (nbit - kbit))</span><br><span class="line">        k.append(kk)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> n, e, k</span><br><span class="line"></span><br><span class="line">n, e, k = gen(<span class="number">1024</span>, <span class="number">12</span>)</span><br><span class="line">enc = <span class="built_in">pow</span>(bytes_to_long(flag), <span class="number">65537</span>, n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;data.txt&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">f&quot;<span class="subst">&#123;n = &#125;</span>\n<span class="subst">&#123;enc = &#125;</span>\n<span class="subst">&#123;e = &#125;</span>\n<span class="subst">&#123;k = &#125;</span>\n&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>data.txtï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">82699881935193109791472212259236125591789180928354081401868164018417228277481034922264132029171387301840769422435233519725339633533151517379984801310897094212731380971539763520078187279519479595450340858225632773423726273875857681742976022998251134553236897670416440247498103588885527592983304472279634643957</span></span><br><span class="line">enc = <span class="number">36794479248642872612364238056628323098776595394584051168003253681308381469543148020365981382945118247106425767548419728448043683874348775891060829403456974633618540620271474325940287199561651410530249693150249056719801828452373946254944967790634308791835260415588851915975925342336816758487259438650490430459</span></span><br><span class="line">e = [<span class="number">8888429835496095643535631191491505388277997809079089914782728064936463291203724475916011147975968533541243766266627762336328575049254500085648004975612619037464278832991</span>, <span class="number">10520875896679093312405671804517920324087646023792222747154447628464758710245963882871820387158134686949159913616463457692301596583039366392879522319633770989600617793993</span>, <span class="number">10601203527211713579180750988795815135916059018550710650265113080975290409723984434909955571406050178911560767494058644740527759576770265488136304573804742084915697171019</span>, <span class="number">14622236712746402638071905642098139610445903171562565245220543995502178907758821801160631615531163735803555926497329822620058537286662778517871290983128596096302228266209</span>, <span class="number">13754445300340270191221556210805776985685382903218031894668871565239317628261744219992643635369635181508144912605084390638097003753479943161757716583483371428111258641999</span>, <span class="number">12460010632813615553769774340135585477760327095310449594534663078794374775415503111884611193451554799744919010772785354797945533347796386998533715641130155450020923742093</span>, <span class="number">13453716597070478297648899092689370236302303280643930607214496697603184305419894290940911668951264509281914356651376372996746606791176528956862446530034762390956440975743</span>, <span class="number">9094611196190891372488960864378207737592838879869747718773801183985658899847575852673983345117604950170885723017205969782710348697632364573814601979741607809886580452089</span>, <span class="number">6208536025163051261514520489326917558898635960331271412905419257732637120279699170648486672913828237574848376496958272367037120192950777084064981617441543021966571267615</span>, <span class="number">12222783896133215551045666761401890068457062194802465729916062142356007806837055121210344156062210736292529151537109874603945090163748106129066462428445187619153477674477</span>, <span class="number">12614188721315363674299785508736495244859114088280924894674179341352352570584522323159835229814636248801721832488735354744616443270824945572498647598651837749451947061719</span>, <span class="number">1152998684313785798360794952776294245536465631931933802028441841686020994002404128005468864877622660410537371162754781745360983347732927142593427077571775783417497297097</span>]</span><br><span class="line">k = [<span class="number">1420437810145904840211095643676412643944076218177458138046274525430773202929328250820697290122977318065170030510975153884301846687954934017</span>, <span class="number">3940861961324077864997765290105972644424759701256821322813075596188909751606433001282290039081974406373664979502491212469917425748074824949</span>, <span class="number">9413004926123376989637174399517514326721338378609741980303584526041973145706068370477394363722601798762946415087687748257511626645382494821</span>, <span class="number">7428184730507734867291435325705251542125906508735340171046981085055137680467341685699246562820294813340827360115146667698628846494205603434</span>, <span class="number">5807754291508765665701362465833864063188458758878871682965086597196662689504909848658274758620320439529911831751168255058459646445501084679</span>, <span class="number">4757450447044159731910445277826227301213629775871240625040932054281107227037248484860063739616068171487636025286033326826668030840136004650</span>, <span class="number">5996697334509086666652114545471399499880715834871318018958944856630439665570432872031097645146070471243016581178433327374429447296670643144</span>, <span class="number">34948977643936917247938455046939890895031986466384330025838204273490152867215005144463212975331851051065343323158463423475270019458998722</span>, <span class="number">2108517589993394132588916598627794212409854321151001283809351367884838987309441276260578523735992656738890197115589763805165681991611220869</span>, <span class="number">7529989400759036686155222444072464272422956186987614547747593414852898515920566835606491795646900457120392171067632339816915038614860409008</span>, <span class="number">5919516150531691402185931957988063032510639008912552676259537229103356758278878266990953285696298526725065525943655778090084815308411600528</span>, <span class="number">6143553530848821997030657441615076975797083210691917101599644261591827822351051233391184584862183963084085114519636359680935327311007033284</span>]</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®å…ˆç”Ÿæˆä¸€ä¸ª462bitçš„ç´ æ•°å½“ä½œkeyï¼Œä¹‹åç”Ÿæˆä¸¤ä¸ª512bitçš„å®‰å…¨ç´ æ•°pã€qï¼Œç„¶åç»™å‡º12è½®hintï¼Œæ¯ä¸€è½®ä¸­ï¼š</p>
<script type="math/tex; mode=display">
dd_i = key + 2i + 2</script><script type="math/tex; mode=display">
ee_i\cdot dd_i = 1 + kk_iphi(n)</script><p>ç»™å‡ºæ¯ä¸€è½®çš„eeçš„ä½562ä½ä»¥åŠkkï¼Œè¦æ±‚åˆ†è§£næ¥è§£æœ€åçš„RSAå¯†æ–‡ã€‚</p>
<p>æŠŠhintä»£è¿›ç­‰å¼å°±æœ‰ï¼š</p>
<script type="math/tex; mode=display">
(2^{562}ee_{i,h} + ee_{i,l})\cdot (key + 2i + 2) = 1 + kk_i(n+1-(p+q))</script><p>å¯ä»¥çœ‹å‡ºåœ¨æ¨¡$2^{562}$ä¸‹æ»¡è¶³ï¼š</p>
<script type="math/tex; mode=display">
ee_{i,l}\cdot (key + 2i + 2) = 1 + kk_i(n+1-(p+q)) \quad(mod\;2^{562})</script><p>è®°ï¼š</p>
<script type="math/tex; mode=display">
C_i = ee_{i,l}\cdot (2i + 2) - 1 - kk_i(n+1)</script><p>é‚£ä¹ˆæœ‰ï¼š</p>
<script type="math/tex; mode=display">
ee_{i,l}\cdot key + kk_i \cdot (p+q) + C_i = 0 \quad(mod\;2^{562})</script><p>è¿™æ˜¯ä¸ªçº¿æ€§ç­‰å¼ï¼Œä¸”$p+q$å’Œ$key$åœ¨æ¨¡$2^{562}$ä¸‹éƒ½ä¸å¤§ï¼Œæ‰€ä»¥å¯ä»¥LLLå¾—åˆ°ï¼Œä¹‹åè§£æ–¹ç¨‹å°±å¯ä»¥åˆ†è§£nã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">kbit = <span class="built_in">int</span>(<span class="number">1024</span> * <span class="number">0.4512</span>)</span><br><span class="line">n = <span class="number">82699881935193109791472212259236125591789180928354081401868164018417228277481034922264132029171387301840769422435233519725339633533151517379984801310897094212731380971539763520078187279519479595450340858225632773423726273875857681742976022998251134553236897670416440247498103588885527592983304472279634643957</span></span><br><span class="line">enc = <span class="number">36794479248642872612364238056628323098776595394584051168003253681308381469543148020365981382945118247106425767548419728448043683874348775891060829403456974633618540620271474325940287199561651410530249693150249056719801828452373946254944967790634308791835260415588851915975925342336816758487259438650490430459</span></span><br><span class="line">e = [<span class="number">8888429835496095643535631191491505388277997809079089914782728064936463291203724475916011147975968533541243766266627762336328575049254500085648004975612619037464278832991</span>, <span class="number">10520875896679093312405671804517920324087646023792222747154447628464758710245963882871820387158134686949159913616463457692301596583039366392879522319633770989600617793993</span>, <span class="number">10601203527211713579180750988795815135916059018550710650265113080975290409723984434909955571406050178911560767494058644740527759576770265488136304573804742084915697171019</span>, <span class="number">14622236712746402638071905642098139610445903171562565245220543995502178907758821801160631615531163735803555926497329822620058537286662778517871290983128596096302228266209</span>, <span class="number">13754445300340270191221556210805776985685382903218031894668871565239317628261744219992643635369635181508144912605084390638097003753479943161757716583483371428111258641999</span>, <span class="number">12460010632813615553769774340135585477760327095310449594534663078794374775415503111884611193451554799744919010772785354797945533347796386998533715641130155450020923742093</span>, <span class="number">13453716597070478297648899092689370236302303280643930607214496697603184305419894290940911668951264509281914356651376372996746606791176528956862446530034762390956440975743</span>, <span class="number">9094611196190891372488960864378207737592838879869747718773801183985658899847575852673983345117604950170885723017205969782710348697632364573814601979741607809886580452089</span>, <span class="number">6208536025163051261514520489326917558898635960331271412905419257732637120279699170648486672913828237574848376496958272367037120192950777084064981617441543021966571267615</span>, <span class="number">12222783896133215551045666761401890068457062194802465729916062142356007806837055121210344156062210736292529151537109874603945090163748106129066462428445187619153477674477</span>, <span class="number">12614188721315363674299785508736495244859114088280924894674179341352352570584522323159835229814636248801721832488735354744616443270824945572498647598651837749451947061719</span>, <span class="number">1152998684313785798360794952776294245536465631931933802028441841686020994002404128005468864877622660410537371162754781745360983347732927142593427077571775783417497297097</span>]</span><br><span class="line">k = [<span class="number">1420437810145904840211095643676412643944076218177458138046274525430773202929328250820697290122977318065170030510975153884301846687954934017</span>, <span class="number">3940861961324077864997765290105972644424759701256821322813075596188909751606433001282290039081974406373664979502491212469917425748074824949</span>, <span class="number">9413004926123376989637174399517514326721338378609741980303584526041973145706068370477394363722601798762946415087687748257511626645382494821</span>, <span class="number">7428184730507734867291435325705251542125906508735340171046981085055137680467341685699246562820294813340827360115146667698628846494205603434</span>, <span class="number">5807754291508765665701362465833864063188458758878871682965086597196662689504909848658274758620320439529911831751168255058459646445501084679</span>, <span class="number">4757450447044159731910445277826227301213629775871240625040932054281107227037248484860063739616068171487636025286033326826668030840136004650</span>, <span class="number">5996697334509086666652114545471399499880715834871318018958944856630439665570432872031097645146070471243016581178433327374429447296670643144</span>, <span class="number">34948977643936917247938455046939890895031986466384330025838204273490152867215005144463212975331851051065343323158463423475270019458998722</span>, <span class="number">2108517589993394132588916598627794212409854321151001283809351367884838987309441276260578523735992656738890197115589763805165681991611220869</span>, <span class="number">7529989400759036686155222444072464272422956186987614547747593414852898515920566835606491795646900457120392171067632339816915038614860409008</span>, <span class="number">5919516150531691402185931957988063032510639008912552676259537229103356758278878266990953285696298526725065525943655778090084815308411600528</span>, <span class="number">6143553530848821997030657441615076975797083210691917101599644261591827822351051233391184584862183963084085114519636359680935327311007033284</span>]</span><br><span class="line"></span><br><span class="line">L = Matrix(ZZ, <span class="number">3</span>+<span class="built_in">len</span>(e), <span class="number">3</span>+<span class="built_in">len</span>(e))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    L[i,i] = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e)):</span><br><span class="line">    Ci = e[i]*(<span class="number">2</span>*i+<span class="number">2</span>) - <span class="number">1</span> - k[i]*(n+<span class="number">1</span>)</span><br><span class="line">    L[<span class="number">0</span>, <span class="number">3</span>+i] = e[i]</span><br><span class="line">    L[<span class="number">1</span>, <span class="number">3</span>+i] = k[i]</span><br><span class="line">    L[<span class="number">2</span>, <span class="number">3</span>+i] = Ci</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e)):</span><br><span class="line">    L[-i-<span class="number">1</span>,-i-<span class="number">1</span>] = <span class="number">2</span>^(<span class="number">1024</span> - kbit)</span><br><span class="line">L[<span class="number">0</span>,<span class="number">0</span>] = <span class="number">2</span>^(<span class="number">513</span>-kbit)</span><br><span class="line">L[<span class="number">2</span>,<span class="number">2</span>] = <span class="number">2</span>^<span class="number">513</span></span><br><span class="line">L[:,<span class="number">3</span>:] *= n</span><br><span class="line"></span><br><span class="line">res = L.LLL()[<span class="number">0</span>]</span><br><span class="line">key = <span class="built_in">abs</span>(res[<span class="number">0</span>])</span><br><span class="line">pplusq = <span class="built_in">abs</span>(res[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">pminusq = iroot(pplusq^<span class="number">2</span>-<span class="number">4</span>*n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">p = (pplusq + pminusq) // <span class="number">2</span></span><br><span class="line">q = n // p</span><br><span class="line">d = inverse(<span class="number">65537</span>,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="keyword">assert</span> p*q == n</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(enc,d,n))))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#n1ctf&#123;7hE_Br1l1!4nCe_0f_D5tErm1Nan7_4Nd_C0PP5R4m|Th!&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="seashells"><a href="#seashells" class="headerlink" title="seashells"></a>seashells</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Searching for  SeashellsğŸš by the seasideğŸï¸ : )</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">FLAG = <span class="string">&quot;n1ctf&#123;REDACTED&#125;&quot;</span></span><br><span class="line">ells = [*primes(<span class="number">3</span>, <span class="number">250</span>), <span class="number">661</span>]</span><br><span class="line">p = <span class="number">4</span> * prod(ells) - <span class="number">1</span></span><br><span class="line">F = GF(p**<span class="number">2</span>, <span class="string">&#x27;i&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Seaside</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.pearls = getrandbits(<span class="built_in">len</span>(ells))</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">wave</span>(<span class="params">self, A, Q=<span class="number">0</span>, signal=<span class="literal">False</span></span>):</span><br><span class="line">        E = EllipticCurve(F, [<span class="number">0</span>, A, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]); Q = E(Q)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> signal: priv = [randint(<span class="number">0</span>, <span class="number">3</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ells))]</span><br><span class="line">        <span class="keyword">else</span>: priv = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bin</span>(self.pearls)[<span class="number">2</span>:].zfill(<span class="built_in">len</span>(ells))]</span><br><span class="line">        <span class="keyword">for</span> e, ell <span class="keyword">in</span> <span class="built_in">zip</span>(priv, ells):</span><br><span class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(e):</span><br><span class="line">                E.set_order((p+<span class="number">1</span>)**<span class="number">2</span>)</span><br><span class="line">                P = self.pebble(E, ell); P.set_order(ell)</span><br><span class="line">                phi = E.isogeny(P)</span><br><span class="line">                E, Q = phi.codomain(), phi(Q)</span><br><span class="line">        Em = E.montgomery_model(); phi = E.isomorphism_to(Em)</span><br><span class="line">        <span class="keyword">return</span> (Em.a2(), phi(Q))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pebble</span>(<span class="params">self, E, ell</span>):</span><br><span class="line">        set_random_seed(<span class="number">1337</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">not</span> (P := (p + <span class="number">1</span>) // ell * E.random_element()): <span class="keyword">pass</span></span><br><span class="line">        set_random_seed(randint(<span class="number">0</span>,p))</span><br><span class="line">        <span class="keyword">return</span> P</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">tide</span>(<span class="params">self</span>):</span><br><span class="line">        shore = self.wave(<span class="number">0</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Shore&quot;</span>, shore)</span><br><span class="line">        <span class="keyword">return</span> self.wave(shore, <span class="built_in">input</span>(<span class="string">&quot;Seashells &gt; &quot;</span>).split(<span class="string">&#x27;,&#x27;</span>), <span class="literal">True</span>)[<span class="number">1</span>].xy()</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">chall</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Pearls &gt; &quot;</span>)) == self.pearls:</span><br><span class="line">            <span class="built_in">print</span>(FLAG)</span><br><span class="line"></span><br><span class="line">alarm(<span class="number">1200</span>)</span><br><span class="line">sys = Seaside()</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">    <span class="built_in">print</span>(sys.tide())</span><br><span class="line"></span><br><span class="line">sys.chall()</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®åŸºäºCSIDHï¼Œè¿æ¥ä¸Šé¶æœºåï¼Œé¶æœºä¼šç”Ÿæˆä¸€ä¸ªéšæœºæ•°pearlsï¼Œæˆ‘ä»¬çš„ç›®çš„å°±æ˜¯æ±‚å‡ºpearlsæ¥ã€‚</p>
<p>ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œé¢˜ç›®ç»™äº†æˆ‘ä»¬30è½®äº¤äº’æœºä¼šï¼ˆå¿…é¡»è¦ç”¨å®Œï¼‰ï¼Œæ¯æ¬¡äº¤äº’è¿‡ç¨‹ä¸ºï¼š</p>
<ul>
<li>é¶æœºéšæœºç”Ÿæˆç§é’¥åˆ—è¡¨ï¼Œè¯¥ç§é’¥åˆ—è¡¨ç”±0-3çš„å…ƒç´ ç»„æˆï¼Œç”¨è¿™ä¸ªç§é’¥è¿›è¡ŒåŒæºå¾—åˆ°ä¸€æ¡æ›²çº¿å¹¶ç»™å‡ºï¼Œè®°ä¸ºE1</li>
<li>æˆ‘ä»¬æ‹¿åˆ°E1åï¼Œå¯ä»¥é€‰æ‹©E1ä¸Šçš„ä¸€ä¸ªç‚¹$Q$å‘é€ç»™é¶æœº</li>
<li>é¶æœºä¹‹åä¼šå°†parlsçš„æ¯”ç‰¹ä¸²å½“ä½œç§é’¥åˆ—è¡¨è¿›è¡ŒåŒæºï¼Œå¹¶å°†æˆ‘ä»¬é€‰æ‹©çš„ç‚¹ç»è¿‡åŒæºæ˜ å°„åçš„$\phi(Q)$è¿”å›ç»™æˆ‘ä»¬</li>
</ul>
<p>ä¸ä¸€èˆ¬çš„CSIDHè¿‡ç¨‹ç›¸æ¯”ï¼Œé¢˜ç›®ä¸åŒçš„ç‚¹åœ¨äºå·¥ä½œåŸŸæ”¾åœ¨äº†äºŒæ¬¡æ‰©åŸŸè€Œä¸æ˜¯ä¸€æ¬¡åŸŸï¼Œè¿™ç›´æ¥å½±å“äº†CSIDHçš„å·¥ä½œæœºç†ï¼Œå› ä¸ºåœ¨ä¸€æ¬¡åŸŸä¸Šï¼Œå¯¹äºä¸€ä¸ªå°ç´ å› å­æ¥è¯´ï¼Œå…¶é‚»å±…æ˜¯ç¡®å®šçš„ï¼Œè€ŒäºŒæ¬¡æ‰©åŸŸä¸Šåˆ™ä¼šæœ‰ä¸åŒçš„é‚»å±…ï¼ˆå‚è€ƒSIDHï¼‰ã€‚</p>
<p>æ­¤å¤–è¿˜æœ‰ä¸€ä¸ªå¥‡æ€ªçš„åœ°æ–¹å°±æ˜¯æ¯æ¬¡åŒæºé¶æœºé€‰æ‹©torsion pointsçš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢çš„è¿™ä¸ªpebbleå‡½æ•°ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">pebble</span>(<span class="params">self, E, ell</span>):</span><br><span class="line">    set_random_seed(<span class="number">1337</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> (P := (p + <span class="number">1</span>) // ell * E.random_element()): <span class="keyword">pass</span></span><br><span class="line">    set_random_seed(randint(<span class="number">0</span>,p))</span><br><span class="line">    <span class="keyword">return</span> P</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡ºï¼Œå¯¹äºä¸€æ¡ç¡®å®šçš„æ›²çº¿æ¥è¯´ï¼Œç”±äºç§å­å›ºå®šï¼Œé€‰æ‹©çš„torsion pointsä¹Ÿå°±æ˜¯å›ºå®šçš„ã€‚</p>
<h4 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h4><p>æ¥ä¸‹æ¥è¿›å…¥è§£é¢˜ï¼Œé¦–å…ˆï¼Œç”±äºæˆ‘ä»¬å¯ä»¥è‡ªå·±æ„é€ ç‚¹$Q$å¹¶è·å¾—åŒæºåçš„$\phi(Q)$ï¼Œè¿™å°±å¾ˆç±»ä¼¼äºimaginaryCTFçš„coastä¸€é¢˜ã€‚åœ¨coastä¸­ï¼Œç”±äºåŒæºå·¥ä½œåœ¨ä¸€æ¬¡åŸŸä¸Šï¼Œæ¯ä¸ªç´ å› å­qåªæœ‰q-torsioné‡Œç‹¬ç‰¹çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œæ‰€ä»¥æˆ‘ä»¬å‘é€çš„ç‚¹åœ¨ç»å†q-isogenyä¹‹åï¼Œè¿™ä¸ªç‚¹é˜¶çš„å› å­qä¸€å®šä¼šæ¶ˆå¤±ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡åˆ¤æ–­è¿”å›çš„ç‚¹çš„é˜¶æ¥å¾—åˆ°ç§é’¥åˆ—è¡¨ã€‚</p>
<p>è€Œè¿™ä¸ªé¢˜ä¸ä¸€æ ·ï¼Œç”±äºtorsionåœ¨äºŒæ¬¡åŸŸä¸Šæœ‰å¤šä¸ªåˆ†æ”¯ï¼Œæ‰€ä»¥å½“ä¸”ä»…å½“æˆ‘ä»¬å‘é€çš„Qä¸æœ¬æ¬¡åŒæºçš„kernelåœ¨åŒä¸€ä¸ªç¾¤ä¸­çš„æ—¶å€™ï¼ŒQçš„é˜¶åœ¨ç»å†q-isogenyä¹‹åï¼Œå…¶é˜¶çš„å› å­qæ‰ä¼šæ¶ˆå¤±ã€‚</p>
<p>è€Œç”±äºæˆ‘ä»¬æœ‰E1ï¼Œå¹¶ä¸”pebbleå‡½æ•°ç”Ÿæˆkernelçš„æ—¶å€™ä¼šå›ºå®šç§å­ä¸º1337ï¼Œæ‰€ä»¥ä¸€ä¸ªå¾ˆè‡ªç„¶çš„æ€è·¯å°±äº§ç”Ÿäº†ï¼š</p>
<ul>
<li><p>ä»ç´ å› å­3å¼€å§‹ï¼Œæˆ‘ä»¬å‡è®¾å…¶å¯¹åº”çš„ç§é’¥æ˜¯1ï¼Œé‚£ä¹ˆç”±äºæˆ‘ä»¬æœ‰E1ï¼Œå› æ­¤æˆ‘ä»¬åŒæ ·å¯ä»¥è®¾ç½®ç§å­ä¸º1337ï¼Œå¹¶é€šè¿‡pebbleæ±‚å‡ºæœ¬æ¬¡åŒæºçš„kernel</p>
</li>
<li><p>æˆ‘ä»¬å°±é€‰è¿™ä¸ªkernelå½“ä½œ$Q$å‘é€ç»™é¶æœºï¼Œé‚£ä¹ˆå½“é¶æœºè¿”å›$\phi(Q)=O$çš„æ—¶å€™ï¼Œå°±è¯´æ˜3å¯¹åº”çš„ç§é’¥çš„ç¡®æ˜¯1ï¼Œå¦åˆ™å°±æ˜¯0</p>
</li>
<li><p>æ­¤æ—¶æˆ‘ä»¬å°±çŸ¥é“äº†ç§é’¥åˆ—è¡¨ä¸­3è¿™ä¸ªç´ å› å­å¯¹åº”çš„å€¼ï¼Œè¿™ä»£è¡¨ç€æˆ‘ä»¬èƒ½å¤ŸçŸ¥é“ä¸‹ä¸€æ¬¡æˆ‘ä»¬æ‹¿åˆ°çš„E1ç»è¿‡è¿™ä¸ªå€¼ååˆ°è¾¾çš„æ›²çº¿ï¼Œè®°ä¸º$E1_{3}$</p>
</li>
<li><p>é‚£ä¹ˆç»§ç»­è¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ä»¬å‡è®¾ç´ å› å­5å¯¹åº”çš„ç§é’¥æ˜¯1ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥é€šè¿‡pebbleè·å¾—è¿™ä¸ª5-isogenyçš„kernelï¼Œè®°è¿™ä¸ªkernelä¸º$Q_5$ã€‚è€Œç°åœ¨æˆ‘ä»¬åªè¦è®©å‘é€çš„$Q$æ»¡è¶³ï¼š</p>
<ul>
<li><p>$\phi_3(Q) = Q_5$</p>
<blockquote>
<p>å…¶å®å¹¶ä¸éœ€è¦ç›¸ç­‰ï¼Œå…¶å®åªéœ€è¦åœ¨åŒä¸€ä¸ªtorsionåˆ†æ”¯ä¸­å³å¯ï¼Œè¿™æ ·åœ¨$\phi_5$ä¹‹åå°±ä¼šé™é˜¶</p>
</blockquote>
</li>
</ul>
<p>ä¸ºæ­¤æˆ‘ä»¬å–$\phi_3$çš„å¯¹å¶åŒæº$\hat{\phi_3}$ï¼Œå¹¶åœ¨$E1_{3}$ä¸Šéšæœºå–ä¸€ä¸ªp+1é˜¶çš„ç‚¹$P$ï¼Œç„¶åå–$Q = \hat{\phi_3}(P)$ï¼Œé‚£ä¹ˆå½“5å¯¹åº”çš„ç§é’¥çš„ç¡®ä¸º1æ—¶ï¼Œæˆ‘ä»¬æœ€åå°±ä¼šæ”¶åˆ°å› ä¸º$\phi_5$é™è¿‡é˜¶çš„$\phi(Q)$ï¼Œå¦åˆ™å°±è¯´æ˜5å¯¹åº”çš„ç§é’¥ä¸º0ã€‚æ­¤æ—¶æˆ‘ä»¬å°±åˆå¾—åˆ°äº†$E1_{3,5}$</p>
</li>
<li><p>ä»¥æ­¤ç±»æ¨</p>
</li>
</ul>
<p>è¿™ä¸ªè¿‡ç¨‹å¯ä»¥åå¤è¿›è¡Œä¸‹å»ï¼Œä¸€ç›´åˆ°30è½®ç»“æŸçš„æ—¶å€™ï¼Œæˆ‘ä»¬æ€»å…±å¯ä»¥è·å¾—å‰ä¸‰åä¸ªç´ å› å­å¯¹åº”çš„ç§é’¥ã€‚è¿™å¼•å‡ºäº†ä¸€ä¸ªä¸¥å³»çš„é—®é¢˜ï¼Œç´ å› å­åˆ—è¡¨æ€»å…±é•¿53ï¼Œè¿˜æœ‰23ä¸ªç´ å› å­è·å¾—ä¸äº†ï¼Œè€Œè¿™23bité çˆ†çš„è¯ï¼Œä¼¼ä¹å¤æ‚åº¦è¿˜æ˜¯æŒºé«˜äº†ã€‚</p>
<p>æ‰€ä»¥è¿™ä¸ªæ–¹æ³•å¯èƒ½å¯ä»¥ä¼˜åŒ–ä¸€ä¸‹ï¼Œä½†æ˜¯æˆ‘ç¡®å®æ²¡æœ‰æƒ³åˆ°å•¥ä¼˜åŒ–çš„å¥½æ€è·¯ã€‚</p>
<blockquote>
<p>ä¸€ä¸ªæƒ³æ³•æ˜¯å‘é€çš„ç‚¹ä¸ç›´æ¥ç”¨kernelï¼Œè€Œæ˜¯å–ç”¨åœ¨ä¹˜$\frac{p+1}{q}$ä¹‹åç­‰äºkernelçš„p+1é˜¶ç‚¹ï¼Œè¿™æ ·åœ¨æœ€åæ£€æŸ¥é˜¶çš„å˜åŒ–æ—¶å¯èƒ½ä¼šè·å¾—å…¶ä»–torsionçš„è‡ªç„¶æ³„éœ²</p>
<p>æ­¤æ—¶ä¹Ÿè®¸å¯ä»¥åŠ ä¸Šä¸€äº›çˆ†ç ´æ¥è·å¾—å®Œæ•´çš„ç§é’¥åˆ—è¡¨</p>
</blockquote>
<h4 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h4><p>è€Œçªç ´ç‚¹ä¾ç„¶åœ¨äºpebbleï¼Œå†ä»”ç»†çœ‹çœ‹è¿™ä¸ªå‡½æ•°ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">pebble</span>(<span class="params">self, E, ell</span>):</span><br><span class="line">    set_random_seed(<span class="number">1337</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> (P := (p + <span class="number">1</span>) // ell * E.random_element()): <span class="keyword">pass</span></span><br><span class="line">    set_random_seed(randint(<span class="number">0</span>,p))</span><br><span class="line">    <span class="keyword">return</span> P</span><br></pre></td></tr></table></figure>
<p>è¦æ³¨æ„åˆ°ï¼Œæœ€åè¿”å›Pä¹‹å‰æœ‰ä¸€ä¸ª<code>set_random_seed(randint(0,p))</code>çš„è¿‡ç¨‹ï¼Œè¿™ä¼¼ä¹æ˜¯ä¸ºäº†è§£é™¤<code>set_random_seed(1337)</code>è€Œè®¾è®¡çš„ï¼Œä½†æ˜¯ç”±äº<code>randint(0,p)</code>ä¹Ÿå’Œç§å­æœ‰å…³ï¼Œæ‰€ä»¥è¿™å®é™…ä¸Šå‹æ ¹æ²¡æœ‰è§£é™¤ã€‚è¿™ä»£è¡¨ç€åœ¨é™¤äº†ç¬¬ä¸€æ¬¡pebbleä¹‹å‰çš„éšæœºç§é’¥ä»¥å¤–ï¼Œ<strong>å‰©ä¸‹çš„ä¸€åˆ‡éƒ½æ˜¯åœ¨ä¸€ä¸ªç¡®å®šçš„çŠ¶æ€ä¸‹èµ°çš„ï¼</strong></p>
<p>è¿™ç”šè‡³ä¼šå½±å“waveä¸­çš„è¿™ä¸€è¡Œï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> signal: priv = [randint(<span class="number">0</span>, <span class="number">3</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ells))]</span><br></pre></td></tr></table></figure>
<p>è¿™ä»£è¡¨ç€ä¸€æ—¦æŸä¸¤æ¬¡è¿›å…¥pebbleçš„æ›²çº¿ä¸€æ ·ï¼Œé‚£ä¹ˆè¿™ä¸¤æ¬¡åŒæºå°†ä¼šå®Œå…¨ä¸€æ ·ï¼Œå¹¶ä¸”è¿™ä¸¤æ¬¡åŒæºä¹‹åçš„åŒ…æ‹¬ç”Ÿæˆ0-3çš„privåˆ—è¡¨åœ¨å†…çš„æ‰€æœ‰æ­¥éª¤éƒ½ä¼šå®Œå…¨ä¸€æ ·ï¼Œè¿™å°±ä¼šäº§ç”Ÿä¸€ä¸ªå¾ªç¯èŠ‚ã€‚</p>
<p>å®é™…æµ‹è¯•ä¸€ä¸‹ä¼šå‘ç°è¿™ç§å¾ªç¯èŠ‚å¤ªå®¹æ˜“äº§ç”Ÿäº†ï¼Œå› æ­¤æˆ‘ä»¬å¾ˆè½»æ¾çš„å°±å¯ä»¥åœ¨30è½®äº¤äº’ä¸­æ”¶åˆ°ä¸¤æ¬¡ä¸€æ¨¡ä¸€æ ·çš„æ›²çº¿E1ï¼Œä¹‹åæˆ‘ä»¬å°±å–E1ä¸Šçš„ä¸¤ä¸ªé˜¶ä¸ºp+1ä¸”åœ¨ä¸¤ä¸ªä¸åŒåˆ†æ”¯ä¸­çš„ç‚¹$Q_1,Q_2$ï¼Œé‚£ä¹ˆæ¯”å¦‚å¯¹äº3-isogenyæ¥è¯´ï¼Œæˆ‘ä»¬è®¡ç®—ï¼š</p>
<script type="math/tex; mode=display">
Q_{1,3} = \frac{p+1}{3}\cdot Q_1</script><script type="math/tex; mode=display">
Q_{2,3} = \frac{p+1}{3}\cdot Q_2</script><p>é‚£ä¹ˆå¦‚ä¸‹ç‚¹ä¼šç”Ÿæˆ3-torsionçš„æ‰€æœ‰åˆ†æ”¯ï¼š</p>
<script type="math/tex; mode=display">
Q_{1,3} + iQ_{2,3} \quad,\quad i < 3</script><blockquote>
<p>ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¸ªç»“æœï¼Œç”¨é…å¯¹çš„è§’åº¦å»æƒ³ä¼šæ¯”è¾ƒç®€å•ï¼Œè®°ï¼š</p>
<script type="math/tex; mode=display">
t = e(Q_{1,3}, Q_{1,3} + iQ_{2,3})</script><p>é‚£ä¹ˆæ˜¾ç„¶æœ‰ï¼š</p>
<script type="math/tex; mode=display">
t = e(Q_{1,3}, Q_{2,3})^i</script><p>ç”±weil pairingçš„æ€§è´¨å¯ä»¥çŸ¥é“å‡ ä¸ªäº‹å®ï¼š</p>
<ul>
<li>weil pairingçš„å‡½æ•°å€¼æ˜¯ä¸ª3æ¬¡å•ä½æ ¹ï¼Œå› æ­¤$e(Q_{1,3}, Q_{2,3})$æ˜¯ä¸ªç”Ÿæˆå…ƒï¼Œæ‰€ä»¥å¯¹äºä¸åŒçš„iç»“æœä¸åŒ</li>
<li>weil pairingæœ¬è´¨æ˜¯å¯¹torsionä¸åŒåˆ†æ”¯çš„é…å¯¹ï¼Œå› æ­¤ä¸åŒå‡½æ•°å€¼å¯¹åº”torsionçš„ä¸åŒåˆ†æ”¯</li>
</ul>
</blockquote>
<p>æ‰€ä»¥å¦‚æœ3å¯¹åº”çš„ç§é’¥æ˜¯1çš„è¯ï¼Œç”±äº$\phi(Q_{1,3}) + i\phi(Q_{2,3})$ä¸€å®šä¼šéå†åˆ°æ‰€æœ‰çš„3-$torsion$ï¼Œæ‰€ä»¥å¦‚æœç»å†äº†3-isogenyï¼Œä¸€å®šæœ‰ä¸€ä¸ªåˆ†æ”¯æ˜¯å¯¹åº”çš„kernelï¼Œé‚£ä¹ˆå°±å­˜åœ¨ä¸€ä¸ªç»“æœçš„å› å­3ä¼šæ¶ˆå¤±ï¼›è¿™ä¹Ÿå°±æ˜¯è¯´éå†0-2çš„å€¼ï¼Œè¿™ä¸ªç»“æœä¸€å®šä¼šæœ‰ä¸€ä¸ªæ˜¯å•ä½å…ƒã€‚å¦åˆ™è¯´æ˜3å¯¹åº”çš„ç§é’¥æ˜¯0ã€‚</p>
<p>è¿™ç§æ–¹æ³•å°±å¾ˆç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°ä¸¤æ¬¡ä¸€æ¨¡ä¸€æ ·çš„æ›²çº¿ï¼Œç„¶åå‘é€ä¸¤ä¸ªå¯¹ä»»ä½•q-torsionéƒ½ä¸åœ¨åŒä¸€ä¸ªåˆ†æ”¯çš„Q1ã€Q2å³å¯ï¼Œç„¶åå°±å¯ä»¥ä¸€æ¬¡æ€§è®¡ç®—å‡ºå…¨éƒ¨çš„ç§é’¥åˆ—è¡¨äº†ã€‚</p>
<p>è€Œå®é™…è„šæœ¬ç¼–å†™çš„è§’åº¦å€’å®Œå…¨ä¸ç”¨è¿™æ ·ï¼Œå› ä¸ºå¯¹äºåé¢ç´ å› å­æ¥è¯´å®é™…ä¸Šå¾ˆéš¾åœ¨åŒä¸€ä¸ªtorsioné‡Œï¼Œä¸»è¦æ˜¯å‰é¢çš„3ã€5ã€7è¿™ç§å°ç´ å› å­æ¯”è¾ƒå®¹æ˜“å‡ºåå·®ï¼Œæ‰€ä»¥ä¸ç”¨å…¨éƒ¨æ£€æŸ¥ä¸€éã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">ells = [*primes(<span class="number">3</span>, <span class="number">250</span>), <span class="number">661</span>]</span><br><span class="line">p = <span class="number">4</span> * prod(ells) - <span class="number">1</span></span><br><span class="line">F = GF(p**<span class="number">2</span>, <span class="string">&#x27;i&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sh = process([<span class="string">&quot;sage&quot;</span>, <span class="string">&quot;seashells.sage&quot;</span>])</span><br><span class="line"><span class="comment">#sh = remote(&quot;120.26.69.200&quot;, 50979)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">G1,G2</span>):</span><br><span class="line">    <span class="keyword">for</span> q <span class="keyword">in</span> ells[:<span class="number">4</span>]:</span><br><span class="line">        qG1 = ((p+<span class="number">1</span>)//q) * G1</span><br><span class="line">        qG2 = ((p+<span class="number">1</span>)//q) * G2</span><br><span class="line">        <span class="keyword">if</span>(qG1.weil_pairing(qG2, q) == <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">Gs = []</span><br><span class="line">Qs = []</span><br><span class="line">As = []</span><br><span class="line">Es = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">30</span>):</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;Shore &quot;</span>)</span><br><span class="line">    A = sh.recvline().strip().decode()</span><br><span class="line">    E = EllipticCurve(F, [<span class="number">0</span>, A, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>])</span><br><span class="line">    E.set_order((p+<span class="number">1</span>)^<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(A <span class="keyword">in</span> As):</span><br><span class="line">        G1 = Gs[As.index(A)]</span><br><span class="line">        <span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">            G = E.random_element()</span><br><span class="line">            <span class="keyword">if</span>(G.order() == (p+<span class="number">1</span>) <span class="keyword">and</span> check(G,G1)):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">            G = E.random_element()</span><br><span class="line">            <span class="keyword">if</span>(G.order() == (p+<span class="number">1</span>)):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    Seashells = <span class="built_in">str</span>(G.xy())[<span class="number">1</span>:-<span class="number">1</span>]</span><br><span class="line">    sh.sendline(Seashells.encode())</span><br><span class="line"></span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;Seashells &gt; &quot;</span>)</span><br><span class="line">    Q = sh.recvline().strip().decode()[<span class="number">1</span>:-<span class="number">1</span>].split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">    x1, y1 = F(Q[<span class="number">0</span>]), F(Q[<span class="number">1</span>])</span><br><span class="line">    </span><br><span class="line">    PR.&lt;AA&gt; = PolynomialRing(F)</span><br><span class="line">    f = y1^<span class="number">2</span> - (x1^<span class="number">3</span> + AA*x1^<span class="number">2</span> + x1)</span><br><span class="line">    A1 = f.roots(multiplicities=<span class="literal">False</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    E1 = EllipticCurve(F, [<span class="number">0</span>, A1, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>])</span><br><span class="line">    E1.set_order((p+<span class="number">1</span>)^<span class="number">2</span>)</span><br><span class="line">    Q = E1((x1,y1))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(A <span class="keyword">in</span> As):</span><br><span class="line">        Qs = [Qs[As.index(A)], Q]</span><br><span class="line">        Es = E1</span><br><span class="line">        times = i + <span class="number">1</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    Gs.append(G)</span><br><span class="line">    Qs.append(Q)</span><br><span class="line">    As.append(A)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">30</span> - times):</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;Shore &quot;</span>)</span><br><span class="line">    A = sh.recvline().strip().decode()</span><br><span class="line">    E = EllipticCurve(F, [<span class="number">0</span>, A, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>])</span><br><span class="line">    Q = E.random_element()</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;Seashells &gt; &quot;</span>)</span><br><span class="line">    Seashells = <span class="built_in">str</span>(Q.xy())[<span class="number">1</span>:-<span class="number">1</span>]</span><br><span class="line">    sh.sendline(Seashells.encode())</span><br><span class="line"></span><br><span class="line"><span class="comment">################################################################################################### check</span></span><br><span class="line">priv = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(ells):</span><br><span class="line">    Found = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i):</span><br><span class="line">        temp = Qs[<span class="number">0</span>] + j*Qs[<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span>(temp*((p+<span class="number">1</span>)//i) == Es(<span class="number">0</span>)):</span><br><span class="line">            Found = <span class="number">1</span></span><br><span class="line">            priv.append(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span>(Found == <span class="number">0</span>):</span><br><span class="line">        priv.append(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(priv)</span><br><span class="line"></span><br><span class="line">pearls = <span class="built_in">int</span>(<span class="string">&quot;&quot;</span>.join(<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">str</span>,priv))), <span class="number">2</span>)</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;Pearls &gt; &quot;</span>)</span><br><span class="line">sh.sendline(<span class="built_in">str</span>(pearls).encode())</span><br><span class="line"><span class="built_in">print</span>(sh.recvline())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#n1ctf&#123;t0r5ion_po1nt_l3aked_my_tre@sure_G_G&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="æ–¹æ³•ä¸‰"><a href="#æ–¹æ³•ä¸‰" class="headerlink" title="æ–¹æ³•ä¸‰"></a>æ–¹æ³•ä¸‰</h4><p>èµ›åå’Œhashhashå’Œyolbbyä¸€èµ·è®¨è®ºäº†å¥½ä¸€ä¼šå„¿è¿™ä¸ªé¢˜ç›®ï¼Œå‘ç°åœ¨æ–¹æ³•ä¸€çš„åŸºç¡€ä¸Šå®Œå…¨å¯ä»¥åŠ ä¸€ç‚¹ä¼˜åŒ–ï¼Œä½¿å¾—èƒ½å¤Ÿè¾¾åˆ°å¦‚ä¸‹ç›®çš„ï¼š</p>
<ul>
<li>æ¯ä¸€æ¬¡äº¤äº’éƒ½å¯ä»¥æ‰¾åˆ°å½“å‰å·²è·å¾—ç§é’¥åˆ—è¡¨çš„åç»­çš„ç¬¬ä¸€ä¸ª0</li>
</ul>
<p>è¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Œæ¯”å¦‚è¯´é¢˜ç›®çš„pearlsæ˜¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆç”¨è¿™ä¸ªä¼˜åŒ–çš„æ–¹æ³•ï¼Œæ¯ä¸€æ¬¡äº¤äº’å¯ä»¥è·å¾—ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line">[<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">[<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line">[<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>æ€è·¯å…¶å®éå¸¸ç®€å•ï¼Œå‡è®¾ç§é’¥åˆ—è¡¨æ¥ä¸‹æ¥çš„è¿ç»­10ä¸ªå€¼å…¨æ˜¯1ï¼Œé‚£ä¹ˆæˆ‘ä»¬èƒ½é€šè¿‡pebbleè·å¾—å®Œæ•´çš„isoé“¾ï¼Œä¹Ÿå°±è·å¾—äº†ä¸€ä¸ªå®Œæ•´çš„$\phi$ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥è®¡ç®—ä»–çš„å¯¹å¶åŒæº$\hat{\phi}$ï¼Œè€Œäº’ä¸ºdualçš„åŒæºå…·æœ‰å¦‚ä¸‹æ€§è´¨ï¼š</p>
<script type="math/tex; mode=display">
\hat{\phi}\cdot \phi = [d]</script><p>å…¶ä¸­dæ˜¯$\phi$å’Œ$\hat{\phi}$çš„degreeã€‚</p>
<blockquote>
<p>è¿™é‡Œè¿ç»­å¤šå°‘ä¸ªå€¼å…¶å®ä¸é‡è¦ï¼Œ10ä¸ªå€¼æ˜¯è®¡ç®—æ—¶é—´å’Œæ¦‚ç‡åšäº†å¹³è¡¡çš„ç»“æœï¼š</p>
<ul>
<li>è¿ç»­10ä¸ªè®¡ç®—æ—¶é—´ä¸ç®—é•¿</li>
<li>å¾ˆéš¾æœ‰è¿ç»­10ä¸ª1å‡ºç°</li>
</ul>
</blockquote>
<p>é‚£ä¹ˆæˆ‘ä»¬åœ¨$phi$ååˆ°è¾¾çš„æ›²çº¿ä¸Šéšæœºå–ä¸€ä¸ª$p+1$é˜¶çš„ç‚¹$P$ï¼Œå¹¶è®¡ç®—$\hat{\phi}(P)$ä½œä¸ºæˆ‘ä»¬å‘é€ç»™é¶æœºçš„ç‚¹$G$ï¼Œé‚£ä¹ˆå¦‚æœæ¥ä¸‹æ¥è¿ç»­åä¸ªå€¼çœŸçš„éƒ½æ˜¯1ï¼Œé¶æœºå‘é€ç»™æˆ‘ä»¬çš„ç»“æœå°±æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
\phi(\hat{\phi}(P)) = [d]P</script><p>é‚£ä¹ˆ$P$çš„é˜¶å°±ä¼šé™ä½dè¿™ä¹ˆå¤šã€‚</p>
<p>è€Œå¦‚æœå®é™…ä¸Šå¹¶ä¸æ˜¯è¿ç»­åä¸ª1ï¼Œæ¯”å¦‚åœ¨è¿ç»­ä¸¤ä¸ª1ä¹‹åå°±æ–­æ‰äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å‘é€çš„$G$åœ¨é™ä½å‰ä¸¤ä¸ªç´ å› å­çš„é˜¶ä¹‹åï¼Œé˜¶å°†ä¸ä¼šå†ä¸‹é™ï¼Œè€Œè¿™åœæ­¢ä¸‹é™çš„ç´ å› å­çš„ä½ç½®å°±ä¸ºæˆ‘ä»¬æŒ‡ç¤ºäº†ä¸‹ä¸€ä¸ª0çš„ä½ç½®ã€‚</p>
<p>è€Œè¿™æ ·ä¸€æ¥ï¼Œ30æ¬¡äº¤äº’ï¼Œåªè¦å½“å‰ç§é’¥æ˜¯1ï¼Œé‚£ä¹ˆå°±è‡³å°‘ä¼šå¾€å‰æ¨è¿›ä¸¤ä¸ªï¼Œæ‰€ä»¥è¿æ°”æ­£å¸¸çš„è¯æ¢å¤å®Œæ•´ç§é’¥åˆ—è¡¨å°±ç»°ç»°æœ‰ä½™äº†ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">ells = [*primes(<span class="number">3</span>, <span class="number">250</span>), <span class="number">661</span>]</span><br><span class="line">p = <span class="number">4</span> * prod(ells) - <span class="number">1</span></span><br><span class="line">F = GF(p**<span class="number">2</span>, <span class="string">&#x27;i&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sh = process([<span class="string">&quot;sage&quot;</span>, <span class="string">&quot;seashells.sage&quot;</span>])</span><br><span class="line"><span class="comment">#sh = remote(&quot;120.26.69.200&quot;, 50979)</span></span><br><span class="line"><span class="comment">#print(sh.recvline().strip().decode())</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">my_pebble</span>(<span class="params">E_start, ell_start, priv, search_length</span>):</span><br><span class="line">    phi_back = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    EE = E_start</span><br><span class="line">    <span class="keyword">for</span> i, ell <span class="keyword">in</span> <span class="built_in">zip</span>(priv, ells):</span><br><span class="line">        <span class="keyword">if</span>(i == <span class="number">1</span>):</span><br><span class="line">            set_random_seed(<span class="number">1337</span>)</span><br><span class="line">            <span class="keyword">while</span> <span class="keyword">not</span> (P := (p + <span class="number">1</span>) // ell * EE.random_element()): <span class="keyword">pass</span></span><br><span class="line">            EE.set_order((p+<span class="number">1</span>)**<span class="number">2</span>)</span><br><span class="line">            P.set_order(ell)</span><br><span class="line">            phi = EE.isogeny(P)</span><br><span class="line">            phi_dual = phi.dual()</span><br><span class="line">            EE = phi.codomain()</span><br><span class="line">            phi_back = phi_back * phi_dual</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    MAX = <span class="built_in">min</span>(ell_start+search_length, <span class="built_in">len</span>(ells)-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> ell <span class="keyword">in</span> ells[ell_start:MAX]:</span><br><span class="line">        set_random_seed(<span class="number">1337</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">not</span> (P := (p + <span class="number">1</span>) // ell * EE.random_element()): <span class="keyword">pass</span></span><br><span class="line">        EE.set_order((p+<span class="number">1</span>)**<span class="number">2</span>)</span><br><span class="line">        P.set_order(ell)</span><br><span class="line">        phi = EE.isogeny(P)</span><br><span class="line">        phi_dual = phi.dual()</span><br><span class="line">        EE = phi.codomain()</span><br><span class="line">        phi_back = phi_back * phi_dual</span><br><span class="line">    </span><br><span class="line">    set_random_seed(<span class="number">1337</span>)</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">        t = EE.random_element()</span><br><span class="line">        <span class="keyword">if</span>(t.order() == p+<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> phi_back(t)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">priv = []</span><br><span class="line">ell_start = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;Shore &quot;</span>)</span><br><span class="line">    A = sh.recvline().strip().decode()</span><br><span class="line">    E = EllipticCurve(F, [<span class="number">0</span>, A, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>])</span><br><span class="line">    E.set_order((p+<span class="number">1</span>)^<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">############################################################# pebble find G</span></span><br><span class="line">    G = my_pebble(E, ell_start, priv, <span class="number">10</span>)</span><br><span class="line">    <span class="comment">############################################################# pebble find G</span></span><br><span class="line"></span><br><span class="line">    Seashells = <span class="built_in">str</span>(G.xy())[<span class="number">1</span>:-<span class="number">1</span>]</span><br><span class="line">    sh.sendline(Seashells.encode())</span><br><span class="line"></span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;Seashells &gt; &quot;</span>)</span><br><span class="line">    Q = sh.recvline().strip().decode()[<span class="number">1</span>:-<span class="number">1</span>].split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">    x1, y1 = F(Q[<span class="number">0</span>]), F(Q[<span class="number">1</span>])</span><br><span class="line">    </span><br><span class="line">    PR.&lt;AA&gt; = PolynomialRing(F)</span><br><span class="line">    f = y1^<span class="number">2</span> - (x1^<span class="number">3</span> + AA*x1^<span class="number">2</span> + x1)</span><br><span class="line">    A1 = f.roots(multiplicities=<span class="literal">False</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    E1 = EllipticCurve(F, [<span class="number">0</span>, A1, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>])</span><br><span class="line">    E1.set_order((p+<span class="number">1</span>)^<span class="number">2</span>)</span><br><span class="line">    Q = E1((x1,y1))</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="comment">############################################################# update priv</span></span><br><span class="line">    update_len = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ell <span class="keyword">in</span> ells[ell_start:ell_start+<span class="number">6</span>]:</span><br><span class="line">        <span class="keyword">if</span>((p+<span class="number">1</span>) // ell * Q == E1(<span class="number">0</span>)):</span><br><span class="line">            priv.append(<span class="number">1</span>)</span><br><span class="line">            update_len += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            priv.append(<span class="number">0</span>)</span><br><span class="line">            update_len += <span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(priv)</span><br><span class="line">    ell_start += update_len</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">len</span>(priv) == <span class="built_in">len</span>(ells)):</span><br><span class="line">        times = i+<span class="number">1</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="comment">############################################################# update priv</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">30</span> - times):</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;Shore &quot;</span>)</span><br><span class="line">    A = sh.recvline().strip().decode()</span><br><span class="line">    E = EllipticCurve(F, [<span class="number">0</span>, A, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>])</span><br><span class="line">    Q = E.random_element()</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;Seashells &gt; &quot;</span>)</span><br><span class="line">    Seashells = <span class="built_in">str</span>(Q.xy())[<span class="number">1</span>:-<span class="number">1</span>]</span><br><span class="line">    sh.sendline(Seashells.encode())</span><br><span class="line"></span><br><span class="line">pearls = <span class="built_in">int</span>(<span class="string">&quot;&quot;</span>.join(<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">str</span>,priv))), <span class="number">2</span>)</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;Pearls &gt; &quot;</span>)</span><br><span class="line">sh.sendline(<span class="built_in">str</span>(pearls).encode())</span><br><span class="line"><span class="built_in">print</span>(sh.recvline())</span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="M4sTeriX"><a href="#M4sTeriX" class="headerlink" title="*M4sTeriX"></a>*M4sTeriX</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">I know that the matrix master is always performing tedious and error-prone matrix operations day after day : (</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">FLAG = <span class="string">b&quot;n1ctf&#123;REDACTED&#125;&quot;</span></span><br><span class="line">N, n, q = <span class="number">1024</span>, <span class="number">60</span>, <span class="number">2</span>**<span class="number">521</span>-<span class="number">1</span></span><br><span class="line">F, Fq = Zmod(<span class="number">256</span>), GF(q)</span><br><span class="line">s = [random_vector(F, N//<span class="number">2</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">error_work</span>(<span class="params">s, w</span>):</span><br><span class="line">    a = random_matrix(F, N//<span class="number">2</span>, N); mat.append(a)</span><br><span class="line">    e = <span class="built_in">list</span>(random_vector(w, x=<span class="number">1</span>, y=<span class="number">256</span>))+[<span class="number">0</span>]*(N-w)</span><br><span class="line">    P = Permutations(N).random_element().to_matrix()</span><br><span class="line">    <span class="keyword">return</span> matrix(Fq, <span class="number">4</span>, N//<span class="number">4</span>, s*a+P*vector(e))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tedious_work</span>(<span class="params">A</span>):</span><br><span class="line">    Î± = random_matrix(Fq, n, N//<span class="number">4</span>)</span><br><span class="line">    Îµ = matrix(n, N//<span class="number">4</span>, [i*randrange(<span class="number">0</span>, q) <span class="keyword">for</span> i <span class="keyword">in</span> Î±])</span><br><span class="line">    Ïƒ = matrix(Fq, [[randrange(<span class="number">1</span>, q) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">80</span>)] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line">    <span class="built_in">open</span>(<span class="string">&quot;tedious&quot;</span>, <span class="string">&quot;w&quot;</span>).write(<span class="built_in">str</span>(&#123;<span class="string">&quot;Ï€&quot;</span>: <span class="built_in">list</span>(Ïƒ*A+Îµ), <span class="string">&quot;Î±&quot;</span>: <span class="built_in">list</span>(Î±)&#125;))</span><br><span class="line"></span><br><span class="line">mat = []</span><br><span class="line">A = matrix(Fq, <span class="number">80</span>, N//<span class="number">4</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    A[<span class="number">4</span>*i:<span class="number">4</span>*i+<span class="number">4</span>,:] = error_work(s[i], <span class="number">22</span>)</span><br><span class="line"></span><br><span class="line">save(mat, <span class="string">&quot;mat&quot;</span>)</span><br><span class="line">tedious_work(A)</span><br><span class="line">cipher = AES.new(md5(<span class="built_in">str</span>(<span class="built_in">sum</span>(s)).encode()).digest(), AES.MODE_ECB)</span><br><span class="line"><span class="built_in">print</span>(cipher.encrypt(pad(FLAG, <span class="number">16</span>)).<span class="built_in">hex</span>())</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">af3010a3de0fa968c38f421f2857d6c60caf9a6ae1023e9d04f253e1d5fb8038fddf26f7cc976fadbb2df12ef549d1fd</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®å…ˆç”Ÿæˆäº†ä¸€ä¸ªé•¿20çš„åˆ—è¡¨sï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ æ˜¯$Z_{256}$ä¸‹çš„512ç»´å‘é‡ï¼Œè¿™æ˜¯æˆ‘ä»¬éœ€è¦æ±‚è§£å‡ºçš„ä¼šä½œä¸ºAESå¯†é’¥çš„å†…å®¹ã€‚</p>
<p>è€Œå¯¹äºsçš„å†…å®¹ï¼Œé¢˜ç›®ç»™äº†è¿™æ ·ä¸€äº›ä¿¡æ¯ï¼š</p>
<ul>
<li><p>error_workéƒ¨åˆ†ï¼Œé¢˜ç›®å¯¹äºsä¸­çš„æ¯ä¸€ä¸ªå‘é‡$\textbf{s}_i$ï¼Œè®¡ç®—ï¼š</p>
<script type="math/tex; mode=display">
t_i = \textbf{s}_ia_i + P_ie_i</script><p>å…¶ä¸­$a_i$æ˜¯$512\times1024$çš„çŸ©é˜µï¼Œ$P_i$æ˜¯ä¸€ä¸ªéšæœºç½®æ¢ï¼Œ$e_i$æ˜¯è¯¯å·®æ•°é‡ä¸º22çš„errorã€‚åœ¨è¿™ä¹‹åæŠŠé•¿1024çš„å‘é‡$t_i$æ‹†æˆä¸€ä¸ª$4\times 256$çš„çŸ©é˜µæ”¾å…¥çŸ©é˜µ$A$ä¸­ï¼Œæœ€ç»ˆä¼šå¾—åˆ°ä¸€ä¸ª$80 \times 256$çš„çŸ©é˜µ$A$</p>
</li>
<li><p>tedious_workéƒ¨åˆ†ï¼Œé¢˜ç›®åœ¨$F_q$è®¡ç®—äº†ä¸€ä¸ªï¼š</p>
<script type="math/tex; mode=display">
Ï€ = ÏƒA+ÎµÎ±</script><p>å¹¶ç»™å‡º$Ï€,Î±$</p>
</li>
</ul>
<p>æ¥ä¸‹æ¥å°±åˆ†ä¸‰ä¸ªéƒ¨åˆ†æ¥è¿›å…¥è§£é¢˜ã€‚</p>
<h4 id="æ–¹æ³•ä¸€-1"><a href="#æ–¹æ³•ä¸€-1" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h4><h5 id="tedious-work"><a href="#tedious-work" class="headerlink" title="tedious_work"></a>tedious_work</h5><p>å¯¹äºè¿™ä¸ªéƒ¨åˆ†ï¼Œæˆ‘ä»¬æœ‰$Ï€,Î±$ï¼Œä»¥åŠå¦‚ä¸‹å…³ç³»å¼ï¼š</p>
<script type="math/tex; mode=display">
Ï€ = ÏƒA+ÎµÎ±</script><p>æ³¨æ„åˆ°åœ¨$F_q$ä¸‹ï¼Œå…¨ä¸º256ä»¥å†…å€¼çš„$A$æ˜¾ç„¶ç®—å°é‡ï¼Œå› æ­¤è¿™å…¶å®æ˜¯ä¸ªæ­£äº¤æ ¼çš„é—®é¢˜ï¼Œå…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬ç”¨æ ¼æ‰¾åˆ°æ»¡è¶³å¦‚ä¸‹æ¡ä»¶çš„å°å€¼çŸ©é˜µ$M$ï¼š</p>
<script type="math/tex; mode=display">
Ï€M = Î±M = 0</script><p>é‚£ä¹ˆä»£å…¥ä¸Šå¼æœ‰ï¼š</p>
<script type="math/tex; mode=display">
ÏƒAM = 0</script><p>æ‰€ä»¥å¯¹$M$çš„å·¦æ ¸è¿›è¡Œè§„çº¦å°±å¯ä»¥æ‰¾åˆ°LLL-reduceè¿‡çš„$A$äº†ï¼Œè®°ä¸º$kA$</p>
<blockquote>
<p>å®é™…ä¸Šå¯ä»¥æ›´è¿›ä¸€æ­¥ï¼Œç”¨æµ‹è¯•æ•°æ®è§‚å¯Ÿä¸€ä¸‹ï¼Œä¼šå‘ç°$kA$ä¸­çš„å‘é‡åŸºæœ¬åªæ¶‰åŠåŸå§‹Aä¸­çš„è‡³å¤šä¸¤ä¸ªå‘é‡çš„çº¦å‡ï¼Œå¹¶ä¸”ç³»æ•°æ˜¯1æˆ–è€…-1ã€‚æ‰€ä»¥ç”¨è´ªå¿ƒçš„æ€è·¯å»æœå…¶å®å¯ä»¥æ‰¾åˆ°ä¸€ä¸ª$A$çš„è¡Œå‘é‡ç½®æ¢åçš„ç»“æœï¼Œä¹Ÿå°±æ˜¯å¯ä»¥æ‰¾åˆ°ä¸€ä¸ª$PA$ï¼Œè¿™æ˜¯ä¸€ä¸ªæ›´å¼ºçš„æ¡ä»¶</p>
</blockquote>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> re <span class="keyword">import</span> findall</span><br><span class="line"><span class="keyword">from</span> subprocess <span class="keyword">import</span> check_output</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">flatter</span>(<span class="params">M</span>):</span><br><span class="line">    <span class="comment"># compile https://github.com/keeganryan/flatter and put it in $PATH</span></span><br><span class="line">    z = <span class="string">&quot;[[&quot;</span> + <span class="string">&quot;]\n[&quot;</span>.join(<span class="string">&quot; &quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, row)) <span class="keyword">for</span> row <span class="keyword">in</span> M) + <span class="string">&quot;]]&quot;</span></span><br><span class="line">    ret = check_output([<span class="string">&quot;flatter&quot;</span>], <span class="built_in">input</span>=z.encode())</span><br><span class="line">    <span class="keyword">return</span> matrix(M.nrows(), M.ncols(), <span class="built_in">map</span>(<span class="built_in">int</span>, findall(<span class="string">b&quot;-?\\d+&quot;</span>, ret)))</span><br><span class="line"></span><br><span class="line">N, n, q = <span class="number">1024</span>, <span class="number">60</span>, <span class="number">2</span>**<span class="number">521</span>-<span class="number">1</span></span><br><span class="line">F, Fq = Zmod(<span class="number">256</span>), GF(q)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;tedious&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    tedious = <span class="built_in">eval</span>(f.read())</span><br><span class="line">Î± = Matrix(Fq, tedious[<span class="string">&quot;Î±&quot;</span>])</span><br><span class="line">Ï€ = Matrix(Fq, tedious[<span class="string">&quot;Ï€&quot;</span>])</span><br><span class="line">mat = load(<span class="string">&quot;mat.sobj&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Ïƒ*A+kÎ± = Ï€</span></span><br><span class="line"><span class="comment"># find Î±r = Ï€r = 0</span></span><br><span class="line"></span><br><span class="line">NN = Î±.stack(Ï€).T</span><br><span class="line">T1 = block_matrix(ZZ,[</span><br><span class="line">    [<span class="number">1</span>, NN],</span><br><span class="line">    [<span class="number">0</span>, q]</span><br><span class="line">])</span><br><span class="line">T1[:,-<span class="number">120</span>:] *= q</span><br><span class="line">T1 = flatter(T1)</span><br><span class="line"></span><br><span class="line">Ker = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">136</span>):</span><br><span class="line">    Ker.append(<span class="built_in">list</span>(T1[i][:<span class="number">256</span>]))</span><br><span class="line">Ker = Matrix(Zmod(q), Ker).T</span><br><span class="line"></span><br><span class="line">NNN = Matrix(ZZ, Ker)</span><br><span class="line"></span><br><span class="line">L = block_matrix(ZZ,[</span><br><span class="line">    [NNN,<span class="number">1</span>],</span><br><span class="line">    [q,<span class="number">0</span>]</span><br><span class="line">])</span><br><span class="line">L[:,:<span class="number">136</span>] *= q</span><br><span class="line">L = flatter(L)</span><br><span class="line"></span><br><span class="line">A = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> L[:<span class="number">80</span>]:</span><br><span class="line">    A.append(i[-<span class="number">256</span>:])</span><br><span class="line">A = Matrix(ZZ,A)</span><br><span class="line"></span><br><span class="line"><span class="comment">#search for all A(using greedy)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">v</span>):</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">all</span>(i &gt;= <span class="number">0</span> <span class="keyword">and</span> i &lt;= <span class="number">256</span>  <span class="keyword">for</span> i <span class="keyword">in</span> v)):</span><br><span class="line">        <span class="keyword">return</span> v</span><br><span class="line">    <span class="keyword">elif</span>(<span class="built_in">all</span>(i &lt;= <span class="number">0</span> <span class="keyword">and</span> i &gt;= -<span class="number">256</span> <span class="keyword">for</span> i <span class="keyword">in</span> v)):</span><br><span class="line">        <span class="keyword">return</span> -v</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find</span>(<span class="params">Ker,x</span>):</span><br><span class="line">    x = [i <span class="keyword">for</span> i <span class="keyword">in</span> ini]</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> vi <span class="keyword">in</span> x:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> Ker:</span><br><span class="line">                xi1 = check(i + vi)</span><br><span class="line">                xi2 = check(i - vi)</span><br><span class="line">                <span class="keyword">if</span> xi1 <span class="keyword">and</span> xi1 <span class="keyword">not</span> <span class="keyword">in</span> x:</span><br><span class="line">                    x.append(xi1)</span><br><span class="line">                    <span class="keyword">if</span>(<span class="built_in">len</span>(x) == <span class="number">80</span>):</span><br><span class="line">                        <span class="keyword">return</span> Matrix(ZZ,x)</span><br><span class="line">                <span class="keyword">if</span> xi2 <span class="keyword">and</span> xi2 <span class="keyword">not</span> <span class="keyword">in</span> x:</span><br><span class="line">                    x.append(xi2)</span><br><span class="line">                    <span class="keyword">if</span>(<span class="built_in">len</span>(x) == <span class="number">80</span>):</span><br><span class="line">                        <span class="keyword">return</span> Matrix(ZZ,x)</span><br><span class="line"></span><br><span class="line">ini = [check(vi) <span class="keyword">for</span> vi <span class="keyword">in</span> A <span class="keyword">if</span> check(vi)]</span><br><span class="line">AA = find(A,ini)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(AA))</span><br></pre></td></tr></table></figure>
<h5 id="MT"><a href="#MT" class="headerlink" title="*MT"></a>*MT</h5><p>è¿™ä¸€æ­¥æ¯”èµ›ä¸­æˆ‘å®Œå…¨æ²¡æœ‰æ³¨æ„åˆ°ï¼Œç›´æ¥å¯¼è‡´äº†ä¸çŸ¥é“è¯¥æ€ä¹ˆæ¢å¤$A$çš„é¡ºåºï¼Œå¹¶ä¸”ç”±äºæœ€åä¸€æ­¥æ˜¯éœ€è¦æ±‚è§£sä¸­å‘é‡çš„å’Œè€Œä¸æ˜¯é¡ºåºçš„sï¼Œæ‰€ä»¥ç›´æ¥å¯¼è‡´äº†æˆ‘è®¤ä¸ºä¹Ÿè®¸å¯ä»¥åœ¨Aé¡ºåºé”™ä¹±çš„æƒ…å†µä¸‹è§£å†³error_workéƒ¨åˆ†ï¼Œå› æ­¤æ•´ä¸ªæ€è·¯å°±è·‘åäº†ã€‚</p>
<blockquote>
<p> è€Œç°åœ¨çœ‹æ¥ï¼Œå…¶å®è¿é¢˜ç›®åå­—éƒ½å¯¹è¿™ä¸ªåšäº†æš—ç¤ºï¼Œåªèƒ½è¯´è¿™æ³¢è€ƒè™‘çš„ä¸æ˜¯å¾ˆå‘¨åˆ°TT</p>
</blockquote>
<p>è€Œä¹‹æ‰€ä»¥èƒ½ç”¨MTä¸»è¦åœ¨äºtedious_workéƒ¨åˆ†é‡Œå…¶å®å¤§èŒƒå›´ä½¿ç”¨äº†randrangeå‡½æ•°ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">tedious_work</span>(<span class="params">A</span>):</span><br><span class="line">    Î± = random_matrix(Fq, n, N//<span class="number">4</span>)</span><br><span class="line">    Îµ = matrix(n, N//<span class="number">4</span>, [i*randrange(<span class="number">0</span>, q) <span class="keyword">for</span> i <span class="keyword">in</span> Î±])</span><br><span class="line">    Ïƒ = matrix(Fq, [[randrange(<span class="number">1</span>, q) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">80</span>)] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line">    <span class="built_in">open</span>(<span class="string">&quot;tedious&quot;</span>, <span class="string">&quot;w&quot;</span>).write(<span class="built_in">str</span>(&#123;<span class="string">&quot;Ï€&quot;</span>: <span class="built_in">list</span>(Ïƒ*A+Îµ), <span class="string">&quot;Î±&quot;</span>: <span class="built_in">list</span>(Î±)&#125;))</span><br></pre></td></tr></table></figure>
<p>è€Œå¯¹äº$q=2^{521}-1$è¿™ç§æ•°å­—æ¥è®²ï¼Œè¿™æ ·çš„<code>randrange(0, q)</code>åŸºæœ¬å®Œå…¨ç­‰ä»·äº<code>getrandbits(521)</code>ï¼Œå› æ­¤å¦‚æœæˆ‘ä»¬èƒ½æ±‚å‡º$Îµ$ï¼Œå°±æœ‰60ä¸ª521bitçš„æ•°å­—ï¼Œå°±å¯ä»¥åˆ©ç”¨MTé€šè¿‡é¢„æµ‹éšæœºæ•°çš„æ–¹å¼å¾—åˆ°$Ïƒ$äº†ã€‚</p>
<p>è€Œæ±‚è§£$Îµ$å¹¶ä¸éº»çƒ¦ï¼Œå›é¡¾ç­‰å¼ï¼š</p>
<script type="math/tex; mode=display">
Ï€ = ÏƒA+ÎµÎ±</script><p>æˆ‘ä»¬ç°åœ¨æœ‰äº†$kA$ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ±‚$kA$çš„å³æ ¸$M$ï¼Œä»£å…¥å°±å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
Ï€M = ÎµÎ±M</script><p>ç„¶åè§£çŸ©é˜µæ–¹ç¨‹å°±æœ‰$Îµ$ï¼Œä¹‹åå°±å¯ä»¥é€šè¿‡MTé¢„æµ‹éšæœºæ•°å¾—åˆ°$Ïƒ$ã€‚</p>
<blockquote>
<p>è¿™é‡Œé¢„æµ‹éšæœºæ•°çš„è¯ï¼Œæˆ‘ç”¨æœ´ç´ çš„å»ºçŸ©é˜µæ–¹æ³•ä¼šå‘ç°ç”±äºæ¯”ç‰¹ä¹‹é—´çº¿æ€§ç›¸å…³æ€§å¾ˆå¼ºï¼Œè‡³å°‘è¦ç”¨30000å¤šbitçš„è¾“å‡ºæ‰èƒ½ä½¿çŸ©é˜µçš„ç§©è¾¾åˆ°é¢„æœŸçš„19937ï¼Œè€Œè¿™æ ·å†…å­˜ä¼šç›´æ¥ä¸å¤Ÿç”¨</p>
<p>é—®äº†ä¸‹hashhashå¸ˆå‚…ï¼Œåˆå¾—åˆ°äº†ä¸€ä¸ªæœ‰åŠ›çš„æ–°å·¥å…·ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://github.com/icemonster/symbolic_mersenne_cracker">https://github.com/icemonster/symbolic_mersenne_cracker</a></p>
</blockquote>
<p>è€Œç°åœ¨æˆ‘ä»¬æœ‰äº†$Ïƒ$ï¼Œå°±å¯ä»¥æ¢å¤é¡ºåºæ­£ç¡®çš„$A$äº†ï¼Œç²—æš´ä¸€ç‚¹ç›´æ¥å¯¹ä¸‹å¼é€åˆ—åšLLLå³å¯ï¼š</p>
<script type="math/tex; mode=display">
Ï€ = ÏƒA+ÎµÎ±</script><p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">PA = load(<span class="string">&quot;PA.sobj&quot;</span>)</span><br><span class="line"></span><br><span class="line">PA = Matrix(Fq, PA)</span><br><span class="line">PA_Ker = Matrix(Fq, PA.right_kernel().basis()).T</span><br><span class="line">X = Ï€*PA_Ker</span><br><span class="line">Y = Î±*PA_Ker</span><br><span class="line">K = Y.solve_left(X)</span><br><span class="line">k = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    k.append(K[i,i])</span><br><span class="line"><span class="built_in">print</span>(k)</span><br><span class="line"></span><br><span class="line"><span class="comment">############################################################### MT predict</span></span><br><span class="line">go to python <span class="keyword">and</span> predict MT :)</span><br><span class="line"><span class="comment">############################################################### MT predict</span></span><br><span class="line"></span><br><span class="line">states = [<span class="number">113704197</span>, <span class="number">3405842530</span>, <span class="number">1738689478</span>, <span class="number">703229539</span>, <span class="number">2907259502</span>, <span class="number">1773213255</span>, <span class="number">4259193140</span>, <span class="number">2328997110</span>, <span class="number">2326382620</span>, <span class="number">3539943450</span>, <span class="number">3943473704</span>, <span class="number">1640519491</span>, <span class="number">1875870865</span>, <span class="number">2731501447</span>, <span class="number">4209819181</span>, <span class="number">3449883535</span>, <span class="number">3523992081</span>, <span class="number">3280171865</span>, <span class="number">2416845087</span>, <span class="number">2151403870</span>, <span class="number">693081970</span>, <span class="number">1747115758</span>, <span class="number">4015945850</span>, <span class="number">3686334481</span>, <span class="number">898499801</span>, <span class="number">4190457978</span>, <span class="number">3787813964</span>, <span class="number">3258218099</span>, <span class="number">3437965753</span>, <span class="number">1878250724</span>, <span class="number">3189476074</span>, <span class="number">1152476894</span>, <span class="number">147834339</span>, <span class="number">2769430677</span>, <span class="number">3511032479</span>, <span class="number">3567924279</span>, <span class="number">2161471426</span>, <span class="number">563308943</span>, <span class="number">3446408078</span>, <span class="number">1949971313</span>, <span class="number">1895962308</span>, <span class="number">3707951421</span>, <span class="number">968721904</span>, <span class="number">252441955</span>, <span class="number">2533651660</span>, <span class="number">2889128006</span>, <span class="number">1721763532</span>, <span class="number">2505823299</span>, <span class="number">458331240</span>, <span class="number">2059589053</span>, <span class="number">64385284</span>, <span class="number">4029357042</span>, <span class="number">695109338</span>, <span class="number">744440358</span>, <span class="number">3519688222</span>, <span class="number">2361161993</span>, <span class="number">3223663686</span>, <span class="number">2010594546</span>, <span class="number">3958688671</span>, <span class="number">2291905952</span>, <span class="number">3926524336</span>, <span class="number">2011139757</span>, <span class="number">461769836</span>, <span class="number">3114896752</span>, <span class="number">2282936557</span>, <span class="number">1927285746</span>, <span class="number">2582255350</span>, <span class="number">504168956</span>, <span class="number">4113181790</span>, <span class="number">848941762</span>, <span class="number">383163494</span>, <span class="number">1372255865</span>, <span class="number">3496580772</span>, <span class="number">2692443861</span>, <span class="number">3389749948</span>, <span class="number">498352369</span>, <span class="number">748459956</span>, <span class="number">3389041382</span>, <span class="number">141074870</span>, <span class="number">1632758136</span>, <span class="number">3219470486</span>, <span class="number">126558810</span>, <span class="number">1031061639</span>, <span class="number">2672864696</span>, <span class="number">48240402</span>, <span class="number">2704206234</span>, <span class="number">1425068775</span>, <span class="number">3265363748</span>, <span class="number">630960765</span>, <span class="number">3819353836</span>, <span class="number">1858506649</span>, <span class="number">485318072</span>, <span class="number">4128742296</span>, <span class="number">3376811318</span>, <span class="number">4204655629</span>, <span class="number">1286398000</span>, <span class="number">2303971794</span>, <span class="number">4274435326</span>, <span class="number">4044081550</span>, <span class="number">1715823135</span>, <span class="number">132631825</span>, <span class="number">3152223805</span>, <span class="number">2583497918</span>, <span class="number">1635027483</span>, <span class="number">3339956668</span>, <span class="number">707057445</span>, <span class="number">3980699204</span>, <span class="number">614764316</span>, <span class="number">1346718391</span>, <span class="number">1135939959</span>, <span class="number">2997914131</span>, <span class="number">4051263902</span>, <span class="number">1963572188</span>, <span class="number">770507588</span>, <span class="number">3909567052</span>, <span class="number">2091058219</span>, <span class="number">2543156465</span>, <span class="number">3842371252</span>, <span class="number">3443677424</span>, <span class="number">759282030</span>, <span class="number">2889909779</span>, <span class="number">1368851309</span>, <span class="number">305191756</span>, <span class="number">1858852750</span>, <span class="number">554329976</span>, <span class="number">3904036123</span>, <span class="number">2901653875</span>, <span class="number">2741469407</span>, <span class="number">2572249766</span>, <span class="number">1246238357</span>, <span class="number">659145741</span>, <span class="number">190685166</span>, <span class="number">3612959518</span>, <span class="number">640691503</span>, <span class="number">1185217803</span>, <span class="number">1009848496</span>, <span class="number">3206611783</span>, <span class="number">2894535678</span>, <span class="number">3453033501</span>, <span class="number">289230470</span>, <span class="number">1372089846</span>, <span class="number">1049152746</span>, <span class="number">2850741310</span>, <span class="number">984661882</span>, <span class="number">611884565</span>, <span class="number">1236657355</span>, <span class="number">3343527827</span>, <span class="number">2548951125</span>, <span class="number">562791145</span>, <span class="number">2252848045</span>, <span class="number">3105367880</span>, <span class="number">2712522865</span>, <span class="number">2479258764</span>, <span class="number">2986877450</span>, <span class="number">3601398564</span>, <span class="number">3662538540</span>, <span class="number">3275126554</span>, <span class="number">2940194474</span>, <span class="number">1356516733</span>, <span class="number">4044042721</span>, <span class="number">1494897675</span>, <span class="number">1989984303</span>, <span class="number">1097151926</span>, <span class="number">4221219684</span>, <span class="number">1212544909</span>, <span class="number">3340394958</span>, <span class="number">1390514300</span>, <span class="number">1549503887</span>, <span class="number">2581775858</span>, <span class="number">2545827540</span>, <span class="number">2645302457</span>, <span class="number">230521227</span>, <span class="number">3196138321</span>, <span class="number">2625674622</span>, <span class="number">79454347</span>, <span class="number">187896698</span>, <span class="number">2008836319</span>, <span class="number">1045267458</span>, <span class="number">1829322640</span>, <span class="number">4025973981</span>, <span class="number">3790962910</span>, <span class="number">283254001</span>, <span class="number">2623533575</span>, <span class="number">122212170</span>, <span class="number">1759345544</span>, <span class="number">869521827</span>, <span class="number">825919923</span>, <span class="number">486969567</span>, <span class="number">78939622</span>, <span class="number">2861038139</span>, <span class="number">1135095820</span>, <span class="number">2180896951</span>, <span class="number">900573089</span>, <span class="number">2804379345</span>, <span class="number">3626010865</span>, <span class="number">1053464390</span>, <span class="number">3427238220</span>, <span class="number">2692890127</span>, <span class="number">949965100</span>, <span class="number">2587630194</span>, <span class="number">2356494570</span>, <span class="number">1622890994</span>, <span class="number">986294457</span>, <span class="number">4244918160</span>, <span class="number">617700961</span>, <span class="number">1624977147</span>, <span class="number">2716699722</span>, <span class="number">2078770881</span>, <span class="number">1002097877</span>, <span class="number">244885836</span>, <span class="number">2443012853</span>, <span class="number">2039552484</span>, <span class="number">4171906420</span>, <span class="number">2427771544</span>, <span class="number">1305324504</span>, <span class="number">2724020235</span>, <span class="number">1036098721</span>, <span class="number">3919115037</span>, <span class="number">993285859</span>, <span class="number">386235749</span>, <span class="number">1258147194</span>, <span class="number">610050676</span>, <span class="number">3012646137</span>, <span class="number">2305189066</span>, <span class="number">1178414969</span>, <span class="number">3302542440</span>, <span class="number">1462463223</span>, <span class="number">1437498692</span>, <span class="number">3668103437</span>, <span class="number">1084808916</span>, <span class="number">309279283</span>, <span class="number">4017505061</span>, <span class="number">1558248353</span>, <span class="number">423359063</span>, <span class="number">4244733362</span>, <span class="number">616039082</span>, <span class="number">2102560308</span>, <span class="number">1060727767</span>, <span class="number">1920662732</span>, <span class="number">358907463</span>, <span class="number">3396088680</span>, <span class="number">903551662</span>, <span class="number">868558723</span>, <span class="number">3212315449</span>, <span class="number">2519349944</span>, <span class="number">1503499107</span>, <span class="number">2102219311</span>, <span class="number">3449942920</span>, <span class="number">669316525</span>, <span class="number">2108323918</span>, <span class="number">2708665195</span>, <span class="number">1941048760</span>, <span class="number">583680212</span>, <span class="number">3424787423</span>, <span class="number">2232015555</span>, <span class="number">2054145795</span>, <span class="number">242750178</span>, <span class="number">3896737257</span>, <span class="number">1467962784</span>, <span class="number">970382615</span>, <span class="number">1392558681</span>, <span class="number">3881466100</span>, <span class="number">2903195184</span>, <span class="number">3585586116</span>, <span class="number">1914526073</span>, <span class="number">2106370747</span>, <span class="number">1008444182</span>, <span class="number">2107010937</span>, <span class="number">2822188700</span>, <span class="number">1218447381</span>, <span class="number">2308375528</span>, <span class="number">3369742794</span>, <span class="number">2975504770</span>, <span class="number">4176851601</span>, <span class="number">67514816</span>, <span class="number">4246377398</span>, <span class="number">1734425751</span>, <span class="number">1993987051</span>, <span class="number">1145805899</span>, <span class="number">3244559845</span>, <span class="number">2521286868</span>, <span class="number">541117045</span>, <span class="number">721746299</span>, <span class="number">3298483091</span>, <span class="number">491071222</span>, <span class="number">1354933102</span>, <span class="number">2956619599</span>, <span class="number">1199597464</span>, <span class="number">3193364044</span>, <span class="number">3668585273</span>, <span class="number">200554677</span>, <span class="number">972726751</span>, <span class="number">2203882536</span>, <span class="number">3485522382</span>, <span class="number">2761802839</span>, <span class="number">3754978098</span>, <span class="number">165615557</span>, <span class="number">322534410</span>, <span class="number">3524217767</span>, <span class="number">4138073568</span>, <span class="number">2261377656</span>, <span class="number">4006747923</span>, <span class="number">109290994</span>, <span class="number">2456757773</span>, <span class="number">2374256574</span>, <span class="number">3232001613</span>, <span class="number">3564455680</span>, <span class="number">1701870507</span>, <span class="number">2377668333</span>, <span class="number">1216762358</span>, <span class="number">553166470</span>, <span class="number">4133793648</span>, <span class="number">2938687008</span>, <span class="number">3815389598</span>, <span class="number">2231853860</span>, <span class="number">3308357816</span>, <span class="number">515681335</span>, <span class="number">2826361049</span>, <span class="number">288633911</span>, <span class="number">110468545</span>, <span class="number">3265849311</span>, <span class="number">3852434959</span>, <span class="number">1231187782</span>, <span class="number">361481132</span>, <span class="number">584104453</span>, <span class="number">1935867088</span>, <span class="number">4149367251</span>, <span class="number">3831702086</span>, <span class="number">1203733277</span>, <span class="number">2899033791</span>, <span class="number">146772292</span>, <span class="number">2887208072</span>, <span class="number">3963017011</span>, <span class="number">3233095710</span>, <span class="number">3600173778</span>, <span class="number">1306987150</span>, <span class="number">390355547</span>, <span class="number">862238214</span>, <span class="number">3220269886</span>, <span class="number">2826165734</span>, <span class="number">689420894</span>, <span class="number">138511293</span>, <span class="number">1327820607</span>, <span class="number">265976988</span>, <span class="number">3864481874</span>, <span class="number">1774854365</span>, <span class="number">276867882</span>, <span class="number">2298473905</span>, <span class="number">698421415</span>, <span class="number">388689242</span>, <span class="number">1038955726</span>, <span class="number">3712967142</span>, <span class="number">2661024048</span>, <span class="number">4236026832</span>, <span class="number">1237739677</span>, <span class="number">4055165262</span>, <span class="number">534625863</span>, <span class="number">1489376830</span>, <span class="number">1800306875</span>, <span class="number">3698762430</span>, <span class="number">3777224699</span>, <span class="number">3234261312</span>, <span class="number">322143627</span>, <span class="number">1816432874</span>, <span class="number">1274393877</span>, <span class="number">812128958</span>, <span class="number">3249283852</span>, <span class="number">3740153121</span>, <span class="number">99828532</span>, <span class="number">678084661</span>, <span class="number">766588687</span>, <span class="number">387426792</span>, <span class="number">987971056</span>, <span class="number">2080859085</span>, <span class="number">850637292</span>, <span class="number">1277972870</span>, <span class="number">188018627</span>, <span class="number">2394503743</span>, <span class="number">2315476470</span>, <span class="number">1565011923</span>, <span class="number">1941074311</span>, <span class="number">1179787099</span>, <span class="number">482261965</span>, <span class="number">835090610</span>, <span class="number">1026182337</span>, <span class="number">530973140</span>, <span class="number">3201248099</span>, <span class="number">288945328</span>, <span class="number">2552958881</span>, <span class="number">2737411289</span>, <span class="number">617540214</span>, <span class="number">1987197723</span>, <span class="number">2597866739</span>, <span class="number">1229316798</span>, <span class="number">636632825</span>, <span class="number">3759065119</span>, <span class="number">2051062165</span>, <span class="number">1090249666</span>, <span class="number">4012867151</span>, <span class="number">3997281726</span>, <span class="number">1891614046</span>, <span class="number">1950467577</span>, <span class="number">1896564800</span>, <span class="number">2803835300</span>, <span class="number">3606368644</span>, <span class="number">257560555</span>, <span class="number">3883205059</span>, <span class="number">664635385</span>, <span class="number">4102706448</span>, <span class="number">622545284</span>, <span class="number">3280864106</span>, <span class="number">293013878</span>, <span class="number">1127325978</span>, <span class="number">3215983960</span>, <span class="number">1146222004</span>, <span class="number">3326539387</span>, <span class="number">808949477</span>, <span class="number">3970628609</span>, <span class="number">4007212270</span>, <span class="number">2711477502</span>, <span class="number">557726083</span>, <span class="number">766381908</span>, <span class="number">33900284</span>, <span class="number">932748148</span>, <span class="number">1121083738</span>, <span class="number">4272167901</span>, <span class="number">466227150</span>, <span class="number">1505452928</span>, <span class="number">1528845019</span>, <span class="number">2263605533</span>, <span class="number">1016244607</span>, <span class="number">3237061456</span>, <span class="number">3137273984</span>, <span class="number">4211330922</span>, <span class="number">1155964522</span>, <span class="number">1608938084</span>, <span class="number">2887620568</span>, <span class="number">2662588350</span>, <span class="number">1201565218</span>, <span class="number">568530275</span>, <span class="number">2678380208</span>, <span class="number">3359503459</span>, <span class="number">3144725110</span>, <span class="number">814896638</span>, <span class="number">1064850116</span>, <span class="number">1483772157</span>, <span class="number">2568601930</span>, <span class="number">541715956</span>, <span class="number">2063836765</span>, <span class="number">2016359752</span>, <span class="number">3728066075</span>, <span class="number">2254054776</span>, <span class="number">722016621</span>, <span class="number">741878938</span>, <span class="number">2558272354</span>, <span class="number">2808723788</span>, <span class="number">4234530153</span>, <span class="number">2125747501</span>, <span class="number">2704729045</span>, <span class="number">2113451904</span>, <span class="number">3332283037</span>, <span class="number">1208922003</span>, <span class="number">1310310684</span>, <span class="number">557110487</span>, <span class="number">1171236916</span>, <span class="number">1135441796</span>, <span class="number">3086182596</span>, <span class="number">181993156</span>, <span class="number">904442790</span>, <span class="number">2096301594</span>, <span class="number">3148947917</span>, <span class="number">547059118</span>, <span class="number">2676365459</span>, <span class="number">551054518</span>, <span class="number">1402555326</span>, <span class="number">1266743827</span>, <span class="number">966157584</span>, <span class="number">1462709454</span>, <span class="number">1044422747</span>, <span class="number">1816623887</span>, <span class="number">1723907402</span>, <span class="number">3680143765</span>, <span class="number">3729225582</span>, <span class="number">4137182800</span>, <span class="number">1540646791</span>, <span class="number">1904561630</span>, <span class="number">4070808312</span>, <span class="number">2453054379</span>, <span class="number">2140927760</span>, <span class="number">1460445742</span>, <span class="number">16529247</span>, <span class="number">311847522</span>, <span class="number">3767018970</span>, <span class="number">660938106</span>, <span class="number">1235032574</span>, <span class="number">2993757301</span>, <span class="number">1334679238</span>, <span class="number">1421661735</span>, <span class="number">3365436073</span>, <span class="number">4096075739</span>, <span class="number">1013195725</span>, <span class="number">755997768</span>, <span class="number">666263898</span>, <span class="number">1909896304</span>, <span class="number">3251310335</span>, <span class="number">3999215317</span>, <span class="number">3302976019</span>, <span class="number">3547292488</span>, <span class="number">3966102960</span>, <span class="number">1860144301</span>, <span class="number">2420524501</span>, <span class="number">4198383718</span>, <span class="number">364183848</span>, <span class="number">813072812</span>, <span class="number">165238552</span>, <span class="number">1286095762</span>, <span class="number">2406680229</span>, <span class="number">4139882913</span>, <span class="number">2593781524</span>, <span class="number">2461772957</span>, <span class="number">3516662592</span>, <span class="number">1468160566</span>, <span class="number">1468596495</span>, <span class="number">1290505617</span>, <span class="number">680659494</span>, <span class="number">1082427874</span>, <span class="number">3220637159</span>, <span class="number">599428397</span>, <span class="number">2343433113</span>, <span class="number">2528532716</span>, <span class="number">3311188194</span>, <span class="number">488997170</span>, <span class="number">3504561095</span>, <span class="number">97864554</span>, <span class="number">2912302105</span>, <span class="number">4221852521</span>, <span class="number">2908477548</span>, <span class="number">940703408</span>, <span class="number">439839216</span>, <span class="number">896505182</span>, <span class="number">1252814322</span>, <span class="number">1901262143</span>, <span class="number">604086101</span>, <span class="number">159852464</span>, <span class="number">3568973474</span>, <span class="number">3821487860</span>, <span class="number">623098514</span>, <span class="number">202248458</span>, <span class="number">2977078642</span>, <span class="number">4036934666</span>, <span class="number">1549547455</span>, <span class="number">3422386820</span>, <span class="number">2938814110</span>, <span class="number">2640881906</span>, <span class="number">2271464353</span>, <span class="number">3641908765</span>, <span class="number">3373579173</span>, <span class="number">2759933980</span>, <span class="number">2957563388</span>, <span class="number">1862384250</span>, <span class="number">3833642986</span>, <span class="number">714120541</span>, <span class="number">38008176</span>, <span class="number">823996869</span>, <span class="number">3512767789</span>, <span class="number">245085003</span>, <span class="number">3871751583</span>, <span class="number">816496606</span>, <span class="number">997537973</span>, <span class="number">597244106</span>, <span class="number">1948340722</span>, <span class="number">1142655576</span>, <span class="number">3213975398</span>, <span class="number">3177419168</span>, <span class="number">1277075442</span>, <span class="number">2836191462</span>, <span class="number">1836238758</span>, <span class="number">2631533053</span>, <span class="number">2398455289</span>, <span class="number">589980987</span>, <span class="number">102662424</span>, <span class="number">4050080940</span>, <span class="number">2606072212</span>, <span class="number">638082255</span>, <span class="number">3821379936</span>, <span class="number">1855702237</span>, <span class="number">141488036</span>, <span class="number">790011767</span>, <span class="number">2814221285</span>, <span class="number">423059338</span>, <span class="number">1324669488</span>, <span class="number">1772067999</span>, <span class="number">929474842</span>, <span class="number">3439201681</span>, <span class="number">1472574624</span>, <span class="number">2524204217</span>, <span class="number">991362400</span>, <span class="number">60046905</span>, <span class="number">897384794</span>, <span class="number">4064258414</span>, <span class="number">1628707668</span>, <span class="number">644418391</span>, <span class="number">3844473927</span>, <span class="number">802859186</span>, <span class="number">2748442866</span>, <span class="number">2501688702</span>, <span class="number">693109486</span>, <span class="number">1060328162</span>, <span class="number">674456370</span>, <span class="number">2161128289</span>, <span class="number">1739588708</span>, <span class="number">1790254588</span>, <span class="number">3158300972</span>, <span class="number">3677273706</span>, <span class="number">4036870155</span>, <span class="number">1785921241</span>, <span class="number">1010936739</span>, <span class="number">1815361842</span>, <span class="number">2442375985</span>, <span class="number">278516160</span>, <span class="number">4182906499</span>, <span class="number">2505615705</span>, <span class="number">2501155191</span>, <span class="number">2687203272</span>]</span><br><span class="line">states = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> states]</span><br><span class="line">RNG = Random()</span><br><span class="line">RNG.setstate((<span class="number">3</span>,<span class="built_in">tuple</span>(states+[<span class="number">396</span>]),<span class="literal">None</span>))</span><br><span class="line">Ïƒ = matrix(Fq, [[RNG.randrange(<span class="number">1</span>, q) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">80</span>)] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">NN = Ï€-K*Î±</span><br><span class="line"></span><br><span class="line">A = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">256</span>):</span><br><span class="line">    L = block_matrix(ZZ,[</span><br><span class="line">        [<span class="number">1</span>, <span class="number">0</span>, Ïƒ.T],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">1</span>, Matrix(ZZ,NN[:,i:i+<span class="number">1</span>]).T],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, q]</span><br><span class="line">    ])</span><br><span class="line">    L[:,-<span class="number">60</span>:] *= q</span><br><span class="line">    res = <span class="built_in">list</span>(flatter(L)[<span class="number">0</span>])</span><br><span class="line">    res = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">abs</span>, res))</span><br><span class="line">    A.append(<span class="built_in">list</span>(res[:<span class="number">80</span>]))</span><br><span class="line">    </span><br><span class="line">A = Matrix(F, A).T</span><br><span class="line">save(A, <span class="string">&quot;A&quot;</span>)</span><br></pre></td></tr></table></figure>
<h5 id="error-work"><a href="#error-work" class="headerlink" title="error_work"></a>error_work</h5><p>ç°åœ¨æˆ‘ä»¬æœ‰äº†é¡ºåºçš„$A$ï¼Œæˆ‘ä»¬ä¹Ÿå°±æ‹¥æœ‰äº†20ä¸ªä¸‹é¢çš„å®ä¾‹ä¸­çš„$t_i,a_i$ï¼š</p>
<script type="math/tex; mode=display">
t_i = \textbf{s}_ia_i + P_ie_i</script><p>eçš„è¯¯å·®æ•°é‡å°‘ï¼Œä½†æ˜¯è¯¯å·®å€¼æ˜¯$F_{256}$ä¸‹çš„éšæœºå€¼ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸€ä¸ªå°†$a_i$ä½œä¸ºç”ŸæˆçŸ©é˜µçš„çº¿æ€§ç è§£ç é—®é¢˜ã€‚</p>
<p>æˆ‘å¯¹ç¼–ç äº†è§£çš„å¹¶ä¸å¤šï¼Œä¸è¿‡å¾ˆå®¹æ˜“æ³¨æ„åˆ°ä¸¤ä¸ªäº‹å®ï¼š</p>
<ul>
<li><p>1024ä¸ªæ–¹ç¨‹ä¸­åªæœ‰22ä¸ªæ˜¯é”™è¯¯çš„ï¼Œæ‰€ä»¥éšæœºé€‰520ä¸ªå»è§£æ–¹ç¨‹å¾—åˆ°sï¼Œè¿™æ¦‚ç‡ä¹Ÿå¹¶ä¸ä½ï¼Œå‡ ç™¾ä¸‡æ¬¡å°±å¯ä»¥</p>
<blockquote>
<p>å¯ä»¥è¿™æ ·ç®€å•æµ‹ä¸€ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">t = comb((<span class="number">1024</span>-<span class="number">22</span>),<span class="number">520</span>) / comb(<span class="number">1024</span>,<span class="number">520</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>(<span class="number">1</span>/t))</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">7523285</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>$Z_{256}$å®Œå…¨å¯ä»¥è½¬åˆ°$Z_2$ä¸‹åšdecodeï¼Œè®¡ç®—é‡å‡å°çš„åŒæ—¶ï¼Œå¶æ•°çš„è¯¯å·®è¿˜ä¼šæ¶ˆå¤±ï¼Œç›¸å½“äºè¯¯å·®æ•°é‡ä¼šå˜å°</p>
<blockquote>
<p>åŒæ ·å¯ä»¥æµ‹ä¸€ä¸‹ï¼Œæ—¢ç„¶ä¸€å…±æœ‰22ä¸ªerrorï¼Œé‚£ä¹ˆé¢„æœŸä¸­æ”¾åˆ°æ¨¡2åä¼šå‡å°11ä¸ªerrorï¼Œæ‰€ä»¥æˆ‘ä»¬èƒ½å®šä½11ä¸ªerrorçš„ä½ç½®ï¼Œä»è€Œå‡å°é€‰åˆ°errorçš„æ¦‚ç‡ï¼Œæ­¤æ—¶æœŸæœ›ä¸ºï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">t = comb(<span class="number">1024</span>-<span class="number">22</span>,<span class="number">520</span>) / comb(<span class="number">1024</span>-<span class="number">11</span>,<span class="number">520</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>(<span class="number">1</span>/t))</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2920</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡ºéœ€è¦çš„æ¬¡æ•°å°±å°‘å¾ˆå¤šäº†</p>
</blockquote>
</li>
</ul>
<p>æ‰€ä»¥ä¸€ä¸ªå¾ˆè‡ªç„¶çš„æ€è·¯å°±æ˜¯ï¼š</p>
<ul>
<li>å…ˆå¯¹æ¯ä¸ªç å­—åœ¨æ¨¡2ä¸‹decodeï¼Œè¿™æ ·å¯ä»¥æŠŠå¥‡æ•°çš„è¯¯å·®å®šä½ï¼Œç„¶åä»å¤‡é€‰åˆ—ä¸­å‰”é™¤æ‰</li>
<li>ä¹‹ååœ¨$Z_{256}$ä¸‹å‰©ä½™çš„åˆ—ä¸­éšæœºé€‰æ‹©520åˆ—å»è§£æ–¹ç¨‹ï¼ˆè¿™æ ·åšæ˜¯ä¸ºäº†å¢åŠ çº¦æŸï¼‰ï¼Œæœ‰è§£çš„æ—¶å€™å°±å¾—åˆ°äº†s</li>
</ul>
<p>åœ¨æ¨¡2ä¸‹decodeå¯ä»¥ç›´æ¥æŠ„mapleåœ¨<a target="_blank" rel="noopener" href="https://blog.maple3142.net/2024/04/21/grey-cat-the-flag-2024-quals-writeups/?highlight=isd#coding">Grey Cat The Flag 2024 Qualifiers</a>ä¸­çš„è°ƒç”¨ï¼Œç”±äºæ¨¡2ä¸‹æœŸæœ›ä¼šæœ‰ä¸€åŠçš„å¥‡æ•°è¯¯å·®ä¼šæ¶ˆå¤±ï¼Œæ‰€ä»¥å¯ä»¥æŠŠerror weightè®¾ç½®çš„ä½ä¸€äº›æé«˜è§£ç é€Ÿåº¦ï¼Œä¹‹åå°±ä¸€ç›´ä»å‰©ä½™çš„æ–¹ç¨‹ç»„é‡ŒæŠ½ä¸€ç›´åˆ°æ‰¾åˆ°è§£å°±å¥½ã€‚</p>
<p>ä¸è¿‡å®é™…ä¸Šæ‰‹ä¼šå‘ç°ï¼Œè§£512x520è§„æ¨¡çš„$F_{256}$ä¸‹çŸ©é˜µæ–¹ç¨‹ä¹Ÿè¦å¥½å‡ ç§’ä¸€æ¬¡ï¼Œæ‰€ä»¥è¦åŠ ç‚¹å¤šè¿›ç¨‹æ‰è¡Œã€‚</p>
<blockquote>
<p>å…¶å®è¿˜æ˜¯ç›¸å½“æ…¢ï¼Œæ‰€ä»¥è¿˜æ˜¯æŒ‰é¢„æœŸè§£ä»$Z_2$ä¸‹decodeå¾€ä¸Šliftæœ€å¥½ï¼Œä½†æ˜¯æˆ‘çœŸçš„ä¸å¤ªä¼š</p>
<p>åº”è¯¥éƒ½ä¸èƒ½è¯´ç›¸å½“æ…¢ï¼Œå®é™…ä¸Šæ˜¯å·¨æ…¢ï¼Œå°¤å…¶æœ‰ä¸€ä¸ª$F_2$ä¸‹erroråªæœ‰6ä¸ªçš„ï¼Œé¢„æœŸè¦roll 20ä¸‡æ¬¡ï¼Œæ‰€ä»¥æˆ‘å®é™…ä¸Šå·æ‡’æ²¡è·‘è¿™ç»„è€Œæ˜¯ç›´æ¥ç”¨äº†hashhashçš„æ•°æ®XD</p>
</blockquote>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">A = load(<span class="string">&quot;A.sobj&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">############################################################### collect codewords</span></span><br><span class="line">C = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    C.append(vector(F, A[<span class="number">4</span>*i:<span class="number">4</span>*i+<span class="number">4</span>].<span class="built_in">list</span>()))</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sage.coding.linear_code <span class="keyword">import</span> LinearCode</span><br><span class="line"><span class="keyword">from</span> sage.coding.information_set_decoder <span class="keyword">import</span> LeeBrickellISDAlgorithm</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">My_decode</span>(<span class="params">Generator_Matrix, Codeword</span>):</span><br><span class="line">    <span class="comment">######################## ISD decode in F2</span></span><br><span class="line">    G = Generator_Matrix.change_ring(F2)</span><br><span class="line">    CODE = LinearCode(G)</span><br><span class="line">    D = LeeBrickellISDAlgorithm(CODE, decoding_interval=(<span class="number">5</span>, <span class="number">15</span>))</span><br><span class="line"></span><br><span class="line">    s = Codeword.change_ring(F2)</span><br><span class="line">    res = (D.decode(s))</span><br><span class="line">    e = (res-s).<span class="built_in">list</span>()</span><br><span class="line">    </span><br><span class="line">    error_ind = []</span><br><span class="line">    <span class="keyword">for</span> i, ei <span class="keyword">in</span> <span class="built_in">enumerate</span>(e):</span><br><span class="line">        <span class="keyword">if</span>(ei == <span class="number">1</span>):</span><br><span class="line">            error_ind.append(i)</span><br><span class="line">    <span class="keyword">return</span> error_ind</span><br><span class="line">    </span><br><span class="line">error_inds = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    error_ind = My_decode(mat[i], C[i])</span><br><span class="line">    error_inds.append(error_ind)</span><br><span class="line">    <span class="built_in">print</span>(error_ind)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">######################## roll</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">roll</span>(<span class="params">_</span>):</span><br><span class="line">    ind = sample(<span class="built_in">list</span>(<span class="built_in">set</span>(<span class="built_in">range</span>(<span class="number">0</span>, <span class="number">1024</span>)) - <span class="built_in">set</span>(error_ind)), <span class="number">520</span>)</span><br><span class="line">    temp_a = mat[i][<span class="built_in">range</span>(<span class="number">0</span>,<span class="number">512</span>), ind]</span><br><span class="line">    temp_c = Matrix(F, C[i])[[<span class="number">0</span>], ind]</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        s = temp_a.solve_left(temp_c)</span><br><span class="line">        <span class="built_in">print</span>(s.<span class="built_in">list</span>())</span><br><span class="line">        <span class="keyword">return</span> s</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    error_ind = error_inds[i]</span><br><span class="line">    <span class="keyword">with</span> Pool(processes=<span class="number">4</span>) <span class="keyword">as</span> pool:</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> tqdm(pool.imap(roll, <span class="built_in">range</span>(<span class="number">10000</span>)), total=<span class="built_in">int</span>(<span class="number">10000</span>)):</span><br><span class="line">            <span class="keyword">if</span>(_ != <span class="literal">None</span>):</span><br><span class="line">                <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cipher = AES.new(md5(<span class="built_in">str</span>(<span class="built_in">sum</span>(s)).encode()).digest(), AES.MODE_ECB)</span><br><span class="line">enc = <span class="string">&quot;af3010a3de0fa968c38f421f2857d6c60caf9a6ae1023e9d04f253e1d5fb8038fddf26f7cc976fadbb2df12ef549d1fd&quot;</span></span><br><span class="line"><span class="built_in">print</span>(cipher.decrypt(<span class="built_in">bytes</span>.fromhex(enc)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#n1ctf&#123;ISD&amp;LLL_4re_bo7h_v3ry_pow3rfu1_t00ls&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="æ–¹æ³•äºŒ-1"><a href="#æ–¹æ³•äºŒ-1" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h4><p>æœ‰æ„æ€çš„æ˜¯ï¼Œsageçš„randoméšæœºæ•°ä¼¼ä¹ä¹Ÿå¹¶ä¸å®‰å…¨ï¼Œå…¶ä½¿ç”¨çš„éšæœºæ•°ä¸»è¦æ˜¯åŸºäºMTçš„python randomå’ŒåŸºäºgmpçš„c randomã€‚è€Œç©¶ç«Ÿä½¿ç”¨å“ªä¸€ç§ä¼¼ä¹å’Œä»¥ä¸‹ä¸¤è€…éƒ½æœ‰å…³ç³»ï¼š</p>
<ul>
<li>æ˜¯çŸ©é˜µè¿˜æ˜¯å‘é‡</li>
<li>ä½¿ç”¨çš„ç¯æ˜¯ä»€ä¹ˆ</li>
</ul>
<p>è¿™ä¸€éƒ¨åˆ†å¯ä»¥åšå¦‚ä¸‹æµ‹è¯•ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line">SEED = random.randint(<span class="number">0</span>, <span class="number">1337</span>)</span><br><span class="line">N, n, q = <span class="number">1024</span>, <span class="number">60</span>, <span class="number">2</span>**<span class="number">521</span>-<span class="number">1</span></span><br><span class="line">F, Fq = Zmod(<span class="number">256</span>), GF(q)</span><br><span class="line"></span><br><span class="line">set_random_seed(SEED)</span><br><span class="line"><span class="built_in">print</span>(getrandbits(<span class="number">521</span>))</span><br><span class="line"></span><br><span class="line">set_random_seed(SEED)</span><br><span class="line"><span class="built_in">print</span>(random_matrix(Fq, <span class="number">1</span>, <span class="number">1</span>))</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5944058836160505616155866937005287978210040077123457746556810859056754156581041151236899945171255465561118925474653412955903593045941410134996821295584866556</span></span><br><span class="line">[<span class="number">5944058836160505616155866937005287978210040077123457746556810859056754156581041151236899945171255465561118925474653412955903593045941410134996821295584866556</span>]</span><br></pre></td></tr></table></figure>
<p>ä»¥åŠï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">set_random_seed(SEED)</span><br><span class="line"><span class="built_in">print</span>([randrange(<span class="number">0</span>, <span class="number">256</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)])</span><br><span class="line"></span><br><span class="line">set_random_seed(SEED)</span><br><span class="line"><span class="built_in">print</span>(random_vector(F, <span class="number">10</span>))</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">188</span>, <span class="number">170</span>, <span class="number">178</span>, <span class="number">103</span>, <span class="number">61</span>, <span class="number">228</span>, <span class="number">17</span>, <span class="number">94</span>, <span class="number">56</span>, <span class="number">168</span>]</span><br><span class="line">(<span class="number">188</span>, <span class="number">170</span>, <span class="number">178</span>, <span class="number">103</span>, <span class="number">61</span>, <span class="number">228</span>, <span class="number">17</span>, <span class="number">94</span>, <span class="number">56</span>, <span class="number">168</span>)</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸¤ä¸ªæµ‹è¯•è¯´æ˜ï¼Œå¯¹äºé¢˜ç›®ä¸­çš„ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s = [random_vector(F, N//<span class="number">2</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)]</span><br><span class="line"></span><br><span class="line">Î± = random_matrix(Fq, n, N//<span class="number">4</span>)</span><br></pre></td></tr></table></figure>
<p>sageå‡ä½¿ç”¨çš„æ˜¯åŸºäºMT19937çš„pythonçš„randomï¼Œè€Œæˆ‘ä»¬æ‹¥æœ‰$Î±$ï¼Œå¹¶ä¸”æ¯”ç‰¹å®Œå…¨è¶³å¤Ÿï¼Œå› æ­¤å¯ä»¥æ¢å¤$Î±$å‰å¯¹åº”çš„éšæœºæ•°çŠ¶æ€ï¼Œå¹¶ä¸”å¾€å‰å›æ»šå¾—åˆ°$s$å‰çš„éšæœºæ•°çŠ¶æ€ï¼Œç„¶åç›´æ¥é¢„æµ‹$s$å°±å¯ä»¥äº†ã€‚ç”±äºsä½¿ç”¨çš„æ˜¯<code>randrange(0,256)</code>æ‰€ä»¥å¹¶ä¸å¥½é¢„æµ‹ç©¶ç«Ÿéœ€è¦å›æ»šå¤šå°‘ä¸ªçŠ¶æ€ï¼Œæ‰€ä»¥ç®€å•çˆ†ç ´ä¸€ä¸‹çœ‹èƒ½ä¸èƒ½è§£å‡ºflagå°±å¥½äº†ã€‚</p>
<blockquote>
<p>è€Œå¯¹äºï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = random_matrix(F, N//<span class="number">2</span>, N)</span><br></pre></td></tr></table></figure>
<p>ä¼¼ä¹å°±æ²¡æœ‰ä½¿ç”¨pythonçš„random</p>
</blockquote>
<p>expï¼š</p>
<p>1.ç”¨$Î±$çš„å‰60ä¸ªå€¼ï¼Œå’Œæ–¹æ³•ä¸€çš„ç¬¬äºŒæ­¥MTä¸€æ ·æ¢å¤å‡º$Î±$å‰çš„MT stateï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#https://github.com/icemonster/symbolic_mersenne_cracker</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> Random</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> count</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line">logging.basicConfig(<span class="built_in">format</span>=<span class="string">&#x27;STT&gt; %(message)s&#x27;</span>)</span><br><span class="line">logger = logging.getLogger()</span><br><span class="line">logger.setLevel(logging.DEBUG)</span><br><span class="line"></span><br><span class="line">SYMBOLIC_COUNTER = count()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Untwister</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        name = <span class="built_in">next</span>(SYMBOLIC_COUNTER)</span><br><span class="line">        self.MT = [BitVec(<span class="string">f&#x27;MT_<span class="subst">&#123;i&#125;</span>_<span class="subst">&#123;name&#125;</span>&#x27;</span>, <span class="number">32</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>)]</span><br><span class="line">        self.index = <span class="number">0</span></span><br><span class="line">        self.solver = Solver()</span><br><span class="line"></span><br><span class="line">    <span class="comment">#This particular method was adapted from https://www.schutzwerk.com/en/43/posts/attacking_a_random_number_generator/</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">symbolic_untamper</span>(<span class="params">self, solver, y</span>):</span><br><span class="line">        name = <span class="built_in">next</span>(SYMBOLIC_COUNTER)</span><br><span class="line"></span><br><span class="line">        y1 = BitVec(<span class="string">f&#x27;y1_<span class="subst">&#123;name&#125;</span>&#x27;</span>, <span class="number">32</span>)</span><br><span class="line">        y2 = BitVec(<span class="string">f&#x27;y2_<span class="subst">&#123;name&#125;</span>&#x27;</span> , <span class="number">32</span>)</span><br><span class="line">        y3 = BitVec(<span class="string">f&#x27;y3_<span class="subst">&#123;name&#125;</span>&#x27;</span>, <span class="number">32</span>)</span><br><span class="line">        y4 = BitVec(<span class="string">f&#x27;y4_<span class="subst">&#123;name&#125;</span>&#x27;</span>, <span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">        equations = [</span><br><span class="line">            y2 == y1 ^ (LShR(y1, <span class="number">11</span>)),</span><br><span class="line">            y3 == y2 ^ ((y2 &lt;&lt; <span class="number">7</span>) &amp; <span class="number">0x9D2C5680</span>),</span><br><span class="line">            y4 == y3 ^ ((y3 &lt;&lt; <span class="number">15</span>) &amp; <span class="number">0xEFC60000</span>),</span><br><span class="line">            y == y4 ^ (LShR(y4, <span class="number">18</span>))</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">        solver.add(equations)</span><br><span class="line">        <span class="keyword">return</span> y1</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">symbolic_twist</span>(<span class="params">self, MT, n=<span class="number">624</span>, upper_mask=<span class="number">0x80000000</span>, lower_mask=<span class="number">0x7FFFFFFF</span>, a=<span class="number">0x9908B0DF</span>, m=<span class="number">397</span></span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            This method models MT19937 function as a Z3 program</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        MT = [i <span class="keyword">for</span> i <span class="keyword">in</span> MT] <span class="comment">#Just a shallow copy of the state</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            x = (MT[i] &amp; upper_mask) + (MT[(i+<span class="number">1</span>) % n] &amp; lower_mask)</span><br><span class="line">            xA = LShR(x, <span class="number">1</span>)</span><br><span class="line">            xB = If(x &amp; <span class="number">1</span> == <span class="number">0</span>, xA, xA ^ a) <span class="comment">#Possible Z3 optimization here by declaring auxiliary symbolic variables</span></span><br><span class="line">            MT[i] = MT[(i + m) % n] ^ xB</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> MT</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_symbolic</span>(<span class="params">self, guess</span>):</span><br><span class="line">        name = <span class="built_in">next</span>(SYMBOLIC_COUNTER)</span><br><span class="line">        ERROR = <span class="string">&#x27;Must pass a string like &quot;?1100???1001000??0?100?10??10010&quot; where ? represents an unknown bit&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">type</span>(guess) == <span class="built_in">str</span>, ERROR</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">all</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x: x <span class="keyword">in</span> <span class="string">&#x27;01?&#x27;</span>, guess)), ERROR</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(guess) &lt;= <span class="number">32</span>, <span class="string">&quot;One 32-bit number at a time please&quot;</span></span><br><span class="line">        guess = guess.zfill(<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">        self.symbolic_guess = BitVec(<span class="string">f&#x27;symbolic_guess_<span class="subst">&#123;name&#125;</span>&#x27;</span>, <span class="number">32</span>)</span><br><span class="line">        guess = guess[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i, bit <span class="keyword">in</span> <span class="built_in">enumerate</span>(guess):</span><br><span class="line">            <span class="keyword">if</span> bit != <span class="string">&#x27;?&#x27;</span>:</span><br><span class="line">                self.solver.add(Extract(i, i, self.symbolic_guess) == bit)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self.symbolic_guess</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">submit</span>(<span class="params">self, guess</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            You need 624 numbers to completely clone the state.</span></span><br><span class="line"><span class="string">                You can input less than that though and this will give you the best guess for the state</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self.index &gt;= <span class="number">624</span>:</span><br><span class="line">            name = <span class="built_in">next</span>(SYMBOLIC_COUNTER)</span><br><span class="line">            next_mt = self.symbolic_twist(self.MT)</span><br><span class="line">            self.MT = [BitVec(<span class="string">f&#x27;MT_<span class="subst">&#123;i&#125;</span>_<span class="subst">&#123;name&#125;</span>&#x27;</span>, <span class="number">32</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>)]</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">                self.solver.add(self.MT[i] == next_mt[i])</span><br><span class="line">            self.index = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        symbolic_guess = self.get_symbolic(guess)</span><br><span class="line">        symbolic_guess = self.symbolic_untamper(self.solver, symbolic_guess)</span><br><span class="line">        self.solver.add(self.MT[self.index] == symbolic_guess)</span><br><span class="line">        self.index += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_random</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            This will give you a random.Random() instance with the cloned state.</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        logger.debug(<span class="string">&#x27;Solving...&#x27;</span>)</span><br><span class="line">        start = time()</span><br><span class="line">        self.solver.check()</span><br><span class="line">        model = self.solver.model()</span><br><span class="line">        end = time()</span><br><span class="line">        logger.debug(<span class="string">f&#x27;Solved! (in <span class="subst">&#123;<span class="built_in">round</span>(end-start,<span class="number">3</span>)&#125;</span>s)&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment">#Compute best guess for state</span></span><br><span class="line">        state = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x: model[x].as_long(), self.MT))</span><br><span class="line">        result_state = (<span class="number">3</span>, <span class="built_in">tuple</span>(state+[self.index]), <span class="literal">None</span>)</span><br><span class="line">        r = Random()</span><br><span class="line">        r.setstate(result_state)</span><br><span class="line">        <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>():</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        This test tries to clone Python random&#x27;s internal state, given partial output from getrandbits</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    output = [<span class="number">2052989026187628018505090216721349257452581944142415044520527283300574439605232693924109130927700026879802796798323130703768462662264638677972389236566564575</span>, <span class="number">5225453256971737388486294931922039723340310407624514585062950191132550635768693727698459978225483485890925297979009284845547716345384959943882275816157687522</span>, <span class="number">6384003021200443422209284938066284944669598755830743086665589025405179546034869584039261565027186461914605565757632351322204847925981744856258211161068962322</span>, <span class="number">1749535151849566187562576405003328739241590589609203380130002844778384115925449614939660420719072392543285487823449085629595737479050295300740318775147141579</span>, <span class="number">5028025320872348362619664669575352799437383176221191236696571007384660009171202139415054134818787096610593718145741391462358687204496779816506856719141822655</span>, <span class="number">496105389179110910629571770916587634389042066650650257984425579874269918093468333674503357907872779356736656387751255169742066622514477356752574103752131907</span>, <span class="number">3436855010723926113914942417231300525946855375567023250635707341579460565380653848367023918454841973305084860125309974180861555605508772341646716195399365641</span>, <span class="number">6126584195256719540568595688171701520258384637422147995403164340188577964266020306172506706376147755631534578364425038386201967414344847686467113226605035647</span>, <span class="number">980463459392690589018511996961588727033831901561920491880496428802031123124266300366385644958771021910396372842006537733114158691781047162064456565268039423</span>, <span class="number">3652411206440878868321893768049493042384908161622024948617835677764964851294519032229584748784200434359115515336005141988750075009657556840833146078021874926</span>, <span class="number">2174879036711363551252583514620689099374871765443068829351645435692473845036078497382453747762822086149466006744940455868715607363213427160625441871341462395</span>, <span class="number">5057161665517951196188775375262157617415164154804898875881631910813336506375890993210100033195636519929285472203830569798770975843515247529830732301265811610</span>, <span class="number">3306354345456324305074016662906845877163348338433268040446425605369588703300245563982934380844167018438270650903252227989642100951223267144417336415457798793</span>, <span class="number">2395295827790551011206890233834169858780101019556800625387218301201488293147130548238081822267669177571367238053707203742360784411688050311559279681980986543</span>, <span class="number">3006440442470261829769737273401992023902498352130211793681154933115235093996373416329694168374953860876342908337466572761808496026203125027138992629106731845</span>, <span class="number">1153335005948746880307780666251566051703622919983097397853073421335999214278284948151883340746104177260976555660395124646968377361398057860351000455659172753</span>, <span class="number">1713042247455350230980953003394073696438285832334658730294685528889059080601549339420898350208749049716932962821610503236722535443046716897749780581289914827</span>, <span class="number">6754872611146772982321539683086146839023334463431896549539154850577425062259371535865000216871632400150813401709488403962840438930093822109433522248076335453</span>, <span class="number">6287767710864953400162108162359797621683058548057219086424193941013508335646817903498303763266852729734701262490912770181115559489358156868483173973970896500</span>, <span class="number">277222994371822706011862250140774279279717760500323019954692225078469794747203189591101712531432953672193933736201841583286416558354027298499084319294266412</span>, <span class="number">3417483291875129256979825075566667645256166558484633170457014974679182788714367016926202779878176844493099202145254197167929477242077894628242444310915435398</span>, <span class="number">1085574083993420275607687913329013813184696072773453652882238989708601326302312337097542482875606073431406521335570070881523196767102663840651591897065521451</span>, <span class="number">5824524783001727209410550431451051249153129904450694782169510505422548986765068364258945827721962400963712050419134221789012348504943171015015286195863741990</span>, <span class="number">6601704560909354252211567773611704159084174986033676854122473607988733744133599808617417824367662776815562925495656657077610026802238706624802394508354382148</span>, <span class="number">1778728784912759795362720287833831788990118630684781280373253516908530206654109738328107440719393589661937340024693100223247040455793889248357242927688249892</span>, <span class="number">6416915812588224445664782904627808566308128227543703756173589465941343171343329178775719353076596703967239413984077128263762103257171686055811444891645058825</span>, <span class="number">5739610032587855032938141208882547321527220335919128940513766189887752273496886645979114098327083944538653971085936369596331580269970350655792421403911218655</span>, <span class="number">2063855308502428822052864418394676238099820881407216754278816888071173792037207936694253120891457529764314756926486324995043087252687982036705198813378915664</span>, <span class="number">3477014337875015781602614555329709730077743902336655810403582109365871797674415343416290352708164743041148302507372623483914816177500922432388906061331010874</span>, <span class="number">6482753687608143462975264728796511686801896699218076243699494447233075903361449747866927251714679260824592213324644920916464697213325172580450392013468313625</span>, <span class="number">1144732121561114538620960110896213703757595862303960780609679192419827034553160301395118859233329298864065526742315395530587230061978407308761087510969098409</span>, <span class="number">2663369250614584903359257073704180061042944465829120277084658626435685666314449604497330552008479082289591533430241478785954240332982496438448662087272856305</span>, <span class="number">1625503401877123118064587116015097162029645572178122120001601243566285131349626207724577697865342288922037055759546997159838046372090429869044438362780094305</span>, <span class="number">680862130832745355482990226054726660700744091327381718588096814032920534644088306118028565030883946615364836537820384219127268869142235593745558070963246041</span>, <span class="number">4014882414151152288278066287017219459517759804864469524435736300373136293076080399716126093409172228322667138734528238551437409733979711331332729319865312380</span>, <span class="number">4704422950875530532314436497542324322568368963516120007597805770848514388576922162359189592976527098266409570948396449912366815182032739123169830920718240305</span>, <span class="number">690164231059595242495550826244944222832161585294669271266123700025314593488116364307091231217508692332713273666595763460533614284962864262311953014474100379</span>, <span class="number">6785829762856450361030167999327180879044601158002269665141528541227641113240929279463596507125747748828112084379276365843303538716230262095861080100351754036</span>, <span class="number">6779411395854639364180412834268053789798254161508878815420901542082669783279757284379191439433216856901462566105364399347339857409897364054612473287336684229</span>, <span class="number">5200486327896911752627279013153346424456647268087509562785746212643962947789386193923551262593722145785625094327307036507781725614475280984248955406218315718</span>, <span class="number">6766018115505863233496488437504459564113553032701552228566296851598728108852369292454441019867167767198684677471103842991965444612399832466426762140833990202</span>, <span class="number">1857754167234108369058884687356671100191937657538963073611935069599963008145512071283477417736344612203774963433585165206676941234180263371794308454523989258</span>, <span class="number">6218380854447481926832586680866881879231599650578367203954021608556581539882097533150164512127332627836132629103311365902275901798241841875282176216854372386</span>, <span class="number">4484250341955282540982557066029960403557526151445828782762206036414084714109807995562348007095479519319978490833884948660962896859419673330915736283143119293</span>, <span class="number">5719518665799717540922616548756376704294224287680684753299589462494633283400267383560646499107229160421788984246235644208190094197129677382137279191626345567</span>, <span class="number">6183544838511811934598450247658473506717449889422546720457877419017221164143542485286136887936019942488983081115288675646150516467627345851970793260108794248</span>, <span class="number">4060259625864440523893329913437385815330396229854633674900837462639601270822525680439043588461389374062208192344001519699398183502957051281689538918582785802</span>, <span class="number">4674255678026139884783381633770087579505974819398209649510660042794673596753605680540279361204472325548871131655347722123765127705717766800550489928590118583</span>, <span class="number">4235305174354877875880908721407722693409603927061930442201385805259206491962626609891620509618680662074877029489958861063726108784357485910285094561525579418</span>, <span class="number">1304482879046737936250592217446487940668006269296100323856207643321946575384121112118644269963713452266947486055748791840597314419623478449556227943272046751</span>, <span class="number">5723133662393454897727214372311054844979375357613580104308566445799906123427550619290628869605832625649167487752674788026571792245384816910716687617609324597</span>, <span class="number">6690869337372358677787805305676510474430932152287453356690736391174276385319926576449243708302298262160338357175238351080196044336828436713453500956276986912</span>, <span class="number">1709148516176100595454198345227647770776132068617957305207797613284696740095278846956146899436846161083141396382322084258921974790018204061260478170839382429</span>, <span class="number">4596839062486185169691326142435396173701999982790472119509678270254374603237887252036067253657432053010005919035531672204949754186386950770753054022640122023</span>, <span class="number">4284033026192974690107958342383445955597787488718148718914401336986762283353122956474851504895403044034780250657199691622138838949395491585859922179871223880</span>, <span class="number">4407596618033695273966500201194728131045986855339262025197711076433716644886501682901785057973164763471419390429811949642266673464590420468022335170603532947</span>, <span class="number">1245174090116826165252009130854025626244787263188227463552747207763429695036678627645359427139881800183870064022547165863193854107493333053578705645112218474</span>, <span class="number">5252075015773147287797948406007229837831033114960436353240449428563534907880527872801125844353143910297718695315389930603134648587470649842791016137936418152</span>, <span class="number">5985509734129310460156410707722925029030939626269875091364071549162048868371903545512866235224306730924941031773042663444889701280634369335066845011589227199</span>, <span class="number">3080785963946069150817641927843563289944890563483038488395920525403208821802200181379991729951535386499548811296451709870981902091035283243521924070732157750</span>]</span><br><span class="line"></span><br><span class="line">    ut = Untwister()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">60</span>):</span><br><span class="line">        random_num = output[i]</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">521</span> // <span class="number">32</span>):</span><br><span class="line">            temp = random_num % <span class="number">2</span>**<span class="number">32</span></span><br><span class="line">            <span class="comment">#Just send stuff like &quot;?11????0011?0110??01110????01???&quot;</span></span><br><span class="line">                <span class="comment">#Where ? represents unknown bits</span></span><br><span class="line">            ut.submit(<span class="built_in">bin</span>(temp)[<span class="number">2</span>:])</span><br><span class="line">            random_num //= <span class="number">2</span>**<span class="number">32</span></span><br><span class="line">        ut.submit(<span class="built_in">bin</span>(random_num)[<span class="number">2</span>:].zfill(<span class="number">9</span>) + <span class="string">&#x27;?&#x27;</span>*(<span class="number">32</span>-<span class="number">9</span>))</span><br><span class="line"></span><br><span class="line">    r2 = ut.get_random()</span><br><span class="line">    <span class="built_in">print</span>(r2.getstate())</span><br><span class="line"></span><br><span class="line">    logger.debug(<span class="string">&#x27;Test passed!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">test()</span><br><span class="line"></span><br><span class="line"><span class="comment">#(3, (2695351630, 1922033548, 3434285234, 1544004455, 1971679449, 2774743117, 3568751734, 1170380852, 1379196785, 1939082526, 2609756861, 3442274255, 1514280443, 2328412430, 2930371449, 2709335402, 3045974100, 1095250868, 29188524, 1282079643, 1748476443, 1066105964, 2733262304, 3401683597, 3103068408, 756269773, 329534395, 3919968778, 1340762899, 2811215679, 2496174671, 282861806, 2709945287, 2257145940, 2513147842, 3017095841, 1525533007, 3901083136, 881396069, 4101418280, 3117510379, 664979225, 1184559110, 557650144, 2550739260, 2838292721, 3627246855, 2589687440, 1495367117, 2576251097, 499262401, 4179172825, 2367686693, 2360776332, 209458381, 4147883114, 3396842125, 3786537214, 487568147, 2695851970, 2907500362, 975567326, 2458576665, 890584127, 577880192, 1993936114, 3156920383, 3315678592, 3061729594, 1162861667, 145048345, 4018945859, 3007415521, 3918838031, 3720821775, 3987846803, 811460519, 3161180265, 625437996, 477986559, 1555396672, 2133352784, 1747342437, 3666573972, 1365391887, 3102897853, 3250112758, 538062034, 2511466698, 622265354, 2871802720, 2845479676, 375152243, 3169670953, 191187436, 2991608187, 1385066376, 460368470, 2402581268, 952887140, 700309987, 381635554, 4063255635, 1021828086, 585091460, 4109272880, 1454999395, 4148434546, 2767540010, 2660853287, 3788075980, 2555726211, 3245823338, 3683005854, 958913863, 2713105594, 4196842608, 1465195517, 2635158305, 1420506679, 334853929, 3122754632, 2077259078, 2419490021, 3713338924, 133052797, 806303692, 1417535111, 1840829159, 145342917, 1480485299, 2798325123, 805412851, 1864526757, 880431652, 1105737777, 2536413707, 3080713391, 386924434, 3862566445, 2474880484, 4267123879, 389996517, 663377419, 1833262401, 3348724287, 3163891885, 524987442, 148925713, 2199399462, 3023817677, 3591368111, 2073886928, 1701801386, 2462126806, 2846628474, 2006935973, 1226649139, 3942930853, 3591196289, 829918901, 2161011364, 3496545202, 4123615426, 38981881, 3976538818, 2966074173, 382108347, 1609211023, 731344784, 615384328, 3571633366, 3739560838, 311792144, 357755121, 398715352, 395325949, 3224565755, 1144699515, 1234027576, 2541458991, 1936013031, 2544749596, 1053917138, 3829274346, 3601012612, 2608608732, 3590342851, 1673805541, 307531817, 2128493756, 3972876403, 1119289067, 434260810, 3431723586, 3389990349, 1964588337, 3714264779, 3583745038, 2225177744, 1652794835, 3717726474, 3748734579, 4214809352, 2967377755, 3781580863, 2316674100, 3501596442, 1968584574, 4149533253, 287041241, 1825446649, 3375573761, 2290055766, 4019478620, 4240249413, 366837734, 4247442960, 3883261001, 1657732020, 2860896929, 2756884805, 2128518208, 3160326168, 1637043802, 2415236233, 3619732061, 1700240223, 1790264898, 2779684519, 46960106, 1399559342, 1025546687, 97943525, 4049004778, 2608551088, 345857, 1090754829, 2612513527, 940959874, 2550801041, 2356638469, 3282897446, 4058560059, 3662430984, 1080626705, 82219622, 601861194, 3443334643, 3907276605, 2130019402, 3704586187, 3545234472, 796974359, 1479422678, 4261725354, 1446892727, 3762923341, 443374502, 4017158958, 3657999925, 3064838547, 200910956, 2943067376, 1102158119, 493064078, 1916229505, 3648028538, 4112706839, 31003100, 2240639338, 3553806242, 3993988596, 973881269, 3371788669, 154325011, 4246683748, 1680749770, 2940357623, 3342155435, 1857799688, 3102929857, 2180772957, 2457056253, 1565671423, 752356380, 491419859, 161553999, 3104702045, 316450207, 1727941732, 1727384240, 4021066939, 1326662785, 378855826, 1687197186, 4094819706, 1979724537, 167949249, 1194605310, 1857749288, 1352722956, 3940093956, 1911958716, 1579356568, 3710855087, 2321004874, 3522796444, 1742617775, 2409299307, 1532201350, 2479894877, 3006495102, 2997713743, 2329795244, 2245290913, 3825156457, 4081201570, 3589106763, 1965152372, 2605880159, 2879378407, 2702002615, 2840755118, 2149936893, 1093503770, 116365721, 1787229610, 2750488345, 2565698802, 2145430013, 4294584394, 204085151, 2174636229, 3140251174, 2698991393, 1282497103, 3234172194, 3005695031, 1703056711, 4201744590, 2432616404, 2395214101, 1368140699, 3834324503, 527998606, 619354998, 1499560365, 3118597689, 1132038758, 1140985482, 1465112585, 2663864350, 3804111686, 3821903933, 2060217054, 623765990, 2695673791, 2894717969, 2854359345, 1490209382, 1480221386, 2661140567, 2800104837, 3829991940, 2119283425, 3780763340, 1972124184, 750187038, 2166699281, 1733185634, 853630604, 3138298595, 1146150252, 3889993817, 831667601, 3469180435, 1822031579, 1635272530, 2108618632, 2385640880, 4011742384, 2811145464, 1025710081, 4168474162, 1667481551, 1928764243, 3205524955, 3088609896, 103133477, 2111904259, 968563202, 3026287000, 3890106396, 1161986845, 1405689645, 2811250603, 4143581466, 1019916766, 2700566049, 3746584683, 3605347392, 819182452, 3581693404, 3037287253, 1436448777, 3397905833, 2816662728, 923624196, 4086396771, 168910861, 3269200513, 2416914148, 3536145407, 71109343, 3307423015, 4212940886, 260844613, 2618967116, 2257891982, 2661096380, 1942630262, 61352998, 2810323365, 3418782676, 1387676775, 3501234354, 4085894422, 2012613408, 2387049773, 753189678, 2894357270, 456730381, 3104330676, 3061793182, 776353181, 4016986299, 2774792199, 3466903569, 3304601777, 4294685334, 1561660819, 3038024764, 1817514750, 3768248971, 1812666977, 4206697533, 2662688175, 1229262173, 2972369904, 4138621734, 1015377946, 2651562555, 268255977, 3252122337, 1621021176, 2994730872, 559931834, 3988579176, 3567691983, 1930674231, 2218383326, 758788884, 910208449, 227817632, 2140599685, 3548929815, 2587591999, 3580039418, 1872428683, 701406125, 4288602909, 1109645047, 1397038574, 2576598599, 586000901, 2693205802, 152821105, 2557672927, 2165199135, 1482476870, 1144667446, 3796957272, 182521958, 3425668252, 1367303991, 1303438183, 3798174016, 3822328448, 2174253407, 368330786, 123594742, 1208148383, 1769908846, 3062152568, 1874539716, 4098588639, 1184714779, 2489698445, 3909685808, 1928812454, 3605420887, 4111625005, 3601167612, 2365741840, 1767141708, 572895792, 2249632076, 4291418450, 603542283, 2506946516, 3132493203, 235891852, 2035908962, 2962949323, 756732284, 1229852751, 163244976, 4117722390, 2204154201, 2211522886, 1137023330, 694949872, 16637714, 167503308, 3680251840, 2097279770, 3496392499, 3178068824, 3118729426, 3137404850, 3646384420, 3444927241, 2182874045, 415700967, 4278153892, 3578893031, 415285993, 1910390682, 443081739, 4009368874, 3216674839, 2732429792, 1801899246, 884417585, 2683393468, 2168835935, 567679007, 2675310920, 3244164342, 948786909, 4049866703, 3763778347, 3994212229, 937179772, 682416950, 4237120584, 1314748325, 1011893987, 594451978, 2591572861, 3321773081, 1782732845, 1906672771, 3198375563, 2677553481, 2524341084, 3834072067, 1843752429, 2535045290, 3159920919, 3333512770, 2901497143, 255992028, 1329320485, 2705147800, 1648509016, 3063622090, 2994198416, 2054303692, 3202051646, 3658720183, 412326269, 1481252325, 2852045384, 253106637, 3226081928, 4263121751, 541226047, 2226732784, 938020060, 1949217059, 3270150900, 548921532, 2822626483, 3199026017, 3417519239, 3658562304, 2840731352, 3326593139, 60562367, 2609616202, 1639463440, 2922591920, 2626459952, 3751875818, 3985074014, 2918717822, 3453007911, 2602897826, 2633193513, 592359758, 2145325100, 1967291896, 392327774, 606203046, 2265885037, 3053206123, 3875079316, 2579332720, 1131140826, 247340200, 497676100, 3083051276, 396), None)</span></span><br></pre></td></tr></table></figure>
<p>2.å¾€å‰å›æ»šï¼Œå¹¶é€ä¸ªæµ‹è¯•sè¿›è¡Œè§£å¯†ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">N, n, q = <span class="number">1024</span>, <span class="number">60</span>, <span class="number">2</span>**<span class="number">521</span>-<span class="number">1</span></span><br><span class="line">F, F2, Fq = Zmod(<span class="number">256</span>), Zmod(<span class="number">2</span>), GF(q)</span><br><span class="line"></span><br><span class="line">states = [<span class="number">2695351630</span>, <span class="number">1922033548</span>, <span class="number">3434285234</span>, <span class="number">1544004455</span>, <span class="number">1971679449</span>, <span class="number">2774743117</span>, <span class="number">3568751734</span>, <span class="number">1170380852</span>, <span class="number">1379196785</span>, <span class="number">1939082526</span>, <span class="number">2609756861</span>, <span class="number">3442274255</span>, <span class="number">1514280443</span>, <span class="number">2328412430</span>, <span class="number">2930371449</span>, <span class="number">2709335402</span>, <span class="number">3045974100</span>, <span class="number">1095250868</span>, <span class="number">29188524</span>, <span class="number">1282079643</span>, <span class="number">1748476443</span>, <span class="number">1066105964</span>, <span class="number">2733262304</span>, <span class="number">3401683597</span>, <span class="number">3103068408</span>, <span class="number">756269773</span>, <span class="number">329534395</span>, <span class="number">3919968778</span>, <span class="number">1340762899</span>, <span class="number">2811215679</span>, <span class="number">2496174671</span>, <span class="number">282861806</span>, <span class="number">2709945287</span>, <span class="number">2257145940</span>, <span class="number">2513147842</span>, <span class="number">3017095841</span>, <span class="number">1525533007</span>, <span class="number">3901083136</span>, <span class="number">881396069</span>, <span class="number">4101418280</span>, <span class="number">3117510379</span>, <span class="number">664979225</span>, <span class="number">1184559110</span>, <span class="number">557650144</span>, <span class="number">2550739260</span>, <span class="number">2838292721</span>, <span class="number">3627246855</span>, <span class="number">2589687440</span>, <span class="number">1495367117</span>, <span class="number">2576251097</span>, <span class="number">499262401</span>, <span class="number">4179172825</span>, <span class="number">2367686693</span>, <span class="number">2360776332</span>, <span class="number">209458381</span>, <span class="number">4147883114</span>, <span class="number">3396842125</span>, <span class="number">3786537214</span>, <span class="number">487568147</span>, <span class="number">2695851970</span>, <span class="number">2907500362</span>, <span class="number">975567326</span>, <span class="number">2458576665</span>, <span class="number">890584127</span>, <span class="number">577880192</span>, <span class="number">1993936114</span>, <span class="number">3156920383</span>, <span class="number">3315678592</span>, <span class="number">3061729594</span>, <span class="number">1162861667</span>, <span class="number">145048345</span>, <span class="number">4018945859</span>, <span class="number">3007415521</span>, <span class="number">3918838031</span>, <span class="number">3720821775</span>, <span class="number">3987846803</span>, <span class="number">811460519</span>, <span class="number">3161180265</span>, <span class="number">625437996</span>, <span class="number">477986559</span>, <span class="number">1555396672</span>, <span class="number">2133352784</span>, <span class="number">1747342437</span>, <span class="number">3666573972</span>, <span class="number">1365391887</span>, <span class="number">3102897853</span>, <span class="number">3250112758</span>, <span class="number">538062034</span>, <span class="number">2511466698</span>, <span class="number">622265354</span>, <span class="number">2871802720</span>, <span class="number">2845479676</span>, <span class="number">375152243</span>, <span class="number">3169670953</span>, <span class="number">191187436</span>, <span class="number">2991608187</span>, <span class="number">1385066376</span>, <span class="number">460368470</span>, <span class="number">2402581268</span>, <span class="number">952887140</span>, <span class="number">700309987</span>, <span class="number">381635554</span>, <span class="number">4063255635</span>, <span class="number">1021828086</span>, <span class="number">585091460</span>, <span class="number">4109272880</span>, <span class="number">1454999395</span>, <span class="number">4148434546</span>, <span class="number">2767540010</span>, <span class="number">2660853287</span>, <span class="number">3788075980</span>, <span class="number">2555726211</span>, <span class="number">3245823338</span>, <span class="number">3683005854</span>, <span class="number">958913863</span>, <span class="number">2713105594</span>, <span class="number">4196842608</span>, <span class="number">1465195517</span>, <span class="number">2635158305</span>, <span class="number">1420506679</span>, <span class="number">334853929</span>, <span class="number">3122754632</span>, <span class="number">2077259078</span>, <span class="number">2419490021</span>, <span class="number">3713338924</span>, <span class="number">133052797</span>, <span class="number">806303692</span>, <span class="number">1417535111</span>, <span class="number">1840829159</span>, <span class="number">145342917</span>, <span class="number">1480485299</span>, <span class="number">2798325123</span>, <span class="number">805412851</span>, <span class="number">1864526757</span>, <span class="number">880431652</span>, <span class="number">1105737777</span>, <span class="number">2536413707</span>, <span class="number">3080713391</span>, <span class="number">386924434</span>, <span class="number">3862566445</span>, <span class="number">2474880484</span>, <span class="number">4267123879</span>, <span class="number">389996517</span>, <span class="number">663377419</span>, <span class="number">1833262401</span>, <span class="number">3348724287</span>, <span class="number">3163891885</span>, <span class="number">524987442</span>, <span class="number">148925713</span>, <span class="number">2199399462</span>, <span class="number">3023817677</span>, <span class="number">3591368111</span>, <span class="number">2073886928</span>, <span class="number">1701801386</span>, <span class="number">2462126806</span>, <span class="number">2846628474</span>, <span class="number">2006935973</span>, <span class="number">1226649139</span>, <span class="number">3942930853</span>, <span class="number">3591196289</span>, <span class="number">829918901</span>, <span class="number">2161011364</span>, <span class="number">3496545202</span>, <span class="number">4123615426</span>, <span class="number">38981881</span>, <span class="number">3976538818</span>, <span class="number">2966074173</span>, <span class="number">382108347</span>, <span class="number">1609211023</span>, <span class="number">731344784</span>, <span class="number">615384328</span>, <span class="number">3571633366</span>, <span class="number">3739560838</span>, <span class="number">311792144</span>, <span class="number">357755121</span>, <span class="number">398715352</span>, <span class="number">395325949</span>, <span class="number">3224565755</span>, <span class="number">1144699515</span>, <span class="number">1234027576</span>, <span class="number">2541458991</span>, <span class="number">1936013031</span>, <span class="number">2544749596</span>, <span class="number">1053917138</span>, <span class="number">3829274346</span>, <span class="number">3601012612</span>, <span class="number">2608608732</span>, <span class="number">3590342851</span>, <span class="number">1673805541</span>, <span class="number">307531817</span>, <span class="number">2128493756</span>, <span class="number">3972876403</span>, <span class="number">1119289067</span>, <span class="number">434260810</span>, <span class="number">3431723586</span>, <span class="number">3389990349</span>, <span class="number">1964588337</span>, <span class="number">3714264779</span>, <span class="number">3583745038</span>, <span class="number">2225177744</span>, <span class="number">1652794835</span>, <span class="number">3717726474</span>, <span class="number">3748734579</span>, <span class="number">4214809352</span>, <span class="number">2967377755</span>, <span class="number">3781580863</span>, <span class="number">2316674100</span>, <span class="number">3501596442</span>, <span class="number">1968584574</span>, <span class="number">4149533253</span>, <span class="number">287041241</span>, <span class="number">1825446649</span>, <span class="number">3375573761</span>, <span class="number">2290055766</span>, <span class="number">4019478620</span>, <span class="number">4240249413</span>, <span class="number">366837734</span>, <span class="number">4247442960</span>, <span class="number">3883261001</span>, <span class="number">1657732020</span>, <span class="number">2860896929</span>, <span class="number">2756884805</span>, <span class="number">2128518208</span>, <span class="number">3160326168</span>, <span class="number">1637043802</span>, <span class="number">2415236233</span>, <span class="number">3619732061</span>, <span class="number">1700240223</span>, <span class="number">1790264898</span>, <span class="number">2779684519</span>, <span class="number">46960106</span>, <span class="number">1399559342</span>, <span class="number">1025546687</span>, <span class="number">97943525</span>, <span class="number">4049004778</span>, <span class="number">2608551088</span>, <span class="number">345857</span>, <span class="number">1090754829</span>, <span class="number">2612513527</span>, <span class="number">940959874</span>, <span class="number">2550801041</span>, <span class="number">2356638469</span>, <span class="number">3282897446</span>, <span class="number">4058560059</span>, <span class="number">3662430984</span>, <span class="number">1080626705</span>, <span class="number">82219622</span>, <span class="number">601861194</span>, <span class="number">3443334643</span>, <span class="number">3907276605</span>, <span class="number">2130019402</span>, <span class="number">3704586187</span>, <span class="number">3545234472</span>, <span class="number">796974359</span>, <span class="number">1479422678</span>, <span class="number">4261725354</span>, <span class="number">1446892727</span>, <span class="number">3762923341</span>, <span class="number">443374502</span>, <span class="number">4017158958</span>, <span class="number">3657999925</span>, <span class="number">3064838547</span>, <span class="number">200910956</span>, <span class="number">2943067376</span>, <span class="number">1102158119</span>, <span class="number">493064078</span>, <span class="number">1916229505</span>, <span class="number">3648028538</span>, <span class="number">4112706839</span>, <span class="number">31003100</span>, <span class="number">2240639338</span>, <span class="number">3553806242</span>, <span class="number">3993988596</span>, <span class="number">973881269</span>, <span class="number">3371788669</span>, <span class="number">154325011</span>, <span class="number">4246683748</span>, <span class="number">1680749770</span>, <span class="number">2940357623</span>, <span class="number">3342155435</span>, <span class="number">1857799688</span>, <span class="number">3102929857</span>, <span class="number">2180772957</span>, <span class="number">2457056253</span>, <span class="number">1565671423</span>, <span class="number">752356380</span>, <span class="number">491419859</span>, <span class="number">161553999</span>, <span class="number">3104702045</span>, <span class="number">316450207</span>, <span class="number">1727941732</span>, <span class="number">1727384240</span>, <span class="number">4021066939</span>, <span class="number">1326662785</span>, <span class="number">378855826</span>, <span class="number">1687197186</span>, <span class="number">4094819706</span>, <span class="number">1979724537</span>, <span class="number">167949249</span>, <span class="number">1194605310</span>, <span class="number">1857749288</span>, <span class="number">1352722956</span>, <span class="number">3940093956</span>, <span class="number">1911958716</span>, <span class="number">1579356568</span>, <span class="number">3710855087</span>, <span class="number">2321004874</span>, <span class="number">3522796444</span>, <span class="number">1742617775</span>, <span class="number">2409299307</span>, <span class="number">1532201350</span>, <span class="number">2479894877</span>, <span class="number">3006495102</span>, <span class="number">2997713743</span>, <span class="number">2329795244</span>, <span class="number">2245290913</span>, <span class="number">3825156457</span>, <span class="number">4081201570</span>, <span class="number">3589106763</span>, <span class="number">1965152372</span>, <span class="number">2605880159</span>, <span class="number">2879378407</span>, <span class="number">2702002615</span>, <span class="number">2840755118</span>, <span class="number">2149936893</span>, <span class="number">1093503770</span>, <span class="number">116365721</span>, <span class="number">1787229610</span>, <span class="number">2750488345</span>, <span class="number">2565698802</span>, <span class="number">2145430013</span>, <span class="number">4294584394</span>, <span class="number">204085151</span>, <span class="number">2174636229</span>, <span class="number">3140251174</span>, <span class="number">2698991393</span>, <span class="number">1282497103</span>, <span class="number">3234172194</span>, <span class="number">3005695031</span>, <span class="number">1703056711</span>, <span class="number">4201744590</span>, <span class="number">2432616404</span>, <span class="number">2395214101</span>, <span class="number">1368140699</span>, <span class="number">3834324503</span>, <span class="number">527998606</span>, <span class="number">619354998</span>, <span class="number">1499560365</span>, <span class="number">3118597689</span>, <span class="number">1132038758</span>, <span class="number">1140985482</span>, <span class="number">1465112585</span>, <span class="number">2663864350</span>, <span class="number">3804111686</span>, <span class="number">3821903933</span>, <span class="number">2060217054</span>, <span class="number">623765990</span>, <span class="number">2695673791</span>, <span class="number">2894717969</span>, <span class="number">2854359345</span>, <span class="number">1490209382</span>, <span class="number">1480221386</span>, <span class="number">2661140567</span>, <span class="number">2800104837</span>, <span class="number">3829991940</span>, <span class="number">2119283425</span>, <span class="number">3780763340</span>, <span class="number">1972124184</span>, <span class="number">750187038</span>, <span class="number">2166699281</span>, <span class="number">1733185634</span>, <span class="number">853630604</span>, <span class="number">3138298595</span>, <span class="number">1146150252</span>, <span class="number">3889993817</span>, <span class="number">831667601</span>, <span class="number">3469180435</span>, <span class="number">1822031579</span>, <span class="number">1635272530</span>, <span class="number">2108618632</span>, <span class="number">2385640880</span>, <span class="number">4011742384</span>, <span class="number">2811145464</span>, <span class="number">1025710081</span>, <span class="number">4168474162</span>, <span class="number">1667481551</span>, <span class="number">1928764243</span>, <span class="number">3205524955</span>, <span class="number">3088609896</span>, <span class="number">103133477</span>, <span class="number">2111904259</span>, <span class="number">968563202</span>, <span class="number">3026287000</span>, <span class="number">3890106396</span>, <span class="number">1161986845</span>, <span class="number">1405689645</span>, <span class="number">2811250603</span>, <span class="number">4143581466</span>, <span class="number">1019916766</span>, <span class="number">2700566049</span>, <span class="number">3746584683</span>, <span class="number">3605347392</span>, <span class="number">819182452</span>, <span class="number">3581693404</span>, <span class="number">3037287253</span>, <span class="number">1436448777</span>, <span class="number">3397905833</span>, <span class="number">2816662728</span>, <span class="number">923624196</span>, <span class="number">4086396771</span>, <span class="number">168910861</span>, <span class="number">3269200513</span>, <span class="number">2416914148</span>, <span class="number">3536145407</span>, <span class="number">71109343</span>, <span class="number">3307423015</span>, <span class="number">4212940886</span>, <span class="number">260844613</span>, <span class="number">2618967116</span>, <span class="number">2257891982</span>, <span class="number">2661096380</span>, <span class="number">1942630262</span>, <span class="number">61352998</span>, <span class="number">2810323365</span>, <span class="number">3418782676</span>, <span class="number">1387676775</span>, <span class="number">3501234354</span>, <span class="number">4085894422</span>, <span class="number">2012613408</span>, <span class="number">2387049773</span>, <span class="number">753189678</span>, <span class="number">2894357270</span>, <span class="number">456730381</span>, <span class="number">3104330676</span>, <span class="number">3061793182</span>, <span class="number">776353181</span>, <span class="number">4016986299</span>, <span class="number">2774792199</span>, <span class="number">3466903569</span>, <span class="number">3304601777</span>, <span class="number">4294685334</span>, <span class="number">1561660819</span>, <span class="number">3038024764</span>, <span class="number">1817514750</span>, <span class="number">3768248971</span>, <span class="number">1812666977</span>, <span class="number">4206697533</span>, <span class="number">2662688175</span>, <span class="number">1229262173</span>, <span class="number">2972369904</span>, <span class="number">4138621734</span>, <span class="number">1015377946</span>, <span class="number">2651562555</span>, <span class="number">268255977</span>, <span class="number">3252122337</span>, <span class="number">1621021176</span>, <span class="number">2994730872</span>, <span class="number">559931834</span>, <span class="number">3988579176</span>, <span class="number">3567691983</span>, <span class="number">1930674231</span>, <span class="number">2218383326</span>, <span class="number">758788884</span>, <span class="number">910208449</span>, <span class="number">227817632</span>, <span class="number">2140599685</span>, <span class="number">3548929815</span>, <span class="number">2587591999</span>, <span class="number">3580039418</span>, <span class="number">1872428683</span>, <span class="number">701406125</span>, <span class="number">4288602909</span>, <span class="number">1109645047</span>, <span class="number">1397038574</span>, <span class="number">2576598599</span>, <span class="number">586000901</span>, <span class="number">2693205802</span>, <span class="number">152821105</span>, <span class="number">2557672927</span>, <span class="number">2165199135</span>, <span class="number">1482476870</span>, <span class="number">1144667446</span>, <span class="number">3796957272</span>, <span class="number">182521958</span>, <span class="number">3425668252</span>, <span class="number">1367303991</span>, <span class="number">1303438183</span>, <span class="number">3798174016</span>, <span class="number">3822328448</span>, <span class="number">2174253407</span>, <span class="number">368330786</span>, <span class="number">123594742</span>, <span class="number">1208148383</span>, <span class="number">1769908846</span>, <span class="number">3062152568</span>, <span class="number">1874539716</span>, <span class="number">4098588639</span>, <span class="number">1184714779</span>, <span class="number">2489698445</span>, <span class="number">3909685808</span>, <span class="number">1928812454</span>, <span class="number">3605420887</span>, <span class="number">4111625005</span>, <span class="number">3601167612</span>, <span class="number">2365741840</span>, <span class="number">1767141708</span>, <span class="number">572895792</span>, <span class="number">2249632076</span>, <span class="number">4291418450</span>, <span class="number">603542283</span>, <span class="number">2506946516</span>, <span class="number">3132493203</span>, <span class="number">235891852</span>, <span class="number">2035908962</span>, <span class="number">2962949323</span>, <span class="number">756732284</span>, <span class="number">1229852751</span>, <span class="number">163244976</span>, <span class="number">4117722390</span>, <span class="number">2204154201</span>, <span class="number">2211522886</span>, <span class="number">1137023330</span>, <span class="number">694949872</span>, <span class="number">16637714</span>, <span class="number">167503308</span>, <span class="number">3680251840</span>, <span class="number">2097279770</span>, <span class="number">3496392499</span>, <span class="number">3178068824</span>, <span class="number">3118729426</span>, <span class="number">3137404850</span>, <span class="number">3646384420</span>, <span class="number">3444927241</span>, <span class="number">2182874045</span>, <span class="number">415700967</span>, <span class="number">4278153892</span>, <span class="number">3578893031</span>, <span class="number">415285993</span>, <span class="number">1910390682</span>, <span class="number">443081739</span>, <span class="number">4009368874</span>, <span class="number">3216674839</span>, <span class="number">2732429792</span>, <span class="number">1801899246</span>, <span class="number">884417585</span>, <span class="number">2683393468</span>, <span class="number">2168835935</span>, <span class="number">567679007</span>, <span class="number">2675310920</span>, <span class="number">3244164342</span>, <span class="number">948786909</span>, <span class="number">4049866703</span>, <span class="number">3763778347</span>, <span class="number">3994212229</span>, <span class="number">937179772</span>, <span class="number">682416950</span>, <span class="number">4237120584</span>, <span class="number">1314748325</span>, <span class="number">1011893987</span>, <span class="number">594451978</span>, <span class="number">2591572861</span>, <span class="number">3321773081</span>, <span class="number">1782732845</span>, <span class="number">1906672771</span>, <span class="number">3198375563</span>, <span class="number">2677553481</span>, <span class="number">2524341084</span>, <span class="number">3834072067</span>, <span class="number">1843752429</span>, <span class="number">2535045290</span>, <span class="number">3159920919</span>, <span class="number">3333512770</span>, <span class="number">2901497143</span>, <span class="number">255992028</span>, <span class="number">1329320485</span>, <span class="number">2705147800</span>, <span class="number">1648509016</span>, <span class="number">3063622090</span>, <span class="number">2994198416</span>, <span class="number">2054303692</span>, <span class="number">3202051646</span>, <span class="number">3658720183</span>, <span class="number">412326269</span>, <span class="number">1481252325</span>, <span class="number">2852045384</span>, <span class="number">253106637</span>, <span class="number">3226081928</span>, <span class="number">4263121751</span>, <span class="number">541226047</span>, <span class="number">2226732784</span>, <span class="number">938020060</span>, <span class="number">1949217059</span>, <span class="number">3270150900</span>, <span class="number">548921532</span>, <span class="number">2822626483</span>, <span class="number">3199026017</span>, <span class="number">3417519239</span>, <span class="number">3658562304</span>, <span class="number">2840731352</span>, <span class="number">3326593139</span>, <span class="number">60562367</span>, <span class="number">2609616202</span>, <span class="number">1639463440</span>, <span class="number">2922591920</span>, <span class="number">2626459952</span>, <span class="number">3751875818</span>, <span class="number">3985074014</span>, <span class="number">2918717822</span>, <span class="number">3453007911</span>, <span class="number">2602897826</span>, <span class="number">2633193513</span>, <span class="number">592359758</span>, <span class="number">2145325100</span>, <span class="number">1967291896</span>, <span class="number">392327774</span>, <span class="number">606203046</span>, <span class="number">2265885037</span>, <span class="number">3053206123</span>, <span class="number">3875079316</span>, <span class="number">2579332720</span>, <span class="number">1131140826</span>, <span class="number">247340200</span>, <span class="number">497676100</span>, <span class="number">3083051276</span>]</span><br><span class="line">states = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> states]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">backtrace_untwist</span>(<span class="params">cur</span>):</span><br><span class="line">    high = <span class="number">0x80000000</span></span><br><span class="line">    low = <span class="number">0x7fffffff</span></span><br><span class="line">    mask = <span class="number">0x9908b0df</span></span><br><span class="line">    state = cur</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">623</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">        tmp = state[i]^^state[(i+<span class="number">397</span>)%<span class="number">624</span>]</span><br><span class="line">        <span class="comment"># recover Y,tmp = Y</span></span><br><span class="line">        <span class="keyword">if</span> tmp &amp; high == high:</span><br><span class="line">            tmp ^^= mask</span><br><span class="line">            tmp &lt;&lt;= <span class="number">1</span></span><br><span class="line">            tmp |= <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp &lt;&lt;=<span class="number">1</span></span><br><span class="line">        <span class="comment"># recover highest bit</span></span><br><span class="line">        res = tmp&amp;high</span><br><span class="line">        <span class="comment"># recover other 31 bits,when i =0,it just use the method again it so beautiful!!!!</span></span><br><span class="line">        tmp = state[i-<span class="number">1</span>]^^state[(i+<span class="number">396</span>)%<span class="number">624</span>]</span><br><span class="line">        <span class="comment"># recover Y,tmp = Y</span></span><br><span class="line">        <span class="keyword">if</span> tmp &amp; high == high:</span><br><span class="line">            tmp ^^= mask</span><br><span class="line">            tmp &lt;&lt;= <span class="number">1</span></span><br><span class="line">            tmp |= <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp &lt;&lt;=<span class="number">1</span></span><br><span class="line">        res |= (tmp)&amp;low</span><br><span class="line">        state[i] = res    </span><br><span class="line">    <span class="keyword">return</span> state</span><br><span class="line">    </span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">statei = states <span class="comment">#init</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">1</span>,<span class="number">150000</span>):</span><br><span class="line">    RNG = random.Random()</span><br><span class="line">    <span class="keyword">if</span>((<span class="number">396</span>-i) % <span class="number">624</span> == <span class="number">0</span>):</span><br><span class="line">        statei = backtrace_untwist(statei)</span><br><span class="line">        statei = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> statei]</span><br><span class="line">        RNG.setstate((<span class="number">3</span>,<span class="built_in">tuple</span>(statei+[<span class="number">624</span>]),<span class="literal">None</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        statei = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> statei]</span><br><span class="line">        RNG.setstate((<span class="number">3</span>,<span class="built_in">tuple</span>(statei+[(<span class="number">396</span>-i) % <span class="number">624</span>]),<span class="literal">None</span>))</span><br><span class="line">    s = [vector(F, [RNG.randrange(<span class="number">0</span>,<span class="number">256</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(N//<span class="number">2</span>)]) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)]</span><br><span class="line"></span><br><span class="line">    cipher = AES.new(md5(<span class="built_in">str</span>(<span class="built_in">sum</span>(s)).encode()).digest(), AES.MODE_ECB)</span><br><span class="line">    enc = <span class="string">&quot;af3010a3de0fa968c38f421f2857d6c60caf9a6ae1023e9d04f253e1d5fb8038fddf26f7cc976fadbb2df12ef549d1fd&quot;</span></span><br><span class="line">    flag = cipher.decrypt(<span class="built_in">bytes</span>.fromhex(enc))</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">b&quot;n1ctf&quot;</span> <span class="keyword">in</span> flag):</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#n1ctf&#123;ISD&amp;LLL_4re_bo7h_v3ry_pow3rfu1_t00ls&#125;</span></span><br></pre></td></tr></table></figure>
<p>å“ˆå“ˆå“ˆ</p>
<p><br></p>
<p><br></p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>ç³–é†‹å°é¸¡å—
  </li>
  <li class="post-copyright-link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="https://tangcuxiaojikuai.xyz/post/cd7e8e10.html" title="2024-N1CTF-wp-crypto">https://tangcuxiaojikuai.xyz/post/cd7e8e10.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sacreative/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SACREATIVE</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>
</div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/post/860541dc.html" rel="prev" title="2024-æ•°ä¿¡æ¯å†³èµ›-wp-crypto">
      <i class="fa fa-chevron-left"></i> 2024-æ•°ä¿¡æ¯å†³èµ›-wp-crypto
    </a></div>
      <div class="post-nav-item">
    <a href="/post/cb7cb618.html" rel="next" title="2024-èœ€é“å±±é«˜æ ¡è”åˆå…¬ç›Šèµ›-wp-crypto">
      2024-èœ€é“å±±é«˜æ ¡è”åˆå…¬ç›Šèµ›-wp-crypto <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#n0tr5a"><span class="nav-number">1.</span> <span class="nav-text">n0tr5a</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#seashells"><span class="nav-number">2.</span> <span class="nav-text">seashells</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80"><span class="nav-number">2.1.</span> <span class="nav-text">æ–¹æ³•ä¸€</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C"><span class="nav-number">2.2.</span> <span class="nav-text">æ–¹æ³•äºŒ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%B8%89"><span class="nav-number">2.3.</span> <span class="nav-text">æ–¹æ³•ä¸‰</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#M4sTeriX"><span class="nav-number">3.</span> <span class="nav-text">*M4sTeriX</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80-1"><span class="nav-number">3.1.</span> <span class="nav-text">æ–¹æ³•ä¸€</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#tedious-work"><span class="nav-number">3.1.1.</span> <span class="nav-text">tedious_work</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#MT"><span class="nav-number">3.1.2.</span> <span class="nav-text">*MT</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#error-work"><span class="nav-number">3.1.3.</span> <span class="nav-text">error_work</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C-1"><span class="nav-number">3.2.</span> <span class="nav-text">æ–¹æ³•äºŒ</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="ç³–é†‹å°é¸¡å—"
      src="/images/image.png">
  <p class="site-author-name" itemprop="name">ç³–é†‹å°é¸¡å—</p>
  <div class="site-description" itemprop="description">"è¿½é£èµ¶æœˆè«åœç•™ï¼Œå¹³èŠœå°½å¤„æ˜¯æ˜¥å±±"</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">109</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/tangcuxiaojikuai" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;tangcuxiaojikuai" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/1142381085@qq.com" title="E-Mail â†’ 1142381085@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/6394335993" title="Weibo â†’ https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;6394335993" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ç³–é†‹å°é¸¡å—</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> å¼ºåŠ›é©±åŠ¨
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>
  <script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'UPEMA7DyYbIIEyOW72ohgytU-gzGzoHsz',
      appKey     : 'M7rXAfeP3JOslroay2n0Jv2R',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
<!-- å¼•å…¥jQuery -->
<script type="text/javascript" src="//libs.baidu.com/jquery/1.8.3/jquery.min.js"></script>
<!-- é›ªèŠ±ç‰¹æ•ˆ2 -->
<script type="text/javascript" src="/js/snow2.js"></script>
