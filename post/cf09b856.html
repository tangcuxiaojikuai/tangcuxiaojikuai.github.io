<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon_small.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="RnN18ZogmZl_dLVpxZ6y8kjKL73Mu9VLVEkw9d3qrq0" />
  <meta name="msvalidate.01" content="DC3050AD55F30DDF75AAB78517714910" />
  <meta name="baidu-site-verification" content="codeva-PPofu3dNxe" />

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-loading-bar.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"tangcuxiaojikuai.xyz","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="æœŸæœ«æ€»ç®—è¿‡å»äº†ï¼Œç»ˆäºæœ‰æ—¶é—´æ¥æ›´æ–°æ›´æ–°å·²ç»è¿‡å»äº†å¤§åŠä¸ªæœˆçš„CryptoCTFã€‚è¿™æ¬¡æ¯”èµ›å’Œè®¤è¯†çš„ä¸€äº›å¸ˆå‚…ä¸€èµ·ç»„äº†ä¸ªå°é˜ŸcyberCryerï¼Œæœ€åæ‹¿åˆ°äº†ç¬¬äºŒåï¼š  è™½ç„¶è¯´è¿™æ¬¡æ¯”èµ›çš„ä¸€äº›é¢˜ç›®å®åœ¨æœ‰ç‚¹æ— åŠ›åæ§½ï¼Œä½†æ˜¯æ¯”èµ›ä¸­é€”å¤§å®¶ä¸€èµ·åŠ ç­åŠ ç‚¹è‚é¢˜çš„ä¹è¶£æ˜¯å®æ‰“å®çš„ï¼Œå†æ¬¡æ„Ÿè°¢cyberCryerçš„å„ä½å¸ˆå‚…ã€‚( ã¤â€¢Ì€Ï‰â€¢Ì)ã¤ ç”±äºå¤§å®¶ä¸€èµ·åœ¨åšé¢˜ï¼Œæ‰€ä»¥éƒ¨åˆ†é¢˜ç›®çš„wpæ˜¯æˆ‘èµ›åå¤ç°çš„ï¼Œå¹¶ä¸ä¸€å®šæ˜¯åšé¢˜çš„å¸ˆå‚…çš„æ€è·¯ã€‚åŒæ—¶æˆ‘">
<meta property="og:type" content="article">
<meta property="og:title" content="2024-CryptoCTF-wp-crypto">
<meta property="og:url" content="https://tangcuxiaojikuai.xyz/post/cf09b856.html">
<meta property="og:site_name" content="ç³–é†‹å°é¸¡å—çš„blog">
<meta property="og:description" content="æœŸæœ«æ€»ç®—è¿‡å»äº†ï¼Œç»ˆäºæœ‰æ—¶é—´æ¥æ›´æ–°æ›´æ–°å·²ç»è¿‡å»äº†å¤§åŠä¸ªæœˆçš„CryptoCTFã€‚è¿™æ¬¡æ¯”èµ›å’Œè®¤è¯†çš„ä¸€äº›å¸ˆå‚…ä¸€èµ·ç»„äº†ä¸ªå°é˜ŸcyberCryerï¼Œæœ€åæ‹¿åˆ°äº†ç¬¬äºŒåï¼š  è™½ç„¶è¯´è¿™æ¬¡æ¯”èµ›çš„ä¸€äº›é¢˜ç›®å®åœ¨æœ‰ç‚¹æ— åŠ›åæ§½ï¼Œä½†æ˜¯æ¯”èµ›ä¸­é€”å¤§å®¶ä¸€èµ·åŠ ç­åŠ ç‚¹è‚é¢˜çš„ä¹è¶£æ˜¯å®æ‰“å®çš„ï¼Œå†æ¬¡æ„Ÿè°¢cyberCryerçš„å„ä½å¸ˆå‚…ã€‚( ã¤â€¢Ì€Ï‰â€¢Ì)ã¤ ç”±äºå¤§å®¶ä¸€èµ·åœ¨åšé¢˜ï¼Œæ‰€ä»¥éƒ¨åˆ†é¢˜ç›®çš„wpæ˜¯æˆ‘èµ›åå¤ç°çš„ï¼Œå¹¶ä¸ä¸€å®šæ˜¯åšé¢˜çš„å¸ˆå‚…çš„æ€è·¯ã€‚åŒæ—¶æˆ‘">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/cf09b856/image-20240630091043812.png">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/cf09b856/image-20240630113251927.png">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/cf09b856/image-20240701095249427.png">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/cf09b856/image-20240701095316721.png">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/cf09b856/image-20240701103055895.png">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/cf09b856/image-20240701103126855.png">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/cf09b856/image-20240701103144061.png">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/cf09b856/image-20240701103159097.png">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/cf09b856/image-20240701103349848.png">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/cf09b856/image-20240701103950864.png">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/cf09b856/image-20240701104026332.png">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/cf09b856/image-20240701104109464.png">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/cf09b856/image-20240701141056368.png">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/cf09b856/image-20240701141412956.png">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/cf09b856/image-20240701141459600.png">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/cf09b856/image-20240701141537346.png">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/cf09b856/image-20240701141559738.png">
<meta property="article:published_time" content="2024-07-01T07:48:40.000Z">
<meta property="article:modified_time" content="2024-07-01T09:51:29.085Z">
<meta property="article:author" content="ç³–é†‹å°é¸¡å—">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tangcuxiaojikuai.xyz/post/cf09b856/image-20240630091043812.png">

<link rel="canonical" href="https://tangcuxiaojikuai.xyz/post/cf09b856.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>2024-CryptoCTF-wp-crypto | ç³–é†‹å°é¸¡å—çš„blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ç³–é†‹å°é¸¡å—çš„blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
        <li class="menu-item menu-item-å‹é“¾">

    <a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>å‹é“¾</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tangcuxiaojikuai.xyz/post/cf09b856.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/image.png">
      <meta itemprop="name" content="ç³–é†‹å°é¸¡å—">
      <meta itemprop="description" content=""è¿½é£èµ¶æœˆè«åœç•™ï¼Œå¹³èŠœå°½å¤„æ˜¯æ˜¥å±±"">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ç³–é†‹å°é¸¡å—çš„blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2024-CryptoCTF-wp-crypto
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2024-07-01 15:48:40 / ä¿®æ”¹æ—¶é—´ï¼š17:51:29" itemprop="dateCreated datePublished" datetime="2024-07-01T15:48:40+08:00">2024-07-01</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/wp-crypto/" itemprop="url" rel="index"><span itemprop="name">wp-crypto</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valineï¼š</span>
    
    <a title="valine" href="/post/cf09b856.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/post/cf09b856.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>æœŸæœ«æ€»ç®—è¿‡å»äº†ï¼Œç»ˆäºæœ‰æ—¶é—´æ¥æ›´æ–°æ›´æ–°å·²ç»è¿‡å»äº†å¤§åŠä¸ªæœˆçš„CryptoCTFã€‚è¿™æ¬¡æ¯”èµ›å’Œè®¤è¯†çš„ä¸€äº›å¸ˆå‚…ä¸€èµ·ç»„äº†ä¸ªå°é˜ŸcyberCryerï¼Œæœ€åæ‹¿åˆ°äº†ç¬¬äºŒåï¼š</p>
<p><img src="/post/cf09b856/image-20240630091043812.png" alt="image-20240630091043812"></p>
<p>è™½ç„¶è¯´è¿™æ¬¡æ¯”èµ›çš„ä¸€äº›é¢˜ç›®å®åœ¨æœ‰ç‚¹æ— åŠ›åæ§½ï¼Œä½†æ˜¯æ¯”èµ›ä¸­é€”å¤§å®¶ä¸€èµ·åŠ ç­åŠ ç‚¹è‚é¢˜çš„ä¹è¶£æ˜¯å®æ‰“å®çš„ï¼Œå†æ¬¡æ„Ÿè°¢cyberCryerçš„å„ä½å¸ˆå‚…ã€‚( ã¤â€¢Ì€Ï‰â€¢Ì)ã¤</p>
<p>ç”±äºå¤§å®¶ä¸€èµ·åœ¨åšé¢˜ï¼Œæ‰€ä»¥éƒ¨åˆ†é¢˜ç›®çš„wpæ˜¯æˆ‘èµ›åå¤ç°çš„ï¼Œå¹¶ä¸ä¸€å®šæ˜¯åšé¢˜çš„å¸ˆå‚…çš„æ€è·¯ã€‚åŒæ—¶æˆ‘ä¹Ÿè®°å½•äº†ä¸€äº›æ¯”èµ›ä¸­çš„æœ‰è¶£çš„åŠ¨æ€ï¼Œç•™ä½œçºªå¿µã€‚</p>
<span id="more"></span>
<h2 id="é˜Ÿä¼å…¶ä»–å¸ˆå‚…çš„wpæŒ‡è·¯ï¼š"><a href="#é˜Ÿä¼å…¶ä»–å¸ˆå‚…çš„wpæŒ‡è·¯ï¼š" class="headerlink" title="é˜Ÿä¼å…¶ä»–å¸ˆå‚…çš„wpæŒ‡è·¯ï¼š"></a>é˜Ÿä¼å…¶ä»–å¸ˆå‚…çš„wpæŒ‡è·¯ï¼š</h2><p>Zimaï¼š<a target="_blank" rel="noopener" href="https://www.zimablue.life/article/cctf2024_1.html">CRYPTOCTF2024(part1) | Zimablueâ€™ Blog</a></p>
<p>â€¦â€¦</p>
<p><br></p>
<p><br></p>
<h2 id="Warm-up"><a href="#Warm-up" class="headerlink" title="Warm-up"></a>Warm-up</h2><h3 id="Welcome-ğŸ‘‹-367-solves-27-pts"><a href="#Welcome-ğŸ‘‹-367-solves-27-pts" class="headerlink" title="Welcome! ğŸ‘‹(367 solves , 27 pts)"></a>Welcome! ğŸ‘‹(367 solves , 27 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">We are excited that you will be participating in 6th CryptoCTF, an engaging online event focused on challenging and improving your cryptography abilities. You&#x27;ll have the opportunity to dive into the captivating realm of ciphers, codes, and modern cryptosystems. ğŸ’ª âš¡ ğŸ’¥ ğŸ”¥</span><br></pre></td></tr></table></figure>
<p>ç›´æ¥äº¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag: CCTF&#123;Harn3sS_Y0ur_CrYptO9rAphy_Pr0wEs5_ğŸ’ª_âš¡_ğŸ’¥_ğŸ”¥!&#125;</span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h2 id="Easy"><a href="#Easy" class="headerlink" title="Easy"></a>Easy</h2><h3 id="Alibos-181-solves-36-pts"><a href="#Alibos-181-solves-36-pts" class="headerlink" title="Alibos(181 solves , 36 pts)"></a>Alibos(181 solves , 36 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Alibos, a classic cryptographic algorithm, is designed to safeguard non-sensitive data, providing a reliable solution for routine information protection.</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> d, flag</span><br><span class="line"></span><br><span class="line">get_context().precision = <span class="number">1337</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">m, d</span>):</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">str</span>(m)) &lt; d:</span><br><span class="line">		m = <span class="built_in">str</span>(m) + <span class="string">&#x27;1&#x27;</span> * (d - <span class="built_in">len</span>(<span class="built_in">str</span>(m)))</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">int</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genkey</span>(<span class="params">d</span>):</span><br><span class="line">	skey = getRandomRange(<span class="number">10</span> ** (d - <span class="number">1</span>), <span class="number">10</span> ** d)</span><br><span class="line">	pkey = <span class="built_in">int</span>(<span class="number">10</span>**d * (sqrt(skey) - floor(sqrt(skey))))</span><br><span class="line">	<span class="keyword">return</span> pkey, skey</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m, pkey</span>):</span><br><span class="line">	m = pad(m, <span class="built_in">len</span>(<span class="built_in">str</span>(pkey)))</span><br><span class="line">	d = <span class="built_in">len</span>(<span class="built_in">str</span>(pkey))</span><br><span class="line">	c = (pkey + d ** <span class="number">2</span> * m) % (<span class="number">10</span> ** d)</span><br><span class="line">	<span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">pkey, skey = genkey(d)</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = encrypt(m, pkey)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;pkey = <span class="subst">&#123;pkey&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;enc  = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>output.txtï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pkey = 8582435512564229286688465405009040056856016872134514945016805951785759509953023638490767572236748566493023965794194297026085882082781147026501124183913218900918532638964014591302221504335115379744625749001902791287122243760312557423006862735120339132655680911213722073949690947638446354528576541717311700749946777</span><br><span class="line">enc  = 6314597738211377086770535291073179315279171595861180001679392971498929017818237394074266448467963648845725270238638741470530326527225591470945568628357663345362977083408459035746665948779559824189070193446347235731566688204757001867451307179564783577100125355658166518394135392082890798973020986161756145194380336</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®å«æœ‰ä¸€ä¸ªæœªçŸ¥çš„é‡dï¼Œåˆ©ç”¨è¿™ä¸ªdç”Ÿæˆäº†éšæœºçš„skeyå’Œpkeyï¼Œç„¶åæŒ‰å¦‚ä¸‹æ–¹å¼åŠ å¯†ï¼š</p>
<script type="math/tex; mode=display">
c = pkey + d^2(pad(m)) \quad(mod\;10^d)</script><p>ç„¶è€Œä»”ç»†çœ‹çš„è¯ä¼šå‘ç°åŠ å¯†å¼å­é‡Œçš„då®é™…ä¸Šæ˜¯pkeyçš„å­—ç¬¦ä¸²é•¿åº¦ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è§£å‡ºmç„¶åå»æ‰padå°±è¡Œã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">pkey = <span class="number">8582435512564229286688465405009040056856016872134514945016805951785759509953023638490767572236748566493023965794194297026085882082781147026501124183913218900918532638964014591302221504335115379744625749001902791287122243760312557423006862735120339132655680911213722073949690947638446354528576541717311700749946777</span></span><br><span class="line">enc  = <span class="number">6314597738211377086770535291073179315279171595861180001679392971498929017818237394074266448467963648845725270238638741470530326527225591470945568628357663345362977083408459035746665948779559824189070193446347235731566688204757001867451307179564783577100125355658166518394135392082890798973020986161756145194380336</span></span><br><span class="line"></span><br><span class="line">d = <span class="built_in">len</span>(<span class="built_in">str</span>(pkey))</span><br><span class="line">m = (enc - pkey)*inverse(d**<span class="number">2</span>,<span class="number">10</span>**d) % <span class="number">10</span>**d</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">300</span>):</span><br><span class="line">    flag = long_to_bytes(<span class="built_in">int</span>(<span class="built_in">str</span>(m)[:-i]))</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">b&quot;CCTF&quot;</span> <span class="keyword">in</span> flag):</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#CCTF&#123;h0M3_m4De_cRyp70_5ySTeM_1N_CryptoCTF!!!&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="Beheaded-32-solves-131-pts"><a href="#Beheaded-32-solves-131-pts" class="headerlink" title="Beheaded(32 solves , 131 pts)"></a>Beheaded(32 solves , 131 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The beheaded flags have had their headers removed, making them encrypted. Can a living entity truly survive without a head?</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">source</span> secrets.sh</span><br><span class="line"></span><br><span class="line">FLAGS=<span class="string">&quot;all_flags.txt&quot;</span></span><br><span class="line"><span class="built_in">rm</span> -f <span class="string">&quot;all_flags.enc&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">read</span> flag; <span class="keyword">do</span></span><br><span class="line">	magick -background white -fill blue -pointsize 72 -size <span class="string">&quot;<span class="variable">$X</span>&quot;</span>x<span class="string">&quot;<span class="variable">$Y</span>&quot;</span> -gravity North caption:<span class="string">&quot;<span class="variable">$flag</span>&quot;</span> flag.ppm</span><br><span class="line">	<span class="built_in">tail</span> -n +4 flag.ppm &gt; <span class="built_in">tail</span></span><br><span class="line">	openssl enc -aes-256-ecb -pbkdf2 -nosalt -pass pass:<span class="string">&quot;<span class="variable">$KEY</span>&quot;</span> -<span class="keyword">in</span> <span class="built_in">tail</span> &gt;&gt; <span class="string">&quot;all_flags.enc&quot;</span></span><br><span class="line"><span class="keyword">done</span> &lt; <span class="string">&quot;<span class="variable">$FLAGS</span>&quot;</span></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®å°†flagä¸²å†™åœ¨å›¾ç‰‡ä¸Šï¼Œç„¶åå¯¹è¿™å¼ å›¾ç‰‡è¿›è¡ŒECBåŠ å¯†ï¼Œæœ€åå¾—åˆ°å¯†æ–‡æ–‡ä»¶ã€‚</p>
<p>åŸç†çš„è¯å…¶å®å¹¶ä¸å¤æ‚ï¼Œå¯¹äºä¸€å¼ å›¾ç‰‡æ¥è¯´ï¼Œå…¶åˆ†ä¸ºäº†å¾ˆå¤šè‰²å—ï¼Œè€Œç”±äºæ˜¯ECBåŠ å¯†ï¼Œæ‰€ä»¥å¯¹äºç›¸åŒçš„è‰²å—(ä¹Ÿå°±æ˜¯èƒŒæ™¯è‰²)ï¼Œå…¶å¯†æ–‡ä¹Ÿä¸€å®šæ˜¯ç›¸åŒçš„ï¼Œè€Œè¿™ä¹Ÿè¯´æ˜ä¸€ç‚¹â€”â€”ä¸æ˜¯èƒŒæ™¯è‰²å—å¯†æ–‡çš„åœ°æ–¹ï¼Œå°±ä¸€å®šæœ‰å†…å®¹ã€‚æ‰€ä»¥å¯ä»¥ç»Ÿè®¡å¯†æ–‡æ¥å¤§è‡´è¿˜åŸè½®å»“ã€‚è€Œå¯¹äºè¿™ä¸ªé¢˜ç›®æ¥è®²ï¼Œå…¶å°±æ˜¯æŠŠæ–‡å­—å†™åœ¨å›¾ç‰‡ä¸Šçš„å›¾ç‰‡ï¼Œæ‰€ä»¥è¿˜åŸè½®å»“å°±ç­‰äºè¿˜åŸflagã€‚</p>
<p>ä¸è¿‡å…·ä½“æ“ä½œä¸Šåº”è¯¥è¿˜æ˜¯æŒºæœ‰è®²ç©¶ï¼Œæ¯”å¦‚ppmæ ¼å¼ã€åŠ å¯†åˆ†ç»„æ€ä¹ˆå¯¹åº”è‰²å—ç­‰æˆ‘éƒ½ä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œä½†<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ZimaBlue">@Zima</a>æ­£å¥½äº†è§£è¿™äº›ï¼Œå°±ç”¨äº†ä¸€ä¸ªå·¥å…·ç›´æ¥æŠŠä»–æ¢­æ‰äº†ã€‚</p>
<p><br></p>
<h3 id="Mashy-68-solves-71-pts"><a href="#Mashy-68-solves-71-pts" class="headerlink" title="Mashy(68 solves , 71 pts)"></a>Mashy(68 solves , 71 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Mashy may seem like a simple cracking task, but you&#x27;ll need to open your eyes to identify the right things to crack.</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> salt, flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">die</span>(<span class="params">*args</span>):</span><br><span class="line">	pr(*args)</span><br><span class="line">	quit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pr</span>(<span class="params">*args</span>):</span><br><span class="line">	s = <span class="string">&quot; &quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, args))</span><br><span class="line">	sys.stdout.write(s + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">	sys.stdout.flush()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sc</span>():</span><br><span class="line">	<span class="keyword">return</span> sys.stdin.buffer.readline()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">s1, s2</span>):</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">bytes</span>([s1[_] ^ s2[_] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s1))])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">	border = <span class="string">&quot;â”ƒ&quot;</span></span><br><span class="line">	pr(        <span class="string">&quot;â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“&quot;</span>)</span><br><span class="line">	pr(border, <span class="string">&quot;.: Hi all, she did Mashy, you should do it too! Are you ready? :. &quot;</span>, border)</span><br><span class="line">	pr(        <span class="string">&quot;â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›&quot;</span>)</span><br><span class="line"></span><br><span class="line">	REC = []</span><br><span class="line">	cnt, STEP = <span class="number">0</span>, <span class="number">7</span></span><br><span class="line">	sh = md5(salt).digest()</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		pr(border, <span class="string">f&#x27;Please send your first input:  &#x27;</span>)</span><br><span class="line">		d1 = sc().strip()</span><br><span class="line">		pr(border, <span class="string">f&#x27;Please send your second input: &#x27;</span>)</span><br><span class="line">		d2 = sc().strip()</span><br><span class="line">		<span class="keyword">try</span>:</span><br><span class="line">			d1 = hexlify(unhexlify(d1))</span><br><span class="line">			d2 = hexlify(unhexlify(d2))</span><br><span class="line">			h1 = md5(unhexlify(d1)).digest()</span><br><span class="line">			h2 = md5(unhexlify(d2)).digest()</span><br><span class="line">		<span class="keyword">except</span>:</span><br><span class="line">			die(border, <span class="string">&#x27;Your inputs are not valid! Bye!!!&#x27;</span>)</span><br><span class="line">		<span class="keyword">if</span> d1 != d2 <span class="keyword">and</span> d1 <span class="keyword">not</span> <span class="keyword">in</span> REC <span class="keyword">and</span> d2 <span class="keyword">not</span> <span class="keyword">in</span> REC:</span><br><span class="line">			<span class="keyword">if</span> md5(xor(d1, d2)).hexdigest() != <span class="string">&#x27;ae09d7510659ca40eda3e45ca70e9606&#x27;</span>:</span><br><span class="line">				<span class="keyword">if</span> hexlify(xor(xor(h1, h2), sh)) == <span class="string">b&#x27;a483b30944cbf762d4a3afc154aad825&#x27;</span>:</span><br><span class="line">					REC += [d1, d2]</span><br><span class="line">					<span class="keyword">if</span> cnt == STEP:</span><br><span class="line">						die(border, <span class="string">f&#x27;Congrats! the flag: <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br><span class="line">					pr(border, <span class="string">&#x27;Good job, try next level :P&#x27;</span>)</span><br><span class="line">					cnt += <span class="number">1</span></span><br><span class="line">				<span class="keyword">else</span>:</span><br><span class="line">					die(border, <span class="string">&#x27;Your input is not correct! Bye!&#x27;</span>)</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				die(border, <span class="string">&#x27;No this one! Sorry!!&#x27;</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			die(border, <span class="string">&#x27;Kidding me!? Bye!!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªé¢˜æ€»çš„æ¥è¯´è¦å®Œæˆä¸ƒè½®æŒ‘æˆ˜ï¼Œæ¯ä¸€è½®éƒ½éœ€è¦è¾“å…¥ä¸¤ä¸ªåå…­è¿›åˆ¶ä¸²d1ã€d2ï¼Œé¶æœºä¼šè®¡ç®—ä»–ä»¬çš„md5å€¼h1ã€h2ï¼Œè¿™äº›å€¼å¦‚æœæ»¡è¶³ä»¥ä¸‹è¦æ±‚å°±å¯ä»¥é€šè¿‡æœ¬è½®æŒ‘æˆ˜ï¼š</p>
<ul>
<li><p>d1ä¸ç­‰äºd2</p>
</li>
<li><p>d1ã€d2ä¹‹å‰æ²¡æœ‰è¾“å…¥è¿‡</p>
</li>
<li><p>$d_1 \oplus d_2$çš„md5å€¼ä¸ä¸ºâ€™ae09d7510659ca40eda3e45ca70e9606â€™</p>
</li>
<li><p>$h_1 \oplus h_2 \oplus sh$çš„å€¼ä¸ºâ€™a483b30944cbf762d4a3afc154aad825â€™ï¼Œå…¶ä¸­shä¸º(saltæœªçŸ¥)ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh = md5(salt).digest()</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>æ€ä¹ˆçœ‹éƒ½æƒ³ä¸é€šè¦å¹²ä»€ä¹ˆï¼Œé¦–å…ˆè¿™ä¸ªshæ˜¯ä¸çŸ¥é“çš„ï¼Œæ‰€ä»¥ä¹Ÿå°±ä¸çŸ¥é“h1å¼‚æˆ–h2åˆ°åº•è¦æ»¡è¶³ä»€ä¹ˆä¸œè¥¿ï¼ŒåªçŸ¥é“éœ€è¦æ˜¯ä¸€ä¸ªå®šå€¼ï¼›å…¶æ¬¡å°±æ˜¯d1å¼‚æˆ–d2çš„md5å€¼ä¹Ÿä¸çŸ¥é“æ˜¯ä»€ä¹ˆï¼Œä¸è¿‡è¿™ä¸ªè¿˜å¥½ï¼Œä»…ä»…æ˜¯è¦æ±‚ä¸ä¸ºå¤šå°‘ï¼Œå¾ˆå®¹æ˜“å°±èƒ½åšåˆ°ã€‚</p>
<p>ä¸€å¤´é›¾æ°´çš„æ—¶å€™å‘ç°è¿™ä¸ªé¢˜è§£æ•°è¹­è¹­æ¶¨ï¼Œæ‰€ä»¥ç›²çŒœåº”è¯¥åªæ˜¯ä¸ªmd5çš„ç¢°æ’ï¼Œä¹Ÿå°±æ˜¯è®©d1ã€d2ä¸ç­‰çš„æƒ…å†µä¸‹h1ã€h2ç›¸ç­‰ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€shå°±æ˜¯â€™a483b30944cbf762d4a3afc154aad825â€™ã€‚ä¸Šåœ¨çº¿ç½‘ç«™ç”Ÿæˆå‡ ç»„å‰ç¼€ç¢°æ’ç„¶åäº¤äº’å°±å¥½ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://rivers.chaitin.cn/tools/md5fastcollision">MD5 åœ¨çº¿ç¢°æ’ - ç™¾å·åœ¨çº¿å·¥å…·ç®± (chaitin.cn)</a></p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&quot;01.cr.yp.toc.tf&quot;</span>,<span class="number">13771</span>)</span><br><span class="line"></span><br><span class="line">msg = [(<span class="string">b&quot;31000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fe11ecc10c7ab8b4fe112d7f29ceb2dae1f39ce7a691488bfb817b7685ad087a162b0ce0ea69b140e7274b44c43f183578392f9719b43d4966c321cc0a10e6fbd002869b42f9fad9eb869dc55d5d349835961b1fd36a0bbe76a9bb5f4f5cc54136dec48d74497bf6579a6bf9721b81078637b429cff958886bd816dc4333a338&quot;</span>,<span class="string">b&quot;31000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fe11ecc10c7ab8b4fe112d7f29ceb2dae1f39c67a691488bfb817b7685ad087a162b0ce0ea69b140e7274b44c4bf183578392f9719b43d4966c3214c0a10e6fbd002869b42f9fad9eb869dc55d5d349835961b9fd36a0bbe76a9bb5f4f5cc54136dec48d74497bf6579a6bf9729b80078637b429cff958886bd8165c4333a338&quot;</span>),</span><br><span class="line">       (<span class="string">b&quot;32000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ebcd0390c198c8f33b4a08cce32f47451b5002e68895b7505d12824a0a460d133de3eff34e4de89ceb27ed3bce211b4696fec6736c059058d8b60f6e473f6c701068abf2d6bc645c4589a6f0f5211f5fc903c96e789d91f8abb300d8176088b7d31d825897c9001cf409c45b3a50005e93e33f4f908f9df944a664c927d28d55&quot;</span>,<span class="string">b&quot;32000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ebcd0390c198c8f33b4a08cce32f47451b5002668895b7505d12824a0a460d133de3eff34e4de89ceb27ed3bcea11b4696fec6736c059058d8b60fee473f6c701068abf2d6bc645c4589a6f0f5211f5fc903c9ee789d91f8abb300d8176088b7d31d825897c9001cf409c45b3ad0ff5d93e33f4f908f9df944a6644927d28d55&quot;</span>),</span><br><span class="line">       (<span class="string">b&quot;3300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000068270588dbc19cfe24db79019b0070d1823c4a4d6d816cdb22c2401a32081455e5db01c54c0ccf1b6706f061eec3e58ead12b5173dee55f954f9ac52a1a4bbedc32ab0ee3cae3896f9908a49d38cc5535c6c80661d262e1ec91a8639ecc7e1654086c61bf4cfe7fc6a7378f7809416ef39ae4ccc7fc29570c4c3a51b03fed7b9&quot;</span>,<span class="string">b&quot;3300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000068270588dbc19cfe24db79019b0070d1823c4acd6d816cdb22c2401a32081455e5db01c54c0ccf1b6706f061ee43e68ead12b5173dee55f954f9acd2a1a4bbedc32ab0ee3cae3896f9908a49d38cc5535c6c80e61d262e1ec91a8639ecc7e1654086c61bf4cfe7fc6a7378f7801416ef39ae4ccc7fc29570c4c3a59b03fed7b9&quot;</span>),</span><br><span class="line">       (<span class="string">b&quot;3400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000025a80516e996c87574dc568d274da9d2d281b09bbc72f7ef46767961b4a708e969ebffe06a6e0945cbefe2f2fc41d89cb89c2574afb1fdbac5aca131cdf52d68b9e3c95615888cbc3d187ccd32f60d5b35636e925c1aa3002bb330c81b6088d8cbeb8014afc24f5e374ad05ab2f30d1fac7221195b7f3f1f19f5219ecaf948a2&quot;</span>,<span class="string">b&quot;3400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000025a80516e996c87574dc568d274da9d2d281b01bbc72f7ef46767961b4a708e969ebffe06a6e0945cbefe2f2fcc1d89cb89c2574afb1fdbac5aca1b1cdf52d68b9e3c95615888cbc3d187ccd32f60d5b35636e125c1aa3002bb330c81b6088d8cbeb8014afc24f5e374ad05ab2730d1fac7221195b7f3f1f19f5211ecaf948a2&quot;</span>),</span><br><span class="line">       (<span class="string">b&quot;35000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f56f1da5ad57f483059ae0869962f05204f954e2de9d56c55b168139ec372cefb1b307cbe84ce477cbff5df4d40bc46c08ceef8bb18bfc996b3b9fdaa7b72c17ee1cb3491794d6e2ff7d9914525cdf2d88b9314505ef864d201d2b364a6e25ae4d183e738c3c86e53e5ad1a1910c825cb1bcd59b97d1a3cf979668fbac6a138b&quot;</span>,<span class="string">b&quot;35000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f56f1da5ad57f483059ae0869962f05204f95462de9d56c55b168139ec372cefb1b307cbe84ce477cbff5df4d48bc46c08ceef8bb18bfc996b3b9f5aa7b72c17ee1cb3491794d6e2ff7d9914525cdf2d88b931c505ef864d201d2b364a6e25ae4d183e738c3c86e53e5ad1a1918c815cb1bcd59b97d1a3cf9796687bac6a138b&quot;</span>),</span><br><span class="line">       (<span class="string">b&quot;36000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f2b343c2bb614b7b4acc4e0ade8a5e4b2abb4eefe97ef7991832793e4e301637cf0becd84c43dbafeb43d0da12c8e2883e0d02ada60e678e3470ee866abe2fa713b8a521a986e75d821f74221fee2ea441b3ab462f29b56f862b00d05f60cdc1a9a1c92d04457bd6e693673963ab6e6b6c3552cd1c54efe627b342fecdfd8dea&quot;</span>,<span class="string">b&quot;36000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f2b343c2bb614b7b4acc4e0ade8a5e4b2abb4e6fe97ef7991832793e4e301637cf0becd84c43dbafeb43d0da1248e3883e0d02ada60e678e3470ee066abe2fa713b8a521a986e75d821f74221fee2ea441b3abc62f29b56f862b00d05f60cdc1a9a1c92d04457bd6e6936739632b6e6b6c3552cd1c54efe627b3427ecdfd8dea&quot;</span>),</span><br><span class="line">       (<span class="string">b&quot;370000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001d6afba61c0910b5ca21a9164b65134753b3845080d9afe6460237a1d938a8385204b0e85cce2b686b40d9b9c517e64b08ee01d02fa63470aa3b34c1e550d11356d867ea70e96b0257d9b1b20df1ee22603111180739001ad17bf6c8dd707932b34e97b62e74936197adcc2f93164b46c7c7e4bb7b6c1a55a21958961f7378be&quot;</span>,<span class="string">b&quot;370000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001d6afba61c0910b5ca21a9164b65134753b384d080d9afe6460237a1d938a8385204b0e85cce2b686b40d9b9c597e64b08ee01d02fa63470aa3b3441e550d11356d867ea70e96b0257d9b1b20df1ee22603111980739001ad17bf6c8dd707932b34e97b62e74936197adcc2f93964a46c7c7e4bb7b6c1a55a21958161f7378be&quot;</span>),</span><br><span class="line">       (<span class="string">b&quot;38000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c6eb639aedf271805029b40d4dc783ab8d769d35cb9032f9184641b94c881615f5f902cb5e8ba3176f2660d4f821828fdbed111365cc4dfbbf001ca884fcb74df4f681c17ed38f53b8346319fee0c2eaecf2ea2597f0ca2c04ed6c064e9e3ddd7d37ff3e54908e889a58455a8fd411bc0f75e93cadc453f6f89d16e8cd8e7c2a&quot;</span>,<span class="string">b&quot;38000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c6eb639aedf271805029b40d4dc783ab8d769db5cb9032f9184641b94c881615f5f902cb5e8ba3176f2660d4f8a1828fdbed111365cc4dfbbf001c2884fcb74df4f681c17ed38f53b8346319fee0c2eaecf2eaa597f0ca2c04ed6c064e9e3ddd7d37ff3e54908e889a58455a8f5411bc0f75e93cadc453f6f89d1668cd8e7c2a&quot;</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    sh.sendline(msg[i][<span class="number">0</span>])</span><br><span class="line">    sh.sendline(msg[i][<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">b&quot;Congrats! the flag: &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(sh.recvline())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#CCTF&#123;mD5_h4Sh_cOlL!Si0N_CrYp7o_ch41lEnGe!!!&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h2 id="Medium"><a href="#Medium" class="headerlink" title="Medium"></a>Medium</h2><h3 id="Ahoo-29-solves-142-pts"><a href="#Ahoo-29-solves-142-pts" class="headerlink" title="Ahoo(29 solves , 142 pts)"></a>Ahoo(29 solves , 142 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ahoo, the swiftest and most graceful gazelle in Iran, is renowned for her unmatched beauty and uncanny ability to evade even the most cunning traps.</span><br></pre></td></tr></table></figure>
<p>æ²¡æœ‰é™„ä»¶ï¼Œé¢˜ç›®çš„é¢˜æ„æ˜¯ï¼š</p>
<ul>
<li>ç»™å®šä¸€ä¸ªæ­£æ•´æ•°n(å¤§æ¦‚åœ¨å‡ åƒè¿™ä¸ªæ•°é‡çº§)ï¼Œè¦æ±‚ç»™å‡ºæœ€å°çš„æ­£æ•´æ•°cï¼Œä½¿å¾—t=ncçš„æ±‰æ˜é‡é‡æœ€å°</li>
</ul>
<p>æœ€å¼€å§‹å½“ç„¶åªæƒ³åˆ°çˆ†ç ´ï¼Œä½†æ˜¯å®é™…æ•ˆæœæ¥è¯´ï¼Œçˆ†ç ´èƒ½å¤Ÿåˆ°çš„èŒƒå›´å¤ªå°äº†ï¼Œå¾ˆå®¹æ˜“å‡ºé”™ã€‚ä¹‹å<a target="_blank" rel="noopener" href="https://yolbby.github.io/">@yolbby</a>æƒ³äº†ä¸€ä¸ªç”¨æ ¼çš„æ–¹æ³•ï¼Œå·®ä¸å¤šæ˜¯ï¼š</p>
<ul>
<li>æŠŠtçœ‹ä½œæ˜¯ä¸€ä¸ªèƒŒåŒ…ï¼ŒèƒŒåŒ…é‡Œçš„å€¼æ˜¯2^kï¼Œé€ æ ¼è§„çº¦å‡ºæ¥çš„çŸ­å‘é‡å°±æ˜¯æ±‰æ˜é‡é‡æ¯”è¾ƒå°çš„ã€‚</li>
<li><p>è¿™æ ·èƒ½æ‰¾åˆ°çš„cçš„èŒƒå›´å°±å’Œæ ¼çš„ç»´æ•°ç›´æ¥ç›¸å…³ï¼Œæ¯”å¦‚æ ¼å¤§å°ä¸º256ï¼Œé‚£ä¹ˆæ ¼èƒ½æ‰¾åˆ°çš„æœ€ä¼˜è§£å°±æ˜¯2^256ä»¥å†…çš„cï¼Œè‚¯å®šæ˜¯æ¯”çˆ†ç ´è¦å¥½çš„</p>
</li>
<li><p>ç„¶åå†å•ç‹¬å¤„ç†ä¸€ä¸‹æ±‰æ˜é‡é‡å¯èƒ½ä¸º2çš„æƒ…å†µã€‚è‹¥æ±‰æ˜é‡é‡æ˜¯2ï¼Œé‚£ä¹ˆå¯ä»¥å†™æˆt = 2^r(2^s+1) = ncï¼Œå…¶å®ä¹Ÿå°±å¯ä»¥ç­‰ä»·æˆc=2^s+1/nï¼Œæ‰€ä»¥å¯ä»¥å†å•ç‹¬æ‰¾ä¸€ä¸‹æ¯”è¾ƒå¤§çš„cï¼Œå°±å¯ä»¥å¤§äº2^256ã€‚</p>
</li>
</ul>
<p>é€ æ ¼ä¼¼ä¹æœ‰ç‚¹ä¸å¤ªå¥½ç†è§£ï¼Œå…¶å®å°±æ˜¯åˆ©ç”¨è¿™ä¸ªç­‰å¼ï¼š</p>
<script type="math/tex; mode=display">
t = nc</script><p>æ—¢ç„¶è¦è®©tæ±‰æ˜é‡é‡è¾ƒå°ï¼Œæ‰€ä»¥å¦‚æœæŠŠä»–ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºçš„è¯ï¼Œç³»æ•°æ˜¯å¾ˆç¨€ç–çš„ï¼Œä¹Ÿå°±æ˜¯å¦‚æœå†™æˆï¼š</p>
<script type="math/tex; mode=display">
t = a_02^0 + a_12^1 + a_22^2 + ... + a_{256}2^{256}</script><p>é‚£ä¹ˆaiåº”è¯¥å¾ˆå¤š0ï¼Œåªæœ‰æå°‘æ•°æ˜¯1ã€‚</p>
<p>é‚£ä¹ˆæŠŠç­‰å¼ç§»ä¸€ä¸‹é¡¹å°±å˜æˆäº†ï¼š</p>
<script type="math/tex; mode=display">
a_02^0 + a_12^1 + a_22^2 + ... + a_{256}2^{256} - cn = 0</script><p>æ‰€ä»¥å°±å¯ä»¥é€ æ ¼ã€‚</p>
<p>256è¿™ä¸ªæ•°å®Œå…¨æ˜¯è‡ªå·±é€‰æ‹©çš„ï¼Œè¦å¹³è¡¡ä¸€ä¸‹èƒ½æ‰¾åˆ°çš„èŒƒå›´å’Œæ ¼è§„çº¦çš„æ—¶é—´æ‰è¡Œï¼Œé€‰æ‹©256ä»£è¡¨ç€å¯ä»¥æ‰¾åˆ°2^256ä»¥å†…çš„tï¼Œå¤§ä¸€ç‚¹æŸ¥æ‰¾èŒƒå›´è‡ªç„¶ä¹Ÿå¤§ä¸€äº›ï¼Œä½†æ˜¯è§„çº¦å°±ä¼šæ…¢ã€‚</p>
<p>ä¸Šæ‰‹å®ç°äº†ä¸€ä¸‹å‘ç°ç¡®å®è¡Œï¼Œä¸è¿‡ä»ç„¶æœ‰å¤±è´¥çš„å¯èƒ½ï¼Œç”±äºè¦é€šè¿‡20è½®ï¼Œä¼˜åŒ–äº†å¾ˆä¹…éƒ½æ²¡æå®šï¼Œæœ€å¤šæŒ‚åˆ°åäº”åå…­è½®çš„æ ·å­ï¼Œæ‰€ä»¥è¿™è‚¯å®šä¸æ˜¯é€šæ³•ã€‚ä¸è¿‡è¿˜æ˜¯æŠŠsolverå‘ä¸Šæ¥ç•™ä½œçºªå¿µï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    sh = remote(<span class="string">&quot;00.cr.yp.toc.tf&quot;</span>,<span class="number">17371</span>)</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">        sh.recvuntil(<span class="string">b&quot;n = &quot;</span>)</span><br><span class="line">        nn = <span class="built_in">int</span>(sh.recvline().strip().decode().split(<span class="string">&quot;,&quot;</span>)[<span class="number">0</span>])</span><br><span class="line">        n = nn</span><br><span class="line">        <span class="built_in">print</span>(n)</span><br><span class="line">        <span class="keyword">while</span>(n % <span class="number">2</span> == <span class="number">0</span>):</span><br><span class="line">            n &gt;&gt;= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        nums = <span class="number">256</span></span><br><span class="line">        K = <span class="number">2</span>^<span class="number">100</span></span><br><span class="line">        L = Matrix(ZZ,nums+<span class="number">1</span>,nums+<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nums):</span><br><span class="line">            L[i,i] = <span class="number">1</span></span><br><span class="line">            L[i,-<span class="number">1</span>] = <span class="number">2</span>^i*K</span><br><span class="line">        L[-<span class="number">1</span>,-<span class="number">1</span>] = n*K</span><br><span class="line">        res = L.BKZ()</span><br><span class="line"></span><br><span class="line">        mini = <span class="number">2000</span></span><br><span class="line">        c = <span class="number">2</span>^<span class="number">512</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">            temp = i</span><br><span class="line">            ans = <span class="number">0</span></span><br><span class="line">            <span class="keyword">if</span>((<span class="built_in">all</span>(j &lt;= <span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> temp[:-<span class="number">1</span>])) <span class="keyword">or</span> (<span class="built_in">all</span>(j &gt;= <span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> temp[:-<span class="number">1</span>]))):</span><br><span class="line">                <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(temp[:-<span class="number">1</span>])):</span><br><span class="line">                    ans += temp[:-<span class="number">1</span>][k] * <span class="number">2</span>^k</span><br><span class="line">                cc = ans // n</span><br><span class="line">                <span class="keyword">while</span>(cc % <span class="number">2</span> == <span class="number">0</span> <span class="keyword">and</span> cc &gt; <span class="number">0</span>):</span><br><span class="line">                    cc = cc &gt;&gt; <span class="number">1</span></span><br><span class="line">                temp = (<span class="built_in">bin</span>(ans)[<span class="number">2</span>:].count(<span class="string">&quot;1&quot;</span>))</span><br><span class="line">                <span class="keyword">if</span>(temp &lt; mini <span class="keyword">and</span> cc != <span class="number">0</span> <span class="keyword">and</span> cc &gt; <span class="number">0</span>):</span><br><span class="line">                    mini = temp</span><br><span class="line">                    c = cc</span><br><span class="line">                <span class="keyword">elif</span>(temp == mini <span class="keyword">and</span> cc != <span class="number">0</span> <span class="keyword">and</span> cc &gt; <span class="number">0</span> <span class="keyword">and</span> cc &lt; c):</span><br><span class="line">                    mini = temp</span><br><span class="line">                    c = cc</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#check 2</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100000</span>):</span><br><span class="line">            tt = <span class="string">&quot;1&quot;</span> + <span class="string">&quot;0&quot;</span>*i + <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">int</span>(tt,<span class="number">2</span>) % n == <span class="number">0</span>):</span><br><span class="line">                mini = <span class="number">2</span></span><br><span class="line">                c = <span class="built_in">int</span>(tt,<span class="number">2</span>) // n</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">bin</span>(nn*c))</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(mini).encode() + <span class="string">b&quot;,&quot;</span> + <span class="built_in">str</span>(c).encode())</span><br><span class="line"></span><br><span class="line">        sh.sendline(<span class="built_in">str</span>(mini).encode() + <span class="string">b&quot;,&quot;</span> + <span class="built_in">str</span>(c).encode())</span><br><span class="line">        tt = (sh.recvline())</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">b&quot;not&quot;</span> <span class="keyword">in</span> tt):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Not this time&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>()</span><br><span class="line">            sh.close()</span><br><span class="line">            sleep(<span class="number">5</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(sh.recvline())</span><br></pre></td></tr></table></figure>
<p>æ€ä¹ˆéƒ½ä¼˜åŒ–ä¸å‡ºæ¥çš„æ—¶å€™<a target="_blank" rel="noopener" href="https://wleukocytec.github.io/">@leukocyte</a>ç™»åœºï¼Œä»–çœ‹å‡ºè¿™å®é™…ä¸Šæ˜¯ä¸€ä¸ªå…³äºåŒä½™æœ€çŸ­è·¯çš„ç®—æ³•é¢˜ï¼Œæ‰€ä»¥ç›´æ¥äº¤ç»™ä»–åšï¼Œæœç„¶å¾ˆå¿«å°±ç§’äº†ã€‚ä½†æˆ‘çš„ç®—æ³•åŠŸåº•å¾ˆçƒ‚ï¼Œæ‰€ä»¥åº”è¯¥ç†è§£ä¸äº†ã€‚</p>
<p>èµ›åçœ‹<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/702904244">æ˜¥å“¥çš„wp</a>å‘ç°è¯´å¯ä»¥æ±‚å‡ºå‰å‡ é¡¹ä¹‹åä¸ŠOEISæŸ¥æ•°åˆ—ï¼Œå°±èƒ½æŸ¥åˆ°å…³äºé€šè§£çš„è®ºæ–‡ï¼Œä»¥åŠå‰10000é¡¹çš„ç»“æœï¼Œæ‰€ä»¥å¯ä»¥æŸ¥è¡¨ç„¶åå‘å›å»ã€‚</p>
<p><br></p>
<h3 id="Alilbols-59-solves-80-pts"><a href="#Alilbols-59-solves-80-pts" class="headerlink" title="Alilbols(59 solves , 80 pts)"></a>Alilbols(59 solves , 80 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Alilbols, a modified version of the Alibos cryptographic algorithm, offers enhanced security features to protect sensitive and confidential data.</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> d, flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genkey</span>(<span class="params">d</span>):</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		f = getRandomRange(<span class="number">1</span>, <span class="built_in">int</span>(sqrt(<span class="number">2</span>) * <span class="number">10</span> ** d))</span><br><span class="line">		g = getRandomRange(<span class="number">10</span> ** d, <span class="built_in">int</span>(sqrt(<span class="number">2</span>) * <span class="number">10</span> ** d))</span><br><span class="line">		<span class="keyword">if</span> gcd(f, <span class="number">10</span> * g) == <span class="number">1</span>:</span><br><span class="line">			q = <span class="number">4</span> * <span class="number">100</span> ** d</span><br><span class="line">			h = inverse(f, q) * g % q</span><br><span class="line">			<span class="keyword">if</span> gcd(h, <span class="number">10</span> * d) == <span class="number">1</span>:</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">	pkey, skey = (d, h), (f, g)</span><br><span class="line">	<span class="keyword">return</span> pkey, skey</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m, pkey</span>):</span><br><span class="line">	d, h = pkey</span><br><span class="line">	q = <span class="number">4</span> * <span class="number">100</span> ** d</span><br><span class="line">	<span class="keyword">assert</span> m &lt; <span class="number">10</span> ** d</span><br><span class="line">	r = getRandomRange(<span class="number">1</span>, <span class="number">10</span> ** d // <span class="number">2</span>)</span><br><span class="line">	c = (r * h + m + r) % q</span><br><span class="line">	<span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">pkey, _ = genkey(d)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = encrypt(m, pkey)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;h = <span class="subst">&#123;pkey[<span class="number">1</span>]&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>output.txtï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">h = 1051643987107349427988807326909852110640860009433515828832892541964729933410444984350917250524103015414239941369074041041830326426044333499878031164851095096864048639115431370526747014210332286314344073411522846701723463410585601251886732229726828022089809603850477551571014006202841406236367999378786782206165205893353928598469661871284779486855440579818275314024966224282757807716013799903830828885606714972634243850947534165272668985513949964901606268939300116019465522042467054120201087606016018354238401711720121586874288767235317479748890350702705575809130664969776549574720593740409234863974057904204809404816059921579771581800937241591669455683460570640868196509926763901079838233646036933530095891316054589051458146768287967886035091641162494322987627448810201550901588438560433001422233269632915351406169253963308421081459981594969405377353502889363324282815864766827664453823780238352371809048289845094882346227809082005375092441877966603138648719670349093616548820955566204871333952902983753935678447080673827214244142614295192263451840766771122229866931492260663320087497820892824540996643905125018452302747847009</span><br><span class="line">c = 11913143174789215053772744981113562063689725867199301496294410323568897757042952642806438602327917861884988292757318755590132189620231444302311290566584065812614959093870787195145654508262419270742989923415342357807325941686508030706603920412262004324188375072184983301522882728578077572816154054220606088703932092256905881975876112779175003897105313776239681492514925430817300633974666123599685062340158348009344351002327049272743679109535286730751345284084148118733529966364414749672437370878526710641430471595906340522772252875146681541656231708112317601000655090279925720590940060372738708208419449824043905057860829031242339842131799965043031307394209699264362321397162645220002253271689678364848888381499587038475895945238726252440250183268252483198408039250213490525880829604473555612305513974817850974135874728084839426045420913060975464553734293001460752648937744531874552694145500413222582269910431269597066268600572899619407093373565994271589940926018891922169454906132284552523035481664164354874071831210264979733079749696197917769435226866441989054017071332158916586376454753209296136133271926449919437888563234409</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ä»ç„¶æ˜¯æœ‰ä¸€ä¸ªæœªçŸ¥çš„é‡dï¼Œåˆ©ç”¨è¿™ä¸ªdå…ˆç”Ÿæˆäº†ä¸€ç»„å¯†é’¥pkeyå’Œskeyï¼Œç„¶åå†ç”¨å…¬é’¥pkeyåŠ å¯†må¾—åˆ°å¯†æ–‡cã€‚</p>
<p>é‚£ä¹ˆå°±å…ˆçœ‹è¿™ä¸ªgenkeyï¼Œå…¶æ­¥éª¤æ˜¯ï¼š</p>
<ul>
<li><p>ç”Ÿæˆfã€gï¼Œæ»¡è¶³ï¼š</p>
<script type="math/tex; mode=display">
f \in (1,\sqrt{2}\cdot 10^d)</script><script type="math/tex; mode=display">
g \in (10^d,\sqrt{2}\cdot 10^d)</script></li>
<li><p>ç”Ÿæˆqï¼Œæ»¡è¶³$q = 4 \cdot 10^{2d}$</p>
</li>
<li><p>è®¡ç®—hï¼š</p>
<script type="math/tex; mode=display">
h = f^{-1}g \quad(mod\;q)</script></li>
<li><p>å¾—åˆ°å…¬é’¥(d,h)ï¼Œç§é’¥(f,g)</p>
</li>
</ul>
<p>ä¹‹åçœ‹encryptï¼š</p>
<ul>
<li><p>qè¿˜æ˜¯ä¸Šé¢é‚£ä¸ªq</p>
</li>
<li><p>å–ä¸€ä¸ªéšæœºæ•°rï¼Œ$r \in (1,\frac{10^d}{2})$</p>
</li>
<li><p>è®¡ç®—å¯†æ–‡cï¼š</p>
<script type="math/tex; mode=display">
c = rh + m + r \quad(mod\;q)</script></li>
</ul>
<p>ç»™å‡ºhã€cï¼Œè¦æ±‚è¿˜åŸmã€‚</p>
<p>å¯ä»¥çœ‹å‡ºä»–çš„genkeyå…¶å®æ˜¯ä¸€ä¸ªntruï¼Œæ‰€ä»¥æœ‰qçš„æƒ…å†µä¸‹å¯ä»¥é€ æ ¼å¾—åˆ°fã€gã€‚ç„¶è€Œé—®é¢˜åœ¨äºé¢˜ç›®æ²¡æœ‰ç»™å‡ºqä¹Ÿæ²¡æœ‰ç»™å‡ºdï¼Œä½†æ˜¯å¯ä»¥å‘ç°cã€héƒ½æ˜¯æ¨¡qä¸‹çš„é‡ï¼Œæ‰€ä»¥qåº”è¯¥ä¼šç•¥å¤§äºcã€hï¼Œå› æ­¤å¯ä»¥ç®€å•åœ¨èŒƒå›´é™„è¿‘çˆ†ç ´ä¸€ä¸‹dï¼Œæ£€æŸ¥ä¸€ä¸‹è§„çº¦å‡ºçš„fã€gæ˜¯å¦åˆç†å°±è¡Œã€‚</p>
<p>å¾—åˆ°fã€gä¹‹åå°±ç­‰äºå¾—åˆ°äº†ç§é’¥ï¼Œä¹‹åç±»ä¼¼ntruå»è§£å¯†ã€‚ç”±äºæœ‰ï¼š</p>
<script type="math/tex; mode=display">
c = rf^{-1}g + m + r \quad(mod\;q)</script><p>æ‰€ä»¥ï¼š</p>
<script type="math/tex; mode=display">
cf = r(f+g) + mf \quad(mod\;q)</script><p>å’Œntruä¸€æ ·ï¼Œç”±äºå„ä¸ªæ•°å­—æ•°é‡çº§å‡æœ‰é™åˆ¶ï¼Œæ‰€ä»¥æ•´ä¸ªå¼å­ä¸æ¨¡qä¹Ÿæ˜¯æˆç«‹çš„ï¼Œä¹Ÿå°±æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
cf = r(f+g) + mf</script><p>æ‰€ä»¥æœ‰ï¼š</p>
<script type="math/tex; mode=display">
cf = mf \quad(mod\; f+g)</script><p>ç„¶åå†åœ¨f+gä¸‹å¯¹fæ±‚é€†å°±å¯ä»¥å¾—åˆ°mã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">h = <span class="number">1051643987107349427988807326909852110640860009433515828832892541964729933410444984350917250524103015414239941369074041041830326426044333499878031164851095096864048639115431370526747014210332286314344073411522846701723463410585601251886732229726828022089809603850477551571014006202841406236367999378786782206165205893353928598469661871284779486855440579818275314024966224282757807716013799903830828885606714972634243850947534165272668985513949964901606268939300116019465522042467054120201087606016018354238401711720121586874288767235317479748890350702705575809130664969776549574720593740409234863974057904204809404816059921579771581800937241591669455683460570640868196509926763901079838233646036933530095891316054589051458146768287967886035091641162494322987627448810201550901588438560433001422233269632915351406169253963308421081459981594969405377353502889363324282815864766827664453823780238352371809048289845094882346227809082005375092441877966603138648719670349093616548820955566204871333952902983753935678447080673827214244142614295192263451840766771122229866931492260663320087497820892824540996643905125018452302747847009</span></span><br><span class="line">c = <span class="number">11913143174789215053772744981113562063689725867199301496294410323568897757042952642806438602327917861884988292757318755590132189620231444302311290566584065812614959093870787195145654508262419270742989923415342357807325941686508030706603920412262004324188375072184983301522882728578077572816154054220606088703932092256905881975876112779175003897105313776239681492514925430817300633974666123599685062340158348009344351002327049272743679109535286730751345284084148118733529966364414749672437370878526710641430471595906340522772252875146681541656231708112317601000655090279925720590940060372738708208419449824043905057860829031242339842131799965043031307394209699264362321397162645220002253271689678364848888381499587038475895945238726252440250183268252483198408039250213490525880829604473555612305513974817850974135874728084839426045420913060975464553734293001460752648937744531874552694145500413222582269910431269597066268600572899619407093373565994271589940926018891922169454906132284552523035481664164354874071831210264979733079749696197917769435226866441989054017071332158916586376454753209296136133271926449919437888563234409</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">560</span>,<span class="number">580</span>):</span><br><span class="line">    q = <span class="number">4</span> * <span class="number">100</span> ** d</span><br><span class="line">    <span class="keyword">if</span>(q &gt; c):</span><br><span class="line">        F = <span class="built_in">int</span>(sqrt(<span class="number">2</span>) * <span class="number">10</span> ** d)</span><br><span class="line">        G = <span class="built_in">int</span>(sqrt(<span class="number">2</span>) * <span class="number">10</span> ** d)</span><br><span class="line">        L = Matrix(ZZ, [[<span class="number">1</span>, h],</span><br><span class="line">                        [<span class="number">0</span>, q]])</span><br><span class="line">        res = L.LLL()[<span class="number">0</span>]</span><br><span class="line">        f, g = res[<span class="number">0</span>] , res[<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">abs</span>(f) &lt; F <span class="keyword">and</span> <span class="built_in">abs</span>(g) &gt; <span class="number">10</span> ** d <span class="keyword">and</span> <span class="built_in">abs</span>(g) &lt; G <span class="keyword">and</span> f*g &gt; <span class="number">0</span>):</span><br><span class="line">            f = <span class="built_in">abs</span>(f)</span><br><span class="line">            g = <span class="built_in">abs</span>(g)</span><br><span class="line">            mf = c*f % q % (f+g)</span><br><span class="line">            m = mf * inverse(f,f+g) % (f+g)</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#CCTF&#123;4_c0N9rU3n7!aL_Pu81iC_k3Y_cRyp70_5ySTeM_1N_CCTF!!&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="Ally-22-solves-174-pts"><a href="#Ally-22-solves-174-pts" class="headerlink" title="Ally(22 solves , 174 pts)"></a>Ally(22 solves , 174 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ally enjoys the challenge of solving Diophantine equations, so help them tackle this latest complex equation as well.</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">die</span>(<span class="params">*args</span>):</span><br><span class="line">	pr(*args)</span><br><span class="line">	quit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pr</span>(<span class="params">*args</span>):</span><br><span class="line">	s = <span class="string">&quot; &quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, args))</span><br><span class="line">	sys.stdout.write(s + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">	sys.stdout.flush()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sc</span>():</span><br><span class="line">	<span class="keyword">return</span> sys.stdin.buffer.readline()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">	border = <span class="string">&quot;â”ƒ&quot;</span></span><br><span class="line">	pr(        <span class="string">&quot;â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“&quot;</span>)</span><br><span class="line">	pr(border, <span class="string">&quot;.::  Ally is my best friend, help him to solve his tough task  ::.&quot;</span>, border)</span><br><span class="line">	pr(        <span class="string">&quot;â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›&quot;</span>)</span><br><span class="line"></span><br><span class="line">	nbit = <span class="number">14</span></span><br><span class="line">	level, step = <span class="number">0</span>, <span class="number">19</span></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		pr(border, <span class="string">f&#x27;Please send your <span class="subst">&#123;nbit&#125;</span>-bit prime:  &#x27;</span>)</span><br><span class="line">		p = sc().strip()</span><br><span class="line">		<span class="keyword">try</span>:</span><br><span class="line">			p = <span class="built_in">int</span>(p)</span><br><span class="line">		<span class="keyword">except</span>:</span><br><span class="line">			die(border, <span class="string">&#x27;Your input is not valid! Bye!!!&#x27;</span>)</span><br><span class="line">		<span class="keyword">if</span> isPrime(p) <span class="keyword">and</span> p.bit_length() == nbit:</span><br><span class="line">			pr(border, <span class="string">&#x27;Send the solution of the following Diophantine equation in positive integers x, y&#x27;</span>)</span><br><span class="line">			pr(border, <span class="string">f&#x27;<span class="subst">&#123;p&#125;</span> * (x - y)**3 = (x**2 + y) * (x + y**2)&#x27;</span>)</span><br><span class="line">			xy = sc().strip().decode()</span><br><span class="line">			<span class="keyword">try</span>:</span><br><span class="line">				x, y = [<span class="built_in">int</span>(_) <span class="keyword">for</span> _ <span class="keyword">in</span> xy.split(<span class="string">&#x27;,&#x27;</span>)]</span><br><span class="line">			<span class="keyword">except</span>:</span><br><span class="line">				die(border, <span class="string">&#x27;Your answer is not valid! Bye!!!&#x27;</span>)</span><br><span class="line">			<span class="keyword">if</span> p * (x - y)**<span class="number">3</span> == (x**<span class="number">2</span> + y) * (x + y**<span class="number">2</span>) <span class="keyword">and</span> x &gt; <span class="number">0</span> <span class="keyword">and</span> y &gt; <span class="number">0</span>:</span><br><span class="line">				<span class="keyword">if</span> level == step:</span><br><span class="line">					die(border, <span class="string">f&#x27;Congratz! You got the flag: <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br><span class="line">				<span class="keyword">else</span>:</span><br><span class="line">					pr(border, <span class="string">f&#x27;Good job, try the next step <span class="subst">&#123;level + <span class="number">2</span>&#125;</span>&#x27;</span>)</span><br><span class="line">					level += <span class="number">1</span></span><br><span class="line">					nbit = <span class="built_in">int</span>(<span class="number">1.2</span>*nbit) + getRandomRange(<span class="number">0</span>, <span class="number">6</span>)</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				die(border, <span class="string">&#x27;Your answer is not correct! Bye!!&#x27;</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			die(border, <span class="string">&#x27;Kidding me!? Bye!!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®å…±19è½®æŒ‘æˆ˜ï¼Œæ¯ä¸€è½®æŒ‘æˆ˜éœ€è¦æ»¡è¶³ï¼š</p>
<ul>
<li><p>è¾“å…¥ä¸€ä¸ªæŒ‡å®šå¤§å°çš„ç´ æ•°p</p>
</li>
<li><p>ç»™å‡ºä¸‹é¢ä¸¢ç•ªå›¾æ–¹ç¨‹çš„ä¸€ä¸ªæ­£æ•´æ•°è§£ï¼š</p>
<script type="math/tex; mode=display">
p(x - y)^3 = (x^2 + y)(x + y^2)</script></li>
</ul>
<p>èµ›ä¸­çš„æ—¶å€™ç ”ç©¶è¿™ä¸ªç ”ç©¶äº†å¥½ä¹…ï¼Œæ—¢æ²¡æœ‰æœåˆ°å•¥è®ºæ–‡ï¼Œä¹Ÿæ²¡æƒ³åˆ°èƒ½æ€ä¹ˆè‡ªå·±æ„é€ ã€‚æœ€å<a target="_blank" rel="noopener" href="https://yolbby.github.io/">@yolbby</a>ç»™å‡ºäº†ä¸€ä¸ªå·§å¦™çš„æ€è·¯ï¼š</p>
<script type="math/tex; mode=display">
p = 4y+1</script><script type="math/tex; mode=display">
x = 2y+1</script><p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&#x27;01.cr.yp.toc.tf&#x27;</span>,<span class="number">13777</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">20</span>):</span><br><span class="line">    sh.recvuntil(<span class="string">b&#x27;Please send your &#x27;</span>)</span><br><span class="line">    a = sh.recvuntil(<span class="string">b&#x27;-&#x27;</span>)[:-<span class="number">1</span>]</span><br><span class="line">    a = <span class="built_in">int</span>(a)</span><br><span class="line">    sh.recvline()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        p = getPrime(a)</span><br><span class="line">        <span class="keyword">if</span> p % <span class="number">4</span> == <span class="number">1</span>:</span><br><span class="line">            y = (p-<span class="number">1</span>)//<span class="number">4</span></span><br><span class="line">            x = <span class="number">2</span>*y+<span class="number">1</span></span><br><span class="line">            sh.sendline(<span class="built_in">str</span>(p).encode())</span><br><span class="line">            sh.recvline()</span><br><span class="line">            sh.sendline(<span class="string">f&#x27;<span class="subst">&#123;x&#125;</span>,<span class="subst">&#123;y&#125;</span>&#x27;</span>.encode())</span><br><span class="line">            sh.recv()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(sh.recvline())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#CCTF&#123;Di0phaNtinE_eQuaT1on_iZ_4n_equ4tion_wiTh_int3ger_solu7Ions_0nly!&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="Bada-51-solves-90-pts"><a href="#Bada-51-solves-90-pts" class="headerlink" title="Bada(51 solves , 90 pts)"></a>Bada(51 solves , 90 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The Bada equation contains an undetermined function. By closely examining how this equation behaves, you may be able to discover the concealed flag.</span><br></pre></td></tr></table></figure>
<p>ä¾ç„¶æ²¡æœ‰é™„ä»¶ï¼Œé¢˜ç›®å†…å®¹æ˜¯ï¼š</p>
<p>å­˜åœ¨ä¸€ä¸ªæœªçŸ¥çš„å‡½æ•°fï¼Œæ»¡è¶³ï¼š</p>
<script type="math/tex; mode=display">
f(a+1,b) = f(a,b) + a</script><script type="math/tex; mode=display">
f(a,b+1) = f(a,b) - b</script><p>å…¶ä¸­æ‰€æœ‰å€¼éƒ½æ˜¯æ•´æ•°ï¼Œé¶æœºä¼šç»™å‡ºä¸¤ä¸ªå€¼ï¼š</p>
<script type="math/tex; mode=display">
f(x,y),f(1,1)</script><p>è¦æ±‚æ±‚å‡ºxï¼Œyã€‚</p>
<p>å¯ä»¥çœ‹å‡ºï¼Œä»(1,1)åˆ°(x,y)çš„è¿­ä»£è¿‡ç¨‹å®Œå…¨å¯ä»¥çœ‹ä½œæ˜¯ä¸¤ä¸ªä¸åŒçš„ç­‰å·®æ•°åˆ—ï¼Œä¹Ÿå°±æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
f(x,y) = f(1,1) + (1 + 2 + ... + (x-1)) - (1 + 2 + ... + (y-1))</script><p>è€Œè¿™ä¸¤ä¸ªç­‰å·®æ•°åˆ—åˆæ˜¾ç„¶å¯ä»¥åˆæˆä¸€ä¸ªç­‰å·®æ•°åˆ—ï¼Œä¹Ÿå°±æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
f(x,y) = f(1,1) + (y + (y+1) + ... + (x-1))</script><p>ç”¨æ±‚å’Œå…¬å¼å°±æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
f(x,y) = f(1,1) + \frac{(y+x-1)(x-y)}{2}</script><p>è®°ï¼š</p>
<script type="math/tex; mode=display">
d = f(x,y) - f(1,1)</script><p>æ‰€ä»¥æœ‰ï¼š</p>
<script type="math/tex; mode=display">
(y+x-1)(x-y) = 2d</script><p>ç„¶åäº¤äº’è¿‡ç¨‹ä¸­åˆå‘ç°äº†ä¸€ä¸ªäº‹æƒ…ï¼Œé‚£å°±æ˜¯dæ€»æ˜¯ä¸€ä¸ªç´ æ•°ï¼Œæ‰€ä»¥å°±å¾ˆå¥½åŠäº†ï¼Œè¦ä½¿ä¸Šå¼æˆç«‹å°±åªèƒ½ï¼š</p>
<script type="math/tex; mode=display">
x-y = 2</script><script type="math/tex; mode=display">
y + x - 1 = d</script><p>ç„¶åè§£æ–¹ç¨‹å°±å¯ä»¥å¾—åˆ°xã€yäº†â€”â€”ç„¶è€Œå‘å›å»ä¸å¯¹ã€‚</p>
<p>å½“æ—¶å¯èƒ½æ­£æ˜¯å¤œé‡Œä¸‰å››ç‚¹é’Ÿï¼Œ<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ZimaBlue">@Zima</a>çœ‹äº†è¿™é¢˜è¿‡åæ­»æ´»æ²¡çœ‹å‡ºè§£æ³•å“ªé‡Œæœ‰é—®é¢˜ï¼Œå°±å«æˆ‘æ¥ï¼›æˆ‘çœ‹äº†çœ‹ä¹Ÿæ­»æ´»æ²¡çœ‹å‡ºé—®é¢˜ï¼Œå°±æ‹‰æ¥äº†<a target="_blank" rel="noopener" href="https://yolbby.github.io/">@yolbby</a>ï¼›ç»“æœä»–ä¹Ÿæ²¡çœ‹å‡ºæ¥è§£æ³•é—®é¢˜åœ¨å“ªï¼Œä¸‰è„¸æ‡µé€¼ã€‚</p>
<p>ç¬¬äºŒå¤©æ—©ä¸Š<a target="_blank" rel="noopener" href="https://hash-hash.github.io/">@hash-hash</a>èµ·æ¥ä¹‹åå°±æŠŠä»–è§£æ‰äº†ï¼Œçœ‹äº†çœ‹æ€è·¯å‘ç°è¯´å…¶å®ä¸Šé¢çš„å¼å­è¿˜æœ‰ä¸€ä¸ªå¯èƒ½å°±æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
x-y = 1</script><script type="math/tex; mode=display">
y + x - 1 = 2d</script><p>è€Œè¿™æ ·å»è§£æ–¹ç¨‹å†å‘å›å»å°±æ­£ç¡®äº†ï¼Œåªèƒ½è¯´ä»–çš„checké€»è¾‘ä¸æ˜¯å¤ªå¯¹(ä¼°è®¡æ˜¯ç›´æ¥åˆ¤æ–­æ˜¯å¦å’Œç¬¬äºŒç§è¿™ä¸ªè§£ç›¸ç­‰)ã€‚</p>
<p><br></p>
<h3 id="Duzly-0-solves-500-pts"><a href="#Duzly-0-solves-500-pts" class="headerlink" title="Duzly(0 solves , 500 pts)"></a>Duzly(0 solves , 500 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Duzly is a straightforward hash function design based on congruence relationships over a prime number modulus.</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">m</span>):</span><br><span class="line">	m += <span class="string">b&#x27;\x8f&#x27;</span> * (<span class="number">8</span> - <span class="built_in">len</span>(m) % <span class="number">8</span>)</span><br><span class="line">	<span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">duzly</span>(<span class="params">m, C</span>):</span><br><span class="line">	ow, E = <span class="number">0</span>, [<span class="number">2</span>**<span class="number">24</span> + <span class="number">17</span>, <span class="number">2</span>**<span class="number">24</span> + <span class="number">3</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line">	<span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">		ow += C[_] * <span class="built_in">pow</span>(m, E[_], p)</span><br><span class="line">	<span class="keyword">return</span> ow % p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pashan</span>(<span class="params">msg</span>):</span><br><span class="line">	msg = pad(msg)</span><br><span class="line">	pash, msg = <span class="string">b&#x27;&#x27;</span>, [msg[<span class="number">8</span>*i:<span class="number">8</span>*(i+<span class="number">1</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(msg) // <span class="number">8</span>)]</span><br><span class="line">	<span class="keyword">for</span> m <span class="keyword">in</span> msg:</span><br><span class="line">		_h = duzly(bytes_to_long(m), C).to_bytes(<span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">		pash += _h</span><br><span class="line">	<span class="keyword">return</span> pash</span><br><span class="line"></span><br><span class="line">p = <span class="number">2</span>**<span class="number">64</span> - <span class="number">59</span></span><br><span class="line">C = [<span class="number">1</span>] + [randint(<span class="number">0</span>, p) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]</span><br><span class="line">flag = urandom(getRandomRange(<span class="number">0</span>, <span class="number">110</span>)) + flag + urandom(getRandomRange(<span class="number">0</span>, <span class="number">110</span>))</span><br><span class="line">_pash = pashan(flag)</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;_pash_updated&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(C).encode() + <span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">f.write(_pash)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ä¸é•¿ï¼Œä½†æ˜¯å¤Ÿç‹ ã€‚åŠ å¯†æµç¨‹ä¸ºï¼š</p>
<ul>
<li><p>ç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º6çš„éšæœºåˆ—è¡¨Cï¼Œç¬¬ä¸€ä¸ªå€¼æ˜¯1ï¼Œå…¶ä»–å‡ä¸º0-pçš„éšæœºæ•°</p>
</li>
<li><p>å°†flagé¦–ä½è¿›è¡Œä¸¤æ®µé•¿åº¦æœªçŸ¥çš„éšæœºå¡«å……</p>
</li>
<li><p>å°†flagåˆ‡åˆ†ä¸ºé•¿åº¦ä¸º8çš„å¤šä¸ªåˆ†ç»„</p>
</li>
<li><p>å¯¹æ¯ä¸ªåˆ†ç»„miï¼Œè¿›è¡Œå¦‚ä¸‹åŠ å¯†å¾—åˆ°å¯¹åº”å¯†æ–‡ciï¼š</p>
<script type="math/tex; mode=display">
c_i = C_0m_i^{2^{24}+17} + C_1m_i^{2^{24}+3} + C_2m_i^{3} + C_3m_i^{2} + C_4m_i^{1} + C_5m_i^{0} \quad(mod \; p)</script></li>
</ul>
<p>ç”±äºupdateé‡Œç»™å‡ºäº†Cï¼Œæ‰€ä»¥è¿™å…¶å®æ˜¯ä¸€ä¸ªå…³äºmiçš„å•å˜é‡æ–¹ç¨‹ï¼Œæ‰€ä»¥è‡ªç„¶æƒ³åˆ°ç›´æ¥æ±‚æ ¹ï¼Œç„¶è€Œè¿™ä¸ªå¤šé¡¹å¼åº¦æ˜¯$2^{24}+17$ï¼Œå®åœ¨å¤ªå¤§äº†ï¼Œæ ¹æœ¬å»ºä¸å‡ºæ¥ï¼Œæ‰€ä»¥è¦æƒ³ä¸‹æ€ä¹ˆé™æ¬¡ã€‚ä½†æ˜¯æ¨¡æ•°pæ˜¯ä¸€ä¸ªéå¸¸æ­£å¸¸çš„ç´ æ•°(ä¹Ÿå°±æ˜¯longlongå‹çš„æœ€å¤§ç´ æ•°)ï¼Œ2^24è™½ç„¶å¤§ï¼Œä½†å®Œå…¨ä¸ä¼šæ˜¯æŸä¸ªå…ƒç´ çš„é˜¶ï¼Œæ‰€ä»¥æ¶ˆä¸æ‰ã€‚</p>
<p>ä¸€ç­¹è«å±•çš„æ—¶å€™æƒ³äº†ç‚¹æ­ªç‚¹å­ï¼Œé¦–å…ˆå¯ä»¥çŸ¥é“ï¼Œflagè™½ç„¶åœ¨é¦–å°¾è¿›è¡Œäº†å¡«å……ï¼Œä½†æ˜¯â€CCTF{â€œè¿™äº”ä¸ªå­—ç¬¦ä»ç„¶ä¸€å®šåœ¨é‡Œé¢ã€‚åˆå› ä¸ºå…«ä¸ªå­—ç¬¦å…«ä¸ªå­—ç¬¦åˆ†äº†ç»„ï¼Œæ‰€ä»¥è¿™ä¸ªflagå¤´å¯èƒ½æœ‰å¦‚ä¸‹å…«ç§åˆ‡åˆ†æ–¹å¼ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CCTF&#123; + YYY</span><br><span class="line">X + CCTF&#123; + YY</span><br><span class="line">XX + CCTF&#123; + Y</span><br><span class="line">XXX + CCTF&#123;</span><br><span class="line">XXXX + CCTF | &#123; + YYYYYYY</span><br><span class="line">XXXXX + CCT | F&#123; + YYYYYY</span><br><span class="line">XXXXXX + CC | TF&#123; + YYYYY</span><br><span class="line">XXXXXXX + C | CTF&#123; + YYYY</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼ŒXä»£è¡¨çº¯éšæœºå­—ç¬¦ï¼ŒYä»£è¡¨å¯è§å­—ç¬¦ã€‚å¯ä»¥çœ‹å‡ºï¼Œå…«ç§æƒ…å†µä¸­ï¼Œåªæœ‰5ã€6ä¸¤ç»„å¤æ‚åº¦ç¨å¤§ï¼Œå…¶ä»–çš„æƒ…å†µå¤æ‚åº¦éƒ½ä¸ç®—ç‰¹åˆ«é«˜ï¼Œå¯ä»¥è¿›è¡Œçˆ†ç ´ã€‚è€ŒæœŸæœ›æ˜¯è¿™æ ·ï¼šå¦‚æœå¾—åˆ°äº†æ­£ç¡®çš„flagå¤´çš„å†…å®¹ï¼Œæ¯”å¦‚â€CCTF{i_loâ€è¿™ç§ï¼Œå°±å¯ä»¥åˆç†çŒœæµ‹ä¸‹ä¸€ä¸ªåˆ†ç»„çš„æ˜¯veå¼€å¤´ï¼Œä»è€Œè¿è’™å¸¦çŒœå¾€åä¸€ä¸ªåˆ†ç»„ä¸€ä¸ªåˆ†ç»„çˆ†ã€‚</p>
<p>ç„¶è€Œäº‹ä¸æ„¿è¿ï¼Œæˆ‘ä¸€å¼€å§‹å¯†æ–‡è¯»å–æ–¹å¼é”™äº†ï¼Œå¯¼è‡´zimaå¸ˆå‚…å†™çš„c++çš„å¤šè¿›ç¨‹çˆ†ç ´å®Œå…¨å°±æ²¡ç”¨å¯¹æ•°æ®ï¼Œè‡ªç„¶ä¹Ÿæ²¡ç»“æœã€‚æ—¶é—´åˆå¾ˆç´§å¼ ï¼Œæ‰€ä»¥æœ€åæ²¡æœ‰æå‡ºæ¥flagå¤´ï¼Œè‡ªç„¶ä¹Ÿå°±ä¸å­˜åœ¨å¾€åçš„è¿è’™å¸¦çŒœäº†ã€‚</p>
<p>èµ›åçœ‹discordçš„è®¨è®ºï¼Œçªç„¶ååº”è¿‡æ¥æ­£è§£åº”è¯¥æ€ä¹ˆåšã€‚é¦–å…ˆå¯¹äºä¸Šé¢çš„ciï¼Œå¯ä»¥æŠŠå®ƒçœ‹æˆä¸€ä¸ªä»¥miä¸ºæ ¹çš„å¤šé¡¹å¼ï¼š</p>
<script type="math/tex; mode=display">
f = C_0x^{2^{24}+17} + C_1x^{2^{24}+3} + C_2x^{3} + C_3x^{2} + C_4x^{1} + C_5x^{0} - c_i\quad(mod \; p)</script><p>è€Œåœ¨æ¨¡pä¸‹å¤©ç„¶æœ‰ä¸€ä¸ªä»¥miä¸ºæ ¹çš„å¤šé¡¹å¼ï¼š</p>
<script type="math/tex; mode=display">
g = x^{p-1} - 1</script><p>æ‰€ä»¥å¦‚æœæ±‚è§£ä¸¤è€…çš„gcdå°±ä¼šå¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
gcd(f,g) = x - m_i</script><p>å°±æœ‰miäº†ã€‚</p>
<p>ä½†æ˜¯ï¼Œfã€gçš„æ¬¡æ•°å¤ªå¤§ä»ç„¶æ˜¯ä¸ªé—®é¢˜ï¼Œå¯¹äºè¿™ä¸€ç‚¹çš„å¤„ç†å’Œæˆ‘åœ¨NSSCTFçš„dlcå‡ºçš„ä¸€é“<a target="_blank" rel="noopener" href="https://www.nssctf.cn/problem/5457">Franklin</a>æœ‰ç‚¹ç±»ä¼¼ã€‚ç”±äºfçš„æ¬¡æ•°è¾ƒä½ï¼Œæ‰€ä»¥å¯ä»¥ç”¨fåšå•†ç¯ï¼Œå°†gä¸€æ­¥ä¸€æ­¥liftä¸Šå»ï¼Œä¹‹åå†ç”¨HGCDæ±‚å‡ºä¸¤è€…çš„å…¬å› å¼ï¼Œè€Œåœ¨å•†ç¯ä¸Šliftçš„è¿‡ç¨‹sageå†…éƒ¨æ˜¯æœ‰å®ç°çš„ã€‚</p>
<p>ç„¶è€Œï¼Œ2^24è¿™ä¸ªæ•°é‡çº§å¥½åƒåˆšå¥½è¶…è¿‡äº†sageèƒ½å¤„ç†çš„æ¬¡æ•°ä¸Šé™ï¼Œæ‰€ä»¥æ²¡æ³•ç›´æ¥åšï¼Œå¹¶ä¸”ç”±äºæœ‰å¤šä¸ªåˆ†ç»„éƒ½è¦è¿™ä¹ˆå¤„ç†ï¼Œæ‰€ä»¥å¯èƒ½è¦è‡ªå·±ç”¨c++æ‰‹åŠ¨å†™ä¸ªå¤šé¡¹å¼çš„liftï¼Œå¹¶ä¸”ç”¨æ›´å¤§å†…å­˜çš„æœºå™¨æ¥è·‘æ‰è¡Œã€‚</p>
<p>è¦æˆ‘å†™è¿™ä¸ªçš„è¯ï¼Œæˆ‘çŸ­æ—¶é—´æ˜¯è‚¯å®šæ†‹ä¸å‡ºæ¥çš„ï¼Œä½†æ˜¯å¦‚æœèµ›ä¸­æ—©ç‚¹æƒ³åˆ°è¿™ä¸ªæ€è·¯ï¼Œç„¶åäº¤ç»™<a target="_blank" rel="noopener" href="https://wleukocytec.github.io/">@leukocyte</a>æ„Ÿè§‰è‚¯å®šèƒ½å†™ï¼Œè¿˜æ˜¯æœ‰ç‚¹å¯æƒœï¼Œè‡ªå·±å‡ºè¿‡çš„ç±»ä¼¼é¢˜æ²¡æœ‰è”æƒ³ä¸Šã€‚</p>
<p><br></p>
<h3 id="Forghan-36-solves-119-pts"><a href="#Forghan-36-solves-119-pts" class="headerlink" title="Forghan(36 solves , 119 pts)"></a>Forghan(36 solves , 119 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The Forghan, the combination of RSA and DLP cryptography, may in certain instances prove more accessible than employing either method individually.</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">die</span>(<span class="params">*args</span>):</span><br><span class="line">	pr(*args)</span><br><span class="line">	quit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pr</span>(<span class="params">*args</span>):</span><br><span class="line">	s = <span class="string">&quot; &quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, args))</span><br><span class="line">	sys.stdout.write(s + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">	sys.stdout.flush()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sc</span>():</span><br><span class="line">	<span class="keyword">return</span> sys.stdin.buffer.readline()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_gen</span>(<span class="params">p</span>):</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		g = getRandomRange(<span class="number">2</span>, p - <span class="number">1</span>)</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">pow</span>(g, (p-<span class="number">1</span>)//<span class="number">2</span> , p) != <span class="number">1</span>:</span><br><span class="line">			<span class="keyword">return</span> g</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">	border = <span class="string">&quot;â”ƒ&quot;</span></span><br><span class="line">	pr(        <span class="string">&quot;â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“&quot;</span>)</span><br><span class="line">	pr(border, <span class="string">&quot;Hi all, now it&#x27;s time to solve a strange and unusual RSA and DLP    &quot;</span>, border)</span><br><span class="line">	pr(border, <span class="string">&quot;challenge about encryption! Follow the questions and find the secret&quot;</span>, border)</span><br><span class="line">	pr(border, <span class="string">&quot;flag! :)                                                            &quot;</span>, border)</span><br><span class="line">	pr(        <span class="string">&quot;â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›&quot;</span>)</span><br><span class="line">	nbit, b = <span class="number">256</span>, <span class="literal">False</span></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		pr(<span class="string">f&quot;| Options: \n|\t[G]et encrypted flag \n|\t[P]ublic parameters \n|\t[S]ubmit <span class="subst">&#123;nbit&#125;</span> primes \n|\t[Q]uit&quot;</span>)</span><br><span class="line">		ans = sc().decode().lower().strip()</span><br><span class="line">		<span class="keyword">if</span> ans == <span class="string">&#x27;g&#x27;</span>:</span><br><span class="line">			<span class="keyword">if</span> b == <span class="literal">True</span>:</span><br><span class="line">				l, n = <span class="built_in">len</span>(flag), (p**<span class="number">2</span> - <span class="number">1</span>) * (q**<span class="number">2</span> - <span class="number">1</span>)</span><br><span class="line">				gp, gq = find_gen(p), find_gen(q)</span><br><span class="line">				sp, sq = getRandomRange(<span class="number">1</span>, p), getRandomRange(<span class="number">1</span>, q)</span><br><span class="line">				flagp, flagq = flag[:l // <span class="number">2</span>], flag[l // <span class="number">2</span>:]</span><br><span class="line">				yp, yq = <span class="built_in">pow</span>(gp, sp, p), <span class="built_in">pow</span>(gq, sq, q)</span><br><span class="line">				cp, cq = <span class="built_in">pow</span>(bytes_to_long(flagp), yp, n), <span class="built_in">pow</span>(bytes_to_long(flagq), yq, n)</span><br><span class="line">				pr(border, <span class="string">f&#x27;cp = <span class="subst">&#123;cp&#125;</span>&#x27;</span>)</span><br><span class="line">				pr(border, <span class="string">f&#x27;cq = <span class="subst">&#123;cq&#125;</span>&#x27;</span>)</span><br><span class="line">			<span class="keyword">else</span>: pr(border, <span class="string">&#x27;Please first send your primes! :P&#x27;</span>)</span><br><span class="line">		<span class="keyword">elif</span> ans == <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">			pr(border, <span class="string">&#x27;Send your desired prime numbers separated by comma: &#x27;</span>)</span><br><span class="line">			P = sc()</span><br><span class="line">			<span class="keyword">try</span>:</span><br><span class="line">				p, q = P.split(<span class="string">b&#x27;,&#x27;</span>)</span><br><span class="line">				p, q = <span class="built_in">int</span>(p), <span class="built_in">int</span>(q)</span><br><span class="line">			<span class="keyword">except</span>: die(border, <span class="string">&#x27;Your input are not integer! Bye!!&#x27;</span>)</span><br><span class="line">			<span class="keyword">if</span> p != q <span class="keyword">and</span> isPrime(p) <span class="keyword">and</span> isPrime(q) <span class="keyword">and</span> p.bit_length() == q.bit_length() == nbit:</span><br><span class="line">				b = <span class="literal">True</span></span><br><span class="line">				pr(border, <span class="string">&#x27;Now you can get the encrypted flag in main menu!&#x27;</span>)</span><br><span class="line">			<span class="keyword">else</span>: die(border, <span class="string">&#x27;Sorry, your integers are not valid :/&#x27;</span>)</span><br><span class="line">		<span class="keyword">elif</span> ans == <span class="string">&#x27;p&#x27;</span>:</span><br><span class="line">			<span class="keyword">if</span> b == <span class="literal">True</span>:</span><br><span class="line">				pr(border, <span class="string">f&#x27; gp = <span class="subst">&#123;gp&#125;</span>&#x27;</span>)</span><br><span class="line">				pr(border, <span class="string">f&#x27; gq = <span class="subst">&#123;gq&#125;</span>&#x27;</span>)</span><br><span class="line">				pr(border, <span class="string">f&#x27; yp = <span class="subst">&#123;yp&#125;</span>&#x27;</span>)</span><br><span class="line">				pr(border, <span class="string">f&#x27; yq = <span class="subst">&#123;yq&#125;</span>&#x27;</span>)</span><br><span class="line">			<span class="keyword">else</span>: pr(border, <span class="string">&#x27;Please first send your primes! :P&#x27;</span>)</span><br><span class="line">		<span class="keyword">elif</span> ans == <span class="string">&#x27;q&#x27;</span>:</span><br><span class="line">			die(border, <span class="string">&#x27;Quitting...&#x27;</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			die(border, <span class="string">&#x27;You should select valid choice!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®æœ‰ä¸‰ä¸ªé€‰é¡¹ï¼Œä½†æ˜¯æ˜¾ç„¶æ˜¯æœ‰é¡ºåºçš„ï¼Œå…·ä½“æ¥è¯´åº”è¯¥æŒ‰ç…§ä¸‹é¢æ¥ï¼š</p>
<ul>
<li>é€‰æ‹©â€Sâ€ï¼Œå¯ä»¥è¾“å…¥256bitçš„ç´ æ•°pã€q</li>
<li>é€‰æ‹©â€Gâ€ï¼Œé¶æœºå¯¹flagè¿›è¡ŒåŠ å¯†ï¼ŒåŠ å¯†æµç¨‹å¦‚ä¸‹ï¼š</li>
<li><ul>
<li>ç”Ÿæˆnï¼Œ$n = (p^2-1)(q^2-1)$</li>
<li>åˆ†åˆ«ç”Ÿæˆpã€qä¸‹çš„ä¸€ä¸ªéšæœºäºŒæ¬¡éå‰©ä½™gpã€gq</li>
<li>ç”Ÿæˆpã€qä¸‹çš„éšæœºæ•°spã€sq</li>
<li>å°†flagåˆ†ä¸ºä¸¤æ®µï¼Œè®°ä¸ºflagpã€flagqï¼Œå¯¹åº”æ•°å­—è®°ä¸ºmpã€mq</li>
<li>è®¡ç®—ypã€yqï¼Œ$y_p = g_p^{s_p}\quad(mod\;p) , y_q = g_q^{s_q}\quad(mod\;q)$</li>
<li>è®¡ç®—å¯†æ–‡cpã€cqï¼Œ$c_p = m_p^{y_p}\quad(mod\;n) , c_q = m_q^{y_q}\quad(mod\;n)$</li>
</ul>
</li>
<li><p>é€‰æ‹©â€Pâ€ï¼Œå¯ä»¥æ‹¿åˆ°gpã€gqã€ypã€yqçš„å€¼</p>
</li>
</ul>
<p>ç”±äºæœ‰ypã€yqï¼Œæ‰€ä»¥å¯¹äºå¯†æ–‡æœ€åä¸€æ­¥çš„è®¡ç®—æ¥è¯´ï¼Œå…¶å®å°±ç›¸å½“äºè§£ä¸€ä¸ªRSAï¼Œåªæ˜¯æ¨¡æ•°nå˜æˆäº†ï¼š</p>
<script type="math/tex; mode=display">
n = (p+1)(p-1)(q+1)(q-1)</script><p>ç”±äºflagæ˜¯é™æ€çš„ï¼Œæ‰€ä»¥å®Œå…¨å¯ä»¥æ”¾åœ¨ä¸€ä¸ªå­ç¾¤é‡Œå»æ±‚è§£ï¼Œæ¯”å¦‚æ”¾åœ¨æ¨¡p-1ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
c_p = m_p^{y_p}\quad(mod\;p-1)</script><script type="math/tex; mode=display">
c_q = m_q^{y_q}\quad(mod\;p-1)</script><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦çŸ¥é“p-1çš„åˆ†è§£ï¼Œå°±å¯ä»¥æ±‚phi(p-1)ï¼Œç„¶åå°±å¯ä»¥è§£RSAè§£å‡ºmpã€mqåœ¨p-1ä¸‹çš„å€¼ï¼Œåˆç”±äºflagæ˜¯é™æ€çš„ï¼Œæ‰€ä»¥äº¤äº’å¤šæ¬¡æ±‚crtï¼Œå°±èƒ½å¾—åˆ°flagçš„å®Œæ•´å€¼ã€‚è€Œpã€qéƒ½æ˜¯è‡ªå·±æ„é€ çš„ï¼Œæ‰€ä»¥æƒ³æ»¡è¶³p-1èƒ½åˆ†è§£å¤ªå®¹æ˜“äº†ï¼Œæ¯”å¦‚æœ€ç®€å•çš„æƒ…å†µå°±æ„é€ ï¼š</p>
<script type="math/tex; mode=display">
p = 2k + 1</script><p>ä»¤kæ˜¯ä¸€ä¸ªç´ æ•°ï¼Œå°±æœ‰ï¼š</p>
<script type="math/tex; mode=display">
\phi(p-1) = k - 1</script><p>ä¹‹åçš„æ±‚è§£å°±å¾ˆå®¹æ˜“ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&quot;00.cr.yp.toc.tf&quot;</span>, <span class="string">&quot;13337&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_prime</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = getPrime(<span class="number">255</span>)</span><br><span class="line">        <span class="keyword">if</span> isPrime(<span class="number">2</span>*p+<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span>*p+<span class="number">1</span></span><br><span class="line"></span><br><span class="line">nums = <span class="number">10</span></span><br><span class="line">P = [gen_prime() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nums)]</span><br><span class="line">mp = []</span><br><span class="line">mq = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nums):</span><br><span class="line">    sh.sendline(<span class="string">b&quot;s&quot;</span>)</span><br><span class="line">    sh.recvline(<span class="string">b&#x27;Send your desired prime numbers separated by comma: &#x27;</span>)</span><br><span class="line">    q = getPrime(<span class="number">256</span>)</span><br><span class="line">    sh.sendline((<span class="built_in">str</span>(P[i])+<span class="string">&#x27;,&#x27;</span>+<span class="built_in">str</span>(q).encode()))</span><br><span class="line"></span><br><span class="line">    sh.sendline(<span class="string">b&quot;g&quot;</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">&quot;cp = &quot;</span>)</span><br><span class="line">    cp = <span class="built_in">int</span>(sh.recvline().strip().decode())</span><br><span class="line">    sh.recvuntil(<span class="string">&quot;cq = &quot;</span>)</span><br><span class="line">    cq = <span class="built_in">int</span>(sh.recvline().strip().decode())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    sh.sendline(<span class="string">b&quot;p&quot;</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">&quot;gp = &quot;</span>)</span><br><span class="line">    gp = <span class="built_in">int</span>(sh.recvline().strip().decode())</span><br><span class="line">    sh.recvuntil(<span class="string">&quot;gq = &quot;</span>)</span><br><span class="line">    gq = <span class="built_in">int</span>(sh.recvline().strip().decode())</span><br><span class="line">    sh.recvuntil(<span class="string">&quot;yp = &quot;</span>)</span><br><span class="line">    yp = <span class="built_in">int</span>(sh.recvline().strip().decode())</span><br><span class="line">    sh.recvuntil(<span class="string">&quot;yq = &quot;</span>)</span><br><span class="line">    yq = <span class="built_in">int</span>(sh.recvline().strip().decode())</span><br><span class="line"></span><br><span class="line">    k = (P[i] - <span class="number">1</span>) // <span class="number">2</span></span><br><span class="line">    mp.append(<span class="built_in">pow</span>(cp,inverse(yp,k-<span class="number">1</span>),P[i]))</span><br><span class="line">    mq.append(<span class="built_in">pow</span>(cq,inverse(yq,k-<span class="number">1</span>),P[i]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mp = crt(P,mp)[<span class="number">0</span>]</span><br><span class="line">Mq = crt(P,mq)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(Mp))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(Mq))</span><br></pre></td></tr></table></figure>
<p>å¦‚æœè¿™é¢˜éœ€è¦ç”¨åˆ°DLPçš„è¯ï¼Œé‚£æ„é€ p-1å…‰æ»‘åº”è¯¥æ˜¯å¥½ç‚¹ï¼Œç„¶è€Œspã€sqå®Œå…¨ç”¨ä¸åˆ°ï¼Œæ‰€ä»¥ä¸ç”¨è€ƒè™‘ã€‚</p>
<p><br></p>
<h3 id="Honey-48-solves-95-pts"><a href="#Honey-48-solves-95-pts" class="headerlink" title="Honey(48 solves , 95 pts)"></a>Honey(48 solves , 95 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Honey is a concealed cryptographic algorithm designed to provide secure encryption for sensitive messages.</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> sqrt</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_params</span>(<span class="params">nbit</span>):</span><br><span class="line">	p, Q, R, S = getPrime(nbit), [], [], []</span><br><span class="line">	d = <span class="built_in">int</span>(sqrt(nbit &lt;&lt; <span class="number">1</span>))</span><br><span class="line">	<span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(d):</span><br><span class="line">		Q.append(getRandomRange(<span class="number">1</span>, p - <span class="number">1</span>))</span><br><span class="line">		R.append(getRandomRange(<span class="number">0</span>, p - <span class="number">1</span>))</span><br><span class="line">		S.append(getRandomRange(<span class="number">0</span>, p - <span class="number">1</span>))</span><br><span class="line">	<span class="keyword">return</span> p, Q, R, S</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m, params</span>):</span><br><span class="line">	p, Q, R, S = params</span><br><span class="line">	<span class="keyword">assert</span> m &lt; p</span><br><span class="line">	d = <span class="built_in">int</span>(sqrt(p.bit_length() &lt;&lt; <span class="number">1</span>))</span><br><span class="line">	C = []</span><br><span class="line">	<span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(d):</span><br><span class="line">		r, s = [getRandomNBitInteger(d) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&#x27;01&#x27;</span>]</span><br><span class="line">		c = Q[_] * m + r * R[_] + s * S[_]</span><br><span class="line">		C.append(c % p)</span><br><span class="line">	<span class="keyword">return</span> C</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nbit = <span class="number">512</span></span><br><span class="line">params = gen_params(<span class="number">512</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">C = encrypt(m, params)</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;params_enc.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(<span class="string">f&#x27;p = <span class="subst">&#123;params[<span class="number">0</span>]&#125;</span>\n&#x27;</span>)</span><br><span class="line">f.write(<span class="string">f&#x27;Q = <span class="subst">&#123;params[<span class="number">1</span>]&#125;</span>\n&#x27;</span>)</span><br><span class="line">f.write(<span class="string">f&#x27;R = <span class="subst">&#123;params[<span class="number">2</span>]&#125;</span>\n&#x27;</span>)</span><br><span class="line">f.write(<span class="string">f&#x27;S = <span class="subst">&#123;params[<span class="number">3</span>]&#125;</span>\n&#x27;</span>)</span><br><span class="line">f.write(<span class="string">f&#x27;C = <span class="subst">&#123;C&#125;</span>&#x27;</span>)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
<p>params_enc.txtï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">10580731215444436219213907263947534038012197972307836319229421193761088798378768844649759133142120180834573817149711299466707823017636232456526471274387917</span></span><br><span class="line">Q = [<span class="number">6718668664591596190749745980002066645380242844394957953766947533978323053938214647829798301606252456858132121628517723050462291300790766055200866765561610</span>, <span class="number">8738840830394886495658505803088103824478963010774845789433253508554356383249611502157307334585157729703873877797759121271071421201959116272886732798936523</span>, <span class="number">4388762712805764363921857352899834586382140923234814556069490536704913653848525595836491615636446563386705915348021173847271741862809075809151508973332816</span>, <span class="number">3663706247989213864330218414789109172658418861584264092087052781618522795676355371739296186667918464732397854703792563460353675590182379535358561615166754</span>, <span class="number">10397730940373180549512945920847346184926672474430866208628825035104473525758952069910968144296138220861205803231072660136999110567752870928953292888013817</span>, <span class="number">7950983396364741732874562189206547723862955251595526752956177377987683115942827501152009639962778147887569469649852864894630521759276627026901168996371682</span>, <span class="number">4533165373271154956275563812280832107592547920299130443910706773435844651231402604986107252454770256826684895729900344877444002682896222483157835711226276</span>, <span class="number">234527648838985018479849393379369972316648524004050156622962478277970628212208049885578895953447529009579881605066831810617219492342569126524704457098602</span>, <span class="number">870946394610707169333783318085559836426827503011955242395779894700298192587685130680102208909573921059078858816359885827349281892186755920839352494224983</span>, <span class="number">5025393101560564396356619431938053414422489109406396725377683594254768077793838379117179092536396259414266971990125716674162127500490058572594571364978294</span>, <span class="number">5914192169617888877888201158713062853387719050723973971874176184801960297380845845091259990664210178355882621876155306106794686897854891414999449337977781</span>, <span class="number">2315609284318723939818174971181608382568372323836754133265010413836452399043354382657889810068171230196496294710150903020084150025606782486579490225752163</span>, <span class="number">7278167622527482910919537896950398911672667355929695202886784227621290914468002099686668156909569183497765732237075799745632960354306268680765408194219074</span>, <span class="number">3334584846711780119716613440720851482199838919351927489954344426327712973616885459737471991960238971274273643566666607141850753561424427088261862873317161</span>, <span class="number">10418397794302836806813296591826255845845380563102199636140458670781241436466478273414138749593148481207713557016996462238845705251702717702279222414513227</span>, <span class="number">8928267741189301140931758366885435860144549752680480164627323600501278650103818630920534258909582593266779000356145650416276415560226176904904552964196921</span>, <span class="number">3371514716248416335324237152123624115597170761078576760713238311485522010416246207731778456501311675041827750001670698984335573888627309609534659722697174</span>, <span class="number">3802217515688979225517388823688564230191961273039428065604146662684362686419670392762755984078261072614619934671572327384351597903233780846163893180876244</span>, <span class="number">2363399549320749312563257796730356164186914867645487733176402567625567991193120859507532138374793392237469893062402307645814490930874653088116729203724851</span>, <span class="number">10221767730316631512882371487958453352895713655492241322139865275323706929127996334620105099751973217983332705204535216804829987329684674632121801754529472</span>, <span class="number">2309440702968799222696132507585555901684240893289264193546892279919675495689944211715270510347394465285317239758024734161176699837687742722383530547735726</span>, <span class="number">5768185970426887633783322939933762164095055854707759575404348181421158843802654199133776622565384843677610666356549368021172121302926969754865633752131083</span>, <span class="number">3229518654067354667224244723968136366109210341994628338992752927462431316675552817799465987425719486448276862390918033544772400219803600904202906882850710</span>, <span class="number">9261930571620802581580992489567043178258044978932724785185749415955521702331959591680386023118398455066896674799447994060060156036800986190467008880726445</span>, <span class="number">2202162000802916921896507108984564185119471354726317829850206292755815439071735424116041491064894922930900262540589602333676063925873357256494020426758849</span>, <span class="number">1449198886322850923273373987785167865779477069790726992542423846556138762913056524689998313112599261515223680429584445016474216381861998363527368722991846</span>, <span class="number">8372052560034461177472546395510480308837387803551378399004608402463282066003862653368875671946863748209051044725913651881213858335224750549176875818647614</span>, <span class="number">1554572177534183877889322947083536921680809086638640689433294150868422460719624621258231995856944045776876555664816113444481761122803489100212103150005950</span>, <span class="number">10304720995101153898600333216365877709018991122985401884049110267116778080162237155472336396606109372189653686733770775660895990549286854727042270667997449</span>, <span class="number">9702831715765050072649082617719386580543641764650576307262259428035281535816750758018451681417440458250169771442858047124693499821240155899358663466925522</span>, <span class="number">4983986466837077050816175727911146971276599399191126236666755181304580074902883995859030897874305902445659355326021836801836996577665092276845357389900055</span>, <span class="number">983210432268706135181772492997088637756153310076409721616450343187239073604891492532080986521255675448499887782529162112441952861587689660048849369850769</span>]</span><br><span class="line">R = [<span class="number">8922553268219903948421811612403588317187402276064169063400419617931637566221670948925221403527928336656976084021780421068421112325215152715630319708159148</span>, <span class="number">1960697234007608888633325436691320507012497445090151112947144246088597317322303593936974554881161091213718329061011703885436579261559669838148253146762736</span>, <span class="number">5876944865176517279136475269375710514719489457672467542904948332791352244229042691977616905122711469012731652511966060550749288338599104284986451669586397</span>, <span class="number">10560136356360422684127995001096871178761635291417665630629868184624616925939841693017240341233504589896610287855672892399213367967385666891688408976236926</span>, <span class="number">477096251733995832965266836067676961413182629438628989729801411920869543083075545758386996801847267554704996660190900105380190625423846876906822024677634</span>, <span class="number">7001514955678391252130680521301315254365131738168087539892724691183104608345983375763663321467662055864103520121513349630333839818372656472731157470876337</span>, <span class="number">3894488356665934776074291789545516608573077899099880057920210752197885106521699021123658077208789295954145485399473386424677782787720074605813565437678385</span>, <span class="number">6084641463140385894120457093933350076091808742065950836200598466936433741373700151235571333073965513559605688011967994215074945374832957951384088589789549</span>, <span class="number">6429023674027239778212676334778900557043774851747196071499704016422574667955121145943674677254291410204037372996870181094090300709994594837656541352954321</span>, <span class="number">974464046378184190666336249935678253753198649184272269465353741281529523364289314148552833155935080422698020734516538377662137879089845095565536185765703</span>, <span class="number">5275384626572520577089146723078373110279682903874445477027602487061203157331398955233780208890725281673434536867800450553737656852356536771518379108118530</span>, <span class="number">7195767683001605593626199889963767438584070902169912442665828755648712278523740276132000225353756257232761885567134364203207306842108602537457408438487869</span>, <span class="number">1960155276835684836483043402384876176138942980630724993481564836712252228823186653467973806509964860286129730847244573674203959835565358735171611743573721</span>, <span class="number">6414607819273473402861616605113355396690170400984793217629732347141796693554056264547151212348354332930126795040213921009711560216969452391748438893237750</span>, <span class="number">3344964019305423035551401397282638905496921053458747459062023331678484337724980196690184898986671355848101101352105363764794975082772539709853216580762130</span>, <span class="number">5599385562588302350377616767130563945375472947459594912838322011021483641484084692396462025157944023828872267520122213089523093591160284337483108416804096</span>, <span class="number">9490045098551912983475126253859124028793327975874647810947095579199208473971726763051464010595903748080632329362605820021188148160826282120484098519748832</span>, <span class="number">980400922804123638777377509067942595214234592161404114303498013065244168965487370334832921426484278913774963761155003569793282819717667783351454812080994</span>, <span class="number">2772369382727364487748752144766350276094463435156818133766210304998890765120785013435379746537938377688617479112518505844159436213691418873590807740501183</span>, <span class="number">2338271137215119073302625621754099128003710500967811947590498668688826448575898279561111743087002717955161536157254689000474464404087443266193145449601031</span>, <span class="number">11773104862539842923315548180471993854469651503131148446111338098437913152663007837927793233931818835121946274135336436554801339749906320765919816150768</span>, <span class="number">7022131435585860015767289025786078578929344550873832550705723505006303288639135070849692494020122369694090619694760175970759059981608871097298624956669246</span>, <span class="number">9062158671807923729547552523768819638817707994079942965412925347441853183471973898478745711676153003756450481351777543455041815438536630317647408008349357</span>, <span class="number">641428039466528875429106458292463262780539744201857515833377175893334510962304373010401729801987725599439620073783868719664061882399367340158128062151780</span>, <span class="number">9636846145225909579086917154824161374486916920345217833190333031690359415616710658317308376119096253360425924297858397657697468296746934075225665559206030</span>, <span class="number">480796179229094678008918831581475398488769027287954488301969143979307355466114726392701279092691566949082439457297527772794149828193400419285116237063338</span>, <span class="number">7726757640854263742178678415761753342099387727318458723726925176786999799204056696883433346568600944559959849253863013300907357120126559055735593380638961</span>, <span class="number">551534415366550033034654093228329954588738781407008585088422737955391043381667720876717529438845777841508116853874405455280903517864352822604194884203656</span>, <span class="number">2135598634800053933515509095633720732412542790075717247869348997292949946344227105219967710854885153055617943193159899627517699960920415492992774438014041</span>, <span class="number">1680242449902645450228202409049382139482100876672724104665964994414865664877710770701122475977142858601068246748276652246938681740022531970523695731126206</span>, <span class="number">436320498659370791836085607479390848415464961245449366885835640616716752879866126057724425537944356751844317980881005608075886211154052092270888058429787</span>, <span class="number">4102523817041969170017113001399252035243358293719837916039521471412151711746047572340376418109842112515873700164747338421862615679590520014959369523777063</span>]</span><br><span class="line">S = [<span class="number">4389820170235953517860364281419052587762385444517203945856665517072263529411621622474249480804818285716662154444854074939122170918939074730520091008754679</span>, <span class="number">10274488321950407401790238304858775303749809597573328350457719402010568443492374388509295355784873292280254116167747959663379913408799485392015111636115272</span>, <span class="number">7413556897779783875511997253964328306011661062497568739340607424890313315434489440969977560260194970241163209968988660276109536299848001455072705137702052</span>, <span class="number">10385679419514177727801069016719283683697529805734389950368725106396939072509839502286093730172215158898251533786500497578747904349856564856054102927847131</span>, <span class="number">6386209810414906928429352824399745808560059492214757951425372272591372428785367326567204502131184260857447725722068674542931096991341451850846209503213310</span>, <span class="number">699060860182347708294712482476262878008951502586470987307146194685783850677219935862211847525612405824474382122868643521962157410369483858428437433802395</span>, <span class="number">3482063900392942412450041046839813864192488604261419419162091087116878838189062406913587662602295096636481252242577251563441565388543873530900962308450590</span>, <span class="number">5752782775722534186844731777766684686828626762801341093006843547008915880093927377014105260314050196609699164926717998841388194942556402699285523644651583</span>, <span class="number">4477944786670422304592908174461368396168580171651041832449759231077050962444090886920563302603784981035116689839335069690875797644553684152368376089740517</span>, <span class="number">5663531682848751034979876476955107364567717396957230368140915480695954150088052156264521615690161327525898382714131905580517915060427960250740110846321921</span>, <span class="number">5343294510843224726960051115907810365241970373986845465490090821566645536683695042467985025063439338770116316455211944030125820601506874250685838077414765</span>, <span class="number">8432688027895892738831218358369397874948328355540048945541749304849571948638169902486647265119397307193449002927427840453857643697175667051504836511635801</span>, <span class="number">8974418251288081645329898313903422373193272601106837017923535786950979222125740970411725976034947989767143786286397290996756916960291029965672692318584390</span>, <span class="number">3367471493907450997862234076499110882206518716388236141312548251406626961838619595519805436447472248133422979102036617759221276869918910189482246041609756</span>, <span class="number">9787518698663334219763616437865759554315749369906898604904977007297368987715422535407542350049111845605011307829034744443271718643291528381794716569586150</span>, <span class="number">7423298611637442306439453382713995476685370148677494272333567929180589186347708172471032286209947149761644993151042408431548488945145292037694546868884030</span>, <span class="number">5591656321514817104832226351286824953278894430528912246855770091334337189386156994498331013600732669813560603667226878637404391237947398475280409452591013</span>, <span class="number">6425108527382412819259579180312607504985609322110590326058191420486308943785080395001318724782575187718535133704219706236946232717333616646838328259100174</span>, <span class="number">1986072520726417425427679478185786673218113837249425820170849864471171328875606626923270664642579676457285438864056080352157246995774517812392120146048999</span>, <span class="number">5085759490547346080963649291763871068034757573012867868532204864022791365366745839456310985148663327808561601274994541505734129506831803550600738607170703</span>, <span class="number">6883330982174382523423400136207766091739299571009207949454774998664997037115272990237878573502506026799645646664956134682833693219974019271740996314084220</span>, <span class="number">3008412285222633004812698063455902388460013611944185187747762649311442328686187279186972723448077521425052318221865300502697494418867793831761784796146329</span>, <span class="number">9547325670583212399117684599284936334790443591395268814958834705867928621240882386996085347052830889322724160452729359284992294890584292625829913315628265</span>, <span class="number">1387461799657365419593288084566026147529011675413652640829187706708872066267641962620159408303872024421411747751690792902149761832079721583778430712988299</span>, <span class="number">2093635222672050417361673475374966389314266702410603863643637918543784930893405832179904330416148995313591588929177333026382745340633946128791737631559286</span>, <span class="number">8413424329301946557805781268429552577339778139904799140486659388945506980343653897206690153402822892272378378085908749995513711021119914769801970795906117</span>, <span class="number">6743445162380434316634371637355512041805280159276931422012464596435558338432827675791139455542184532473287436049595748235961499758716697674776760822162391</span>, <span class="number">1706184129470213725753097073154985919221181897433450716898208607625832464228411992900434982560203334218404626447424408012817411257665032706434306723906871</span>, <span class="number">1188503046129710474378492502021666062040985983530761819828342979325166292485440608536173516789179154601587903599847267180858095017007891547798890802090080</span>, <span class="number">6398862094282462456834873185064362330936738060688527379705123125559724680574585721467123968313071365176318010618981170019917278363707049487278610027058585</span>, <span class="number">1827205671808118170959457466922915851906256049105694256301380823860317738339383848734269783842511423911532135506082729000044271560428423457063013176002958</span>, <span class="number">4296939764995860347968082436772567300063081379392577066061720737920992283479200350022263164173968370055486217109628430523063986426005741344085155171587948</span>]</span><br><span class="line">C = [<span class="number">2312453804397990204892582347458673184184584053391181580849656202381982276483135032773767708029907426388840618138608941250788745829088238589339462137662516</span>, <span class="number">10523194306636352419831471584744199603299973937259007033119401866043123235256118686290774285411893111835433604432082195914308420845569896693674208644701928</span>, <span class="number">8625321422409900297730698589684636810222608572364004227411854906715574297306124060030713845833976664653817196364988412308992879167741430256046508164902265</span>, <span class="number">2203036357494864574281685606458518951592160562338358743010726696365683441724958156704554110208947394458113054047499157258753175446414976136008162642109757</span>, <span class="number">7440676439428237992864596387460092947449968530635365999432104198675297081825315672568959667296286389774687367936168132053293001589687795737604457160906082</span>, <span class="number">2264157050840270501520646271743213633490605461967539030408028006097728678459599299655371587125945029431528702214373899493252891890106222569122603386717360</span>, <span class="number">6089828885562252420652081197249651438359320954630388805129416420415135298321118452771481678140904854945253504361325478946359729157231808943846058944117026</span>, <span class="number">10539688120079451218718476929576210805778407047878263373562960368159158621424931104363627052374700437454925765616146962059684388174993415278124860987310938</span>, <span class="number">6303692164422236243124789748609418445914012315334563733630138248326249660310698584154622748275297380026916444293448955157206727703202478794453250926439643</span>, <span class="number">881942845076614931271891025655927553295291244201690295230440723375006916146507322259936249039275621554840488955637696630030022348109669072833863866985225</span>, <span class="number">10106348190249831893088197931090851286229747534150777530156601113972916238286905365616240501204440809598108220364456446320022747806334510176621958436096123</span>, <span class="number">8324531392881516178541244041903222514911964835924579628962940318936570586739198442236357026438613345385230182029810965182157993322744038688573053225547374</span>, <span class="number">5078708553426349749719952343873018594648548601008242439539543130067536764970709366523519348572603124221309659983256536103306454063139670063244331611755453</span>, <span class="number">8542547993117228744822361667182819410791296436924016725757178153507707272004493213120780743910507865839367749205817741703451968423781285521621014600059589</span>, <span class="number">3073352723766074586873446203285051955281142348730058300259816322651361605792426446390729367386148254808552616968786890277451301146248756651016086606742804</span>, <span class="number">5269945451683706496607356863109615383647000556701922770404180133092195426319754674753614204346587769298246334991876508268642550219392732660290378353338400</span>, <span class="number">6262348731181694593163187372863680743743096474259867989757989072530511417286900866334036812204673457159090130621478933266270029789176903023636735673595513</span>, <span class="number">3297899863181037954379261853482229450757449782777910450819629975965660022355584717412057615899333569245281976118829898854119850433763380827003244277020101</span>, <span class="number">7487260566995972228255217362172107520309457024141075543923988636564806307827017535285595701845830793533604534902349660541692391232785351590333159515799384</span>, <span class="number">10324279404125558600858330541468243667961239247663241031255287540601841176203292036413076990028875224629890818418992943759206077129550049357885152924273782</span>, <span class="number">8044925106089251438446731137002808317322635126054485149617494154471416674741758172633019611642437845768869330746423337854351186668227486117398013073824286</span>, <span class="number">4234270952814400783009242730655483882561531800274439758860142245952005010632014464198770218689605527760730047723966950012227395838571254801244673898812828</span>, <span class="number">638896609043108497262778277770178050665854883307447937008504779907661322405672174519391657570064336725509768185637608044022219246206471015980252602095129</span>, <span class="number">5180216795602211214280366461349507739255238657924206736673167715462995927060334503420979145327254053283011116720223275075476559911219732336496503542596869</span>, <span class="number">4889582376915206124736222022750168286228699065224704085027955184917144323557844593386817223260498520607466742269645929630472738644444652704289510157100913</span>, <span class="number">5012604326308554636339480431591200785633930724891396744558818436357664982175033998281443810436271724799610836412819040278374041390604150781759163613994682</span>, <span class="number">3219038638665180576932584279254771209098300305384572525709292133614238552451580810601286362213655499134538083785424726484119059950676285763438331520089227</span>, <span class="number">6419694420004223063062285264931096360778228156157853232796125041025067958687740255716444718822744614217377927689465894996156144384079594697465808095114901</span>, <span class="number">9910546009146267464166501179537825349776178695164070160517872596078275117785713000045215455672195660329319962408970209137481672915542900445933477806115760</span>, <span class="number">1420603945244588398788478464408905133932325733716125030735921688979482121297328679317495694245547716568441401137633433150951713462958551532394178628021900</span>, <span class="number">6208847506587273852328049116772424002595270959861992270025537759079430511161476024600259347318966551584005222005704567718008394909230998308545154993159673</span>, <span class="number">10385926333158107236552504228168776101396372491461292301486697050842973861408756486936932908479675556344542947425765714101814836237112561730341100901890350</span>]</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ç»™äº†dç»„å¦‚ä¸‹ç­‰å¼ï¼š</p>
<script type="math/tex; mode=display">
c_i = Q_im + r_iR_i + s_iS_i \quad(mod\;p)</script><p>æ‰€æœ‰cã€Qã€Rã€Så‡å·²çŸ¥ï¼Œè¦æ±‚è¿˜åŸmã€‚åŒæ—¶ï¼Œæ¯æ¬¡çš„riã€siéƒ½æ˜¯d bitçš„æ•°ï¼Œpæ˜¯512bitã€‚</p>
<p>ç”±åˆ—è¡¨é•¿åº¦å¯ä»¥çŸ¥é“då°±æ˜¯32ï¼Œæ‰€ä»¥rã€séƒ½æ˜¯å¾ˆå°çš„é‡ï¼Œå› æ­¤è‡ªç„¶æƒ³åˆ°æ¶ˆå»måšä¸€ä¸ªHNPã€‚æ¶ˆå»çš„æ–¹å¼ä¹Ÿå¾ˆæœ´ç´ ï¼Œå°±æ˜¯å–ç¬¬0ç»„å’Œç¬¬iç»„çš„ç­‰å¼ï¼š</p>
<script type="math/tex; mode=display">
c_0 = Q_0m + r_0R_0 + s_0S_0 \quad(mod\;p)</script><script type="math/tex; mode=display">
c_i = Q_im + r_iR_i + s_iS_i \quad(mod\;p)</script><p>åˆ†åˆ«å°†må‰ç³»æ•°ä¹˜è‡³ç›¸ç­‰ï¼š</p>
<script type="math/tex; mode=display">
Q_ic_0 = Q_iQ_0m + r_0Q_iR_0 + s_0Q_iS_0 \quad(mod\;p)</script><script type="math/tex; mode=display">
Q_0c_i = Q_0Q_im + r_iQ_0R_i + s_iQ_0S_i \quad(mod\;p)</script><p>ç„¶åä½œå·®å°±æ¶ˆæ‰mäº†ï¼Œä¹‹åå°±æ˜¯é€ ä¸ªæ ¼å­å»åšHNPå°±è¡Œã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">10580731215444436219213907263947534038012197972307836319229421193761088798378768844649759133142120180834573817149711299466707823017636232456526471274387917</span></span><br><span class="line">Q = [<span class="number">6718668664591596190749745980002066645380242844394957953766947533978323053938214647829798301606252456858132121628517723050462291300790766055200866765561610</span>, <span class="number">8738840830394886495658505803088103824478963010774845789433253508554356383249611502157307334585157729703873877797759121271071421201959116272886732798936523</span>, <span class="number">4388762712805764363921857352899834586382140923234814556069490536704913653848525595836491615636446563386705915348021173847271741862809075809151508973332816</span>, <span class="number">3663706247989213864330218414789109172658418861584264092087052781618522795676355371739296186667918464732397854703792563460353675590182379535358561615166754</span>, <span class="number">10397730940373180549512945920847346184926672474430866208628825035104473525758952069910968144296138220861205803231072660136999110567752870928953292888013817</span>, <span class="number">7950983396364741732874562189206547723862955251595526752956177377987683115942827501152009639962778147887569469649852864894630521759276627026901168996371682</span>, <span class="number">4533165373271154956275563812280832107592547920299130443910706773435844651231402604986107252454770256826684895729900344877444002682896222483157835711226276</span>, <span class="number">234527648838985018479849393379369972316648524004050156622962478277970628212208049885578895953447529009579881605066831810617219492342569126524704457098602</span>, <span class="number">870946394610707169333783318085559836426827503011955242395779894700298192587685130680102208909573921059078858816359885827349281892186755920839352494224983</span>, <span class="number">5025393101560564396356619431938053414422489109406396725377683594254768077793838379117179092536396259414266971990125716674162127500490058572594571364978294</span>, <span class="number">5914192169617888877888201158713062853387719050723973971874176184801960297380845845091259990664210178355882621876155306106794686897854891414999449337977781</span>, <span class="number">2315609284318723939818174971181608382568372323836754133265010413836452399043354382657889810068171230196496294710150903020084150025606782486579490225752163</span>, <span class="number">7278167622527482910919537896950398911672667355929695202886784227621290914468002099686668156909569183497765732237075799745632960354306268680765408194219074</span>, <span class="number">3334584846711780119716613440720851482199838919351927489954344426327712973616885459737471991960238971274273643566666607141850753561424427088261862873317161</span>, <span class="number">10418397794302836806813296591826255845845380563102199636140458670781241436466478273414138749593148481207713557016996462238845705251702717702279222414513227</span>, <span class="number">8928267741189301140931758366885435860144549752680480164627323600501278650103818630920534258909582593266779000356145650416276415560226176904904552964196921</span>, <span class="number">3371514716248416335324237152123624115597170761078576760713238311485522010416246207731778456501311675041827750001670698984335573888627309609534659722697174</span>, <span class="number">3802217515688979225517388823688564230191961273039428065604146662684362686419670392762755984078261072614619934671572327384351597903233780846163893180876244</span>, <span class="number">2363399549320749312563257796730356164186914867645487733176402567625567991193120859507532138374793392237469893062402307645814490930874653088116729203724851</span>, <span class="number">10221767730316631512882371487958453352895713655492241322139865275323706929127996334620105099751973217983332705204535216804829987329684674632121801754529472</span>, <span class="number">2309440702968799222696132507585555901684240893289264193546892279919675495689944211715270510347394465285317239758024734161176699837687742722383530547735726</span>, <span class="number">5768185970426887633783322939933762164095055854707759575404348181421158843802654199133776622565384843677610666356549368021172121302926969754865633752131083</span>, <span class="number">3229518654067354667224244723968136366109210341994628338992752927462431316675552817799465987425719486448276862390918033544772400219803600904202906882850710</span>, <span class="number">9261930571620802581580992489567043178258044978932724785185749415955521702331959591680386023118398455066896674799447994060060156036800986190467008880726445</span>, <span class="number">2202162000802916921896507108984564185119471354726317829850206292755815439071735424116041491064894922930900262540589602333676063925873357256494020426758849</span>, <span class="number">1449198886322850923273373987785167865779477069790726992542423846556138762913056524689998313112599261515223680429584445016474216381861998363527368722991846</span>, <span class="number">8372052560034461177472546395510480308837387803551378399004608402463282066003862653368875671946863748209051044725913651881213858335224750549176875818647614</span>, <span class="number">1554572177534183877889322947083536921680809086638640689433294150868422460719624621258231995856944045776876555664816113444481761122803489100212103150005950</span>, <span class="number">10304720995101153898600333216365877709018991122985401884049110267116778080162237155472336396606109372189653686733770775660895990549286854727042270667997449</span>, <span class="number">9702831715765050072649082617719386580543641764650576307262259428035281535816750758018451681417440458250169771442858047124693499821240155899358663466925522</span>, <span class="number">4983986466837077050816175727911146971276599399191126236666755181304580074902883995859030897874305902445659355326021836801836996577665092276845357389900055</span>, <span class="number">983210432268706135181772492997088637756153310076409721616450343187239073604891492532080986521255675448499887782529162112441952861587689660048849369850769</span>]</span><br><span class="line">R = [<span class="number">8922553268219903948421811612403588317187402276064169063400419617931637566221670948925221403527928336656976084021780421068421112325215152715630319708159148</span>, <span class="number">1960697234007608888633325436691320507012497445090151112947144246088597317322303593936974554881161091213718329061011703885436579261559669838148253146762736</span>, <span class="number">5876944865176517279136475269375710514719489457672467542904948332791352244229042691977616905122711469012731652511966060550749288338599104284986451669586397</span>, <span class="number">10560136356360422684127995001096871178761635291417665630629868184624616925939841693017240341233504589896610287855672892399213367967385666891688408976236926</span>, <span class="number">477096251733995832965266836067676961413182629438628989729801411920869543083075545758386996801847267554704996660190900105380190625423846876906822024677634</span>, <span class="number">7001514955678391252130680521301315254365131738168087539892724691183104608345983375763663321467662055864103520121513349630333839818372656472731157470876337</span>, <span class="number">3894488356665934776074291789545516608573077899099880057920210752197885106521699021123658077208789295954145485399473386424677782787720074605813565437678385</span>, <span class="number">6084641463140385894120457093933350076091808742065950836200598466936433741373700151235571333073965513559605688011967994215074945374832957951384088589789549</span>, <span class="number">6429023674027239778212676334778900557043774851747196071499704016422574667955121145943674677254291410204037372996870181094090300709994594837656541352954321</span>, <span class="number">974464046378184190666336249935678253753198649184272269465353741281529523364289314148552833155935080422698020734516538377662137879089845095565536185765703</span>, <span class="number">5275384626572520577089146723078373110279682903874445477027602487061203157331398955233780208890725281673434536867800450553737656852356536771518379108118530</span>, <span class="number">7195767683001605593626199889963767438584070902169912442665828755648712278523740276132000225353756257232761885567134364203207306842108602537457408438487869</span>, <span class="number">1960155276835684836483043402384876176138942980630724993481564836712252228823186653467973806509964860286129730847244573674203959835565358735171611743573721</span>, <span class="number">6414607819273473402861616605113355396690170400984793217629732347141796693554056264547151212348354332930126795040213921009711560216969452391748438893237750</span>, <span class="number">3344964019305423035551401397282638905496921053458747459062023331678484337724980196690184898986671355848101101352105363764794975082772539709853216580762130</span>, <span class="number">5599385562588302350377616767130563945375472947459594912838322011021483641484084692396462025157944023828872267520122213089523093591160284337483108416804096</span>, <span class="number">9490045098551912983475126253859124028793327975874647810947095579199208473971726763051464010595903748080632329362605820021188148160826282120484098519748832</span>, <span class="number">980400922804123638777377509067942595214234592161404114303498013065244168965487370334832921426484278913774963761155003569793282819717667783351454812080994</span>, <span class="number">2772369382727364487748752144766350276094463435156818133766210304998890765120785013435379746537938377688617479112518505844159436213691418873590807740501183</span>, <span class="number">2338271137215119073302625621754099128003710500967811947590498668688826448575898279561111743087002717955161536157254689000474464404087443266193145449601031</span>, <span class="number">11773104862539842923315548180471993854469651503131148446111338098437913152663007837927793233931818835121946274135336436554801339749906320765919816150768</span>, <span class="number">7022131435585860015767289025786078578929344550873832550705723505006303288639135070849692494020122369694090619694760175970759059981608871097298624956669246</span>, <span class="number">9062158671807923729547552523768819638817707994079942965412925347441853183471973898478745711676153003756450481351777543455041815438536630317647408008349357</span>, <span class="number">641428039466528875429106458292463262780539744201857515833377175893334510962304373010401729801987725599439620073783868719664061882399367340158128062151780</span>, <span class="number">9636846145225909579086917154824161374486916920345217833190333031690359415616710658317308376119096253360425924297858397657697468296746934075225665559206030</span>, <span class="number">480796179229094678008918831581475398488769027287954488301969143979307355466114726392701279092691566949082439457297527772794149828193400419285116237063338</span>, <span class="number">7726757640854263742178678415761753342099387727318458723726925176786999799204056696883433346568600944559959849253863013300907357120126559055735593380638961</span>, <span class="number">551534415366550033034654093228329954588738781407008585088422737955391043381667720876717529438845777841508116853874405455280903517864352822604194884203656</span>, <span class="number">2135598634800053933515509095633720732412542790075717247869348997292949946344227105219967710854885153055617943193159899627517699960920415492992774438014041</span>, <span class="number">1680242449902645450228202409049382139482100876672724104665964994414865664877710770701122475977142858601068246748276652246938681740022531970523695731126206</span>, <span class="number">436320498659370791836085607479390848415464961245449366885835640616716752879866126057724425537944356751844317980881005608075886211154052092270888058429787</span>, <span class="number">4102523817041969170017113001399252035243358293719837916039521471412151711746047572340376418109842112515873700164747338421862615679590520014959369523777063</span>]</span><br><span class="line">S = [<span class="number">4389820170235953517860364281419052587762385444517203945856665517072263529411621622474249480804818285716662154444854074939122170918939074730520091008754679</span>, <span class="number">10274488321950407401790238304858775303749809597573328350457719402010568443492374388509295355784873292280254116167747959663379913408799485392015111636115272</span>, <span class="number">7413556897779783875511997253964328306011661062497568739340607424890313315434489440969977560260194970241163209968988660276109536299848001455072705137702052</span>, <span class="number">10385679419514177727801069016719283683697529805734389950368725106396939072509839502286093730172215158898251533786500497578747904349856564856054102927847131</span>, <span class="number">6386209810414906928429352824399745808560059492214757951425372272591372428785367326567204502131184260857447725722068674542931096991341451850846209503213310</span>, <span class="number">699060860182347708294712482476262878008951502586470987307146194685783850677219935862211847525612405824474382122868643521962157410369483858428437433802395</span>, <span class="number">3482063900392942412450041046839813864192488604261419419162091087116878838189062406913587662602295096636481252242577251563441565388543873530900962308450590</span>, <span class="number">5752782775722534186844731777766684686828626762801341093006843547008915880093927377014105260314050196609699164926717998841388194942556402699285523644651583</span>, <span class="number">4477944786670422304592908174461368396168580171651041832449759231077050962444090886920563302603784981035116689839335069690875797644553684152368376089740517</span>, <span class="number">5663531682848751034979876476955107364567717396957230368140915480695954150088052156264521615690161327525898382714131905580517915060427960250740110846321921</span>, <span class="number">5343294510843224726960051115907810365241970373986845465490090821566645536683695042467985025063439338770116316455211944030125820601506874250685838077414765</span>, <span class="number">8432688027895892738831218358369397874948328355540048945541749304849571948638169902486647265119397307193449002927427840453857643697175667051504836511635801</span>, <span class="number">8974418251288081645329898313903422373193272601106837017923535786950979222125740970411725976034947989767143786286397290996756916960291029965672692318584390</span>, <span class="number">3367471493907450997862234076499110882206518716388236141312548251406626961838619595519805436447472248133422979102036617759221276869918910189482246041609756</span>, <span class="number">9787518698663334219763616437865759554315749369906898604904977007297368987715422535407542350049111845605011307829034744443271718643291528381794716569586150</span>, <span class="number">7423298611637442306439453382713995476685370148677494272333567929180589186347708172471032286209947149761644993151042408431548488945145292037694546868884030</span>, <span class="number">5591656321514817104832226351286824953278894430528912246855770091334337189386156994498331013600732669813560603667226878637404391237947398475280409452591013</span>, <span class="number">6425108527382412819259579180312607504985609322110590326058191420486308943785080395001318724782575187718535133704219706236946232717333616646838328259100174</span>, <span class="number">1986072520726417425427679478185786673218113837249425820170849864471171328875606626923270664642579676457285438864056080352157246995774517812392120146048999</span>, <span class="number">5085759490547346080963649291763871068034757573012867868532204864022791365366745839456310985148663327808561601274994541505734129506831803550600738607170703</span>, <span class="number">6883330982174382523423400136207766091739299571009207949454774998664997037115272990237878573502506026799645646664956134682833693219974019271740996314084220</span>, <span class="number">3008412285222633004812698063455902388460013611944185187747762649311442328686187279186972723448077521425052318221865300502697494418867793831761784796146329</span>, <span class="number">9547325670583212399117684599284936334790443591395268814958834705867928621240882386996085347052830889322724160452729359284992294890584292625829913315628265</span>, <span class="number">1387461799657365419593288084566026147529011675413652640829187706708872066267641962620159408303872024421411747751690792902149761832079721583778430712988299</span>, <span class="number">2093635222672050417361673475374966389314266702410603863643637918543784930893405832179904330416148995313591588929177333026382745340633946128791737631559286</span>, <span class="number">8413424329301946557805781268429552577339778139904799140486659388945506980343653897206690153402822892272378378085908749995513711021119914769801970795906117</span>, <span class="number">6743445162380434316634371637355512041805280159276931422012464596435558338432827675791139455542184532473287436049595748235961499758716697674776760822162391</span>, <span class="number">1706184129470213725753097073154985919221181897433450716898208607625832464228411992900434982560203334218404626447424408012817411257665032706434306723906871</span>, <span class="number">1188503046129710474378492502021666062040985983530761819828342979325166292485440608536173516789179154601587903599847267180858095017007891547798890802090080</span>, <span class="number">6398862094282462456834873185064362330936738060688527379705123125559724680574585721467123968313071365176318010618981170019917278363707049487278610027058585</span>, <span class="number">1827205671808118170959457466922915851906256049105694256301380823860317738339383848734269783842511423911532135506082729000044271560428423457063013176002958</span>, <span class="number">4296939764995860347968082436772567300063081379392577066061720737920992283479200350022263164173968370055486217109628430523063986426005741344085155171587948</span>]</span><br><span class="line">C = [<span class="number">2312453804397990204892582347458673184184584053391181580849656202381982276483135032773767708029907426388840618138608941250788745829088238589339462137662516</span>, <span class="number">10523194306636352419831471584744199603299973937259007033119401866043123235256118686290774285411893111835433604432082195914308420845569896693674208644701928</span>, <span class="number">8625321422409900297730698589684636810222608572364004227411854906715574297306124060030713845833976664653817196364988412308992879167741430256046508164902265</span>, <span class="number">2203036357494864574281685606458518951592160562338358743010726696365683441724958156704554110208947394458113054047499157258753175446414976136008162642109757</span>, <span class="number">7440676439428237992864596387460092947449968530635365999432104198675297081825315672568959667296286389774687367936168132053293001589687795737604457160906082</span>, <span class="number">2264157050840270501520646271743213633490605461967539030408028006097728678459599299655371587125945029431528702214373899493252891890106222569122603386717360</span>, <span class="number">6089828885562252420652081197249651438359320954630388805129416420415135298321118452771481678140904854945253504361325478946359729157231808943846058944117026</span>, <span class="number">10539688120079451218718476929576210805778407047878263373562960368159158621424931104363627052374700437454925765616146962059684388174993415278124860987310938</span>, <span class="number">6303692164422236243124789748609418445914012315334563733630138248326249660310698584154622748275297380026916444293448955157206727703202478794453250926439643</span>, <span class="number">881942845076614931271891025655927553295291244201690295230440723375006916146507322259936249039275621554840488955637696630030022348109669072833863866985225</span>, <span class="number">10106348190249831893088197931090851286229747534150777530156601113972916238286905365616240501204440809598108220364456446320022747806334510176621958436096123</span>, <span class="number">8324531392881516178541244041903222514911964835924579628962940318936570586739198442236357026438613345385230182029810965182157993322744038688573053225547374</span>, <span class="number">5078708553426349749719952343873018594648548601008242439539543130067536764970709366523519348572603124221309659983256536103306454063139670063244331611755453</span>, <span class="number">8542547993117228744822361667182819410791296436924016725757178153507707272004493213120780743910507865839367749205817741703451968423781285521621014600059589</span>, <span class="number">3073352723766074586873446203285051955281142348730058300259816322651361605792426446390729367386148254808552616968786890277451301146248756651016086606742804</span>, <span class="number">5269945451683706496607356863109615383647000556701922770404180133092195426319754674753614204346587769298246334991876508268642550219392732660290378353338400</span>, <span class="number">6262348731181694593163187372863680743743096474259867989757989072530511417286900866334036812204673457159090130621478933266270029789176903023636735673595513</span>, <span class="number">3297899863181037954379261853482229450757449782777910450819629975965660022355584717412057615899333569245281976118829898854119850433763380827003244277020101</span>, <span class="number">7487260566995972228255217362172107520309457024141075543923988636564806307827017535285595701845830793533604534902349660541692391232785351590333159515799384</span>, <span class="number">10324279404125558600858330541468243667961239247663241031255287540601841176203292036413076990028875224629890818418992943759206077129550049357885152924273782</span>, <span class="number">8044925106089251438446731137002808317322635126054485149617494154471416674741758172633019611642437845768869330746423337854351186668227486117398013073824286</span>, <span class="number">4234270952814400783009242730655483882561531800274439758860142245952005010632014464198770218689605527760730047723966950012227395838571254801244673898812828</span>, <span class="number">638896609043108497262778277770178050665854883307447937008504779907661322405672174519391657570064336725509768185637608044022219246206471015980252602095129</span>, <span class="number">5180216795602211214280366461349507739255238657924206736673167715462995927060334503420979145327254053283011116720223275075476559911219732336496503542596869</span>, <span class="number">4889582376915206124736222022750168286228699065224704085027955184917144323557844593386817223260498520607466742269645929630472738644444652704289510157100913</span>, <span class="number">5012604326308554636339480431591200785633930724891396744558818436357664982175033998281443810436271724799610836412819040278374041390604150781759163613994682</span>, <span class="number">3219038638665180576932584279254771209098300305384572525709292133614238552451580810601286362213655499134538083785424726484119059950676285763438331520089227</span>, <span class="number">6419694420004223063062285264931096360778228156157853232796125041025067958687740255716444718822744614217377927689465894996156144384079594697465808095114901</span>, <span class="number">9910546009146267464166501179537825349776178695164070160517872596078275117785713000045215455672195660329319962408970209137481672915542900445933477806115760</span>, <span class="number">1420603945244588398788478464408905133932325733716125030735921688979482121297328679317495694245547716568441401137633433150951713462958551532394178628021900</span>, <span class="number">6208847506587273852328049116772424002595270959861992270025537759079430511161476024600259347318966551584005222005704567718008394909230998308545154993159673</span>, <span class="number">10385926333158107236552504228168776101396372491461292301486697050842973861408756486936932908479675556344542947425765714101814836237112561730341100901890350</span>]</span><br><span class="line"></span><br><span class="line">d = <span class="built_in">len</span>(C)</span><br><span class="line">nums = <span class="built_in">len</span>(C)</span><br><span class="line"></span><br><span class="line">L = Matrix(ZZ,<span class="number">3</span>*nums,<span class="number">3</span>*nums)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>*nums):</span><br><span class="line">    L[i,i] = <span class="number">1</span></span><br><span class="line">L[<span class="number">2</span>*nums,<span class="number">2</span>*nums] = <span class="number">2</span>^<span class="number">32</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,nums):</span><br><span class="line">    L[<span class="number">0</span>,<span class="number">2</span>*nums+i] = R[<span class="number">0</span>]*Q[i]</span><br><span class="line">    L[<span class="number">1</span>,<span class="number">2</span>*nums+i] = S[<span class="number">0</span>]*Q[i]</span><br><span class="line">    L[<span class="number">2</span>*i,<span class="number">2</span>*nums+i] = -R[i]*Q[<span class="number">0</span>]</span><br><span class="line">    L[<span class="number">1</span>+<span class="number">2</span>*i,<span class="number">2</span>*nums+i] = -S[i]*Q[<span class="number">0</span>]</span><br><span class="line">    L[<span class="number">2</span>*nums,<span class="number">2</span>*nums+i] = C[i]*Q[<span class="number">0</span>] - C[<span class="number">0</span>]*Q[i]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,nums):</span><br><span class="line">    L[-i,-i] = p</span><br><span class="line">L[:,-<span class="number">1</span>:] *= <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">res = L.LLL()</span><br><span class="line">r0,s0 = res[<span class="number">0</span>][<span class="number">0</span>],res[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">m = (C[<span class="number">0</span>] - r0*R[<span class="number">0</span>] - s0*S[<span class="number">0</span>])*inverse(Q[<span class="number">0</span>],p) % p</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#CCTF&#123;3X7eNdED_H!dD3n_nNm8eR_pR0Bl3m_iN_CCTF!!&#125;</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°må…¶å®ä¹Ÿä¸å¤§ï¼Œæ‰€ä»¥ä¸æ¶ˆmç›´æ¥è§„çº¦ä¹Ÿå¯ä»¥ã€‚</p>
<p><br></p>
<h3 id="Joe-19-120-solves-47-pts"><a href="#Joe-19-120-solves-47-pts" class="headerlink" title="Joe-19(120 solves , 47 pts)"></a>Joe-19(120 solves , 47 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Joe-19 is a cryptographic system that leverages a top-secret version of GPT AI technology to develop advanced and robust cryptographic tools.</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> GPT <span class="keyword">import</span> GPT6 <span class="comment"># deep fake </span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">P = [GPT6(<span class="string">&#x27;A 512-bit prime appears in consecutive digits of e&#x27;</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">n, m = prod(P), bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, <span class="number">0x10001</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>output.txtï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">n = 8098851734937207931222242323719278262039311278408396153102939840336549151541408692581651429325092535316359074019383926520363453725271849258924996783681725111665666420297112252565291898169877088446887149672943461236879128453847442584868198963005276340812322871768679441501282681171263391133217373094824601748838255306528243603493400515452224778867670063040337191204276832576625227337670689681430055765023322478267339944312535862682499007423158988134472889946113994555274385595499503495488202251032898470224056637967019786473820952632846823442509236976892995505554046850101313269847925347047514591030406052185186963433</span><br><span class="line">c = 7109666883988892105091816608945789114105575520302872143453259352879355990908149124303310269223886289484842913063773914475282456079383409262649058768777227206800315566373109284537693635270488429501591721126853086090237488579840160957328710017268493911400151764046320861154478494943928510792105098343926542515526432005970840321142196894715037239909959538873866099850417570975505565638622448664580282210383639403173773002795595142150433695880167315674091756597784809792396452578104130341085213443116999368555639128246707794076354522200892568943534878523445909591352323861659891882091917178199085781803940677425823784662</span><br></pre></td></tr></table></figure>
<p>çœ‹è¿™é¢˜çš„æ—¶å€™ä¸€è„¸æ‡µé€¼ï¼Œè¿™æ„æ€æ˜¯ä¸æ˜¯ç”¨65537å»è¿ç»­æ‹¼æ¥å¾—åˆ°ä¸€ä¸ª512bitçš„ç´ æ•°pï¼Ÿå°è¯•äº†ä¸€ä¸‹æ— æœä¹‹åå°±å…ˆè·‘å»åšåˆ«çš„é¢˜ç›®äº†ã€‚</p>
<p>ä¹‹åå›æ¥çœ‹å‘ç°å·²ç»è¢«@Astrageldonè§£å†³äº†ï¼Œä¸è¿‡æ–‡æ¡£é‡Œæ²¡æœ‰å†™è¿‡ç¨‹ã€‚ä¹‹ååˆé—®äº†ä¸‹<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ZimaBlue">@Zima</a>ï¼Œä»–å‘Šè¯‰æˆ‘å¯ä»¥ï¼š</p>
<p><img src="/post/cf09b856/image-20240630113251927.png" alt="image-20240630113251927"></p>
<p>XD</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">8098851734937207931222242323719278262039311278408396153102939840336549151541408692581651429325092535316359074019383926520363453725271849258924996783681725111665666420297112252565291898169877088446887149672943461236879128453847442584868198963005276340812322871768679441501282681171263391133217373094824601748838255306528243603493400515452224778867670063040337191204276832576625227337670689681430055765023322478267339944312535862682499007423158988134472889946113994555274385595499503495488202251032898470224056637967019786473820952632846823442509236976892995505554046850101313269847925347047514591030406052185186963433</span></span><br><span class="line">c = <span class="number">7109666883988892105091816608945789114105575520302872143453259352879355990908149124303310269223886289484842913063773914475282456079383409262649058768777227206800315566373109284537693635270488429501591721126853086090237488579840160957328710017268493911400151764046320861154478494943928510792105098343926542515526432005970840321142196894715037239909959538873866099850417570975505565638622448664580282210383639403173773002795595142150433695880167315674091756597784809792396452578104130341085213443116999368555639128246707794076354522200892568943534878523445909591352323861659891882091917178199085781803940677425823784662</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">7728751393377105569802455757436190501772466214587592374418657530064998056688376964229825501195065837843125232135309371235243969149662310110328243570065781</span></span><br><span class="line">q = <span class="number">9688632098638681429535439991332657144752666147923336383829750592576742104399942931057096761773496510622226977570278994077236841491368959008277469453600569</span></span><br><span class="line">r = <span class="number">10019005372961705640183251650710051163228093250949727357306333102512304273058618645339800283588040423877666492199352609508401454089083503146788384653241593</span></span><br><span class="line">s = <span class="number">10795109107229646654467923653403055635071360620150038008453082390943756377071343139771120080956310498862485323957447467376538994662280143050510681877597429</span></span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c, inverse(<span class="number">65537</span>,(p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)*(s-<span class="number">1</span>)), n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#CCTF&#123;ASIS_h1r3_7aL3nT5_t0_cO1La8orAt3_!N_Crypto_CTF!&#125;</span></span><br></pre></td></tr></table></figure>
<p>ä¹‹åçœ‹<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/702939109">æ˜¥å“¥çš„wp</a>æ‰çŸ¥é“é¢˜é¢çš„eè¯´çš„æ˜¯è‡ªç„¶å¯¹æ•°é‚£ä¸ªeï¼Œæ‰€ä»¥é¢„æœŸåº”è¯¥æ˜¯è¦æšä¸¾è¿™ä¸ªæ•°å­—çš„è¿ç»­bitå»æ‰¾ç´ æ•°ã€‚</p>
<p><br></p>
<h3 id="Melek-66-solves-73-pts"><a href="#Melek-66-solves-73-pts" class="headerlink" title="Melek(66 solves , 73 pts)"></a>Melek(66 solves , 73 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Melek is a secret sharing scheme that may be relatively straightforward to break - what are your thoughts on the best way to approach it?</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">msg, nbit</span>):</span><br><span class="line">	m, p = bytes_to_long(msg), getPrime(nbit)</span><br><span class="line">	<span class="keyword">assert</span> m &lt; p</span><br><span class="line">	e, t = randint(<span class="number">1</span>, p - <span class="number">1</span>), randint(<span class="number">1</span>, nbit - <span class="number">1</span>)</span><br><span class="line">	C = [randint(<span class="number">0</span>, p - <span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(t - <span class="number">1</span>)] + [<span class="built_in">pow</span>(m, e, p)]</span><br><span class="line">	R.&lt;x&gt; = GF(p)[]</span><br><span class="line">	f = R(<span class="number">0</span>)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t): f += x**(t - i - <span class="number">1</span>) * C[i]</span><br><span class="line">	P = [<span class="built_in">list</span>(<span class="built_in">range</span>(nbit))]</span><br><span class="line">	shuffle(P)</span><br><span class="line">	P = P[:t]</span><br><span class="line">	PT = [(a, f(a)) <span class="keyword">for</span> a <span class="keyword">in</span> [randint(<span class="number">1</span>, p - <span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(t)]]</span><br><span class="line">	<span class="keyword">return</span> e, p, PT</span><br><span class="line"></span><br><span class="line">nbit = <span class="number">512</span></span><br><span class="line">enc = encrypt(flag, nbit)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;enc = <span class="subst">&#123;enc&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>outputå¤ªé•¿å°±ä¸æ”¾åœ¨è¿™ï¼Œå¯ä»¥å»NSSCTFä¸‹è½½é™„ä»¶ã€‚</p>
<p>è¿™ä¸ªé¢˜ç›®è¿‡äºç›´ç™½ï¼Œé¦–å…ˆåœ¨æ¨¡pä¸‹å»ºç«‹ä¸€ä¸ªåº¦ä¸ºt-1çš„å¤šé¡¹å¼fï¼Œå…¶ä¸­å¸¸æ•°é¡¹æ˜¯flagåŠ å¯†åçš„å¯†æ–‡ï¼Œå…¶ä»–ç³»æ•°å‡æœªçŸ¥ã€‚ç„¶åéšæœºç»™å‡ºäº†tä¸ªç‚¹å€¼å¯¹ï¼Œå¹¶ä¸”ç»™äº†eã€pçš„å€¼ã€‚æ˜¾ç„¶æ‹‰æ ¼æœ—æ—¥æ’å€¼è¿‡åå†å¯¹eæ±‚ä¸€æ¬¡å…³äºp-1çš„é€†å°±è¡Œã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e,p,PT = </span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">recover_f = PR.lagrange_polynomial(PT)</span><br><span class="line">c = recover_f(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">m2 = <span class="built_in">pow</span>(c,inverse(e//<span class="number">2</span>,p-<span class="number">1</span>),p)</span><br><span class="line">PR.&lt;y&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">f = y^<span class="number">2</span> - m2</span><br><span class="line">res = f.roots()</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(res[<span class="number">1</span>][<span class="number">0</span>])))</span><br><span class="line"></span><br><span class="line"><span class="comment">#CCTF&#123;SSS_iZ_4n_3fF!ciEn7_5ecr3T_ShArIn9_alGorItHm!&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="Nabat-25-solves-159-pts"><a href="#Nabat-25-solves-159-pts" class="headerlink" title="Nabat(25 solves , 159 pts)"></a>Nabat(25 solves , 159 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Nabat is a cryptographic challenge that explores the representation of polynomials within a specific polynomial ring structure.</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">die</span>(<span class="params">*args</span>):</span><br><span class="line">	pr(*args)</span><br><span class="line">	quit()</span><br><span class="line">	</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pr</span>(<span class="params">*args</span>):</span><br><span class="line">	s = <span class="string">&quot; &quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, args))</span><br><span class="line">	sys.stdout.write(s + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">	sys.stdout.flush()</span><br><span class="line">	</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sc</span>(): </span><br><span class="line">	<span class="keyword">return</span> sys.stdin.buffer.readline()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">randstr</span>(<span class="params">l</span>):</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([printable[randint(<span class="number">0</span>, <span class="number">90</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(l)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">f, l</span>):</span><br><span class="line">	R = PolynomialRing(ZZ, <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">	f, g = R(f), R(x^<span class="number">2</span> + x + <span class="number">2</span>)</span><br><span class="line">	coefs = f.<span class="built_in">list</span>()</span><br><span class="line">	_b1 = <span class="built_in">all</span>(<span class="built_in">abs</span>(_) &lt;= <span class="number">1</span> <span class="keyword">for</span> _ <span class="keyword">in</span> coefs)</span><br><span class="line">	_b2 = f.degree() + <span class="number">1</span> - <span class="number">2</span> * n(log(l)) &gt;= <span class="number">0</span></span><br><span class="line">	_b3 = coefs.count(<span class="number">0</span>) &gt;= <span class="number">2</span> * f.degree() // <span class="number">3</span> - <span class="number">3</span></span><br><span class="line">	_b4 = (f - l) % g == <span class="number">0</span></span><br><span class="line">	<span class="keyword">if</span> _b1 <span class="keyword">and</span> _b2 <span class="keyword">and</span> _b3 <span class="keyword">and</span> _b4:</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">	border = <span class="string">&quot;â”ƒ&quot;</span></span><br><span class="line">	pr(        <span class="string">&quot;â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“&quot;</span>)</span><br><span class="line">	pr(border, <span class="string">&quot;Welcome to the NABAT challenge, your mission is to validate the main&quot;</span>, border)</span><br><span class="line">	pr(border, <span class="string">&quot;check function in the provided system, Try your best to find flag :)&quot;</span>, border)</span><br><span class="line">	pr(        <span class="string">&quot;â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›&quot;</span>)</span><br><span class="line">	step = <span class="number">12</span></span><br><span class="line">	R = PolynomialRing(ZZ, <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">	pr(border, <span class="string">f&quot;Send a polynomial that satisfies the check function for each given `n&#x27;.&quot;</span>)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, step):</span><br><span class="line">		n = randint(<span class="number">2</span>**i, <span class="number">2</span>**(i + <span class="number">1</span>))</span><br><span class="line">		pr(border, <span class="string">f&quot;Your are in step <span class="subst">&#123;i&#125;</span> and n = <span class="subst">&#123;n&#125;</span>, please send the polynomial f:&quot;</span>)</span><br><span class="line">		_f = sc().decode()</span><br><span class="line">		<span class="keyword">try</span>:</span><br><span class="line">			_f = R(_f)</span><br><span class="line">		<span class="keyword">except</span>:</span><br><span class="line">			die(border, <span class="string">f&quot;The polynomial you provided is is not valid!&quot;</span>)</span><br><span class="line">		_b = check(_f, n)</span><br><span class="line">		<span class="keyword">if</span> _b:</span><br><span class="line">			<span class="keyword">if</span> i == step - <span class="number">1</span>:</span><br><span class="line">				die(border, <span class="string">f&#x27;Congrats, you got the flag: <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				pr(border, <span class="string">f&#x27;You have successfully passed step <span class="subst">&#123;i&#125;</span>. Please proceed to the next step :)&#x27;</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			die(border, <span class="string">f&quot;Your input does not meet the requirements!!!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®æœ‰12è½®æŒ‘æˆ˜ï¼Œæ¯è½®æŒ‘æˆ˜ä¼šå…ˆç”Ÿæˆä¸€ä¸ªéšæœºæ•°n(éšç€è½®æ•°å˜å¤§)ï¼Œéœ€è¦ç»™å‡ºä¸€ä¸ªå¤šé¡¹å¼fï¼Œfæ»¡è¶³å››ä¸ªæ¡ä»¶å°±å¯ä»¥é€šè¿‡æœ¬è½®æŒ‘æˆ˜ï¼š</p>
<ul>
<li>æ‰€æœ‰ç³»æ•°éœ€è¦ä¸º1ï¼Œ0ï¼Œ-1</li>
<li>fçš„åº¦dè¦å¤§äºç­‰äº$2logn - 1$</li>
<li>ç³»æ•°ä¸º0çš„æ•°é‡è¦å¤§äºç­‰äº$\lfloor \frac{2d}{3} \rfloor-3$</li>
<li>f-næ˜¯gçš„å› å­</li>
</ul>
<p>å…¶ä¸­ï¼Œgæ˜¯ï¼š</p>
<script type="math/tex; mode=display">
x^2 + x + 2</script><p>å’Œå…¶ä»–å•†ç¯ç±»é¢˜ä¸€æ ·çš„æ€è·¯ï¼Œç”±äºåœ¨æ¨¡gä¸‹æœ‰ï¼š</p>
<script type="math/tex; mode=display">
x^2 + x + 2 = 0 \quad(mod \; g)</script><p>æ‰€ä»¥ï¼š</p>
<script type="math/tex; mode=display">
x^2 + x = -2 \quad(mod \; g)</script><p>åŒç†å°±æœ‰ï¼š</p>
<script type="math/tex; mode=display">
x^{i+2} + x^{i+1} = -2x^i \quad(mod \; g)</script><p>æ‰€ä»¥è¯´å…¶å®æ•´ä¸ªå¤šé¡¹å¼fçš„ç³»æ•°çš„äº§ç”Ÿè¿‡ç¨‹ï¼Œå…¶å®å¯ä»¥çœ‹ä½œæ˜¯ä»å¸¸æ•°nå¼€å§‹çš„å‘é«˜æ¬¡é¡¹ç³»æ•°çš„è¿­ä»£ã€‚è€Œä¸ºäº†æ»¡è¶³å‰©ä¸‹ä¸‰ä¸ªè¦æ±‚ï¼Œé€šä¿—ä¸€ç‚¹æ¥è¯´å°±æ˜¯è¦è¿­ä»£çš„è¶Šå½»åº•è¶Šå¥½ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸€é¡¹çš„ç³»æ•°éƒ½è¦å°½å¯èƒ½æ¶ˆæˆ0ã€‚</p>
<p>é‚£å°±ä»å¸¸æ•°nå¼€å§‹æ€è€ƒï¼Œå‡è®¾ä»–çº¦å‡äº†k0ä¸ª2ä¹‹åå˜æˆ1ã€0æˆ–è€…-1ï¼Œè®°è¿™ä¸ªç³»æ•°ä¸ºa0ï¼Œä¹Ÿå°±æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
n - 2k_0 = a_0 \quad a_0 \in \{1,0,-1\}</script><p>é‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œä¸€æ¬¡é¡¹å’ŒäºŒæ¬¡é¡¹çš„ç³»æ•°å°±å˜æˆäº†k0ï¼Œå¯¹äºä¸€æ¬¡é¡¹æ¥è¯´ï¼Œå…¶çº¦å‡k1ä¸ª2ä¹‹åå˜æˆa1ï¼Œa1åŒæ ·åªèƒ½å–1ã€0æˆ–è€…-1ï¼Œé‚£ä¹ˆè¿™ä¸ªk1åˆä¼šè´¡çŒ®ç»™äºŒæ¬¡é¡¹å’Œä¸‰æ¬¡é¡¹ï¼Œæ‰€ä»¥äºŒæ¬¡é¡¹ä¼šä»k0+k1å¼€å§‹çº¦å‡ï¼Œä¾æ­¤ç±»æ¨ã€‚æ•´ä¸ªå¤šé¡¹å¼ç³»æ•°å°±ä¼šå˜æˆå¦‚ä¸‹çš„çº¿æ€§è¿­ä»£è¿‡ç¨‹ï¼š</p>
<script type="math/tex; mode=display">
(1,k_0,k_1,...k_{d-2})
\left(\begin{matrix}
1&n\\
&2&1&1\\
&&2&1&1\\
&&&2&1&1\\
&&&&\ddots&\ddots&\ddots\\
&&&&&2&1&1\\

\end{matrix}\right)
=
(1,a_0,a_1,...,a_d)</script><p>æ‰€ä»¥å¯¹ä¸Šé¢çš„æ ¼è¿›è¡Œè§„çº¦å°±å¯ä»¥å¾—åˆ°éœ€è¦çš„ç»“æœã€‚è‡³äºåº¦æ€ä¹ˆé€‰æ‹©ï¼Œä¸ºäº†æ»¡è¶³é¢˜ç›®æ¡ä»¶çš„è¯åº”è¯¥æ˜¯è¶Šå¤§è¶Šå¥½ï¼Ÿè¿™é‡Œæˆ‘å–äº†400ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">f, l</span>):</span><br><span class="line">    R = PolynomialRing(ZZ, <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">    f, g = R(f), R(x^<span class="number">2</span> + x + <span class="number">2</span>)</span><br><span class="line">    coefs = f.<span class="built_in">list</span>()</span><br><span class="line">    _b1 = <span class="built_in">all</span>(<span class="built_in">abs</span>(_) &lt;= <span class="number">1</span> <span class="keyword">for</span> _ <span class="keyword">in</span> coefs)</span><br><span class="line">    _b2 = f.degree() + <span class="number">1</span> - <span class="number">2</span> * <span class="built_in">int</span>(log(l)) &gt;= <span class="number">0</span></span><br><span class="line">    _b3 = coefs.count(<span class="number">0</span>) &gt;= <span class="number">2</span> * f.degree() // <span class="number">3</span> - <span class="number">3</span></span><br><span class="line">    _b4 = (f - l) % g == <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> _b1 <span class="keyword">and</span> _b2 <span class="keyword">and</span> _b3 <span class="keyword">and</span> _b4:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getf</span>(<span class="params">l</span>):</span><br><span class="line">    d = <span class="number">400</span></span><br><span class="line">    <span class="keyword">assert</span> d &gt; <span class="number">2</span>*<span class="built_in">int</span>(log(l)) + <span class="number">1</span></span><br><span class="line">    L = Matrix(ZZ,d,d+<span class="number">2</span>)</span><br><span class="line">    L[<span class="number">0</span>,<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    L[<span class="number">0</span>,<span class="number">1</span>] = l</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,d):</span><br><span class="line">        L[i,i] = <span class="number">2</span></span><br><span class="line">        L[i,i+<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">        L[i,i+<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">    res = L.LLL()</span><br><span class="line">    </span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(ZZ)</span><br><span class="line">    <span class="keyword">for</span> v <span class="keyword">in</span> res:</span><br><span class="line">        <span class="keyword">if</span> v[<span class="number">0</span>] == -<span class="number">1</span>:</span><br><span class="line">            v = -v</span><br><span class="line">        <span class="keyword">elif</span> v[<span class="number">0</span>] == <span class="number">1</span>:</span><br><span class="line">            f = PR(v[<span class="number">1</span>:].<span class="built_in">list</span>())</span><br><span class="line">            <span class="keyword">if</span> check(f, l):</span><br><span class="line">                <span class="keyword">return</span> f</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">step = <span class="number">12</span></span><br><span class="line">R = PolynomialRing(ZZ, <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, step):</span><br><span class="line">    n = randint(<span class="number">2</span>**i, <span class="number">2</span>**(i + <span class="number">1</span>))</span><br><span class="line">    f = getf(n)</span><br><span class="line">    <span class="built_in">print</span>(i,f)</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªé¢˜ç›®èµ›ä¸­çš„æ—¶å€™ï¼Œåœ¨æœªæ›´æ–°ä¹‹å‰ï¼Œå…¶å®ä¸€å…±éœ€è¦é€šè¿‡40è½®ï¼Œå¹¶ä¸”æ¡ä»¶3é™åˆ¶ä¸ºï¼š</p>
<ul>
<li>ç³»æ•°ä¸º0çš„æ•°é‡è¦å¤§äºç­‰äº$\lfloor \frac{2d}{3} \rfloor$</li>
</ul>
<p>å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•æ£€æŸ¥ä¸€ä¸‹ï¼Œå‘ç°é€šè¿‡æ¦‚ç‡ä½äº†å¾ˆå¤šå¾ˆå¤šã€‚èµ›ä¸­<a target="_blank" rel="noopener" href="https://wleukocytec.github.io/">@leukocyte</a>å’Œ<a target="_blank" rel="noopener" href="https://hash-hash.github.io/">@hash-hash</a>ä¹Ÿæ˜¯åˆ©ç”¨ä¸‰å€¼å¤šé¡¹å¼æ¥çº¦å‡ç³»æ•°ï¼Œä¸è¿‡åº”è¯¥æ˜¯ç”¨äº†å¦ä¸€ä¸ªç­–ç•¥æ¥æ»¡è¶³åä¸‰ä¸ªæ¡ä»¶ã€‚ç„¶åå¤§å®¶ä¸€èµ·æŒ‚é‚£ä¸ªè„šæœ¬ï¼Œæœ€å¥½çš„æ—¶å€™ä¹Ÿå°±æŒ‚åˆ°äº†28è½®ã€‚çœ‹discordæ‰å‘ç°æœç„¶åˆæ˜¯é¢˜çš„é—®é¢˜ã€‚</p>
<p><br></p>
<h3 id="Nazdone-35-solves-122-pts"><a href="#Nazdone-35-solves-122-pts" class="headerlink" title="Nazdone(35 solves , 122 pts)"></a>Nazdone(35 solves , 122 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Nazdone is a cryptographic exercise focused on the practical challenges of generating random prime numbers for real-world applications.</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> params, flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sol</span>(<span class="params">m, a, z</span>):</span><br><span class="line">	p = m * (a - <span class="number">1</span>) % <span class="number">2</span> + <span class="number">1</span></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		R = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">1</span>, a))</span><br><span class="line">		shuffle(R)</span><br><span class="line">		<span class="keyword">for</span> r <span class="keyword">in</span> R[:z]:</span><br><span class="line">			p += getRandomRange(<span class="number">0</span>, <span class="number">2</span>) * m ** r</span><br><span class="line">		<span class="keyword">if</span> isPrime(p):</span><br><span class="line">			<span class="keyword">return</span> p</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			p = m * (a - <span class="number">1</span>) % <span class="number">2</span> + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p, q, r = [sol(*params) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&#x27;007&#x27;</span>]</span><br><span class="line">n = p * q * r</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, params[<span class="number">0</span>] ** <span class="number">3</span> + params[<span class="number">2</span>] - <span class="number">2</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>output.txtï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">n = 301929748923678449872944933611657670834216889867340028357609265175830693931365828840717548752313862343315133541384709574659039910206634528428504034051556622114290811586746168354731258756502196637977942743110508997919976400864419640496894428180120687863921269087080600917900477624095004141559042793509244689248253036809126205146653922738685595903222471152317095497914809983689734189245440774658145462867680027337</span><br><span class="line">c = 104375152140523502741159687674899095271676058870899569351687154311685938980840028326701029233383897490722759532494438442871187152038720886122756131781086198384270569105043114469786514257765392820254951665751573388426239366215033932234329514161827069071792449190823827669673064646681779764841034307000600929149689291216313319444583032339045277433847691961234044840927155960887984372868669401051358701522484473320</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®çš„paramsç”±ä¸‰ä¸ªæœªçŸ¥é‡mã€aã€zæ„æˆï¼Œåˆ©ç”¨è¿™ä¸‰ä¸ªå€¼ç”Ÿæˆäº†ä¸‰ä¸ªç´ æ•°pã€qã€rï¼Œå…·ä½“ç”Ÿæˆè¿‡ç¨‹ä¹Ÿå°±æ˜¯solå‡½æ•°ï¼Œæµç¨‹æ˜¯ï¼š</p>
<ul>
<li><p>å–påˆå§‹å€¼ï¼Œä¸º1æˆ–è€…2</p>
</li>
<li><p>éšæœºæ‰“ä¹±1åˆ°açš„åˆ—è¡¨ï¼Œå¹¶å–å‰zé¡¹ï¼Œè®°ä¸ºa1,a2,â€¦,azï¼Œä¹‹åå°†påŠ ä¸Šå¦‚ä¸‹å€¼ï¼š</p>
<script type="math/tex; mode=display">
\sum_{i=1}^{z}{b_i}m^{a_i}</script><p>å…¶ä¸­biæ˜¯éšæœºçš„0æˆ–è€…1</p>
</li>
<li><p>æ£€æŸ¥pæ˜¯å¦æ˜¯ç´ æ•°ï¼Œæ˜¯çš„è¯å°±è¿”å›</p>
</li>
</ul>
<p>å¯ä»¥çœ‹å‡ºï¼Œå…¶å®på°±ç­‰äºï¼š</p>
<script type="math/tex; mode=display">
1 + \sum_{i=1}^{z}{b_i}m^{a_i}</script><p>æˆ–è€…ï¼š</p>
<script type="math/tex; mode=display">
2 + \sum_{i=1}^{z}{b_i}m^{a_i}</script><p>è€Œpã€qã€réƒ½æ˜¯è¿™ç§ç±»å‹çš„ç´ æ•°ï¼Œå…¶ä¹˜ç§¯æ„æˆnã€‚æœ€åæŒ‰å¦‚ä¸‹æ–¹å¼åŠ å¯†ï¼š</p>
<script type="math/tex; mode=display">
c = flag^{m^3 + z - 2} \quad (mod\;n)</script><p>ä»…ç»™å‡ºnã€cï¼Œè¦æ±‚è¿˜åŸflagã€‚</p>
<p>é¦–å…ˆï¼Œå¯¹äºparamsçš„ä¸‰ä¸ªå‚æ•°mã€aã€zå¯ä»¥è¯´æ˜¯ä¸€æ— æ‰€çŸ¥ï¼Œå¿…é¡»è¦åˆ©ç”¨næ¥è¿˜åŸä»–ä»¬ï¼Œè¿˜åŸçš„ä¾æ®å°±æ˜¯pã€qã€ræ»¡è¶³çš„ç­‰å¼ã€‚ä¸å¦¨å‡è®¾ä»–ä»¬éƒ½æ˜¯ç¬¬ä¸€ç§ç±»å‹(ç¬¬äºŒç§åŒç†)ï¼Œé‚£ä¹ˆnå°±è¯¥ç­‰äºï¼š</p>
<script type="math/tex; mode=display">
n = (1 + \sum_{i=1}^{z}{b_{pi}}m^{a_{pi}})(1 + \sum_{i=1}^{z}{b_{qi}}m^{a_{qi}})(1 + \sum_{i=1}^{z}{b_{ri}}m^{a_{ri}})</script><p>å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœè¿›è¡Œå±•å¼€çš„è¯ï¼Œåœ¨æ¨¡mä¸‹nå°±ä¸º1(å¦‚æœæ˜¯ç¬¬äºŒç§ç±»å‹å°±ä¸º8)ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç®€å•çˆ†ç ´ä¸€ä¸‹ï¼Œå°±å¯ä»¥æ‹¿åˆ°mï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">301929748923678449872944933611657670834216889867340028357609265175830693931365828840717548752313862343315133541384709574659039910206634528428504034051556622114290811586746168354731258756502196637977942743110508997919976400864419640496894428180120687863921269087080600917900477624095004141559042793509244689248253036809126205146653922738685595903222471152317095497914809983689734189245440774658145462867680027337</span></span><br><span class="line">c = <span class="number">104375152140523502741159687674899095271676058870899569351687154311685938980840028326701029233383897490722759532494438442871187152038720886122756131781086198384270569105043114469786514257765392820254951665751573388426239366215033932234329514161827069071792449190823827669673064646681779764841034307000600929149689291216313319444583032339045277433847691961234044840927155960887984372868669401051358701522484473320</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">2000</span>):</span><br><span class="line">    <span class="keyword">if</span>(n % m == <span class="number">1</span> <span class="keyword">or</span> n % m == <span class="number">8</span>):</span><br><span class="line">        <span class="built_in">print</span>(m)</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯è¿™æ ·å¯ä»¥å‘ç°å¤‡é€‰é¡¹è¿˜æ˜¯æœ‰ä¸€ç‚¹å¤šï¼Œè¿™ä¸ªæ—¶å€™å°±è¦åˆ©ç”¨å¦ä¸€ä¸ªäº‹å®ï¼Œä¹Ÿå°±æ˜¯biåªä¼šæ˜¯0æˆ–1è¿™ä¸ªæ¡ä»¶ã€‚ä»ç„¶ç”¨ç¬¬ä¸€ç§æƒ…å½¢è¿›è¡Œè®¨è®ºï¼Œnå‡å»1åï¼Œä»–åº”è¯¥æ˜¯ä¸€ä¸ªè¾ƒç¨€ç–çš„mè¿›åˆ¶æ•°æ‰å¯¹(ç¬¬äºŒç§ç±»å‹åˆ™ä¸ºn-8)ã€‚æ‰€ä»¥å¯ä»¥ä¼˜åŒ–ä¸€ä¸‹åˆšæ‰çš„è„šæœ¬æ¥å¾—åˆ°æ›´ç¬¦åˆè¦æ±‚çš„mï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getbase</span>(<span class="params">num,base</span>):</span><br><span class="line">    li = []</span><br><span class="line">    <span class="keyword">while</span>(num &gt; <span class="number">0</span>):</span><br><span class="line">        li.append(num % base)</span><br><span class="line">        num //= base</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span>(li)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">301929748923678449872944933611657670834216889867340028357609265175830693931365828840717548752313862343315133541384709574659039910206634528428504034051556622114290811586746168354731258756502196637977942743110508997919976400864419640496894428180120687863921269087080600917900477624095004141559042793509244689248253036809126205146653922738685595903222471152317095497914809983689734189245440774658145462867680027337</span></span><br><span class="line">c = <span class="number">104375152140523502741159687674899095271676058870899569351687154311685938980840028326701029233383897490722759532494438442871187152038720886122756131781086198384270569105043114469786514257765392820254951665751573388426239366215033932234329514161827069071792449190823827669673064646681779764841034307000600929149689291216313319444583032339045277433847691961234044840927155960887984372868669401051358701522484473320</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">2000</span>):</span><br><span class="line">    <span class="keyword">if</span>(n % m == <span class="number">1</span>):</span><br><span class="line">        li = getbase(n-<span class="number">1</span>,m)</span><br><span class="line">        <span class="built_in">print</span>(m,li)</span><br><span class="line">    <span class="keyword">elif</span>(n % m == <span class="number">8</span>):</span><br><span class="line">        li = getbase(n-<span class="number">8</span>,m)</span><br><span class="line">        <span class="built_in">print</span>(m,li)</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºçš„æ•°æ®æ˜¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span> <span class="number">706</span></span><br><span class="line"><span class="number">3</span> <span class="number">862</span></span><br><span class="line"><span class="number">4</span> <span class="number">1059</span></span><br><span class="line"><span class="number">6</span> <span class="number">1226</span></span><br><span class="line"><span class="number">8</span> <span class="number">1629</span></span><br><span class="line"><span class="number">9</span> <span class="number">1744</span></span><br><span class="line"><span class="number">12</span> <span class="number">2004</span></span><br><span class="line"><span class="number">18</span> <span class="number">2954</span></span><br><span class="line"><span class="number">19</span> <span class="number">839</span></span><br><span class="line"><span class="number">24</span> <span class="number">3424</span></span><br><span class="line"><span class="number">29</span> <span class="number">3960</span></span><br><span class="line"><span class="number">36</span> <span class="number">4296</span></span><br><span class="line"><span class="number">53</span> <span class="number">6012</span></span><br><span class="line"><span class="number">58</span> <span class="number">6201</span></span><br><span class="line"><span class="number">72</span> <span class="number">7464</span></span><br><span class="line"><span class="number">87</span> <span class="number">9354</span></span><br><span class="line"><span class="number">106</span> <span class="number">10491</span></span><br><span class="line"><span class="number">116</span> <span class="number">11106</span></span><br><span class="line"><span class="number">159</span> <span class="number">15052</span></span><br><span class="line"><span class="number">174</span> <span class="number">15315</span></span><br><span class="line"><span class="number">212</span> <span class="number">18447</span></span><br><span class="line"><span class="number">232</span> <span class="number">18933</span></span><br><span class="line"><span class="number">261</span> <span class="number">22756</span></span><br><span class="line"><span class="number">318</span> <span class="number">25573</span></span><br><span class="line"><span class="number">348</span> <span class="number">28334</span></span><br><span class="line"><span class="number">361</span> <span class="number">8489</span></span><br><span class="line"><span class="number">424</span> <span class="number">34794</span></span><br><span class="line"><span class="number">477</span> <span class="number">37056</span></span><br><span class="line"><span class="number">522</span> <span class="number">38266</span></span><br><span class="line"><span class="number">607</span> <span class="number">42389</span></span><br><span class="line"><span class="number">636</span> <span class="number">49836</span></span><br><span class="line"><span class="number">696</span> <span class="number">47656</span></span><br><span class="line"><span class="number">954</span> <span class="number">67644</span></span><br><span class="line"><span class="number">1044</span> <span class="number">76347</span></span><br><span class="line"><span class="number">1272</span> <span class="number">85161</span></span><br><span class="line"><span class="number">1537</span> <span class="number">93384</span></span><br><span class="line"><span class="number">1908</span> <span class="number">119410</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡ºmå¾ˆå¯èƒ½ç­‰äº19ã€‚</p>
<p>ç„¶åç”¨.logæ£€æŸ¥ä¸€ä¸‹nåœ¨19è¿›åˆ¶ä¸‹çš„æœ€å¤§æ¬¡æ•°ï¼Œå¯ä»¥å‘ç°æ˜¯321ï¼Œè¯´æ˜pã€qã€rä¸‰ä¸ªç´ æ•°çš„æ¬¡æ•°å·®ä¸å¤šéƒ½åœ¨107å·¦å³ã€‚è€Œåˆå› ä¸ºä½œä¸ºmè¿›åˆ¶çš„æ•°å­—ï¼Œå…¶ç³»æ•°éƒ½ä¸º0æˆ–1ï¼Œå› æ­¤å°±åªéœ€è¦åšä¸ªæ·±æœå³å¯ï¼Œæ·±æœæ€è·¯å’ŒäºŒè¿›åˆ¶ä¸‹æ·±æœåŸºæœ¬æ²¡å·®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">find</span>(<span class="params">pl,ql,rl,h</span>):</span><br><span class="line">    <span class="keyword">if</span>(h &gt; <span class="number">200</span>):</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    mask = m**h</span><br><span class="line">    <span class="keyword">if</span>(pl*ql*rl % mask != n % mask):</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(n % pl == <span class="number">0</span>):</span><br><span class="line">        <span class="built_in">print</span>(pl)</span><br><span class="line">    <span class="keyword">if</span>(n % ql == <span class="number">0</span>):</span><br><span class="line">        <span class="built_in">print</span>(ql)</span><br><span class="line">    <span class="keyword">if</span>(n % rl == <span class="number">0</span>):</span><br><span class="line">        <span class="built_in">print</span>(rl)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">                <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">                    find(i*<span class="number">19</span>**h+pl,j*<span class="number">19</span>**h+ql,k*<span class="number">19</span>**h+rl,h+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">find(<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°pã€qã€rï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">3530869780887683268140728773245395170410635845517928489976021534009516369358447511411853596093628646212566313257712207746790503704123439</span></span><br><span class="line">q = <span class="number">1274643990900453659882765495755380673132370043776742526720540623203930562265302201405804416214498793910236254519606076438989349099317154363</span></span><br><span class="line">r = <span class="number">67086525836865982094673880600810256005961617151283317566078153226175705789594094624822652838168627925461219084263915001883644637391279141</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åå°±æ˜¯å¸¸è§„RSAè§£å¯†ï¼Œè™½ç„¶zå¹¶ä¸çŸ¥é“ï¼Œä½†æ˜¯æ˜¾ç„¶èŒƒå›´ä¹Ÿå¾ˆå°ï¼Œæ‰€ä»¥çˆ†ç ´å°±å¥½ã€‚</p>
<p>å®Œæ•´expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getbase</span>(<span class="params">num,base</span>):</span><br><span class="line">    li = []</span><br><span class="line">    <span class="keyword">while</span>(num &gt; <span class="number">0</span>):</span><br><span class="line">        li.append(num % base)</span><br><span class="line">        num //= base</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span>(li)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">301929748923678449872944933611657670834216889867340028357609265175830693931365828840717548752313862343315133541384709574659039910206634528428504034051556622114290811586746168354731258756502196637977942743110508997919976400864419640496894428180120687863921269087080600917900477624095004141559042793509244689248253036809126205146653922738685595903222471152317095497914809983689734189245440774658145462867680027337</span></span><br><span class="line">c = <span class="number">104375152140523502741159687674899095271676058870899569351687154311685938980840028326701029233383897490722759532494438442871187152038720886122756131781086198384270569105043114469786514257765392820254951665751573388426239366215033932234329514161827069071792449190823827669673064646681779764841034307000600929149689291216313319444583032339045277433847691961234044840927155960887984372868669401051358701522484473320</span></span><br><span class="line"></span><br><span class="line"><span class="comment">############################################### part1 get m</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span>):</span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">2000</span>):</span><br><span class="line">        <span class="keyword">if</span>(n % m == <span class="number">1</span>):</span><br><span class="line">            li = getbase(n-<span class="number">1</span>,m)</span><br><span class="line">            <span class="built_in">print</span>(m,li)</span><br><span class="line">        <span class="keyword">elif</span>(n % m == <span class="number">8</span>):</span><br><span class="line">            li = getbase(n-<span class="number">8</span>,m)</span><br><span class="line">            <span class="built_in">print</span>(m,li)</span><br><span class="line">m = <span class="number">19</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">############################################### part2 find p,q,r</span></span><br><span class="line"><span class="comment">#print(int(n.log(m)))</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find</span>(<span class="params">pl,ql,rl,h</span>):</span><br><span class="line">    <span class="keyword">if</span>(h &gt; <span class="number">200</span>):</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    mask = m**h</span><br><span class="line">    <span class="keyword">if</span>(pl*ql*rl % mask != n % mask):</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(n % pl == <span class="number">0</span>):</span><br><span class="line">        <span class="built_in">print</span>(pl)</span><br><span class="line">    <span class="keyword">if</span>(n % ql == <span class="number">0</span>):</span><br><span class="line">        <span class="built_in">print</span>(ql)</span><br><span class="line">    <span class="keyword">if</span>(n % rl == <span class="number">0</span>):</span><br><span class="line">        <span class="built_in">print</span>(rl)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">                <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">                    find(i*<span class="number">19</span>**h+pl,j*<span class="number">19</span>**h+ql,k*<span class="number">19</span>**h+rl,h+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#find(2,2,2,0)</span></span><br><span class="line">p = <span class="number">3530869780887683268140728773245395170410635845517928489976021534009516369358447511411853596093628646212566313257712207746790503704123439</span></span><br><span class="line">q = <span class="number">1274643990900453659882765495755380673132370043776742526720540623203930562265302201405804416214498793910236254519606076438989349099317154363</span></span><br><span class="line">r = <span class="number">67086525836865982094673880600810256005961617151283317566078153226175705789594094624822652838168627925461219084263915001883644637391279141</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">############################################### part3 dec</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">321</span>):</span><br><span class="line">    e = <span class="number">19</span> ** <span class="number">3</span> + i - <span class="number">2</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        d = inverse(e,phi)</span><br><span class="line">        flag = long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n)))</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">b&quot;CCTF&quot;</span> <span class="keyword">in</span> flag):</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#CCTF&#123;nUmb3r5_1N_D!fFerEn7_8As35_4r3_n!cE!?&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="RM2-64-solves-75-pts"><a href="#RM2-64-solves-75-pts" class="headerlink" title="RM2(64 solves , 75 pts)"></a>RM2(64 solves , 75 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The RM2 cryptosystem is a minimalist design that exhibits remarkable resilience, making it exceptionally difficult to compromise.</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line">	</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">die</span>(<span class="params">*args</span>):</span><br><span class="line">	pr(*args)</span><br><span class="line">	quit()</span><br><span class="line">	</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pr</span>(<span class="params">*args</span>):</span><br><span class="line">	s = <span class="string">&quot; &quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, args))</span><br><span class="line">	sys.stdout.write(s + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">	sys.stdout.flush()</span><br><span class="line">	</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sc</span>(): </span><br><span class="line">	<span class="keyword">return</span> sys.stdin.buffer.readline()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">randstr</span>(<span class="params">l</span>):</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([printable[randint(<span class="number">0</span>, <span class="number">90</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(l)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">msg, p, q</span>):</span><br><span class="line">	e = <span class="number">65537</span></span><br><span class="line">	m1, m2 = msg[:<span class="built_in">len</span>(msg) &gt;&gt; <span class="number">1</span>], msg[<span class="built_in">len</span>(msg) &gt;&gt; <span class="number">1</span>:]</span><br><span class="line">	m1, m2 = bytes_to_long(m1), bytes_to_long(m2)</span><br><span class="line">	c1, c2 = <span class="built_in">pow</span>(m1, e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>)), <span class="built_in">pow</span>(m2, e, (<span class="number">2</span>*p + <span class="number">1</span>) * (<span class="number">2</span>*q + <span class="number">1</span>))</span><br><span class="line">	<span class="keyword">return</span> (c1, c2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">	border = <span class="string">&quot;â”ƒ&quot;</span></span><br><span class="line">	pr(        <span class="string">&quot;â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“&quot;</span>)</span><br><span class="line">	pr(border, <span class="string">&quot;.: Welcome to RM2 task! Your mission is break our cryptosystem :. &quot;</span>, border)</span><br><span class="line">	pr(        <span class="string">&quot;â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›&quot;</span>)</span><br><span class="line">	nbit, _b = <span class="number">1024</span>, <span class="literal">False</span></span><br><span class="line">	pr(border, <span class="string">f&quot;Please provide your desired <span class="subst">&#123;nbit&#125;</span>-bit prime numbers p, q:&quot;</span>)</span><br><span class="line">	inp = sc().decode()</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		p, q = [<span class="built_in">int</span>(_) <span class="keyword">for</span> _ <span class="keyword">in</span> inp.split(<span class="string">&#x27;,&#x27;</span>)]</span><br><span class="line">		<span class="keyword">if</span> p.bit_length() == q.bit_length() == nbit <span class="keyword">and</span> isPrime(p) <span class="keyword">and</span> isPrime(q) <span class="keyword">and</span> p != q:</span><br><span class="line">			_b = <span class="literal">True</span></span><br><span class="line">	<span class="keyword">except</span>:</span><br><span class="line">		die(border, <span class="string">f&quot;The input you provided is is not valid!&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> _b:</span><br><span class="line">		e, n =  <span class="number">65537</span>, p * q</span><br><span class="line">		s = randstr(nbit &gt;&gt; <span class="number">4</span>).encode()</span><br><span class="line">		m = bytes_to_long(s)</span><br><span class="line">		<span class="keyword">assert</span> m &lt; n &gt;&gt; <span class="number">2</span></span><br><span class="line">		c1, c2 = encrypt(s, p, q)</span><br><span class="line">		pr(border, <span class="string">f&#x27;c1 = <span class="subst">&#123;c1&#125;</span>&#x27;</span>)</span><br><span class="line">		pr(border, <span class="string">f&#x27;c2 = <span class="subst">&#123;c2&#125;</span>&#x27;</span>)</span><br><span class="line">		pr(border, <span class="string">f&#x27;Now, send us the secret string to get the flag: &#x27;</span>)</span><br><span class="line">		_m = sc().strip()</span><br><span class="line">		<span class="keyword">if</span> _m == s:</span><br><span class="line">			die(border, <span class="string">f&#x27;Congrats, you got the flag: <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			die(border, <span class="string">f&#x27;The secret string is not correct! Bye!!&#x27;</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		die(border, <span class="string">f&quot;Your input does not meet the requirements!!!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>
<p>ç®€å•æ¥è¯´ï¼Œé¢˜ç›®å¯ä»¥è¾“å…¥ä¸¤ä¸ª1024bitçš„ç´ æ•°pã€qï¼Œä¹‹åä¼šç”Ÿæˆä¸€ä¸ªéšæœºå­—ç¬¦ä¸²sï¼Œå°†å…¶åˆ†ä¸ºä¸¤éƒ¨åˆ†ååˆ†åˆ«å˜ä¸ºæ•´æ•°m1ã€m2ï¼Œå¹¶è®¡ç®—ï¼š</p>
<script type="math/tex; mode=display">
c_1 = m_1^e \quad(mod\;(p-1)(q-1))</script><script type="math/tex; mode=display">
c_2 = m_2^e \quad(mod\;(2p+1)(2q+1))</script><p>ç»™å‡ºc1ã€c2ï¼Œå¦‚æœä¹‹åèƒ½æ­£ç¡®è¾“å…¥sï¼Œå°±å¯ä»¥æ‹¿åˆ°flagã€‚</p>
<p>ä¸¤ä¸ªéƒ½å¯ä»¥çœ‹åšæ˜¯RSAï¼Œæ‰€ä»¥åªè¦çŸ¥é“æ¨¡æ•°çš„å…¨éƒ¨åˆ†è§£å°±å¯ä»¥åšäº†ã€‚è€Œå¯¹äºä¸¤è€…æ¥è¯´éƒ½å¯ä»¥ç”¨ä¸€ä¸ªå¾ˆç®€å•çš„æ–¹æ³•å»æ„é€ ï¼š</p>
<ul>
<li>ç”Ÿæˆç´ æ•°k</li>
<li>ä»¤p=2k+1</li>
<li>æ£€æŸ¥på’Œ2p+1æ˜¯å¦éƒ½æ˜¯ç´ æ•°</li>
</ul>
<p>å¦‚æ­¤ä¸€æ¥å°±æœ‰ï¼š</p>
<script type="math/tex; mode=display">
\phi(p-1) = \phi(2k) = k-1</script><script type="math/tex; mode=display">
\phi(2p+1) = 2p</script><p>ç„¶åå°±è§£RSAå°±è¡Œäº†ã€‚</p>
<p><br></p>
<h3 id="Soufia-36-solves-119-pts"><a href="#Soufia-36-solves-119-pts" class="headerlink" title="Soufia(36 solves , 119 pts)"></a>Soufia(36 solves , 119 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The Soufia equation incorporates an undisclosed random oracle function. Can you analyze the equation and infer the unknown function&#x27;s value?</span><br></pre></td></tr></table></figure>
<p>è¿˜æ˜¯æ²¡æœ‰é™„ä»¶ï¼Œå’ŒBadaç±»ä¼¼ï¼Œé¢˜ç›®å†…å®¹æ˜¯ï¼š</p>
<p>å­˜åœ¨ä¸€ä¸ªæœªçŸ¥çš„å‡½æ•°fï¼Œæ»¡è¶³ï¼š</p>
<script type="math/tex; mode=display">
f(tx) + tf(y) = f(f(x+y))</script><p>ç»™å‡ºä¸¤ä¸ªç‚¹å€¼å¯¹ï¼š</p>
<script type="math/tex; mode=display">
(x_1,f(x_1))</script><script type="math/tex; mode=display">
(x_2,f(x_2))</script><p>è¦æ±‚å¯ä»¥å¯¹ä»»æ„çš„f(x)æ±‚å‡ºxã€‚</p>
<p>è¿™ç§å‡½æ•°æ–¹ç¨‹é¢˜ç›®ä¸€èˆ¬æ¥è¯´è¦åšä»¥ä¸‹å‡ ä¸ªäº‹æƒ…ï¼š</p>
<ul>
<li>å»æ‰å¤šå±‚å¤åˆ</li>
<li>ä»£ä¸€äº›ç‰¹å€¼</li>
</ul>
<p>æ¯”å¦‚å¯¹äºè¿™ä¸ªé¢˜ç›®çš„å‡½æ•°fï¼Œå…ˆä»¤x=0æœ‰</p>
<script type="math/tex; mode=display">
f(0) + tf(y) = f(f(y))</script><p>ç„¶åä»¤y=0ï¼Œx=yå°±å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
f(ty) + tf(0) = f(f(y))</script><p>ä½œå·®å°±å¯ä»¥å»æ‰åŒå±‚å¤åˆï¼Œå¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
f(0) + tf(y) - f(ty) - tf(0) = 0</script><p>å…¶å®åˆ°è¿™é‡Œå¯ä»¥çœ‹å‡ºä¸€ç‚¹ç«¯å€ªï¼Œå°±æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
f(0) - tf(0) = f(ty) - tf(y)</script><p>è¿™å…¶å®ä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯ï¼š</p>
<script type="math/tex; mode=display">
f(t0) - tf(0) = f(ty) - tf(y)</script><p>ä¸Šå¼å¯¹äºä»»æ„çš„yæ’æˆç«‹ï¼Œä¹Ÿå°±æœ‰ï¼š</p>
<script type="math/tex; mode=display">
F(x) = f(tx) - tf(x)</script><p>æ˜¯ä¸€ä¸ªå¸¸å‡½æ•°ã€‚è€Œæ˜¾ç„¶å½“f(x)æ˜¯çº¿æ€§å‡½æ•°ä¸€å®šæ»¡è¶³è¿™ä¸ªæ¡ä»¶ï¼Œæ‰€ä»¥ç›´æ¥ç”±é¢˜ç›®ä¸¤ç‚¹å»ºä¸€ä¸ªçº¿æ€§çš„f(x)å°±å¯ä»¥äº†ã€‚</p>
<p>è€Œè¯´åˆ°è¿™ä¸ªé¢˜ç›®å°±ä¸å¾—ä¸åæ§½ä¸€ä¸‹ä»–çš„é¶æœºï¼Œè¿™ä¸ªé¶æœºä»å¼€å§‹åˆ°æ¯”èµ›ç»“æŸï¼Œæ•´ä¸ªé˜Ÿä¼é‡Œéƒ½åªæœ‰<a target="_blank" rel="noopener" href="https://blog.shangchen.club/">@ä¸Šè¾°</a>èƒ½è¿ä¸Šï¼Œå‘é‚®ä»¶ç»™ä¸»åŠæ–¹ï¼Œä»–ä»¬ä¹Ÿæ²¡å¢åŠ è¿™ä¸ªé¢˜ç›®çš„é¶æœºã€‚<a target="_blank" rel="noopener" href="https://hash-hash.github.io/">@hash-hash</a>åœ¨åšè¿™ä¸ªé¢˜çš„æ—¶å€™æ€ä¹ˆè¿æ€ä¹ˆæŒ‚ï¼Œéå¸¸æŠ˜ç£¨ã€‚</p>
<p><br></p>
<h3 id="Vantuk-51-solves-90-pts"><a href="#Vantuk-51-solves-90-pts" class="headerlink" title="Vantuk(51 solves , 90 pts)"></a>Vantuk(51 solves , 90 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The Vantuk equation is complex, designed to conceal flag components, yet it appears deceptively simple on the surface.</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">u</span>(<span class="params">a, x, y</span>):</span><br><span class="line">	<span class="keyword">assert</span> a.is_integer() <span class="keyword">and</span> x.is_rational() <span class="keyword">and</span> y.is_rational()</span><br><span class="line">	<span class="keyword">return</span> x + Rational((a * x - y)/(x ** <span class="number">2</span> + y ** <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">v</span>(<span class="params">a, x, y</span>):</span><br><span class="line">	<span class="keyword">assert</span> a.is_integer() <span class="keyword">and</span> x.is_rational() <span class="keyword">and</span> y.is_rational()</span><br><span class="line">	<span class="keyword">return</span> y - Rational((x + a * y)/(x ** <span class="number">2</span> + y ** <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">m1 = Integer(bytes_to_long(flag[:<span class="built_in">len</span>(flag)//<span class="number">2</span>]))</span><br><span class="line">m2 = Integer(bytes_to_long(flag[<span class="built_in">len</span>(flag)//<span class="number">2</span>:]))</span><br><span class="line">a = Integer(randint(<span class="number">1</span>, <span class="number">1</span> &lt;&lt; <span class="number">512</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;A = <span class="subst">&#123;u(<span class="number">5</span>, a, <span class="number">4</span>*a)&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;U = <span class="subst">&#123;u(a, m1, m2)&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;V = <span class="subst">&#123;v(a, m1, m2)&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>output.txtï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">A = 6080057478320734754578252336954411086329731226445881868123716230995225973869803901199434606333357820515656618869146654158788168766842914410452961599054518002813068771365518772891986864276289860125347726759503163130747954047189098354503529975642910040243893426023284760560550058749486622149336255123273699589/10166660077500992696786674322778747305573988490459101951030888617339232488971703619809763229396514541455656973227690713112602531083990085142454453827397614</span><br><span class="line">U = 3225614773582213369706292127090052479554140270383744354251548034114969532022146352828696162628127070196943244336606099417210627640399143341122777407316956319347428454301338989662689983156270502206905873768685192940264891098471650041034871787036353839986435/9195042623204647899565271327907071916397082689301388805795886223781949921278129819112624089473306486581983153439866384171645444456400131619437018878598534536108398238424609</span><br><span class="line">V = 1971582892158351181843851788527088806814104010680626247728311504906886858748378948163011806974145871263749452213375101951129675358232283650086419295655854343862361076089682606804214329522917382524296561295274823374483828323983651110722084223144007926678084087/9195042623204647899565271327907071916397082689301388805795886223781949921278129819112624089473306486581983153439866384171645444456400131619437018878598534536108398238424609</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®å°†flagåˆ†ä¸ºä¸¤æ®µm1ã€m2ï¼Œå¹¶å–ä¸€ä¸ªéšæœºæ•°aï¼Œä¹‹åç»™å‡ºä»¥ä¸‹å‡ ä¸ªå€¼ï¼š</p>
<script type="math/tex; mode=display">
A = a + \frac{5a-4a}{a^2 + 16a^2} = \frac{17a^2 + 1}{17a}</script><script type="math/tex; mode=display">
U = m_1 + \frac{am_1-m_2}{m_1^2 + m_2^2}</script><script type="math/tex; mode=display">
V = m_2 - \frac{m_1 + am_2}{m_1^2 + m_2^2}</script><p>è¦æ±‚è¿˜åŸflagã€‚</p>
<p>ç”±äºAä»…ä»…æ˜¯å…³äºaçš„å¼å­ï¼Œæ‰€ä»¥åˆ©ç”¨å…¶åˆ†å­åˆ†æ¯ä¸¤ä¸ªæ–¹ç¨‹åº”è¯¥å¯ä»¥è§£å‡ºaæ¥ï¼Œæ³¨æ„åˆ°åˆ†å­åˆ†æ¯å¯èƒ½æœ‰ç»è¿‡åŒ–ç®€ï¼Œæ‰€ä»¥æŠŠåŒ–ç®€çš„å€æ•°kä¹Ÿå½“ä½œå˜é‡ï¼Œå»è§£ä¸€ä¸ªäºŒå…ƒæ–¹ç¨‹ç»„ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">t1 = <span class="number">6080057478320734754578252336954411086329731226445881868123716230995225973869803901199434606333357820515656618869146654158788168766842914410452961599054518002813068771365518772891986864276289860125347726759503163130747954047189098354503529975642910040243893426023284760560550058749486622149336255123273699589</span></span><br><span class="line">t2 = <span class="number">10166660077500992696786674322778747305573988490459101951030888617339232488971703619809763229396514541455656973227690713112602531083990085142454453827397614</span></span><br><span class="line">PR.&lt;k,a&gt; = PolynomialRing(ZZ)</span><br><span class="line">f1 = <span class="number">17</span>*a^<span class="number">2</span> + <span class="number">1</span> - k*t1</span><br><span class="line">f2 = <span class="number">17</span>*a - k*t2</span><br><span class="line">h = f1.sylvester_matrix(f2, k).det()</span><br><span class="line">res = h.univariate_polynomial().monic().roots()</span><br><span class="line">a = <span class="built_in">int</span>(res[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line"><span class="keyword">assert</span> a &lt; (<span class="number">1</span> &lt;&lt; <span class="number">512</span>)</span><br></pre></td></tr></table></figure>
<p>è§£å¾—aä¸ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">598038828088293688046274960163455723857293440615241291237111095137601911115982565871162542905677325967979821954570041947800148887293534420144379636905742</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°aä¹‹åçš„æ­¥éª¤å°±åŒç†äº†ï¼Œåªä¸è¿‡å˜æˆåˆ©ç”¨Uã€Vå»è§£å…³äºm1ã€m2ã€k1ã€k2çš„æ–¹ç¨‹è€Œå·²ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">######################################################### part1 get a</span></span><br><span class="line">A1 = <span class="number">6080057478320734754578252336954411086329731226445881868123716230995225973869803901199434606333357820515656618869146654158788168766842914410452961599054518002813068771365518772891986864276289860125347726759503163130747954047189098354503529975642910040243893426023284760560550058749486622149336255123273699589</span></span><br><span class="line">A2 = <span class="number">10166660077500992696786674322778747305573988490459101951030888617339232488971703619809763229396514541455656973227690713112602531083990085142454453827397614</span></span><br><span class="line">PR.&lt;k,a&gt; = PolynomialRing(ZZ)</span><br><span class="line">f1 = <span class="number">17</span>*a^<span class="number">2</span> + <span class="number">1</span> - k*A1</span><br><span class="line">f2 = <span class="number">17</span>*a - k*A2</span><br><span class="line">h = f1.sylvester_matrix(f2, k).det()</span><br><span class="line">res = h.univariate_polynomial().monic().roots()</span><br><span class="line">a = <span class="built_in">int</span>(res[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line"><span class="keyword">assert</span> a &lt; (<span class="number">1</span> &lt;&lt; <span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">######################################################### part2 get m1,m2</span></span><br><span class="line">U1 = <span class="number">3225614773582213369706292127090052479554140270383744354251548034114969532022146352828696162628127070196943244336606099417210627640399143341122777407316956319347428454301338989662689983156270502206905873768685192940264891098471650041034871787036353839986435</span></span><br><span class="line">U2 = <span class="number">9195042623204647899565271327907071916397082689301388805795886223781949921278129819112624089473306486581983153439866384171645444456400131619437018878598534536108398238424609</span></span><br><span class="line">V1 = <span class="number">1971582892158351181843851788527088806814104010680626247728311504906886858748378948163011806974145871263749452213375101951129675358232283650086419295655854343862361076089682606804214329522917382524296561295274823374483828323983651110722084223144007926678084087</span></span><br><span class="line">V2 = <span class="number">9195042623204647899565271327907071916397082689301388805795886223781949921278129819112624089473306486581983153439866384171645444456400131619437018878598534536108398238424609</span></span><br><span class="line"></span><br><span class="line">PR.&lt;k1,k2,m1,m2&gt; = PolynomialRing(ZZ)</span><br><span class="line">f1 = m1*(m1^<span class="number">2</span>+m2^<span class="number">2</span>) + a*m1 - m2 - k1*U1</span><br><span class="line">f2 = m1^<span class="number">2</span> + m2^<span class="number">2</span> - k1*U2</span><br><span class="line">f3 = m2*(m1^<span class="number">2</span>+m2^<span class="number">2</span>) - m1 - a*m2 - k2*V1</span><br><span class="line">f4 = m1^<span class="number">2</span> + m2^<span class="number">2</span> - k2*V2</span><br><span class="line"></span><br><span class="line">g1 = f1.sylvester_matrix(f2, k1).det()</span><br><span class="line">g2 = f3.sylvester_matrix(f4, k2).det()</span><br><span class="line"></span><br><span class="line">hm1 = g1.sylvester_matrix(g2, m2).det().univariate_polynomial().monic().roots()</span><br><span class="line">hm2 = g1.sylvester_matrix(g2, m1).det().univariate_polynomial().monic().roots()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(hm1[<span class="number">0</span>][<span class="number">0</span>])) + long_to_bytes(<span class="built_in">int</span>(hm2[<span class="number">0</span>][<span class="number">0</span>])))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#CCTF&#123;d!D_y0U_5oLv3_7HiS_eQu4T!On_wItH_uSing_c0mPlEx_Num8erS!!?&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h2 id="Hard"><a href="#Hard" class="headerlink" title="Hard"></a>Hard</h2><h3 id="Chochol-15-solves-226-pts"><a href="#Chochol-15-solves-226-pts" class="headerlink" title="Chochol(15 solves , 226 pts)"></a>Chochol(15 solves , 226 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Chochol is an unusual cryptosystem that encrypts messages by blending them within elliptic curves - see if you can crack it.</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">keygen</span>(<span class="params">nbit</span>):</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		p, q = [getPrime(nbit) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]</span><br><span class="line">		<span class="keyword">if</span> p % <span class="number">4</span> == q % <span class="number">4</span> == <span class="number">3</span> <span class="keyword">and</span> p &lt; q:</span><br><span class="line">			a = randint(<span class="number">1</span>, p - <span class="number">1</span>)</span><br><span class="line">			Ep, Eq = EllipticCurve(GF(p), [a, <span class="number">0</span>]), EllipticCurve(GF(q), [a, <span class="number">0</span>])</span><br><span class="line">			<span class="keyword">try</span>:</span><br><span class="line">				Gp, Gq = Ep.lift_x(<span class="number">2024</span>), Eq.lift_x(<span class="number">2024</span>)</span><br><span class="line">				s = randint(<span class="number">1</span>, p)</span><br><span class="line">				Hp, Hq = s * Gp, s * Gq</span><br><span class="line">				pkey = (Gp, Hp, Gq, Hq)</span><br><span class="line">				skey = (p, q, s)</span><br><span class="line">				<span class="keyword">return</span> pkey, skey</span><br><span class="line">			<span class="keyword">except</span>:</span><br><span class="line">				<span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">pkey, skey = keygen(<span class="number">128</span>)</span><br><span class="line">p, q, s = skey</span><br><span class="line">n = p * q</span><br><span class="line">m = bytes_to_long(flag.lstrip(<span class="string">b&#x27;CCTF&#123;&#x27;</span>).rstrip(<span class="string">b&#x27;&#125;&#x27;</span>))</span><br><span class="line"><span class="keyword">assert</span> m &lt; n</span><br><span class="line">c = <span class="built_in">pow</span>(m, s, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Gp = <span class="subst">&#123;pkey[<span class="number">0</span>].xy()&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Hp = <span class="subst">&#123;pkey[<span class="number">1</span>].xy()&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Gq = <span class="subst">&#123;pkey[<span class="number">2</span>].xy()&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Hq = <span class="subst">&#123;pkey[<span class="number">3</span>].xy()&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c  = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>output.txtï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Gp = (2024, 77522466419731346352388161327659294096)</span><br><span class="line">Hp = (187001239996895215821259450553198409012, 158495938026527642884038157170741730943)</span><br><span class="line">Gq = (2024, 92609909821520263487623088269239797003)</span><br><span class="line">Hq = (191534442430060308634251661645421139195, 102273233384427938890774177710170123915)</span><br><span class="line">c  = 15084463560924811262750235394027264639346464192638172940901706702947534963652</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®éå¸¸éå¸¸çš„ç›´ç™½ï¼Œç»™å‡ºä¸¤æ¡æ¤­åœ†æ›²çº¿ï¼š</p>
<script type="math/tex; mode=display">
E_p:y^2 = x^3 + ax \quad(mod\;p)</script><script type="math/tex; mode=display">
E_q:y^2 = x^3 + ax \quad(mod\;q)</script><p>ç„¶åç”Ÿæˆéšæœºæ•°sï¼Œå¹¶ç»™å‡ºå››ä¸ªç‚¹Gp,Gq,Hp,Hqï¼Œæ»¡è¶³ï¼š</p>
<script type="math/tex; mode=display">
H_p = sG_p</script><script type="math/tex; mode=display">
H_q = sG_q</script><p>æœ€åæŠŠflagè¿›è¡ŒRSAåŠ å¯†å¹¶ç»™å‡ºcï¼š</p>
<script type="math/tex; mode=display">
c = m^s \quad(mod\;n)</script><p>è¦æ±‚è¿˜åŸflagã€‚</p>
<p>è¦è§£æœ€åçš„RSAï¼Œä¸ä»…è¦æœ‰åŠ å¯†æŒ‡æ•°sï¼Œä¹Ÿéœ€è¦æœ‰nçš„åˆ†è§£ï¼Œè€Œæˆ‘ä»¬çš„æ•°æ®ä»…æœ‰å¯†æ–‡cå’Œå››ä¸ªç‚¹Gp,Gq,Hp,Hqï¼Œå¹¶æ²¡æœ‰ä»–ä»¬æ‰€åœ¨æœ‰é™åŸŸçš„ä¿¡æ¯ã€‚æ‰€ä»¥ç¬¬ä¸€æ­¥åªèƒ½æ˜¯åˆ©ç”¨ç‚¹åœ¨æ›²çº¿ä¸Šè¿™ä¸ªä¿¡æ¯ï¼Œå»æ¶ˆaæˆ–è€…åšä¸€æ¬¡groebnerå¾—åˆ°ä¸€ä¸ªpçš„å€æ•°k1pï¼ŒåŒç†ä¹Ÿå°±æœ‰k2qã€‚ç”±äºpã€qéƒ½åªæœ‰128bitï¼Œæ‰€ä»¥æŒ‚yafuæœ‰æœºä¼šåˆ†è§£å‡ºæ¥ï¼Œåˆå› ä¸ºä¸¤ä¸ªæ›²çº¿aç›¸åŒï¼Œæ‰€ä»¥ä¸¤ä¸ªä¸€èµ·æŒ‚ï¼Œè°æ›´å¿«æŒ‚å‡ºæ¥å°±å¯ä»¥ç›´æ¥æ±‚aï¼Œé‚£å¦ä¸€ä¸ªå°±å¯ä»¥ä¸ç”¨æŒ‚äº†ã€‚</p>
<p>å¾—åˆ°pã€qä¹‹åå°±å¥½åŠäº†ï¼Œå¯¹åŒæºç†Ÿæ‚‰ä¸€äº›çš„è¯å¯ä»¥çŸ¥é“pã€qæ¨¡4ä½™3å¹¶ä¸”æ˜¯è¿™ä¸ªæ›²çº¿æ–¹ç¨‹å½¢å¼æ—¶ï¼Œè¿™æ˜¯ä¸€æ¡è¶…å¥‡å¼‚æ¤­åœ†æ›²çº¿ï¼Œé˜¶ä¸ºp+1ï¼Œæ‰€ä»¥æ—¢å¯ä»¥åšMOV attackæ±‚å‡ºsï¼Œä¹Ÿå¯ä»¥é€‰å–p+1çš„ä¸€äº›å°å› å­å’Œq+1çš„ä¸€äº›å°å› å­å»Pohlig-Hellmanï¼Œå†crtèµ·æ¥å°±è¡Œã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">Gp = (<span class="number">2024</span>, <span class="number">77522466419731346352388161327659294096</span>)</span><br><span class="line">Hp = (<span class="number">187001239996895215821259450553198409012</span>, <span class="number">158495938026527642884038157170741730943</span>)</span><br><span class="line">Gq = (<span class="number">2024</span>, <span class="number">92609909821520263487623088269239797003</span>)</span><br><span class="line">Hq = (<span class="number">191534442430060308634251661645421139195</span>, <span class="number">102273233384427938890774177710170123915</span>)</span><br><span class="line">c  = <span class="number">15084463560924811262750235394027264639346464192638172940901706702947534963652</span></span><br><span class="line"></span><br><span class="line"><span class="comment">############################# get q</span></span><br><span class="line">q = <span class="number">278451262698064898668334196027031252819</span></span><br><span class="line">PR.&lt;a&gt; = PolynomialRing(Zmod(q))</span><br><span class="line">x3,y3 = Gq[<span class="number">0</span>],Gq[<span class="number">1</span>]</span><br><span class="line">x4,y4 = Hq[<span class="number">0</span>],Hq[<span class="number">1</span>]</span><br><span class="line">f3 = y3^<span class="number">2</span> - x3^<span class="number">3</span> - a*x3</span><br><span class="line">f4 = y4^<span class="number">2</span> - x4^<span class="number">3</span> - a*x4</span><br><span class="line">qq = <span class="number">1293030084926293436183849323949823514874151405643244735656543151754612840701244335038404810744976684941536215639890425</span></span><br><span class="line">q = <span class="number">278451262698064898668334196027031252819</span></span><br><span class="line">fac = <span class="number">28338689773015872412188935645719088445835579</span></span><br><span class="line">res = Ideal([f3,f4]).groebner_basis()</span><br><span class="line">a = q - <span class="number">150779601446914247367064450767283168919</span></span><br><span class="line"></span><br><span class="line"><span class="comment">############################# get p</span></span><br><span class="line">x1,y1 = Gp[<span class="number">0</span>],Gp[<span class="number">1</span>]</span><br><span class="line">x2,y2 = Hp[<span class="number">0</span>],Hp[<span class="number">1</span>]</span><br><span class="line">f1 = y1^<span class="number">2</span> - x1^<span class="number">3</span> - a*x1</span><br><span class="line">f2 = y2^<span class="number">2</span> - x2^<span class="number">3</span> - a*x2</span><br><span class="line">pp = <span class="number">1408163190634528995462435641953100501680643957675634911266005150804547379301555317411069040554339057760687942005173</span></span><br><span class="line">p = <span class="number">243678574849421895808521345944938402807</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Ep, Eq = EllipticCurve(GF(p), [a, <span class="number">0</span>]), EllipticCurve(GF(q), [a, <span class="number">0</span>])</span><br><span class="line">Gp = Ep(Gp)</span><br><span class="line">Hp = Ep(Hp)</span><br><span class="line">Gq = Eq(Gq)</span><br><span class="line">Hq = Eq(Hq)</span><br><span class="line"></span><br><span class="line"><span class="comment">############################ </span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span>):</span><br><span class="line">    ordp = Ep.order()</span><br><span class="line">    ordq = Eq.order()</span><br><span class="line">    <span class="built_in">print</span>(factor(ordp))</span><br><span class="line">    <span class="built_in">print</span>(factor(ordq))</span><br><span class="line"></span><br><span class="line">    r2 = <span class="number">321810878759529563693</span></span><br><span class="line">    sp = (Hp).log(Gp)</span><br><span class="line">    <span class="built_in">print</span>(sp)</span><br><span class="line">    sq = (r2*Hq).log(r2*Gq)</span><br><span class="line"></span><br><span class="line">    modp = Ep.order()</span><br><span class="line">    modq = Eq.order() // r2</span><br><span class="line"></span><br><span class="line">    s = crt([modp,modq] , [sp,sq])[<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s = <span class="number">172134561985710786674839705035313724070</span></span><br><span class="line"><span class="keyword">assert</span> s*Gp == Hp <span class="keyword">and</span> s*Gq == Hq</span><br><span class="line">tt = GCD(s,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">d = inverse(s//tt,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">n = p*q</span><br><span class="line">m16 = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">d = inverse(s//<span class="number">6</span>,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,p*q)</span><br><span class="line">mp = m%p</span><br><span class="line">mq = m%q</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(GF(p))</span><br><span class="line">f = x^<span class="number">6</span>-mp</span><br><span class="line">pp = (f.roots())</span><br><span class="line">R.&lt;x&gt; = PolynomialRing(GF(q))</span><br><span class="line">f = x^<span class="number">6</span>-mq</span><br><span class="line">qq = (f.roots())</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> pp:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> qq:</span><br><span class="line">        m = crt([<span class="built_in">int</span>(i[<span class="number">0</span>]),<span class="built_in">int</span>(j[<span class="number">0</span>])],[p,q])</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)).decode())</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#CCTF&#123;m1X!n9__3cC__&amp;_R54_!&#125;</span></span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªé¢˜å¼€å§‹flagå€¼ä¸å¯¹ï¼Œå’Œ<a target="_blank" rel="noopener" href="https://yolbby.github.io/">@yolbby</a>ä¸€èµ·åšå‡ºæ¥ä¹‹åæ€ä¹ˆéƒ½äº¤ä¸ä¸Šã€‚è¿™å…¨æ˜¯å¯è§å­—ç¬¦ï¼Œè¯­å¥è¿˜æœ‰æ„ä¹‰ï¼Œè¿™è¿˜èƒ½ä¸å¯¹ï¼Ÿå‘é‚®ä»¶ç»™ä¸»åŠæ–¹ä¹‹åå‘ç°ç¡®å®æ˜¯ä»–ä»¬è®¾ç½®é”™äº†ã€‚ã€‚ã€‚</p>
<p><br></p>
<h3 id="Imen-19-solves-194-pts"><a href="#Imen-19-solves-194-pts" class="headerlink" title="Imen(19 solves , 194 pts)"></a>Imen(19 solves , 194 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Imen presents a challenging task involving a novel and creative cryptosystem, inviting you to attempt to break it and obtain the flag.</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">load(<span class="string">&#x27;secret.sage&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">die</span>(<span class="params">*args</span>):</span><br><span class="line">	pr(*args)</span><br><span class="line">	quit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pr</span>(<span class="params">*args</span>):</span><br><span class="line">	s = <span class="string">&quot; &quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, args))</span><br><span class="line">	sys.stdout.write(s + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">	sys.stdout.flush()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sc</span>():</span><br><span class="line">	<span class="keyword">return</span> sys.stdin.buffer.readline()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genimen</span>(<span class="params">k, p, _B</span>):</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		A = random_matrix(GF(p), k)</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">			<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">				A[i, j] = <span class="built_in">int</span>(A[i, j]) % (_B + <span class="number">1</span>)</span><br><span class="line">		<span class="keyword">if</span> det(A) != <span class="number">0</span>:</span><br><span class="line">			<span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">	border = <span class="string">&quot;â”ƒ&quot;</span></span><br><span class="line">	pr(        <span class="string">&quot;â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“&quot;</span>)</span><br><span class="line">	pr(border, <span class="string">&quot;Hi all, now it&#x27;s time to solve a new and creative IMEN challenge    &quot;</span>, border)</span><br><span class="line">	pr(border, <span class="string">&quot;In each step, try to find the unknown permutation to get the flag!  &quot;</span>, border)</span><br><span class="line">	pr(        <span class="string">&quot;â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›&quot;</span>)</span><br><span class="line">	nbit, step = <span class="number">128</span>, <span class="number">12</span></span><br><span class="line">	<span class="keyword">for</span> level <span class="keyword">in</span> <span class="built_in">range</span>(step):</span><br><span class="line">		k, l, p, B = <span class="number">3</span>, <span class="number">12</span> + level, getPrime(nbit), <span class="number">14</span> + (level + <span class="number">1</span>)</span><br><span class="line">		nbit = <span class="built_in">int</span>((k * l) ** B).bit_length() + <span class="number">5</span> </span><br><span class="line">		<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">			A = [genimen(k, p, B) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(l)]</span><br><span class="line">			L = <span class="built_in">list</span>(<span class="built_in">range</span>(l))</span><br><span class="line">			shuffle(L)</span><br><span class="line">			M = prod([A[_] <span class="keyword">for</span> _ <span class="keyword">in</span> L])</span><br><span class="line">			<span class="keyword">if</span> check(A, M): <span class="keyword">break</span></span><br><span class="line">		<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">			pr(<span class="string">f&quot;| Options: \n|\t[G]et <span class="subst">&#123;l&#125;</span> matrices \n|\t[P]roduct of matrices \n|\t[S]ubmit the permutation \n|\t[Q]uit&quot;</span>)</span><br><span class="line">			ans = sc().decode().lower().strip()</span><br><span class="line">			<span class="keyword">if</span> ans == <span class="string">&#x27;g&#x27;</span>:</span><br><span class="line">				<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">					pr(border, <span class="string">f&#x27;<span class="subst">&#123;A[i]&#125;</span>&#x27;</span>)</span><br><span class="line">			<span class="keyword">elif</span> ans == <span class="string">&#x27;p&#x27;</span>:</span><br><span class="line">				pr(border, <span class="string">f&#x27;M = <span class="subst">&#123;M&#125;</span>&#x27;</span>)</span><br><span class="line">			<span class="keyword">elif</span> ans == <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">				_p = sc().decode()</span><br><span class="line">				<span class="keyword">try</span>:</span><br><span class="line">					_p = [<span class="built_in">int</span>(_) <span class="keyword">for</span> _ <span class="keyword">in</span> _p.split(<span class="string">&#x27;,&#x27;</span>)]</span><br><span class="line">				<span class="keyword">except</span>:</span><br><span class="line">					die(border, <span class="string">f&#x27;Your permutation is not valid!&#x27;</span>)</span><br><span class="line">				<span class="keyword">if</span> _p == L:</span><br><span class="line">					<span class="keyword">if</span> level == step - <span class="number">1</span>:</span><br><span class="line">						die(border, <span class="string">f&#x27;Congratulation! You got the flag: <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br><span class="line">					<span class="keyword">else</span>:</span><br><span class="line">						pr(border, <span class="string">f&#x27;gj, you got the <span class="subst">&#123;level&#125;</span>, try the next level now!&#x27;</span>)</span><br><span class="line">						<span class="keyword">break</span></span><br><span class="line">				<span class="keyword">else</span>:</span><br><span class="line">					die(border, <span class="string">f&#x27;The permutation is not corr3ct! Bye!!&#x27;</span>)</span><br><span class="line">			<span class="keyword">elif</span> ans == <span class="string">&#x27;q&#x27;</span>:</span><br><span class="line">				die(border, <span class="string">&#x27;Quitting...&#x27;</span>)</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				die(border, <span class="string">&#x27;You should select valid choice!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®å…±12è½®æŒ‘æˆ˜ï¼Œæ¯ä¸€è½®æŒ‘æˆ˜æµç¨‹æ˜¯ï¼š</p>
<ul>
<li><p>ç”Ÿæˆç´ æ•°pï¼Œå¤§å°éšè½®æ•°å¢åŠ </p>
</li>
<li><p>ç”Ÿæˆ $l$ ä¸ªæ¨¡pä¸‹çš„çŸ©é˜µï¼Œä¸ªæ•°ä¹Ÿéšè½®æ•°å¢åŠ ï¼š</p>
<script type="math/tex; mode=display">
A_1,A_2,...,A_l</script></li>
<li><p>éšæœºæ‰“ä¹±çŸ©é˜µæ¬¡åºåï¼Œè®¡ç®—ä¹˜ç§¯Mï¼š</p>
<script type="math/tex; mode=display">
M = A_iA_j...A_k \quad(i,j,...,k = Permutation(1,2,...,l))</script></li>
<li><p>ç»™å‡ºMå’ŒæŒ‰é¡ºåºçš„çŸ©é˜µåˆ—è¡¨ï¼Œè¦æ±‚è®¡ç®—å‡ºè¿™ä¸ªç½®æ¢</p>
</li>
</ul>
<p>å®Œæˆå…¨éƒ¨12è½®æŒ‘æˆ˜å°±å¯ä»¥æ‹¿åˆ°flagäº†ã€‚</p>
<p>æ³¨æ„åˆ°ç”ŸæˆçŸ©é˜µAiæ—¶ï¼Œé™¤äº†å›ºå®šçš„ç»´æ•°kã€éšæœºçš„ç´ æ•°pä»¥å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªå‚æ•°æ˜¯Bï¼Œä»–æŠŠAä¸­çš„æ¯ä¸ªå…ƒç´ é™åˆ¶åœ¨äº†0-Bå†…ã€‚ç”Ÿæˆå‡ ç»„æ•°æ®å¯ä»¥å‘ç°ï¼Œè¿™æ ·åšä¹‹åï¼ŒMå…¶å®æ ¹æœ¬å°±æ²¡æœ‰æ¨¡pï¼Œæ˜¯åœ¨ZZä¸Šæˆç«‹çš„ã€‚</p>
<p>æ‰€ä»¥æ€è·¯å°±å¾ˆå¥½åŠï¼Œæˆ‘ä»¬æšä¸¾Aä¸­çš„æ‰€æœ‰å…ƒç´ Asï¼Œå»è®¡ç®—ï¼š</p>
<script type="math/tex; mode=display">
T = A_s^{-1}M = A_s^{-1}A_iA_j...A_k</script><p>é€†çŸ©é˜µåœ¨ZZä¸‹æ±‚å³å¯ï¼Œå¯ä»¥å‘ç°ï¼Œç”±äºçŸ©é˜µä¹˜æ³•æ²¡æœ‰äº¤æ¢å¾‹ï¼Œæ‰€ä»¥å½“ä¸”ä»…å½“æšä¸¾åˆ°Asä¸ºAiçš„æ—¶å€™ï¼Œæ°å¥½å¯ä»¥æ¶ˆæ‰ï¼Œä¹Ÿå°±æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
T = A_i^{-1}M = (A_i^{-1}A_i)A_j...A_k = A_j...A_k</script><p>æ‰€ä»¥ä»æ˜¯ä¸€ä¸ªZZä¸‹çš„çŸ©é˜µï¼Œè€Œå…¶ä»–çš„çŸ©é˜µä¼šå¯¼è‡´Tä¸å†æ˜¯ZZä¸‹çš„çŸ©é˜µï¼Œå› æ­¤å°±å¯ä»¥æ±‚å‡ºç½®æ¢äº†ã€‚(å› ä¸ºZZå¹¶ä¸æ˜¯ä¸€ä¸ªåŸŸï¼Œé‡Œé¢é™¤å»0çš„å…ƒç´ å¹¶ä¸éƒ½æœ‰ä¹˜æ³•é€†å…ƒï¼Œæ‰€ä»¥æ±‚é€†ä¼šå‡ºç°åˆ†æ•°)</p>
<p>å¯ä»¥ç”¨ä¸‹é¢çš„è„šæœ¬ç®€å•éªŒè¯è¿™ä¸ªæ€è·¯çš„æ­£ç¡®æ€§ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genimen</span>(<span class="params">k, p, _B</span>):</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		A = random_matrix(GF(p), k)</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">			<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">				A[i, j] = <span class="built_in">int</span>(A[i, j]) % (_B + <span class="number">1</span>)</span><br><span class="line">		<span class="keyword">if</span> det(A) != <span class="number">0</span>:</span><br><span class="line">			<span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line">nbit, step = <span class="number">128</span>, <span class="number">12</span></span><br><span class="line"><span class="keyword">for</span> level <span class="keyword">in</span> <span class="built_in">range</span>(step):</span><br><span class="line">	k, l, p, B = <span class="number">3</span>, <span class="number">12</span> + level, getPrime(nbit), <span class="number">14</span> + (level + <span class="number">1</span>)</span><br><span class="line">	nbit = <span class="built_in">int</span>((k * l) ** B).bit_length() + <span class="number">5</span> </span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		A = [genimen(k, p, B) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(l)]</span><br><span class="line">		L = <span class="built_in">list</span>(<span class="built_in">range</span>(l))</span><br><span class="line">		M = prod([A[_] <span class="keyword">for</span> _ <span class="keyword">in</span> L])</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">f&quot;Round <span class="subst">&#123;level&#125;</span>:&quot;</span>)</span><br><span class="line">	<span class="built_in">print</span>(Matrix(ZZ,A[<span class="number">0</span>])^(-<span class="number">1</span>)*Matrix(ZZ,M))</span><br><span class="line">	<span class="built_in">print</span>(Matrix(ZZ,A[<span class="number">1</span>])^(-<span class="number">1</span>)*Matrix(ZZ,M))</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªé¢˜ç›®åœ¨æ²¡æœ‰updateä¹‹å‰ï¼Œå¥½åƒæœ€åå‡ è½®çŸ©é˜µçš„å€¼ä¼šè¶…è¿‡pï¼Œå¯èƒ½å°±ä¸å¤ªå¥½åšäº†ã€‚è¿˜æœ‰è¿™ä¸ªé¢˜ç›®çš„è¾“å…¥è¾“å‡ºå¤„ç†æ›´æ˜¯ä¾æ‰˜ã€‚</p>
<p><br></p>
<h3 id="Latifa-22-solves-174-pts"><a href="#Latifa-22-solves-174-pts" class="headerlink" title="Latifa(22 solves , 174 pts)"></a>Latifa(22 solves , 174 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Latifa is a tricky yet enjoyable challenge, akin to solving a puzzle in a dream-like state.</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> b, g, flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m, b, g</span>):</span><br><span class="line">	i, c = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		N, D = b * g, n(<span class="built_in">pow</span>(g, Rational(<span class="number">2</span>*i/m)), prec = b) + g</span><br><span class="line">		s = N/D</span><br><span class="line">		c += s</span><br><span class="line">		i += <span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span> i &gt;= m:</span><br><span class="line">			<span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag.lstrip(<span class="string">b&#x27;CCTF&#123;&#x27;</span>).rstrip(<span class="string">b&#x27;&#125;&#x27;</span>))</span><br><span class="line">c = encrypt(m, b, g)</span><br><span class="line"><span class="comment"># Takes many many years :(</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>output.txtï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="number">1.802740943639362458394687428102524270510281665315000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e47</span></span><br></pre></td></tr></table></figure>
<p>6.9çš„å‡Œæ™¨å…­ç‚¹å·¦å³ï¼Œæˆ‘å’Œ<a target="_blank" rel="noopener" href="https://yolbby.github.io/">@yolbby</a>åšå®ŒChocholä¹‹åæ€ä¹ˆéƒ½äº¤ä¸ä¸Šflag(åŸå› å°±æ˜¯ä¸Šé¢è¯´çš„ï¼Œä¸»åŠæ–¹flagè®¾ç½®é”™äº†)ã€‚ç„¶åä»–è¯´ä»–å»çœ‹ç‚¹åˆ«çš„ï¼Œå°±å»çœ‹äº†è¿™ä¸ªLatifaã€‚</p>
<p>ç»“æœ10åˆ†é’Ÿå·¦å³ä»–å°±åšå®Œå›æ¥äº†ï¼š</p>
<p><img src="/post/cf09b856/image-20240701095249427.png" alt="image-20240701095249427"></p>
<p><img src="/post/cf09b856/image-20240701095316721.png" alt="image-20240701095316721"></p>
<p>ç„¶åå°±å¥½å¥‡åœ°æ¥çœ‹äº†ä¸€ä¸‹è¿™ä¸ªé¢˜ç›®ï¼Œä»–ç”¨æœªçŸ¥çš„bã€gï¼Œå¯¹flagè¿›è¡Œäº†å¦‚ä¸‹åŠ å¯†ï¼š</p>
<script type="math/tex; mode=display">
c = \sum_{i=0}^{m-1}\frac{bg}{g^{\frac{2i}{m}} + g}</script><p>æŠŠä¸Šä¸‹çš„gçº¦ä¸€ä¸‹å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
c = \sum_{i=0}^{m-1}\frac{b}{g^{\frac{2i}{m}-1} + 1}</script><p>ç”±äºè¿™å­¦æœŸåˆšå¥½é€‰ä¿®äº†ä¸€é—¨ç”µå­ä¿¡æ¯æ•°å­¦åŸºç¡€ï¼Œé‡æ¸©äº†ä¸‹é«˜æ•°ï¼Œæ‰€ä»¥çœ‹åˆ°è¿™ä¸ªæƒ³åˆ°äº†å®šç§¯åˆ†ï¼Œä½†æ˜¯æ—¢ç„¶ååˆ†é’Ÿå°±èƒ½æå®šï¼Œåº”è¯¥ä¸æ˜¯è¿™ä¹ˆåšçš„å§ï¼Ÿ</p>
<p>é¦–å…ˆå¯ä»¥å‘ç°cæœ€åçš„å€¼ä¸€å®šåŒ…å«å› å­bï¼Œæ‰€ä»¥å…ˆæŸ¥ä¸€ä¸‹cçš„æ‰€æœ‰å› å­ç»„åˆæ‰¾ä¸€ä¸‹bã€‚ä½†æ˜¯æ ¹æœ¬ä¸çŸ¥é“æ€ä¹ˆåˆ¤æ–­bæ­£ä¸æ­£ç¡®ï¼Œæ‰€ä»¥æ‰“å°äº†ä¸€ä¸‹long_to_bytesï¼Œç»“æœå°±å‡ºäº†â€¦â€¦</p>
<p>æˆ‘ä¹Ÿå¾ˆæ‡µï¼Œçœ‹äº†ä¸‹yolbbyå†™åœ¨æ–‡æ¡£çš„ä¸œè¥¿ä¹Ÿæ˜¯è¿™ä¹ˆåšçš„ï¼Œç­‰ä»–æœŸæœ«è€ƒå®Œé—®é—®ä»–å½“æ—¶åšè¿™ä¸ªæ˜¯æ€ä¹ˆæƒ³ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a = [<span class="number">3</span>,<span class="number">5</span>,<span class="number">379</span>,<span class="number">39719</span>,<span class="number">8959787</span>,<span class="number">891059823255825019255461632769683</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">7</span>):</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> combinations(a,t):</span><br><span class="line">		l = prod(i)</span><br><span class="line">		<span class="keyword">try</span>:</span><br><span class="line">			<span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(l)).decode())</span><br><span class="line">		<span class="keyword">except</span>:</span><br><span class="line">			<span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">#CCTF&#123;h4Lf_7UrN_5ym3Try!&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="O7R-23-solves-169-pts"><a href="#O7R-23-solves-169-pts" class="headerlink" title="O7R(23 solves , 169 pts)"></a>O7R(23 solves , 169 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The O7R cryptosystem combines RSA key recovery techniques with a 7-segment digit representation, resulting in a unique and robust design.</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ç»™çš„æ˜¯pdfæ–‡ä»¶ï¼Œæ ¸å¿ƒä¸€ç‚¹çš„éƒ¨åˆ†æ˜¯ï¼š</p>
<p><img src="/post/cf09b856/image-20240701103055895.png" alt="image-20240701103055895"></p>
<p><img src="/post/cf09b856/image-20240701103126855.png" alt="image-20240701103126855"></p>
<p>æ•°æ®ï¼š</p>
<p><img src="/post/cf09b856/image-20240701103144061.png" alt="image-20240701103144061"></p>
<p><img src="/post/cf09b856/image-20240701103159097.png" alt="image-20240701103159097"></p>
<p><img src="/post/cf09b856/image-20240701103349848.png" alt="image-20240701103349848"></p>
<p>å…ˆé˜è¿°ä¸‹é¢˜ç›®å†…å®¹ï¼Œé¢˜ç›®ç»™å‡ºäº†ç”¨ä¸ƒæ®µæ•°ç ç®¡è¡¨ç¤ºçš„pã€qã€nã€n^2ã€cç­‰äº”ä¸ªæ•°å€¼ï¼Œä»–ä»¬æ»¡è¶³ï¼š</p>
<ul>
<li>cæ˜¯æ²¡æœ‰æŸåçš„(ä¹Ÿå°±æ˜¯cçš„æ‰€æœ‰æ•°å­—éƒ½å®Œå¥½)</li>
<li>å‰©ä½™çš„å››ä¸ªæ•°å€¼ï¼Œéƒ½æ˜¯ç»è¿‡äº†æŸåçš„ï¼ŒæŸåçš„å«ä¹‰æ˜¯ï¼šæ¯ä¸ªä¸ƒæ®µæ•°ç ç®¡è¡¨ç¤ºçš„æ•°å­—ï¼Œæœ‰50%çš„æ¦‚ç‡çˆ†æ‰éšæœºä¸€æ ¹æ•°ç ç®¡</li>
</ul>
<p>è¦æ±‚è¿˜åŸflagã€‚</p>
<p>é¦–å…ˆæ˜ç¡®è¿™ä¸ªæŸåçš„å«ä¹‰ï¼Œ50%çš„æ¦‚ç‡çˆ†æ‰éšæœºä¸€æ ¹æ•°ç ç®¡ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªæ•°å­—å¯èƒ½æ ¹æœ¬ä¸ä¼šåï¼Œå°±ç®—æŸåäº†ï¼Œä¹Ÿæœ€å¤šæ˜¯ä¸€æ ¹æ•°ç ç®¡ä¸äº®ã€‚æ‰€ä»¥å¯¹äºå…¶ä¸­æ¯ä¸€ä¸ªæ•°å­—ï¼Œä»–çš„å¯èƒ½æ€§éƒ½æ˜¯æœ‰é™çš„ï¼Œæ¯”å¦‚ä¸¾å‡ ä¸ªä¾‹å­ï¼š</p>
<p><img src="/post/cf09b856/image-20240701103950864.png" alt="image-20240701103950864"></p>
<p>è¿™ä¸ªå¯èƒ½æ˜¯5ã€6æˆ–9ã€‚</p>
<p><img src="/post/cf09b856/image-20240701104026332.png" alt="image-20240701104026332"></p>
<p>è¿™ä¸ªå¯èƒ½æ˜¯1ã€7ã€‚</p>
<p><img src="/post/cf09b856/image-20240701104109464.png" alt="image-20240701104109464"></p>
<p>è¿™ä¸ªåªèƒ½æ˜¯4ï¼Œå› ä¸ºæœ€å¤šæ‰ä¸€æ ¹ç®¡ï¼Œä»–è¡¥ä»»ä½•ä¸€ä¸ªåœ°æ–¹éƒ½ä¸ä¼šæˆä¸ºå…¶ä»–æ•°å­—ã€‚</p>
<p>è¿™ä¹ˆçœ‹æ¥çš„è¯ï¼Œåªéœ€è¦æŠŠæ¯ä¸ªæ•°å­—çš„å¯èƒ½æ€§éƒ½åˆ—å‡ºæ¥ï¼Œç„¶åæ·±æœå‰ªæå°±å¯ä»¥äº†ã€‚ç”±äºæ¯ä¸ªæ•°å­—çš„å¯èƒ½æ€§éƒ½ä¸å¤š(æœ€å¤šä¹Ÿå°±æ˜¯ä¸Šé¢è¿™ä¸ª5çš„æƒ…å†µï¼Œå…±3ç§)ï¼Œæ‰€ä»¥å…¶å®å®Œå…¨ä¸éœ€è¦n^2ï¼Œç›´æ¥ç”¨pq=næ¥å‰ªæå°±è¡Œã€‚</p>
<p>æ€è·¯å¾ˆæ¸…æ™°ï¼Œä½†æ˜¯æ€ä¹ˆæ ·åšæ‰èƒ½æ–¹ä¾¿åœ°æŠŠæ¯ä¸ªæ•°å­—çš„å¯èƒ½æ€§éƒ½åˆ—å‡ºæ¥ï¼Ÿå’Œ<a target="_blank" rel="noopener" href="https://yolbby.github.io/">@yolbby</a>åˆè®¡äº†ä¸€ä¸‹ï¼Œä¸å…¶åˆ‡åˆ†å›¾ç‰‡æåƒç´ ç„¶ååˆ†ç±»ï¼Œä¸å¦‚ç›´æ¥è‚‰çœ¼ä¸€ä¸ªä¸€ä¸ªå†™ï¼Œæˆ‘å†™pã€ä»–å†™qï¼Œç„¶åå†åˆ†è¡Œå†™nã€‚ä¸ºäº†ç»Ÿä¸€ï¼ŒæŠŠå¯èƒ½æ€§å†™æˆäºŒé‡åˆ—è¡¨çš„å½¢å¼å¦‚ä¸‹(ç”¨pçš„å‰å‡ ä½ä¸¾ä¾‹)ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="number">7</span>],[<span class="number">3</span>],[<span class="number">2</span>],[<span class="number">6</span>,<span class="number">8</span>],...]</span><br></pre></td></tr></table></figure>
<p>æŠ˜ç£¨å°±è¿™ä¹ˆå¼€å§‹äº†ï¼Œå‡Œæ™¨çš„æ—¶å€™ï¼Œä¸¤ä¸ªäººç›¯ç€ç”µè„‘å±å¹•è€çœ¼æ˜èŠ±çš„å†™ï¼Œè€Œä¸”æ¯ä¸ªä½ç½®è¿˜è¦ä»”ç»†åœ°å»æƒ³æ‰€æœ‰çš„å¯èƒ½æ€§ï¼Œå› ä¸ºæ¼äº†å°±å¾ˆéº»çƒ¦ã€‚</p>
<p>ç„¶ååˆæ‹‰ç€<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ZimaBlue">@Zima</a>ä¸€èµ·æŠ˜ç£¨ï¼Œå¥½ä¸å®¹æ˜“æŠŠpã€qã€nå…¨éƒ¨å†™å®Œäº†ï¼Œä¸€å‰ªå‘ç°è¿10ä½éƒ½å‰ªä¸å‡ºæ¥ï¼Œè¯´æ˜æœ€ååä½å°±æœ‰é”™ã€‚ç„¶åä¸‰ä¸ªäººåˆä¸€èµ·debugã€‚debugè€åŠå¤©ç»ˆäºæŠŠpã€qå‰ªå‡ºæ¥äº†ï¼Œç„¶åå‘ç°å¥½åƒè¿˜æ²¡æœ‰å¼„cï¼Œä¸è¿‡cæŒºå¥½åŠï¼Œå› ä¸ºæ²¡æœ‰æŸåï¼Œä½†æ˜¯ç›´æ¥OCRè¯†åˆ«å‡ºæ¥çš„è¿˜æ˜¯ä¸å°‘é”™(ç‰¹åˆ«å®¹æ˜“æ¼1)ï¼Œç„¶ååˆæ˜¯ä¸€èµ·è‚‰çœ¼debugæ‰æŠŠcå¼„å‡ºæ¥ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = [[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;1&quot;</span>],[<span class="string">&quot;1&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;1&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;7&quot;</span>],</span><br><span class="line">     [<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;0&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;0&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;1&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],</span><br><span class="line">     [<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;1&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;1&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;1&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;1&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],</span><br><span class="line">     [<span class="string">&quot;0&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;1&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;5&quot;</span>],</span><br><span class="line">     [<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;1&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;2&quot;</span>,<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;1&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;1&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;2&quot;</span>,<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],</span><br><span class="line">     [<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;0&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;8&quot;</span>],</span><br><span class="line">     [<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;2&quot;</span>,<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;0&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;1&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],</span><br><span class="line">     [<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;1&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;2&quot;</span>,<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;3&quot;</span>]]</span><br><span class="line"></span><br><span class="line">p = [[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;0&quot;</span>],[<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;1&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;0&quot;</span>],</span><br><span class="line">     [<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;2&quot;</span>,<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;6&quot;</span>],</span><br><span class="line">     [<span class="string">&quot;3&quot;</span>,<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;0&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;1&quot;</span>],[<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;3&quot;</span>],</span><br><span class="line">     [<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;2&quot;</span>,<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;1&quot;</span>],[<span class="string">&quot;1&quot;</span>],[<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;7&quot;</span>]]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">q = [[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;0&quot;</span>],[<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;0&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;9&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;0&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;1&quot;</span>],[<span class="string">&quot;1&quot;</span>],</span><br><span class="line">     [<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;1&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;2&quot;</span>,<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;9&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;9&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;1&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;1&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;6&quot;</span>],</span><br><span class="line">     [<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;1&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;0&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;9&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;9&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],</span><br><span class="line">     [<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;2&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;1&quot;</span>],[<span class="string">&quot;6&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;5&quot;</span>],[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;3&quot;</span>,<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;9&quot;</span>],[<span class="string">&quot;4&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;9&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;3&quot;</span>],[<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;0&quot;</span>],[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;7&quot;</span>],[<span class="string">&quot;0&quot;</span>,<span class="string">&quot;8&quot;</span>],[<span class="string">&quot;9&quot;</span>]]</span><br><span class="line"></span><br><span class="line">P = p[::-<span class="number">1</span>]</span><br><span class="line">Q = q[::-<span class="number">1</span>]</span><br><span class="line">N = n[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find</span>(<span class="params">pl,ql,nl,h</span>):</span><br><span class="line">    p_pos = P[h-<span class="number">1</span>]</span><br><span class="line">    q_pos = Q[h-<span class="number">1</span>]</span><br><span class="line">    n_pos = N[h-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    mask = <span class="number">10</span>**h</span><br><span class="line">    <span class="keyword">if</span>(h == <span class="built_in">len</span>(Q)):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">int</span>(pl))</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">int</span>(ql))</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> p_pos:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> q_pos:</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> n_pos:</span><br><span class="line">                ppl = <span class="built_in">int</span>(i + pl)</span><br><span class="line">                qql = <span class="built_in">int</span>(j + ql)</span><br><span class="line">                nnl = <span class="built_in">int</span>(k + nl)</span><br><span class="line">                <span class="keyword">if</span>(ppl*qql % mask == nnl % mask):</span><br><span class="line">                    find(i+pl,j+ql,k+nl,h+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#find(&quot;&quot;,&quot;&quot;,&quot;&quot;,1)</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">7326673976775677403615902952775786009780696864351810113969520603559523530618382637866632341958388570488543071638027072634087397361132795284727648994814597</span></span><br><span class="line">q = <span class="number">7075605374343310393660736847187727587911784641033429799366923429044581810690842608691612098700666156539827395662425799607464237168537039463467940973806709</span></span><br><span class="line">n = p*q</span><br><span class="line">c = <span class="number">3562663791006368034141977288433903435480729754256243271724528203580472770993094486280368310543613382256743525891807443983661459665243901555404810179525594817342115941001759547407703653781422057871347356603203075709275979343680289210665741824992476238299997444201948575831891922291318008008982215564064059476</span></span><br><span class="line"></span><br><span class="line">d = inverse(<span class="number">65537</span>,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">flag = long_to_bytes(<span class="built_in">pow</span>(c,d,n))</span><br><span class="line"><span class="keyword">if</span>(<span class="string">b&quot;CCTF&quot;</span>) <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#CCTF&#123;5eVEn_S39Men7_RSA_w!Th_k3Y_rEc0v3Ry!!!&#125;</span></span><br></pre></td></tr></table></figure>
<p>ç—›è‹¦ã€‚TT</p>
<p><br></p>
<h3 id="Solmaz-11-solves-271-pts"><a href="#Solmaz-11-solves-271-pts" class="headerlink" title="Solmaz(11 solves , 271 pts)"></a>Solmaz(11 solves , 271 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solmaz has developed a simple and visually appealing cryptosystem based on Elliptic Curve Cryptography, but its potential vulnerabilities require further investigation.</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_param</span>(<span class="params">nbit</span>):</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		t = prod([getPrime(nbit &gt;&gt; <span class="number">3</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)])</span><br><span class="line">		p = <span class="number">4</span> * t ** <span class="number">2</span> + <span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span> is_prime(p):</span><br><span class="line">			c = randint(<span class="number">3</span>, p - <span class="number">3</span>) ** <span class="number">2</span> % p</span><br><span class="line">			E = EllipticCurve(GF(p), [c, <span class="number">0</span>])</span><br><span class="line">			<span class="keyword">if</span> E.order() == p - <span class="number">1</span>:</span><br><span class="line">				<span class="keyword">return</span> p, c</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m, x, p, c</span>):</span><br><span class="line">	E = EllipticCurve(GF(p), [c, <span class="number">0</span>])</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		<span class="keyword">try</span>:</span><br><span class="line">			P = E.lift_x(x)</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		<span class="keyword">except</span>:</span><br><span class="line">			x += <span class="number">1</span></span><br><span class="line">	<span class="keyword">assert</span> m &lt; p - <span class="number">1</span></span><br><span class="line">	Q = m * P</span><br><span class="line">	<span class="keyword">return</span> P, Q, m</span><br><span class="line"></span><br><span class="line">nbit, x = <span class="number">256</span>, <span class="number">1337</span></span><br><span class="line">m = bytes_to_long(flag.lstrip(<span class="string">b&#x27;CCTF&#123;&#x27;</span>).rstrip(<span class="string">b&#x27;&#125;&#x27;</span>))</span><br><span class="line">p, c = gen_param(nbit)</span><br><span class="line">P, Q, m = encrypt(m, x, p, c)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;P = <span class="subst">&#123;P.x(), P.y()&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Q = <span class="subst">&#123;Q.x(), Q.y()&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>output.txtï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">P = (<span class="number">1338</span>, <span class="number">9218578132576071095213927906233283616907115389852794510465118810355739314264</span>)</span><br><span class="line">Q = (<span class="number">3454561753909947353764378180794889923919743476068813953002808647958908878895</span>, <span class="number">17267599534808803050751150297274989016063324917454246976792837120400888025519</span>)</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ç”Ÿæˆ4ä¸ª32bitçš„ç´ æ•°ï¼Œè®°ä¸ºq1ã€q2ã€q3ã€q4ï¼Œç„¶åè®¡ç®—ï¼š</p>
<script type="math/tex; mode=display">
p = 4(q_1q_2q_3q_4)^2 + 1</script><p>ç„¶åå–éšæœºæ•°cï¼Œå¾—åˆ°æ¨¡pä¸‹çš„æ¤­åœ†æ›²çº¿ï¼Œæ»¡è¶³é˜¶ä¸ºp-1ï¼š</p>
<script type="math/tex; mode=display">
E_p:y^2 = x^3 + cx</script><blockquote>
<p>ç”±äºpæ¨¡4ä½™1ï¼Œæ‰€ä»¥è¿™ä¸ªæ„é€ å’Œå‰é¢çš„Chocholåˆä¸ä¸€æ ·ï¼Œè™½ç„¶å½¢å¼ç›¸åŒï¼Œä½†å¹¶ä¸æ˜¯è¶…å¥‡å¼‚çš„ï¼Œæ‰€ä»¥æ‰èƒ½ä½¿é˜¶ä¸ºp-1</p>
</blockquote>
<p>ä¹‹åç»™å‡ºæ›²çº¿ä¸Šçš„ä¸¤ä¸ªç‚¹Pã€Qï¼Œæ»¡è¶³Q=mPï¼Œè¦æ±‚è¿˜åŸmã€‚</p>
<p>ä¾ç„¶æ²¡æœ‰æ¨¡æ•°på’Œcï¼Œæ‰€ä»¥åŒæ ·åšgroebnerå¾—åˆ°ä¸€ä¸ªpçš„å€æ•°kpï¼Œç„¶åç”±äºp-1æ˜¾ç„¶æ˜¯ä¸ªå…‰æ»‘æ•°ï¼Œæ‰€ä»¥æƒ³åˆ°åˆ©ç”¨Pollard p-1æ¥åˆ†è§£ä»–ã€‚</p>
<p>ä½†æ˜¯è™½ç„¶è¯´ç¡®å®å…‰æ»‘ï¼Œä½†æ˜¯32bitçš„ç´ æ•°å¥½åƒè¿˜æ˜¯ç¨å¾®å¤§äº†ä¸€äº›ï¼Œä½†æ˜¯ä¹‹å‰åœ¨mapleåšå®¢æœ‰ä¸€ç¯‡æ–‡ç« çœ‹åˆ°è¿‡ä¸€ä¸ªå«gmp-ecmçš„å·¥å…·å¥½åƒå¯ä»¥ç”¨ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://blog.maple3142.net/2022/11/06/n1ctf-2022-writeups/?highlight=n1ctf#ezdlp">N1CTF 2022 Writeups | å»¢æ–‡é›†ä¸­å€ (maple3142.net)</a></p>
<p>ç„¶åå°±åœ¨é˜Ÿä¼é‡Œé—®äº†é—®æœ‰æ²¡æœ‰å¸ˆå‚…ç”¨è¿‡ï¼Œ<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ZimaBlue">@Zima</a>å’Œ<a target="_blank" rel="noopener" href="https://wleukocytec.github.io/">@leukocyte</a>è¯•äº†ä¸€ä¸‹å¥½åƒä¸å¤ªè¡Œï¼Œå¯èƒ½æ˜¯å› ä¸ºæ¯ä¸ªç´ å› å­éƒ½å¹³æ–¹äº†ä¸€ä¸‹çš„ç¼˜æ•…ã€‚</p>
<p>æ‰€ä»¥æœ€åè¿˜æ˜¯æƒ³ç€ç›´æ¥å†™ä¸€ä¸ªp-1å…‰æ»‘çš„åˆ†è§£è„šæœ¬ï¼Œå›é¡¾ä¸€ä¸‹Pollard p-1çš„åŸç†ï¼Œå…¶å®å°±æ˜¯æ„é€ ä¸€ä¸ªtï¼Œä½¿å¾—ï¼š</p>
<script type="math/tex; mode=display">
t = r(p-1)</script><p>é‚£ä¹ˆç”±äºè´¹é©¬å°å®šç†ï¼Œå°±æœ‰ï¼š</p>
<script type="math/tex; mode=display">
a^t = 1 \quad(mod\;p)</script><p>æ‰€ä»¥å¯ä»¥æ±‚ï¼š</p>
<script type="math/tex; mode=display">
gcd(a^t-1,kp)</script><p>ä»è€Œå¾—åˆ°pã€‚</p>
<p>å…³é”®çš„ä¸€æ­¥å°±æ˜¯æ€ä¹ˆæ„é€ å‡ºè¿™æ ·çš„tï¼Œç”±äºï¼š</p>
<script type="math/tex; mode=display">
p-1 = 4(q_1q_2q_3q_4)^2</script><p>æ‰€ä»¥åªè¦ä»4å¼€å§‹ï¼Œä¹˜ä¸Šæ‰€æœ‰32bitç´ å› å­çš„å¹³æ–¹ï¼Œè¿™æ ·çš„tå°±ä¸€å®šæ˜¯p-1çš„å€æ•°ã€‚</p>
<p>è€Œè¦éå†æ‰€æœ‰32bitçš„å› å­ï¼Œå¯¹äºpythonè€Œè¨€æœ‰ç‚¹å¤§äº†ï¼Œæ‰€ä»¥æƒ³çš„æ˜¯ç”¨C++çš„NTLåº“å»åšè¿™ä¸ªäº‹æƒ…ã€‚ä½†é…è¿™ä¸ªç¯å¢ƒå¥½åƒå®åœ¨æœ‰ç‚¹éº»çƒ¦ï¼Œæ‰€ä»¥äº¤ç»™äº†Zimaã€‚Zimaæç¤ºè¯´gmpy2çš„nextprimeä¹Ÿè®¸å¯ä»¥ï¼Œæ‰€ä»¥æˆ‘ä¹Ÿå°±å†™äº†ä¸ªpythonçš„è„šæœ¬æŒ‚ç€ï¼Œç»“æœæŒ‚äº†ä¸€å°æ—¶å·¦å³çœŸçš„å‡ºäº†åˆ†è§£ã€‚</p>
<p>åˆ†è§£å®Œå°±å¥½åšäº†ï¼Œç”±äºä¿è¯äº†é˜¶ä¸ºp-1ï¼Œp-1ä¹Ÿå…‰æ»‘ï¼Œæ‰€ä»¥ç›´æ¥æ±‚DLPå°±å¯ä»¥ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">P = (<span class="number">1338</span>, <span class="number">9218578132576071095213927906233283616907115389852794510465118810355739314264</span>)</span><br><span class="line">Q = (<span class="number">3454561753909947353764378180794889923919743476068813953002808647958908878895</span>, <span class="number">17267599534808803050751150297274989016063324917454246976792837120400888025519</span>)</span><br><span class="line"></span><br><span class="line">x1,y1 = P[<span class="number">0</span>],P[<span class="number">1</span>]</span><br><span class="line">x2,y2 = Q[<span class="number">0</span>],Q[<span class="number">1</span>]</span><br><span class="line">PR.&lt;c,t&gt; = PolynomialRing(ZZ)</span><br><span class="line">f1 = y1^<span class="number">2</span> - x1^<span class="number">3</span> - c*x1</span><br><span class="line">f2 = y2^<span class="number">2</span> - x2^<span class="number">3</span> - c*x2</span><br><span class="line">res = Ideal([f1,f2]).groebner_basis()</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"></span><br><span class="line">p = <span class="number">55454940004513276799611588380059302189664933020838413515384708243928267219228512844352832003082349090934777517286737687281070260517892560156083453894086877367076953177914949876201881341274104406095268673060476748059522884381040212</span></span><br><span class="line">p = <span class="number">1846015660040154116831101677935731707303583319663256520946194832443059845383265967606382443176439867135351202904588407039443283680086981350429332914636635325121016081809085910600024068461413790906246868559</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span>):</span><br><span class="line">    i = next_prime(<span class="number">2</span>^<span class="number">31</span>)</span><br><span class="line">    a = <span class="number">2</span>^<span class="number">4</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">        a = powmod(a,i^<span class="number">2</span>,p)</span><br><span class="line">        <span class="keyword">if</span>(gcd(a-<span class="number">1</span>,p) != <span class="number">1</span>):</span><br><span class="line">            <span class="built_in">print</span>(gcd(a-<span class="number">1</span>,p))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        i = next_prime(i)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pp = <span class="number">30126567747372029007183424263223733382328264316268541293679065617875255137317</span></span><br><span class="line">PR.&lt;c,t&gt; = PolynomialRing(Zmod(pp))</span><br><span class="line">f1 = y1^<span class="number">2</span> - x1^<span class="number">3</span> - c*x1</span><br><span class="line">f2 = y2^<span class="number">2</span> - x2^<span class="number">3</span> - c*x2</span><br><span class="line">res = Ideal([f1,f2]).groebner_basis()</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"></span><br><span class="line">c = pp - <span class="number">12551276475019101031129136087416454095594035188486953048519662649803219581851</span></span><br><span class="line">E = EllipticCurve(GF(pp), [c, <span class="number">0</span>])</span><br><span class="line">P = E(P)</span><br><span class="line">Q = E(Q)</span><br><span class="line">m = Q.log(P)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#3cC_d1ViSibil!7Y</span></span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªé¢˜ä¹Ÿå¾ˆæ‰¯ï¼Œå¼€å§‹çš„é™„ä»¶é‡Œæ±‚å®Œmå‘ç°ä¸å¯¹ï¼Œç­‰äº†ä¸€ä¼šå„¿å‘ç°æœç„¶åˆè¦redownloadã€‚</p>
<p><br></p>
<h3 id="Tesvir-27-solves-150-pts"><a href="#Tesvir-27-solves-150-pts" class="headerlink" title="Tesvir(27 solves , 150 pts)"></a>Tesvir(27 solves , 150 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Tesvir, an advanced and unbreakable cryptosystem, emerged as a revolutionary development in the 20th century cryptographic landscape.</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># Note: The provided code is unclean and lacks efficient performance!</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_params</span>(<span class="params">p, h</span>):</span><br><span class="line">	F = GF(p ** h)</span><br><span class="line">	R = PolynomialRing(GF(p), <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">	P = Permutations(p)</span><br><span class="line">	r = P.random_element()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		f = R.random_element(degree = h)</span><br><span class="line">		<span class="keyword">if</span> f.is_irreducible():</span><br><span class="line">			f *= f.<span class="built_in">list</span>()[-<span class="number">1</span>] ** -<span class="number">1</span></span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">	</span><br><span class="line">	g = F.gen()</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		_ = randint(<span class="number">1</span>, p ** h - <span class="number">1</span>)</span><br><span class="line">		<span class="keyword">if</span> gcd(_, p ** h - <span class="number">1</span>) == <span class="number">1</span>:</span><br><span class="line">			g = g ** _</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">	</span><br><span class="line">	RR.&lt;x&gt; = GF(p**h)[]</span><br><span class="line">	f = RR(f)</span><br><span class="line">	t = f.roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">	<span class="keyword">return</span> g, t, r</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genkey</span>(<span class="params">p, h, params</span>):</span><br><span class="line">	g, t, r = params</span><br><span class="line">	pubkey, d = [], randint(<span class="number">1</span>, p ** h - <span class="number">1</span>)</span><br><span class="line">	P = Permutations(p)</span><br><span class="line">	pi = P.random_element()</span><br><span class="line">	<span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(p):</span><br><span class="line">		b = discrete_log(t + r[pi[_] - <span class="number">1</span>] - <span class="number">1</span>, g)</span><br><span class="line">		c = (b + d) % (p ** h - <span class="number">1</span>)</span><br><span class="line">		pubkey.append(c)</span><br><span class="line">	privkey = (d, pi, t, g)</span><br><span class="line">	<span class="keyword">return</span> pubkey, privkey</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">msg, p, h</span>):</span><br><span class="line">	m = bytes_to_long(msg)</span><br><span class="line">	B = <span class="built_in">bin</span>(m)[<span class="number">2</span>:].zfill(<span class="number">8</span> * <span class="built_in">len</span>(msg))</span><br><span class="line">	BA = [B[i*h:(i+<span class="number">1</span>)*h] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(B) // h)]</span><br><span class="line">	M = []</span><br><span class="line">	<span class="keyword">for</span> ba <span class="keyword">in</span> BA:</span><br><span class="line">		m = ba.ljust(p, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">		m = m[:-h + m.count(<span class="string">&#x27;1&#x27;</span>)] + <span class="string">&#x27;1&#x27;</span> * (h - m.count(<span class="string">&#x27;1&#x27;</span>))</span><br><span class="line">		M.append(m)</span><br><span class="line">	<span class="keyword">return</span> M</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">msg, pubkey, p, h</span>):</span><br><span class="line">	M, C = encode(msg, p, h), []</span><br><span class="line">	<span class="keyword">for</span> m <span class="keyword">in</span> M:</span><br><span class="line">		s = <span class="number">0</span></span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(p):</span><br><span class="line">			s += <span class="built_in">int</span>(m[i]) * pubkey[i]</span><br><span class="line">		C.append(s % (p ** h - <span class="number">1</span>))</span><br><span class="line">	<span class="keyword">return</span> C</span><br><span class="line"></span><br><span class="line">p, h = <span class="number">223</span>, <span class="number">24</span></span><br><span class="line">params = gen_params(p, h)</span><br><span class="line">g, t, r = params</span><br><span class="line">pubkey, _ = genkey(p, h, params)</span><br><span class="line">enc = encrypt(flag, pubkey, p, h)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;r = <span class="subst">&#123;r&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;pubkey  = <span class="subst">&#123;pubkey&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;enc = <span class="subst">&#123;enc&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºä¹Ÿæœ‰ç‚¹é•¿ï¼Œä¸æ”¾åœ¨è¿™é‡Œäº†ã€‚</p>
<p>å…ˆæ¢³ç†ä¸€ä¸‹é¢˜ç›®å†…å®¹ã€‚é¦–å…ˆæ˜¯gen_paramsï¼š</p>
<ul>
<li>ç”Ÿæˆæœ‰é™åŸŸï¼š</li>
</ul>
<script type="math/tex; mode=display">
F = GF(223^{24})</script><ul>
<li>ç”Ÿæˆä¸€ä¸ª1-223çš„éšæœºç½®æ¢r</li>
<li>ç”Ÿæˆåº¦ä¸º24çš„ä¸å¯çº¦å¤šé¡¹å¼f</li>
<li>ç”ŸæˆFçš„ç”Ÿæˆå…ƒg</li>
<li>æŠŠfè½¬åˆ°Fä¸‹å¹¶æ±‚å‡ºæ ¹t</li>
</ul>
<p>ç„¶åæ˜¯genkeyï¼š</p>
<ul>
<li><p>ç”Ÿæˆä¸€ä¸ªéšæœºæ•°d</p>
</li>
<li><p>å†ç”Ÿæˆä¸€ä¸ª1-223çš„éšæœºç½®æ¢pi</p>
</li>
<li><p>å¯¹0-223çš„jï¼Œåˆ†åˆ«è®¡ç®—bjï¼Œæ»¡è¶³ï¼š</p>
<script type="math/tex; mode=display">
g^{b_j} = t + r_{p_{ij}} - 1</script></li>
<li><p>è®¡ç®—cjï¼Œæ»¡è¶³ï¼š</p>
<script type="math/tex; mode=display">
c_j = b_j + d \quad(mod\;223^{24}-1)</script></li>
<li><p>æ‰€æœ‰cjä½œä¸ºå…¬é’¥</p>
</li>
</ul>
<p>è¯´å®è¯ï¼Œçœ‹åˆ°è¿™é‡ŒçœŸçš„ä¸€å¤´é›¾æ°´ï¼Œgen_paramsçš„å†…å®¹ä»¥åŠè¿™ä¸ª223è®©æˆ‘è”æƒ³åˆ°ä¹‹å‰å­¦äº†ä¸€ç‚¹ç‚¹çš„Reed Solomon Codeï¼Œä½†æ˜¯æœ¬èº«å°±å­¦äº†ç‚¹çš®æ¯›ï¼Œå®Œå…¨ä¸ä¼šç”¨ã€‚ç„¶åè¿™ä¸ªgenkeyä¹Ÿä¸€ç‚¹æ²¡çœ‹å‡ºè¦å¹²å˜›ã€‚</p>
<p>æ€»ä¹‹å…ˆç»§ç»­å¾€ä¸‹ï¼Œè¿˜å‰©ä¸€ä¸ªencodeå’Œencryptï¼Œå…·ä½“æ¥è¯´encodeæ˜¯ï¼š</p>
<ul>
<li>æŠŠæ˜æ–‡æŒ‰24bitåˆ†æˆè‹¥å¹²ç»„ï¼Œåˆ†åˆ«è¿›è¡ŒåŠ å¯†</li>
<li>å¯¹äºæ¯ä¸ªåˆ†ç»„mï¼Œå¡«å……0ä½¿å…¶é•¿åº¦ä¸º223</li>
<li>ä¹‹åï¼Œä»æœ«å°¾å¼€å§‹å°†0æ¢æˆ1ï¼Œä½¿å¾—æœ€ç»ˆçš„mä¸€å…±å«æœ‰24ä¸ª1</li>
</ul>
<p>æœ€åæ˜¯encryptï¼š</p>
<ul>
<li>å¯¹äºæ¯ä¸ªmï¼Œè®¡ç®—å‘é‡må’ŒCåœ¨æ¨¡p^h-1ä¸‹çš„å†…ç§¯</li>
</ul>
<p>çœ‹å®Œå‘ç°è¿™ä¸å°±æ˜¯ä¸ªèƒŒåŒ…å—ï¼Œè€Œä¸”ç”±äºæ¯ä¸ªmå…¶å®éƒ½åªç”±24bitç”Ÿæˆï¼Œä¸€ä¸€å¯¹åº”ï¼Œæ‰€ä»¥ç›´æ¥çˆ†ç ´å°±å¥½äº†ï¼Œä¹Ÿå°±æ˜¯å¯¹æ‰€æœ‰24bitçš„mï¼Œè®¡ç®—æœ€åçš„å¯†æ–‡å€¼æ¥å»ºç«‹å­—å…¸ï¼Œç„¶åæŸ¥å­—å…¸å°±è¡Œã€‚</p>
<p>åˆå› ä¸ºmåªèƒ½æ˜¯å¯è§å­—ç¬¦ï¼Œæ‰€ä»¥åªéœ€è¦ç”¨å¯è§å­—ç¬¦å»ºå­—å…¸å°±å¤Ÿäº†ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> printable</span><br><span class="line"></span><br><span class="line">r = [<span class="number">115</span>, <span class="number">149</span>, <span class="number">46</span>, <span class="number">15</span>, <span class="number">122</span>, <span class="number">10</span>, <span class="number">81</span>, <span class="number">136</span>, <span class="number">65</span>, <span class="number">166</span>, <span class="number">219</span>, <span class="number">156</span>, <span class="number">129</span>, <span class="number">170</span>, <span class="number">214</span>, <span class="number">210</span>, <span class="number">223</span>, <span class="number">21</span>, <span class="number">179</span>, <span class="number">72</span>, <span class="number">67</span>, <span class="number">85</span>, <span class="number">220</span>, <span class="number">183</span>, <span class="number">5</span>, <span class="number">212</span>, <span class="number">134</span>, <span class="number">106</span>, <span class="number">139</span>, <span class="number">188</span>, <span class="number">146</span>, <span class="number">102</span>, <span class="number">125</span>, <span class="number">22</span>, <span class="number">221</span>, <span class="number">87</span>, <span class="number">126</span>, <span class="number">51</span>, <span class="number">153</span>, <span class="number">159</span>, <span class="number">116</span>, <span class="number">32</span>, <span class="number">144</span>, <span class="number">205</span>, <span class="number">55</span>, <span class="number">127</span>, <span class="number">222</span>, <span class="number">93</span>, <span class="number">71</span>, <span class="number">201</span>, <span class="number">20</span>, <span class="number">75</span>, <span class="number">123</span>, <span class="number">41</span>, <span class="number">25</span>, <span class="number">33</span>, <span class="number">114</span>, <span class="number">192</span>, <span class="number">120</span>, <span class="number">70</span>, <span class="number">96</span>, <span class="number">211</span>, <span class="number">8</span>, <span class="number">180</span>, <span class="number">26</span>, <span class="number">147</span>, <span class="number">28</span>, <span class="number">34</span>, <span class="number">177</span>, <span class="number">199</span>, <span class="number">92</span>, <span class="number">11</span>, <span class="number">198</span>, <span class="number">29</span>, <span class="number">89</span>, <span class="number">37</span>, <span class="number">74</span>, <span class="number">162</span>, <span class="number">133</span>, <span class="number">97</span>, <span class="number">79</span>, <span class="number">69</span>, <span class="number">35</span>, <span class="number">80</span>, <span class="number">124</span>, <span class="number">101</span>, <span class="number">216</span>, <span class="number">61</span>, <span class="number">117</span>, <span class="number">173</span>, <span class="number">176</span>, <span class="number">53</span>, <span class="number">98</span>, <span class="number">150</span>, <span class="number">4</span>, <span class="number">42</span>, <span class="number">39</span>, <span class="number">56</span>, <span class="number">112</span>, <span class="number">195</span>, <span class="number">38</span>, <span class="number">218</span>, <span class="number">178</span>, <span class="number">157</span>, <span class="number">19</span>, <span class="number">206</span>, <span class="number">172</span>, <span class="number">181</span>, <span class="number">17</span>, <span class="number">62</span>, <span class="number">103</span>, <span class="number">182</span>, <span class="number">45</span>, <span class="number">13</span>, <span class="number">161</span>, <span class="number">171</span>, <span class="number">175</span>, <span class="number">95</span>, <span class="number">148</span>, <span class="number">217</span>, <span class="number">193</span>, <span class="number">187</span>, <span class="number">66</span>, <span class="number">90</span>, <span class="number">104</span>, <span class="number">24</span>, <span class="number">76</span>, <span class="number">60</span>, <span class="number">108</span>, <span class="number">6</span>, <span class="number">131</span>, <span class="number">196</span>, <span class="number">128</span>, <span class="number">184</span>, <span class="number">163</span>, <span class="number">137</span>, <span class="number">105</span>, <span class="number">189</span>, <span class="number">86</span>, <span class="number">174</span>, <span class="number">91</span>, <span class="number">64</span>, <span class="number">57</span>, <span class="number">118</span>, <span class="number">77</span>, <span class="number">140</span>, <span class="number">190</span>, <span class="number">194</span>, <span class="number">200</span>, <span class="number">43</span>, <span class="number">16</span>, <span class="number">44</span>, <span class="number">30</span>, <span class="number">207</span>, <span class="number">94</span>, <span class="number">9</span>, <span class="number">68</span>, <span class="number">135</span>, <span class="number">169</span>, <span class="number">204</span>, <span class="number">143</span>, <span class="number">160</span>, <span class="number">100</span>, <span class="number">23</span>, <span class="number">191</span>, <span class="number">113</span>, <span class="number">111</span>, <span class="number">185</span>, <span class="number">213</span>, <span class="number">58</span>, <span class="number">130</span>, <span class="number">197</span>, <span class="number">59</span>, <span class="number">40</span>, <span class="number">186</span>, <span class="number">54</span>, <span class="number">52</span>, <span class="number">12</span>, <span class="number">18</span>, <span class="number">132</span>, <span class="number">83</span>, <span class="number">82</span>, <span class="number">202</span>, <span class="number">3</span>, <span class="number">141</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">165</span>, <span class="number">14</span>, <span class="number">63</span>, <span class="number">84</span>, <span class="number">109</span>, <span class="number">152</span>, <span class="number">155</span>, <span class="number">36</span>, <span class="number">7</span>, <span class="number">138</span>, <span class="number">154</span>, <span class="number">49</span>, <span class="number">78</span>, <span class="number">168</span>, <span class="number">73</span>, <span class="number">151</span>, <span class="number">50</span>, <span class="number">209</span>, <span class="number">158</span>, <span class="number">119</span>, <span class="number">110</span>, <span class="number">145</span>, <span class="number">88</span>, <span class="number">47</span>, <span class="number">203</span>, <span class="number">142</span>, <span class="number">31</span>, <span class="number">208</span>, <span class="number">27</span>, <span class="number">121</span>, <span class="number">164</span>, <span class="number">167</span>, <span class="number">48</span>, <span class="number">107</span>, <span class="number">215</span>, <span class="number">99</span>]</span><br><span class="line">pubkey  = [<span class="number">4579387258479099442826389140450017183599598717619029205</span>, <span class="number">50797264141313161541250199298799563140155742676514856070</span>, <span class="number">219434691099250615018456858310069756006004009383046642143</span>, <span class="number">11468330660842953225747497191767883930924930581150665808</span>, <span class="number">42194638083287011574373249814732023116819279406149017814</span>, <span class="number">134902545392443293573158976620222083109565710059582776902</span>, <span class="number">3625160144836978085583648268825293444860869777878716136</span>, <span class="number">166813383914408395764151023241147502314266684547884287332</span>, <span class="number">29943565577633575933303332141205158945650619101645934495</span>, <span class="number">17247055180775323745936195042907464159475314878330706940</span>, <span class="number">132701774141813613088531286364104917554398118755301161215</span>, <span class="number">206201625677033303772404919447115617309491897222468899200</span>, <span class="number">128759746088591221813929603681654308197557770578218948759</span>, <span class="number">183360234828977645180158181331005804200611579381078449242</span>, <span class="number">3433497919764270981254123021568517019107322906407838775</span>, <span class="number">180827244701547409769187849611685260472147977186544075612</span>, <span class="number">90094342976044807455290765016453082784682254114643836710</span>, <span class="number">140026255208288075756758769477351349475202860424951564344</span>, <span class="number">44112364626789590294371548773210573275126865083833640129</span>, <span class="number">151820161852264758050222465177459785347971580873896530205</span>, <span class="number">222641568922329016629261535558799809898506907527486806640</span>, <span class="number">35846272444624180096743012590749051207738305050375026589</span>, <span class="number">110125275231759529474921195973993669124331074146968153872</span>, <span class="number">11904056771999183668735243652491014687752264483508519866</span>, <span class="number">119911867667253049327009237856594634409002462712397844820</span>, <span class="number">161987059546037388210491693488518594653631887673204452021</span>, <span class="number">190788561858532711625259038792473501768790789526603183037</span>, <span class="number">171042759190856745199182923448465366839589623183777310937</span>, <span class="number">101801200452544922434731443664964969246088222257527659764</span>, <span class="number">140090724075803428561186326582496226733538620993806652027</span>, <span class="number">176639396674357206316302178630628292675252712623699685490</span>, <span class="number">224783685350046016548546283210616077635030923321729671618</span>, <span class="number">157686979388371420253523386799757123908864516455322611545</span>, <span class="number">28199419400037879567825862396075374687069854583804945245</span>, <span class="number">171978417782412325892218086069748164824402244074965942435</span>, <span class="number">150310833853533773405964930253939487392079866821627398318</span>, <span class="number">98831345742413826709455556687993160848501023377907278651</span>, <span class="number">154123567141389311086541742847650387097698934736160865023</span>, <span class="number">121630066975031002990840926074186080216239975029293476812</span>, <span class="number">31286696313154799066012880007327124505421721519900715948</span>, <span class="number">101968393996191205796932269707677612467402575382356961248</span>, <span class="number">2499136180549370600650171447598502321445026784559416298</span>, <span class="number">16848125897903955338136140634369505392045684150115786655</span>, <span class="number">47578327339400295189131054328443796093121978922647143447</span>, <span class="number">24179233030291902452310675469039369826988576939199879176</span>, <span class="number">105273037901112446462027934415037990047326123775284256167</span>, <span class="number">57411134139938220106040243797683715192527950831820732678</span>, <span class="number">10195725519763357104221976240106299814337949772923615115</span>, <span class="number">58166560063884761465783400200196628538821017285137875256</span>, <span class="number">54605784905038131389770213608353236551670620624534944596</span>, <span class="number">38226456600614157062858559660172787082020565146605850918</span>, <span class="number">197663869365124319457839210919740591516696780039282126370</span>, <span class="number">54967216556218275683218087499570854735333195406411928855</span>, <span class="number">35042906559524305301502230096462527221023815082011655179</span>, <span class="number">171952564704992857457616532638790008890189941636196696639</span>, <span class="number">13591589636081003740574689687993869647237413563256792156</span>, <span class="number">57500559744886027958431694115198596269754572013078937199</span>, <span class="number">156436123898613669232291346505787899872553219088301314205</span>, <span class="number">57806240192751898104001203282509821193881347139984859692</span>, <span class="number">75418944937404633800905243484214892003346945987666650321</span>, <span class="number">217951708406473977895295349132268568429989686999505522686</span>, <span class="number">176304391015211148283705335593955617239819817843077950051</span>, <span class="number">55758125847440048397087822777244647091332565999126988186</span>, <span class="number">67763984529554201139494025200729662864492800619660213727</span>, <span class="number">191656222762556273307219102885834144624172791167272826527</span>, <span class="number">227057602273122755633874913712839974408374157556787076376</span>, <span class="number">33453697550484714961091977965265482703240184817695545931</span>, <span class="number">12925259442356937434080842924124428578042373548580641181</span>, <span class="number">129261341826868448249871227617413161190310094555223712007</span>, <span class="number">71767590488420142133048641448102466710457459547821693469</span>, <span class="number">103075493305044879489908640369142480134843220688626837743</span>, <span class="number">12297364715802489173873556831742255265347989101674609502</span>, <span class="number">150291384287610485111409155980244572563593549745010253623</span>, <span class="number">33554524283172661611961357763141315669196684041832264667</span>, <span class="number">107585516815880888762810129132766424476978665361986789693</span>, <span class="number">36898755542881194892338867205127165804165674781364624017</span>, <span class="number">138477491659893664966890466537007728539785384371165227574</span>, <span class="number">65080684456472796307268797791487491498452724689891503205</span>, <span class="number">54048070387499035173896610221943137253486493038088391758</span>, <span class="number">173153561765864340705771824025973165939007109224817507817</span>, <span class="number">99568762534450608460985163776495428624938259974357002753</span>, <span class="number">108073734079270345964706401004242426736899095097270034663</span>, <span class="number">211296070795991107573611899784372810320165661065744807048</span>, <span class="number">191950980282295846436480586220709004688220897961209478055</span>, <span class="number">219870789829809143290238261647242433619723780668567898644</span>, <span class="number">82846254389400741644821834447511166580591663882000899601</span>, <span class="number">147335705565643026701833336777988683175003463278814922435</span>, <span class="number">6677330657331868597177080912636187709184247213001090915</span>, <span class="number">65509954025264162376897683857059640795180443611539638608</span>, <span class="number">97788348508348672587427253412621341354516347030316943263</span>, <span class="number">50339872017921024171565922882962110596867515107807632791</span>, <span class="number">20404897329900652246085973695039579378539236291786309377</span>, <span class="number">121628627709837892062339399628512721395766452440642156526</span>, <span class="number">117664673632829519874589853389281010878033806284806858518</span>, <span class="number">3494726644577971223092642563152500568596276988795464645</span>, <span class="number">223190741523925264571455759912144998793891033522018823048</span>, <span class="number">124704306247788182879460388204439451710110862604146656179</span>, <span class="number">179566098748276203619721337178633709517431960525191942726</span>, <span class="number">173695293570764259997115035606911185447598999607810255972</span>, <span class="number">98378718420486206578551644649570093764645689842230247773</span>, <span class="number">36294885445792353105870401865114008348319522604135751238</span>, <span class="number">88351601718747228918743630494029404621883715463441833300</span>, <span class="number">136753888328355936111533885450395887852887609650952850511</span>, <span class="number">88826423819149324073976027277400003130267101605703817417</span>, <span class="number">153626347770151869159701273708416238028320992726042173456</span>, <span class="number">48447665799548951912445970765509796863255819192369137317</span>, <span class="number">25926148818727084305421258039188486622091968754727603495</span>, <span class="number">75433007506007981941697739028886717357568843374886617854</span>, <span class="number">163403523743183107337343618869709094774134312669607579337</span>, <span class="number">90195006643240793119903093662362093956207796050824877543</span>, <span class="number">76931655268596842019773587962860622955093248369876788943</span>, <span class="number">167125463295542690682664785803694224887085948995189999120</span>, <span class="number">165912236533045749391666265104352059105394417883439144504</span>, <span class="number">102981866240314860142794639939500562112030796419343035128</span>, <span class="number">123694742410185960631033448288250064254819985873351326165</span>, <span class="number">146592629552828995525189097760808351453961284758262774466</span>, <span class="number">203019861676583573314131259559172588655975662889495156847</span>, <span class="number">10036161500498212898467897368941308147748449303016069174</span>, <span class="number">87685737716753006215675653796273463223114323170147465929</span>, <span class="number">70329560627252087252573684487639836859071522052119307709</span>, <span class="number">136915861244063044189262984270735166984429581745567649014</span>, <span class="number">73329998651742245723573422155349760954316509103924762273</span>, <span class="number">113734525875359728198291451178172485335376151605520663473</span>, <span class="number">208813187221334309596716858611421084130040781080505004952</span>, <span class="number">103875031262332837491631581905413234953377770241528241376</span>, <span class="number">13243847546817072175843419982531752763684782213514268707</span>, <span class="number">120001744407132173260771636243615527375774917295121354322</span>, <span class="number">89851436867267737223022839170104811357555399505302690249</span>, <span class="number">19106651045250061786958853204442871931070349664665906834</span>, <span class="number">208140981493299248238118954460510449680605048319117899909</span>, <span class="number">120436526754234062175517049489497536862368615535960465554</span>, <span class="number">41291126508960073783277550372758414648175366207183334071</span>, <span class="number">2749944545805905720645531699140358480207253897204188026</span>, <span class="number">152081380532436580972673620869155127882780286091923495345</span>, <span class="number">100852343092400579536924309146452168877906896247239016614</span>, <span class="number">72079920508055254975205188574206595876645959712620597055</span>, <span class="number">64522268400191343447596383230061887992830219982859913739</span>, <span class="number">152197766648262372890520836531877829770805996935738924903</span>, <span class="number">210877734181002617812004654242222645876962178158868141209</span>, <span class="number">24683946164990045540189560349129683887167164299195625775</span>, <span class="number">206820209167550683642789721762915236268108999576680456003</span>, <span class="number">57710866387091758853441183389265772964358226230824623991</span>, <span class="number">179747783113998854176536062668891588251038080701285687124</span>, <span class="number">111115053514467266934252222133378536223568883659999381505</span>, <span class="number">194310031249253577037158724020305219028469221832006495335</span>, <span class="number">54171305756709974148893255631810739380658440555289725183</span>, <span class="number">36081061592476397164849907656781564201428054975112151104</span>, <span class="number">166387522179865867529326169813325590271108420005029369186</span>, <span class="number">50236753450199839053294465580343603952154218305737501432</span>, <span class="number">70229038648249274204999881080972889501721690256998625762</span>, <span class="number">169828815141066923955361893760454462461324854178070409119</span>, <span class="number">26513302826439642958218716242634740776783823741312689484</span>, <span class="number">185293148966236856497840087050705776290599263752404971816</span>, <span class="number">210075369853066586284316297419359553539776027083874134267</span>, <span class="number">41205384335146937893146509772611998036936514483031810977</span>, <span class="number">204592520934960087493828781217416383428211029411383214329</span>, <span class="number">76065261425709174633836852053941128687067031775700625939</span>, <span class="number">203179613168733078332953358441061351071432612584054415916</span>, <span class="number">66513708250927489690305470142866176469513954748228766009</span>, <span class="number">20175814755308115791665314547889139205636005255804299913</span>, <span class="number">41078990455149658170563497862994645535886142813093891945</span>, <span class="number">228716072689925880543313659773455487756692019817537192658</span>, <span class="number">88391808755246018940367365181350246171557051014871850843</span>, <span class="number">139071342756333141894701291100940798956239314294905885889</span>, <span class="number">34147579027293395946839437099948813145351207426978539631</span>, <span class="number">104582557632522499285198546400846355094887074031948009088</span>, <span class="number">193859720380076021440874403745137391037512325878308523794</span>, <span class="number">225121265357955697363133178349606491945064525800785037545</span>, <span class="number">160720585717566128665444228898129797771581562781360670661</span>, <span class="number">195166070960955730159221227940352776779707446869688343508</span>, <span class="number">133627947376034537976383882910801869861246650572569070695</span>, <span class="number">16719370811161879662359147931457873453820872914250387809</span>, <span class="number">155580990893469680143665368454873188094047243027201936841</span>, <span class="number">18694763141354823690068972812866289937107702217472736692</span>, <span class="number">180898634569544925760572911334766030238281261919118297851</span>, <span class="number">159751985510351400082345385715475564587105850170299678853</span>, <span class="number">155124615247547146942168765500966248268323206179567419205</span>, <span class="number">39649641204773451404479536238969341384057353458256712174</span>, <span class="number">216313168003657711664578876360545799473306544830810266276</span>, <span class="number">2436503838732292885729786856280366925839569007022405596</span>, <span class="number">29242869292273221923479959280952424708462203556781794240</span>, <span class="number">21353805727988428836254728455321385646191528588118693349</span>, <span class="number">184613959938479515383397207452089562397995531746818305735</span>, <span class="number">140289186800524865867557270107130302338585963835219455920</span>, <span class="number">14428539381784887761791822212123106533195544480287429965</span>, <span class="number">40063122489718320389768387980387937974266804567069179915</span>, <span class="number">55679889320878386368056199019499075551252069356762025349</span>, <span class="number">228364327140445947910507206533691038804961948329604730314</span>, <span class="number">137306250863214464757975768638682609074020140712052016591</span>, <span class="number">152391609702632678722030482025816660799366940635319107692</span>, <span class="number">194331603613786615373811392732597540342727111461284467597</span>, <span class="number">112113260165766031933616735889437144400364790129165745472</span>, <span class="number">164499490550482070591340758879746189249388690835705287235</span>, <span class="number">20402415569195842441186230361383311044896719963531571028</span>, <span class="number">225143804839005659587542376622296525537292745802892642188</span>, <span class="number">219943480713442124639466865807923792140876225471303796193</span>, <span class="number">100202994621560168061154249542004856938325751300523918584</span>, <span class="number">166436226032756440467049814076007698369014463998417351566</span>, <span class="number">18518355241335588006356643517380924818275705817097834578</span>, <span class="number">169604362625557928746484454468713671095324100635870987551</span>, <span class="number">159533814543444317784990508257554461271048535710886251037</span>, <span class="number">133643088722739646000296360061097750513592416981320784101</span>, <span class="number">25825717351397349919398666003417921265219251686879820730</span>, <span class="number">103890888915605250679479877052313405985439478970128423397</span>, <span class="number">175772907838636899849299085810673621817614674781130017660</span>, <span class="number">43252300614589311522387147190442713053937984366326355858</span>, <span class="number">16873508457113580715891642673658667475105208209712112109</span>, <span class="number">204936077584769128504523195223183609999978573880209766347</span>, <span class="number">146181990984131617454963783388766051702152117818499103400</span>, <span class="number">226800051676747490358957570441842948948454336820531603559</span>, <span class="number">13156759590500952498608314082303404240995496109216133020</span>, <span class="number">162761766626445741079367215153670009011553941246752760271</span>, <span class="number">123445831125323393499253996280041267200348094380668843306</span>, <span class="number">121602035722307931614892071798221758823002664577511063923</span>, <span class="number">23269715190123797016604529624307223622512790793866100396</span>, <span class="number">201076240655311730254977907588618994829092140461549116438</span>, <span class="number">186737762068262742773830024339577470536847993539671779909</span>, <span class="number">64769358039037097203493324824901293008710108086262539570</span>, <span class="number">76036556626637280604159891162317494917916766168683677624</span>, <span class="number">122041751030855798908591443027132885210134390844715030960</span>, <span class="number">6420731920346907316661151593704807667310013944904682276</span>, <span class="number">133261601326695897123023151238223660543182011673252011668</span>, <span class="number">30312418798752835863188687757298737341991779619884584800</span>]</span><br><span class="line">enc = [<span class="number">121773698579173930646656942313646818799949564181892514859</span>, <span class="number">110363069068565613417175306995877029091942876457783351430</span>, <span class="number">67317447763346252995608047282163289259952724379009239066</span>, <span class="number">40661215922494279426540413963914475266467025509037412483</span>, <span class="number">199660192385826369347118319254502285195924547332922588842</span>, <span class="number">210938210594770518313394647530370135516757130870441793616</span>, <span class="number">164968164223840366829073701035700449613620360889464719358</span>, <span class="number">47722780186684500642502897705647627086520536818326027744</span>, <span class="number">172004040329747663442384678364642020997081017719965572563</span>, <span class="number">168534236138473024418565955930918724937733991774575045958</span>, <span class="number">10055390150692383401863041865436699229887022636104189218</span>, <span class="number">192916357157635434222013845041170212448835303838788802734</span>, <span class="number">68753529179558868929323016763964628261555073720614388332</span>, <span class="number">23143793866551418276708722027637360095751061589410241996</span>, <span class="number">12858601314274634932275239968551622469282315096707517108</span>, <span class="number">186769443202545717151434669644556005309108741078385143683</span>, <span class="number">48691603859905562687745717731829643706189835379113081935</span>]</span><br><span class="line"></span><br><span class="line">p,h = <span class="number">223</span>,<span class="number">24</span></span><br><span class="line">mod = (p ** h - <span class="number">1</span>)</span><br><span class="line">dic = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(product(printable,repeat=<span class="number">3</span>),total=<span class="built_in">len</span>(printable)**<span class="number">3</span>):</span><br><span class="line">    tt = <span class="built_in">bin</span>(bytes_to_long(<span class="string">&quot;&quot;</span>.join(i).encode()))[<span class="number">2</span>:].zfill(<span class="number">24</span>)</span><br><span class="line">    m = tt.ljust(p, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">    m = m[:-h + m.count(<span class="string">&#x27;1&#x27;</span>)] + <span class="string">&#x27;1&#x27;</span> * (h - m.count(<span class="string">&#x27;1&#x27;</span>))</span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(p):</span><br><span class="line">        s += <span class="built_in">int</span>(m[j]) * pubkey[j]</span><br><span class="line">    s %= mod</span><br><span class="line">    dic[s] = <span class="string">&quot;&quot;</span>.join(i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc:</span><br><span class="line">    <span class="built_in">print</span>(dic[i],end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#ASIS&#123;h0W_dO_yUo_5oLvE_tH!s_m1X3D_5eMi_H4rD_T4Sk!!?&#125;</span></span><br></pre></td></tr></table></figure>
<p>ä¸è¿‡flagå¤´ä¸ºä»€ä¹ˆä¸æ˜¯CCTFï¼Ÿ</p>
<p><br></p>
<p><br></p>
<h2 id="Tough"><a href="#Tough" class="headerlink" title="Tough"></a>Tough</h2><h3 id="Capac-5-solves-375-pts"><a href="#Capac-5-solves-375-pts" class="headerlink" title="Capac(5 solves , 375 pts)"></a>Capac(5 solves , 375 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Capac is a specialized case of elliptic curve cryptography, which we&#x27;ve used to develop a new system. Fully cracking it requires deep understanding of all details.</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">iscube</span>(<span class="params">n, p</span>): </span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">pow</span>(n, (p-<span class="number">1</span>) // gcd(<span class="number">3</span>, p-<span class="number">1</span>), p) == <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">issquare</span>(<span class="params">n, p</span>): </span><br><span class="line">	<span class="keyword">return</span> Mod(n, p).is_square()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_prime</span>(<span class="params">nbit, t</span>):</span><br><span class="line">	P = []</span><br><span class="line">	<span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(t):</span><br><span class="line">		<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">			p = getPrime(nbit)</span><br><span class="line">			<span class="keyword">if</span> p % <span class="number">3</span> * p % <span class="number">4</span> == <span class="number">3</span>:</span><br><span class="line">				P.append(p)</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">	<span class="keyword">return</span> P</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">P, Q, c, n</span>):</span><br><span class="line">	<span class="comment"># Add two points P and Q on curve x^3 + c*y^3 + c^2*z^3 - 3*c*x*y*z = 1 in Zmod(n) </span></span><br><span class="line">	(x1, y1, z1) = P</span><br><span class="line">	(x2, y2, z2) = Q</span><br><span class="line">	x3 = (x1*x2 + c*(y2*z1	+ y1*z2))	% n</span><br><span class="line">	y3 = (x2*y1 + x1*y2		+ c*z1*z2)	% n</span><br><span class="line">	z3 = (y1*y2 + x2*z1		+ x1*z2)	% n</span><br><span class="line">	<span class="keyword">return</span> (x3, y3, z3)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">P, g, c, n</span>):</span><br><span class="line">	<span class="comment"># Scalar multiplication on curve</span></span><br><span class="line">	(x1, y1, z1) = P</span><br><span class="line">	(x2, y2, z2) = (<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">	<span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">bin</span>(g)[<span class="number">2</span>:]:</span><br><span class="line">		(x2, y2, z2) = add((x2, y2, z2), (x2, y2, z2), c, n)</span><br><span class="line">		<span class="keyword">if</span> b == <span class="string">&#x27;1&#x27;</span>: </span><br><span class="line">			(x2, y2, z2) = add((x2, y2, z2), (x1, y1, z1), c, n)</span><br><span class="line">	<span class="keyword">return</span> (x2, y2, z2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">keygen</span>(<span class="params">nbit, r, s</span>):</span><br><span class="line">	p, q = gen_prime(nbit, <span class="number">2</span>)</span><br><span class="line">	n, o = p^r * q^s, p*q*(p^<span class="number">2</span>+p+<span class="number">1</span>)*(q^<span class="number">2</span>+q+<span class="number">1</span>)*(p - <span class="number">1</span>)^<span class="number">2</span>*(q - <span class="number">1</span>)^<span class="number">2</span></span><br><span class="line">	e = randint(<span class="number">1</span>, n)</span><br><span class="line">	<span class="keyword">while</span> gcd(e, o) != <span class="number">1</span>: e = randint(<span class="number">1</span>, n)</span><br><span class="line">	E = [</span><br><span class="line">		p^(<span class="number">2</span>*(r-<span class="number">1</span>))*q^(<span class="number">2</span>*(s-<span class="number">1</span>))*(p^<span class="number">2</span>+p+<span class="number">1</span>)*(q^<span class="number">2</span>+q+<span class="number">1</span>),</span><br><span class="line">		p^(<span class="number">2</span>*(r-<span class="number">1</span>))*q^(<span class="number">2</span>*(s-<span class="number">1</span>))*(p - <span class="number">1</span>)^<span class="number">2</span>*(q - <span class="number">1</span>)^<span class="number">2</span>,</span><br><span class="line">		p^(<span class="number">2</span>*(r-<span class="number">1</span>))*q^(<span class="number">2</span>*(s-<span class="number">1</span>))*(p^<span class="number">2</span>+p+<span class="number">1</span>)*(q - <span class="number">1</span>)^<span class="number">2</span>,</span><br><span class="line">		p^(<span class="number">2</span>*(r-<span class="number">1</span>))*q^(<span class="number">2</span>*(s-<span class="number">1</span>))*(p - <span class="number">1</span>)^<span class="number">2</span>*(q^<span class="number">2</span>+q+<span class="number">1</span>)</span><br><span class="line">		]</span><br><span class="line">	D = [inverse(e, _) <span class="keyword">for</span> _ <span class="keyword">in</span> E]</span><br><span class="line">	<span class="keyword">return</span> (n, e), (p, q, D)</span><br><span class="line">	</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m, pubkey</span>):</span><br><span class="line">	(n, e) = pubkey</span><br><span class="line">	(x, y) = m</span><br><span class="line">	c = ((<span class="number">1</span> - x^<span class="number">3</span>) * inverse(y^<span class="number">3</span>, n)) % n</span><br><span class="line">	enc = mul((x, y, <span class="number">0</span>), e, c, n)</span><br><span class="line">	<span class="keyword">return</span> enc</span><br><span class="line">	</span><br><span class="line">nbit, r, s = <span class="number">128</span>, <span class="number">4</span>, <span class="number">6</span></span><br><span class="line">pubkey, _ = keygen(nbit, r, s)</span><br><span class="line"></span><br><span class="line">l = <span class="built_in">len</span>(flag)</span><br><span class="line">m = (bytes_to_long(flag[:l//<span class="number">2</span>]), bytes_to_long(flag[l//<span class="number">2</span>:]))</span><br><span class="line"><span class="keyword">assert</span> m[<span class="number">0</span>] &lt; pubkey[<span class="number">0</span>] <span class="keyword">and</span> m[<span class="number">1</span>] &lt; pubkey[<span class="number">0</span>]</span><br><span class="line">enc = encrypt(m, pubkey)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;pubkey = <span class="subst">&#123;pubkey&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;enc = <span class="subst">&#123;enc&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>output.txtï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pubkey = (88952423353141033373010851411899063207359252317845617788486152084097996161951607075526045796294269180195617694600310298365306053247057038631088894596240751441036842918276089201617169287026865078594774765749720881882802881828282593949861999972983150274426090825607252511101783484830324425960589823065107734367701062429129988752511807642589018556438468736528286490143324590323667921809, 14614034441012778293137473086633630265649701969941154268770044720080815753509578891278180391973505358690528554774945713350178015180660958849492699471696540533037229348328187546698408636098560882156797223120456953146198082440467610904542891004365972384778900094467795995848069039170326511960815050814119987884996078973626805712610037071776396313451847840676985037388757858071864447123)</span><br><span class="line">enc = (74158970310971046231997292851174632705425701438436982687926541524724544224231671471756658836625071336004647139089957902974649062221314465084271501589880770583941500196989635332899104572053993557369592779214576832520061811752375562631936339531925289336294731237548348991115741285818322588605461239511885627502936265303243765703454352951543594465847846082641044334665902197532903361220, 32862210810953363269397127296728098991061383898392345745080345431931505360414244177467955530544676345008050896351576923265903524343350732466422536502620280273396299390682777548383347188854201456093950612280100041148727882639697090249087208377309058187228075582307715470057023215738254854627890486238852220413501003095534357306896337255070197365694626426757850493485339926618395215692, 8760728942548667764591709653964398229332835041712977477051692400662690767214082230265877984156055902045022941831987525871134103847451840503068333260259579853989011172849487654339072318429238338649112865664749209365538613493979432571794717299576778336030161337610867161636673944099727796251480137420420611432383002785264268560701104663971345262296523136517664986251708476458028224136)</span><br></pre></td></tr></table></figure>
<p>æœ€é‡é‡çº§çš„ä¸€é¢˜ã€‚</p>
<p>é¢˜ç›®åŸºäºCubic Pell Curveçš„åŠ å¯†ï¼Œå’Œå‰æ®µæ—¶é—´DASCTFçš„ä¸€æ ·ï¼Œå…³äºè¿™ä¸ªåŠ å¯†ç³»ç»Ÿçš„è®ºæ–‡æ˜¯ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://eprint.iacr.org/2024/385.pdf">385.pdf (iacr.org)</a></p>
<p>å…·ä½“åŠ å¯†å’Œè§£å¯†æ­¥éª¤å‚è€ƒè®ºæ–‡å°±å¯ä»¥äº†ï¼Œæ€»ä¹‹åªè¦æœ‰ç§é’¥â€”â€”ä¹Ÿå°±æ˜¯nçš„åˆ†è§£çš„è¯å°±å¯ä»¥åšã€‚å…¶ä¸­næ˜¯è¿™æ ·çš„å½¢å¼ï¼š</p>
<script type="math/tex; mode=display">
n = p^4q^6</script><p>å…¶ä¸­pã€qå‡ä¸º128bitçš„ç´ æ•°ã€‚</p>
<p>é—®é¢˜å°±åœ¨äºï¼Œæ•´ä¸ªé¢˜ç›®å°±å®Œå®Œå…¨å…¨æ˜¯æŠŠè¿™ä¸ªåŠ å¯†å®ç°äº†ä¸€éï¼Œå®Œå…¨æ²¡çœ‹å‡ºä»€ä¹ˆæ¼æ´ï¼Œé‚£æ€ä¹ˆè§£ï¼Ÿä¸è¿‡è€ƒè™‘åˆ°pã€qéƒ½æ˜¯128bitï¼Œè¯´å¤§çš„è¯ä¹Ÿä¸ç®—å¤§(å‰é¢å‡ ä¸ªé¢˜ä¸ä¹Ÿæ˜¯128bitæŒ‚yafuå—)ï¼Œæ‰€ä»¥è¿˜æ˜¯å…ˆç»™nå¼€äº†ä¸ªæ ¹ä¹‹åæŒ‚äº†ä¸ªyafuã€‚ä¸€æ—¶åŠä¼šå„¿æ²¡æœ‰åŠ¨é™ï¼Œå°±å…ˆæŒ‚ä½äº†ã€‚</p>
<p>è·ç¦»æ¯”èµ›ç»“æŸè¿˜å‰©å‡ å°æ—¶çš„æ—¶å€™ï¼Œå®åœ¨è§‰å¾—åˆå›°åˆé¥¿(é€šå®µ+æ²¡åƒé¥­)ï¼Œå…¶ä»–é¢˜ä¹Ÿåšçš„å·®ä¸å¤šäº†ï¼Œå°±æƒ³ç€å·®ä¸å¤šå‡ºé—¨åƒä¸ªé¥­ï¼Œè¿™ä¸ªæ—¶å€™æƒ³èµ·è¿˜æŒ‚äº†ä¸ªyafuï¼Œç„¶ååˆ‡è¿‡å»çœ‹äº†çœ‹ï¼š</p>
<p><img src="/post/cf09b856/image-20240701141056368.png" alt="image-20240701141056368"></p>
<p>å¤ªé€†å¤©äº†ï¼Œç¡¬æŒ‚32949.2510ç§’å‡ºäº†åˆ†è§£ï¼Œæ‰€ä»¥è¯´factorCTFä¸æ˜¯æ²¡æœ‰é“ç†ï¼Œå‘åˆ°ç¾¤é‡Œå¤§ç«ä¹Ÿç‚¸é”…äº†å“ˆå“ˆå“ˆï¼š</p>
<p><img src="/post/cf09b856/image-20240701141412956.png" alt="image-20240701141412956"></p>
<p><img src="/post/cf09b856/image-20240701141459600.png" alt="image-20240701141459600"></p>
<p><img src="/post/cf09b856/image-20240701141537346.png" alt="image-20240701141537346"></p>
<p><img src="/post/cf09b856/image-20240701141559738.png" alt="image-20240701141559738"></p>
<p>ä¹‹åæŠŠè¿™ä¸ªåˆ†è§£ç»™<a target="_blank" rel="noopener" href="https://hash-hash.github.io/">@hash-hash</a>(å› ä¸ºä»–ä¹‹å‰è§£è¿‡DASCTFé‚£ä¸ªï¼Œåº”è¯¥æ”¹ä¸€æ”¹å°±èƒ½ç”¨)ï¼Œä¹Ÿæ˜¯å¾ˆå¿«å°±æå®šäº†ï¼Œè¿™é‡Œå·æ‡’æ¬ä¸€æ¬ä»–çš„è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Pell_Curve</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, a, N</span>):</span><br><span class="line">        self.a = a</span><br><span class="line">        self.N = N</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">is_on_curve</span>(<span class="params">self, point</span>):</span><br><span class="line">        <span class="keyword">if</span> point <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        x, y, z = point</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            x**<span class="number">3</span> + self.a * y**<span class="number">3</span> + self.a**<span class="number">2</span> * z**<span class="number">3</span> - <span class="number">3</span> * self.a * x * y * z</span><br><span class="line">        ) % self.N == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">self, P, Q</span>):</span><br><span class="line">        x1, y1, z1 = P</span><br><span class="line">        x2, y2, z2 = Q</span><br><span class="line">        x3 = (x1 * x2 + self.a * (y2 * z1 + y1 * z2)) % self.N</span><br><span class="line">        y3 = (x2 * y1 + x1 * y2 + self.a * z1 * z2) % self.N</span><br><span class="line">        z3 = (y1 * y2 + x2 * z1 + x1 * z2) % self.N</span><br><span class="line">        <span class="keyword">return</span> (x3, y3, z3)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">self, P, x</span>):</span><br><span class="line">        Q = (<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">while</span> x &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> x &amp; <span class="number">1</span>:</span><br><span class="line">                Q = self.add(Q, P)</span><br><span class="line">            P = self.add(P, P)</span><br><span class="line">            x &gt;&gt;= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> Q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>(<span class="params">E, Q, r, s</span>):</span><br><span class="line">    lcg = LCG(E, Q)</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        p = lcg.get_prime()</span><br><span class="line">        q = lcg.get_prime()</span><br><span class="line">        <span class="built_in">print</span>(p, q)</span><br><span class="line">        <span class="keyword">if</span> p % <span class="number">3</span> == <span class="number">1</span> <span class="keyword">and</span> q % <span class="number">3</span> == <span class="number">1</span>:</span><br><span class="line">            N = p**r * q**s</span><br><span class="line">            e = <span class="number">0x20002</span></span><br><span class="line">            <span class="keyword">return</span> (N, e)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">M, N, e</span>):</span><br><span class="line">    xm, ym = M</span><br><span class="line">    M = (xm, ym, <span class="number">0</span>)</span><br><span class="line">    a = (<span class="number">1</span> - xm**<span class="number">3</span>) * inverse(ym**<span class="number">3</span>, N) % N</span><br><span class="line">    curve = Pell_Curve(<span class="built_in">int</span>(a), N)</span><br><span class="line">    <span class="keyword">if</span> curve.is_on_curve(M):</span><br><span class="line">        <span class="keyword">return</span> curve.mul(M, e), curve.is_on_curve(curve.mul(M, e))</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">q = <span class="number">171955359080932502551172606124599656543</span></span><br><span class="line">p = <span class="number">242195390295637766135570468161415180323</span></span><br><span class="line"></span><br><span class="line">r, s = <span class="number">4</span>, <span class="number">6</span></span><br><span class="line"></span><br><span class="line">n, e = (<span class="number">88952423353141033373010851411899063207359252317845617788486152084097996161951607075526045796294269180195617694600310298365306053247057038631088894596240751441036842918276089201617169287026865078594774765749720881882802881828282593949861999972983150274426090825607252511101783484830324425960589823065107734367701062429129988752511807642589018556438468736528286490143324590323667921809</span>, <span class="number">14614034441012778293137473086633630265649701969941154268770044720080815753509578891278180391973505358690528554774945713350178015180660958849492699471696540533037229348328187546698408636098560882156797223120456953146198082440467610904542891004365972384778900094467795995848069039170326511960815050814119987884996078973626805712610037071776396313451847840676985037388757858071864447123</span>)</span><br><span class="line">x, y, z = (<span class="number">74158970310971046231997292851174632705425701438436982687926541524724544224231671471756658836625071336004647139089957902974649062221314465084271501589880770583941500196989635332899104572053993557369592779214576832520061811752375562631936339531925289336294731237548348991115741285818322588605461239511885627502936265303243765703454352951543594465847846082641044334665902197532903361220</span>, <span class="number">32862210810953363269397127296728098991061383898392345745080345431931505360414244177467955530544676345008050896351576923265903524343350732466422536502620280273396299390682777548383347188854201456093950612280100041148727882639697090249087208377309058187228075582307715470057023215738254854627890486238852220413501003095534357306896337255070197365694626426757850493485339926618395215692</span>, <span class="number">8760728942548667764591709653964398229332835041712977477051692400662690767214082230265877984156055902045022941831987525871134103847451840503068333260259579853989011172849487654339072318429238338649112865664749209365538613493979432571794717299576778336030161337610867161636673944099727796251480137420420611432383002785264268560701104663971345262296523136517664986251708476458028224136</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = [</span><br><span class="line"></span><br><span class="line">    <span class="number">38082677088809290708888864314473611698208489947149149020141323354876853986846324667486599783099732449253321999219530956251885062836963617473433230328586192652813973364030607478840215477264438623285384369097235663234708836294503355550514113793191654083605154926924302782918924474190008822819680949832855309114998683480624021568578210762241091831893916401635203167722829317883574117304</span>,</span><br><span class="line"> <span class="number">55542785903937490819242771302549793176088751965230011448729375621780480702917260980627366579559731499071481465701273803009160786625112585403160409241867914028776478433782380129148977220686475108517789796522840237011806357784338595091229781789385237782508264914170678295844412591496324511913794387127204408153535129355464447351230388778897031953295817190543912286619989423406655977700</span>,</span><br><span class="line"> <span class="number">32809102117103053026047707178806708898308641810687342740050761956023499193587988346676441294031383037731625771964079418993097123328311195543468739276724770166588580694731012772209001624219626666752889679553768268558153713398821943876723711708308989355210892928040680077147537640505525324780317757262161253076610556164212322764995420591745497492132140599484611217302174245592265314953</span>,</span><br><span class="line"> <span class="number">50269210932231253136401614166882890376188903828768205168638814222927125909658924659817208090491382087549785238445822265750372847116460163473195918190006491542551085764482785422517763367641663151985295106979372842335251234888657183417439379704502573054114002915287055590073025757811841013874431194556510352115147002039052748547647598608401437613534041388393320336199334351115347175349</span>]</span><br><span class="line"></span><br><span class="line">C = (<span class="number">74158970310971046231997292851174632705425701438436982687926541524724544224231671471756658836625071336004647139089957902974649062221314465084271501589880770583941500196989635332899104572053993557369592779214576832520061811752375562631936339531925289336294731237548348991115741285818322588605461239511885627502936265303243765703454352951543594465847846082641044334665902197532903361220</span>, <span class="number">32862210810953363269397127296728098991061383898392345745080345431931505360414244177467955530544676345008050896351576923265903524343350732466422536502620280273396299390682777548383347188854201456093950612280100041148727882639697090249087208377309058187228075582307715470057023215738254854627890486238852220413501003095534357306896337255070197365694626426757850493485339926618395215692</span>, <span class="number">8760728942548667764591709653964398229332835041712977477051692400662690767214082230265877984156055902045022941831987525871134103847451840503068333260259579853989011172849487654339072318429238338649112865664749209365538613493979432571794717299576778336030161337610867161636673944099727796251480137420420611432383002785264268560701104663971345262296523136517664986251708476458028224136</span>)</span><br><span class="line"></span><br><span class="line">Fp = GF(p)</span><br><span class="line">Fq = GF(q)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> a0 <span class="keyword">in</span> a:</span><br><span class="line">    curve = Pell_Curve(<span class="built_in">int</span>(a0), n)</span><br><span class="line">    <span class="keyword">try</span>: </span><br><span class="line">        root = Fp(a0).nth_root(<span class="number">3</span>)</span><br><span class="line">        phi1 = p^(<span class="number">2</span>*(r-<span class="number">1</span>))*(p-<span class="number">1</span>)^<span class="number">2</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        phi1 = p^(<span class="number">2</span>*(r-<span class="number">1</span>))*(p^<span class="number">2</span>+p+<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">try</span>: </span><br><span class="line">        root = Fq(a0).nth_root(<span class="number">3</span>)</span><br><span class="line">        phi2 = q^(<span class="number">2</span>*(s-<span class="number">1</span>))*(q-<span class="number">1</span>)^<span class="number">2</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        phi2 = q^(<span class="number">2</span>*(s-<span class="number">1</span>))*(q^<span class="number">2</span>+q+<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    phi = phi1*phi2</span><br><span class="line">    d = inverse_mod(e, phi)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(curve.mul(C, d)[<span class="number">0</span>]))</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(curve.mul(C, d)[<span class="number">1</span>]))</span><br><span class="line">    </span><br><span class="line"><span class="comment">#CCTF&#123;n3W_Publ1c_k3Y_crYp70sy5T3m_8a5Ed_ON_7h3_cBb!c_Pell_curV3s!!!&#125;</span></span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªé¢˜å°±è¿™ä¹ˆç»“æŸäº†ï¼Œæœ‰ç‚¹å¥‡å¦™ã€‚</p>
<blockquote>
<p>èµ›åçœ‹<a target="_blank" rel="noopener" href="https://d33b4t0.com/archives/">deebato</a>ä»–ä»¬ç¡¬æŒ‚yafuæ²¡ç›´æ¥æ˜¾ç¤ºç»“æœï¼Œä½†æ˜¯åœ¨logé‡Œæ‰¾åˆ°äº†åˆ†è§£ï¼Œçªç„¶æ„Ÿè§‰æˆ‘è¿™é‡Œåˆ†è§£å‡ºå› å­çš„æ—¶å€™å¯èƒ½ä¹Ÿè¿œè¿œä¸åˆ°32949.2510è¿™ä¹ˆå¤šç§’ï¼Œåªæ˜¯ç¨‹åºæ²¡è¿è¡Œå®Œæ²¡æ˜¾ç¤ºç½¢äº†ï¼Œåˆå­¦åˆ°ä¸€æ‹›ã€‚</p>
<p>å…³äºè¿™ä¸ªé¢˜ï¼Œå…¶å®èµ›ä¸­<a target="_blank" rel="noopener" href="https://yolbby.github.io/">@yolbby</a>æƒ³å‡ºäº†ä¸€ä¸ªå¾ˆåˆç†çš„æ€è·¯ï¼Œåªæ˜¯å¯¹äºè¿™ä¸ªé¢˜çš„æ•°æ®æ¥è¯´å¹¶ä¸å¤ªé€‚ç”¨ï¼Œæˆ‘æŠŠä»–çš„æƒ³æ³•å‡ºæˆäº†ä¸€é¢˜ï¼Œæ”¾åœ¨äº†<a target="_blank" rel="noopener" href="https://www.nssctf.cn/problem/5638">NSSCTF</a>ä¸Š</p>
<p>ç›¸å¯¹äºè¿™ä¸ªé¢˜ç›®ï¼Œä»…ä»…æ˜¯æŠŠpã€qæ”¹æˆäº†512bitï¼Œåˆ«çš„éƒ½æ²¡æœ‰å˜ï¼Œæœ‰å…´è¶£çš„å¸ˆå‚…å¯ä»¥åšåšçœ‹</p>
</blockquote>
<p><br></p>
<h3 id="Jonon-13-solves-247-pts"><a href="#Jonon-13-solves-247-pts" class="headerlink" title="Jonon(13 solves , 247 pts)"></a>Jonon(13 solves , 247 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The Jonon challenge is a variation of the Imen challenge, and it provides a similar level of difficulty as the original version - it&#x27;s an enjoyable experience.</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> printable <span class="keyword">as</span> prn</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genimen</span>(<span class="params">k, p, _B</span>):</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		A = random_matrix(GF(p), k)</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">			<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">				A[i, j] = <span class="built_in">int</span>(A[i, j]) % (_B + <span class="number">1</span>)</span><br><span class="line">		<span class="keyword">if</span> det(A) != <span class="number">0</span>: <span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genkey</span>(<span class="params">k, p, _B, l</span>):</span><br><span class="line">	sA = [genimen(k, p, _B) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(l + <span class="number">1</span>)]</span><br><span class="line">	L = <span class="built_in">list</span>(<span class="built_in">range</span>(l))</span><br><span class="line">	shuffle(L)</span><br><span class="line">	s, pE = randint(<span class="number">1</span>, p - <span class="number">1</span>), prod([sA[_] <span class="keyword">for</span> _ <span class="keyword">in</span> L])</span><br><span class="line">	sD, sE = sA[-<span class="number">1</span>], s * pE</span><br><span class="line">	pkey = [sE * _ * sD * sE.inverse() <span class="keyword">for</span> _ <span class="keyword">in</span> sA[:-<span class="number">1</span>]], sA[:-<span class="number">1</span>], pE</span><br><span class="line">	skey = L, s, sE, sD</span><br><span class="line">	<span class="keyword">return</span> pkey, skey</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">pkey, _p</span>):</span><br><span class="line">	pA, psA, pE = pkey</span><br><span class="line">	k = pA[<span class="number">0</span>].nrows()</span><br><span class="line">	C = identity_matrix(GF(p), k)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> _p: C *= pA[i]</span><br><span class="line">	<span class="keyword">return</span> C</span><br><span class="line"></span><br><span class="line">nbit = <span class="number">256</span></span><br><span class="line">k, l, p, _B = <span class="number">5</span>, <span class="number">19</span>, getPrime(nbit), <span class="number">63</span></span><br><span class="line">_p = <span class="built_in">list</span>(<span class="built_in">range</span>(l))</span><br><span class="line">shuffle(_p)</span><br><span class="line">flag = <span class="string">&#x27;CCTF&#123;&#x27;</span> + <span class="string">&#x27;&#x27;</span>.join([prn[<span class="number">10</span> + _p[_]] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(l)]) + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">pkey, skey = genkey(k, p, _B, l)</span><br><span class="line">C = encrypt(pkey, _p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;pkey = <span class="subst">&#123;pkey&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;C = <span class="subst">&#123;C&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>outputæ¯”è¾ƒé•¿ï¼Œä¹Ÿä¸æ”¾åœ¨è¿™é‡Œã€‚</p>
<p>å¯ä»¥çœ‹å‡ºè¿™ä¸ªé¢˜å’ŒImenç›¸å½“çš„ç¥ä¼¼ï¼Œåªæ˜¯ç¨ç¨å˜äº†ä¸€äº›ã€‚å…ˆæŠŠgenkeyæ¢³ç†ä¸€ä¸‹ï¼š</p>
<ul>
<li><p>ç”Ÿæˆl+1ä¸ªæ¨¡pä¸‹çš„çŸ©é˜µï¼š</p>
<script type="math/tex; mode=display">
sA_1,sA_2,...,sA_{l+1}</script></li>
<li><p>ç”Ÿæˆéšæœºæ•°s</p>
</li>
<li><p>å°†sAæ‰“ä¹±åï¼Œè®¡ç®—å…¶ä¹˜ç§¯pEï¼š</p>
<script type="math/tex; mode=display">
pE = sA_isA_j...sA_k\quad(i,j,...,k = Permutation(1,2,...,l+1))</script></li>
<li><p>è®¡ç®—ï¼š</p>
<script type="math/tex; mode=display">
sD = sA_{l+1}</script><script type="math/tex; mode=display">
sE = s \cdot pE</script></li>
<li><p>å†ä¾æ¬¡è®¡ç®—ä¸‹é¢çŸ©é˜µçš„å€¼å¾—åˆ°åˆ—è¡¨ï¼Œå¹¶å’ŒsA(ä¸åŒ…å«sD)å’ŒpEä¸€åŒä½œä¸ºå…¬é’¥pkeyï¼š</p>
<script type="math/tex; mode=display">
sE \cdot sA_{i} \cdot sD \cdot sE^{-1} \quad ,i \in \{1,2,...,l\}</script></li>
<li><p>æ‰“ä¹±åçš„åˆ—è¡¨Lï¼Œsï¼ŒsEå’ŒsDä½œä¸ºç§é’¥</p>
</li>
</ul>
<p>ç„¶åæ˜¯encryptï¼š</p>
<ul>
<li><p>å…ˆç”Ÿæˆä¸€ä¸ª1-lçš„éšæœºç½®æ¢piï¼Œå¹¶ç”¨è¿™ä¸ªç½®æ¢ç”Ÿæˆflag(ä¹Ÿå°±æ˜¯æ±‚å‡ºç½®æ¢å°±æœ‰flag)</p>
</li>
<li><p>ç”Ÿæˆpkeyï¼Œskey</p>
</li>
<li><p>è®¡ç®—Cï¼š</p>
<script type="math/tex; mode=display">
C = \prod_{i=pi_1}^{pi_l}(sE \cdot sA_{i} \cdot sD \cdot sE^{-1})</script></li>
</ul>
<p>è¦æ±‚æ±‚å‡ºç½®æ¢ã€‚</p>
<p>é¦–å…ˆï¼Œæ‰€æœ‰çŸ©é˜µéƒ½æ˜¯æ¨¡pä¸‹çš„ï¼Œè™½ç„¶æˆ‘ä»¬å¹¶æ²¡æœ‰pï¼Œä½†æ˜¯æˆ‘ä»¬æœ‰æ‰€æœ‰çš„ï¼š</p>
<script type="math/tex; mode=display">
T_i = sE \cdot sA_{i} \cdot sD \cdot sE^{-1} \quad ,i \in \{1,2,...,l\}</script><p>æ±‚é€†å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
T_i^{-1} = sE \cdot sD^{-1} \cdot sA_i^{-1} \cdot sE^{-1} ,i \in \{1,2,...,l\}</script><p>æ‰€ä»¥æœ‰ï¼š</p>
<script type="math/tex; mode=display">
T_iT_j = sE \cdot sA_i \cdot sA_j^{-1} \cdot sE^{-1}</script><p>ç„¶ååˆå› ä¸ºé€†çŸ©é˜µå…·æœ‰ä¸‹é¢çš„æ€§è´¨ï¼š</p>
<script type="math/tex; mode=display">
(sA)^{-1} = s^{-1}A^{-1}</script><p>æ‰€ä»¥è¯´ä¸Šé¢çš„å¼å­åˆå¯ä»¥å˜æˆï¼š</p>
<script type="math/tex; mode=display">
T_iT_j = (s\cdot pE) \cdot sA_i \cdot sA_j^{-1} \cdot (s^{-1} \cdot pE^{-1})</script><p>ä¹Ÿå°±æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
T_iT_j = pE \cdot sA_i \cdot sA_j^{-1} \cdot pE^{-1}</script><p>è€Œè¿™å‡ ä¸ªçŸ©é˜µéƒ½æ˜¯å…¬é’¥é‡Œçš„ï¼Œæ‰€ä»¥å¯ä»¥åœ¨ZZä¸Šç›´æ¥æ±‚è¿™ä¸ªçŸ©é˜µï¼Œé‚£ä¹ˆä¸¤è€…çš„è¡Œåˆ—å¼åœ¨æ¨¡pä¸‹åº”è¯¥ç›¸ç­‰ï¼Œæ‰€ä»¥å¯ä»¥å¤šæ±‚å‡ ç»„ä½œå·®ï¼Œç„¶ågcdå°±å¾—åˆ°päº†ã€‚</p>
<p>æœ‰äº†pè¿‡åï¼Œåˆå› ä¸ºï¼š</p>
<script type="math/tex; mode=display">
T_i = pE \cdot sA_{i} \cdot sD \cdot pE^{-1} \quad ,i \in \{1,2,...,l\}</script><p>æ‰€ä»¥åˆå¾ˆè½»æ¾å°±å¯ä»¥åœ¨æ¨¡pä¸‹è®¡ç®—å‡ºsDæ¥ã€‚</p>
<p>ä¹‹åå°±å¾ˆå¥½åŠäº†ï¼Œç°åœ¨æˆ‘ä»¬æ‹¥æœ‰Cï¼Œè¦æ±‚å¯¹åº”çš„ç½®æ¢ï¼š</p>
<script type="math/tex; mode=display">
C = \prod_{i=pi_1}^{pi_l}(sE \cdot sA_{i} \cdot sD \cdot sE^{-1})</script><p>è€Œå¯ä»¥çœ‹å‡ºï¼Œé¦–ä½çš„sEå’ŒsE^(-1)æ— éæ˜¯å¯¹çŸ©é˜µåšäº†ç›¸ä¼¼ï¼Œè€Œç›¸ä¼¼å‰åï¼ŒçŸ©é˜µçš„è¿¹æ˜¯ä¸ä¼šå˜çš„ï¼Œåˆå› ä¸ºsAå’ŒsDéƒ½è¾ƒå°ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡æšä¸¾sAï¼Œç„¶ååˆ¤æ–­è¿¹æ˜¯å¢å¤§è¿˜æ˜¯å‡å°æ¥æ£€æŸ¥æšä¸¾çš„æ˜¯å¦æ­£ç¡®ï¼Œå°±å¾—åˆ°äº†ç½®æ¢ã€‚</p>
<p>ç„¶è€Œæœ‰ä¸ªç»†èŠ‚éœ€è¦æ³¨æ„ï¼Œé‚£å°±æ˜¯é¢˜ç›®è®¾ç½®çš„æ•°é‡çº§ä¼šä½¿å¾—æœ€ç»ˆCçš„è¿¹ä¹Ÿä¼šè¶…è¿‡pçš„å¤§å°ï¼Œæ‰€ä»¥å…ˆæšä¸¾å‡ºå¯èƒ½çš„åˆå§‹è·¯å¾„ä¹‹åï¼Œå†è¿›è¡Œæœç´¢æ‰è¡Œã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> printable <span class="keyword">as</span> prn</span><br><span class="line"></span><br><span class="line">T = </span><br><span class="line">sA = </span><br><span class="line">pE = </span><br><span class="line">C = </span><br><span class="line"></span><br><span class="line"><span class="comment">######################################################## part1 get p</span></span><br><span class="line">t1 = Matrix(ZZ,T[<span class="number">0</span>])*Matrix(ZZ,T[<span class="number">1</span>])^(-<span class="number">1</span>)</span><br><span class="line">t2 = Matrix(ZZ,pE)*Matrix(ZZ,sA[<span class="number">0</span>])*Matrix(ZZ,sA[<span class="number">1</span>])^(-<span class="number">1</span>)*Matrix(ZZ,pE)^(-<span class="number">1</span>)</span><br><span class="line">t3 = Matrix(ZZ,T[<span class="number">0</span>])*Matrix(ZZ,T[<span class="number">2</span>])^(-<span class="number">1</span>)</span><br><span class="line">t4 = Matrix(ZZ,pE)*Matrix(ZZ,sA[<span class="number">0</span>])*Matrix(ZZ,sA[<span class="number">2</span>])^(-<span class="number">1</span>)*Matrix(ZZ,pE)^(-<span class="number">1</span>)</span><br><span class="line">t5 = Matrix(ZZ,T[<span class="number">0</span>])*Matrix(ZZ,T[<span class="number">3</span>])^(-<span class="number">1</span>)</span><br><span class="line">t6 = Matrix(ZZ,pE)*Matrix(ZZ,sA[<span class="number">0</span>])*Matrix(ZZ,sA[<span class="number">3</span>])^(-<span class="number">1</span>)*Matrix(ZZ,pE)^(-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">kp = gcd(gcd(t1.det()-t2.det() , t3.det()-t4.det()) , t5.det()-t6.det())</span><br><span class="line">p = kp.numerator()</span><br><span class="line"><span class="keyword">assert</span> isPrime(p)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">######################################################## part2 get sD</span></span><br><span class="line">F = GF(p)</span><br><span class="line">T = [Matrix(F,i) <span class="keyword">for</span> i <span class="keyword">in</span> T]</span><br><span class="line">sA = [Matrix(F,i) <span class="keyword">for</span> i <span class="keyword">in</span> sA]</span><br><span class="line">pE = Matrix(F,pE)</span><br><span class="line">C = Matrix(F,C)</span><br><span class="line">sD = sA[<span class="number">0</span>]^(-<span class="number">1</span>)*pE^(-<span class="number">1</span>)*T[<span class="number">0</span>]*pE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">######################################################## part3 trace</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find</span>(<span class="params">temp,setT,path</span>):</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">all</span>(i[<span class="number">0</span>] == <span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> setT)):</span><br><span class="line">        flag = <span class="string">&#x27;CCTF&#123;&#x27;</span> + <span class="string">&#x27;&#x27;</span>.join([prn[<span class="number">10</span> + path[_]] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">19</span>)]) + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    tt = [ii <span class="keyword">for</span> ii <span class="keyword">in</span> setT]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(setT)):</span><br><span class="line">        <span class="keyword">if</span>((setT[i][<span class="number">1</span>]^(-<span class="number">1</span>)*temp).trace() &lt; temp.trace()):</span><br><span class="line">            tt[i][<span class="number">0</span>] = <span class="number">0</span></span><br><span class="line">            find(setT[i][<span class="number">1</span>]^(-<span class="number">1</span>)*temp , tt , path+[i])</span><br><span class="line">            tt[i][<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">T_table = [[<span class="number">1</span>,i] <span class="keyword">for</span> i <span class="keyword">in</span> T]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">19</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">19</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">19</span>):</span><br><span class="line">            temp = T[i]^(-<span class="number">1</span>)*T[j]^(-<span class="number">1</span>)*T[k]^(-<span class="number">1</span>)*C</span><br><span class="line">            tt = [ii <span class="keyword">for</span> ii <span class="keyword">in</span> T_table]</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(<span class="built_in">int</span>(temp.trace()))) &lt; <span class="number">232</span>:</span><br><span class="line">                tt[i][<span class="number">0</span>] = <span class="number">0</span></span><br><span class="line">                tt[j][<span class="number">0</span>] = <span class="number">0</span></span><br><span class="line">                tt[k][<span class="number">0</span>] = <span class="number">0</span></span><br><span class="line">                find(temp , tt , [k,j,i])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#CCTF&#123;mpradjnkfcqhilsoebg&#125;</span></span><br></pre></td></tr></table></figure>
<p>å’ŒImenä¸€æ ·ï¼Œè¿™ä¸ªé¢˜çš„è¾“å‡ºä¹Ÿæ˜¯ä¾æ‰˜ï¼Œè¦è‡ªå·±å¤„ç†ä¸€ä¸‹å˜æˆåˆ—è¡¨å½¢å¼ã€‚</p>
<p><br></p>
<h3 id="Rehawk-9-solves-300-pts"><a href="#Rehawk-9-solves-300-pts" class="headerlink" title="Rehawk(9 solves , 300 pts)"></a>Rehawk(9 solves , 300 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Rehawk is an advanced, modern cryptosystem of great complexity that only seasoned cryptographers can comprehend, with few able to successfully break it.</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_params</span>(<span class="params">m</span>):</span><br><span class="line">	C = CyclotomicField(m)</span><br><span class="line">	F, PHI = C.maximal_totally_real_subfield()</span><br><span class="line">	d = F.degree()</span><br><span class="line">	D = [[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(d)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(d)]</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(d):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i + <span class="number">1</span>):</span><br><span class="line">			<span class="keyword">if</span> (i - j) % <span class="number">2</span> == <span class="number">0</span>: D[i][j] = binomial(i, (i - j) &gt;&gt; <span class="number">1</span>)		</span><br><span class="line">	D = Matrix(D)</span><br><span class="line">	O = [F(_) <span class="keyword">for</span> _ <span class="keyword">in</span> D.inverse()]</span><br><span class="line">	<span class="keyword">return</span> (C, F, PHI, O, D)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genkey</span>(<span class="params">F, O, D, _B</span>):</span><br><span class="line">	_d, g = F.degree(), F.gen()</span><br><span class="line">	a = <span class="built_in">sum</span>([randint(-_B, _B + <span class="number">1</span>) * g**_ <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(_d)])</span><br><span class="line">	A = a.matrix().LLL()</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		b = <span class="built_in">sum</span>([randint(-_B, _B + <span class="number">1</span>) * g**_ <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(_d)])</span><br><span class="line">		B = b.matrix().LLL()</span><br><span class="line">		C = block_matrix([[A], [B]]).change_ring(ZZ)</span><br><span class="line">		R, M = C.hermite_form(transformation = <span class="literal">True</span>)</span><br><span class="line">		<span class="keyword">if</span> R[<span class="number">0</span>:_d] == identity_matrix(_d): <span class="keyword">break</span></span><br><span class="line">	c, d = F(-M[<span class="number">0</span>][_d:<span class="number">2</span>*_d]*B) / b, F(M[<span class="number">0</span>][<span class="number">0</span>:_d]*A) / a</span><br><span class="line">	n = (a*c + b*d) / (a**<span class="number">2</span> + b**<span class="number">2</span>)</span><br><span class="line">	N = vector(n) * D</span><br><span class="line">	_n = <span class="built_in">sum</span>(<span class="built_in">round</span>(N[_]) * O[_] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(_d))</span><br><span class="line">	_c, _d = c - _n * a, d - _n * b</span><br><span class="line">	skey = Matrix([[a, _c], [b, _d]])</span><br><span class="line">	pkey = (skey + identity_matrix(<span class="number">2</span>)) * (skey.T - identity_matrix(<span class="number">2</span>))</span><br><span class="line">	<span class="keyword">return</span> (skey, pkey)</span><br><span class="line"></span><br><span class="line">nbit = <span class="number">4</span> * <span class="number">32</span></span><br><span class="line">C, F, PHI, O, D = gen_params(nbit)</span><br><span class="line">skey, pkey = genkey(F, O, D, nbit &gt;&gt; <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">str</span>(<span class="built_in">sum</span>(skey.coefficients()).polynomial()(<span class="number">2</span>^<span class="number">128</span>))</span><br><span class="line">flag = <span class="string">&#x27;CCTF&#123;&#x27;</span> + sha256(flag.encode()).hexdigest() + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;flag_update.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(flag)</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;pubkey_update&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(pkey).encode())</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
<p>output.txtï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[            -<span class="number">4602774218265912404</span>*zeta1280^<span class="number">31</span> - <span class="number">25509381853469544908</span>*zeta1280^<span class="number">30</span> + <span class="number">129376017982404349488</span>*zeta1280^<span class="number">29</span> + <span class="number">716286531689185935744</span>*zeta1280^<span class="number">28</span> - <span class="number">1632208466401721293158</span>*zeta1280^<span class="number">27</span> - <span class="number">9028003170806549615013</span>*zeta1280^<span class="number">26</span> + <span class="number">12206704950441875625482</span>*zeta1280^<span class="number">25</span> + <span class="number">67457290883578785545644</span>*zeta1280^<span class="number">24</span> - <span class="number">60204416625997809670344</span>*zeta1280^<span class="number">23</span> - <span class="number">332433796634335506443469</span>*zeta1280^<span class="number">22</span> + <span class="number">206123873952616279215906</span>*zeta1280^<span class="number">21</span> + <span class="number">1137323310449735580891532</span>*zeta1280^<span class="number">20</span> - <span class="number">502186108465894748616016</span>*zeta1280^<span class="number">19</span> - <span class="number">2769056905000016534751538</span>*zeta1280^<span class="number">18</span> + <span class="number">878039249325641175319414</span>*zeta1280^<span class="number">17</span> + <span class="number">4838663751293786838127040</span>*zeta1280^<span class="number">16</span> - <span class="number">1097188014524649363149070</span>*zeta1280^<span class="number">15</span> - <span class="number">6043236501081735721161712</span>*zeta1280^<span class="number">14</span> + <span class="number">964124818127455367449150</span>*zeta1280^<span class="number">13</span> + <span class="number">5308004439355857834330485</span>*zeta1280^<span class="number">12</span> - <span class="number">578006232877698984851372</span>*zeta1280^<span class="number">11</span> - <span class="number">3181061779748249841736219</span>*zeta1280^<span class="number">10</span> + <span class="number">224962785316232564841220</span>*zeta1280^<span class="number">9</span> + <span class="number">1237722919632690072191185</span>*zeta1280^<span class="number">8</span> - <span class="number">52424883340535911897910</span>*zeta1280^<span class="number">7</span> - <span class="number">288372879182213647372365</span>*zeta1280^<span class="number">6</span> + <span class="number">6357946814410664097444</span>*zeta1280^<span class="number">5</span> + <span class="number">34967804349427160519879</span>*zeta1280^<span class="number">4</span> - <span class="number">302245973040480152708</span>*zeta1280^<span class="number">3</span> - <span class="number">1662172616495876145310</span>*zeta1280^<span class="number">2</span> + <span class="number">2366049046813041208</span>*zeta1280 + <span class="number">13011646416303986233</span>                     <span class="number">20341475869141650336</span>*zeta1280^<span class="number">31</span> + <span class="number">1951592807564566629</span>*zeta1280^<span class="number">30</span> - <span class="number">571077856249690441621</span>*zeta1280^<span class="number">29</span> - <span class="number">55295108849716726354</span>*zeta1280^<span class="number">28</span> + <span class="number">7196660823549758544764</span>*zeta1280^<span class="number">27</span> + <span class="number">702767505392614093619</span>*zeta1280^<span class="number">26</span> - <span class="number">53765538109270297626741</span>*zeta1280^<span class="number">25</span> - <span class="number">5291465118503133518883</span>*zeta1280^<span class="number">24</span> + <span class="number">264923914169814211875106</span>*zeta1280^<span class="number">23</span> + <span class="number">26259460116858500856269</span>*zeta1280^<span class="number">22</span> - <span class="number">906245929396843087071465</span>*zeta1280^<span class="number">21</span> - <span class="number">90407733487003834471466</span>*zeta1280^<span class="number">20</span> + <span class="number">2206203021593936629146834</span>*zeta1280^<span class="number">19</span> + <span class="number">221362527660366178501972</span>*zeta1280^<span class="number">18</span> - <span class="number">3854747120193508447272846</span>*zeta1280^<span class="number">17</span> - <span class="number">388741550159692397343437</span>*zeta1280^<span class="number">16</span> + <span class="number">4813958180021168270877045</span>*zeta1280^<span class="number">15</span> + <span class="number">487624064628609110025176</span>*zeta1280^<span class="number">14</span> - <span class="number">4227967989714953615984050</span>*zeta1280^<span class="number">13</span> - <span class="number">429881071729752134763778</span>*zeta1280^<span class="number">12</span> + <span class="number">2533644029049790041455129</span>*zeta1280^<span class="number">11</span> + <span class="number">258414888967057871397446</span>*zeta1280^<span class="number">10</span> - <span class="number">985769426015678192342018</span>*zeta1280^<span class="number">9</span> - <span class="number">100792924475518106238832</span>*zeta1280^<span class="number">8</span> + <span class="number">229662454242100806590311</span>*zeta1280^<span class="number">7</span> + <span class="number">23526719373273264108474</span>*zeta1280^<span class="number">6</span> - <span class="number">27847921707112376241503</span>*zeta1280^<span class="number">5</span> - <span class="number">2856416535680139555816</span>*zeta1280^<span class="number">4</span> + <span class="number">1323714816988549264238</span>*zeta1280^<span class="number">3</span> + <span class="number">135871497938828491146</span>*zeta1280^<span class="number">2</span> - <span class="number">10362137493026264546</span>*zeta1280 - <span class="number">1063759814089207676</span>]</span><br><span class="line">[                    <span class="number">20341475868748923024</span>*zeta1280^<span class="number">31</span> + <span class="number">1951592806605672059</span>*zeta1280^<span class="number">30</span> - <span class="number">571077856238540660223</span>*zeta1280^<span class="number">29</span> - <span class="number">55295108822895822100</span>*zeta1280^<span class="number">28</span> + <span class="number">7196660823407758697940</span>*zeta1280^<span class="number">27</span> + <span class="number">702767505055806319373</span>*zeta1280^<span class="number">26</span> - <span class="number">53765538108198903629865</span>*zeta1280^<span class="number">25</span> - <span class="number">5291465115995185819391</span>*zeta1280^<span class="number">24</span> + <span class="number">264923914164486524534940</span>*zeta1280^<span class="number">23</span> + <span class="number">26259460104538909856351</span>*zeta1280^<span class="number">22</span> - <span class="number">906245929378464841397589</span>*zeta1280^<span class="number">21</span> - <span class="number">90407733444980990175230</span>*zeta1280^<span class="number">20</span> + <span class="number">2206203021548855068437216</span>*zeta1280^<span class="number">19</span> + <span class="number">221362527558328990088394</span>*zeta1280^<span class="number">18</span> - <span class="number">3854747120114205378128966</span>*zeta1280^<span class="number">17</span> - <span class="number">388741549981824734924651</span>*zeta1280^<span class="number">16</span> + <span class="number">4813958179921541651869291</span>*zeta1280^<span class="number">15</span> + <span class="number">487624064406937426541122</span>*zeta1280^<span class="number">14</span> - <span class="number">4227967989627007169290270</span>*zeta1280^<span class="number">13</span> - <span class="number">429881071535409363510562</span>*zeta1280^<span class="number">12</span> + <span class="number">2533644028996862789742983</span>*zeta1280^<span class="number">11</span> + <span class="number">258414888850769755761022</span>*zeta1280^<span class="number">10</span> - <span class="number">985769425995015280773042</span>*zeta1280^<span class="number">9</span> - <span class="number">100792924430327984016820</span>*zeta1280^<span class="number">8</span> + <span class="number">229662454237274355481855</span>*zeta1280^<span class="number">7</span> + <span class="number">23526719362754563876958</span>*zeta1280^<span class="number">6</span> - <span class="number">27847921706526106032793</span>*zeta1280^<span class="number">5</span> - <span class="number">2856416534405482802868</span>*zeta1280^<span class="number">4</span> + <span class="number">1323714816960654684330</span>*zeta1280^<span class="number">3</span> + <span class="number">135871497878260136072</span>*zeta1280^<span class="number">2</span> - <span class="number">10362137492807861970</span>*zeta1280 - <span class="number">1063759813615106246</span> <span class="number">9479323308436728508</span>*zeta1280^<span class="number">31</span> - <span class="number">70533314534492196905</span>*zeta1280^<span class="number">30</span> - <span class="number">265607299367708827120</span>*zeta1280^<span class="number">29</span> + <span class="number">1979831130978284462763</span>*zeta1280^<span class="number">28</span> + <span class="number">3341016926189694874654</span>*zeta1280^<span class="number">27</span> - <span class="number">24945362580283401746400</span>*zeta1280^<span class="number">26</span> - <span class="number">24917836206749318963324</span>*zeta1280^<span class="number">25</span> + <span class="number">186334783002684698789191</span>*zeta1280^<span class="number">24</span> + <span class="number">122586899086925146656452</span>*zeta1280^<span class="number">23</span> - <span class="number">918010464058548571922420</span>*zeta1280^<span class="number">22</span> - <span class="number">418740666342845811245466</span>*zeta1280^<span class="number">21</span> + <span class="number">3139891285412312572660856</span>*zeta1280^<span class="number">20</span> + <span class="number">1018079424800570481061316</span>*zeta1280^<span class="number">19</span> - <span class="number">7642962939237553667703665</span>*zeta1280^<span class="number">18</span> - <span class="number">1776769434047526922198020</span>*zeta1280^<span class="number">17</span> + <span class="number">13352594357905645275206924</span>*zeta1280^<span class="number">16</span> + <span class="number">2216659229139532144217196</span>*zeta1280^<span class="number">15</span> - <span class="number">16673676083116486323107226</span>*zeta1280^<span class="number">14</span> - <span class="number">1945146801270513519057908</span>*zeta1280^<span class="number">13</span> + <span class="number">14642857602023675891482054</span>*zeta1280^<span class="number">12</span> + <span class="number">1164803955054950478252698</span>*zeta1280^<span class="number">11</span> - <span class="number">8774263024173173761196618</span>*zeta1280^<span class="number">10</span> - <span class="number">452930026846689350220538</span>*zeta1280^<span class="number">9</span> + <span class="number">3413634778211777313137122</span>*zeta1280^<span class="number">8</span> + <span class="number">105476445981425991518928</span>*zeta1280^<span class="number">7</span> - <span class="number">795268995785895547201508</span>*zeta1280^<span class="number">6</span> - <span class="number">12785805943160598272756</span>*zeta1280^<span class="number">5</span> + <span class="number">96428355297618433095990</span>*zeta1280^<span class="number">4</span> + <span class="number">607656823442098385608</span>*zeta1280^<span class="number">3</span> - <span class="number">4583526826365167751127</span>*zeta1280^<span class="number">2</span> - <span class="number">4756628030961100976</span>*zeta1280 + <span class="number">35880078853642750464</span>]</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªé¢˜ç›®çœ‹äº†ä¸€çœ¼æˆ‘å°±è¢«åŠé€€äº†ï¼Œåˆæ˜¯åˆ†åœ†åŸŸåˆæ˜¯hermiteçŸ©é˜µçš„ï¼Œçœ‹ç€å°±å¤´å¤§ã€‚</p>
<p>ç„¶å<a target="_blank" rel="noopener" href="https://yolbby.github.io/">@yolbby</a>ä¸€è¯­ç‚¹é†’æ¢¦ä¸­äººï¼Œå®šä½åˆ°è¿™é‡Œï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">skey = Matrix([[a, _c], [b, _d]])</span><br><span class="line">pkey = (skey + identity_matrix(<span class="number">2</span>)) * (skey.T - identity_matrix(<span class="number">2</span>))</span><br><span class="line"><span class="keyword">return</span> (skey, pkey)</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡ºskeyå’Œpkeyéƒ½æ˜¯2x2çš„çŸ©é˜µï¼Œå¹¶ä¸”è¿˜å­˜åœ¨å…³ç³»å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
P = (S + I)(S^T-I)</script><p>è€Œå…¶å®è¿™ç›¸å½“äºå››ä¸ªæ–¹ç¨‹å››ä¸ªæœªçŸ¥æ•°ï¼Œåªæ˜¯å…ƒç´ åœ¨ä¸€ä¸ªé™Œç”Ÿä¸€ç‚¹çš„åŸŸä¸­è€Œå·²ï¼Œsageä¾ç„¶æ˜¯å¯ä»¥æ­£å¸¸å¤„ç†çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç”¨è¿™å››ä¸ªæ–¹ç¨‹å»resultantå°±å¯ä»¥æŠŠskeyå®Œå…¨è§£å‡ºæ¥ã€‚åˆç”±äºflagæ˜¯æ ¹æ®skeyç”Ÿæˆçš„ï¼Œæ‰€ä»¥è§£å‡ºæ¥ä¹‹åå°±å¯ä»¥æ‹¿åˆ°flagã€‚</p>
<p>exp(from yolbby)ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">r&#x27;C:\Users\chax\Desktop\rehawk_updated\pubkey_update&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line"></span><br><span class="line">C = CyclotomicField(<span class="number">128</span>)</span><br><span class="line">F, PHI = C.maximal_totally_real_subfield()</span><br><span class="line">d = F.degree()</span><br><span class="line">D = [[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(d)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(d)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(d):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> (i - j) % <span class="number">2</span> == <span class="number">0</span>: D[i][j] = binomial(i, (i - j) &gt;&gt; <span class="number">1</span>)</span><br><span class="line">D = Matrix(D)</span><br><span class="line">O = [F(_) <span class="keyword">for</span> _ <span class="keyword">in</span> D.inverse()]</span><br><span class="line">a = f.readline().replace(<span class="string">b&#x27;                     &#x27;</span>,<span class="string">b&#x27;,&#x27;</span>).replace(<span class="string">b&#x27;^&#x27;</span>,<span class="string">b&#x27;**&#x27;</span>)</span><br><span class="line">zeta1280 = F.gen()</span><br><span class="line">a = matrix(F,<span class="built_in">eval</span>(a))</span><br><span class="line">b = [<span class="number">20341475868748923024</span>*zeta1280**<span class="number">31</span> + <span class="number">1951592806605672059</span>*zeta1280**<span class="number">30</span> - <span class="number">571077856238540660223</span>*zeta1280**<span class="number">29</span> - <span class="number">55295108822895822100</span>*zeta1280**<span class="number">28</span> + <span class="number">7196660823407758697940</span>*zeta1280**<span class="number">27</span> + <span class="number">702767505055806319373</span>*zeta1280**<span class="number">26</span> - <span class="number">53765538108198903629865</span>*zeta1280**<span class="number">25</span> - <span class="number">5291465115995185819391</span>*zeta1280**<span class="number">24</span> + <span class="number">264923914164486524534940</span>*zeta1280**<span class="number">23</span> + <span class="number">26259460104538909856351</span>*zeta1280**<span class="number">22</span> - <span class="number">906245929378464841397589</span>*zeta1280**<span class="number">21</span> - <span class="number">90407733444980990175230</span>*zeta1280**<span class="number">20</span> + <span class="number">2206203021548855068437216</span>*zeta1280**<span class="number">19</span> + <span class="number">221362527558328990088394</span>*zeta1280**<span class="number">18</span> - <span class="number">3854747120114205378128966</span>*zeta1280**<span class="number">17</span> - <span class="number">388741549981824734924651</span>*zeta1280**<span class="number">16</span> + <span class="number">4813958179921541651869291</span>*zeta1280**<span class="number">15</span> + <span class="number">487624064406937426541122</span>*zeta1280**<span class="number">14</span> - <span class="number">4227967989627007169290270</span>*zeta1280**<span class="number">13</span> - <span class="number">429881071535409363510562</span>*zeta1280**<span class="number">12</span> + <span class="number">2533644028996862789742983</span>*zeta1280**<span class="number">11</span> + <span class="number">258414888850769755761022</span>*zeta1280**<span class="number">10</span> - <span class="number">985769425995015280773042</span>*zeta1280**<span class="number">9</span> - <span class="number">100792924430327984016820</span>*zeta1280**<span class="number">8</span> + <span class="number">229662454237274355481855</span>*zeta1280**<span class="number">7</span> + <span class="number">23526719362754563876958</span>*zeta1280**<span class="number">6</span> - <span class="number">27847921706526106032793</span>*zeta1280**<span class="number">5</span> - <span class="number">2856416534405482802868</span>*zeta1280**<span class="number">4</span> + <span class="number">1323714816960654684330</span>*zeta1280**<span class="number">3</span> + <span class="number">135871497878260136072</span>*zeta1280**<span class="number">2</span> - <span class="number">10362137492807861970</span>*zeta1280 - <span class="number">1063759813615106246</span>,<span class="number">9479323308436728508</span>*zeta1280**<span class="number">31</span> - <span class="number">70533314534492196905</span>*zeta1280**<span class="number">30</span> - <span class="number">265607299367708827120</span>*zeta1280**<span class="number">29</span> + <span class="number">1979831130978284462763</span>*zeta1280**<span class="number">28</span> + <span class="number">3341016926189694874654</span>*zeta1280**<span class="number">27</span> - <span class="number">24945362580283401746400</span>*zeta1280**<span class="number">26</span> - <span class="number">24917836206749318963324</span>*zeta1280**<span class="number">25</span> + <span class="number">186334783002684698789191</span>*zeta1280**<span class="number">24</span> + <span class="number">122586899086925146656452</span>*zeta1280**<span class="number">23</span> - <span class="number">918010464058548571922420</span>*zeta1280**<span class="number">22</span> - <span class="number">418740666342845811245466</span>*zeta1280**<span class="number">21</span> + <span class="number">3139891285412312572660856</span>*zeta1280**<span class="number">20</span> + <span class="number">1018079424800570481061316</span>*zeta1280**<span class="number">19</span> - <span class="number">7642962939237553667703665</span>*zeta1280**<span class="number">18</span> - <span class="number">1776769434047526922198020</span>*zeta1280**<span class="number">17</span> + <span class="number">13352594357905645275206924</span>*zeta1280**<span class="number">16</span> + <span class="number">2216659229139532144217196</span>*zeta1280**<span class="number">15</span> - <span class="number">16673676083116486323107226</span>*zeta1280**<span class="number">14</span> - <span class="number">1945146801270513519057908</span>*zeta1280**<span class="number">13</span> + <span class="number">14642857602023675891482054</span>*zeta1280**<span class="number">12</span> + <span class="number">1164803955054950478252698</span>*zeta1280**<span class="number">11</span> - <span class="number">8774263024173173761196618</span>*zeta1280**<span class="number">10</span> - <span class="number">452930026846689350220538</span>*zeta1280**<span class="number">9</span> + <span class="number">3413634778211777313137122</span>*zeta1280**<span class="number">8</span> + <span class="number">105476445981425991518928</span>*zeta1280**<span class="number">7</span> - <span class="number">795268995785895547201508</span>*zeta1280**<span class="number">6</span> - <span class="number">12785805943160598272756</span>*zeta1280**<span class="number">5</span> + <span class="number">96428355297618433095990</span>*zeta1280**<span class="number">4</span> + <span class="number">607656823442098385608</span>*zeta1280**<span class="number">3</span> - <span class="number">4583526826365167751127</span>*zeta1280**<span class="number">2</span> - <span class="number">4756628030961100976</span>*zeta1280 + <span class="number">35880078853642750464</span>]</span><br><span class="line">b = matrix(F,b)</span><br><span class="line">pkey = block_matrix([[a],[b]])</span><br><span class="line">a2_c_2 = pkey[<span class="number">0</span>,<span class="number">0</span>]+<span class="number">1</span></span><br><span class="line">b_c = ((pkey[<span class="number">0</span>,<span class="number">1</span>]-pkey[<span class="number">1</span>,<span class="number">0</span>])/<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">ab_cd = pkey[<span class="number">0</span>,<span class="number">1</span>]-b_c</span><br><span class="line">b2_d_2 = pkey[<span class="number">1</span>,<span class="number">1</span>]+<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a2_c_2)</span><br><span class="line"><span class="built_in">print</span>(ab_cd)</span><br><span class="line"><span class="built_in">print</span>(b2_d_2)</span><br><span class="line"></span><br><span class="line">R.&lt;a,b,c,d&gt; = PolynomialRing(F)</span><br><span class="line">f1 = a^<span class="number">2</span>+c^<span class="number">2</span>-a2_c_2</span><br><span class="line">f2 = a*b+c*d-ab_cd</span><br><span class="line">f3 = b^<span class="number">2</span>+d^<span class="number">2</span>-b2_d_2</span><br><span class="line">f4 = b-c-b_c</span><br><span class="line"></span><br><span class="line">h1 = f1.sylvester_matrix(f4, b).det()</span><br><span class="line">h2 = f2.sylvester_matrix(f4, b).det()</span><br><span class="line">h3 = f3.sylvester_matrix(f4, b).det()</span><br><span class="line">g1 = h1.sylvester_matrix(h2, c).det()</span><br><span class="line">g2 = h1.sylvester_matrix(h3, c).det()</span><br><span class="line">t = g1.sylvester_matrix(g2, d).det()</span><br><span class="line"></span><br><span class="line">R.&lt;a&gt; = PolynomialRing(F)</span><br><span class="line">t = R(t)</span><br><span class="line"><span class="comment">#print(t.roots())</span></span><br><span class="line"></span><br><span class="line">a = -<span class="number">8</span>*zeta1280^<span class="number">31</span> + <span class="number">6</span>*zeta1280^<span class="number">30</span> + <span class="number">11</span>*zeta1280^<span class="number">29</span> - <span class="number">11</span>*zeta1280^<span class="number">28</span> - <span class="number">2</span>*zeta1280^<span class="number">27</span> - <span class="number">30</span>*zeta1280^<span class="number">26</span> + <span class="number">12</span>*zeta1280^<span class="number">25</span> - <span class="number">3</span>*zeta1280^<span class="number">24</span> + <span class="number">6</span>*zeta1280^<span class="number">23</span> + <span class="number">18</span>*zeta1280^<span class="number">22</span> - <span class="number">15</span>*zeta1280^<span class="number">21</span> + <span class="number">32</span>*zeta1280^<span class="number">20</span> - <span class="number">22</span>*zeta1280^<span class="number">19</span> + <span class="number">26</span>*zeta1280^<span class="number">18</span> + <span class="number">4</span>*zeta1280^<span class="number">17</span> + <span class="number">22</span>*zeta1280^<span class="number">16</span> - <span class="number">13</span>*zeta1280^<span class="number">15</span> + <span class="number">29</span>*zeta1280^<span class="number">14</span> - <span class="number">6</span>*zeta1280^<span class="number">13</span> - <span class="number">24</span>*zeta1280^<span class="number">12</span> - <span class="number">3</span>*zeta1280^<span class="number">11</span> - <span class="number">27</span>*zeta1280^<span class="number">10</span> + <span class="number">30</span>*zeta1280^<span class="number">9</span> + <span class="number">20</span>*zeta1280^<span class="number">8</span> + <span class="number">26</span>*zeta1280^<span class="number">7</span> + <span class="number">29</span>*zeta1280^<span class="number">6</span> - <span class="number">13</span>*zeta1280^<span class="number">5</span> - <span class="number">12</span>*zeta1280^<span class="number">4</span> + <span class="number">10</span>*zeta1280^<span class="number">3</span> - <span class="number">15</span>*zeta1280^<span class="number">2</span> + <span class="number">21</span>*zeta1280 + <span class="number">17</span></span><br><span class="line">R.&lt;c&gt; = PolynomialRing(F)</span><br><span class="line">f1 = a^<span class="number">2</span>+c^<span class="number">2</span>-a2_c_2</span><br><span class="line"><span class="comment">#print(f1.roots())</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">196363659</span>*zeta1280^<span class="number">31</span> + <span class="number">479447260</span>*zeta1280^<span class="number">30</span> - <span class="number">5574890698</span>*zeta1280^<span class="number">29</span> - <span class="number">13410452103</span>*zeta1280^<span class="number">28</span> + <span class="number">70999923425</span>*zeta1280^<span class="number">27</span> + <span class="number">168403887120</span>*zeta1280^<span class="number">26</span> - <span class="number">535696998441</span>*zeta1280^<span class="number">25</span> - <span class="number">1253973849729</span>*zeta1280^<span class="number">24</span> + <span class="number">2663843670086</span>*zeta1280^<span class="number">23</span> + <span class="number">6159795499952</span>*zeta1280^<span class="number">22</span> - <span class="number">9189122836929</span>*zeta1280^<span class="number">21</span> - <span class="number">21011422148145</span>*zeta1280^<span class="number">20</span> + <span class="number">22540780354795</span>*zeta1280^<span class="number">19</span> + <span class="number">51018594206807</span>*zeta1280^<span class="number">18</span> - <span class="number">39651534571929</span>*zeta1280^<span class="number">17</span> - <span class="number">88933831209400</span>*zeta1280^<span class="number">16</span> + <span class="number">49813309503893</span>*zeta1280^<span class="number">15</span> + <span class="number">110835841742009</span>*zeta1280^<span class="number">14</span> - <span class="number">43973223346903</span>*zeta1280^<span class="number">13</span> - <span class="number">97171385626612</span>*zeta1280^<span class="number">12</span> + <span class="number">26463625856054</span>*zeta1280^<span class="number">11</span> + <span class="number">58144057818179</span>*zeta1280^<span class="number">10</span> - <span class="number">10331455784462</span>*zeta1280^<span class="number">9</span> - <span class="number">22595061111030</span>*zeta1280^<span class="number">8</span> + <span class="number">2413225554250</span>*zeta1280^<span class="number">7</span> + <span class="number">5259350115786</span>*zeta1280^<span class="number">6</span> - <span class="number">293135104364</span>*zeta1280^<span class="number">5</span> - <span class="number">637328376483</span>*zeta1280^<span class="number">4</span> + <span class="number">13947289953</span>*zeta1280^<span class="number">3</span> + <span class="number">30284177528</span>*zeta1280^<span class="number">2</span> - <span class="number">109201303</span>*zeta1280 - <span class="number">237050725</span></span><br><span class="line">c = -c</span><br><span class="line">b = c+b_c</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"></span><br><span class="line">R.&lt;d&gt; = PolynomialRing(F)</span><br><span class="line">f3 = b^<span class="number">2</span>+d^<span class="number">2</span>-b2_d_2</span><br><span class="line"><span class="built_in">print</span>(f3.roots())</span><br><span class="line">d = <span class="number">266010789</span>*zeta1280^<span class="number">31</span> + <span class="number">482737266</span>*zeta1280^<span class="number">30</span> - <span class="number">7361323736</span>*zeta1280^<span class="number">29</span> - <span class="number">13829433097</span>*zeta1280^<span class="number">28</span> + <span class="number">91483219711</span>*zeta1280^<span class="number">27</span> + <span class="number">177606388336</span>*zeta1280^<span class="number">26</span> - <span class="number">674398006293</span>*zeta1280^<span class="number">25</span> - <span class="number">1350408311994</span>*zeta1280^<span class="number">24</span> + <span class="number">3281208330570</span>*zeta1280^<span class="number">23</span> + <span class="number">6762561063913</span>*zeta1280^<span class="number">22</span> - <span class="number">11091831601900</span>*zeta1280^<span class="number">21</span> - <span class="number">23477085414453</span>*zeta1280^<span class="number">20</span> + <span class="number">26707622486418</span>*zeta1280^<span class="number">19</span> + <span class="number">57918642171854</span>*zeta1280^<span class="number">18</span> - <span class="number">46200520267420</span>*zeta1280^<span class="number">17</span> - <span class="number">102400447660711</span>*zeta1280^<span class="number">16</span> + <span class="number">57184654198715</span>*zeta1280^<span class="number">15</span> + <span class="number">129209740105463</span>*zeta1280^<span class="number">14</span> - <span class="number">49834602378781</span>*zeta1280^<span class="number">13</span> - <span class="number">114489362577117</span>*zeta1280^<span class="number">12</span> + <span class="number">29667951387175</span>*zeta1280^<span class="number">11</span> + <span class="number">69115665617763</span>*zeta1280^<span class="number">10</span> - <span class="number">11481488829941</span>*zeta1280^<span class="number">9</span> - <span class="number">27050018004836</span>*zeta1280^<span class="number">8</span> + <span class="number">2664050718278</span>*zeta1280^<span class="number">7</span> + <span class="number">6330200656934</span>*zeta1280^<span class="number">6</span> - <span class="number">322126775377</span>*zeta1280^<span class="number">5</span> - <span class="number">769914149547</span>*zeta1280^<span class="number">4</span> + <span class="number">15288262361</span>*zeta1280^<span class="number">3</span> + <span class="number">36657928391</span>*zeta1280^<span class="number">2</span> - <span class="number">119641092</span>*zeta1280 - <span class="number">287055447</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a*b+c*d == ab_cd)</span><br><span class="line">skey = matrix([[a,c],[b,d]])</span><br><span class="line"></span><br><span class="line">P = (skey + identity_matrix(<span class="number">2</span>)) * (skey.T - identity_matrix(<span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(P[<span class="number">0</span>,<span class="number">0</span>] == pkey[<span class="number">0</span>,<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(P[<span class="number">0</span>,<span class="number">1</span>] == pkey[<span class="number">0</span>,<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(P[<span class="number">1</span>,<span class="number">0</span>] == pkey[<span class="number">1</span>,<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(P[<span class="number">1</span>,<span class="number">1</span>] == pkey[<span class="number">1</span>,<span class="number">1</span>])</span><br><span class="line">flag = <span class="built_in">str</span>(<span class="built_in">sum</span>(skey.coefficients()).polynomial()(<span class="number">2</span>^<span class="number">128</span>))</span><br><span class="line">flag = <span class="string">&#x27;CCTF&#123;&#x27;</span> + sha256(flag.encode()).hexdigest() + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="Vorop-7-solves-334-pts"><a href="#Vorop-7-solves-334-pts" class="headerlink" title="Vorop(7 solves , 334 pts)"></a>Vorop(7 solves , 334 pts)</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Vorop is a post-modern cryptosystem with diverse applications in finite fields and matrices - thoroughly analyze it to attempt breaking it.</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">die</span>(<span class="params">*args</span>):</span><br><span class="line">	pr(*args)</span><br><span class="line">	quit()</span><br><span class="line">	</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pr</span>(<span class="params">*args</span>):</span><br><span class="line">	s = <span class="string">&quot; &quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, args))</span><br><span class="line">	sys.stdout.write(s + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">	sys.stdout.flush()</span><br><span class="line">	</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sc</span>(): </span><br><span class="line">	<span class="keyword">return</span> sys.stdin.buffer.readline()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rand_utm</span>(<span class="params">F, n</span>):</span><br><span class="line">	M = matrix(F, n, n)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i, n):</span><br><span class="line">			M[i,j] = F.random_element()</span><br><span class="line">	<span class="keyword">return</span> M</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upper</span>(<span class="params">F, M</span>):</span><br><span class="line">	r, c = M.nrows(), M.ncols()</span><br><span class="line">	_U = matrix(F, r, c)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(r):</span><br><span class="line">		_U[i, i] = M[i, i]</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i + <span class="number">1</span>, c):</span><br><span class="line">			_U[i, j] = M[i, j] + M[j, i]</span><br><span class="line">	<span class="keyword">return</span> _U</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genkey</span>(<span class="params">q, m, d, u</span>):</span><br><span class="line">	n = m + d + u</span><br><span class="line">	F = GF(q)</span><br><span class="line">	O = random_matrix(F, u, m + d)</span><br><span class="line">	c = O.ncols()</span><br><span class="line">	I = identity_matrix(F, c)</span><br><span class="line">	OI = block_matrix([[O], [I]])</span><br><span class="line">	P = []</span><br><span class="line">	<span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">		A = rand_utm(F, u)</span><br><span class="line">		B = random_matrix(F, u, m + d)</span><br><span class="line">		C = O.transpose() * A * O + O.transpose() * B</span><br><span class="line">		C = upper(F, C)</span><br><span class="line">		D = matrix(F, m + d, u)</span><br><span class="line">		Q = block_matrix([[A, B], [D, C]])</span><br><span class="line">		P.append(Q)		</span><br><span class="line">	<span class="keyword">return</span> (O, OI), P</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">iszero</span>(<span class="params">M</span>):</span><br><span class="line">	F, r, c = M.base_ring(), M.nrows(), M.ncols()</span><br><span class="line">	<span class="keyword">return</span> matrix(F, r, c) == M</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">n2F</span>(<span class="params">n</span>):</span><br><span class="line">	z = GF(<span class="number">256</span>).gen()</span><br><span class="line">	G, g = <span class="built_in">bin</span>(n)[<span class="number">2</span>:].zfill(<span class="number">8</span>), GF(<span class="number">256</span>)(<span class="number">0</span>)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">		g += <span class="built_in">int</span>(G[i]) * z ^ (<span class="number">7</span> - i)</span><br><span class="line">	<span class="keyword">return</span> g</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compress</span>(<span class="params">M</span>):</span><br><span class="line">	r, c = M.nrows(), M.ncols()</span><br><span class="line">	_M = matrix(r, c)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(r):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(c):</span><br><span class="line">			_M[i, j] = M[i][j].to_integer()</span><br><span class="line">	<span class="keyword">return</span> _M</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">oracle</span>(<span class="params">O</span>) :</span><br><span class="line">	F = O.base_ring()</span><br><span class="line">	r, c = O.nrows(), O.ncols()</span><br><span class="line">	n = r + c</span><br><span class="line">	I = identity_matrix(F, c)</span><br><span class="line">	OI = block_matrix([[O], [I]])</span><br><span class="line">	U = matrix(F, n, <span class="number">1</span>)</span><br><span class="line">	<span class="keyword">while</span>(iszero(U)):</span><br><span class="line">		V = random_matrix(F, c, <span class="number">1</span>)</span><br><span class="line">		U = OI * V</span><br><span class="line">	<span class="keyword">return</span> U</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isequal</span>(<span class="params">F, A, B</span>):</span><br><span class="line">	l, k = <span class="built_in">len</span>(A), <span class="built_in">len</span>(B)</span><br><span class="line">	<span class="keyword">if</span> l != k: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">	n = A[<span class="number">0</span>].nrows()</span><br><span class="line">	<span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">		V = random_matrix(F, n, <span class="number">1</span>)</span><br><span class="line">		<span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">			r = V.transpose() * A[_] * V</span><br><span class="line">			s = V.transpose() * B[_] * V</span><br><span class="line">			<span class="keyword">if</span> r != s: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">P, OI</span>):</span><br><span class="line">	r, c, F = P[<span class="number">0</span>].nrows(), OI.ncols(), OI.base_ring()</span><br><span class="line">	B, Z = [], []</span><br><span class="line">	<span class="keyword">for</span> _ <span class="keyword">in</span> P:</span><br><span class="line">		Z.append(matrix(F, c, c))</span><br><span class="line">		B.append(OI.transpose() * _ * OI)</span><br><span class="line">	<span class="keyword">return</span> isequal(F, B, Z)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">	border = <span class="string">&quot;â”ƒ&quot;</span></span><br><span class="line">	pr(        <span class="string">&quot;â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“&quot;</span>)</span><br><span class="line">	pr(border, <span class="string">&quot;  .: Welcome to VOROP oracle! Try to break this cryptosystem :.   &quot;</span>, border)</span><br><span class="line">	pr(        <span class="string">&quot;â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›&quot;</span>)</span><br><span class="line">	q, m, d, u = <span class="number">2</span>**<span class="number">8</span>, <span class="number">38</span>, <span class="number">8</span>, <span class="number">86</span></span><br><span class="line">	params = (q, m, d, u)</span><br><span class="line">	F = GF(q)</span><br><span class="line">	(O, OI), P = genkey(q, m, d, u)</span><br><span class="line">	U = oracle(O)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> verify(P, OI):	</span><br><span class="line">		pr(<span class="string">&quot;| Options: \n|\t[G]et the parameters \n|\t[O]racle output \n|\t[P]ublic key \n|\t[V]erify \n|\t[Q]uit&quot;</span>)</span><br><span class="line">		ans = sc().decode().lower().strip()</span><br><span class="line">		<span class="keyword">if</span> ans == <span class="string">&#x27;g&#x27;</span>:</span><br><span class="line">			pr(border, <span class="string">f&quot;The parameters are q, m, d, u = <span class="subst">&#123;q, m, d, u&#125;</span>&quot;</span>)</span><br><span class="line">		<span class="keyword">elif</span> ans == <span class="string">&#x27;o&#x27;</span>:</span><br><span class="line">			pr(border, <span class="string">f&quot;The oracle output U = <span class="subst">&#123;compress(U.transpose())&#125;</span>&quot;</span>)</span><br><span class="line">		<span class="keyword">elif</span> ans == <span class="string">&#x27;p&#x27;</span>:</span><br><span class="line">			pr(border, <span class="string">f&quot;Public key P is very large matrix, I will print row by row!&quot;</span>)</span><br><span class="line">			<span class="keyword">for</span> p <span class="keyword">in</span> P:</span><br><span class="line">				_p = compress(p)</span><br><span class="line">				<span class="keyword">for</span> _r <span class="keyword">in</span> _p:</span><br><span class="line">					pr(border, <span class="string">f&quot;<span class="subst">&#123;_r&#125;</span>&quot;</span>)</span><br><span class="line">				pr(border, <span class="string">&quot;â”&quot;</span> * <span class="number">40</span>)</span><br><span class="line">			pr(border, <span class="string">&quot;Done!&quot;</span>)</span><br><span class="line">		<span class="keyword">elif</span> ans == <span class="string">&#x27;v&#x27;</span>:</span><br><span class="line">			pr(border, <span class="string">f&quot;You should send a matrix with the appropriate size!&quot;</span>)</span><br><span class="line">			pr(border, <span class="string">f&quot;So please send it row by row separated by comma &#x27;,&#x27;&quot;</span>)</span><br><span class="line">			B = []</span><br><span class="line">			<span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(m + d):</span><br><span class="line">				pr(border, <span class="string">f&quot;Send the row <span class="subst">&#123;_&#125;</span>:&quot;</span>)</span><br><span class="line">				_r = sc().decode().split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">				<span class="keyword">try</span>:</span><br><span class="line">					_r = [n2F(<span class="built_in">int</span>(_)) <span class="keyword">for</span> _ <span class="keyword">in</span> _r]</span><br><span class="line">					B.append(_r)</span><br><span class="line">				<span class="keyword">except</span>:</span><br><span class="line">					die(border, <span class="string">f&quot;The input you provided is is not valid!&quot;</span>)</span><br><span class="line">			_b, B = <span class="literal">False</span>, matrix(F, B)</span><br><span class="line">			<span class="keyword">if</span> B.ncols() == m + d + u:</span><br><span class="line">				_b = verify(P, B.transpose()) <span class="keyword">and</span> <span class="keyword">not</span> B.is_zero()</span><br><span class="line">				<span class="keyword">if</span> _b:</span><br><span class="line">					die(border, <span class="string">f&#x27;Congrats, you got the flag: <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br><span class="line">				<span class="keyword">else</span>:</span><br><span class="line">					die(border, <span class="string">f&#x27;The provided matrix is not correct! Bye!!&#x27;</span>)</span><br><span class="line">		<span class="keyword">elif</span> ans == <span class="string">&#x27;q&#x27;</span>:</span><br><span class="line">			die(border, <span class="string">&#x27;Quitting...&#x27;</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			die(border, <span class="string">f&quot;Your input does not meet the requirements!!!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>
<p>çŸ¥è¯†ç›²åŒºï¼ŒæŒ‰<a target="_blank" rel="noopener" href="https://hash-hash.github.io/">@hash-hash</a>çš„è¯´æ³•æ˜¯åŸºäºå¤šå˜é‡çš„ä¸€é“é¢˜ç›®ï¼Œä¹‹å‰ç¨å¾®çœ‹è¿‡ä¸€ç‚¹å¤šå˜é‡ï¼Œä½†é™¤äº†è¿˜è®°å¾—æ²¹å˜é‡å’Œé†‹å˜é‡ä¹‹å¤–ï¼Œå…¶ä»–çš„å®Œå…¨ä¸æ‡‚äº†ã€‚</p>
<p>ç›´æ¥å†™attackå¥½åƒå¾ˆæŠ˜ç£¨ï¼Œhashhashå°±å‘åŠ¨ç¾¤å‹ä¸€èµ·æ‰¾ç°æˆçš„attackï¼Œç„¶å<a target="_blank" rel="noopener" href="https://wleukocytec.github.io/">@leukocyte</a>æ‰¾åˆ°äº†è¿™ç¯‡ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://eprint.iacr.org/2024/279.pdf">https://eprint.iacr.org/2024/279.pdf</a></p>
<p>é‡Œé¢æœ‰å®ç°ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://github.com/River-Moreira-Ferreira/prov-attack">https://github.com/River-Moreira-Ferreira/prov-attack</a></p>
<p>hashhashç¨å¾®è°ƒè°ƒå°±èƒ½ç”¨äº†ï¼Œä½†æˆ‘ç¡®å®æ˜¯ä¸€ç‚¹éƒ½æ•´ä¸æ˜ç™½ï¼Œç›´æ¥èººå¥½ã€‚è€Œä¸”hashhashå¥½åƒè¿˜å‘ç°äº†ä¸ªéé¢„æœŸã€‚</p>
<p>ç„¶è€Œå¥‡æ€ªçš„äº‹æƒ…åˆå‘ç”Ÿäº†â€”â€”äº¤äº’æ€»æ˜¯ä¼šå¡åœ¨ç¬¬33è½®ï¼Œå¼€å§‹æ€€ç–‘æ˜¯ç½‘çš„é—®é¢˜ï¼Œæ‰€ä»¥å¤§å®¶éƒ½è·‘äº†ä¸€éï¼Œéƒ½å¡åœ¨33è½®ã€‚leukocyteæœ€åå‘ç°ä»–è¿œç«¯ä¸‹å‘çš„å‚æ•°å’Œé¢˜ç›®é™„ä»¶çš„ä¸ä¸€æ ·ï¼Œå¯¹åº”æ”¹ä¸€æ”¹å°±å¥½äº†ã€‚</p>
<p>ä½†è¿˜æ˜¯å®Œå…¨ä¸æ‡‚å¤šå˜é‡ï¼Œæœ‰ç©ºå­¦ä¸€å­¦ã€‚</p>
<p><br></p>
<p><br></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è™½ç„¶æ¯”èµ›æ§½ç‚¹å¾ˆå¤šï¼Œä½†æ˜¯æ€»è€Œè¨€ä¹‹ï¼Œä¸€ç¾¤å–œæ¬¢å¯†ç çš„å¸ˆå‚…èšä¸€å—å„¿æ‰“æ¯”èµ›æœ¬æ¥å°±æ˜¯å¾ˆå¼€å¿ƒçš„äº‹æƒ…ï¼Œæ˜å¹´ç»§ç»­åŠ æ²¹ã€‚</p>
<p>è¿˜æœ‰å°±æ˜¯æ¯”èµ›ç»“æŸç¬¬äºŒå¤©å»CTFtimeå»ºæˆ˜é˜Ÿçš„æ—¶å€™å‘ç°cyberCryerè¿™ä¸ªæˆ˜é˜Ÿå<strong>è¢« æŠ¢ æ³¨ äº†</strong>ï¼ŒçœŸæ˜¯ç¦»äº†å¤§è°±ã€‚ç»™CTFtimeå‘feedbackè¿‡åæ¢å¤äº†æ­£å¸¸ï¼Œç„¶è€Œæ’åä¼¼ä¹ä¸å¤ªå¥½æ”¹äº†ï¼Œå‘feedbackã€å‘é‚®ä»¶ç”šè‡³å»æ¨ä¸Šatéƒ½æ²¡æœ‰äººç†ï¼Œä¼¤å¿ƒã€‚</p>
<p><br></p>
<p><br></p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>ç³–é†‹å°é¸¡å—
  </li>
  <li class="post-copyright-link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="https://tangcuxiaojikuai.xyz/post/cf09b856.html" title="2024-CryptoCTF-wp-crypto">https://tangcuxiaojikuai.xyz/post/cf09b856.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sacreative/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SACREATIVE</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>
</div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/post/ee681ca2.html" rel="prev" title="2024-äº¬éº’CTF-wp-crypto">
      <i class="fa fa-chevron-left"></i> 2024-äº¬éº’CTF-wp-crypto
    </a></div>
      <div class="post-nav-item">
    <a href="/post/a02848e0.html" rel="next" title="2024-æ˜¥ç§‹æ¯ç½‘ç»œå®‰å…¨è”èµ›å¤å­£èµ›-wp-crypto">
      2024-æ˜¥ç§‹æ¯ç½‘ç»œå®‰å…¨è”èµ›å¤å­£èµ›-wp-crypto <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%98%9F%E4%BC%8D%E5%85%B6%E4%BB%96%E5%B8%88%E5%82%85%E7%9A%84wp%E6%8C%87%E8%B7%AF%EF%BC%9A"><span class="nav-number">1.</span> <span class="nav-text">é˜Ÿä¼å…¶ä»–å¸ˆå‚…çš„wpæŒ‡è·¯ï¼š</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Warm-up"><span class="nav-number">2.</span> <span class="nav-text">Warm-up</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Welcome-%F0%9F%91%8B-367-solves-27-pts"><span class="nav-number">2.1.</span> <span class="nav-text">Welcome! ğŸ‘‹(367 solves , 27 pts)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Easy"><span class="nav-number">3.</span> <span class="nav-text">Easy</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Alibos-181-solves-36-pts"><span class="nav-number">3.1.</span> <span class="nav-text">Alibos(181 solves , 36 pts)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Beheaded-32-solves-131-pts"><span class="nav-number">3.2.</span> <span class="nav-text">Beheaded(32 solves , 131 pts)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Mashy-68-solves-71-pts"><span class="nav-number">3.3.</span> <span class="nav-text">Mashy(68 solves , 71 pts)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Medium"><span class="nav-number">4.</span> <span class="nav-text">Medium</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Ahoo-29-solves-142-pts"><span class="nav-number">4.1.</span> <span class="nav-text">Ahoo(29 solves , 142 pts)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Alilbols-59-solves-80-pts"><span class="nav-number">4.2.</span> <span class="nav-text">Alilbols(59 solves , 80 pts)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Ally-22-solves-174-pts"><span class="nav-number">4.3.</span> <span class="nav-text">Ally(22 solves , 174 pts)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Bada-51-solves-90-pts"><span class="nav-number">4.4.</span> <span class="nav-text">Bada(51 solves , 90 pts)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Duzly-0-solves-500-pts"><span class="nav-number">4.5.</span> <span class="nav-text">Duzly(0 solves , 500 pts)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Forghan-36-solves-119-pts"><span class="nav-number">4.6.</span> <span class="nav-text">Forghan(36 solves , 119 pts)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Honey-48-solves-95-pts"><span class="nav-number">4.7.</span> <span class="nav-text">Honey(48 solves , 95 pts)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Joe-19-120-solves-47-pts"><span class="nav-number">4.8.</span> <span class="nav-text">Joe-19(120 solves , 47 pts)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Melek-66-solves-73-pts"><span class="nav-number">4.9.</span> <span class="nav-text">Melek(66 solves , 73 pts)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Nabat-25-solves-159-pts"><span class="nav-number">4.10.</span> <span class="nav-text">Nabat(25 solves , 159 pts)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Nazdone-35-solves-122-pts"><span class="nav-number">4.11.</span> <span class="nav-text">Nazdone(35 solves , 122 pts)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RM2-64-solves-75-pts"><span class="nav-number">4.12.</span> <span class="nav-text">RM2(64 solves , 75 pts)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Soufia-36-solves-119-pts"><span class="nav-number">4.13.</span> <span class="nav-text">Soufia(36 solves , 119 pts)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Vantuk-51-solves-90-pts"><span class="nav-number">4.14.</span> <span class="nav-text">Vantuk(51 solves , 90 pts)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Hard"><span class="nav-number">5.</span> <span class="nav-text">Hard</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Chochol-15-solves-226-pts"><span class="nav-number">5.1.</span> <span class="nav-text">Chochol(15 solves , 226 pts)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Imen-19-solves-194-pts"><span class="nav-number">5.2.</span> <span class="nav-text">Imen(19 solves , 194 pts)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Latifa-22-solves-174-pts"><span class="nav-number">5.3.</span> <span class="nav-text">Latifa(22 solves , 174 pts)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#O7R-23-solves-169-pts"><span class="nav-number">5.4.</span> <span class="nav-text">O7R(23 solves , 169 pts)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solmaz-11-solves-271-pts"><span class="nav-number">5.5.</span> <span class="nav-text">Solmaz(11 solves , 271 pts)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Tesvir-27-solves-150-pts"><span class="nav-number">5.6.</span> <span class="nav-text">Tesvir(27 solves , 150 pts)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Tough"><span class="nav-number">6.</span> <span class="nav-text">Tough</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Capac-5-solves-375-pts"><span class="nav-number">6.1.</span> <span class="nav-text">Capac(5 solves , 375 pts)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Jonon-13-solves-247-pts"><span class="nav-number">6.2.</span> <span class="nav-text">Jonon(13 solves , 247 pts)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Rehawk-9-solves-300-pts"><span class="nav-number">6.3.</span> <span class="nav-text">Rehawk(9 solves , 300 pts)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Vorop-7-solves-334-pts"><span class="nav-number">6.4.</span> <span class="nav-text">Vorop(7 solves , 334 pts)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">7.</span> <span class="nav-text">æ€»ç»“</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="ç³–é†‹å°é¸¡å—"
      src="/images/image.png">
  <p class="site-author-name" itemprop="name">ç³–é†‹å°é¸¡å—</p>
  <div class="site-description" itemprop="description">"è¿½é£èµ¶æœˆè«åœç•™ï¼Œå¹³èŠœå°½å¤„æ˜¯æ˜¥å±±"</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">97</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="/1142381085@qq.com" title="E-Mail â†’ 1142381085@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/6394335993" title="Weibo â†’ https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;6394335993" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ç³–é†‹å°é¸¡å—</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> å¼ºåŠ›é©±åŠ¨
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>
  <script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'UPEMA7DyYbIIEyOW72ohgytU-gzGzoHsz',
      appKey     : 'M7rXAfeP3JOslroay2n0Jv2R',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
<!-- å¼•å…¥jQuery -->
<script type="text/javascript" src="//libs.baidu.com/jquery/1.8.3/jquery.min.js"></script>
<!-- é›ªèŠ±ç‰¹æ•ˆ2 -->
<script type="text/javascript" src="/js/snow2.js"></script>
