<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon_small.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="RnN18ZogmZl_dLVpxZ6y8kjKL73Mu9VLVEkw9d3qrq0" />
  <meta name="msvalidate.01" content="DC3050AD55F30DDF75AAB78517714910" />
  <meta name="baidu-site-verification" content="codeva-PPofu3dNxe" />

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-loading-bar.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"tangcuxiaojikuai.xyz","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="èµ›é¢˜è®°å½•">
<meta property="og:type" content="article">
<meta property="og:title" content="2023-æå®¢å¤§æŒ‘æˆ˜-wp-crypto">
<meta property="og:url" content="https://tangcuxiaojikuai.xyz/post/6f77578c.html">
<meta property="og:site_name" content="ç³–é†‹å°é¸¡å—çš„blog">
<meta property="og:description" content="èµ›é¢˜è®°å½•">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/6f77578c/image-20231107181701914.png">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/6f77578c/image-20231107183752038.png">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/6f77578c/image-20231107184055983.png">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/6f77578c/image-20231107184230427.png">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/6f77578c/image-20231107184344112.png">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/6f77578c/image-20231107184441636.png">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/6f77578c/image-20231107191309019.png">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/6f77578c/image-20231107194348306.png">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/6f77578c/image-20231107195806843.png">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/6f77578c/image-20231113142925845.png">
<meta property="article:published_time" content="2023-11-28T10:13:46.000Z">
<meta property="article:modified_time" content="2023-11-28T11:58:08.000Z">
<meta property="article:author" content="ç³–é†‹å°é¸¡å—">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tangcuxiaojikuai.xyz/post/6f77578c/image-20231107181701914.png">

<link rel="canonical" href="https://tangcuxiaojikuai.xyz/post/6f77578c.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>2023-æå®¢å¤§æŒ‘æˆ˜-wp-crypto | ç³–é†‹å°é¸¡å—çš„blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ç³–é†‹å°é¸¡å—çš„blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
        <li class="menu-item menu-item-å‹é“¾">

    <a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>å‹é“¾</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tangcuxiaojikuai.xyz/post/6f77578c.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/image.png">
      <meta itemprop="name" content="ç³–é†‹å°é¸¡å—">
      <meta itemprop="description" content=""è¿½é£èµ¶æœˆè«åœç•™ï¼Œå¹³èŠœå°½å¤„æ˜¯æ˜¥å±±"">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ç³–é†‹å°é¸¡å—çš„blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2023-æå®¢å¤§æŒ‘æˆ˜-wp-crypto
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2023-11-28 18:13:46 / ä¿®æ”¹æ—¶é—´ï¼š19:58:08" itemprop="dateCreated datePublished" datetime="2023-11-28T18:13:46+08:00">2023-11-28</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/wp-crypto/" itemprop="url" rel="index"><span itemprop="name">wp-crypto</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valineï¼š</span>
    
    <a title="valine" href="/post/6f77578c.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/post/6f77578c.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>èµ›é¢˜è®°å½•</p>
<span id="more"></span>
<h2 id="Week-1"><a href="#Week-1" class="headerlink" title="Week 1"></a>Week 1</h2><h3 id="SignIn"><a href="#SignIn" class="headerlink" title="SignIn"></a>SignIn</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Bibo...Hello! ä½ å¥½! ã“ã‚“ã«ã¡ã¯! ĞŸÑ€Ğ¸Ğ²ĞµÑ‚!</span><br><span class="line">5359437b48656c6c6f5f576f726c645f43727970746f5f6269626f6269626f7dâ€¦  Hmm... Something goes wrong with my grettings bot.</span><br></pre></td></tr></table></figure>
<p>åå…­è¿›åˆ¶è§£ç å³å¯ã€‚</p>
<p><img src="/post/6f77578c/image-20231107181701914.png" alt="image-20231107181701914"></p>
<p><br></p>
<p><br></p>
<h3 id="proof-of-work"><a href="#proof-of-work" class="headerlink" title="proof_of_work"></a>proof_of_work</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc 59.110.20.54:5526 Build your own function to solve proof_of_work!</span><br></pre></td></tr></table></figure>
<p>ç¡®å®æ˜¯è¿‡ä¸ªproofå°±é€ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode,b64encode</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>():</span><br><span class="line">	table = string.digits + string.ascii_letters</span><br><span class="line">	temp = r.recvuntil(<span class="string">b&quot;sha256(XXXX+&quot;</span>)</span><br><span class="line">	temp = r.recvline()</span><br><span class="line">	suffix = temp[:<span class="number">16</span>].decode()</span><br><span class="line">	hex1 = temp[<span class="number">20</span>:].strip().decode()</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> tqdm(table):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> table:</span><br><span class="line">			<span class="keyword">for</span> k <span class="keyword">in</span> table:</span><br><span class="line">				<span class="keyword">for</span> m <span class="keyword">in</span> table:</span><br><span class="line">					temp1 = i+j+k+m</span><br><span class="line">					<span class="keyword">if</span>(sha256((temp1+suffix).encode()).hexdigest() == hex1):</span><br><span class="line">						r.sendline(temp1.encode())</span><br><span class="line">						<span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;59.110.20.54&quot;</span>, <span class="number">5526</span>)</span><br><span class="line">proof_of_work()</span><br><span class="line">r.recvline()</span><br><span class="line"><span class="built_in">print</span>(r.recvline())</span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;st3p_1nt0_1nter4ctive_Crypt0graphy&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="SimpleRSA"><a href="#SimpleRSA" class="headerlink" title="SimpleRSA"></a>SimpleRSA</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">So simple RSA! Wait... Are you kidding me? https://en.wikipedia.org/wiki/RSA_(cryptosystem) </span><br><span class="line">hint: flag&lt;p</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line">flag = <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">35</span></span><br><span class="line">p,q = [getPrime(<span class="number">2048</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;__&quot;</span>] </span><br><span class="line">n = p*q </span><br><span class="line">e = <span class="number">65537</span> </span><br><span class="line">c = gmpy2.powmod(bytes_to_long(flag),e,n) </span><br><span class="line"><span class="built_in">print</span>(p) </span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment">#24724324630507415330944861660078769085865178656494256140070836181271808964994457686409910764936630391300708451701526900994412268365698217113884698394658886249353179639767806926527103624836198494439742123128823109527320850165486500517304731554371680236789357527395416607541627295126502440202040826686102479225702795427693781581584928770373613126894936500089282093366117940069743670997994742595407158340397268147325612840109162997306902492023078425623839297511182053658542877738887677835528624045235391227122453939459585542485427063193993069301141720316104612551340923656979591045138487394366671477460626997125944456537</span></span><br><span class="line"><span class="comment">#510345661718450375632304764819724223824018609359964259503762283253350010161515190912152623604019093266967095847334388281390406831587663253164256543905694021952211220652820225527413861208452760215767828927039893435528572148282529198773772864255061213208279999011194952146362748485103032149806538140693537361755210176698895104708379400806511907719904867068865970241208806615061055047254026118016836750283966478103987375361826198930529462261013324904522014804502582865716441828895047550041401172127129749969507853355531197814919603963664646220505672302543085959372679395717892060245461464861507164276442140407308832537707450729432224150754603518526288767105682399190438680085925078051459448618725871249563011864525585870188123725554411655044152994826056900502298772802133526591794328224932405680583757307064395792317383571866619582974377344736930271554160701478385763426091091686496788999588340419226785217028504684542197970387916262126278955278523452903043316452825738030645100271595942652498852506660789605846309602343932245435421425673058238785509280366229754404949219663043627431437755087855502139890639468481922788973821783957766433857773771229298328019250652625289700950165414584983487319078090573179470893450632419467111117341472</span></span><br></pre></td></tr></table></figure>
<p>ç”¨pè§£å¯†å°±å¥½ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"></span><br><span class="line">p = <span class="number">24724324630507415330944861660078769085865178656494256140070836181271808964994457686409910764936630391300708451701526900994412268365698217113884698394658886249353179639767806926527103624836198494439742123128823109527320850165486500517304731554371680236789357527395416607541627295126502440202040826686102479225702795427693781581584928770373613126894936500089282093366117940069743670997994742595407158340397268147325612840109162997306902492023078425623839297511182053658542877738887677835528624045235391227122453939459585542485427063193993069301141720316104612551340923656979591045138487394366671477460626997125944456537</span></span><br><span class="line">c = <span class="number">510345661718450375632304764819724223824018609359964259503762283253350010161515190912152623604019093266967095847334388281390406831587663253164256543905694021952211220652820225527413861208452760215767828927039893435528572148282529198773772864255061213208279999011194952146362748485103032149806538140693537361755210176698895104708379400806511907719904867068865970241208806615061055047254026118016836750283966478103987375361826198930529462261013324904522014804502582865716441828895047550041401172127129749969507853355531197814919603963664646220505672302543085959372679395717892060245461464861507164276442140407308832537707450729432224150754603518526288767105682399190438680085925078051459448618725871249563011864525585870188123725554411655044152994826056900502298772802133526591794328224932405680583757307064395792317383571866619582974377344736930271554160701478385763426091091686496788999588340419226785217028504684542197970387916262126278955278523452903043316452825738030645100271595942652498852506660789605846309602343932245435421425673058238785509280366229754404949219663043627431437755087855502139890639468481922788973821783957766433857773771229298328019250652625289700950165414584983487319078090573179470893450632419467111117341472</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = inverse(e,p-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,p)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;Just_a_s1mple_modular_equation&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="OTPTwice"><a href="#OTPTwice" class="headerlink" title="OTPTwice"></a>OTPTwice</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">I invented a new symmetric cryptosystem, and I believe you will never break it!</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor </span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom </span><br><span class="line">flag = <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># step0: key generation &amp; distribution</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s0</span>(<span class="params">msg</span>): </span><br><span class="line">    k1,k2 = [urandom(<span class="built_in">len</span>(msg)) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;__&quot;</span>] </span><br><span class="line">    <span class="keyword">return</span> k1,k2 </span><br><span class="line"></span><br><span class="line"><span class="comment">#  </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># step1: Alice encrypt M, and send it to Bob</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s1</span>(<span class="params">msg,k1</span>):</span><br><span class="line">    c1 = xor(msg,k1)</span><br><span class="line">    <span class="keyword">return</span> c1 </span><br><span class="line"></span><br><span class="line"><span class="comment"># step2: Bob encrypt c1, and send it to Alice </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s2</span>(<span class="params">msg,k2</span>):</span><br><span class="line">    c2 = xor(msg,k2) </span><br><span class="line">    <span class="keyword">return</span> c2 </span><br><span class="line"></span><br><span class="line"><span class="comment"># step3: Alice decrypt c2, and send it to Bob.</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s3</span>(<span class="params">msg,k1</span>):</span><br><span class="line">    c3 = xor(msg,k1)</span><br><span class="line">    <span class="keyword">return</span> c3 </span><br><span class="line"></span><br><span class="line"><span class="comment"># step4: Bob decrypt c3, get M.</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s4</span>(<span class="params">msg,k2</span>):</span><br><span class="line">    m_ = xor(msg,k2) </span><br><span class="line">    <span class="keyword">return</span> m_ </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">msg,k1,k2</span>): </span><br><span class="line">    c1 = s1(msg,k1) </span><br><span class="line">    c2 = s2(c1,k2) </span><br><span class="line">    c3 = s3(c2,k1)</span><br><span class="line">    m_ = s4(c3,k2) </span><br><span class="line">    <span class="keyword">assert</span> msg == m_</span><br><span class="line"></span><br><span class="line"><span class="comment"># Here&#x27;s what hacker Eve got:</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_</span>(<span class="params">msg,k1,k2</span>):</span><br><span class="line">    c1 = s1(msg,k1) </span><br><span class="line">    c2 = s2(c1,k2) </span><br><span class="line">    c3 = s3(c2,k1)</span><br><span class="line">    m_ = s4(c3,k2) </span><br><span class="line">    <span class="keyword">if</span> HACK == <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(c1) </span><br><span class="line">        <span class="built_in">print</span>(c2) </span><br><span class="line">        <span class="built_in">print</span>(c3) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">k1,k2 = s0(flag) </span><br><span class="line">encrypt_(flag,k1,k2) </span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">b&#x27;\xdbi\xab\x8d\xfb0\xd3\xfe!\xf8Xpy\x80w\x8c\x87\xb9&#x27;</span></span><br><span class="line"><span class="string">b&#x27;o\xb0%\xfb\xdb\x0e\r\x04\xde\xd1\x9a\x08w\xda4\x0f\x0cR&#x27;</span></span><br><span class="line"><span class="string">b&#x27;\xe7\x80\xcd\ria\xb2\xca\x89\x1a\x9d;|#3\xf7\xbb\x96&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®çœ‹ç€æ¯”è¾ƒé•¿ï¼Œä½†æ˜¯å…¶å®å‡ ä¸ªå‡½æ•°åŠŸèƒ½éƒ½æ˜¯é‡å¤çš„ï¼Œå‡ä¸ºå¼‚æˆ–æ“ä½œã€‚æå–ä¸€ä¸‹å…¶å®ä¹Ÿå°±æœ‰ï¼š</p>
<script type="math/tex; mode=display">
c_1 = flag \oplus k_1</script><script type="math/tex; mode=display">
c_2 = c_1 \oplus k_2 =flag \oplus k_1 \oplus k_2</script><script type="math/tex; mode=display">
c_3 = c_2 \oplus k_1 = flag \oplus k_1 \oplus k_2 \oplus k_1 = flag \oplus k_2</script><p>é‚£ä¹ˆå°±æœ‰ï¼š</p>
<script type="math/tex; mode=display">
c_2 \oplus c_1 = k_2</script><script type="math/tex; mode=display">
c_2 \oplus c_3 = k_1</script><script type="math/tex; mode=display">
flag = c_1 \oplus c_2 \oplus c_3</script><p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor </span><br><span class="line"></span><br><span class="line">c1 = <span class="string">b&#x27;\xdbi\xab\x8d\xfb0\xd3\xfe!\xf8Xpy\x80w\x8c\x87\xb9&#x27;</span></span><br><span class="line">c2 = <span class="string">b&#x27;o\xb0%\xfb\xdb\x0e\r\x04\xde\xd1\x9a\x08w\xda4\x0f\x0cR&#x27;</span></span><br><span class="line">c3 = <span class="string">b&#x27;\xe7\x80\xcd\ria\xb2\xca\x89\x1a\x9d;|#3\xf7\xbb\x96&#x27;</span></span><br><span class="line"></span><br><span class="line">flag = xor(c1,xor(c2,c3))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;I_l0v3_Crypt0&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="OldAlgorithm"><a href="#OldAlgorithm" class="headerlink" title="OldAlgorithm"></a>OldAlgorithm</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">An old algorithm but widely used nowadays.</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line">flag = <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">pad = <span class="keyword">lambda</span> msg,padlen: msg+os.urandom(padlen-<span class="built_in">len</span>(msg))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = pad(flag,<span class="number">32</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(flag))</span><br><span class="line">p = [getPrime(<span class="number">16</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)] </span><br><span class="line">c = [bytes_to_long(flag)%i <span class="keyword">for</span> i <span class="keyword">in</span> p] </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p=&#x27;</span>,p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c=&#x27;</span>,c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p= [58657, 47093, 47963, 41213, 57653, 56923, 41809, 49639, 44417, 38639, 39857, 53609, 55621, 41729, 60497, 44647, 39703, 55117, 44111, 57131, 37747, 63419, 63703, 64007, 46349, 39241, 39313, 44909, 40763, 46727, 34057, 56333]</span></span><br><span class="line"><span class="string">c= [36086, 4005, 3350, 23179, 34246, 5145, 32490, 16348, 13001, 13628, 7742, 46317, 50824, 23718, 32995, 7640, 10590, 46897, 39245, 16633, 31488, 36547, 42136, 52782, 31929, 34747, 29026, 18748, 6634, 9700, 8126, 5197]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>æ ‡é¢˜æŒ‡çš„å°±æ˜¯CRTã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"></span><br><span class="line">p= [<span class="number">58657</span>, <span class="number">47093</span>, <span class="number">47963</span>, <span class="number">41213</span>, <span class="number">57653</span>, <span class="number">56923</span>, <span class="number">41809</span>, <span class="number">49639</span>, <span class="number">44417</span>, <span class="number">38639</span>, <span class="number">39857</span>, <span class="number">53609</span>, <span class="number">55621</span>, <span class="number">41729</span>, <span class="number">60497</span>, <span class="number">44647</span>, <span class="number">39703</span>, <span class="number">55117</span>, <span class="number">44111</span>, <span class="number">57131</span>, <span class="number">37747</span>, <span class="number">63419</span>, <span class="number">63703</span>, <span class="number">64007</span>, <span class="number">46349</span>, <span class="number">39241</span>, <span class="number">39313</span>, <span class="number">44909</span>, <span class="number">40763</span>, <span class="number">46727</span>, <span class="number">34057</span>, <span class="number">56333</span>]</span><br><span class="line">c= [<span class="number">36086</span>, <span class="number">4005</span>, <span class="number">3350</span>, <span class="number">23179</span>, <span class="number">34246</span>, <span class="number">5145</span>, <span class="number">32490</span>, <span class="number">16348</span>, <span class="number">13001</span>, <span class="number">13628</span>, <span class="number">7742</span>, <span class="number">46317</span>, <span class="number">50824</span>, <span class="number">23718</span>, <span class="number">32995</span>, <span class="number">7640</span>, <span class="number">10590</span>, <span class="number">46897</span>, <span class="number">39245</span>, <span class="number">16633</span>, <span class="number">31488</span>, <span class="number">36547</span>, <span class="number">42136</span>, <span class="number">52782</span>, <span class="number">31929</span>, <span class="number">34747</span>, <span class="number">29026</span>, <span class="number">18748</span>, <span class="number">6634</span>, <span class="number">9700</span>, <span class="number">8126</span>, <span class="number">5197</span>]</span><br><span class="line"></span><br><span class="line">m = crt(p,c)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;CRT_1s_s0_ju1cy!&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="easy-classic"><a href="#easy-classic" class="headerlink" title="easy_classic"></a>easy_classic</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">éå¸¸å¥½å¥—å¨ƒï¼Œä½¿æˆ‘çš„å¤å…¸æ—‹è½¬</span><br></pre></td></tr></table></figure>
<p>å‡ å±‚å¯†ç åŠå¯¹åº”è§£å¯†åˆ†åˆ«å¦‚ä¸‹</p>
<h4 id="1"><a href="#1" class="headerlink" title="1"></a>1</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">udzeojxuwqcu</span><br></pre></td></tr></table></figure>
<p><img src="/post/6f77578c/image-20231107183752038.png" alt="image-20231107183752038"></p>
<h4 id="2"><a href="#2" class="headerlink" title="2"></a>2</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ialhhooavtepcyr</span><br></pre></td></tr></table></figure>
<p>ä¸€çœ¼å°±çœ‹å‡ºæ¥æ˜¯ilovecryptohahaï¼Œä¼°è®¡æ˜¯ä¸ªWå‹æ …æ ä¹‹ç±»ï¼Œåæ­£æ˜¯ä¸ªç½®æ¢å¯†ç ã€‚</p>
<h4 id="3"><a href="#3" class="headerlink" title="3"></a>3</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">5a6H5a6Z5LiH5rOV55qE6YKj5Liq5rqQ5aS0</span><br></pre></td></tr></table></figure>
<p>base64</p>
<p><img src="/post/6f77578c/image-20231107184055983.png" alt="image-20231107184055983"></p>
<h4 id="4"><a href="#4" class="headerlink" title="4"></a>4</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç†Šæ›°ï¼šå‘‹é£Ÿé£Ÿé£Ÿå–å™—å±±ç¬¨ç¬¨ç ´å—„å’¯å“ˆå‹•å—¡é›œé¡å—’å˜¿å•½æ²’æ­¡ç ´å–å’¬æˆ‘å•½å¯¶ç›œå™”å’¯æ²’</span><br></pre></td></tr></table></figure>
<p>å¼€å§‹ä»¥ä¸ºæ˜¯å…½éŸ³ï¼Œæœäº†æ‰çŸ¥é“å±…ç„¶è¿˜æœ‰ä¸ç†Šè®ºé“åŠ å¯†ï¼Œåœ¨çº¿è§£å¯†ç½‘å€å¦‚ä¸‹ï¼š</p>
<p><a target="_blank" rel="noopener" href="http://hi.pcmoe.net/">ä¸ç†Šè®ºé“/ç†Šæ›°åŠ å¯† - PcMoe!</a></p>
<p><img src="/post/6f77578c/image-20231107184230427.png" alt="image-20231107184230427"></p>
<h4 id="5"><a href="#5" class="headerlink" title="5"></a>5</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">password: adltlfltqrcy</span><br><span class="line">key: ğŸ‘ğŸ‘˜ğŸ‘ ğŸ‘©ğŸ‘ğŸ‘˜ğŸ‘¤ğŸ‘œ</span><br></pre></td></tr></table></figure>
<p>keyç”¨emojiè§£å¯†å¾—åˆ°ï¼šfairgame</p>
<p><img src="/post/6f77578c/image-20231107184344112.png" alt="image-20231107184344112"></p>
<p>æ˜¾ç„¶æ˜¯ä¸ªæç¤ºï¼Œç”¨playfairå¯†ç è§£ã€‚</p>
<p><img src="/post/6f77578c/image-20231107184441636.png" alt="image-20231107184441636"></p>
<p>æœ€ç»ˆå¾—åˆ°flagï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SYC&#123;classical_1s_fun&#125;</span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="Week-2"><a href="#Week-2" class="headerlink" title="Week 2"></a>Week 2</h2><h3 id="PolyRSA"><a href="#PolyRSA" class="headerlink" title="PolyRSA"></a>PolyRSA</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Harder RSA. Check it out!</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *  </span><br><span class="line">flag = <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span></span><br><span class="line">p,q = [getPrime(<span class="number">2048</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;__&quot;</span>] </span><br><span class="line">e1,e2 = [getPrime(<span class="number">17</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;__&quot;</span>] </span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = p*q </span><br><span class="line">c1 = gmpy2.powmod(<span class="number">2</span>*p + <span class="number">3</span>*q,e1,n)</span><br><span class="line">c2 = gmpy2.powmod(<span class="number">5</span>*p + <span class="number">7</span>*q,e2,n) </span><br><span class="line">c = gmpy2.powmod(bytes_to_long(flag),e,n) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e1=&quot;</span>,e1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e2=&quot;</span>,e2) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c1=&quot;</span>,c1) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c2=&quot;</span>,c2) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"></span><br><span class="line"><span class="comment">#e1= 113717</span></span><br><span class="line"><span class="comment">#e2= 80737</span></span><br><span class="line"><span class="comment">#c1= 97528398828294138945371018405777243725957112272614466238005409057342884425132214761228537249844134865481148636534134025535106624840957740753950100180978607132333109806554009969378392835952544552269685553539656827070349532458156758965322477969141073720173165958341043159560928836304172136610929023123638981560836183245954461041167802574206323129671965436040047358250847178930436773249800969192016749684095882580749559014647942135761757750292281205876241566597813517452803933496218995755905344070203047797893640399372627351254542342772576533524820435965479881620338366838326652599102311019884528903481310690767832417584600334987458835108576322111553947045733143836419313427495888019352323209000292825566986863770366023326755116931788018138432898323148059980463407567431417724940484236335082696026821105627826117901730695680967455710434307270501190258033004471156993017301443803372029004817834317756597444195146024630164820841200575179112295902020141040090350486764038633257871003899386340004440642516190842086462237559715130631205046041819931656962904630367121414263911179041905140516402771368603623318492074423223885367923228718341206283572152570049573607906130786276734660847733952210105659707746969830132429975090175091281363770357</span></span><br><span class="line"><span class="comment">#c2= 353128571201645377052005694809874806643786163076931670184196149901625274899734977100920488129375537186771931435883114557320913415191396857882995726660784707377672210953334914418470453787964899846194872721616628198368241044602144880543115393715025896206210152190007408112767478800650578941849344868081146624444817544806046188600685873402369145450593575618922226415069043442295774369567389939040265656574664538667552522329712111984168798829635080641332045614585247317991581514218486004191829362787750803153463482021229058714990823658655863245025037102127138472397462755776598314247771125981017814912049441827643898478473451005083533693951329544115861795587564408860828213753948427321483082041546722974666875065831843384005041800692983406353922680299538080900818930589336142421748023025830846906503542594380663429947801329079870530727382679634952272644949425079242992486832995962516376820051495641486546631849426876810933393153871774796182078367277299340503872124124714036499367887886486264658590613431293656417255355575602576047502506125375605713228912611320198066713358654181533335650785578352716562937038768171269136647529849805172492594142026261051266577821582011917001752590659862613307646536049830151262848916867223615064832279222</span></span><br><span class="line"><span class="comment">#c= 375617816311787295279632219241669262704366237192565344884527300748210925539528834207344757670998995567820735715933908541800125317082581328287816628816752542104514363629022246620070560324071543077301256917337165566677142545053272381990573611757629429857842709092285442319141751484248315990593292618113678910350875156232952525787082482638460259354559904243062546518553607882194808191571131590524874275187750985821420412987586148770397073003186510357920710387377990379862185266175190503647626248057084923516190642292152259727446111686043531725993433395002330208067534104745851308178560234372373476331387737629284961288204368572750848248186692623500372605736825205759172773503283282321274793846281079650686871355211691681512637459986684769598186821524093789286661348936784712071312135814683041839882338235290487868969391040389837253093468883093296547473466050960563347060307256735803099039921213839491129726807647623542881247210251994139130146519265086673883077644185971830004165931626986486648581644383717994174627681147696341976767364316172091139507445131410662391699728189797082878876950386933926807186382619331901457205957462337191923354433435013338037399565519987793880572723211669459895193009710035003369626116024630678400746946356</span></span><br><span class="line"><span class="comment">#n= 728002565949733279371529990942440022467681592757835980552797682116929657292509059813629423038094227544032071413317330087468458736175902373398210691802243764786251764982802000867437756347830992118278032311046807282193498960587170291978547754942295932606784354258945168927044376692224049202979158068158842475322825884209352566494900083765571037783472505580851500043517614314755340168507097558967372661966013776090657685241689631615245294004694287660685274079979318342939473469143729494106686592347327776078649315612768988028622890242005700892937828732613800620455225438339852445425046832904615827786856105112781009995862999853122308496903885748394541643702103368974605177097553007573113536089894913967154637055293769061726082740854619536748297829779639633209710676774371525146758917646731487495135734759201537358734170552231657257498090553682791418003138924472103077035355223367678622115314235119493397080290540006942708439607767313672671274857069053688258983103863067394473084183472609906612056828326916114024662795812611685559034285371151973580240723680736227737324052391721149957542711415812665358477474058103338801398214688403784213100455466705770532894531602252798634923125974783427678469124261634518543957766622712661056594132089</span></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ç»™äº†å¯†æ–‡ä»¥åŠå¦‚ä¸‹ä¸¤ä¸ªä¿¡æ¯ã€‚è¦æ±‚åˆ†è§£nè¿˜åŸæ˜æ–‡ï¼š</p>
<script type="math/tex; mode=display">
c_1 = (2p+3q)^{e_1} \quad(mod\;n)</script><script type="math/tex; mode=display">
c_2 = (5p+7q)^{e_2} \quad(mod\;n)</script><p>æ€è·¯è‚¯å®šæ˜¯æ¶ˆpã€qå…¶ä¸­ä¸€ä¸ªå…ƒï¼Œç„¶åä¸næ±‚gcdå¾—åˆ°åˆ†è§£ã€‚</p>
<p>å…ˆç»Ÿä¸€æŒ‡æ•°ï¼š</p>
<script type="math/tex; mode=display">
c_1^{e_2} = (2p+3q)^{e_1e_2} \quad(mod\;n)</script><script type="math/tex; mode=display">
c_2^{e_1} = (5p+7q)^{e_1e_2} \quad(mod\;n)</script><p>ç”±äºŒé¡¹å¼å®šç†å±•å¼€å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
c_1^{e_2} = (2p)^{e_1e_2}+(3q)^{e_1e_2} \quad(mod\;n)</script><script type="math/tex; mode=display">
c_2^{e_1} = (5p)^{e_1e_2}+(7q)^{e_1e_2} \quad(mod\;n)</script><p>ç„¶åé…ç³»æ•°ä½œå·®å°±èƒ½æ¶ˆæ‰å…¶ä¸­ä¸€ä¸ªï¼Œæ¯”å¦‚è¿™é‡Œæˆ‘ä»¬æ¶ˆå»pï¼š</p>
<script type="math/tex; mode=display">
5^{e_1e_2}c_1^{e_2} = 5^{e_1e_2}(2p)^{e_1e_2}+5^{e_1e_2}(3q)^{e_1e_2} \quad(mod\;n)</script><script type="math/tex; mode=display">
2^{e_1e_2}c_2^{e_1} = 2^{e_1e_2}(5p)^{e_1e_2}+2^{e_1e_2}(7q)^{e_1e_2} \quad(mod\;n)</script><p>ä½œå·®å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
5^{e_1e_2}c_1^{e_2}- 2^{e_1e_2}c_2^{e_1} = 5^{e_1e_2}(3q)^{e_1e_2} - 2^{e_1e_2}(7q)^{e_1e_2} \quad(mod\;n)</script><p>æ±‚è§£ä¸nçš„gcdå³å¯å¾—åˆ°qï¼Œä»è€Œåˆ†è§£nè¿˜åŸæ˜æ–‡ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *  </span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">e1= <span class="number">113717</span></span><br><span class="line">e2= <span class="number">80737</span></span><br><span class="line">c1= <span class="number">97528398828294138945371018405777243725957112272614466238005409057342884425132214761228537249844134865481148636534134025535106624840957740753950100180978607132333109806554009969378392835952544552269685553539656827070349532458156758965322477969141073720173165958341043159560928836304172136610929023123638981560836183245954461041167802574206323129671965436040047358250847178930436773249800969192016749684095882580749559014647942135761757750292281205876241566597813517452803933496218995755905344070203047797893640399372627351254542342772576533524820435965479881620338366838326652599102311019884528903481310690767832417584600334987458835108576322111553947045733143836419313427495888019352323209000292825566986863770366023326755116931788018138432898323148059980463407567431417724940484236335082696026821105627826117901730695680967455710434307270501190258033004471156993017301443803372029004817834317756597444195146024630164820841200575179112295902020141040090350486764038633257871003899386340004440642516190842086462237559715130631205046041819931656962904630367121414263911179041905140516402771368603623318492074423223885367923228718341206283572152570049573607906130786276734660847733952210105659707746969830132429975090175091281363770357</span></span><br><span class="line">c2= <span class="number">353128571201645377052005694809874806643786163076931670184196149901625274899734977100920488129375537186771931435883114557320913415191396857882995726660784707377672210953334914418470453787964899846194872721616628198368241044602144880543115393715025896206210152190007408112767478800650578941849344868081146624444817544806046188600685873402369145450593575618922226415069043442295774369567389939040265656574664538667552522329712111984168798829635080641332045614585247317991581514218486004191829362787750803153463482021229058714990823658655863245025037102127138472397462755776598314247771125981017814912049441827643898478473451005083533693951329544115861795587564408860828213753948427321483082041546722974666875065831843384005041800692983406353922680299538080900818930589336142421748023025830846906503542594380663429947801329079870530727382679634952272644949425079242992486832995962516376820051495641486546631849426876810933393153871774796182078367277299340503872124124714036499367887886486264658590613431293656417255355575602576047502506125375605713228912611320198066713358654181533335650785578352716562937038768171269136647529849805172492594142026261051266577821582011917001752590659862613307646536049830151262848916867223615064832279222</span></span><br><span class="line">c= <span class="number">375617816311787295279632219241669262704366237192565344884527300748210925539528834207344757670998995567820735715933908541800125317082581328287816628816752542104514363629022246620070560324071543077301256917337165566677142545053272381990573611757629429857842709092285442319141751484248315990593292618113678910350875156232952525787082482638460259354559904243062546518553607882194808191571131590524874275187750985821420412987586148770397073003186510357920710387377990379862185266175190503647626248057084923516190642292152259727446111686043531725993433395002330208067534104745851308178560234372373476331387737629284961288204368572750848248186692623500372605736825205759172773503283282321274793846281079650686871355211691681512637459986684769598186821524093789286661348936784712071312135814683041839882338235290487868969391040389837253093468883093296547473466050960563347060307256735803099039921213839491129726807647623542881247210251994139130146519265086673883077644185971830004165931626986486648581644383717994174627681147696341976767364316172091139507445131410662391699728189797082878876950386933926807186382619331901457205957462337191923354433435013338037399565519987793880572723211669459895193009710035003369626116024630678400746946356</span></span><br><span class="line">n= <span class="number">728002565949733279371529990942440022467681592757835980552797682116929657292509059813629423038094227544032071413317330087468458736175902373398210691802243764786251764982802000867437756347830992118278032311046807282193498960587170291978547754942295932606784354258945168927044376692224049202979158068158842475322825884209352566494900083765571037783472505580851500043517614314755340168507097558967372661966013776090657685241689631615245294004694287660685274079979318342939473469143729494106686592347327776078649315612768988028622890242005700892937828732613800620455225438339852445425046832904615827786856105112781009995862999853122308496903885748394541643702103368974605177097553007573113536089894913967154637055293769061726082740854619536748297829779639633209710676774371525146758917646731487495135734759201537358734170552231657257498090553682791418003138924472103077035355223367678622115314235119493397080290540006942708439607767313672671274857069053688258983103863067394473084183472609906612056828326916114024662795812611685559034285371151973580240723680736227737324052391721149957542711415812665358477474058103338801398214688403784213100455466705770532894531602252798634923125974783427678469124261634518543957766622712661056594132089</span></span><br><span class="line"></span><br><span class="line">t1 = <span class="built_in">pow</span>(<span class="number">3</span>,(e1*e2),n)</span><br><span class="line">t2 = <span class="built_in">pow</span>(<span class="number">7</span>,(e1*e2),n)</span><br><span class="line">temp1 = t2*<span class="built_in">pow</span>(c1,e2,n)</span><br><span class="line">temp2 = t1*<span class="built_in">pow</span>(c2,e1,n)</span><br><span class="line"></span><br><span class="line">p = GCD(temp1-temp2,n)</span><br><span class="line">q = n // p</span><br><span class="line">d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;poly_rsa_Just_need5_s1mple_gcd&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="Simple3DES"><a href="#Simple3DES" class="headerlink" title="Simple3DES"></a>Simple3DES</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é¢˜ç›®é“¾æ¥ï¼šnc 59.110.20.54:23333 https://blog.csdn.net/Mr_wzc/article/details/121713518</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">xor = <span class="keyword">lambda</span> a,b: <span class="built_in">bytes</span>([a[i % <span class="built_in">len</span>(a)] ^ b[i % <span class="built_in">len</span>(b)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">max</span>(<span class="built_in">len</span>(a), <span class="built_in">len</span>(b)))])</span><br><span class="line">pad = <span class="keyword">lambda</span> msg,padlen: msg+<span class="built_in">chr</span>((padlen-(<span class="built_in">len</span>(msg)%padlen))).encode()*(padlen-(<span class="built_in">len</span>(msg)%padlen))</span><br><span class="line"></span><br><span class="line">flag = os.environ.get(<span class="string">&quot;FLAG&quot;</span>, <span class="string">&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span>).encode()</span><br><span class="line">sec = os.urandom(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">banner = <span class="string">&#x27;|&#x27;</span>*<span class="number">70</span></span><br><span class="line"></span><br><span class="line">DEBUG = <span class="literal">False</span> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>():</span><br><span class="line">    <span class="keyword">if</span> DEBUG:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    proof = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters+string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">    digest = hashlib.sha256(proof.encode()).hexdigest()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;sha256(XXXX+%s) == %s&quot;</span> % (proof[<span class="number">4</span>:], digest))</span><br><span class="line">    x = <span class="built_in">input</span>(<span class="string">&quot;Give me XXXX: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(x)!=<span class="number">4</span> <span class="keyword">or</span> hashlib.sha256((x+proof[<span class="number">4</span>:]).encode()).hexdigest() != digest:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Right!&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">msg,key</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        key = long_to_bytes(key)</span><br><span class="line">        msg = xor(long_to_bytes(msg),sec)</span><br><span class="line">        des = DES3.new(key,DES3.MODE_ECB)</span><br><span class="line">        ct = xor(des.encrypt(pad(msg,<span class="number">8</span>)),sec)</span><br><span class="line">        <span class="keyword">return</span> bytes_to_long(ct)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">        <span class="keyword">return</span> Exception</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">service</span>():</span><br><span class="line">    cnt = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> proof_of_work():</span><br><span class="line">        exit()</span><br><span class="line">    <span class="built_in">print</span>(banner)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Simple DES Encryption Service&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(banner)</span><br><span class="line">    <span class="keyword">while</span> cnt&lt;<span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;1. Encrypt\n2. Get encrypted flag.&#x27;</span>)</span><br><span class="line">        choice = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>))</span><br><span class="line">        <span class="keyword">if</span> choice == <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Input msg:&#x27;</span>)</span><br><span class="line">            msg = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>).strip())</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Input key:&#x27;</span>)</span><br><span class="line">            key = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>).strip())</span><br><span class="line">            <span class="built_in">print</span>(enc(msg,key))</span><br><span class="line">        <span class="keyword">elif</span> choice == <span class="number">2</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Input key:&#x27;</span>)</span><br><span class="line">            key = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>).strip())</span><br><span class="line">            <span class="built_in">print</span>(enc(bytes_to_long(flag),key))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            exit()</span><br><span class="line">        cnt+=<span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(banner)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Bye!&#x27;</span>)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    service()</span><br><span class="line"><span class="keyword">except</span> Exception:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Something goes wrong...\n&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    exit()</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®åŸºäº3DESï¼Œå…¶åŠ å¯†æµç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="/post/6f77578c/image-20231107191309019.png" alt="image-20231107191309019"></p>
<p>æˆ‘ä»¬å¯ä»¥åšçš„æ˜¯ï¼š</p>
<ul>
<li>è¾“å…¥1ï¼Œå¯ä»¥æŒ‡å®š3DESå¯†é’¥ä¸ä¸€æ®µæ˜æ–‡ï¼Œè·å¾—ä»–çš„åŠ å¯†ç»“æœ</li>
<li>è¾“å…¥2ï¼Œå¯ä»¥æŒ‡å®šå¯†é’¥ï¼Œè·å¾—flagçš„åŠ å¯†ç»“æœ</li>
</ul>
<p>å¹¶ä¸”ä¸€å…±åªæœ‰ä¸¤æ¬¡äº¤äº’æœºä¼šï¼Œæ‰€ä»¥å¯ä»¥çŸ¥é“é¢„æœŸåº”è¯¥æ˜¯æ¯ä¸ªé€‰é¡¹ç”¨ä¸€æ¬¡ã€‚</p>
<p>ç„¶åéœ€è¦æ³¨æ„ï¼Œè¿™é‡Œçš„encå‡½æ•°å¹¶ä¸æ˜¯ç®€å•çš„3DESåŠ å¯†ï¼Œè€Œæ˜¯æœ‰ä¸´æ—¶å¯†é’¥secçš„å‚ä¸ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">sec = os.urandom(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">msg,key</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        key = long_to_bytes(key)</span><br><span class="line">        msg = xor(long_to_bytes(msg),sec)</span><br><span class="line">        des = DES3.new(key,DES3.MODE_ECB)</span><br><span class="line">        ct = xor(des.encrypt(pad(msg,<span class="number">8</span>)),sec)</span><br><span class="line">        <span class="keyword">return</span> bytes_to_long(ct)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">        <span class="keyword">return</span> Exception</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œencçš„æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>å°†msgä¸secå¼‚æˆ–ï¼Œå¹¶è¿›è¡Œå¡«å……</li>
<li>è¿›è¡Œ3DESåŠ å¯†</li>
<li>å°†å¾—åˆ°çš„å¯†æ–‡å†ä¸secå¼‚æˆ–ï¼Œå¾—åˆ°æœ€ç»ˆå¯†æ–‡å€¼</li>
</ul>
<p>æ¥ä¸‹æ¥é˜è¿°ä¸¤ç§æ€è·¯ã€‚</p>
<h4 id="å¼±å¯†é’¥"><a href="#å¼±å¯†é’¥" class="headerlink" title="å¼±å¯†é’¥"></a>å¼±å¯†é’¥</h4><p>è¿™ä¸€éƒ¨åˆ†æˆ‘æ˜¯çœ‹2022å¹´çš„hackergameä¸­ï¼Œä¸å¯åŠ å¯†çš„å¼‚ä¸–ç•Œçš„wpäº†è§£åˆ°çš„ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://tl2cents.github.io/2022/11/01/Hacker-Game-2022-å‡ºé¢˜è®°/">HackerGame 2022 å‡ºé¢˜è®° | tl2cents blog</a></p>
<p>è¿˜æœ‰ä¸€äº›å‚è€ƒå¦‚ä¸‹ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://lightless.me/archives/DES-Weak-Keys.html">DES å¼±å¯†é’¥ - lightless blog</a></p>
<p>è¿™å°±æ˜¯è¯´ï¼ŒDESåŠ å¯†ä¸­ï¼Œå­˜åœ¨ä¸€äº›å¯†é’¥ä¸ºå¼±å¯†é’¥ï¼Œå¦‚æœä½¿ç”¨å¼±å¯†é’¥åŠ å¯†ï¼Œä¼šå¯¼è‡´ä¸€ä¸ªæƒ¨é‡ç»“æœï¼šè½®å¯†é’¥å…¨éƒ¨ç›¸åŒã€‚</p>
<p>è¿™ä¹Ÿå°±æ˜¯è¯´ï¼Œä½¿ç”¨å¼±å¯†é’¥çš„è¯ï¼š</p>
<ul>
<li>å¯¹æ˜æ–‡è¿ç»­åŠ å¯†ä¸¤æ¬¡ï¼Œä»ç„¶æ˜¯æ˜æ–‡</li>
<li>å¯¹å¯†æ–‡è¿ç»­è§£å¯†ä¸¤æ¬¡ï¼Œä»ç„¶æ˜¯å¯†æ–‡</li>
</ul>
<p>è€Œ3DESçš„å¯†é’¥åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†k1ï¼Œk2ï¼Œk3ï¼ŒåŠ å¯†æµç¨‹æ˜¯ï¼š</p>
<ul>
<li>ç”¨k1è¿›è¡ŒåŠ å¯†</li>
<li>ç”¨k2è¿›è¡Œè§£å¯†</li>
<li>ç”¨k3è¿›è¡ŒåŠ å¯†</li>
</ul>
<p>é‚£ä¹ˆå¯ä»¥å–å·§çš„ä¸€ä¸ªæ–¹å¼å°±æ˜¯ï¼Œæˆ‘ä»¬é€‰æ‹©ä¸¤ä¸ªå¼±å¯†é’¥ï¼ŒæŒ‰å¦‚ä¸‹æ–¹å¼æ‹¼èµ·æ¥å½“ä½œ3DESçš„å¯†é’¥ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="string">b&quot;\x01\x01\x01\x01\x01\x01\x01\x01&quot;</span>+<span class="string">b&quot;\xFE\xFE\xFE\xFE\xFE\xFE\xFE\xFE&quot;</span>+<span class="string">b&quot;\x01\x01\x01\x01\x01\x01\x01\x01&quot;</span></span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆæˆ‘ä»¬ç¬¬ä¸€æ¬¡è¾“å…¥2ï¼Œå¾—åˆ°flagçš„åŠ å¯†å€¼ã€‚ç¬¬äºŒæ¬¡å†æŠŠflagåŠ å¯†å€¼å‘é€å›å»è®©ä»–åŠ å¯†å³å¯ï¼Œè¿™æ ·æ­£å¥½è¿˜æŠµæ¶ˆäº†secçš„å½±å“(å¯ä»¥è‡ªå·±æ¨ä¸€ä¸‹)ï¼Œå› æ­¤å°±èƒ½å¾—åˆ°flagã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>():</span><br><span class="line">	table = string.digits + string.ascii_letters</span><br><span class="line">	temp = r.recvuntil(<span class="string">b&quot;sha256(XXXX+&quot;</span>)</span><br><span class="line">	temp = r.recvline()</span><br><span class="line">	suffix = temp[:<span class="number">16</span>].decode()</span><br><span class="line">	hex1 = temp[<span class="number">20</span>:].strip().decode()</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> tqdm(table):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> table:</span><br><span class="line">			<span class="keyword">for</span> k <span class="keyword">in</span> table:</span><br><span class="line">				<span class="keyword">for</span> m <span class="keyword">in</span> table:</span><br><span class="line">					temp1 = i+j+k+m</span><br><span class="line">					<span class="keyword">if</span>(sha256((temp1+suffix).encode()).hexdigest() == hex1):</span><br><span class="line">						r.sendline(temp1.encode())</span><br><span class="line">						<span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;59.110.20.54&quot;</span>, <span class="number">23333</span>)</span><br><span class="line">proof_of_work()</span><br><span class="line"></span><br><span class="line">xor = <span class="keyword">lambda</span> a,b: <span class="built_in">bytes</span>([a[i % <span class="built_in">len</span>(a)] ^ b[i % <span class="built_in">len</span>(b)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">max</span>(<span class="built_in">len</span>(a), <span class="built_in">len</span>(b)))])</span><br><span class="line"><span class="comment">#2</span></span><br><span class="line">r.recvuntil(<span class="string">b&quot;Get encrypted flag.&quot;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">r.sendline(<span class="string">b&quot;2&quot;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">key = <span class="string">b&quot;\x01\x01\x01\x01\x01\x01\x01\x01&quot;</span>+<span class="string">b&quot;\xFE\xFE\xFE\xFE\xFE\xFE\xFE\xFE&quot;</span>+<span class="string">b&quot;\x01\x01\x01\x01\x01\x01\x01\x01&quot;</span></span><br><span class="line">r.sendline(<span class="built_in">str</span>(bytes_to_long(key)).encode())</span><br><span class="line">enc = long_to_bytes(<span class="built_in">int</span>(r.recvline().strip().decode()))</span><br><span class="line"></span><br><span class="line"><span class="comment">#1</span></span><br><span class="line">r.recvuntil(<span class="string">b&quot;Get encrypted flag.&quot;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">r.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">r.sendline(<span class="built_in">str</span>(bytes_to_long(enc)).encode())</span><br><span class="line">r.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">r.sendline(<span class="built_in">str</span>(bytes_to_long(key)).encode())</span><br><span class="line">flag = long_to_bytes(<span class="built_in">int</span>(r.recvline().strip().decode()))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;DES_1s_0ut_0f_t1me&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="pad"><a href="#pad" class="headerlink" title="pad"></a>pad</h4><p>ä½†æ˜¯ç¬¬äºŒç§ä¼°è®¡æ‰æ˜¯é¢„æœŸè§£ï¼Œæ³¨æ„åˆ°encä¸­åŠ å¯†æµç¨‹ä¸­æœ‰ä¸ªæ¼æ´ï¼š</p>
<ul>
<li>å°†msgä¸secå¼‚æˆ–ï¼Œå¹¶è¿›è¡Œå¡«å……</li>
<li>è¿›è¡Œ3DESåŠ å¯†</li>
<li>å°†å¾—åˆ°çš„å¯†æ–‡å†ä¸secå¼‚æˆ–ï¼Œå¾—åˆ°æœ€ç»ˆå¯†æ–‡å€¼</li>
</ul>
<p>ä»–å°†msgä¸secå¼‚æˆ–åï¼Œå†è¿›è¡Œå¡«å……ã€‚è€Œå¡«å……çš„æ–¹å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pad = <span class="keyword">lambda</span> msg,padlen: msg+<span class="built_in">chr</span>((padlen-(<span class="built_in">len</span>(msg)%padlen))).encode()*(padlen-(<span class="built_in">len</span>(msg)%padlen))</span><br></pre></td></tr></table></figure>
<p>DESä»¥8å­—èŠ‚ä¸ºä¸€ç»„è¿›è¡Œåˆ†ç»„åŠ å¯†ã€‚è€Œè¿™ä¸ªpadæ˜¯åœ¨msgæ°å¥½ä¸º8å­—èŠ‚çš„æ•´æ•°å€æ—¶ï¼Œä»ç„¶ä¼šè¿›è¡Œ8å­—èŠ‚bâ€\x08â€çš„å¡«å……ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬å‘é€ä¸€ä¸ªç©ºçš„å­—èŠ‚ä¸²ï¼Œå¯¹åº”çš„æ•°å­—ä¹Ÿå°±æ˜¯0ï¼Œé‚£ä¹ˆé¶æœºç«¯åŠ å¯†çš„æµç¨‹åº”è¯¥æ˜¯ï¼š</p>
<ul>
<li>sec + bâ€\x08â€*8</li>
<li>è¿›è¡Œ3DESåŠ å¯†</li>
<li>å¾—åˆ°çš„å¯†æ–‡å†ä¸secå¼‚æˆ–ï¼Œå¾—åˆ°æœ€ç»ˆå¯†æ–‡å€¼</li>
</ul>
<p>è€Œç”±äº8å­—èŠ‚ä¸ºä¸€ç»„åŠ å¯†ï¼Œæ‰€ä»¥ç¬¬äºŒç»„çš„å¯†æ–‡å€¼æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
3DES(padding) \oplus sec</script><p>è€Œæˆ‘ä»¬æ‹¥æœ‰å¯†é’¥ï¼Œè‡ªç„¶ä¹Ÿå°±èƒ½è·å¾—3DES(padding)çš„å€¼ï¼Œä¸å¯†æ–‡å¼‚æˆ–å°±èƒ½å¾—åˆ°secçš„å€¼ã€‚</p>
<p>æœ‰äº†secåï¼Œè¾“å…¥2ç”³è¯·flagçš„å¯†æ–‡ï¼Œç›¸ä¿¡è§£å¯†ä¸æ˜¯éš¾äº‹ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>():</span><br><span class="line">	table = string.digits + string.ascii_letters</span><br><span class="line">	temp = r.recvuntil(<span class="string">b&quot;sha256(XXXX+&quot;</span>)</span><br><span class="line">	temp = r.recvline()</span><br><span class="line">	suffix = temp[:<span class="number">16</span>].decode()</span><br><span class="line">	hex1 = temp[<span class="number">20</span>:].strip().decode()</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> tqdm(table):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> table:</span><br><span class="line">			<span class="keyword">for</span> k <span class="keyword">in</span> table:</span><br><span class="line">				<span class="keyword">for</span> m <span class="keyword">in</span> table:</span><br><span class="line">					temp1 = i+j+k+m</span><br><span class="line">					<span class="keyword">if</span>(sha256((temp1+suffix).encode()).hexdigest() == hex1):</span><br><span class="line">						r.sendline(temp1.encode())</span><br><span class="line">						<span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;59.110.20.54&quot;</span>, <span class="number">23333</span>)</span><br><span class="line">proof_of_work()</span><br><span class="line"></span><br><span class="line">xor = <span class="keyword">lambda</span> a,b: <span class="built_in">bytes</span>([a[i % <span class="built_in">len</span>(a)] ^ b[i % <span class="built_in">len</span>(b)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">max</span>(<span class="built_in">len</span>(a), <span class="built_in">len</span>(b)))])</span><br><span class="line"><span class="comment">#2</span></span><br><span class="line">r.recvuntil(<span class="string">b&quot;Get encrypted flag.&quot;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">r.sendline(<span class="string">b&quot;2&quot;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">key = <span class="string">b&quot;1234567887654321&quot;</span></span><br><span class="line">des = DES3.new(key,DES3.MODE_ECB)</span><br><span class="line">r.sendline(<span class="built_in">str</span>(bytes_to_long(key)).encode())</span><br><span class="line">enc = long_to_bytes(<span class="built_in">int</span>(r.recvline().strip().decode()))</span><br><span class="line"></span><br><span class="line"><span class="comment">#1</span></span><br><span class="line">r.recvuntil(<span class="string">b&quot;Get encrypted flag.&quot;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">r.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">r.sendline(<span class="string">b&quot;0&quot;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">r.sendline(<span class="built_in">str</span>(bytes_to_long(key)).encode())</span><br><span class="line">enc1 = long_to_bytes(<span class="built_in">int</span>(r.recvline().strip().decode()))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#dec</span></span><br><span class="line">padding = <span class="string">b&quot;\x08&quot;</span>*<span class="number">8</span></span><br><span class="line">enc_pad1 = des.encrypt(padding)</span><br><span class="line">sec = xor(enc_pad1,enc1)[-<span class="number">8</span>:]</span><br><span class="line">temp = xor(des.decrypt(xor(sec,enc)),sec)</span><br><span class="line"><span class="built_in">print</span>(temp)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;DES_1s_0ut_0f_t1me&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="JPGDiff"><a href="#JPGDiff" class="headerlink" title="JPGDiff"></a>JPGDiff</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å›¾ç‰‡ä¸­çš„å­—ç¬¦ä¸²å³ä¸ºflag</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ç»™äº†ä¸¤å¼ å›¾ç‰‡ï¼Œä¸€å¼ æ˜¯ç»è¿‡æŸç§åŠ å¯†åçš„å›¾ç‰‡ï¼Œä¸€å¼ æ˜¯hintã€‚hintå›¾ç‰‡å¦‚ä¸‹ï¼š</p>
<p><img src="/post/6f77578c/image-20231107194348306.png" alt="image-20231107194348306"></p>
<p>å¯ä»¥çœ‹åˆ°ä»–åˆ†åˆ«ç»™äº†2x2ï¼Œ4x4ï¼Œ8x8çš„å‡ ä¸ªå›¾ç‰‡çš„ä¸€ç§ä¸€æ¬¡æ€§èµ°å®Œæ‰€æœ‰ç‚¹çš„èµ°æ³•ï¼Œè€Œç”±äºåŠ å¯†åçš„å›¾ç‰‡æ˜¯ä¸€ä¸ªä¸€ç»´çš„ç‚¹åºåˆ—ï¼Œå› æ­¤å¯ä»¥çŸ¥é“ï¼šåŠ å¯†çš„å›¾ç‰‡å°±æ˜¯æŒ‰ç…§è¿™ç§èµ°æ³•å¾—åˆ°çš„ç‚¹çš„åºåˆ—ã€‚</p>
<p>è€Œç”±äºåŠ å¯†å›¾ç‰‡å…±æœ‰65536=256x256ä¸ªç‚¹ï¼Œæ‰€ä»¥ç›®æ ‡å°±æ˜¯ï¼š</p>
<ul>
<li>æ‰¾åˆ°è¿™ç§èµ°æ³•çš„æ™®éå‡½æ•°å½¢å¼ï¼Œæ¨å¹¿åˆ°256x256çš„æ­£æ–¹å½¢ä¸­</li>
<li>ç„¶åç”Ÿæˆ256x256çš„ç‚¹çš„åºåˆ—ï¼Œç„¶åç”¨åºåˆ—å¯¹åº”è¿˜åŸåŠ å¯†å›¾ç‰‡å³å¯</li>
</ul>
<p>ç„¶åå…¶å®ä¹‹å‰çç¿»ï¼Œç¿»åˆ°æ˜¥å“¥åšå®¢é‡Œçœ‹åˆ°è¿‡è¿™ä¸ªèµ°æ³•çš„åŠ å¯†å‡½æ•°ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/643051459">[CryptoCTF] CryptoCTF 2023 mediumåˆ†ç±» å›¢é˜Ÿè§£é¢˜writeup ä¹‹äºŒ - çŸ¥ä¹ (zhihu.com)</a></p>
<p>å°±ç›´æ¥å»NSSä¸Šä¸‹è½½è¿™ä¸ªé¢˜ç›®é™„ä»¶ï¼Œç”¨é‡Œé¢çš„å‡½æ•°ç›´æ¥è·‘ä¸€éå°±èƒ½ç”Ÿæˆå¯¹åº”åºåˆ—ï¼Œç„¶åå¯¹ç€è¿˜åŸå³å¯ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sox</span>(<span class="params">n, d</span>):</span><br><span class="line">	x, y, t = <span class="number">0</span>, <span class="number">0</span>, d</span><br><span class="line">	<span class="keyword">for</span> s <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>):</span><br><span class="line">		u = <span class="number">1</span> &amp; t // <span class="number">2</span></span><br><span class="line">		v = <span class="number">1</span> &amp; t ^ u</span><br><span class="line">		x, y = spin(<span class="number">2</span>**s, x, y, u, v)</span><br><span class="line">		x += <span class="number">2</span>**s * u</span><br><span class="line">		y += <span class="number">2</span>**s * v</span><br><span class="line">		t = t // <span class="number">4</span></span><br><span class="line">	<span class="keyword">return</span> x, y</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">spin</span>(<span class="params">n, x, y, u, v</span>):</span><br><span class="line">	<span class="keyword">if</span> v == <span class="number">0</span>:</span><br><span class="line">		<span class="keyword">if</span> u == <span class="number">1</span>:</span><br><span class="line">			x = n - <span class="number">1</span> - x</span><br><span class="line">			y = n - <span class="number">1</span> - y</span><br><span class="line">		x, y = y, x</span><br><span class="line">	<span class="keyword">return</span> x, y</span><br><span class="line"></span><br><span class="line">n = <span class="number">256</span></span><br><span class="line">pix = []</span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> trange(n**<span class="number">2</span>):</span><br><span class="line">    x, y = sox(n, d)</span><br><span class="line">    pix.append((x,y))</span><br><span class="line"></span><br><span class="line">image = Image.<span class="built_in">open</span>(<span class="string">r&quot;E:\é¢˜\æå®¢å¤§æŒ‘æˆ˜ 2023\week2\jpgdiff\ct.png&quot;</span>)</span><br><span class="line">width, height = image.size</span><br><span class="line">pixel_data = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">        pixel = image.getpixel((x, y))</span><br><span class="line">        pixel_data.append(pixel)</span><br><span class="line"></span><br><span class="line">image = Image.new(<span class="string">&quot;RGB&quot;</span>, (<span class="number">256</span>, <span class="number">256</span>))</span><br><span class="line">pixels = image.load()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">65536</span>):</span><br><span class="line">      x,y = pix[i]</span><br><span class="line">      pixels[y, x] = pixel_data[i]</span><br><span class="line"></span><br><span class="line">image.save(<span class="string">&quot;flag.png&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;H1LB5RT_C1pher&#125;</span></span><br></pre></td></tr></table></figure>
<p><img src="/post/6f77578c/image-20231107195806843.png" alt="image-20231107195806843"></p>
<p>ç„¶åå¯¹ç€flagè¿›è¡Œæœç´¢ï¼Œå¯ä»¥æ‰¾åˆ°å¯¹åº”çš„èµ°æ³•å…¶å®æ˜¯å«åšHilbertæ›²çº¿ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1494903">å¸Œå°”ä¼¯ç‰¹æ›²çº¿ï¼ˆHilbertæ›²çº¿å«è§£æï¼‰-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘ (tencent.com)</a></p>
<p><br></p>
<p><br></p>
<h3 id="Energetic-Carcano"><a href="#Energetic-Carcano" class="headerlink" title="Energetic_Carcano"></a>Energetic_Carcano</h3><p>é¢˜ç›®æ¥æºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é¢˜ç›®é“¾æ¥ï¼šnc 59.110.20.54:8763 https://en.wikipedia.org/wiki/Elliptic-curve_cryptography</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from sage.all import *</span></span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line"><span class="keyword">import</span> random </span><br><span class="line"><span class="keyword">import</span> string </span><br><span class="line"><span class="keyword">import</span> hashlib </span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"></span><br><span class="line">DEBUG = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">banner = <span class="string">&#x27;|&#x27;</span>*<span class="number">70</span> </span><br><span class="line">flag = os.environ.get(<span class="string">&quot;FLAG&quot;</span>, <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span>).encode()</span><br><span class="line">pbits = <span class="number">120</span></span><br><span class="line">abp = <span class="string">&quot;abp&quot;</span> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>(): </span><br><span class="line">    <span class="keyword">if</span> DEBUG:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    proof = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters+string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">    digest = hashlib.sha256(proof.encode()).hexdigest()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;sha256(XXXX+%s) == %s&quot;</span> % (proof[<span class="number">4</span>:], digest))</span><br><span class="line">    x = <span class="built_in">input</span>(<span class="string">&quot;Give me XXXX: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(x)!=<span class="number">4</span> <span class="keyword">or</span> hashlib.sha256((x+proof[<span class="number">4</span>:]).encode()).hexdigest() != digest: </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Right!&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">a,b,p,turn,ans</span>):</span><br><span class="line">    <span class="keyword">if</span> DEBUG:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span> </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> turn == <span class="string">&quot;a&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int</span>(a) == ans </span><br><span class="line">        <span class="keyword">if</span> turn == <span class="string">&quot;b&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int</span>(b) == ans</span><br><span class="line">        <span class="keyword">if</span> turn == <span class="string">&quot;p&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int</span>(p) == ans  </span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>: </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> proof_of_work():</span><br><span class="line">        exit() </span><br><span class="line">    <span class="built_in">print</span>(banner) </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\nHi Crypto-ers! AL3XEI here. I know you are excellent at math, so I prepared a game for u.&#x27;</span>) </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;In the equation y^2 = x^3+ a*x + b (mod p), 4 points are given. Plz give me the right a, b or p to contine the game.&#x27;</span>) </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Good Luck!\n&#x27;</span>) </span><br><span class="line">    <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>) </span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        turn = random.choice(abp) </span><br><span class="line">        p = getPrime(pbits) </span><br><span class="line">        a,b = [next_prime(random.randint(<span class="number">2</span>,p)) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;ab&quot;</span>] </span><br><span class="line">        curve = EllipticCurve(GF(p),[a,b]) </span><br><span class="line">        pts = [curve.random_point() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">        pts = [(_[<span class="number">0</span>], _[<span class="number">1</span>]) <span class="keyword">for</span> _ <span class="keyword">in</span> pts] </span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> pts:</span><br><span class="line">            <span class="built_in">print</span>(_,end=<span class="string">&quot; &quot;</span>) </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\nGive me &#x27;</span>+turn+<span class="string">&quot; :&quot;</span>) </span><br><span class="line">        ans = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>)) </span><br><span class="line">        <span class="keyword">if</span> check(a,b,p,turn,ans):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Good! Next challenge-&gt;\n&quot;</span>) </span><br><span class="line">            <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">            pbits+=<span class="number">5</span>  </span><br><span class="line">            <span class="keyword">continue</span> </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Something goes wrong...\n&quot;</span>) </span><br><span class="line">            <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>) </span><br><span class="line">            exit() </span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Congrats! Your flag is:&#x27;</span>,flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> Exception:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Something goes wrong...\n&quot;</span>) </span><br><span class="line">    <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>) </span><br><span class="line">    exit() </span><br></pre></td></tr></table></figure>
<p>é¢˜æ„å¾ˆç®€å•ï¼Œå®Œæˆåè½®æŒ‘æˆ˜å°±èƒ½è·å¾—flagï¼Œæ¯è½®æŒ‘æˆ˜å†…å®¹ä¸ºï¼š</p>
<ul>
<li>ç”Ÿæˆä¸€æ¡éšæœºæ¤­åœ†æ›²çº¿ï¼Œç»™å‡ºå…¶ä¸Šå››ä¸ªç‚¹çš„åæ ‡</li>
<li>è¦æ±‚æä¾›ç»™å®šå‚æ•°pã€aã€bå…¶ä¸­ä¸€ä¸ªçš„å€¼ï¼Œæä¾›æ­£ç¡®åˆ™è¿›è¡Œä¸‹ä¸€è½®æŒ‘æˆ˜</li>
</ul>
<p>æˆ‘ä»¬çŸ¥é“æ¤­åœ†æ›²çº¿çš„ç‚¹æ»¡è¶³æ–¹ç¨‹ï¼š</p>
<script type="math/tex; mode=display">
y^2 = x^3+ax+b \quad(mod\;p)</script><p>è€Œæˆ‘ä»¬æœ‰å››ä¸ªç‚¹çš„åæ ‡ï¼Œå°±æœ‰å››ç»„æ–¹ç¨‹ï¼š</p>
<script type="math/tex; mode=display">
y_1^2 = x_1^3+ax_1+b \quad(mod\;p)</script><script type="math/tex; mode=display">
y_2^2 = x_2^3+ax_2+b \quad(mod\;p)</script><script type="math/tex; mode=display">
y_3^2 = x_3^3+ax_3+b \quad(mod\;p)</script><script type="math/tex; mode=display">
y_4^2 = x_4^3+ax_4+b \quad(mod\;p)</script><p>è¦æ±‚ä»å››ç»„æ–¹ç¨‹ä¸­è¿˜åŸaã€bã€pï¼Œå…¶å®è·Ÿæ— å‚æ•°çš„LCGå¾ˆåƒï¼Œä¸»è¦ç›®çš„å°±æ˜¯æ¶ˆå…ƒï¼Œæ±‚gcdå¾—åˆ°pï¼Œç„¶åå†å›åˆ°æ¨¡æ–¹ç¨‹ä¸­æ±‚è§£aã€bã€‚</p>
<p>æ¶ˆå…ƒè¿‡ç¨‹å¦‚ä¸‹ï¼Œæˆ‘ä»¬å–å‰ä¸¤ç»„æ–¹ç¨‹ï¼š</p>
<script type="math/tex; mode=display">
y_1^2 -  x_1^3 =ax_1+b \quad(mod\;p)</script><script type="math/tex; mode=display">
y_2^2 - x_2^3= ax_2+b \quad(mod\;p)</script><p>ä½œå·®æ¶ˆæ‰bï¼š</p>
<script type="math/tex; mode=display">
y_1^2 -  x_1^3 - y_2^2 + x_2^3=ax_1 - ax_2 \quad(mod\;p)</script><p>æŠŠaå•ç‹¬æå‡ºæ¥ï¼š</p>
<script type="math/tex; mode=display">
(y_1^2 -  x_1^3 - y_2^2 + x_2^3)(x_1-x_2)^{-1} = a \quad(mod\;p)</script><p>åŒç†ï¼Œæˆ‘ä»¬å–ç¬¬äºŒä¸‰ç»„æ–¹ç¨‹ä¹Ÿèƒ½å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
(y_2^2 -  x_2^3 - y_3^2 + x_3^3)(x_2-x_3)^{-1} = a \quad(mod\;p)</script><p>é‚£ä¹ˆä½œå·®å°±æœ‰ï¼š</p>
<script type="math/tex; mode=display">
(y_1^2 -  x_1^3 - y_2^2 + x_2^3)(x_1-x_2)^{-1} - (y_2^2 -  x_2^3 - y_3^2 + x_3^3)(x_2-x_3)^{-1} = 0 \quad(mod\;p)</script><p>é‚£ä¹ˆåŒæ ·å†å–ä¸€ç»„æ±‚gcdï¼Œå¹¶æ¶ˆå»å°å› å­å°±èƒ½å¾—åˆ°pï¼Œå¾—åˆ°pè¿‡åè¿˜åŸabå°±å¾ˆè½»æ¾ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>():</span><br><span class="line">	table = string.digits + string.ascii_letters</span><br><span class="line">	temp = r.recvuntil(<span class="string">b&quot;sha256(XXXX+&quot;</span>)</span><br><span class="line">	temp = r.recvline()</span><br><span class="line">	suffix = temp[:<span class="number">16</span>].decode()</span><br><span class="line">	hex1 = temp[<span class="number">20</span>:].strip().decode()</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> tqdm(table):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> table:</span><br><span class="line">			<span class="keyword">for</span> k <span class="keyword">in</span> table:</span><br><span class="line">				<span class="keyword">for</span> m <span class="keyword">in</span> table:</span><br><span class="line">					temp1 = i+j+k+m</span><br><span class="line">					<span class="keyword">if</span>(sha256((temp1+suffix).encode()).hexdigest() == hex1):</span><br><span class="line">						r.sendline(temp1.encode())</span><br><span class="line">						<span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calc</span>(<span class="params">points</span>):</span><br><span class="line">    (x1,y1),(x2,y2),(x3,y3),(x4,y4) = points</span><br><span class="line">    t1 = (y2**<span class="number">2</span>-y1**<span class="number">2</span>-x2**<span class="number">3</span>+x1**<span class="number">3</span>)</span><br><span class="line">    t2 = (y3**<span class="number">2</span>-y2**<span class="number">2</span>-x3**<span class="number">3</span>+x2**<span class="number">3</span>)</span><br><span class="line">    t3 = (y4**<span class="number">2</span>-y3**<span class="number">2</span>-x4**<span class="number">3</span>+x3**<span class="number">3</span>)</span><br><span class="line">    k1p = t1*(x3-x2) - t2*(x2-x1)</span><br><span class="line">    k2p = t2*(x4-x3) - t3*(x3-x2)</span><br><span class="line">    k3p = t1*(x4-x3) - t3*(x2-x1)</span><br><span class="line">    p = GCD(k1p,k2p)</span><br><span class="line">    p = GCD(p,k3p)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">1000</span>):</span><br><span class="line">        <span class="keyword">while</span>(p % i == <span class="number">0</span>):</span><br><span class="line">            p //= i</span><br><span class="line">    a = inverse(x2-x1,p)*t1 % p</span><br><span class="line">    b = (y1**<span class="number">2</span>-x1**<span class="number">3</span>-a*x1) % p</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> a,b,p</span><br><span class="line">	</span><br><span class="line">r = remote(<span class="string">&quot;59.110.20.54&quot;</span>,<span class="number">8763</span>)</span><br><span class="line">proof_of_work()</span><br><span class="line">r.recvuntil(<span class="string">b&quot;Good Luck!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;|&quot;</span>*<span class="number">70</span>)</span><br><span class="line">    r.recvline()</span><br><span class="line">    r.recvline()</span><br><span class="line">    points = r.recvline().strip().decode().split(<span class="string">&quot; &quot;</span>)</span><br><span class="line">    point_list = [[<span class="number">0</span>,<span class="number">0</span>] <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        <span class="keyword">if</span>(j % <span class="number">2</span> == <span class="number">0</span>):</span><br><span class="line">            point_list[j//<span class="number">2</span>][<span class="number">0</span>] = <span class="built_in">int</span>(points[j][<span class="number">1</span>:-<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            point_list[j//<span class="number">2</span>][<span class="number">1</span>] = <span class="built_in">int</span>(points[j][:-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    a,b,p = calc(point_list)</span><br><span class="line"></span><br><span class="line">    r.recvuntil(<span class="string">b&quot;me &quot;</span>)</span><br><span class="line">    turn = r.recvline()</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">b&quot;a&quot;</span> <span class="keyword">in</span> turn):</span><br><span class="line">        r.sendline(<span class="built_in">str</span>(a).encode())</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">b&quot;b&quot;</span> <span class="keyword">in</span> turn):</span><br><span class="line">        r.sendline(<span class="built_in">str</span>(b).encode())</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">b&quot;p&quot;</span> <span class="keyword">in</span> turn):</span><br><span class="line">        r.sendline(<span class="built_in">str</span>(p).encode())</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&quot;Congrats! Your flag is:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.recvline())	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;ECC_M4ster&#125;</span></span><br></pre></td></tr></table></figure>
<p>äº‹å®ä¸Šï¼Œè¿™é¢˜å±…ç„¶å¯ä»¥ç›´æ¥å®šä¹‰åœ¨ZZåŸŸä¸Šï¼Œç„¶åGroebnerè§£ã€‚æˆ‘å¼€å§‹è®¤ä¸ºå¿…é¡»åœ¨ZpåŸŸä¸Šæ‰è¡Œï¼Œæ‰€ä»¥æ²¡æœ‰è€ƒè™‘è¿‡ï¼Œæ¶¨çŸ¥è¯†äº†ã€‚</p>
<p><br></p>
<p><br></p>
<h3 id="Just-need-One"><a href="#Just-need-One" class="headerlink" title="Just need One"></a>Just need One</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é¢˜ç›®é“¾æ¥ï¼šnc 59.110.20.54:2613 One bullet to kill all Outlaws.</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os </span><br><span class="line"><span class="keyword">import</span> random </span><br><span class="line"><span class="keyword">import</span> string </span><br><span class="line"><span class="keyword">import</span> hashlib </span><br><span class="line"></span><br><span class="line">flag = os.environ.get(<span class="string">&quot;FLAG&quot;</span>, <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span>)</span><br><span class="line">DEBUG = <span class="literal">False</span></span><br><span class="line">banner = <span class="string">&#x27;|&#x27;</span>*<span class="number">70</span></span><br><span class="line"><span class="keyword">if</span> DEBUG:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;==DEBUG MODE==&quot;</span>) </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>(): </span><br><span class="line">    <span class="keyword">if</span> DEBUG:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    proof = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters+string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">    digest = hashlib.sha256(proof.encode()).hexdigest()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;sha256(XXXX+%s) == %s&quot;</span> % (proof[<span class="number">4</span>:], digest))</span><br><span class="line">    x = <span class="built_in">input</span>(<span class="string">&quot;Give me XXXX: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(x)!=<span class="number">4</span> <span class="keyword">or</span> hashlib.sha256((x+proof[<span class="number">4</span>:]).encode()).hexdigest() != digest: </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Right!&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span>  </span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> proof_of_work():</span><br><span class="line">        exit() </span><br><span class="line">    <span class="built_in">print</span>(banner) </span><br><span class="line">    parms = [random.getrandbits(<span class="number">32</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>)] </span><br><span class="line">    res = res = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;Give me x calculating f(x) :\n&gt; &#x27;</span>))  </span><br><span class="line">    <span class="keyword">if</span> res &gt;= <span class="number">2</span>**<span class="number">32</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Give me something smaller.\n&quot;</span>)  </span><br><span class="line">        <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>) </span><br><span class="line">        exit() </span><br><span class="line"></span><br><span class="line">    cnt = <span class="number">0</span>  </span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>): </span><br><span class="line">        cnt += <span class="built_in">pow</span>(res,_)*parms[_]  </span><br><span class="line">    <span class="built_in">print</span>(cnt) </span><br><span class="line">    ans = <span class="built_in">input</span>(<span class="string">&#x27;Give me Coefficients :\n&gt; &#x27;</span>) </span><br><span class="line">    ans = [<span class="built_in">int</span>(_) <span class="keyword">for</span> _ <span class="keyword">in</span> ans.split(<span class="string">&quot;,&quot;</span>)] </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ans == parms:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Congrats! Your flag is:&#x27;</span>,flag)  </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> Exception:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Something goes wrong...\n&quot;</span>) </span><br><span class="line">    <span class="built_in">print</span>(banner+<span class="string">&#x27;\n&#x27;</span>) </span><br><span class="line">    exit() </span><br></pre></td></tr></table></figure>
<p>è¿™é¢˜é¢˜æ„å¦‚ä¸‹ï¼š</p>
<ul>
<li>é€šè¿‡proof</li>
<li>ç”Ÿæˆé•¿åº¦ä¸º128çš„åºåˆ—ï¼Œåºåˆ—ä¸­æ¯ä¸ªå€¼æ˜¯éšæœºçš„32æ¯”ç‰¹</li>
<li>å¯ä»¥è¾“å…¥ä¸€ä¸ªå°äº2^32çš„resï¼Œå½“ä½œå¤šé¡¹å¼çš„xï¼Œå¹¶è®¡ç®—å¦‚ä¸‹ç´¯åŠ å’Œcntï¼š</li>
</ul>
<script type="math/tex; mode=display">
cnt = \sum_{i=0}^{127}parms_i * res^i</script><ul>
<li>ç»™å‡ºcntï¼Œè¦æ±‚è¿˜åŸparmså¹¶è¾“å…¥ç»™é¶æœºï¼Œå°±èƒ½è·å¾—flag</li>
</ul>
<p>è§£å†³æ–¹å¼ä¹Ÿå¾ˆç®€å•ï¼Œæ³¨æ„åˆ°ä»–å…¶å®åªé™åˆ¶äº†reså°äº2^32ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼ å…¥è´Ÿæ•°çš„è¯ï¼Œç»å¯¹å€¼å¤§å°æ˜¯ä¸ä¼šæ£€æŸ¥çš„ã€‚æ‰€ä»¥ç›´æ¥ä¼ -2^32æˆ–æ›´å°çš„2çš„å¹‚æ¬¡ï¼Œç„¶åå°†ç´¯åŠ å’Œé€æ¬¡ç§»ä½å¹¶å¤„ç†å¯¹åº”çš„å‡æ³•å€Ÿä½å°±æœ‰parmsäº†ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>():</span><br><span class="line">	table = string.digits + string.ascii_letters</span><br><span class="line">	temp = r.recvuntil(<span class="string">b&quot;sha256(XXXX+&quot;</span>)</span><br><span class="line">	temp = r.recvline()</span><br><span class="line">	suffix = temp[:<span class="number">16</span>].decode()</span><br><span class="line">	hex1 = temp[<span class="number">20</span>:].strip().decode()</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> tqdm(table):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> table:</span><br><span class="line">			<span class="keyword">for</span> k <span class="keyword">in</span> table:</span><br><span class="line">				<span class="keyword">for</span> m <span class="keyword">in</span> table:</span><br><span class="line">					temp1 = i+j+k+m</span><br><span class="line">					<span class="keyword">if</span>(sha256((temp1+suffix).encode()).hexdigest() == hex1):</span><br><span class="line">						r.sendline(temp1.encode())</span><br><span class="line">						<span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;59.110.20.54&quot;</span>, <span class="number">2613</span>)</span><br><span class="line">proof_of_work()</span><br><span class="line">r.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">res = -<span class="number">2</span>**<span class="number">64</span></span><br><span class="line">r.sendline(<span class="built_in">str</span>(res).encode())</span><br><span class="line">cnt = <span class="built_in">int</span>(r.recvline().strip().decode())</span><br><span class="line">tt = cnt</span><br><span class="line">r.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line"></span><br><span class="line">parms = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">	parms[i] = cnt &amp; ((<span class="number">1</span>&lt;&lt;<span class="number">64</span>)-<span class="number">1</span>)</span><br><span class="line">	<span class="keyword">if</span>(i%<span class="number">2</span>):</span><br><span class="line">		parms[i] = <span class="number">2</span>**<span class="number">64</span>-parms[i]</span><br><span class="line">	<span class="keyword">elif</span>(i!=<span class="number">0</span> <span class="keyword">and</span> i%<span class="number">2</span> == <span class="number">0</span>):</span><br><span class="line">		parms[i] += <span class="number">1</span></span><br><span class="line">	cnt &gt;&gt;= <span class="number">64</span></span><br><span class="line"></span><br><span class="line">r.sendline(<span class="built_in">str</span>(parms)[<span class="number">1</span>:-<span class="number">1</span>].encode())</span><br><span class="line"><span class="built_in">print</span>(r.recvline())</span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;Alg0r1thm_1s_s0_S1mpl3!&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="Fi1nd-th3-xâ€™"><a href="#Fi1nd-th3-xâ€™" class="headerlink" title="Fi1nd_th3_xâ€™"></a>Fi1nd_th3_xâ€™</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¬è¯´åœ¨é‚£ä¸ªå¤§é™†æœ‰ä½å«jrl777çš„æ—…è¡Œè€…......Cryptoerç©¿è¶Šåˆ°äº†æç“¦ç‰¹å°±è¦æ‹¿å‡ºçœŸæœ¬äº‹ï¼</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span>* </span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">r = getPrime(<span class="number">512</span>)</span><br><span class="line">e = getPrime(<span class="number">32</span>)</span><br><span class="line">n = p*q*r</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">dP = d%((q-<span class="number">1</span>)*(r-<span class="number">1</span>))</span><br><span class="line">dQ = d%((p-<span class="number">1</span>)*(r-<span class="number">1</span>))</span><br><span class="line">dR = d%((p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = s2n(flag.encode())</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p=&#x27;</span>,p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;q=&#x27;</span>,q)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;r=&#x27;</span>,r)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;dP=&#x27;</span>,dP)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;dQ=&#x27;</span>,dQ)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;dR=&#x27;</span>,dR)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c=&#x27;</span>,c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p= 13014610351521460822156239705430709078128228907778181478242620569429327799535062679140131416771915929573454741755415612880788196172134695027201422226050343</span></span><br><span class="line"><span class="string">q= 12772373441651008681294250861077909144300908972709561019514945881228862913558543752401850710742410181542277593157992764354184262443612041344749961361188667</span></span><br><span class="line"><span class="string">r= 12128188838358065666687296689425460086282352520167544115899775800918383085863282204525519245937988837403739683061218279585168168892037039644924073220678419</span></span><br><span class="line"><span class="string">dP= 116715737414908163105708802733763596338775040866822719131764691930369001776551671725363881836568414327815420649861207859100479999650414099346914809923964116101517432576562641857767638396325944526867458624878906968552835814078216316470330511385701105459053294771612727181278955929391807414985165924450505855941</span></span><br><span class="line"><span class="string">dQ= 44209639124029393930247375993629669338749966042856653556428540234515804939791650065905841618344611216577807325504984178760405516121845853248373571704473449826683120387747977520655432396578361308033763778324817416507993263234206797363191089863381905902638111246229641698709383653501799974217118168526572365797</span></span><br><span class="line"><span class="string">dR= 60735172709413093730902464873458655487237612458970735840670987186877666190533417038325630420791294593669609785154204677845781980482700493870590706892523016041087206844082222225206703139282240453277802870868459288354322845410191061009582969848870045522383447751431300627611762289800656277924903605593069856921</span></span><br><span class="line"><span class="string">c= 93063188325241977486352111369210103514669725591157371105152980481620575818945846725056329712195176948376321676112726029400835578531311113991944495646259750817465291340479809938094295621728828133981781064352306623727112813796314947081857025012662546178066873083689559924412320123824601550896063037191589471066773464829226873338699012924080583389032903142107586722373131642720522453842444615499672193051587154108368643495983197891525747653618742702589711752256009</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>Task.txtï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">5Lq65Lus5Y+q6K6w5b6X77yM6L+Z5pys5piv6aOO5ZKM5pel5Li955qE5LiA5aSp77yManJsNzc35q2j5Zyo572R5LiK5a2m5Lmg5a+G56CB5a2m44CC5b+954S25LmL6Ze077yM6buR6Imy5raI6YCA77yM5bGP5bmV55m95YWJ6aqk6LW377yM5omA5pyJ55qE6K665paH6YO95reh5Ye655y85biY44CC5LuW5Yed56We5LiA55yL77yM5Y205Y+q5pyJ5rex6YKD5aaC5aKo55qE4oCc5Y6f56We4oCd5LqM5a2X5Zyo5Zue5bqU552A44CC5pyq5Y+K5oCd6ICD77yManJsNzc36ISR6KKL5LiA6Zi15pmV55yp44CC6ICM5q2k5Yi777yM5o+Q55Om54m55aSn6ZmG5LiK56m65pyJ6YeR5YWJ6Zeq54OB77yM56m66Ze05Lmx5rWB5LmL5YaF77yM5LiD56eN5YWD57Sg5Yqb5pKV5byA5LqG5pe256m66KOC57yd77yM6aOO5bim5p2l5LqG5pWF5LqL55qE56eN5a2Q44CC5Y+v5YaN5Z2a5Zu655qE5bKp55+z5Lmf6Zq+6YCD56Oo5o2f55qE5ZG96L+Q44CC4oCc5LiW55WM77yM6YGX5b+Y5oiR44CC4oCd5LuW57uI56m25b+Y6K6w5LqG6Ieq5bexQ3J5cHRvZXLnmoTouqvku73jgILigJzmj5Dnk6bnibnlpKfpmYbnmoTml4XkurrvvIzkvaDog73mib7liLDmiJHpgZflpLHnmoTotKblj7flkJfvvJ/igJ0=</span><br></pre></td></tr></table></figure>
<p>å…ˆè§£taskå¾—åˆ°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">äººä»¬åªè®°å¾—ï¼Œè¿™æœ¬æ˜¯é£å’Œæ—¥ä¸½çš„ä¸€å¤©ï¼Œjrl777æ­£åœ¨ç½‘ä¸Šå­¦ä¹ å¯†ç å­¦ã€‚å¿½ç„¶ä¹‹é—´ï¼Œé»‘è‰²æ¶ˆé€€ï¼Œå±å¹•ç™½å…‰éª¤èµ·ï¼Œæ‰€æœ‰çš„è®ºæ–‡éƒ½æ·¡å‡ºçœ¼å¸˜ã€‚ä»–å‡ç¥ä¸€çœ‹ï¼Œå´åªæœ‰æ·±é‚ƒå¦‚å¢¨çš„â€œåŸç¥â€äºŒå­—åœ¨å›åº”ç€ã€‚æœªåŠæ€è€ƒï¼Œjrl777è„‘è¢‹ä¸€é˜µæ™•çœ©ã€‚è€Œæ­¤åˆ»ï¼Œæç“¦ç‰¹å¤§é™†ä¸Šç©ºæœ‰é‡‘å…‰é—ªçƒï¼Œç©ºé—´ä¹±æµä¹‹å†…ï¼Œä¸ƒç§å…ƒç´ åŠ›æ’•å¼€äº†æ—¶ç©ºè£‚ç¼ï¼Œé£å¸¦æ¥äº†æ•…äº‹çš„ç§å­ã€‚å¯å†åšå›ºçš„å²©çŸ³ä¹Ÿéš¾é€ƒç£¨æŸçš„å‘½è¿ã€‚â€œä¸–ç•Œï¼Œé—å¿˜æˆ‘ã€‚â€ä»–ç»ˆç©¶å¿˜è®°äº†è‡ªå·±Cryptoerçš„èº«ä»½ã€‚â€œæç“¦ç‰¹å¤§é™†çš„æ—…äººï¼Œä½ èƒ½æ‰¾åˆ°æˆ‘é—å¤±çš„è´¦å·å—ï¼Ÿâ€</span><br></pre></td></tr></table></figure>
<p>è¿˜æ˜¯ç›´æ¥çœ‹é¢˜å§ï¼Œé¢˜ç›®ç»™å‡ºä»¥ä¸‹å‡ ä¸ªå€¼ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dP = d%((q-<span class="number">1</span>)*(r-<span class="number">1</span>))</span><br><span class="line">dQ = d%((p-<span class="number">1</span>)*(r-<span class="number">1</span>))</span><br><span class="line">dR = d%((p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br></pre></td></tr></table></figure>
<p>ç„¶åä¹Ÿç›´æ¥ç»™äº†nçš„åˆ†è§£pã€qã€rä»¥åŠå¯†æ–‡ï¼Œè¦æ±‚è¿˜åŸæ˜æ–‡ã€‚</p>
<p>ä¸»è¦é—®é¢˜å°±åœ¨äºï¼Œæ²¡æœ‰åŠ å¯†æŒ‡æ•°eï¼Œä¸”åŠ å¯†æŒ‡æ•°eçš„æ¯”ç‰¹æ˜¯32ï¼Œä¸å¤ªå®¹æ˜“çˆ†ç ´ï¼Œå› æ­¤æˆ‘ä»¬æ— æ³•ç›´æ¥æ±‚å¾—è§£å¯†æŒ‡æ•°ï¼Œåªèƒ½ç”¨ç»™çš„å‡ ä¸ªdPã€dQã€dRæ¥è§£é¢˜ã€‚(å…¶å®ç¿»mapleçš„åšå®¢ç¿»åˆ°è¿‡æœ‰ä¸€ä¸ªå·¥å…·ï¼Œå¯ä»¥éå¸¸å¿«é€Ÿçš„ç»™å‡ºæ‰€æœ‰32æ¯”ç‰¹çš„ç´ æ•°ï¼Œä½†æ˜¯è¿™é¢˜è‚¯å®šä¸æ˜¯è€ƒè¿™ä¸ªå“ˆå“ˆã€‚æœ‰å…´è¶£çš„å¸ˆå‚…ä¹Ÿå¯ä»¥è‡ªå·±å»æ‰¾ä¸€æ‰¾)</p>
<p>ç„¶åå¯¹dPç†Ÿæ‚‰ä¸€ç‚¹çš„è¯ï¼Œåº”è¯¥èƒ½çŸ¥é“ï¼Œæˆ‘ä»¬èƒ½è·å¾—ä»¥ä¸‹å‡ ä¸ªè§£å¯†å€¼ï¼š</p>
<script type="math/tex; mode=display">
c^{dP} \equiv m \quad(mod\;qr)</script><script type="math/tex; mode=display">
c^{dQ} \equiv m \quad(mod\;pr)</script><script type="math/tex; mode=display">
c^{dR} \equiv m \quad(mod\;pq)</script><p>é‚£ä¹ˆå…¶å®å°±æ˜¯ä¸€ä¸ªä¸äº’ç´ çš„CRTï¼Œä¸æ¸…æ¥šçš„å¸ˆå‚…å¯ä»¥è‡ªå·±æœä¸€æœåŸç†ï¼Œè¿™é‡Œæ¨èä¸€æ‰‹Xennyå¸ˆå‚…çš„å¯†ç å·¥åŠã€‚</p>
<p>ä½†æ˜¯åªè¿½æ±‚å‡ºç»“æœçš„è¯ï¼Œç”¨è¿™ä¸ªåº“é‡Œçš„å‡½æ•°å¯ä»¥ä¸€æ­¥åˆ°ä½ï¼Œä¸ç®¡äº’ä¸äº’ç´ ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br></pre></td></tr></table></figure>
<p>å½“ç„¶æˆ‘æ˜¯å»ºè®®äº†è§£æ¸…æ¥šåŸç†ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"></span><br><span class="line">p= <span class="number">13014610351521460822156239705430709078128228907778181478242620569429327799535062679140131416771915929573454741755415612880788196172134695027201422226050343</span></span><br><span class="line">q= <span class="number">12772373441651008681294250861077909144300908972709561019514945881228862913558543752401850710742410181542277593157992764354184262443612041344749961361188667</span></span><br><span class="line">r= <span class="number">12128188838358065666687296689425460086282352520167544115899775800918383085863282204525519245937988837403739683061218279585168168892037039644924073220678419</span></span><br><span class="line">dP= <span class="number">116715737414908163105708802733763596338775040866822719131764691930369001776551671725363881836568414327815420649861207859100479999650414099346914809923964116101517432576562641857767638396325944526867458624878906968552835814078216316470330511385701105459053294771612727181278955929391807414985165924450505855941</span></span><br><span class="line">dQ= <span class="number">44209639124029393930247375993629669338749966042856653556428540234515804939791650065905841618344611216577807325504984178760405516121845853248373571704473449826683120387747977520655432396578361308033763778324817416507993263234206797363191089863381905902638111246229641698709383653501799974217118168526572365797</span></span><br><span class="line">dR= <span class="number">60735172709413093730902464873458655487237612458970735840670987186877666190533417038325630420791294593669609785154204677845781980482700493870590706892523016041087206844082222225206703139282240453277802870868459288354322845410191061009582969848870045522383447751431300627611762289800656277924903605593069856921</span></span><br><span class="line">c= <span class="number">93063188325241977486352111369210103514669725591157371105152980481620575818945846725056329712195176948376321676112726029400835578531311113991944495646259750817465291340479809938094295621728828133981781064352306623727112813796314947081857025012662546178066873083689559924412320123824601550896063037191589471066773464829226873338699012924080583389032903142107586722373131642720522453842444615499672193051587154108368643495983197891525747653618742702589711752256009</span></span><br><span class="line"></span><br><span class="line">cp = <span class="built_in">pow</span>(c,dP,q*r)</span><br><span class="line">cq = <span class="built_in">pow</span>(c,dQ,p*r)</span><br><span class="line">cr = <span class="built_in">pow</span>(c,dR,p*q)</span><br><span class="line"></span><br><span class="line">N = [q*r,p*r,p*q]</span><br><span class="line">C = [cp,cq,cr]</span><br><span class="line">M = crt(N,C)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(M))</span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;CRT_1s_f3n_but_Gen3hi_im9act_is_a_balabalaba&#125;</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åå°±å‘ç°ï¼Œè¿™æ˜æ–‡å¹¶ä¸é•¿ï¼Œæ‰€ä»¥éšä¾¿ç”¨ä¸€ä¸ªæ¨¡ä¸‹çš„méƒ½å¯ä»¥ç›´æ¥å‡ºç»“æœï¼Œå¹¶ä¸éœ€è¦CRTã€‚</p>
<p><br></p>
<p><br></p>
<h2 id="Week-3"><a href="#Week-3" class="headerlink" title="Week 3"></a>Week 3</h2><h3 id="Quick-Robert"><a href="#Quick-Robert" class="headerlink" title="Quick_Robert"></a>Quick_Robert</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc 59.110.20.54:3042 https://en.wikipedia.org/wiki/Quadratic_residue</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®æ²¡æœ‰ç»™æºç ï¼Œncä¸Šå»åå‘ç°æœ‰proof_of_workï¼Œé‚£ä¹ˆæŠŠproofè¿‡æ‰åé¶æœºä¼šå‘é€é¢˜ç›®ä»»åŠ¡å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||</span><br><span class="line"></span><br><span class="line">Hi Crypto-ers! AL3XEI Here. In number theory, <span class="keyword">if</span> there exists an integer q satisfying x^<span class="number">2</span>=q(mod n), q <span class="keyword">is</span> so called a quadratic residue.</span><br><span class="line">We write this calculation <span class="keyword">as</span> L(a,p), which its value shows a <span class="keyword">is</span> <span class="keyword">or</span> <span class="keyword">is</span> <span class="keyword">not</span> quadratic residue modulo p.</span><br><span class="line">Below, you need to give me the answer of the <span class="built_in">sum</span> of L(a*l**<span class="number">2</span>+b*l+<span class="number">1</span>,p), where a,b are integers, p <span class="keyword">is</span> a prime, <span class="keyword">and</span> l rise <span class="keyword">from</span> <span class="number">0</span> to p-<span class="number">1.</span></span><br><span class="line">For example, given a = <span class="number">2</span>, b = <span class="number">3</span>, c = <span class="number">1</span>, p = <span class="number">5</span>, the answer will be</span><br><span class="line">L(<span class="number">1</span>, <span class="number">5</span>) + L(<span class="number">6</span>, <span class="number">5</span>) + L(<span class="number">15</span>, <span class="number">5</span>) + L(<span class="number">28</span>, <span class="number">5</span>) + L(<span class="number">45</span>, <span class="number">5</span>) = <span class="number">1.</span>      </span><br><span class="line">Hope you success!</span><br><span class="line"></span><br><span class="line">||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||</span><br><span class="line"></span><br><span class="line"><span class="number">1809</span> * l**<span class="number">2</span> + <span class="number">204</span> * l + <span class="number">1</span></span><br><span class="line">p = <span class="number">191</span> (<span class="number">8</span> bits)</span><br><span class="line"></span><br><span class="line">&gt; <span class="type">Type</span> your answer:</span><br></pre></td></tr></table></figure>
<p>å¤§è‡´æè¿°ä¸€ä¸‹é¢˜ç›®ä»»åŠ¡ï¼š</p>
<ul>
<li>L(a,p)æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ ¹æ®aæ˜¯æ¨¡pä¸‹çš„äºŒæ¬¡å‰©ä½™è¿˜æ˜¯äºŒæ¬¡éå‰©ä½™æœ‰ä¸åŒçš„å–å€¼ã€‚æŒ‰ç…§ä¾‹å­çš„è¯ï¼Œæˆ‘è®¤ä¸ºåº”è¯¥æ˜¯ï¼š</li>
</ul>
<script type="math/tex; mode=display">
\begin{equation}
L(a,p)=\left\{
    \begin{aligned}
    0 \quad aæ˜¯æ¨¡pä¸‹çš„äºŒæ¬¡å‰©ä½™\\
    1 \quad aæ˜¯æ¨¡pä¸‹äºŒæ¬¡éå‰©ä½™\\
    \end{aligned}
    \right
    .
\end{equation}</script><ul>
<li>ç„¶åï¼Œé¢˜ç›®è¦æ±‚è®¡ç®—å¦‚ä¸‹ç´¯åŠ å¼å¹¶è¿”å›ç­”æ¡ˆï¼Œç­”æ¡ˆæ­£ç¡®å³å¯è¿›å…¥ä¸‹ä¸€è½®ï¼š</li>
</ul>
<script type="math/tex; mode=display">
\sum_{l=0}^{p-1}{L(al^2+bl+1,p)}</script><p>æ²¡ä»€ä¹ˆå…¶ä»–æ€è·¯ï¼Œä¸è¿‡ç¬¬ä¸€è½®påªæœ‰8bitæ‰€ä»¥å¯ä»¥å…ˆç”¨æ¬§æ‹‰åˆ¤åˆ«å¼æš´åŠ›è®¡ç®—ä¸€éï¼Œç„¶åä¼šå‘ç°ä¸€ä¸ªå¾ˆå·§çš„äº‹å®ï¼š</p>
<p>å¯¹äºæ‰€æœ‰çš„ $ l \in [0,p-1]$ï¼Œéƒ½æœ‰al^2+bl+1æ˜¯æ¨¡pä¸‹çš„äºŒæ¬¡å‰©ä½™ã€‚å¤šåˆ‡å‡ ç»„æ•°å­—ä¹Ÿæ˜¯è¿™æ ·çš„ã€‚</p>
<p>é‚£è¿™éš¾é“æ˜¯ä¸ªä»€ä¹ˆç»“è®ºå—ï¼Ÿå¹¶ä¸æ˜¯ã€‚å› ä¸ºå¦‚æœè‡ªå·±ç”Ÿæˆä¸€ç»„aã€bã€pçš„è¯ï¼ŒåŸºæœ¬ä¸Šæ˜¯æ»¡è¶³ä¸äº†è¿™ä¸ªç»“è®ºçš„ã€‚è¯´æ˜è¿™ä¸ªaã€bã€pè‚¯å®šæ˜¯å–çš„æ»¡è¶³æŸä¸ªæ€§è´¨çš„ç‰¹æ®Šå€¼ã€‚ç»è¿‡æµ‹è¯•å‘ç°ï¼šç»™çš„aã€bå‡æ»¡è¶³aæ˜¯äºŒæ¬¡å‰©ä½™ï¼Œä¸”æ»¡è¶³ä¸‹é¢çš„å®Œå…¨å¹³æ–¹å¼ï¼š</p>
<script type="math/tex; mode=display">
t^2 = a</script><script type="math/tex; mode=display">
ax^2+bx+1 = (tx+1)^2 \quad(mod\;p)</script><p>æµ‹è¯•è„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a,b,c,p = <span class="number">1809</span>,<span class="number">204</span>,<span class="number">1</span>,<span class="number">191</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">f = x^<span class="number">2</span> - a</span><br><span class="line">t = f.roots()</span><br><span class="line"></span><br><span class="line"><span class="comment">#ax^2+bx+1 -&gt; (tx+1)^2</span></span><br><span class="line"><span class="built_in">print</span>(b%p)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> t:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">int</span>(i[<span class="number">0</span>])*<span class="number">2</span>%p)</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥æ‰æœ‰ä¸ºä»€ä¹ˆå…¨éƒ¨éƒ½æ˜¯äºŒæ¬¡å‰©ä½™ã€‚é‚£ä¹ˆç…§è¿™æ ·æ¥è¯´æˆ‘ä»¬æ¯æ¬¡ä¼ 0ç»™é¶æœºå°±å¥½ã€‚</p>
<p>ä½†æ˜¯å®é™…ä¸Šå¹¶ä¸æ˜¯è¿™æ ·çš„ï¼Œæµ‹è¯•å‡ºæ¥éœ€è¦æ¯æ¬¡ä¼ p-1ç»™é¶æœºï¼Œä¸çŸ¥é“æ˜¯ä¾‹å­ç»™é”™äº†è¿˜æ˜¯ä»€ä¹ˆæƒ…å†µï¼Œåæ­£é¢˜ç›®è‚¯å®šæ˜¯æœ‰ç‚¹å°é—®é¢˜ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#part1 proof		</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>():</span><br><span class="line">	table = string.digits + string.ascii_letters</span><br><span class="line">	temp = r.recvuntil(<span class="string">b&quot;sha256(XXXX+&quot;</span>)</span><br><span class="line">	temp = r.recvline()</span><br><span class="line">	suffix = temp[:<span class="number">16</span>].decode()</span><br><span class="line">	hex1 = temp[<span class="number">20</span>:].strip().decode()</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> tqdm(table):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> table:</span><br><span class="line">			<span class="keyword">for</span> k <span class="keyword">in</span> table:</span><br><span class="line">				<span class="keyword">for</span> m <span class="keyword">in</span> table:</span><br><span class="line">					temp1 = i+j+k+m</span><br><span class="line">					<span class="keyword">if</span>(sha256((temp1+suffix).encode()).hexdigest() == hex1):</span><br><span class="line">						r.sendline(temp1.encode())</span><br><span class="line">						<span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;59.110.20.54&quot;</span>,<span class="number">3042</span>)</span><br><span class="line">proof_of_work()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#part2 calculate</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_coeffcients</span>(<span class="params">expression</span>):</span><br><span class="line">	<span class="comment"># å®šä¹‰åŒ¹é…ç³»æ•°çš„æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">    pattern = re.<span class="built_in">compile</span>(<span class="string">r&#x27;(-?\d+)\s*\*\s*l\*\*2|(-?\d+)\s*\*\s*l|(-?\d+)&#x27;</span>)</span><br><span class="line">    <span class="comment"># ä½¿ç”¨findallæ–¹æ³•æ‰¾åˆ°åŒ¹é…çš„æ‰€æœ‰é¡¹</span></span><br><span class="line">    matches = pattern.findall(expression)</span><br><span class="line">    <span class="comment"># å°†åŒ¹é…ç»“æœè½¬æ¢ä¸ºæ•´æ•°å¹¶å­˜å‚¨åœ¨åˆ—è¡¨ä¸­</span></span><br><span class="line">    coefficients = [<span class="built_in">int</span>(<span class="keyword">match</span>[<span class="number">0</span>] <span class="keyword">or</span> <span class="keyword">match</span>[<span class="number">1</span>] <span class="keyword">or</span> <span class="keyword">match</span>[<span class="number">2</span>]) <span class="keyword">for</span> <span class="keyword">match</span> <span class="keyword">in</span> matches]</span><br><span class="line">    <span class="keyword">return</span> coefficients</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_p</span>(<span class="params">equation</span>):</span><br><span class="line">    pattern = re.<span class="built_in">compile</span>(<span class="string">r&#x27;\b\d+\b&#x27;</span>)</span><br><span class="line">    <span class="comment"># ä½¿ç”¨searchæ–¹æ³•æ‰¾åˆ°åŒ¹é…çš„ç¬¬ä¸€ä¸ªæ•°å­—</span></span><br><span class="line">    <span class="keyword">match</span> = pattern.search(equation)</span><br><span class="line">    p_value = <span class="built_in">int</span>(<span class="keyword">match</span>.group())</span><br><span class="line">    <span class="keyword">return</span> p_value</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&quot;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):	</span><br><span class="line">	r.recvuntil(<span class="string">b&quot;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||&quot;</span>)</span><br><span class="line">	r.recvline()</span><br><span class="line">	r.recvline()	</span><br><span class="line">	temp = r.recvline().strip().decode()		</span><br><span class="line">	a,b,c = find_coeffcients(temp)</span><br><span class="line">	p = find_p(r.recvline().strip().decode())</span><br><span class="line">	<span class="comment">#print(&quot;a,b,c,p = &quot;+str(a)+&quot;,&quot;+str(b)+&quot;,&quot;+str(c)+&quot;,&quot;+str(p))</span></span><br><span class="line">	r.recvuntil(<span class="string">b&quot;&gt; Type your answer:&quot;</span>)</span><br><span class="line">	r.sendline(<span class="built_in">str</span>(p-<span class="number">1</span>).encode())</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line"><span class="built_in">print</span>(r.recvline())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;G00d!_u_4r3_Qu33n_0f_Quadratic&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h4><p>é¢˜ç›®ä¹‹åè¿›è¡Œäº†updateï¼Œå¯¹Lå‡½æ•°ä½œäº†è¯¦ç»†è¯´æ˜ï¼Œä¹Ÿå°±æ˜¯å‹’è®©å¾·ç¬¦å·ï¼š</p>
<script type="math/tex; mode=display">
\begin{equation}
L(a,p)=\left\{
    \begin{aligned}
    0 \quad aæ˜¯æ¨¡pä¸‹çš„æŸä¸ªå› å­\\
    1 \quad aæ˜¯æ¨¡pä¸‹çš„äºŒæ¬¡å‰©ä½™\\
    -1 \quad aæ˜¯æ¨¡pä¸‹äºŒæ¬¡éå‰©ä½™\\
    \end{aligned}
    \right
    .
\end{equation}</script><p>é‚£ä¹ˆå†çœ‹ä¹‹å‰é¢˜ç›®çš„ä¾‹å­å°±æ²¡é—®é¢˜äº†ï¼Œå›ä¼ p-1ä¹Ÿæ˜¯æ­£ç¡®çš„ã€‚ç„¶åé¢˜ç›®æ›´æ–°åè¿˜åšäº†å¦‚ä¸‹ä¿®æ”¹ï¼š</p>
<ul>
<li>æ¯ä¸€è½®çš„péƒ½å–äº†1000bitä»¥ä¸Šçš„å¤§æ•°</li>
<li>å¢åŠ äº†ä¸‰è½®ï¼Œç°åœ¨éœ€è¦é€šè¿‡åè½®æ‰æœ‰flag</li>
<li>aã€bã€pä¸å†å…¨éƒ¨æ˜¯ç‰¹æ®Šæ„é€ </li>
</ul>
<p>å½“ç„¶è¿™ä¸ªéœ€è¦åè½®æ˜¯åšå‡ºæ¥æ‰çŸ¥é“çš„ã€‚</p>
<p>ç„¶åæˆ‘çš„åšæ³•ä¹Ÿå¾ˆç®€å•ï¼Œé¦–å…ˆè‡ªå·±ç”Ÿæˆä¸€äº›å°çš„ç´ æ•°è¿›è¡Œæµ‹è¯•ï¼Œæ‰¾æ‰¾è§„å¾‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calcsum</span>(<span class="params">a,b,c,p</span>):</span><br><span class="line">    <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,p):</span><br><span class="line">        temp = a*i**<span class="number">2</span>+b*i+<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(powmod(temp,(p-<span class="number">1</span>)//<span class="number">2</span>,p) == <span class="number">1</span>):</span><br><span class="line">            <span class="built_in">sum</span> += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span>(powmod(temp,(p-<span class="number">1</span>)//<span class="number">2</span>,p) == p-<span class="number">1</span>):</span><br><span class="line">            <span class="built_in">sum</span> += -<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">sum</span> += <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    p = getPrime(<span class="number">18</span>)</span><br><span class="line">    a = random.randint(<span class="number">1</span>,p-<span class="number">1</span>)</span><br><span class="line">    b = random.randint(<span class="number">1</span>,p-<span class="number">1</span>)</span><br><span class="line">    c = <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(powmod(a,(p-<span class="number">1</span>)//<span class="number">2</span>,p),calcsum(a,b,c,p))</span><br></pre></td></tr></table></figure>
<p>ç„¶åå°±ä¼šå‘ç°æµ‹è¯•å‡ºæ¥ï¼ŒLå‡½æ•°çš„æ±‚å’Œç»“æœä»…ä¸aæ˜¯å¦æ˜¯æ¨¡pä¸‹çš„äºŒæ¬¡å‰©ä½™æœ‰å…³ã€‚å¦‚æœaæ˜¯æ¨¡pä¸‹çš„äºŒæ¬¡å‰©ä½™ï¼Œæ±‚å’Œç»“æœä¸º-1ï¼›å¦åˆ™ä¸º1ã€‚</p>
<p>å½“ç„¶è¿˜è¦è€ƒè™‘ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œä¹Ÿå°±æ˜¯updateä¹‹å‰çš„é‚£ç§ç‰¹æ®Šæ„é€ (è™½ç„¶aã€bå¦‚æœæ˜¯çº¯éšæœºçš„è¯è¿™ç§æƒ…å†µåŸºæœ¬ä¸å¤ªå¯èƒ½å‡ºç°ï¼Œä½†æ˜¯å‡ºé¢˜äººç¡®å®åœ¨é¢˜ç›®ä¸­æ„é€ äº†è¿™ä¸ªæƒ…å†µ)ï¼Œæˆ‘ä»¬ç”¨å¦‚ä¸‹æ–¹æ³•æ¥æ ¸éªŒæ˜¯å¦èƒ½æ„æˆå®Œå…¨å¹³æ–¹å¼ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(b*inverse(<span class="number">2</span>,p))**<span class="number">2</span> % p == a%p</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥æˆ‘ä»¬æ¯æ¬¡ç”¨ä»¥ä¸‹æ¡ä»¶è¯­å¥ï¼Œé€‰æ‹©å‘é€å¯¹åº”çš„æ±‚å’Œç»“æœç»™é¶æœºå°±å¥½ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>((b*inverse(<span class="number">2</span>,p))**<span class="number">2</span> % p == a%p):</span><br><span class="line">	res = p-<span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span>(<span class="built_in">pow</span>(a,(p-<span class="number">1</span>)//<span class="number">2</span>,p) == <span class="number">1</span>):</span><br><span class="line">	res = -<span class="number">1</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	res = <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#part1 proof		</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>():</span><br><span class="line">	table = string.digits + string.ascii_letters</span><br><span class="line">	temp = r.recvuntil(<span class="string">b&quot;sha256(XXXX+&quot;</span>)</span><br><span class="line">	temp = r.recvline()</span><br><span class="line">	suffix = temp[:<span class="number">16</span>].decode()</span><br><span class="line">	hex1 = temp[<span class="number">20</span>:].strip().decode()</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> tqdm(table):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> table:</span><br><span class="line">			<span class="keyword">for</span> k <span class="keyword">in</span> table:</span><br><span class="line">				<span class="keyword">for</span> m <span class="keyword">in</span> table:</span><br><span class="line">					temp1 = i+j+k+m</span><br><span class="line">					<span class="keyword">if</span>(sha256((temp1+suffix).encode()).hexdigest() == hex1):</span><br><span class="line">						r.sendline(temp1.encode())</span><br><span class="line">						<span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;59.110.20.54&quot;</span>,<span class="number">3042</span>)</span><br><span class="line">proof_of_work()</span><br><span class="line"></span><br><span class="line"><span class="comment">#part2 calculate</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_coeffcients</span>(<span class="params">expression</span>):</span><br><span class="line">	<span class="comment"># å®šä¹‰åŒ¹é…ç³»æ•°çš„æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">	pattern = re.<span class="built_in">compile</span>(<span class="string">r&#x27;(-?\d+)\s*\*\s*l\*\*2|(-?\d+)\s*\*\s*l|(-?\d+)&#x27;</span>)</span><br><span class="line">	<span class="comment"># ä½¿ç”¨findallæ–¹æ³•æ‰¾åˆ°åŒ¹é…çš„æ‰€æœ‰é¡¹</span></span><br><span class="line">	matches = pattern.findall(expression)</span><br><span class="line">	<span class="comment"># å°†åŒ¹é…ç»“æœè½¬æ¢ä¸ºæ•´æ•°å¹¶å­˜å‚¨åœ¨åˆ—è¡¨ä¸­</span></span><br><span class="line">	coefficients = [<span class="built_in">int</span>(<span class="keyword">match</span>[<span class="number">0</span>] <span class="keyword">or</span> <span class="keyword">match</span>[<span class="number">1</span>] <span class="keyword">or</span> <span class="keyword">match</span>[<span class="number">2</span>]) <span class="keyword">for</span> <span class="keyword">match</span> <span class="keyword">in</span> matches]</span><br><span class="line">	<span class="keyword">return</span> coefficients</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_p</span>(<span class="params">equation</span>):</span><br><span class="line">	pattern = re.<span class="built_in">compile</span>(<span class="string">r&#x27;\b\d+\b&#x27;</span>)</span><br><span class="line">	<span class="comment"># ä½¿ç”¨searchæ–¹æ³•æ‰¾åˆ°åŒ¹é…çš„ç¬¬ä¸€ä¸ªæ•°å­—</span></span><br><span class="line">	<span class="keyword">match</span> = pattern.search(equation)</span><br><span class="line">	p_value = <span class="built_in">int</span>(<span class="keyword">match</span>.group())</span><br><span class="line">	<span class="keyword">return</span> p_value</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&quot;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">10</span>):	</span><br><span class="line">	r.recvuntil(<span class="string">b&quot;|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||&quot;</span>)</span><br><span class="line">	r.recvline()</span><br><span class="line">	r.recvline()	</span><br><span class="line">	temp = r.recvline().strip().decode()</span><br><span class="line">	</span><br><span class="line">	a,b,c = find_coeffcients(temp)</span><br><span class="line">	p = find_p(r.recvline().strip().decode())</span><br><span class="line">	<span class="comment">#print(&quot;a,b,c,p = &quot;+str(a)+&quot;,&quot;+str(b)+&quot;,&quot;+str(c)+&quot;,&quot;+str(p))</span></span><br><span class="line">	r.recvuntil(<span class="string">b&quot;&gt; Type your answer:&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span>((b*inverse(<span class="number">2</span>,p))**<span class="number">2</span> % p == a%p):</span><br><span class="line">		res = p-<span class="number">1</span></span><br><span class="line">	<span class="keyword">elif</span>(<span class="built_in">pow</span>(a,(p-<span class="number">1</span>)//<span class="number">2</span>,p) == <span class="number">1</span>):</span><br><span class="line">		res = -<span class="number">1</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		res = <span class="number">1</span></span><br><span class="line">	r.sendline(<span class="built_in">str</span>(res).encode())</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line"><span class="built_in">print</span>(r.recvline())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;G00d!_u_4r3_Qu33n_0f_Quadratic&#125;</span></span><br></pre></td></tr></table></figure>
<p>å½“ç„¶ï¼Œé¢˜åšå®Œäº†è¿˜æ˜¯è¦æƒ³æƒ³ï¼Œæ’é™¤æ‰èƒ½æ„æˆå®Œå…¨å¹³æ–¹å¼çš„ç‰¹æ®Šæƒ…å†µåï¼Œä¸ºä»€ä¹ˆè¿™ä¸ªæ±‚å’Œç»“æœåªä¸aæ˜¯å¦æ˜¯æ¨¡pä¸‹çš„äºŒæ¬¡å‰©ä½™æœ‰å…³ã€‚è¿™ä¸ªé—®é¢˜æŠ½è±¡å‡ºæ¥å…¶å®å°±æ˜¯å‹’è®©å¾·ç¬¦å·æ±‚å’Œï¼Œäºæ˜¯æœç´¢å…³é”®è¯å¯ä»¥æœç´¢åˆ°ä¸‹é¢è¿™ç¯‡æ–‡ç« ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://imomath.com/index.cgi?page=quadraticCongruencesSumsLegendreSymbols">https://imomath.com/index.cgi?page=quadraticCongruencesSumsLegendreSymbols</a></p>
<p>è¿™é‡Œé˜è¿°ä¸€ä¸‹ä»–çš„è¯æ˜æ€è·¯ã€‚</p>
<h5 id="é¢„å¤‡çŸ¥è¯†"><a href="#é¢„å¤‡çŸ¥è¯†" class="headerlink" title="é¢„å¤‡çŸ¥è¯†"></a>é¢„å¤‡çŸ¥è¯†</h5><p>é¦–å…ˆéœ€è¦çŸ¥é“ä¸€ä¸ªå¼•ç†ï¼š</p>
<blockquote>
<p>å»é™¤0ï¼Œæ¨¡pçš„å®Œå…¨å‰©ä½™ç³»ä¸­æœ‰(p-1)/2ä¸ªäºŒæ¬¡å‰©ä½™ï¼Œæœ‰(p-1)/2ä¸ªäºŒæ¬¡éå‰©ä½™</p>
</blockquote>
<p>è¿™ä¸ªå¼•ç†çš„è¯æ˜ä¹Ÿå¾ˆç®€å•ï¼Œé¦–å…ˆçŸ¥é“ï¼š</p>
<script type="math/tex; mode=display">
å¯¹äº \forall x \in(0,p),(\frac{x^2}{p}) = 1</script><p>ä¹Ÿå°±æ˜¯x^2å½¢å¼çš„æ•°å‡ä¸ºäºŒæ¬¡å‰©ä½™ï¼Œè¿™æ ·ä¹Ÿèƒ½æ±‚å‡ºæ¨¡pä¸‹çš„å…¨éƒ¨äºŒæ¬¡å‰©ä½™ã€‚è€Œç”±äº(p-x)^2å’Œx^2æ¨¡pä¸‹ç›¸åŒï¼Œå› æ­¤å¯ä»¥ä¸¤ä¸¤é…å¯¹ï¼Œä¹Ÿå°±æ˜¯æ¨¡pçš„å®Œå…¨å‰©ä½™ç³»ä¸‹å…±æœ‰(p-1)/2ä¸ªäºŒæ¬¡å‰©ä½™ï¼Œå‰©ä¸‹çš„(p-1)/2ä¸ªæ•°è‡ªç„¶ä¹Ÿå°±æ˜¯äºŒæ¬¡éå‰©ä½™ã€‚</p>
<p>æœ‰äº†è¿™ä¸ªå¼•ç†åï¼Œæˆ‘ä»¬å…ˆä»æœ€ç®€å•çš„æƒ…å†µå¼€å§‹ï¼Œè€ƒè™‘å¯¹å¦‚ä¸‹å½¢å¼çš„f(x)æ±‚å‹’è®©å¾·ç¬¦å·çš„å’Œï¼š</p>
<script type="math/tex; mode=display">
f(x) = ax+b</script><script type="math/tex; mode=display">
sum = \sum_{x=0}^{p-1}(\frac{f(x)}{p})</script><p>æ˜¾ç„¶ï¼Œç”±äºax+bä¹Ÿæ„æˆæ¨¡pä¸‹çš„å®Œå…¨å‰©ä½™ç³»ï¼Œæ‰€ä»¥åŒæ ·æœ‰(p-1)/2ä¸ªxä½¿å¾—f(x)æ˜¯äºŒæ¬¡å‰©ä½™ï¼Œ(p-1)/2ä¸ªxä½¿å¾—f(x)æ˜¯äºŒæ¬¡éå‰©ä½™ï¼Œç„¶åè¿˜æœ‰ä¸€ä¸ªxä½¿å¾—f(x)ä¸º0ï¼Œå› æ­¤æ±‚å’Œç»“æœæ˜¯ï¼š</p>
<script type="math/tex; mode=display">
sum = \sum_{x=0}^{p-1}(\frac{f(x)}{p}) = 1*\frac{p-1}{2}+(-1)*\frac{p-1}{2}+0 = 0</script><h5 id="å›åˆ°é¢˜ç›®"><a href="#å›åˆ°é¢˜ç›®" class="headerlink" title="å›åˆ°é¢˜ç›®"></a>å›åˆ°é¢˜ç›®</h5><p>ç„¶åå›åˆ°æˆ‘ä»¬æ±‚å‹’è®©å¾·ç¬¦å·å’Œçš„f(x)å½¢å¼ï¼Œä¹Ÿå°±æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
f(x) = ax^2+bx+c</script><script type="math/tex; mode=display">
sum = \sum_{x=0}^{p-1}(\frac{f(x)}{p})</script><p>é‚£ä¹ˆé¦–å…ˆå¯¹f(x)è¿›è¡Œä¸€ç‚¹å¤„ç†ï¼Œç”±äºï¼š</p>
<script type="math/tex; mode=display">
4af(x) = 4ax^2+4abx+4ac = (2ax+b)^2 - (b^2 - 4ac)</script><p>é‚£ä¹ˆå¯¹äºf(x)çš„å‹’è®©å¾·ç¬¦å·æœ‰ï¼š</p>
<script type="math/tex; mode=display">
(\frac{4af(x)}{p}) = (\frac{4a}{p})(\frac{f(x)}{p})</script><p>æ‰€ä»¥å¯¹äºæˆ‘ä»¬éœ€è¦æ±‚çš„å’Œsumï¼Œå¯ä»¥å†™ä½œï¼š</p>
<script type="math/tex; mode=display">
\sum_{x=0}^{p-1}(\frac{4af(x)}{p}) = (\frac{4a}{p})\sum_{x=0}^{p-1}(\frac{f(x)}{p})</script><p>ç§»é¡¹å°±å¾—åˆ°(ç§»é¡¹åŸºäºå‹’è®©å¾·ç¬¦å·åªæœ‰1ã€-1ã€0ä¸‰ä¸ªå–å€¼)ï¼š</p>
<script type="math/tex; mode=display">
sum = \sum_{x=0}^{p-1}(\frac{f(x)}{p}) = (\frac{4a}{p})\sum_{x=0}^{p-1}(\frac{4af(x)}{p})
=
(\frac{4a}{p})\sum_{x=0}^{p-1}(\frac{(2ax+b)^2 - (b^2 - 4ac)}{p})</script><p>è€Œä¹‹æ‰€ä»¥è¦æŠŠxåŒ–æˆè¿™ä¸ªå½¢å¼ï¼Œæ˜¯å› ä¸ºè¿™æ ·å¯ä»¥å‘ç°ï¼š2ax+bä¹Ÿæ„æˆäº†æ¨¡pä¸‹çš„å®Œå…¨å‰©ä½™ç³»ï¼Œæ‰€ä»¥å…¶å®(2ax+b)^2æ•ˆæœå’Œx^2ç›¸åŒï¼Œç„¶åæˆ‘ä»¬æŠŠb^2-4acè®°ä½œD(å°±åƒäºŒæ¬¡å‡½æ•°çš„åˆ¤åˆ«å¼)ï¼Œï¼Œå¹¶ä¸”ï¼Œç”±äºå‹’è®©å¾·ç¬¦å·çš„å®Œå…¨ç§¯æ€§ï¼Œ(4a,p)=(a,p)ï¼Œå› æ­¤sumçš„è¡¨è¾¾å¼å¯ä»¥è¿›ä¸€æ­¥ç®€åŒ–ä¸ºï¼š</p>
<script type="math/tex; mode=display">
sum = (\frac{a}{p})\sum_{x=0}^{p-1}(\frac{x^2 - D}{p})</script><p>é‚£ä¹ˆé—®é¢˜å°±ç®€åŒ–æˆäº†æ±‚è§£å‡ºä¸‹é¢è¿™ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼š</p>
<script type="math/tex; mode=display">
\sum_{x=0}^{p-1}(\frac{x^2 - D}{p})</script><p>ç„¶åè¦æ±‚è§£è¿™ä¸ªå¼å­åˆéœ€è¦å¼•å…¥ä¸€ä¸ªå®šç†ï¼Œè¿™é‡Œæˆ‘ç›´æ¥æˆªå›¾ï¼š</p>
<p><img src="/post/6f77578c/image-20231113142925845.png" alt="image-20231113142925845"></p>
<p>è¿™ä¸ªå®šç†å¯¹æˆ‘ä»¬ç°åœ¨æ¨å¯¼çš„è´¡çŒ®æ˜¯ï¼Œä»–å‘Šè¯‰æˆ‘ä»¬ä»¥ä¸‹å¼å­çš„å€¼ä¸ºï¼š</p>
<script type="math/tex; mode=display">
\sum_{x=0}^{p-1}(\frac{x^2 - D}{p}) \equiv -1 \quad(mod\;p)</script><p>è€Œç”±äºå‹’è®©å¾·ç¬¦å·åªæœ‰1ã€-1ã€0ä¸‰ä¸ªå–å€¼ï¼Œæ‰€ä»¥å°±æœ‰ï¼š</p>
<script type="math/tex; mode=display">
\sum_{x=0}^{p-1}(\frac{x^2 - D}{p}) = -1 æˆ–p-1</script><p>é‚£å€¼åœ¨ä»€ä¹ˆæ—¶å€™ä¼šåˆ†åˆ«å–åˆ°-1å’Œp-1å‘¢ï¼Ÿå¯ä»¥æƒ³åˆ°ï¼Œå¦‚æœç­‰äºp-1ï¼Œé‚£ä¹ˆå¯¹é™¤äº†x^2-Dé›¶ç‚¹ä»¥å¤–çš„æ‰€æœ‰xï¼Œéƒ½æœ‰ï¼š</p>
<script type="math/tex; mode=display">
(\frac{x^2 - D}{p}) = 1</script><p>è¿™ä¹Ÿå°±æ˜¯è¯´æ‰€æœ‰x^-Déƒ½æ˜¯æ¨¡pä¸‹çš„äºŒæ¬¡å‰©ä½™ï¼Œå› æ­¤åªå¯èƒ½Dæ˜¯pçš„å€æ•°ã€‚è€Œæ­¤å¤–çš„å…¶ä»–æƒ…å†µå°±æœ‰ï¼š</p>
<script type="math/tex; mode=display">
\sum_{x=0}^{p-1}(\frac{x^2 - D}{p}) = -1</script><p>ç„¶åç”±ä¹‹å‰çš„æ¨å¯¼æœ‰ï¼š</p>
<script type="math/tex; mode=display">
sum = (\frac{a}{p})\sum_{x=0}^{p-1}(\frac{x^2 - D}{p})</script><p>æ‰€ä»¥å†æ’é™¤äº†èƒ½æ„æˆå®Œå…¨å¹³æ–¹å¼çš„æƒ…å†µåï¼Œæˆ‘ä»¬åªéœ€è¦åˆ¤æ–­aæ˜¯å¦æ˜¯æ¨¡pä¸‹çš„äºŒæ¬¡å‰©ä½™å°±å¯ä»¥æ±‚è§£sumäº†ã€‚</p>
<p><br></p>
<p><br></p>
<h3 id="Diligent-Liszt"><a href="#Diligent-Liszt" class="headerlink" title="Diligent_Liszt"></a>Diligent_Liszt</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://en.wikipedia.org/wiki/Discrete_logarithm</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp </span><br><span class="line"><span class="keyword">import</span> random </span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"></span><br><span class="line">DEBUG = <span class="literal">False</span></span><br><span class="line"> </span><br><span class="line">flag = <span class="string">b&quot;SYC&#123;Al3XEI_FAKE_FLAG&#125;&quot;</span></span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">b&quot;SYC&quot;</span>)</span><br><span class="line">nbits = <span class="number">512</span></span><br><span class="line">g = <span class="number">3</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_p_1</span>(<span class="params">digit</span>):</span><br><span class="line">    primes = []</span><br><span class="line">    pri = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">len</span>(primes)&lt;<span class="number">100</span>):</span><br><span class="line">        pri = gp.next_prime(pri)</span><br><span class="line">        primes.append(<span class="built_in">int</span>(pri))</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        count = <span class="number">2</span></span><br><span class="line">        <span class="keyword">while</span> count &lt; <span class="number">2</span>**digit:</span><br><span class="line">            count *= random.choice(primes)</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(gp.is_prime(count)):</span><br><span class="line">            <span class="keyword">return</span> count</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">p,q,r = [gen_p_1(nbits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;pqr&quot;</span>] </span><br><span class="line"></span><br><span class="line">n = p*q*r </span><br><span class="line">x = bytes_to_long(flag) </span><br><span class="line">y = gp.powmod(g,x,n) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(p))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;q = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(q))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;r = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(r))   </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;y = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(y)) </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> DEBUG:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;x = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(x)) </span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p = 1068910928091265978478887270179608140018534288604159452828300604294675735481804963679672853224192480667904101881092533866322948043654533322038484907159945421</span></span><br><span class="line"><span class="string">q = 1711302770747802020613711652777299980542669713888988077474955896217408515180094849053961025086865697904731088087532944829046702427480842253022459937172565651</span></span><br><span class="line"><span class="string">r = 132969813572228739353704467775972551435751558645548804253458782569132362201099158857093676816706297676454547299888531536236748314013888413096371966359860637</span></span><br><span class="line"><span class="string">y = 5385116324746699759660077007129548063211490907227715474654765255668507958312745677683558789874078477569613259930365612562164095274660123330458355653249805062678976259429733060364358954180439218947514191603330532117142653558803034110759332447742304749985874760435453594107494324797235909651178472904825071375135846093354526936559640383917210702874692725723836865724807664892994298377375580807917514349966834376413176898806591411038129330967050554114677719107335006266</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ä¸­ä¸‰ä¸ªæ•°å‡æ»¡è¶³p-1å…‰æ»‘ï¼Œé‚£ä¹ˆå¦‚æœä¸ç»™pã€qã€råˆ†åˆ«çš„å€¼ä¹Ÿèƒ½åˆ†è§£å‡ºæ¥ã€‚æ—¢ç„¶ç›´æ¥ç»™äº†ï¼Œé‚£å°±åˆ†å¼€ç”¨pohlig-hellmanæ±‚DLPåå†crtèµ·æ¥å°±å¥½ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"></span><br><span class="line">p = <span class="number">1068910928091265978478887270179608140018534288604159452828300604294675735481804963679672853224192480667904101881092533866322948043654533322038484907159945421</span></span><br><span class="line">q = <span class="number">1711302770747802020613711652777299980542669713888988077474955896217408515180094849053961025086865697904731088087532944829046702427480842253022459937172565651</span></span><br><span class="line">r = <span class="number">132969813572228739353704467775972551435751558645548804253458782569132362201099158857093676816706297676454547299888531536236748314013888413096371966359860637</span></span><br><span class="line">y = <span class="number">5385116324746699759660077007129548063211490907227715474654765255668507958312745677683558789874078477569613259930365612562164095274660123330458355653249805062678976259429733060364358954180439218947514191603330532117142653558803034110759332447742304749985874760435453594107494324797235909651178472904825071375135846093354526936559640383917210702874692725723836865724807664892994298377375580807917514349966834376413176898806591411038129330967050554114677719107335006266</span></span><br><span class="line">g = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">xp = discrete_log(mod(y,p),mod(g,p))</span><br><span class="line">xq = discrete_log(mod(y,q),mod(g,q))</span><br><span class="line">xr = discrete_log(mod(y,r),mod(g,r))</span><br><span class="line"></span><br><span class="line">n = [p-<span class="number">1</span>,q-<span class="number">1</span>,r-<span class="number">1</span>]</span><br><span class="line">c = xp,xq,xr</span><br><span class="line">M = crt(n,c)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(M)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;D1scr3te_L0g_W1th_Mult1pl3_pr1m35&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="card-game"><a href="#card-game" class="headerlink" title="card_game"></a>card_game</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AL3XEIé€ç»™äº†ä½ è¿™ä¸ªæ¸¸æˆçš„å…³é”®æ•°æ®ï¼Œä½ èƒ½é¢„æµ‹æ¥ä¸‹æ¥è¦å‡ºçš„ç‰Œå— nc 59.110.20.54 4953</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> cards <span class="keyword">import</span> Heart, Spade, Club, Diamond</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">choose_card</span>(<span class="params">num</span>):</span><br><span class="line">    x = (num&gt;&gt;<span class="number">5</span>)%<span class="number">4</span></span><br><span class="line">    <span class="keyword">if</span> x == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (Heart[(num&gt;&gt;<span class="number">6</span>)%<span class="number">13</span>]), <span class="string">&#x27;Heart&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> x%<span class="number">4</span> == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> (Spade[(num&gt;&gt;<span class="number">6</span>)%<span class="number">13</span>]), <span class="string">&#x27;Spade&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> x%<span class="number">4</span> == <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> (Diamond[(num&gt;&gt;<span class="number">6</span>)%<span class="number">13</span>]), <span class="string">&#x27;Diamond&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> (Club[(num&gt;&gt;<span class="number">6</span>)%<span class="number">13</span>]), <span class="string">&#x27;Club&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GAME</span>():</span><br><span class="line">    banner = <span class="string">&#x27;&#x27;&#x27; </span></span><br><span class="line"><span class="string"> ####    ##   #####  #####      ####    ##   #    # ###### </span></span><br><span class="line"><span class="string">#    #  #  #  #    # #    #    #    #  #  #  ##  ## #      </span></span><br><span class="line"><span class="string">#      #    # #    # #    #    #      #    # # ## # #####  </span></span><br><span class="line"><span class="string">#      ###### #####  #    #    #  ### ###### #    # #      </span></span><br><span class="line"><span class="string">#    # #    # #   #  #    #    #    # #    # #    # #      </span></span><br><span class="line"><span class="string"> ####  #    # #    # #####      ####  #    # #    # ######</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(banner)</span><br><span class="line"></span><br><span class="line">    meum = <span class="string">&#x27;&#x27;&#x27;option:</span></span><br><span class="line"><span class="string">    1: start game</span></span><br><span class="line"><span class="string">    2: get hint</span></span><br><span class="line"><span class="string">    3: exit</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(meum)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;input your option: &#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        your_input = <span class="built_in">input</span>()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> your_input == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            n = getPrime(<span class="number">36</span>)</span><br><span class="line">            m = getPrime(<span class="number">16</span>)</span><br><span class="line">            c = getPrime(<span class="number">16</span>)</span><br><span class="line">            seed = getPrime(<span class="number">36</span>)</span><br><span class="line">            out = seed</span><br><span class="line">            <span class="built_in">round</span> = <span class="number">0</span></span><br><span class="line">            score = <span class="number">0</span></span><br><span class="line">            res = []</span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                <span class="built_in">round</span> += <span class="number">1</span></span><br><span class="line">                res = []</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;round:<span class="subst">&#123;<span class="built_in">round</span>&#125;</span>&#x27;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;score:<span class="subst">&#123;score&#125;</span>&#x27;</span>)</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">3</span>):</span><br><span class="line">                    out = (out*m+c)%n</span><br><span class="line">                    res.append(out)</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">round</span> == <span class="number">1</span>:</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">                        card, suit = choose_card(i)</span><br><span class="line">                        <span class="built_in">print</span>(card)</span><br><span class="line">                <span class="keyword">elif</span> <span class="built_in">round</span>==<span class="number">2</span> <span class="keyword">or</span> <span class="built_in">round</span>==<span class="number">3</span>:  <span class="comment">#gift</span></span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">                        card, suit = choose_card(i)</span><br><span class="line">                        <span class="built_in">print</span>(card)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&#x27;gift: <span class="subst">&#123;res&#125;</span>&#x27;</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    cards = []</span><br><span class="line">                    suits = []</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(res)):</span><br><span class="line">                        card, suit = choose_card(res[i])</span><br><span class="line">                        cards.append(card)</span><br><span class="line">                        suits.append(suit)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;Give me your guess: (example: Heart_1 Club_2 Diamond_3)&quot;</span>)  </span><br><span class="line">                    <span class="keyword">try</span>:</span><br><span class="line">                        g_1, g_2, g_3 = <span class="built_in">input</span>().split()</span><br><span class="line">                        g_1, g_2, g_3 = g_1.split(<span class="string">&#x27;_&#x27;</span>), g_2.split(<span class="string">&#x27;_&#x27;</span>), g_3.split(<span class="string">&#x27;_&#x27;</span>)</span><br><span class="line">                    <span class="keyword">except</span> ValueError:</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;Please enter in the correct format.&quot;</span>)</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line">                    <span class="keyword">if</span> (g_1[<span class="number">0</span>] == suits[<span class="number">0</span>] <span class="keyword">and</span> g_1[<span class="number">1</span>] == cards[<span class="number">0</span>][<span class="number">15</span>]) <span class="keyword">and</span> (g_2[<span class="number">0</span>] == suits[<span class="number">1</span>] <span class="keyword">and</span> g_2[<span class="number">1</span>] == cards[<span class="number">1</span>][<span class="number">15</span>]) <span class="keyword">and</span> (g_3[<span class="number">0</span>] == suits[<span class="number">2</span>] <span class="keyword">and</span> g_3[<span class="number">1</span>] == cards[<span class="number">2</span>][<span class="number">15</span>]):</span><br><span class="line">                        <span class="keyword">for</span> i <span class="keyword">in</span> cards:</span><br><span class="line">                            <span class="built_in">print</span>(i)</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;Congratulations! You matched the cards!&quot;</span>)</span><br><span class="line">                        score += <span class="number">1</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="keyword">for</span> i <span class="keyword">in</span> cards:</span><br><span class="line">                            <span class="built_in">print</span>(i)</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;Try again!&quot;</span>)</span><br><span class="line">                <span class="keyword">if</span> score == <span class="number">50</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;The flag is your reward!&#x27;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(flag)</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> your_input == <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Have you ever heard of LCG?&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> your_input == <span class="string">&#x27;3&#x27;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    GAME()</span><br></pre></td></tr></table></figure>
<p>cardæ–‡ä»¶æ˜¯ç»™äº†å¾ˆå¤šå¦‚ä¸‹å½¢å¼çš„ç‰Œé¢å­—ç¬¦ä¸²ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span><br><span class="line"><span class="string">â”‚ A       â”‚</span></span><br><span class="line"><span class="string">â”‚         â”‚</span></span><br><span class="line"><span class="string">â”‚    â™¥    â”‚</span></span><br><span class="line"><span class="string">â”‚         â”‚</span></span><br><span class="line"><span class="string">â”‚       A â”‚</span></span><br><span class="line"><span class="string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>æ€»çš„è¯´æ¥ï¼Œé¢˜ç›®ä»£ç å¾ˆé•¿ï¼Œä½†æ˜¯å®é™…ä¸Šä»”ç»†çœ‹å®Œè¿‡åä¼šå‘ç°è€ƒçš„ä¸œè¥¿çœŸçš„å¾ˆç®€å•ï¼Œæˆ‘çŒœå¯èƒ½æ˜¯æœ‰å‡çº§ç‰ˆçš„é¢˜ç›®åœ¨åé¢ï¼Œä¸ç„¶æ„Ÿè§‰æœ‰ç‚¹æµªè´¹ã€‚</p>
<p>ä»»åŠ¡æ˜¯è¿™æ ·çš„ï¼Œé¢˜ç›®ç»™æˆ‘ä»¬æä¾›äº†ä¸‰ä¸ªé€‰é¡¹ï¼Œä½†æ˜¯å…¶å®åªæœ‰è¾“å…¥1æœ‰ç”¨ã€‚è¾“å…¥1åä¼šå‘ç”Ÿï¼š</p>
<ul>
<li>éšæœºç”Ÿæˆnã€mã€cã€seedå››ä¸ªæ•°ï¼Œç”¨è¿™å››ä¸ªæ•°å®ç°ä»¥ä¸‹çš„LCGï¼š</li>
</ul>
<script type="math/tex; mode=display">
x = mx+c \quad(mod\;n)</script><ul>
<li>ç„¶åæ¸¸æˆå¼€å§‹ï¼Œæ¯ä¸€è½®ï¼Œç”¨è¿™ä¸ªLCGç”Ÿæˆä¸‰ä¸ªæ•°ï¼Œå¹¶ç”¨è¿™ä¸‰ä¸ªæ•°è®¡ç®—ç‰Œçš„æ•°å­—å’ŒèŠ±è‰²</li>
<li>åœ¨ç¬¬äºŒè½®å’Œç¬¬ä¸‰è½®ï¼Œä¼šé¢å¤–ç»™å‡ºè¿™ä¸€è½®çš„ä¸‰ä¸ªæ•°çš„å€¼</li>
<li>ä»ç¬¬å››è½®å¼€å§‹ï¼Œè¦æ±‚æˆ‘ä»¬é¢„æµ‹è¿™ä¸€è½®çš„ä¸‰å¼ ç‰Œçš„æ•°å­—å’ŒèŠ±è‰²ï¼Œé¢„æµ‹æ­£ç¡®åˆ™åŠ ä¸€åˆ†ï¼Œåˆ†æ•°è¾¾åˆ°50å°±ç»™flag</li>
</ul>
<p>è€Œæ ¹æ®æ•°å­—å¾—åˆ°ç‰Œçš„è®¡ç®—æ–¹å¼choose_card(num)æ˜¯é¢˜ç›®ç»™äº†æˆ‘ä»¬çš„ï¼Œæ‰€ä»¥ç›®æ ‡å°±æ˜¯å¾—åˆ°LCGçš„æ¯ä¸€è½®çš„ä¸‰ä¸ªæ•°çš„å€¼ã€‚è€Œæˆ‘ä»¬æœ‰ç¬¬äºŒè½®å’Œç¬¬ä¸‰è½®çš„å…±å…­ä¸ªLCGçš„æ•°å­—åºåˆ—ã€‚é‚£ä¹ˆå°±å¯ä»¥å®Œå…¨å¤åŸLCGçš„å„ä¸ªå‚æ•°mã€cã€nï¼Œç„¶åå°±å¾€åé¢„æµ‹å°±å¯ä»¥äº†ã€‚</p>
<p>ç„¶åæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œæ¯ä¸€æ¬¡å‘é€çš„å½¢å¼åº”è¯¥æ˜¯å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(example: Heart_1 Club_2 Diamond_3)</span><br></pre></td></tr></table></figure>
<p>ç„¶åæ³¨æ„åˆ°ä»–çš„ç‰Œçš„æ•°å­—æ˜¯è¿™ä¹ˆå–çš„ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cards[<span class="number">0</span>][<span class="number">15</span>]</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯æ¯å¼ ç‰Œçš„ç¬¬åäº”ä¸ªå­—ç¬¦ã€‚æ¯”å¦‚å¯¹äºAï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span><br><span class="line"><span class="string">â”‚ A       â”‚</span></span><br><span class="line"><span class="string">â”‚         â”‚</span></span><br><span class="line"><span class="string">â”‚    â™¥    â”‚</span></span><br><span class="line"><span class="string">â”‚         â”‚</span></span><br><span class="line"><span class="string">â”‚       A â”‚</span></span><br><span class="line"><span class="string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>ç¬¬åäº”ä¸ªå­—ç¬¦å°±æ°å¥½æ˜¯Aã€‚ç„¶è€Œå¯¹äº10å°±ä¸å¤ªä¸€æ ·äº†ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span><br><span class="line"><span class="string">â”‚10       â”‚</span></span><br><span class="line"><span class="string">â”‚         â”‚</span></span><br><span class="line"><span class="string">â”‚    â™¥    â”‚</span></span><br><span class="line"><span class="string">â”‚         â”‚</span></span><br><span class="line"><span class="string">â”‚       10â”‚</span></span><br><span class="line"><span class="string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>å…¶ç¬¬åäº”ä¸ªå­—ç¬¦åº”è¯¥æ˜¯0ã€‚æ‰€ä»¥è¦ç•™æ„ä¸€ä¸‹è¿™ä¸ªå°ç»†èŠ‚ã€‚ä¸è¿‡å…¶å®æ— ä¼¤å¤§é›…ï¼Œå› ä¸ºå°±ç®—çŒœé”™äº†ä»–ä¹Ÿä¸ä¼šé€€å‡ºï¼Œè€Œè¿˜èƒ½ç»§ç»­çŒœï¼Œæ‰€ä»¥åªè¦å¤Ÿ50åˆ†å°±å¯ä»¥ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> powmod</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_LCG</span>(<span class="params">sequence</span>):</span><br><span class="line">    c1,c2,c3,c4,c5,c6 = sequence</span><br><span class="line"></span><br><span class="line">    t1 = c2-c1</span><br><span class="line">    t2 = c3-c2</span><br><span class="line">    t3 = c4-c3</span><br><span class="line">    t4 = c5-c4</span><br><span class="line">    T1 = t4*t2 - t3*t3</span><br><span class="line">    T2 = t3*t1 - t2*t2</span><br><span class="line">    n = GCD(T1,T2)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">1000</span>):</span><br><span class="line">        <span class="keyword">while</span>(n % i == <span class="number">0</span>):</span><br><span class="line">            n //= i</span><br><span class="line"></span><br><span class="line">    m = inverse((c2-c1),n)*(c3-c2) % n</span><br><span class="line">    c = (-m*c2 + c3) % n</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> m,c,n</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getnext</span>(<span class="params">out,m,c,n</span>):</span><br><span class="line">    next_out = [out[-<span class="number">1</span>]]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        next_out.append((m*next_out[-<span class="number">1</span>]+c)%n)</span><br><span class="line">    <span class="keyword">return</span> next_out[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_card</span>(<span class="params">out</span>):</span><br><span class="line">    table_num = [<span class="string">&quot;A&quot;</span>,<span class="string">&quot;2&quot;</span>,<span class="string">&quot;3&quot;</span>,<span class="string">&quot;4&quot;</span>,<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;7&quot;</span>,<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>,<span class="string">&quot;0&quot;</span>,<span class="string">&quot;J&quot;</span>,<span class="string">&quot;Q&quot;</span>,<span class="string">&quot;K&quot;</span>]</span><br><span class="line">    table_suits = [<span class="string">&#x27;Heart&#x27;</span>,<span class="string">&#x27;Spade&#x27;</span>,<span class="string">&#x27;Diamond&#x27;</span>,<span class="string">&#x27;Club&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    res = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> out:</span><br><span class="line">        suits_order = (i &gt;&gt; <span class="number">5</span>) % <span class="number">4</span></span><br><span class="line">        num_order = (i &gt;&gt; <span class="number">6</span>) % <span class="number">13</span></span><br><span class="line">        res += (table_suits[suits_order] + <span class="string">&quot;_&quot;</span> + table_num[num_order] + <span class="string">&quot; &quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">    </span><br><span class="line">sequence = []</span><br><span class="line">r = remote(<span class="string">&quot;59.110.20.54&quot;</span>,<span class="number">4953</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&quot;input your option:&quot;</span>)</span><br><span class="line">r.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&quot;gift: &quot;</span>)</span><br><span class="line">sequence += <span class="built_in">eval</span>(r.recvline().decode().strip())</span><br><span class="line">r.recvuntil(<span class="string">b&quot;gift: &quot;</span>)</span><br><span class="line">sequence += <span class="built_in">eval</span>(r.recvline().decode().strip())</span><br><span class="line">m,c,n = solve_LCG(sequence)</span><br><span class="line">out = getnext(sequence,m,c,n)</span><br><span class="line">res = gen_card(out)</span><br><span class="line">r.recvuntil(<span class="string">b&quot;(example: Heart_1 Club_2 Diamond_3)&quot;</span>)</span><br><span class="line">r.sendline(res.encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">49</span>):</span><br><span class="line">    out = getnext(out,m,c,n)</span><br><span class="line">    res = gen_card(out)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;(example: Heart_1 Club_2 Diamond_3)&quot;</span>)</span><br><span class="line">    r.sendline(res.encode())</span><br><span class="line">r.recvuntil(<span class="string">b&quot;The flag is your reward!&quot;</span>)</span><br><span class="line">r.recvline()</span><br><span class="line"><span class="built_in">print</span>(r.recvline())</span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;lcg_a@@@@@ttack&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h2 id="Week-4"><a href="#Week-4" class="headerlink" title="Week 4"></a>Week 4</h2><h3 id="EzComplex"><a href="#EzComplex" class="headerlink" title="EzComplex"></a>EzComplex</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">And u, my friend:  Complex factors! (In a double sense)</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage9.3</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">b&#x27;FAKE&#123;Do_You_know_Complex_numbers&#125;&#x27;</span></span><br><span class="line">p = random_prime(<span class="number">1</span> &lt;&lt; <span class="number">384</span>)</span><br><span class="line">q = random_prime(<span class="number">1</span> &lt;&lt; <span class="number">384</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">N = <span class="built_in">pow</span>(p, <span class="number">2</span>) + <span class="built_in">pow</span>(q, <span class="number">2</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(N)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">122977267154486898127643454001467185956864368276013342450998567212966113302012584153291519651365278888605594000436279106907163024162771486315220072170917153855370362692990814276908399943293854077912175867886513964032241638851526276</span></span><br><span class="line"><span class="string">973990451943921675425625260267293227445098713194663380695161260771362036776671793195525239267004528550439258233703798932349677698127549891815995206853756301593324349871567926792912475619794804691721625860861059975526781239293017498</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ç»™äº†ä¸€ä¸ªé¢å¤–ä¿¡æ¯Nå¦‚ä¸‹ï¼Œè¦æ±‚ç»™å‡ºnçš„åˆ†è§£ï¼š</p>
<script type="math/tex; mode=display">
N = p^2 + q^2</script><p>ç»“åˆé¢˜ç›®åå­—complexï¼Œå¯ä»¥æŠŠè¿™ä¸ªæ•°å­—æ”¾åœ¨å¤æ•°åŸŸä¸­åˆ†è§£ï¼Œè¿™æ˜¯å› ä¸ºï¼š</p>
<script type="math/tex; mode=display">
N = (p+qi)(p-qi)</script><p>å› æ­¤åœ¨å¤æ•°åŸŸä¸­åˆ†è§£ï¼Œå¹¶éå†æ‰€æœ‰å¯èƒ½çš„å› å­å°±èƒ½å¾—åˆ°på’Œqã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = <span class="number">122977267154486898127643454001467185956864368276013342450998567212966113302012584153291519651365278888605594000436279106907163024162771486315220072170917153855370362692990814276908399943293854077912175867886513964032241638851526276</span></span><br><span class="line">N = <span class="number">973990451943921675425625260267293227445098713194663380695161260771362036776671793195525239267004528550439258233703798932349677698127549891815995206853756301593324349871567926792912475619794804691721625860861059975526781239293017498</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">zn = ZZ[i](N)</span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> divisors(zn):</span><br><span class="line">    p = <span class="built_in">int</span>(d[<span class="number">0</span>])</span><br><span class="line">    q = <span class="built_in">int</span>(d[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">if</span> isPrime(p) <span class="keyword">and</span> isPrime(q) <span class="keyword">and</span> p.bit_length() &gt; <span class="number">380</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">n  = p*q</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n))))</span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;D0_you_like_r41n?_i_pref3r_R1_ng&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="ext-7gcd"><a href="#ext-7gcd" class="headerlink" title="ext^7gcd"></a>ext^7gcd</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é¢˜ç›®é“¾æ¥ï¼šnc 59.110.20.54:1789 ï¼ˆä¸‹sagemath! ä¸ä¸‹çš„ç»Ÿç»Ÿå‘é…åˆ°å®‰ä¸œæ˜Ÿå½“å˜¿å¥´ï¼ï¼‰</span><br></pre></td></tr></table></figure>
<p>åˆæ˜¯ä¸€ä¸ªæ²¡æœ‰é™„ä»¶çš„é¢˜ç›®ï¼Œé€šè¿‡proofåæˆ‘ä»¬å¯ä»¥çœ‹è§é¢˜ç›®å†…å®¹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||</span><br><span class="line"></span><br><span class="line">Hi Crypto-ers! AL3XEI here. Solving extended gcd over <span class="number">2</span> primes can be easy, but what about <span class="number">7</span> primes?</span><br><span class="line">primes : [<span class="number">938770989594038574883307091377</span>, <span class="number">731124780451059048515699872973</span>, <span class="number">705906522337130351303390881793</span>, <span class="number">1259253321424214851154594220511</span>, <span class="number">638192849150199238389371476021</span>, <span class="number">1160157641563492827848830377527</span>, <span class="number">1225294646722407790694425867847</span>] ( <span class="number">100</span> bits )</span><br><span class="line">Give me a0,...a5,a6:</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®æ„æ€ä¹Ÿå¾ˆæ˜ç¡®ï¼Œè¦æ±‚æˆ‘ä»¬å¯¹7ä¸ªç´ æ•°æ±‚å‡ºæ‰©å±•æ¬§å‡ é‡Œå¾—çš„ç»“æœï¼Œä¹Ÿå°±æ˜¯æ‰¾åˆ°a0ã€a1ã€â€¦a6æ»¡è¶³ï¼š</p>
<script type="math/tex; mode=display">
\sum_{i=0}^{6}{a_ip_i} = d</script><p>å…¶ä¸­dæ˜¯7ä¸ªç´ æ•°çš„æœ€å¤§å…¬çº¦æ•°ï¼Œæ‰€ä»¥ä¹Ÿå°±æ˜¯1ã€‚å¹¶ä¸”ç»æµ‹è¯•æ˜¯ä¸èƒ½å‘é€0ç»™é¶æœºçš„ã€‚</p>
<p>æˆ‘çš„åšæ³•ä¹Ÿå¾ˆç®€å•ï¼Œé¦–å…ˆå¯¹å‰å…­ä¸ªæ•°ä¸¤ä¸¤ä½¿ç”¨exgcdï¼Œä½¿å¾—ï¼š</p>
<script type="math/tex; mode=display">
a_1p_1 + b_1p_2 = 1</script><script type="math/tex; mode=display">
a_2p_3 + b_2p_4 = 1</script><script type="math/tex; mode=display">
a_3p_5 + b_3p_6 = 1</script><p>æ‰€ä»¥å°±æœ‰ï¼š</p>
<script type="math/tex; mode=display">
(a_1p_1 + b_1p_2) + (a_2p_3 + b_2p_4) + (a_3p_5 + b_3p_6) = 3</script><p>ç„¶åå†å°†3ä¸æœ€åä¸€ä¸ªç´ æ•°åšexgcdï¼Œå°±æœ‰ï¼š</p>
<script type="math/tex; mode=display">
a_4((a_1p_1 + b_1p_2) + (a_2p_3 + b_2p_4) + (a_3p_5 + b_3p_6)) + b_4p_7 = 1</script><p>å°†å¯¹åº”ç³»æ•°å‘é€è¿‡å»å³å¯ã€‚æµ‹è¯•åçŸ¥é“å…±æœ‰15è½®æŒ‘æˆ˜ï¼Œå¹¶ä¸”å‘é€çš„æ ¼å¼æ˜¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a,b,c,d,e,f,g</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯åˆ—è¡¨ä¸å¸¦ä¸¤è¾¹æ‹¬å·çš„å½¢å¼ã€‚</p>
<p>ç„¶åå¦‚æœé™åˆ¶åªæœ‰ä¸èƒ½å‘é€0çš„è¯ï¼Œé‚£ä¹ˆæ–¹æ³•å¤ªå¤šå¤ªå¤šäº†ã€‚æ¯”å¦‚æƒ³ä¸ªç®€å•ä¸€ç‚¹çš„å…ˆè®©åå…­ä¸ªaä¸º1ï¼Œç„¶åæŠŠåå…­ä¸ªç´ æ•°çš„å’Œä¸ç¬¬ä¸€ä¸ªç´ æ•°åšexgcdå³å¯ã€‚å†éº»çƒ¦ä¸€ç‚¹ï¼Œç”šè‡³å¯ä»¥æ„é€ ä¸€ä¸ªä¸‹é¢è¿™æ ·çš„æ ¼ï¼š</p>
<script type="math/tex; mode=display">
L=
\left(\begin{matrix}
-K & & & & &  & & \\
Kp_1 & 1& & & &  & & \\
Kp_2 & & 1& & &  & & \\
Kp_3 & & & 1& &  & & \\
Kp_4 & & & & 1&  & & \\
Kp_5 & & & & & 1 & & \\
Kp_6 & & & & &  & 1& \\
Kp_7 & & & & &  & & 1\\
\end{matrix}\right)</script><p>è¿™æ˜¯å› ä¸ºå½“æ»¡è¶³é¢˜ç›®éœ€è¦çš„exgcdè¦æ±‚ $ \sum_{i=1}^{7}{a_ip_i} = 1 $æ—¶ï¼Œè¿™ä¸ªæ ¼å…·æœ‰ä¸‹é¢çš„çº¿æ€§å…³ç³»ï¼š</p>
<script type="math/tex; mode=display">
(1,a_1,a_2,a_3,a_4,a_5,a_6,a_7)
\left(\begin{matrix}
-K & & & & &  & & \\
Kp_1 & 1& & & &  & & \\
Kp_2 & & 1& & &  & & \\
Kp_3 & & & 1& &  & & \\
Kp_4 & & & & 1&  & & \\
Kp_5 & & & & & 1 & & \\
Kp_6 & & & & &  & 1& \\
Kp_7 & & & & &  & & 1\\
\end{matrix}\right)
=(0,a_1,a_2,a_3,a_4,a_5,a_6,a_7)</script><p>æ‰€ä»¥å¯ä»¥è§„çº¦å‡ºæˆ‘ä»¬éœ€è¦çš„aiå‘é‡ï¼Œè€Œä¹‹æ‰€ä»¥ç¬¬ä¸€åˆ—ä¹˜ä¸Šå¤§ç³»æ•°Kæ˜¯ä¸ºäº†ä¿è¯ç¬¬ä¸€é¡¹è§„çº¦å‡º0ã€‚ä¸è¿‡æ—¢ç„¶æœ‰å¾ˆå¤šç®€å•æ–¹æ³•å¯é€‰ï¼Œè¿™ä¸ªæ–¹æ³•å°±æ²¡å¤ªå¤§å¿…è¦äº†ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256,sha1</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcdext</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>():</span><br><span class="line">	table = string.digits + string.ascii_letters</span><br><span class="line">	temp = r.recvuntil(<span class="string">b&quot;sha256(XXXX+&quot;</span>)</span><br><span class="line">	temp = r.recvline()</span><br><span class="line">	suffix = temp[:<span class="number">16</span>].decode()</span><br><span class="line">	hex1 = temp[<span class="number">20</span>:].strip().decode()</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> tqdm(table):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> table:</span><br><span class="line">			<span class="keyword">for</span> k <span class="keyword">in</span> table:</span><br><span class="line">				<span class="keyword">for</span> m <span class="keyword">in</span> table:</span><br><span class="line">					temp1 = i+j+k+m</span><br><span class="line">					<span class="keyword">if</span>(sha256((temp1+suffix).encode()).hexdigest() == hex1):</span><br><span class="line">						r.sendline(temp1.encode())</span><br><span class="line">						<span class="keyword">return</span></span><br><span class="line">					</span><br><span class="line">r = remote(<span class="string">&quot;59.110.20.54&quot;</span>, <span class="number">1789</span>)</span><br><span class="line">proof_of_work()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">round</span> <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>):</span><br><span class="line">	r.recvuntil(<span class="string">b&#x27;primes :&#x27;</span>)</span><br><span class="line">	primes = <span class="built_in">eval</span>(r.recvline().strip().decode().split(<span class="string">&quot;(&quot;</span>)[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">	d,a1,b1 = gcdext(primes[<span class="number">0</span>],primes[<span class="number">1</span>])</span><br><span class="line">	d,a2,b2 = gcdext(primes[<span class="number">2</span>],primes[<span class="number">3</span>])</span><br><span class="line">	d,a3,b3 = gcdext(primes[<span class="number">4</span>],primes[<span class="number">5</span>])</span><br><span class="line">	d,a4,b4 = gcdext(<span class="number">3</span>,primes[<span class="number">6</span>])</span><br><span class="line"></span><br><span class="line">	t = [<span class="built_in">int</span>(a1)*<span class="built_in">int</span>(a4),<span class="built_in">int</span>(b1)*<span class="built_in">int</span>(a4),<span class="built_in">int</span>(a2)*<span class="built_in">int</span>(a4),<span class="built_in">int</span>(b2)*<span class="built_in">int</span>(a4),<span class="built_in">int</span>(a3)*<span class="built_in">int</span>(a4),<span class="built_in">int</span>(b3)*<span class="built_in">int</span>(a4),<span class="built_in">int</span>(b4)]</span><br><span class="line">	sum1 = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">		sum1 += t[i]*primes[i]</span><br><span class="line">	r.sendline(<span class="built_in">str</span>(t)[<span class="number">1</span>:-<span class="number">1</span>].encode())</span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line"><span class="built_in">print</span>(r.recvline())</span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;N0t_s0_e4sy_3xtgCd&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="Algebra"><a href="#Algebra" class="headerlink" title="Algebra"></a>Algebra</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Recently jrl888 has learned something about groebner_basis.But could U plz help him to sovle his linear algebra homework?</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#utf-8</span></span><br><span class="line"><span class="comment">#sage</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag,e</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> reduce(<span class="keyword">lambda</span> x,y:x&amp;y,[i^<span class="number">3</span> - <span class="number">10</span>*i^<span class="number">2</span> + <span class="number">31</span>*i - <span class="number">30</span>==<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> e])</span><br><span class="line"></span><br><span class="line">LEN = <span class="number">32</span></span><br><span class="line">flag = pad(flag,<span class="number">36</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">LongArray</span>(<span class="params">t:<span class="built_in">list</span></span>):</span><br><span class="line">    <span class="keyword">return</span> [bytes_to_long(t[i]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(t))]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">BytesArray</span>(<span class="params">t:<span class="built_in">list</span></span>):</span><br><span class="line">    <span class="keyword">return</span> [long_to_bytes(t[i]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(t))]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([a[i%<span class="built_in">len</span>(a)] ^^ b[i%<span class="built_in">len</span>(b)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">max</span>(<span class="built_in">len</span>(a), <span class="built_in">len</span>(b)))])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ArrayXor</span>(<span class="params">a:<span class="built_in">list</span>,b:<span class="built_in">bytes</span></span>):</span><br><span class="line">    <span class="keyword">return</span> [xor(a[i],b) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a))]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">scissors</span>(<span class="params">flag:<span class="built_in">bytes</span></span>):</span><br><span class="line">    <span class="keyword">return</span> [flag[i:i+<span class="built_in">len</span>(flag)//<span class="number">3</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(flag), <span class="built_in">len</span>(flag)//<span class="number">3</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">challenge</span>(<span class="params">m: <span class="built_in">bytes</span>, bits: <span class="built_in">int</span>, level: <span class="built_in">int</span></span>):</span><br><span class="line">    p = getPrime(bits)</span><br><span class="line">    M = random_matrix(Zmod(p), LEN).matrix_from_rows_and_columns(<span class="built_in">range</span>(LEN), <span class="built_in">range</span>(LEN-level))</span><br><span class="line">    c = vector(GF(p), m) * M</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;p&quot;</span>: p, <span class="string">&quot;M&quot;</span>: M.<span class="built_in">list</span>(), <span class="string">&quot;c&quot;</span>: c.<span class="built_in">list</span>()&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">groebner_challenge</span>(<span class="params">m,e</span>):</span><br><span class="line">    p = getPrime(<span class="number">1024</span>)</span><br><span class="line">    s = <span class="built_in">sum</span>(m)</span><br><span class="line">    c = [<span class="built_in">pow</span>(m[i],e[i],p) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">    c.insert(<span class="number">0</span>,s)</span><br><span class="line">    c.insert(<span class="number">0</span>,p)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">key = os.urandom(LEN)</span><br><span class="line">Get_key = challenge(key,<span class="number">256</span>,<span class="number">0x10</span>)</span><br><span class="line"></span><br><span class="line">S_bytes = scissors(flag)</span><br><span class="line">C_bytes = ArrayXor(S_bytes,key)</span><br><span class="line">C_long  = LongArray(C_bytes)</span><br><span class="line"></span><br><span class="line">groebner_challenge = groebner_challenge(C_long,e)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;keyTask.chall&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">f&quot;<span class="subst">&#123;Get_key&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;groebnerTask.chall&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">f&quot;<span class="subst">&#123;groebner_challenge&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>ç„¶åè¿˜æœ‰ä¸¤ä»½æ•°æ®æ–‡ä»¶ï¼Œè¾ƒé•¿å°±ä¸å†™å‡ºæ¥äº†ï¼Œæœ‰éœ€è¦çš„å¸ˆå‚…å¯ä»¥æ‰¾æˆ‘è¦ã€‚</p>
<p>ç®€å•æè¿°ä¸€ä¸‹é¢˜ç›®ä»»åŠ¡ï¼š</p>
<ul>
<li>ç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º32çš„éšæœºå­—èŠ‚ä¸²keyï¼Œå¹¶è¿›å…¥challenge</li>
<li>challengeä¸­ï¼Œå°†keyæŒ‰å­—èŠ‚æ‹†æˆ1x32çš„å‘é‡mï¼ŒåŒæ—¶ç”Ÿæˆä¸€ä¸ª32x16çš„éšæœºçŸ©é˜µMä»¥åŠéšæœºç´ æ•°pï¼Œå¹¶è¿”å›Mä»¥åŠæ¨¡pä¸‹mMçš„è®¡ç®—ç»“æœc</li>
<li>å°†flagæ‹†æˆä¸‰ç­‰åˆ†çš„å­—èŠ‚ä¸²ï¼Œæ¯ä¸€éƒ¨åˆ†å‡ä¸keyå¼‚æˆ–å¾—åˆ°C_bytesï¼Œå¹¶è½¬ä¸ºåˆ—è¡¨C_long</li>
<li>å¯¹C_longè¿›è¡Œgroebner_challengeå¹¶è¿”å›ç»“æœ</li>
</ul>
<p>æ‰€ä»¥å…¶å®é¢˜ç›®ä¸»è¦ä¹Ÿå°±åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†è§£challengeå¾—åˆ°keyï¼Œä¸€éƒ¨åˆ†è§£groebner_challengeå¾—åˆ°C_longï¼Œç„¶åå¼‚æˆ–å°±æœ‰flagï¼Œå› æ­¤æˆ‘çš„wpä¹Ÿåˆ†ä¸¤éƒ¨åˆ†é˜è¿°ã€‚</p>
<h4 id="challenge"><a href="#challenge" class="headerlink" title="challenge"></a>challenge</h4><p>è¿™ä¸€éƒ¨åˆ†ä¸»è¦åœ¨äºkeyå¯¹åº”çš„må‘é‡æ˜¯æŒ‰å­—èŠ‚æ‹†åˆ†ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨æ¨¡pä¸‹éƒ½æ˜¯å¾ˆå°çš„é‡ï¼Œæ‰€ä»¥å¯ä»¥ç”¨æ ¼è§„çº¦å‡ºkeyï¼Œå…·ä½“å¦‚ä½•æ„é€ æ ¼å¯ä»¥è§æˆ‘å†™çš„è¿™ä¸€ç¯‡ä¸­çš„Matrixä¸€é¢˜çš„challenge3ï¼Œæ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼š</p>
<p><a href="https://tangcuxiaojikuai.xyz/post/9b40da15.html">Cryptoè¶£é¢˜-Lattice | ç³–é†‹å°é¸¡å—çš„blog (tangcuxiaojikuai.xyz)</a></p>
<h4 id="groebner-challenge"><a href="#groebner-challenge" class="headerlink" title="groebner_challenge"></a>groebner_challenge</h4><p>è¿™ä¸€éƒ¨åˆ†ç»™äº†ä»¥ä¸‹å‡ ç»„æ¨¡ç­‰å¼ï¼š</p>
<script type="math/tex; mode=display">
m_0^{e_0} \equiv c_0 \quad(mod\;p)</script><script type="math/tex; mode=display">
m_1^{e_1} \equiv c_1 \quad(mod\;p)</script><script type="math/tex; mode=display">
m_2^{e_2} \equiv c_2 \quad(mod\;p)</script><p>å…¶ä¸­miå°±æ˜¯æˆ‘ä»¬éœ€è¦æ±‚å‡ºçš„C_longä¸­çš„ä¸‰éƒ¨åˆ†ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜ç»™å‡ºäº†ä¸¤ä¸ªä¿¡æ¯ï¼Œä¸€ä¸ªæ˜¯miçš„å’Œï¼š</p>
<script type="math/tex; mode=display">
m_0 + m_1 + m_2 = s</script><p>å¦ä¸€ä¸ªæ˜¯ä¸‰ä¸ªeæ»¡è¶³çš„æ–¹ç¨‹ï¼š</p>
<script type="math/tex; mode=display">
e_i^3 - 10e_i^2 + 3*e_i - 30==0</script><p>é‚£ä¹ˆæ±‚è§£è¿™ä¸ªä¸‰æ¬¡æ–¹ç¨‹å¯ä»¥å¾—åˆ°ä¸‰ä¸ªæ ¹5ï¼Œ3ï¼Œ2ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯¹æ‰€æœ‰å¯èƒ½çš„3^3ç§eçš„ç»„åˆåˆ†åˆ«æ±‚groebnerï¼Œå°±ä¼šå‘ç°åœ¨åˆ†åˆ«å–2ï¼Œ3ï¼Œ5çš„æ—¶å€™å¯ä»¥æ±‚å‡ºmiï¼Œç„¶åå¼‚æˆ–keyå°±èƒ½å¾—åˆ°flagäº†ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#part1 get key</span></span><br><span class="line">Get_key = </span><br><span class="line">p,M,c = Get_key[<span class="string">&quot;p&quot;</span>],Get_key[<span class="string">&quot;M&quot;</span>],Get_key[<span class="string">&quot;c&quot;</span>]</span><br><span class="line"></span><br><span class="line">MM = matrix(ZZ,<span class="number">32</span>,<span class="number">16</span>,M)</span><br><span class="line">E = diagonal_matrix([<span class="number">1</span>]*<span class="number">32</span>)</span><br><span class="line">P = diagonal_matrix([p]*<span class="number">16</span>)</span><br><span class="line">C = matrix(ZZ,c)</span><br><span class="line">L = block_matrix(ZZ,[[MM,E],[P,<span class="number">0</span>],[C,<span class="number">0</span>]])</span><br><span class="line">ML = L.LLL()</span><br><span class="line">key = <span class="built_in">list</span>(ML[<span class="number">1</span>][<span class="number">16</span>:])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)):</span><br><span class="line">    key[i] = <span class="built_in">abs</span>(key[i])</span><br><span class="line">key = <span class="built_in">bytes</span>(key)</span><br><span class="line"></span><br><span class="line"><span class="comment">#part2 get e</span></span><br><span class="line">PR.&lt;i&gt; = PolynomialRing(ZZ)</span><br><span class="line">f = i^<span class="number">3</span> - <span class="number">10</span>*i^<span class="number">2</span> + <span class="number">31</span>*i - <span class="number">30</span></span><br><span class="line">res = f.roots()</span><br><span class="line">e = [i[<span class="number">0</span>] <span class="keyword">for</span> i <span class="keyword">in</span> res]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#part3 get C_long</span></span><br><span class="line">groebner_challenge = [<span class="number">175336555462486363373099551411803174933803940918372428249159666803182759268063415863987676455854054651631174131625763475189413468427467197699058719725221879406119373683175842618465694427132003565774900609456204965408254598477034791500576573579131820364396996254469692964946065509325801687720344376041097328929</span>, <span class="number">192597139210277682598060185912821582569043452465684540030278464832244948354365</span>, <span class="number">5415723658972576382153559473862560277755192970021711034483296770242757614573901416501357332661976379693731699836578087114136761491831672836130172409491889</span>, <span class="number">210713951733721296094981135225517096332793112439184310028590576805069783972692891743044656754643189870169698041576462365740899368554671164493356650858567594970345928936103914826926922045852943068526737627918609421198466329605091625</span>, <span class="number">93558120697660628972553751937347865465963385519812302371069578286123647411810258547153399045605149278436900736665388355004346922404097196048139360206875149390218160164739477798859206611473675859708579299466581718543909912951088772842957187413726251892347470983848602814387339449340072310561011153714207338630</span>]</span><br><span class="line">p,s,c = groebner_challenge[<span class="number">0</span>],groebner_challenge[<span class="number">1</span>],groebner_challenge[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">PR.&lt;x1,x2,x3&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">f1 = x1+x2+x3-s</span><br><span class="line">f2 = x1^e[<span class="number">2</span>]-c[<span class="number">0</span>]</span><br><span class="line">f3 = x2^e[<span class="number">1</span>]-c[<span class="number">1</span>]</span><br><span class="line">f4 = x3^e[<span class="number">0</span>]-c[<span class="number">2</span>]</span><br><span class="line">F = [f1,f2,f3,f4]</span><br><span class="line">res = Ideal(F).groebner_basis()</span><br><span class="line"><span class="comment">#print(res)</span></span><br><span class="line">C_long = [<span class="number">175336555462486363373099551411803174933803940918372428249159666803182759268063415863987676455854054651631174131625763475189413468427467197699058719725221879406119373683175842618465694427132003565774900609456204965408254598477034791426984973114319422168794550068252297864611570239554629678043272534782205132762</span>,<span class="number">175336555462486363373099551411803174933803940918372428249159666803182759268063415863987676455854054651631174131625763475189413468427467197699058719725221879406119373683175842618465694427132003565774900609456204965408254598477034791441070070348726882479628953871755257672217743797421672257560044812378339845544</span>,<span class="number">175336555462486363373099551411803174933803940918372428249159666803182759268063415863987676455854054651631174131625763475189413468427467197699058719725221879406119373683175842618465694427132003565774900609456204965408254598477034791441077538064071473846707298910579940788965430025316563097279250948717798654116</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    C_long[i] = p - C_long[i]</span><br><span class="line"></span><br><span class="line"><span class="comment">#part4 get flag</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([a[i%<span class="built_in">len</span>(a)] ^^ b[i%<span class="built_in">len</span>(b)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">max</span>(<span class="built_in">len</span>(a), <span class="built_in">len</span>(b)))])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ArrayXor</span>(<span class="params">a:<span class="built_in">list</span>,b:<span class="built_in">bytes</span></span>):</span><br><span class="line">    <span class="keyword">return</span> [xor(a[i],b) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a))]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    C_long[i] = long_to_bytes(C_long[i])</span><br><span class="line">S_bytes = ArrayXor(C_long,key)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> S_bytes:</span><br><span class="line">    flag += i[:<span class="number">12</span>]</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;You_are_really_algebra_master&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="GoGoCrypto"><a href="#GoGoCrypto" class="headerlink" title="GoGoCrypto"></a>GoGoCrypto</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é¢˜ç›®é“¾æ¥ï¼šhttp://47.109.106.62:7842/ å¸¦ä¸Šä½ çš„webé˜Ÿå‹ï¼Œæ‹¿ä¸‹è¿™é“crypto web é¢˜å§ï¼ï¼ˆå…è®¸å°èŒƒå›´çˆ†ç ´ï¼‰</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®æ–‡ä»¶å¾ˆå¤šï¼Œå…¨éƒ¨æ”¾åœ¨wpé‡Œæœ‰ç‚¹é•¿ï¼Œéœ€è¦çš„å¸ˆå‚…æ‰¾æˆ‘è¦å°±å¯ä»¥äº†ã€‚è§£é¢˜è¦ç”¨åˆ°çš„ä¸»è¦çš„ä¸¤ä¸ªgoæ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<p>publicController.goï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Controller</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;GoCode/myfunc&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span> </span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">	<span class="string">&quot;encoding/base64&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span> </span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> PubController <span class="keyword">struct</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> sid []<span class="type">byte</span> </span><br><span class="line"><span class="keyword">var</span> key []<span class="type">byte</span> </span><br><span class="line"><span class="keyword">var</span> iv []<span class="type">byte</span> </span><br><span class="line"><span class="keyword">var</span> nonce []<span class="type">byte</span> </span><br><span class="line"><span class="keyword">var</span> pwd <span class="type">string</span>  </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SendJsonBack</span><span class="params">(feedback <span class="type">string</span>, check <span class="type">string</span>, c *gin.Context)</span></span> &#123;</span><br><span class="line">	messageMap := <span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line">		<span class="string">&quot;msg&quot;</span>:   feedback,</span><br><span class="line">		<span class="string">&quot;check&quot;</span>: check,</span><br><span class="line">	&#125;</span><br><span class="line">	c.JSON(http.StatusOK, messageMap)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(pc PubController)</span></span> Router(pr *gin.Engine) &#123;</span><br><span class="line">	pr.GET(<span class="string">&quot;/&quot;</span>, pc.Room)</span><br><span class="line">	pr.POST(<span class="string">&quot;/api/dec&quot;</span>, pc.MyDec) </span><br><span class="line">	pr.POST(<span class="string">&quot;/api/check&quot;</span>, pc.CheckPwd)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(pc PubController)</span></span> Room(c *gin.Context) &#123;</span><br><span class="line">	sid = Myfunc.GetRandBytes(<span class="number">16</span>) </span><br><span class="line">	key = Myfunc.GetRandBytes(<span class="number">16</span>) </span><br><span class="line">	iv = Myfunc.GetRandBytes(<span class="number">16</span>) </span><br><span class="line">	nonce = Myfunc.GetRandBytes(<span class="number">16</span>) </span><br><span class="line"></span><br><span class="line">	token, _ := Myfunc.AESEnc(sid, key, iv) </span><br><span class="line">	c.SetCookie(<span class="string">&quot;token&quot;</span>, base64.StdEncoding.EncodeToString(token), <span class="number">0</span>, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="literal">true</span>, <span class="literal">true</span>) </span><br><span class="line">	c.SetCookie(<span class="string">&quot;nonce&quot;</span>,base64.StdEncoding.EncodeToString(nonce) , <span class="number">0</span>, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="literal">true</span>, <span class="literal">true</span>) </span><br><span class="line">	fmt.Println(<span class="string">&quot;token:&quot;</span>, base64.StdEncoding.EncodeToString(token))	</span><br><span class="line">	c.HTML(http.StatusOK, <span class="string">&quot;index.html&quot;</span>, gin.H&#123;<span class="string">&quot;ping&quot;</span>: <span class="string">&quot;pong&quot;</span>&#125;) </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span><span class="params">(pc PubController)</span></span> MyDec(c *gin.Context) &#123;</span><br><span class="line">	<span class="keyword">var</span> feedback <span class="type">string</span> </span><br><span class="line">	<span class="keyword">var</span> check <span class="type">string</span> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	Rec_err := c.PostForm(<span class="string">&quot;Rec&quot;</span>) </span><br><span class="line">	fmt.Println(<span class="string">&quot;Rec:&quot;</span>, Rec_err) </span><br><span class="line">	Rec, err := base64.StdEncoding.DecodeString(Rec_err) </span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		check = <span class="string">&quot;false&quot;</span> </span><br><span class="line">		feedback = <span class="string">&quot;Try again.&quot;</span> </span><br><span class="line">		SendJsonBack(feedback, check, c) </span><br><span class="line">		<span class="keyword">return</span> </span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Pt_err, err := Myfunc.AESDec(Rec, key, iv) </span><br><span class="line">	<span class="comment">//</span></span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> || base64.StdEncoding.EncodeToString(Pt_err) == base64.StdEncoding.EncodeToString(sid)&#123;</span><br><span class="line">		check = <span class="string">&quot;false&quot;</span> </span><br><span class="line">		feedback = <span class="string">&quot;Don&#x27;t try to fool me! Try again.&quot;</span> </span><br><span class="line">		SendJsonBack(feedback, check, c) </span><br><span class="line">		<span class="keyword">return</span> </span><br><span class="line">	&#125;</span><br><span class="line">	check = <span class="string">&quot;true&quot;</span> </span><br><span class="line">	feedback = <span class="string">&quot;Access Accepted.&quot;</span>  </span><br><span class="line">	Pt := base64.StdEncoding.EncodeToString(Pt_err) </span><br><span class="line">	fmt.Println(<span class="string">&quot;(DEBUG)Pt: &quot;</span>, Pt) </span><br><span class="line">	nonce_hash := Myfunc.Hash(nonce) </span><br><span class="line">	pwd = Pt+nonce_hash</span><br><span class="line">	fmt.Println(<span class="string">&quot;pwd: &quot;</span>,pwd)</span><br><span class="line">	SendJsonBack(feedback, check, c) </span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span><span class="params">(pc PubController)</span></span> CheckPwd(c *gin.Context) &#123;</span><br><span class="line">	<span class="keyword">var</span> feedback <span class="type">string</span> </span><br><span class="line">	<span class="keyword">var</span> check <span class="type">string</span> </span><br><span class="line"></span><br><span class="line">	Rec := c.PostForm(<span class="string">&quot;Password&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> pwd == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">		check = <span class="string">&quot;false&quot;</span> </span><br><span class="line">		feedback = <span class="string">&quot;Give me your token first.&quot;</span> </span><br><span class="line">		SendJsonBack(feedback, check, c) </span><br><span class="line">		<span class="keyword">return</span>  </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> Rec == pwd &#123;</span><br><span class="line">		check = <span class="string">&quot;true&quot;</span> </span><br><span class="line">		feedback = <span class="string">&quot;Your flag is: SYC&#123;AL3XEI_FAKE_FLAG&#125;&quot;</span> </span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		check =  <span class="string">&quot;false&quot;</span> </span><br><span class="line">		feedback = <span class="string">&quot;Oops! Please try again.&quot;</span> </span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	SendJsonBack(feedback, check, c) </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>myfunc.goï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Myfunc </span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;crypto/aes&quot;</span></span><br><span class="line">    <span class="string">&quot;crypto/cipher&quot;</span></span><br><span class="line">    <span class="string">&quot;crypto/rand&quot;</span></span><br><span class="line">    <span class="string">&quot;bytes&quot;</span></span><br><span class="line">	<span class="string">&quot;crypto/sha512&quot;</span> </span><br><span class="line">	<span class="string">&quot;encoding/base64&quot;</span> </span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">check</span><span class="params">(err <span class="type">error</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="built_in">panic</span>(err) </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetRandBytes</span><span class="params">(n <span class="type">int</span>)</span></span> []<span class="type">byte</span> &#123;</span><br><span class="line">	res := <span class="built_in">make</span>([]<span class="type">byte</span>, n) </span><br><span class="line">	_, e := rand.Read(res) </span><br><span class="line">	check(e) </span><br><span class="line">	<span class="keyword">return</span> res </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Pad</span><span class="params">(pt []<span class="type">byte</span>)</span></span> []<span class="type">byte</span> &#123;</span><br><span class="line">	padlen := aes.BlockSize - (<span class="built_in">len</span>(pt) % aes.BlockSize) </span><br><span class="line">	padding := bytes.Repeat([]<span class="type">byte</span>&#123;<span class="type">byte</span>(padlen)&#125;, padlen) </span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">append</span>(pt, padding...) </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Unpad</span><span class="params">(pt []<span class="type">byte</span>)</span></span> []<span class="type">byte</span> &#123;</span><br><span class="line">	padlen := <span class="type">int</span>(pt[<span class="built_in">len</span>(pt)<span class="number">-1</span>]) </span><br><span class="line">	<span class="keyword">return</span> pt[:<span class="built_in">len</span>(pt)-padlen] </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AESEnc</span><span class="params">(pt []<span class="type">byte</span>, key []<span class="type">byte</span>, iv []<span class="type">byte</span>)</span></span> ([]<span class="type">byte</span>, <span class="type">error</span>) &#123;</span><br><span class="line">	block, e := aes.NewCipher(key) </span><br><span class="line">	<span class="keyword">if</span> e != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, e </span><br><span class="line">	&#125;</span><br><span class="line">	pt_ := Pad(pt) </span><br><span class="line">	fmt.Println(<span class="string">&quot;(DEBUG) pt_: &quot;</span>, pt_)</span><br><span class="line">	ct := <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="built_in">len</span>(pt_)) </span><br><span class="line">	m := cipher.NewCBCEncrypter(block, iv) </span><br><span class="line">	m.CryptBlocks(ct, pt_) </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> ct, <span class="literal">nil</span> </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AESDec</span><span class="params">(ct []<span class="type">byte</span>, key []<span class="type">byte</span>, iv []<span class="type">byte</span>)</span></span> ([]<span class="type">byte</span>, <span class="type">error</span>) &#123;</span><br><span class="line">	block, e := aes.NewCipher(key) </span><br><span class="line">	<span class="keyword">if</span> e != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, e</span><br><span class="line">	&#125;</span><br><span class="line">	m := cipher.NewCBCDecrypter(block, iv) </span><br><span class="line">	pt_ := <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="built_in">len</span>(ct)) </span><br><span class="line">	m.CryptBlocks(pt_, ct) </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> Unpad(pt_), <span class="literal">nil</span> </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Hash</span><span class="params">(nonce []<span class="type">byte</span>)</span></span> <span class="type">string</span>&#123;</span><br><span class="line">	h := sha512.New() </span><br><span class="line">	h.Write(nonce) </span><br><span class="line">	nonce_hash := base64.StdEncoding.EncodeToString(h.Sum(<span class="literal">nil</span>)) </span><br><span class="line">	<span class="keyword">return</span> nonce_hash </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>äº‹å®ä¸Šæˆ‘ä¸€ç‚¹ä¹Ÿä¸æ‡‚webï¼Œä½†æ˜¯ä¸¢ç»™chatgpt+é—®webé˜Ÿå‹å¾ˆè½»æ¾å°±èƒ½å¤§æ¦‚ææ¸…æ¥šæ¯ä¸ªå‡½æ•°çš„æ„æ€ã€‚ç®€å•æè¿°ä¸€ä¸‹é¢˜ç›®ä»»åŠ¡ï¼Œæœ‰ä¸‰ä¸ªè®¿é—®æ¥å£å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">func (pc PubController) Router(pr *gin.Engine) &#123;</span><br><span class="line">	pr.GET(<span class="string">&quot;/&quot;</span>, pc.Room)</span><br><span class="line">	pr.POST(<span class="string">&quot;/api/dec&quot;</span>, pc.MyDec) </span><br><span class="line">	pr.POST(<span class="string">&quot;/api/check&quot;</span>, pc.CheckPwd)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>è®¿é—®Roomæ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ä»Cookieä¸­å¾—åˆ°tokenå’Œnonceçš„å€¼ï¼Œtokenæ˜¯sidç»AESåŠ å¯†åçš„å€¼ï¼›</p>
</li>
<li><p>è®¿é—®MyDecæ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨postæ–¹å¼å‘é€ä¸€ä¸ªbase64ä¸²è®©æœåŠ¡å™¨è§£å¯†ï¼ŒæœåŠ¡å™¨æ­£ç¡®è§£å¯†åä¼šæ£€æŸ¥è§£å¯†ç»“æœæ˜¯å¦ç­‰äºsidï¼Œå¦‚æœä¸ç›¸ç­‰åˆ™é€šè¿‡æ£€æŸ¥ï¼Œå¹¶å°†è§£å¯†åçš„ç»“æœè¿æ¥ä¸Šnonceçš„sha512å€¼ï¼Œä½œä¸ºpwd</p>
</li>
<li>è®¿é—®CheckPwdæ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å‘é€ä¸€ä¸ªbase64ä¸²ï¼ŒæœåŠ¡å™¨base64è§£ç åæ£€æŸ¥ç»“æœä¸pwdç›¸ç­‰ï¼Œåˆ™å¯ä»¥è·å¾—flag</li>
</ul>
<p>æ¥ä¸‹æ¥çœ‹çœ‹æ€ä¹ˆè§£é¢˜ã€‚é¦–å…ˆï¼Œpwdçš„ååŠéƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯nonceçš„sha512å€¼æˆ‘ä»¬æ˜¯å¯ä»¥è·å¾—çš„ï¼Œå› æ­¤ä¸»è¦è¦æƒ³çš„åŠæ³•æ˜¯å¦‚ä½•å»å¾—åˆ°pwdçš„å‰åŠéƒ¨åˆ†Ptï¼Œä¹Ÿå°±æ˜¯MyDecä¸­çš„AESè§£å¯†ç»“æœã€‚</p>
<p>ç„¶åæˆ‘çš„åšæ³•ä¹Ÿå¾ˆç®€å•ï¼Œæ³¨æ„åˆ°AESè§£å¯†åä¸€å®šä¼šunpadï¼Œè€Œmyfuncä¸­çš„padå’Œunpadæ˜¯pkcs#7çš„æ ‡å‡†å¡«å……æ–¹å¼ï¼Œè€Œæˆ‘ä»¬åˆ©ç”¨çš„ç‚¹ä¹Ÿä¸»è¦åœ¨äºunpadå‡½æ•°ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Unpad</span><span class="params">(pt []<span class="type">byte</span>)</span></span> []<span class="type">byte</span> &#123;</span><br><span class="line">	padlen := <span class="type">int</span>(pt[<span class="built_in">len</span>(pt)<span class="number">-1</span>]) </span><br><span class="line">	<span class="keyword">return</span> pt[:<span class="built_in">len</span>(pt)-padlen] </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°å®ƒè§£å¡«å……æ—¶ï¼Œåªç”¨æœ€åä¸€ä¸ªå­—èŠ‚çš„å€¼å½“ä½œå¡«å……é•¿åº¦ï¼Œè¿™å¯¹äºæ ‡å‡†å¡«å……è¿‡çš„å¯†æ–‡æ¥è¯´ï¼Œè¿™æ ·è§£å¡«å……å½“ç„¶æ˜¯æ²¡é—®é¢˜çš„ï¼Œä½†æ˜¯å¦‚æœä¸æ˜¯æ ‡å‡†å¡«å……è¿‡åçš„å¯†æ–‡å°±ä¼šäº§ç”Ÿé—®é¢˜ï¼Œè¿™æ˜¯å› ä¸ºåœ¨MyDecä¸­æˆ‘ä»¬å¯ä»¥å‘é€ä»»ä½•base64ä¸²ï¼Œåªè¦ä»–èƒ½æ­£ç¡®AESè§£å¯†ï¼Œå¹¶ä¸”è§£å¯†ç»“æœä¸ç­‰äºsid(ä¹Ÿå°±æ˜¯tokençš„è§£å¯†å€¼)ï¼ŒæœåŠ¡å™¨å°±ä¼šæŠŠè§£å¯†ç»“æœPtå½“ä½œpwdçš„å‰ä¸€éƒ¨åˆ†ã€‚</p>
<h4 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h4><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å‘é€ä»»æ„16å­—èŠ‚å¯†æ–‡çš„base64ä¸²ï¼ŒæœåŠ¡å™¨åº”è¯¥éƒ½èƒ½AESè§£å¯†å‡º16å­—èŠ‚æ˜æ–‡å¹¶<strong>è§£å¡«å……</strong>ï¼Œå¾—åˆ°æœ€ç»ˆçš„Ptã€‚è€Œå¦‚æœæˆ‘ä»¬å¯ä»¥ä½¿è§£å¯†å‡ºçš„æœ€åä¸€å­—èŠ‚å€¼æ°ä¸º16ï¼Œé‚£ä¹ˆæ ¹æ®unpadçš„æ–¹å¼ï¼ŒPtæœ€ç»ˆå°†ä¼šæ˜¯ä¸€ä¸ªç©ºä¸²ï¼Œæ‰€ä»¥pwdå…¶å®å°±æ˜¯nonceçš„sha512å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å‘é€nonceçš„sha512å€¼è¿‡å»checkå°±èƒ½å¾—åˆ°flagã€‚</p>
<p>è‡³äºå¦‚ä½•ä½¿è§£å¯†å‡ºçš„æœ€åä¸€å­—èŠ‚å€¼æ°ä¸º16ï¼Œæˆ‘çš„æ–¹æ³•æ˜¯ç›´æ¥ç”Ÿæ—¥æ”»å‡»å°±å¥½ï¼Œä¸€æ¬¡æœ‰1/256çš„æ¦‚ç‡æˆåŠŸï¼Œé‚£ä¹ˆçˆ†ç ´256æ¬¡å°±æœ‰å¤§äº50%çš„æ¦‚ç‡æˆåŠŸã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> unquote</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha512</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">base_url = <span class="string">&quot;http://47.109.106.62:7842/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#part1 get nonce</span></span><br><span class="line">response = requests.get(base_url + <span class="string">&quot;/&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">    cookies = response.cookies</span><br><span class="line">    token_cookie = cookies.get(<span class="string">&quot;token&quot;</span>)</span><br><span class="line">    nonce_cookie = cookies.get(<span class="string">&quot;nonce&quot;</span>)</span><br><span class="line"></span><br><span class="line">    token = unquote(token_cookie)</span><br><span class="line">    nonce = unquote(nonce_cookie)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Token:&quot;</span>, token)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Nonce:&quot;</span>, nonce)</span><br><span class="line">nonce_hash = b64encode(sha512(b64decode(nonce)).digest())</span><br><span class="line"></span><br><span class="line"><span class="comment">#part2 get flag</span></span><br><span class="line">randombytes = <span class="string">b&quot;0&quot;</span> * <span class="number">15</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">256</span>):</span><br><span class="line">    <span class="comment">#get pwd</span></span><br><span class="line">    temp = randombytes + long_to_bytes(i)</span><br><span class="line">    temp = b64encode(temp)</span><br><span class="line">    data = &#123;<span class="string">&quot;Rec&quot;</span>: temp&#125;</span><br><span class="line">    response = requests.post(base_url + <span class="string">&quot;api/dec&quot;</span>, data=data)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#get flag</span></span><br><span class="line">    data = &#123;<span class="string">&quot;Password&quot;</span>: nonce_hash&#125;</span><br><span class="line">    response = requests.post(base_url + <span class="string">&quot;api/check&quot;</span>, data=data)</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">&quot;Oops!&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> response.text):</span><br><span class="line">        <span class="built_in">print</span>(response.text)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;N0t_S0_E45y_Cryp0W3b&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h4><p>å¯ä»¥å‘ç°åˆšæ‰çš„æ–¹æ³•æ˜¯å®Œå…¨æ²¡ç”¨åˆ°tokençš„ï¼Œè€Œå¦‚æœç”¨ä¸Štokenï¼Œæˆ‘ä»¬åˆ™å¯ä»¥å®Œå…¨ä¸çˆ†ç ´ã€‚æ€è·¯å°±æ˜¯ï¼šsidæœ¬èº«æ˜¯ä¸ª16å­—èŠ‚çš„å€¼ï¼Œæ‰€ä»¥AESåŠ å¯†å‰ä¼šè¢«å¡«å……ä¸ºä¸‹é¢çš„å½¢å¼ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sid + <span class="string">b&quot;\x10&quot;</span>*<span class="number">16</span></span><br></pre></td></tr></table></figure>
<p>è€Œåˆå› ä¸ºæ˜¯CBCæ¨¡å¼åŠ å¯†ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨å­—èŠ‚ç¿»è½¬æ”»å‡»ï¼Œæ”¹å˜ç¬¬ä¸€ç»„æ˜æ–‡çš„æœ€åä¸€å­—èŠ‚ï¼Œä»è€Œå®ç°æŠŠæœ€åä¸€ä¸ªè§£å¯†å‡ºçš„å­—èŠ‚ä»16æ”¹æˆ32ï¼Œè¿™æ ·è§£å¡«å……çš„Ptä¹Ÿä¸ºç©ºä¸²ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> unquote</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha512</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">base_url = <span class="string">&quot;http://47.109.106.62:7842/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#part1 get token&amp;nonce</span></span><br><span class="line">response = requests.get(base_url + <span class="string">&quot;/&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">    cookies = response.cookies</span><br><span class="line">    token_cookie = cookies.get(<span class="string">&quot;token&quot;</span>)</span><br><span class="line">    nonce_cookie = cookies.get(<span class="string">&quot;nonce&quot;</span>)</span><br><span class="line"></span><br><span class="line">    token = unquote(token_cookie)</span><br><span class="line">    nonce = unquote(nonce_cookie)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Token:&quot;</span>, token)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Nonce:&quot;</span>, nonce)</span><br><span class="line">nonce_hash = b64encode(sha512(b64decode(nonce)).digest())</span><br><span class="line"></span><br><span class="line"><span class="comment">#part2 get flag</span></span><br><span class="line">token1,token2 = b64decode(token)[:<span class="number">16</span>],b64decode(token)[<span class="number">16</span>:]</span><br><span class="line">token1 = token1[:-<span class="number">1</span>] + long_to_bytes((token1[-<span class="number">1</span>] ^ <span class="number">16</span> ^ <span class="number">32</span>))</span><br><span class="line">temp = b64encode(token1+token2)</span><br><span class="line">data = &#123;<span class="string">&quot;Rec&quot;</span>: temp&#125;</span><br><span class="line">response = requests.post(base_url + <span class="string">&quot;api/dec&quot;</span>, data=data)</span><br><span class="line"></span><br><span class="line"><span class="comment">#get flag</span></span><br><span class="line">data = &#123;<span class="string">&quot;Password&quot;</span>: nonce_hash&#125;</span><br><span class="line">response = requests.post(base_url + <span class="string">&quot;api/check&quot;</span>, data=data)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;N0t_S0_E45y_Cryp0W3b&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>ç³–é†‹å°é¸¡å—
  </li>
  <li class="post-copyright-link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="https://tangcuxiaojikuai.xyz/post/6f77578c.html" title="2023-æå®¢å¤§æŒ‘æˆ˜-wp-crypto">https://tangcuxiaojikuai.xyz/post/6f77578c.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sacreative/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SACREATIVE</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>
</div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/post/df537e5d.html" rel="prev" title="2023-TPCTF-wp-crypto">
      <i class="fa fa-chevron-left"></i> 2023-TPCTF-wp-crypto
    </a></div>
      <div class="post-nav-item">
    <a href="/post/1b5eb6c5.html" rel="next" title="2023-ISCTF-wp-crypto">
      2023-ISCTF-wp-crypto <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Week-1"><span class="nav-number">1.</span> <span class="nav-text">Week 1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#SignIn"><span class="nav-number">1.1.</span> <span class="nav-text">SignIn</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#proof-of-work"><span class="nav-number">1.2.</span> <span class="nav-text">proof_of_work</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SimpleRSA"><span class="nav-number">1.3.</span> <span class="nav-text">SimpleRSA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#OTPTwice"><span class="nav-number">1.4.</span> <span class="nav-text">OTPTwice</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#OldAlgorithm"><span class="nav-number">1.5.</span> <span class="nav-text">OldAlgorithm</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easy-classic"><span class="nav-number">1.6.</span> <span class="nav-text">easy_classic</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1"><span class="nav-number">1.6.1.</span> <span class="nav-text">1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2"><span class="nav-number">1.6.2.</span> <span class="nav-text">2</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3"><span class="nav-number">1.6.3.</span> <span class="nav-text">3</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4"><span class="nav-number">1.6.4.</span> <span class="nav-text">4</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5"><span class="nav-number">1.6.5.</span> <span class="nav-text">5</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Week-2"><span class="nav-number">2.</span> <span class="nav-text">Week 2</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#PolyRSA"><span class="nav-number">2.1.</span> <span class="nav-text">PolyRSA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Simple3DES"><span class="nav-number">2.2.</span> <span class="nav-text">Simple3DES</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%B1%E5%AF%86%E9%92%A5"><span class="nav-number">2.2.1.</span> <span class="nav-text">å¼±å¯†é’¥</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#pad"><span class="nav-number">2.2.2.</span> <span class="nav-text">pad</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JPGDiff"><span class="nav-number">2.3.</span> <span class="nav-text">JPGDiff</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Energetic-Carcano"><span class="nav-number">2.4.</span> <span class="nav-text">Energetic_Carcano</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Just-need-One"><span class="nav-number">2.5.</span> <span class="nav-text">Just need One</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Fi1nd-th3-x%E2%80%99"><span class="nav-number">2.6.</span> <span class="nav-text">Fi1nd_th3_xâ€™</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Week-3"><span class="nav-number">3.</span> <span class="nav-text">Week 3</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Quick-Robert"><span class="nav-number">3.1.</span> <span class="nav-text">Quick_Robert</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9B%B4%E6%96%B0"><span class="nav-number">3.1.1.</span> <span class="nav-text">æ›´æ–°</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%A2%84%E5%A4%87%E7%9F%A5%E8%AF%86"><span class="nav-number">3.1.1.1.</span> <span class="nav-text">é¢„å¤‡çŸ¥è¯†</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9B%9E%E5%88%B0%E9%A2%98%E7%9B%AE"><span class="nav-number">3.1.1.2.</span> <span class="nav-text">å›åˆ°é¢˜ç›®</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Diligent-Liszt"><span class="nav-number">3.2.</span> <span class="nav-text">Diligent_Liszt</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#card-game"><span class="nav-number">3.3.</span> <span class="nav-text">card_game</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Week-4"><span class="nav-number">4.</span> <span class="nav-text">Week 4</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#EzComplex"><span class="nav-number">4.1.</span> <span class="nav-text">EzComplex</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ext-7gcd"><span class="nav-number">4.2.</span> <span class="nav-text">ext^7gcd</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Algebra"><span class="nav-number">4.3.</span> <span class="nav-text">Algebra</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#challenge"><span class="nav-number">4.3.1.</span> <span class="nav-text">challenge</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#groebner-challenge"><span class="nav-number">4.3.2.</span> <span class="nav-text">groebner_challenge</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GoGoCrypto"><span class="nav-number">4.4.</span> <span class="nav-text">GoGoCrypto</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80"><span class="nav-number">4.4.1.</span> <span class="nav-text">æ–¹æ³•ä¸€</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C"><span class="nav-number">4.4.2.</span> <span class="nav-text">æ–¹æ³•äºŒ</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="ç³–é†‹å°é¸¡å—"
      src="/images/image.png">
  <p class="site-author-name" itemprop="name">ç³–é†‹å°é¸¡å—</p>
  <div class="site-description" itemprop="description">"è¿½é£èµ¶æœˆè«åœç•™ï¼Œå¹³èŠœå°½å¤„æ˜¯æ˜¥å±±"</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">77</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="/1142381085@qq.com" title="E-Mail â†’ 1142381085@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/6394335993" title="Weibo â†’ https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;6394335993" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ç³–é†‹å°é¸¡å—</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> å¼ºåŠ›é©±åŠ¨
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>
  <script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'UPEMA7DyYbIIEyOW72ohgytU-gzGzoHsz',
      appKey     : 'M7rXAfeP3JOslroay2n0Jv2R',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
<!-- å¼•å…¥jQuery -->
<script type="text/javascript" src="//libs.baidu.com/jquery/1.8.3/jquery.min.js"></script>
<!-- é›ªèŠ±ç‰¹æ•ˆ2 -->
<script type="text/javascript" src="/js/snow2.js"></script>
