<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon_small.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="RnN18ZogmZl_dLVpxZ6y8kjKL73Mu9VLVEkw9d3qrq0" />
  <meta name="msvalidate.01" content="DC3050AD55F30DDF75AAB78517714910" />
  <meta name="baidu-site-verification" content="codeva-PPofu3dNxe" />

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-loading-bar.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"tangcuxiaojikuai.xyz","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="依然有最喜欢的maple师傅的题，依然做不来几道，不过还是记录一下。打*的赛后才会做，打$的不会做。">
<meta property="og:type" content="article">
<meta property="og:title" content="2024-ImaginaryCTF-wp-crypto">
<meta property="og:url" content="https://tangcuxiaojikuai.xyz/post/6956167f.html">
<meta property="og:site_name" content="糖醋小鸡块的blog">
<meta property="og:description" content="依然有最喜欢的maple师傅的题，依然做不来几道，不过还是记录一下。打*的赛后才会做，打$的不会做。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tangcuxiaojikuai.xyz/post/6956167f/image-20240723215429445.png">
<meta property="article:published_time" content="2024-07-22T02:11:28.000Z">
<meta property="article:modified_time" content="2024-11-09T14:36:52.778Z">
<meta property="article:author" content="糖醋小鸡块">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tangcuxiaojikuai.xyz/post/6956167f/image-20240723215429445.png">

<link rel="canonical" href="https://tangcuxiaojikuai.xyz/post/6956167f.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>2024-ImaginaryCTF-wp-crypto | 糖醋小鸡块的blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">糖醋小鸡块的blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-友链">

    <a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tangcuxiaojikuai.xyz/post/6956167f.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/image.png">
      <meta itemprop="name" content="糖醋小鸡块">
      <meta itemprop="description" content=""追风赶月莫停留，平芜尽处是春山"">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="糖醋小鸡块的blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2024-ImaginaryCTF-wp-crypto
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-07-22 10:11:28" itemprop="dateCreated datePublished" datetime="2024-07-22T10:11:28+08:00">2024-07-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-11-09 22:36:52" itemprop="dateModified" datetime="2024-11-09T22:36:52+08:00">2024-11-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/wp-crypto/" itemprop="url" rel="index"><span itemprop="name">wp-crypto</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/post/6956167f.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/post/6956167f.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>依然有最喜欢的maple师傅的题，依然做不来几道，不过还是记录一下。打*的赛后才会做，打$的不会做。</p>
<span id="more"></span>
<h3 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yet another base64 decoding challenge</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"></span><br><span class="line">q = <span class="number">64</span></span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line">flag_int = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">secret_key = []</span><br><span class="line"><span class="keyword">while</span> flag_int:</span><br><span class="line">    secret_key.append(flag_int % q)</span><br><span class="line">    flag_int //= q</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;secret_key = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">secret_key = [<span class="number">10</span>, <span class="number">52</span>, <span class="number">23</span>, <span class="number">14</span>, <span class="number">52</span>, <span class="number">16</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">37</span>, <span class="number">37</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">50</span>, <span class="number">32</span>, <span class="number">19</span>, <span class="number">14</span>, <span class="number">48</span>, <span class="number">32</span>, <span class="number">35</span>, <span class="number">13</span>, <span class="number">54</span>, <span class="number">12</span>, <span class="number">35</span>, <span class="number">12</span>, <span class="number">31</span>, <span class="number">29</span>, <span class="number">7</span>, <span class="number">29</span>, <span class="number">38</span>, <span class="number">61</span>, <span class="number">37</span>, <span class="number">27</span>, <span class="number">47</span>, <span class="number">5</span>, <span class="number">51</span>, <span class="number">28</span>, <span class="number">50</span>, <span class="number">13</span>, <span class="number">35</span>, <span class="number">29</span>, <span class="number">46</span>, <span class="number">1</span>, <span class="number">51</span>, <span class="number">24</span>, <span class="number">31</span>, <span class="number">21</span>, <span class="number">54</span>, <span class="number">28</span>, <span class="number">52</span>, <span class="number">8</span>, <span class="number">54</span>, <span class="number">30</span>, <span class="number">38</span>, <span class="number">17</span>, <span class="number">55</span>, <span class="number">24</span>, <span class="number">41</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<p>就是简单的把flag用64进制表示而已。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">secret_key = [<span class="number">10</span>, <span class="number">52</span>, <span class="number">23</span>, <span class="number">14</span>, <span class="number">52</span>, <span class="number">16</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">37</span>, <span class="number">37</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">50</span>, <span class="number">32</span>, <span class="number">19</span>, <span class="number">14</span>, <span class="number">48</span>, <span class="number">32</span>, <span class="number">35</span>, <span class="number">13</span>, <span class="number">54</span>, <span class="number">12</span>, <span class="number">35</span>, <span class="number">12</span>, <span class="number">31</span>, <span class="number">29</span>, <span class="number">7</span>, <span class="number">29</span>, <span class="number">38</span>, <span class="number">61</span>, <span class="number">37</span>, <span class="number">27</span>, <span class="number">47</span>, <span class="number">5</span>, <span class="number">51</span>, <span class="number">28</span>, <span class="number">50</span>, <span class="number">13</span>, <span class="number">35</span>, <span class="number">29</span>, <span class="number">46</span>, <span class="number">1</span>, <span class="number">51</span>, <span class="number">24</span>, <span class="number">31</span>, <span class="number">21</span>, <span class="number">54</span>, <span class="number">28</span>, <span class="number">52</span>, <span class="number">8</span>, <span class="number">54</span>, <span class="number">30</span>, <span class="number">38</span>, <span class="number">17</span>, <span class="number">55</span>, <span class="number">24</span>, <span class="number">41</span>, <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(secret_key)):</span><br><span class="line">    flag += <span class="number">64</span>**i*secret_key[i]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(flag))</span><br><span class="line"></span><br><span class="line"><span class="comment">#ictf&#123;b4se_c0nv3rs1on_ftw_236680982d9e8449&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="integrity"><a href="#integrity" class="headerlink" title="integrity"></a>integrity</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">I think this is how signing works</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> crc_hqx</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">tot = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, tot)</span><br><span class="line"></span><br><span class="line">flag = bytes_to_long(<span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>).read())</span><br><span class="line">ct = <span class="built_in">pow</span>(flag, e, n)</span><br><span class="line"></span><br><span class="line"><span class="comment">#signature = pow(flag, d, n) # no, im not gonna do that</span></span><br><span class="line">signature = <span class="built_in">pow</span>(flag, crc_hqx(long_to_bytes(d), <span class="number">42</span>), n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;ct = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;signature = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">n = <span class="number">10564138776494961592014999649037456550575382342808603854749436027195501416732462075688995673939606183123561300630136824493064895936898026009104455605012656112227514866064565891419378050994219942479391748895230609700734689313646635542548646360048189895973084184133523557171393285803689091414097848899969143402526024074373298517865298596472709363144493360685098579242747286374667924925824418993057439374115204031395552316508548814416927671149296240291698782267318342722947218349127747750102113632548814928601458613079803549610741586798881477552743114563683288557678332273321812700473448697037721641398720563971130513427</span></span><br><span class="line">ct = <span class="number">5685838967285159794461558605064371935808577614537313517284872621759307511347345423871842021807700909863051421914284950799996213898176050217224786145143140975344971261417973880450295037249939267766501584938352751867637557804915469126317036843468486184370942095487311164578774645833237405496719950503828620690989386907444502047313980230616203027489995981547158652987398852111476068995568458186611338656551345081778531948372680570310816660042320141526741353831184185543912246698661338162113076490444675190068440073174561918199812094602565237320537343578057719268260605714741395310334777911253328561527664394607785811735</span></span><br><span class="line">signature = <span class="number">1275844821761484983821340844185575393419792337993640612766980471786977428905226540853335720384123385452029977656072418163973282187758615881752669563780394774633730989087558776171213164303749873793794423254467399925071664163215290516803252776553092090878851242467651143197066297392861056333834850421091466941338571527809879833005764896187139966615733057849199417410243212949781433565368562991243818187206912462908282367755241374542822443478131348101833178421826523712810049110209083887706516764828471192354631913614281317137232427617291828563280573927573115346417103439835614082100305586578385614623425362545483289428</span></span><br></pre></td></tr></table></figure>
<p>题目给出了两组数据：</p>
<script type="math/tex; mode=display">
ct = m^e \quad(mod\;n)</script><script type="math/tex; mode=display">
sig = m^{crchqx(d,42)} \quad(mod\;n)</script><p>似乎比较复杂，但是搜索一下发现说这个crchqx其实就是计算从给定数值42开始的d的crc16的值，所以其实加密指数也只有16bit，因此爆破一下这个指数，然后共模就可以了。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcdext,powmod</span><br><span class="line"></span><br><span class="line">n = <span class="number">10564138776494961592014999649037456550575382342808603854749436027195501416732462075688995673939606183123561300630136824493064895936898026009104455605012656112227514866064565891419378050994219942479391748895230609700734689313646635542548646360048189895973084184133523557171393285803689091414097848899969143402526024074373298517865298596472709363144493360685098579242747286374667924925824418993057439374115204031395552316508548814416927671149296240291698782267318342722947218349127747750102113632548814928601458613079803549610741586798881477552743114563683288557678332273321812700473448697037721641398720563971130513427</span></span><br><span class="line">ct = <span class="number">5685838967285159794461558605064371935808577614537313517284872621759307511347345423871842021807700909863051421914284950799996213898176050217224786145143140975344971261417973880450295037249939267766501584938352751867637557804915469126317036843468486184370942095487311164578774645833237405496719950503828620690989386907444502047313980230616203027489995981547158652987398852111476068995568458186611338656551345081778531948372680570310816660042320141526741353831184185543912246698661338162113076490444675190068440073174561918199812094602565237320537343578057719268260605714741395310334777911253328561527664394607785811735</span></span><br><span class="line">signature = <span class="number">1275844821761484983821340844185575393419792337993640612766980471786977428905226540853335720384123385452029977656072418163973282187758615881752669563780394774633730989087558776171213164303749873793794423254467399925071664163215290516803252776553092090878851242467651143197066297392861056333834850421091466941338571527809879833005764896187139966615733057849199417410243212949781433565368562991243818187206912462908282367755241374542822443478131348101833178421826523712810049110209083887706516764828471192354631913614281317137232427617291828563280573927573115346417103439835614082100305586578385614623425362545483289428</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>,<span class="number">2</span>**<span class="number">16</span>):</span><br><span class="line">    dd = i</span><br><span class="line">    d,x,y = gcdext(e,dd)</span><br><span class="line">    m = powmod(ct,x,n)*powmod(signature,y,n) % n</span><br><span class="line">    flag = long_to_bytes(m)</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">b&quot;ictf&quot;</span> <span class="keyword">in</span> flag):</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ictf&#123;oops_i_leaked_some_info&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="tango"><a href="#tango" class="headerlink" title="tango"></a>tango</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Let&#x27;s dance!</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> Salsa20</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, long_to_bytes</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> token_bytes, token_hex</span><br><span class="line"><span class="keyword">from</span> zlib <span class="keyword">import</span> crc32</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"></span><br><span class="line">KEY = token_bytes(<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_command</span>(<span class="params">command</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(command) != <span class="number">3</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Nuh uh.&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    cipher = Salsa20.new(key=KEY)</span><br><span class="line">    nonce = cipher.nonce</span><br><span class="line">    data = json.dumps(&#123;<span class="string">&#x27;user&#x27;</span>: <span class="string">&#x27;user&#x27;</span>, <span class="string">&#x27;command&#x27;</span>: command, <span class="string">&#x27;nonce&#x27;</span>: token_hex(<span class="number">8</span>)&#125;).encode(<span class="string">&#x27;ascii&#x27;</span>)</span><br><span class="line">    checksum = long_to_bytes(crc32(data))</span><br><span class="line">    ciphertext = cipher.encrypt(data)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Your encrypted packet is:&#x27;</span>, (nonce + checksum + ciphertext).<span class="built_in">hex</span>())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_command</span>(<span class="params">packet</span>):</span><br><span class="line">    packet = <span class="built_in">bytes</span>.fromhex(packet)</span><br><span class="line">    nonce = packet[:<span class="number">8</span>]</span><br><span class="line">    checksum = bytes_to_long(packet[<span class="number">8</span>:<span class="number">12</span>])</span><br><span class="line">    ciphertext = packet[<span class="number">12</span>:]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        cipher = Salsa20.new(key=KEY, nonce=nonce)</span><br><span class="line">        plaintext = cipher.decrypt(ciphertext)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> crc32(plaintext) != checksum:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Invalid checksum. Aborting!&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        data = json.loads(plaintext.decode(<span class="string">&#x27;ascii&#x27;</span>))</span><br><span class="line">        user = data.get(<span class="string">&#x27;user&#x27;</span>, <span class="string">&#x27;anon&#x27;</span>)</span><br><span class="line">        command = data.get(<span class="string">&#x27;command&#x27;</span>, <span class="string">&#x27;nop&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> command == <span class="string">&#x27;nop&#x27;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;...&#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span> command == <span class="string">&#x27;sts&#x27;</span>:</span><br><span class="line">            <span class="keyword">if</span> user <span class="keyword">not</span> <span class="keyword">in</span> [<span class="string">&#x27;user&#x27;</span>, <span class="string">&#x27;root&#x27;</span>]:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;o_O&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;The server is up and running.&#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span> command == <span class="string">&#x27;flag&#x27;</span>:</span><br><span class="line">            <span class="keyword">if</span> user != <span class="string">&#x27;root&#x27;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;You wish :p&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(FLAG)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Unknown command.&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span> (json.JSONDecodeError, UnicodeDecodeError):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Invalid data. Aborting!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">menu</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[E]ncrypt a command&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[R]un a command&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[Q]uit&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Welcome to the Tango server! What would you like to do?&#x27;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        menu()</span><br><span class="line">        option = <span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>).upper()</span><br><span class="line">        <span class="keyword">if</span> option == <span class="string">&#x27;E&#x27;</span>:</span><br><span class="line">            command = <span class="built_in">input</span>(<span class="string">&#x27;Your command: &#x27;</span>)</span><br><span class="line">            encrypt_command(command)</span><br><span class="line">        <span class="keyword">elif</span> option == <span class="string">&#x27;R&#x27;</span>:</span><br><span class="line">            packet = <span class="built_in">input</span>(<span class="string">&#x27;Your encrypted packet (hex): &#x27;</span>)</span><br><span class="line">            run_command(packet)</span><br><span class="line">        <span class="keyword">elif</span> option == <span class="string">&#x27;Q&#x27;</span>:</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Unknown option:&#x27;</span>, option)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>连上靶机后，靶机会随机生成32字节的KEY，之后有两个选项供选择：</p>
<ul>
<li>输入E，可以输入一个command，靶机会对command进行加密</li>
<li>输入R，可以输入一段打包的密文，靶机会拆开这段密文，进行解密+检查</li>
</ul>
<p>两种交互均可以无限次进行。</p>
<p>然后来看下加密的encrypt_command函数和解密的run_command函数分别在做什么。</p>
<p>对于encrypt，需要输入一个长度为3的字符串当作command，然后靶机会用KEY初始化一个Salsa20的加密器，并加密下面这段json：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&#x27;user&#x27;</span>: <span class="string">&#x27;user&#x27;</span>, <span class="string">&#x27;command&#x27;</span>: command, <span class="string">&#x27;nonce&#x27;</span>: token_hex(<span class="number">8</span>)&#125;</span><br></pre></td></tr></table></figure>
<p>同时，靶机会计算这段json的crc32值checksum，之后返回如下值作为密文：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nonce + checksum + ciphertext</span><br></pre></td></tr></table></figure>
<blockquote>
<p>这里需要注意一下返回的密文中的nonce和json里的nonce是不一样的。返回的nonce是本次Salsa20加密所用的nonce，而json里的nonce就是保证每次的json数据都不同而已</p>
</blockquote>
<p>而对于decrypt，其接受的数据格式就是encrypt的密文格式。在接收到输入后，会先按照格式拆分出nonce、checksum和ciphertext，然后会依次执行下面的步骤：</p>
<ul>
<li>用nonce和KEY初始化Salsa20加密器</li>
<li>用Salsa20加密器对ciphertext进行解密，得到plaintext</li>
<li>检查plaintext的crc32值是否与checksum相等，不相等则返回</li>
<li>用json加载plaintext，从中取出user和command</li>
<li>如果user为root，且command为flag，则得到flag</li>
</ul>
<p>步骤就到这里结束了。</p>
<p>首先就是Salsa20之前完全没了解过，搜索一下发现是一种流密码。也就是说给定KEY和nonce，Salsa20会以某种方式产生密钥流，然后与明文加密就得到最终密文。这也就是说，对于同样的KEY和nonce，产生的密钥流也是一样的。</p>
<p>而要利用run_command解密之前，肯定首先是要加密一次的，这样才能获取nonce从而得到完全一样的密钥流。然而对于加密，我们唯一能输入的是长为3的command，也就是不能输入flag，并且user也不能改为root，此外最后的json里的nonce每次加密都是随机产生的，也未知，就更没办法计算出crc32的值了。</p>
<p>但是处理方法也很简单，由于密钥流确定，所以我们可以随意篡改每次data的任意字节和长度，也就是说，我就输入fla作为command，那么我得到的ciphertext是对下面这段json的加密：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&#x27;user&#x27;</span>: <span class="string">&#x27;user&#x27;</span>, <span class="string">&#x27;command&#x27;</span>: <span class="string">&#x27;fla&#x27;</span>, <span class="string">&#x27;nonce&#x27;</span>: xxxxxxxxxxxxxxxx&#125;</span><br></pre></td></tr></table></figure>
<p>那么直接用下面这段json作为target：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;user&quot;</span>: <span class="string">&quot;root&quot;</span>, <span class="string">&quot;command&quot;</span>: <span class="string">&quot;flag&quot;</span>&#125;</span><br></pre></td></tr></table></figure>
<p>与上面密文的对应长度做异或就得到diff，然后把ciphertext异或上这段diff并送回去解密就可以了，checksum直接对这段target做crc32就行。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> zlib <span class="keyword">import</span> crc32</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&quot;tango.chal.imaginaryctf.org&quot;</span>, <span class="number">1337</span>)</span><br><span class="line"></span><br><span class="line">sh.sendline(<span class="string">b&quot;E&quot;</span>)</span><br><span class="line">sh.recvuntil(<span class="string">b&#x27;Your command: &#x27;</span>)</span><br><span class="line">sh.sendline(<span class="string">b&quot;fla&quot;</span>)</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;Your encrypted packet is: &quot;</span>)</span><br><span class="line">packet = <span class="built_in">bytes</span>.fromhex(sh.recvline().strip().decode())</span><br><span class="line">nonce, checksum, ciphertext = packet[:<span class="number">8</span>], bytes_to_long(packet[<span class="number">8</span>:<span class="number">12</span>]), packet[<span class="number">12</span>:]</span><br><span class="line">target = <span class="string">b&#x27;&#123;&quot;user&quot;: &quot;root&quot;, &quot;command&quot;: &quot;flag&quot;&#125;&#x27;</span></span><br><span class="line">now =    <span class="string">b&#x27;&#123;&quot;user&quot;: &quot;user&quot;, &quot;command&quot;: &quot;fla&quot;, &quot;nonce&quot;: &quot;0000000000000000&quot;&#125;&#x27;</span></span><br><span class="line">diff = xor(target,now[:<span class="built_in">len</span>(target)])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sh.sendline(<span class="string">b&quot;R&quot;</span>)</span><br><span class="line">sh.recvuntil(<span class="string">b&#x27;Your encrypted packet (hex): &#x27;</span>)</span><br><span class="line">my_checksum = long_to_bytes(crc32(target))</span><br><span class="line">my_packet = nonce + my_checksum + xor(ciphertext[:<span class="built_in">len</span>(target)],diff)</span><br><span class="line">sh.sendline(my_packet.<span class="built_in">hex</span>().encode())</span><br><span class="line"><span class="built_in">print</span>(sh.recvline())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#ictf&#123;F0xtr0t_L1m4_4lph4_G0lf&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="solitude"><a href="#solitude" class="headerlink" title="solitude"></a>solitude</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The best thinking has been done in solitude. The worst has been done in turmoil.</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">a: <span class="built_in">bytes</span>, b: <span class="built_in">bytes</span></span>):</span><br><span class="line">  out = []</span><br><span class="line">  <span class="keyword">for</span> m,n <span class="keyword">in</span> <span class="built_in">zip</span>(a,b):</span><br><span class="line">    out.append(m^n)</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">bytes</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RNG</span>():</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, size, state=<span class="literal">None</span></span>):</span><br><span class="line">    self.size = size</span><br><span class="line">    self.state = <span class="built_in">list</span>(<span class="built_in">range</span>(self.size+<span class="number">2</span>))</span><br><span class="line">    random.shuffle(self.state)</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">    idx = self.state.index(self.size)</span><br><span class="line">    self.state.pop(idx)</span><br><span class="line">    self.state.insert((idx+<span class="number">1</span>) % (<span class="built_in">len</span>(self.state)+<span class="number">1</span>), self.size)</span><br><span class="line">    <span class="keyword">if</span> self.state[<span class="number">0</span>] == self.size:</span><br><span class="line">      self.state.pop(<span class="number">0</span>)</span><br><span class="line">      self.state.insert(<span class="number">1</span>, self.size)</span><br><span class="line">    idx = self.state.index(self.size+<span class="number">1</span>)</span><br><span class="line">    self.state.pop(idx)</span><br><span class="line">    self.state.insert((idx+<span class="number">1</span>) % (<span class="built_in">len</span>(self.state)+<span class="number">1</span>), self.size+<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> self.state[<span class="number">0</span>] == self.size+<span class="number">1</span>:</span><br><span class="line">      self.state.pop(<span class="number">0</span>)</span><br><span class="line">      self.state.insert(<span class="number">1</span>, self.size+<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> self.state[<span class="number">1</span>] == self.size+<span class="number">1</span>:</span><br><span class="line">      self.state.pop(<span class="number">1</span>)</span><br><span class="line">      self.state.insert(<span class="number">2</span>, self.size+<span class="number">1</span>)</span><br><span class="line">    c1 = self.state.index(self.size)</span><br><span class="line">    c2 = self.state.index(self.size+<span class="number">1</span>)</span><br><span class="line">    self.state = self.state[<span class="built_in">max</span>(c1,c2)+<span class="number">1</span>:] + [self.size <span class="keyword">if</span> c1&lt;c2 <span class="keyword">else</span> self.size+<span class="number">1</span>] + self.state[<span class="built_in">min</span>(c1,c2)+<span class="number">1</span>:<span class="built_in">max</span>(c1,c2)] + [self.size <span class="keyword">if</span> c1&gt;c2 <span class="keyword">else</span> self.size+<span class="number">1</span>] + self.state[:<span class="built_in">min</span>(c1,c2)]</span><br><span class="line">    count = self.state[-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> count <span class="keyword">in</span> [self.size,self.size+<span class="number">1</span>]:</span><br><span class="line">      count = self.size</span><br><span class="line">    self.state = self.state[count:-<span class="number">1</span>] + self.state[:count] + self.state[-<span class="number">1</span>:]</span><br><span class="line">    idx = self.state[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> idx <span class="keyword">in</span> [self.size,self.size+<span class="number">1</span>]:</span><br><span class="line">      idx = self.size</span><br><span class="line">    out = self.state[idx]</span><br><span class="line">    <span class="keyword">if</span> out <span class="keyword">in</span> [self.size,self.size+<span class="number">1</span>]:</span><br><span class="line">      out = self.<span class="built_in">next</span>()</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">  flag = <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line">  <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;got flag? &quot;</span>))</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(i):</span><br><span class="line">      rng = RNG(<span class="number">128</span>)</span><br><span class="line">      stream = <span class="built_in">bytes</span>([rng.<span class="built_in">next</span>() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag))])</span><br><span class="line">      <span class="built_in">print</span>(xor(flag, stream).<span class="built_in">hex</span>())</span><br></pre></td></tr></table></figure>
<p>相当杂乱的一个RNG，大致来说是把0-129这些数字按某种方式每次选出一个，然后这些数字就组成了密钥流与flag异或。</p>
<p>其中，可以输入i来指定次数，每次会重新生成一个RNG并开始产生密钥流。次数多大都可以，目的是还原flag。</p>
<p>由于这个RNG感觉实在是太乱了，所以我先放弃理解直接上手试了试他的统计特性，结果发现一个结果：0这个数字几乎百分百在每个新RNG的前64个数字中最少出现一次。</p>
<p>直观一点用代码表示这个特征就是：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">res = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    rng = RNG(<span class="number">128</span>)</span><br><span class="line">    res += [rng.<span class="built_in">next</span>() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>)]</span><br><span class="line"><span class="built_in">print</span>(Counter(res).most_common(<span class="number">10</span>))</span><br></pre></td></tr></table></figure>
<p>得到结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[(<span class="number">0</span>, <span class="number">996</span>), (<span class="number">93</span>, <span class="number">546</span>), (<span class="number">106</span>, <span class="number">542</span>), (<span class="number">112</span>, <span class="number">539</span>), (<span class="number">32</span>, <span class="number">534</span>), (<span class="number">44</span>, <span class="number">533</span>), (<span class="number">99</span>, <span class="number">530</span>), (<span class="number">91</span>, <span class="number">530</span>), (<span class="number">61</span>, <span class="number">528</span>), (<span class="number">49</span>, <span class="number">527</span>)]</span><br></pre></td></tr></table></figure>
<p>而剩下的之所以都是500次多一点，是因为除了0以外，所有数字出现概率较为随机，也就是有大约64/128的概率出现在密钥流的前64个之中。</p>
<p>虽然实际上flag长度是32，但是0“更容易出现在一个新RNG的前面”这个特点是不会改变的，所以光解题来说就很容易，由于所有flag字符都与0异或的最多，所以只需要发一个很大的i过去，统计出现次数最多的也就是flag字符。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&quot;solitude.chal.imaginaryctf.org&quot;</span>,<span class="number">1337</span>)</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;got flag? &quot;</span>)</span><br><span class="line">sh.sendline(<span class="string">b&quot;10000&quot;</span>)</span><br><span class="line"></span><br><span class="line">res = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>):</span><br><span class="line">    res.append(<span class="built_in">bytes</span>.fromhex(sh.recvline().strip().decode()))</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    temp = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>):</span><br><span class="line">        temp += <span class="built_in">chr</span>(res[i][j]).encode()</span><br><span class="line">    flag += <span class="built_in">chr</span>(Counter(temp).most_common(<span class="number">1</span>)[<span class="number">0</span>][<span class="number">0</span>]).encode()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#ictf&#123;biased_rng_so_sad_6b065f93&#125;</span></span><br></pre></td></tr></table></figure>
<p>做完之后写wp的时候决定深究一下原因，具体流程用叙述的话有点长，可以自己看看。主要来说这个RNG有这么几个特点：</p>
<ul>
<li>数字有0-129，共130个</li>
<li>RNG只会产生0-127这128个数字</li>
<li>128、129这两个数字可以类比于“指针”的作用，他们在调控state如何变换</li>
</ul>
<p>但即使这样做，还是太难看出有啥地方导致这种统计特性了，所以决定用删的方式来逐个判断一下是哪一部份在作怪，最终发现即使删成这样：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">    c1 = self.state.index(self.size)</span><br><span class="line">    c2 = self.state.index(self.size+<span class="number">1</span>)</span><br><span class="line">    self.state = self.state[<span class="built_in">max</span>(c1,c2)+<span class="number">1</span>:] + [self.size <span class="keyword">if</span> c1&lt;c2 <span class="keyword">else</span> self.size+<span class="number">1</span>] + self.state[<span class="built_in">min</span>(c1,c2)+<span class="number">1</span>:<span class="built_in">max</span>(c1,c2)] + [self.size <span class="keyword">if</span> c1&gt;c2 <span class="keyword">else</span> self.size+<span class="number">1</span>] + self.state[:<span class="built_in">min</span>(c1,c2)]</span><br><span class="line">    count = self.state[-<span class="number">1</span>]    </span><br><span class="line">    self.state = self.state[count:-<span class="number">1</span>] + self.state[:count] + self.state[-<span class="number">1</span>:]</span><br><span class="line">    idx = self.state[<span class="number">0</span>]</span><br><span class="line">    out = self.state[idx]</span><br><span class="line">    <span class="keyword">return</span> out</span><br></pre></td></tr></table></figure>
<p>统计特性依然存在，并且发现前面总结的规律并不正确，0并不是在前面的位置出现概率大，而是在所有位置出现概率都更大。</p>
<p>但是还是没看明白为啥就有这个规律了，先放着吧TT。</p>
<p><br></p>
<p><br></p>
<h3 id="lf3r"><a href="#lf3r" class="headerlink" title="lf3r"></a>lf3r</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LFSR&#x27;s weakness comes from its linearity, so I come up with a new way to make it non-linear. Can you help me analyze it?</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> secrets, os</span><br><span class="line"></span><br><span class="line">n = <span class="number">256</span></span><br><span class="line">MASK = <span class="number">0x560074275752B31E43E64E99D996BC7B5A8A3DAC8B472FE3B83E6C6DDB5A26E7</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LF3R</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, n, key, mask</span>):</span><br><span class="line">        self.n = n</span><br><span class="line">        self.state = key &amp; ((<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>)</span><br><span class="line">        self.mask = mask</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self</span>):</span><br><span class="line">        v = self.state % <span class="number">3</span></span><br><span class="line">        self.state = (self.state &gt;&gt; <span class="number">1</span>) | (</span><br><span class="line">            ((self.state &amp; self.mask).bit_count() &amp; <span class="number">1</span>) &lt;&lt; (self.n - <span class="number">1</span>)</span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">int_to_base</span>(<span class="params">n, b</span>):</span><br><span class="line">    digits = []</span><br><span class="line">    <span class="keyword">while</span> n:</span><br><span class="line">        digits.append(n % b)</span><br><span class="line">        n //= b</span><br><span class="line">    <span class="keyword">return</span> digits</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    key = secrets.randbits(n)</span><br><span class="line">    lf3r = LF3R(n, key, MASK)</span><br><span class="line"></span><br><span class="line">    stream = [lf3r() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2048</span>)]</span><br><span class="line"></span><br><span class="line">    flag = os.environ[<span class="string">&quot;FLAG&quot;</span>].encode()</span><br><span class="line">    flag_digits = int_to_base(<span class="built_in">int</span>.from_bytes(flag, <span class="string">&quot;big&quot;</span>), <span class="number">3</span>)</span><br><span class="line">    stream += [(x + lf3r()) % <span class="number">3</span> <span class="keyword">for</span> x <span class="keyword">in</span> flag_digits]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;stream = &#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>output.txt：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stream = [<span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<p>这题自己做的时候路走偏了，感觉挺麻烦，但rec一来就给出了正解。</p>
<p>题目基于一个已知mask，未知初始state的LFSR递推。然而一个特殊的地方在于，每次递推之后给的并不是产生的二进制位，而是当前state模3的值。给出2048组数据，要求能够继续向后预测LFSR的递推过程，从而还原flag。</p>
<p>首先明确一个事情，就是LFSR依然完完全全在模2下递推，仅仅是给出的值是整个当前state在模3下的，这才使得整个系统显得不那么线性。那么不妨假设第一次递推前，也就是初始状态的256个bit为</p>
<script type="math/tex; mode=display">
(s_0,s_1,s_2,...,s_{255})</script><p>那么这个state对应的256bit的整数是：</p>
<script type="math/tex; mode=display">
state_0 = 2^{255}s_0 + 2^{254}s_1 + ... + 2^{1}s_{254} + 2^0s_{255}</script><p>而如果把2模3看作是等于-1的话，那么整个式子模3就变成了：</p>
<script type="math/tex; mode=display">
state_0 = (-1)^{255}s_0 + (-1)^{254}s_1 + ... + (-1)^{1}s_{254} + (-1)^0s_{255}</script><p>也就等价于：</p>
<script type="math/tex; mode=display">
state_0 = -s_0 + s_1 + ... - s_{254} + s_{255}</script><p>而下一个state也就是：</p>
<script type="math/tex; mode=display">
state_1 = -s_1 + s_2 + ... - s_{255} + s_{256}</script><p>然后把这两个相加就可以消去绝大部分项：</p>
<script type="math/tex; mode=display">
state_0 + state_1 = s_{256} - s_0</script><p>此时注意，由于s256和s0都是一个二进制位，所以相减的取值仅有-1，0，1三种情况(-1也就对应2)。可以看出，当相减取值为1或-1时，就可以确定下两个bit的值分别为1、0和0、1，所以搜集足够的比特位就可以解线性方程得到初始state了。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">256</span></span><br><span class="line">MASK = <span class="number">0x560074275752B31E43E64E99D996BC7B5A8A3DAC8B472FE3B83E6C6DDB5A26E7</span></span><br><span class="line">stream = [<span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">############################################### part1 get init_state</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">construct_matrix</span>(<span class="params">n, MASK</span>):</span><br><span class="line">    L = Matrix(GF(<span class="number">2</span>),n,n)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>):</span><br><span class="line">        L[i,i+<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        L[-<span class="number">1</span>,i] = (MASK &gt;&gt; i) &amp; <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> L</span><br><span class="line"></span><br><span class="line">L = construct_matrix(n, MASK)</span><br><span class="line">idx = <span class="number">0</span></span><br><span class="line">T = Matrix(GF(<span class="number">2</span>),identity_matrix(n))</span><br><span class="line">A = []</span><br><span class="line">b = []</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span>((stream[idx] + stream[idx+<span class="number">1</span>]) % <span class="number">3</span> == <span class="number">2</span>):</span><br><span class="line">        A.append(T[<span class="number">0</span>])</span><br><span class="line">        b.append(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">elif</span>((stream[idx] + stream[idx+<span class="number">1</span>]) % <span class="number">3</span> == <span class="number">1</span>):</span><br><span class="line">        A.append(T[<span class="number">0</span>])</span><br><span class="line">        b.append(<span class="number">1</span>)</span><br><span class="line">    T *= L</span><br><span class="line">    idx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">len</span>(b) == n <span class="keyword">or</span> idx == <span class="number">2048</span>-<span class="number">1</span>):</span><br><span class="line">        A = Matrix(GF(<span class="number">2</span>),A)</span><br><span class="line">        b = vector(GF(<span class="number">2</span>),b)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">init_state = A.solve_right(b)[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">############################################### part2 get flag</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LF3R</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, n, key, mask</span>):</span><br><span class="line">        self.n = n</span><br><span class="line">        self.state = key &amp; ((<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>)</span><br><span class="line">        self.mask = mask</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self</span>):</span><br><span class="line">        v = self.state % <span class="number">3</span></span><br><span class="line">        self.state = (self.state &gt;&gt; <span class="number">1</span>) | (</span><br><span class="line">            (<span class="built_in">bin</span>(self.state &amp; self.mask).count(<span class="string">&quot;1&quot;</span>) &amp; <span class="number">1</span>) &lt;&lt; (self.n - <span class="number">1</span>)</span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line">key = <span class="built_in">int</span>(<span class="string">&quot;&quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>,init_state)),<span class="number">2</span>)</span><br><span class="line">lf3r = LF3R(n, key, MASK)</span><br><span class="line">[lf3r() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2048</span>)]</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(stream)-<span class="number">2048</span>):</span><br><span class="line">    flag += <span class="built_in">str</span>((stream[<span class="number">2048</span>+i] - lf3r()) % <span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(flag[::-<span class="number">1</span>],<span class="number">3</span>)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#ictf&#123;mixing_modulus_is_really_annoying_right?&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="coast"><a href="#coast" class="headerlink" title="coast"></a>coast</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Isogeny cryptography seems so fun, so I build a new cryptosystem based on CSIDH.</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line">proof.<span class="built_in">all</span>(<span class="literal">False</span>)</span><br><span class="line"><span class="comment"># fmt: off</span></span><br><span class="line">ls = [<span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">29</span>, <span class="number">31</span>, <span class="number">37</span>, <span class="number">41</span>, <span class="number">43</span>, <span class="number">47</span>, <span class="number">53</span>, <span class="number">59</span>, <span class="number">61</span>, <span class="number">67</span>, <span class="number">71</span>, <span class="number">73</span>, <span class="number">79</span>, <span class="number">83</span>, <span class="number">89</span>, <span class="number">97</span>, <span class="number">101</span>, <span class="number">103</span>, <span class="number">107</span>, <span class="number">109</span>, <span class="number">113</span>, <span class="number">127</span>, <span class="number">131</span>, <span class="number">137</span>, <span class="number">139</span>, <span class="number">149</span>, <span class="number">151</span>, <span class="number">157</span>, <span class="number">163</span>, <span class="number">167</span>, <span class="number">173</span>, <span class="number">179</span>, <span class="number">181</span>, <span class="number">191</span>, <span class="number">193</span>, <span class="number">197</span>, <span class="number">199</span>, <span class="number">211</span>, <span class="number">223</span>, <span class="number">227</span>, <span class="number">229</span>, <span class="number">233</span>, <span class="number">239</span>, <span class="number">241</span>, <span class="number">251</span>, <span class="number">257</span>, <span class="number">263</span>, <span class="number">269</span>, <span class="number">271</span>, <span class="number">277</span>, <span class="number">281</span>, <span class="number">283</span>, <span class="number">293</span>, <span class="number">307</span>, <span class="number">311</span>, <span class="number">313</span>, <span class="number">317</span>, <span class="number">331</span>, <span class="number">337</span>, <span class="number">347</span>, <span class="number">349</span>, <span class="number">353</span>, <span class="number">359</span>, <span class="number">367</span>, <span class="number">373</span>, <span class="number">379</span>, <span class="number">383</span>, <span class="number">389</span>, <span class="number">397</span>, <span class="number">401</span>, <span class="number">409</span>, <span class="number">419</span>, <span class="number">421</span>, <span class="number">431</span>, <span class="number">433</span>, <span class="number">439</span>, <span class="number">443</span>, <span class="number">449</span>, <span class="number">457</span>, <span class="number">461</span>, <span class="number">463</span>, <span class="number">467</span>, <span class="number">479</span>, <span class="number">487</span>, <span class="number">491</span>, <span class="number">499</span>, <span class="number">503</span>, <span class="number">509</span>, <span class="number">521</span>, <span class="number">523</span>, <span class="number">541</span>, <span class="number">547</span>, <span class="number">557</span>, <span class="number">563</span>, <span class="number">569</span>, <span class="number">571</span>, <span class="number">577</span>, <span class="number">587</span>, <span class="number">593</span>, <span class="number">599</span>, <span class="number">601</span>, <span class="number">607</span>, <span class="number">613</span>, <span class="number">617</span>, <span class="number">619</span>, <span class="number">631</span>, <span class="number">641</span>, <span class="number">643</span>, <span class="number">647</span>, <span class="number">653</span>, <span class="number">659</span>, <span class="number">661</span>, <span class="number">673</span>, <span class="number">677</span>, <span class="number">683</span>, <span class="number">691</span>, <span class="number">701</span>, <span class="number">709</span>, <span class="number">719</span>, <span class="number">929</span>]</span><br><span class="line"><span class="comment"># fmt: on</span></span><br><span class="line">p = <span class="number">4</span> * product(ls) - <span class="number">1</span></span><br><span class="line">F = GF(p)</span><br><span class="line">E0 = EllipticCurve(F, [<span class="number">1</span>, <span class="number">0</span>])</span><br><span class="line">G = E0.gen(<span class="number">0</span>)</span><br><span class="line">base = (E0, G)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">keygen</span>():</span><br><span class="line">    <span class="keyword">return</span> [randint(-<span class="number">1</span>, <span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ls))]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exchange</span>(<span class="params">pub, priv</span>):</span><br><span class="line">    E, G = pub</span><br><span class="line">    es = priv[:]</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">any</span>(es):</span><br><span class="line">        s = +<span class="number">1</span> <span class="keyword">if</span> randint(<span class="number">0</span>, <span class="number">1</span>) <span class="keyword">else</span> -<span class="number">1</span></span><br><span class="line">        E.set_order(p + <span class="number">1</span>)</span><br><span class="line">        P = E.random_point()</span><br><span class="line">        k = prod(l <span class="keyword">for</span> l, e <span class="keyword">in</span> <span class="built_in">zip</span>(ls, es) <span class="keyword">if</span> sign(e) == s)</span><br><span class="line">        P *= (p + <span class="number">1</span>) // k</span><br><span class="line">        <span class="keyword">for</span> i, (l, e) <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">zip</span>(ls, es)):</span><br><span class="line">            <span class="keyword">if</span> sign(e) != s:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            Q = k // l * P</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> Q:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            Q.set_order(l)</span><br><span class="line">            phi = E.isogeny(Q)</span><br><span class="line">            E, P = phi.codomain(), phi(P)</span><br><span class="line">            G = phi(G)</span><br><span class="line">            es[i] -= s</span><br><span class="line">            k //= l</span><br><span class="line">    <span class="keyword">return</span> E, G</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">serialize_pub</span>(<span class="params">pub</span>):</span><br><span class="line">    E, G = pub</span><br><span class="line">    <span class="keyword">return</span> (E.a4(), E.a6(), G[<span class="number">0</span>], G[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = f.read().strip()</span><br><span class="line"></span><br><span class="line">priv_alice = keygen()</span><br><span class="line">priv_bob = keygen()</span><br><span class="line">pub_alice = exchange(base, priv_alice)</span><br><span class="line">pub_bob = exchange(base, priv_bob)</span><br><span class="line">shared_1 = exchange(pub_alice, priv_bob)</span><br><span class="line">shared_2 = exchange(pub_bob, priv_alice)</span><br><span class="line"><span class="keyword">assert</span> shared_1 == shared_2</span><br><span class="line"></span><br><span class="line">shared_secret = <span class="built_in">int</span>(shared_1[<span class="number">0</span>].j_invariant() + shared_1[<span class="number">1</span>][<span class="number">0</span>])</span><br><span class="line">key = sha256(<span class="built_in">str</span>(shared_secret).encode()).digest()</span><br><span class="line">cipher = AES.new(key, AES.MODE_CTR)</span><br><span class="line">ct = cipher.encrypt(flag)</span><br><span class="line">iv = cipher.nonce</span><br><span class="line"></span><br><span class="line">base_ser = serialize_pub(base)</span><br><span class="line">pub_alice_ser = serialize_pub(pub_alice)</span><br><span class="line">pub_bob_ser = serialize_pub(pub_bob)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;base_ser = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pub_alice_ser = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pub_bob_ser = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;ct = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;iv = &#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>output.txt：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">base_ser = (<span class="number">1</span>, <span class="number">0</span>, <span class="number">6395576350626777292729821677181541606370191430555605995902296654660733787961884662675205008112728910627829097716240328518277343733654560980779031197383306195903192278996242667385893559502924064335660043910231897229406366701069814748813352528977494567341233293392314984276702732050363273792561347300313</span>, <span class="number">4989628161531004318153788074304291273577473031059606908412965124036974844963743869216684686020120111949770513589687750670438648526142795689802013040914101895565898055896213731473214310303864435287131739468789570598441615792162769805326802317670196010077382560220110366549259348962142078308153647899274</span>)</span><br><span class="line">pub_alice_ser = (<span class="number">16796745232047376431076025485853428113133878598097917003461887969217006498108008731966744769172838839455129087919415367459511356804735314320761042839383730282543236466692745670914654548112400401873112245614944913297758267192129423214055383555189748155309668519243823656843679941140887547541583677456851</span>, <span class="number">8963816826825107706757885015960152371166552220981896678339960705520861493163941960230523020894830135812851365288978634124277530779100695340287569755423459240568704426045331208533913128865584575359563263393253534547084448818884991750356771030230632199257310184446749944357247275509600739836829962695982</span>, <span class="number">5985363780131483127972578951676841809331634397976984954623788863861777364455401615121494127550821174942018761442458411590922907440513151315213076773138479058971335280960602464177689878904986723530962048747658113657305981717196234378352404797804042544442260172818264948952275310656449986193544911288998</span>, <span class="number">11649597127875537444034607923163754235537320890125543416303955671947999961428652169037025819875497760380019726767893160005005207635230495183159964997017269895171761165208635703481382384409333096255950930548560628238229917503014555866644994772105200770892341004064761100707021002853325553967825145390381</span>)</span><br><span class="line">pub_bob_ser = (<span class="number">11074315528506118650419974941868902144061087346415910875754699136651403897503986559271837685210876546003254210356095728661380015394250217544836232370667249236726866756134031525443480212922804350247920434230860777321021642812917870058468202706130234985660019235758626667794297106070003964360950607030598</span>, <span class="number">14788615576129160240974902210621158431820003187709942310686740894110660926275619991889339611525021308542253932884035960214935758630370400596713566372704518819883473808782054060292387578412174017604910767645236213465324157607253511970477802974564062325283523478550237024031582360283010701611159519365278</span>, <span class="number">14321992806289178321304756176419224025450932661291292547666237239861901427262601709081849960088644959294041693893090273529716185385414362311881174527793744440204632764863112487952716682577231240702585919349036909411205777137409147119242850872654694352308452421920098660171268727320418419754354531076628</span>, <span class="number">7538734401643277631776877448699813925331537292810845825274725479798688685992383653831671943669387620894416031681699814135234397288844079804264499920949132059399186790837118164550554056080958276489614279355615876249173470199144967698224721556194470026970595690830845832259388888940448493603599827181272</span>)</span><br><span class="line">ct = <span class="string">b&#x27;\x8a\x1cs\xa1\xb3\xa77\x81_:\x81\xf8\x83\xc3a\x17\xe1\xd9\xcb\x0c]\x9b\xebP\x06c\x85\x9de1\xeed\x91\x0f\x87_\xf9\x9bD\x7f\xf1\xbdD\x88P\x9eO\x04&#x27;</span></span><br><span class="line">iv = <span class="string">b&#x27;\x94j;L,\xf3\xde\xc5&#x27;</span></span><br></pre></td></tr></table></figure>
<p>这是一道基于CSIDH的密钥交换，先简要介绍一下CSIDH与SIDH主要有哪些不同：</p>
<ul>
<li><p>CSIDH一般工作在由p+1光滑的素数的一次域上</p>
</li>
<li><p>Alice与Bob的私钥是一个指数列表，用来指示在每个p+1的奇素因子上进行同源移动的次数</p>
</li>
<li><p>由于是一次域，所有奇素数都只对应一个唯一的torsion，因此每个度数的同源均只有一个</p>
<blockquote>
<p>也就是对于一个确定的曲线来说，经过一个度数确定的同源，一定会到达另一条确定的曲线，这个目的地有且仅有一个。且如果按相同的度数一直同源下去最后会走出一个循环。</p>
</blockquote>
</li>
<li><p>一般是用最后到达的曲线的Montgomery form的系数A作为共享密钥，不过题目中是j不变量，应该也行</p>
</li>
</ul>
<p>而经过测试可以发现这里的CSIDH本身密钥交换的实现就有问题，在指数为负数的时候根本没有利用quadratic twisted来倒着走，所以他的整个作为私钥的指数列表其实是完全没有负数这个概念的，完全等价于01列表(-1就等价于1)。此外，由于给了初始曲线E0的生成元G，且给出了经历双方私钥交换的$\phi_A(G)$和$\phi_B(G)$，注意到刚才说过同样的torsion只有一个，所以经历了一个度为k的同源后，生成元G的阶中因子k也会随之消失，就破坏了他作为生成元的特点。</p>
<blockquote>
<p>一个简单但不太严谨的解释是，由于k-torsion作为同源的核，也就是说k-torsion中的所有点会映射到O，因此生成元的因子k自然就消失了</p>
</blockquote>
<p>因此简单的遍历一下G的阶中因子是否还存在就可以求出双方的私钥了，之后进行错误的密钥交换即可。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"><span class="comment"># fmt: off</span></span><br><span class="line">ls = [<span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">29</span>, <span class="number">31</span>, <span class="number">37</span>, <span class="number">41</span>, <span class="number">43</span>, <span class="number">47</span>, <span class="number">53</span>, <span class="number">59</span>, <span class="number">61</span>, <span class="number">67</span>, <span class="number">71</span>, <span class="number">73</span>, <span class="number">79</span>, <span class="number">83</span>, <span class="number">89</span>, <span class="number">97</span>, <span class="number">101</span>, <span class="number">103</span>, <span class="number">107</span>, <span class="number">109</span>, <span class="number">113</span>, <span class="number">127</span>, <span class="number">131</span>, <span class="number">137</span>, <span class="number">139</span>, <span class="number">149</span>, <span class="number">151</span>, <span class="number">157</span>, <span class="number">163</span>, <span class="number">167</span>, <span class="number">173</span>, <span class="number">179</span>, <span class="number">181</span>, <span class="number">191</span>, <span class="number">193</span>, <span class="number">197</span>, <span class="number">199</span>, <span class="number">211</span>, <span class="number">223</span>, <span class="number">227</span>, <span class="number">229</span>, <span class="number">233</span>, <span class="number">239</span>, <span class="number">241</span>, <span class="number">251</span>, <span class="number">257</span>, <span class="number">263</span>, <span class="number">269</span>, <span class="number">271</span>, <span class="number">277</span>, <span class="number">281</span>, <span class="number">283</span>, <span class="number">293</span>, <span class="number">307</span>, <span class="number">311</span>, <span class="number">313</span>, <span class="number">317</span>, <span class="number">331</span>, <span class="number">337</span>, <span class="number">347</span>, <span class="number">349</span>, <span class="number">353</span>, <span class="number">359</span>, <span class="number">367</span>, <span class="number">373</span>, <span class="number">379</span>, <span class="number">383</span>, <span class="number">389</span>, <span class="number">397</span>, <span class="number">401</span>, <span class="number">409</span>, <span class="number">419</span>, <span class="number">421</span>, <span class="number">431</span>, <span class="number">433</span>, <span class="number">439</span>, <span class="number">443</span>, <span class="number">449</span>, <span class="number">457</span>, <span class="number">461</span>, <span class="number">463</span>, <span class="number">467</span>, <span class="number">479</span>, <span class="number">487</span>, <span class="number">491</span>, <span class="number">499</span>, <span class="number">503</span>, <span class="number">509</span>, <span class="number">521</span>, <span class="number">523</span>, <span class="number">541</span>, <span class="number">547</span>, <span class="number">557</span>, <span class="number">563</span>, <span class="number">569</span>, <span class="number">571</span>, <span class="number">577</span>, <span class="number">587</span>, <span class="number">593</span>, <span class="number">599</span>, <span class="number">601</span>, <span class="number">607</span>, <span class="number">613</span>, <span class="number">617</span>, <span class="number">619</span>, <span class="number">631</span>, <span class="number">641</span>, <span class="number">643</span>, <span class="number">647</span>, <span class="number">653</span>, <span class="number">659</span>, <span class="number">661</span>, <span class="number">673</span>, <span class="number">677</span>, <span class="number">683</span>, <span class="number">691</span>, <span class="number">701</span>, <span class="number">709</span>, <span class="number">719</span>, <span class="number">929</span>]</span><br><span class="line"><span class="comment"># fmt: on</span></span><br><span class="line">p = <span class="number">4</span> * product(ls) - <span class="number">1</span></span><br><span class="line">F = GF(p)</span><br><span class="line">E0 = EllipticCurve(F, [<span class="number">1</span>, <span class="number">0</span>])</span><br><span class="line">G = E0.gen(<span class="number">0</span>)</span><br><span class="line">base = (E0, G)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exchange</span>(<span class="params">pub, priv</span>):</span><br><span class="line">    E, G = pub</span><br><span class="line">    es = priv[:]</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">any</span>(es):</span><br><span class="line">        s = +<span class="number">1</span> <span class="keyword">if</span> randint(<span class="number">0</span>, <span class="number">1</span>) <span class="keyword">else</span> -<span class="number">1</span></span><br><span class="line">        E.set_order(p + <span class="number">1</span>)</span><br><span class="line">        P = E.random_point()</span><br><span class="line">        k = prod(l <span class="keyword">for</span> l, e <span class="keyword">in</span> <span class="built_in">zip</span>(ls, es) <span class="keyword">if</span> sign(e) == s)</span><br><span class="line">        P *= (p + <span class="number">1</span>) // k</span><br><span class="line">        <span class="keyword">for</span> i, (l, e) <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">zip</span>(ls, es)):</span><br><span class="line">            <span class="keyword">if</span> sign(e) != s:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            Q = k // l * P</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> Q:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            Q.set_order(l)</span><br><span class="line">            phi = E.isogeny(Q)</span><br><span class="line">            E, P = phi.codomain(), phi(P)</span><br><span class="line">            G = phi(G)</span><br><span class="line">            es[i] -= s</span><br><span class="line">            k //= l</span><br><span class="line">    <span class="keyword">return</span> E, G</span><br><span class="line"></span><br><span class="line">base_ser = (<span class="number">1</span>, <span class="number">0</span>, <span class="number">6395576350626777292729821677181541606370191430555605995902296654660733787961884662675205008112728910627829097716240328518277343733654560980779031197383306195903192278996242667385893559502924064335660043910231897229406366701069814748813352528977494567341233293392314984276702732050363273792561347300313</span>, <span class="number">4989628161531004318153788074304291273577473031059606908412965124036974844963743869216684686020120111949770513589687750670438648526142795689802013040914101895565898055896213731473214310303864435287131739468789570598441615792162769805326802317670196010077382560220110366549259348962142078308153647899274</span>)</span><br><span class="line">pub_alice_ser = (<span class="number">16796745232047376431076025485853428113133878598097917003461887969217006498108008731966744769172838839455129087919415367459511356804735314320761042839383730282543236466692745670914654548112400401873112245614944913297758267192129423214055383555189748155309668519243823656843679941140887547541583677456851</span>, <span class="number">8963816826825107706757885015960152371166552220981896678339960705520861493163941960230523020894830135812851365288978634124277530779100695340287569755423459240568704426045331208533913128865584575359563263393253534547084448818884991750356771030230632199257310184446749944357247275509600739836829962695982</span>, <span class="number">5985363780131483127972578951676841809331634397976984954623788863861777364455401615121494127550821174942018761442458411590922907440513151315213076773138479058971335280960602464177689878904986723530962048747658113657305981717196234378352404797804042544442260172818264948952275310656449986193544911288998</span>, <span class="number">11649597127875537444034607923163754235537320890125543416303955671947999961428652169037025819875497760380019726767893160005005207635230495183159964997017269895171761165208635703481382384409333096255950930548560628238229917503014555866644994772105200770892341004064761100707021002853325553967825145390381</span>)</span><br><span class="line">pub_bob_ser = (<span class="number">11074315528506118650419974941868902144061087346415910875754699136651403897503986559271837685210876546003254210356095728661380015394250217544836232370667249236726866756134031525443480212922804350247920434230860777321021642812917870058468202706130234985660019235758626667794297106070003964360950607030598</span>, <span class="number">14788615576129160240974902210621158431820003187709942310686740894110660926275619991889339611525021308542253932884035960214935758630370400596713566372704518819883473808782054060292387578412174017604910767645236213465324157607253511970477802974564062325283523478550237024031582360283010701611159519365278</span>, <span class="number">14321992806289178321304756176419224025450932661291292547666237239861901427262601709081849960088644959294041693893090273529716185385414362311881174527793744440204632764863112487952716682577231240702585919349036909411205777137409147119242850872654694352308452421920098660171268727320418419754354531076628</span>, <span class="number">7538734401643277631776877448699813925331537292810845825274725479798688685992383653831671943669387620894416031681699814135234397288844079804264499920949132059399186790837118164550554056080958276489614279355615876249173470199144967698224721556194470026970595690830845832259388888940448493603599827181272</span>)</span><br><span class="line">ct = <span class="string">b&#x27;\x8a\x1cs\xa1\xb3\xa77\x81_:\x81\xf8\x83\xc3a\x17\xe1\xd9\xcb\x0c]\x9b\xebP\x06c\x85\x9de1\xeed\x91\x0f\x87_\xf9\x9bD\x7f\xf1\xbdD\x88P\x9eO\x04&#x27;</span></span><br><span class="line">iv = <span class="string">b&#x27;\x94j;L,\xf3\xde\xc5&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">################################################################ solve</span></span><br><span class="line">EA = EllipticCurve(F, [pub_alice_ser[<span class="number">0</span>],pub_alice_ser[<span class="number">1</span>]])</span><br><span class="line">phiA_G = EA(pub_alice_ser[<span class="number">2</span>],pub_alice_ser[<span class="number">3</span>])</span><br><span class="line">EB = EllipticCurve(F, [pub_bob_ser[<span class="number">0</span>],pub_bob_ser[<span class="number">1</span>]])</span><br><span class="line">phiB_G = EB(pub_bob_ser[<span class="number">2</span>],pub_bob_ser[<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">As = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ls:</span><br><span class="line">    <span class="keyword">if</span>(((p+<span class="number">1</span>) // i)*phiA_G == EA(<span class="number">0</span>)):</span><br><span class="line">        As.append(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        As.append(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">shared_1 = exchange((EB,phiB_G), As)</span><br><span class="line">shared_secret = <span class="built_in">int</span>(shared_1[<span class="number">0</span>].j_invariant() + shared_1[<span class="number">1</span>][<span class="number">0</span>])</span><br><span class="line">key = sha256(<span class="built_in">str</span>(shared_secret).encode()).digest()</span><br><span class="line">cipher = AES.new(key, AES.MODE_CTR, nonce=iv)</span><br><span class="line">flag = cipher.decrypt(ct)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#ictf&#123;just_a_very_broken_implementation_of_csidh&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="lcasm"><a href="#lcasm" class="headerlink" title="lcasm$"></a>lcasm$</h3><p>二进制的，默认自己不会。</p>
<p><br></p>
<p><br></p>
<h3 id="notitle"><a href="#notitle" class="headerlink" title="notitle*"></a>notitle*</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The keys are obfuscated by a weird magic operation.</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha512</span><br><span class="line"></span><br><span class="line">proof.<span class="built_in">all</span>(<span class="literal">False</span>)</span><br><span class="line">p = <span class="number">0x7AADA0BA1C05D63803BA6BCE66CB6BC091C7ADA62B5CB5BC9F924B528FC113971D4BC54C7FAF3C146ADEB0548BFB9258DFF316741266B802DD7A2F46F77593BAD983E6DF394C1519E8DB0130289FA5A9C628E3ABCE58C63B3379DB7088AAC7A40B63776959774B1B57B8FD316C650AE3C012A91EE653477443446050438A99E79B89B69745BD1918EECB08A0C9D45EF3C61639137F24D979FF380D65C7ABD08785F1AF99729A62F3690747AEC4CCBDA99BAE6E990A0FEFF6F1AB9ABEAFE7FB5BDDB8471C607DEC16198A2AE7776C56B5B6CA24B4C0A2441A047A18EB23302B46CC49ADFF6188FC97C886D5BF67B4B0EFF56762C4E48AAD3F02E7CFE8AA157FB1789B1</span></span><br><span class="line">F = GF(p)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">magic_op</span>(<span class="params">x, n</span>):</span><br><span class="line">    r0, r1 = <span class="number">1</span>, x</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> <span class="string">f&quot;<span class="subst">&#123;n:b&#125;</span>&quot;</span>:</span><br><span class="line">        <span class="keyword">if</span> b == <span class="string">&quot;0&quot;</span>:</span><br><span class="line">            r1 = <span class="number">2</span> * r0 * r1 - x</span><br><span class="line">            r0 = <span class="number">2</span> * r0**<span class="number">2</span> - <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            r0 = <span class="number">2</span> * r0 * r1 - x</span><br><span class="line">            r1 = <span class="number">2</span> * r1**<span class="number">2</span> - <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> r0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        flag = f.read().strip()</span><br><span class="line">    h = <span class="built_in">int</span>(sha512(flag).hexdigest(), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">    magic_pi = magic_op(F(<span class="number">314159</span>), h)</span><br><span class="line">    magic_e = magic_op(F(<span class="number">271828</span>), h)</span><br><span class="line"></span><br><span class="line">    key = os.urandom(<span class="number">16</span>)</span><br><span class="line">    k = F(<span class="built_in">int</span>.from_bytes(key, <span class="string">&quot;big&quot;</span>))</span><br><span class="line">    fake_k = [F.random_element() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">63</span>)]</span><br><span class="line">    fake_k += [k - <span class="built_in">sum</span>(fake_k)]</span><br><span class="line">    obfuscated_keys = [magic_op(k, h) <span class="keyword">for</span> k <span class="keyword">in</span> fake_k]</span><br><span class="line"></span><br><span class="line">    cipher = AES.new(key, AES.MODE_CTR)</span><br><span class="line">    ct = cipher.encrypt(flag)</span><br><span class="line">    iv = cipher.nonce</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;magic_pi = &#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;magic_e = &#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;obfuscated_keys = &#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;ct = &#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;iv = &#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>output.txt：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">magic_pi = <span class="number">5148814821900119542741261450055292586113647535732067369080655482691554380052565459741879836667166985122205831918390644340336597281539053251470086499523221365132775020379803159725553942273967210168653981106714132657280843578263021148705351143778776029557496571051812809658662726067976153186472043930315453925013490294642486555939775792002395538684028065710983702501767061099948677637628170785784723184512036672606688238070423752236657778483603721097906556034261993570775222774608063476541749544916702299880398045617340589746748928485972604335018907462971390470546547369413439887745742610507865846805659916187409855769246066</span></span><br><span class="line">magic_e = <span class="number">8878447123397871032793353635483327299966719603604645637163456750260006046180515857865901833307682085912071015731199110455704373871473760113314701165784769078987667181963959211583330276422824395469710749484200091258769774857850449793872245975923747504359937479437427303903459396846176850418095454020049581060468731625620525480615177381749700411805412315918132064189892840156850179530864345864647263106024656636294433888042438876427957061597712325859489700850421088851945938854380725546034619592618176214387229401345980744871213452008057033238556317427000191355488935507225718920441262097316074944129216518797230562213963417</span></span><br><span class="line">obfuscated_keys = [<span class="number">4326140824521956487976279790363299848688143578937727990023522238815491662350740671721514230013411757331597683368571625352388582695882636582128941646360484347134795459111236569160279150663909457407768124309279392312476336344636337502713652117848919644108537912289537322494307490254659660165575733974835847622467835578814965651031527438243253655951024082459516351436633862436384099126043526729739695974589408793403726945561938878282572240502275350253088156244371636214730224202958258359181350999902964201837940328230260016200721331892104987949025868469034207768217318927673717244644296580381717696704066699126629784882249232</span>, <span class="number">12443852187166196720263773487283365969361609467991060481955407164652241510433853083928163146416567316676178025363217117728278664255221809057719433687467466810275886907447175232228490675449517397426150486389494934608476560374723991695971918174805214710490057914531786288570435609287394946783260974440895393003319981553282456016796554678387442213355808029672092760088108657118016146417856066386654143854772884893910982387205388649305692130861026577511931693062669287514031657669618200317062312320313349947602797108676439966773727374368065488296578198977712288313471741297817131246080749281776495523725045728152013076716579287</span>, <span class="number">11783892783845819822870118117095038815104455351866333000589560749098466628752885114729156400211030676341184493016854273358000235184460998133226442870016165406925974147322395625126526284591834524316625582610271803528810859130264343844762295212699648111891630832643731292496671469062044728522576285172558908261266622769714284479597883494141193293192677562309270395117167944341612647620710597355169080040700649466338521642057317942930919487129785167269418353236763384167693221489620632450146502489746343324216092314796389520608070296144713060449325563373049259850316522648892100988388281194612063333448453461429502953505069573</span>, <span class="number">13894156638324199491589780325830647932652544899161564463071559483309546467286093405223520828169135501264802636698144156608516453216427423472361615961466613487013592996735628692789112084183006911770462544909904292646886178154723635982076885329756051981361999710089024689789416873999180519387091759639949808128828934335034206105630671166162493389440566346219873666954802229378089406087408880266698641655763151660357376758272844138884041995102251835611568833358273437505601811703195992793903089434782951182383020836633876990785303163382566116745854956335998834081239653710801745824302726034711674184913396042435545055571133792</span>, <span class="number">12678288448580042671186572469150275732822504483478141616732256941827239948358904046737688494183857567091488922251145171949955786859542694797167065162005340117661944911268231110365173088594730916095260828201812295288827844523549888068807701993173707879018614183865756424790518035581212078705997387207032364954604468540347928656995060619874359690897177473562379276785605496954007349277266990144216846433687645615455380199763058723951535981176833824218307933431198927899563580987508956169389119542592287655511500141123922463707224972886223356516031479459516982361186926716312866603420168263730649073879243570182239773829095085</span>, <span class="number">3007294520795497281042971612618310128844540139916958409280017009726485825242140286348730829573687277581285784645978145514923002927378011382555890942158454315298297591905311675413392708087984705879729621808091506645665118979702634105332675233169240984774154598329480151952278439600932572470639284867323341033534137891365118246922101858574197390664866438229887716525686547585157980145986494912912295787917764249358350330661650836463245385940512988395266502602200283381141770165120289620346213668626042898791413973369493560174862894317322568496707343437438692540388002805570813541847298532205661707949133935540996986490197477</span>, <span class="number">5150414151397048173102333802347899058497038712155283257579690234348639298884383272819016174034348114780339516279305495231131724756072480756216642522839955109208180547993963876310060836688786183828797203759791107954479064101319067743130419359786634495088015088493786197431686444905326641918372318519306288465236243786592906055846211726340837454969044165821652342742330946992403889900251785709671384558725336003250724388886409390053154050836598054959226233970754686197878915813683465988719736372179906009484488351295985183480786596004188150714175199309727969280951208386123046273613599881884323800194747636149997390176321906</span>, <span class="number">8822452485847643520056531376202657760622284461200511783685206377039813796522800232415414044464110636630309232224302892600444641934122119055647819332327533614937140614103432257826287539431363148634901301220582119950287451208090864057654810424554936975154842031917205172176217829936212424366780193081899826932340562262173489922623021011888700027727161681179146061578675674953774712387442828288434487112421184725603899915290848923075636826371960550156431176653732343229298639253640765030942086287099937580145176065193329233345632075574482989413898228726132603082154846923022856677416631598629159315889124923811272270816112735</span>, <span class="number">5530564345741667565286560935175431459904864931664757434615456196761126412190962500743165982324652394148165576198585786356807915341477218949522508476530779037517844295317564441013718727992899643842959246771073995705020705792438613183147422022822943490655629684949923020837284054212713341821314161023870400593265968850042379012837763781351761617351226946259593070029631072747837766000848785340917178837516178566179269374753220218105863917440840691005317767118783100733694368217259812166023342996922603420967961201491494881784504075759246277161159474600935372661828760637878000801501311176081503494232370265935972434405520645</span>, <span class="number">7050786732312699449019042060515010786769858607414797421582874796853275354694990669744329864630573503999226250486662967599507849745693933350481328409438454122855417386040729798833455681742061762649547726320348142063520857313221343169576590484210648746479267342322840074012017851181993087895151453981118025188771093875123268201991044281746804534260244159408849894067763479881138344976015120895300646428677400346532666225014576713571119035212998022785661234985825154866291499934926726495897257676539602704034498082339228273979951306506807247793996532403451666020129429241687379968747177124983264617320204852923682913234764987</span>, <span class="number">5039276900659266398047276548145800363446446135192214581000699675060748984346104329635667375864374083669634210849847418399402955979107949072879526290055742048319963262617321741342070063692686759985479585016894937813184093826899774787805239230982723417453911184162810655919905421268754500360609454992705830496127032285926105428672485457581172316502943305979906188456501864178709625419860050562423790107653334719999154288618946089692006847992353294712460587566251634295749564398614502158516435977797837971295255274676756336459773503001898760372828684943173035798590537886997931193573162596458101167538732250834146345969659402</span>, <span class="number">5758979144226805331210475341135327946794182699365039410088158661602138541980306673893490938905010737448041530716212543360799837605674386476048258400311741790612235657539127504614765749970084036923234722025542743703512663617133820923351137814232964714666962702878505756411219726379798159531641295570221073018042985371298809828748239340353138662907286081441293855801916674878274249926448224232275175009437867092552751245262672575806810591868632575749171767194711371225223372211564267601300128744626987017744296805117130178270938858378849326239396002268917135705050799878759162808707533012057361126013078728940721792329243108</span>, <span class="number">1702895159056171468823854947589757749228140952532080385767221090170681843555269830130551394169176690540877327837112589046144967382421591437316136148294182775816724844383034072754894526183914063087907480127483399963483948979682367931489901920500452695725151093453409410170499306787904328629621318142578909623702509467797750928863512942677686932651156236732110943353279609314490030773734639558099704027890802037569219394059333203706397847857186463593731003179309828197760781216778269268992723276653980577701472054566370211611480145528194475546669854954494087728968004515339040903714334173424117589940469697063029858293294963</span>, <span class="number">8118346686273198384298416566359739860453494777349905084314865188502216025263404196850082499071566905418671867183045095253865605532239496804112347373745439811316233249074655944105447871837733902201305216878086604539079113088078270005144382641828549894767427450020886657941741757778929216118221738333256855672918473863478310226765092064782539556466893117217230996820778216662238210243497144596968331573201579210318881796905724804697788221408330127669062281529824482501508975578102099915280088267191020727557864716435138436958250707577380361741140390514594512388292611226495585650776974775157748491808584012483243342824000654</span>, <span class="number">9859440924791794452856268296823119423269312136038813936175037949820316447248967428345383597176392641982989783210956358750539196959190343489376075059334431525446467443100739290888118438980165121928942078295181491070959121001316679784682153603078143960481506405191514941843945555738565342915055811309094729223228571036764543242632461378734882285850105027013899076391107921800039945347881723334009092620443056218859999777120746421606896661287093802181731089895032285072504061676559599152748585728992344369734651854875141083832024831749094638192094030867160130321447621984987651283940845177224428883974777987291775428361920170</span>, <span class="number">8827798874736088922209564411102702400436158486164907253829643715345394081838754458054076414210244038292929230844437285376812111434356350058445227863483114026053641737856793397482869702075779170413607658219387301243604060157441503154355673942290925864510030941412866143755338470735266159417444150836630211894840757839615014191694812501431705113376722561203958380285600633601957161971607073652999563544473273653131077459753334266791377137195124504451040521851116080049024730871437594896946591210681044717333528384921936917082029160018243978884921805335548907280756156218363196248520199505075700364198590208581088569467606556</span>, <span class="number">2461672925442236135088701785284090922635949358193800363966849184053285317198224183864003566531997883925488867215129530806281877848369895575310559797872529892257552837382755682043786800830508073424073512462946259164295558860527520996471517316770499020992271812945267958392786878593021817136104455717105142877716645527092679113274170546306023239118511199202413429216860908324460544151174993813913987719927736936215787066930172854884534723710066377097301484334733086107195420735492694188365084071809083394209016684596595876144458412488557189655051820026094495792445623034692387711532858244703246179167669945229204210165919806</span>, <span class="number">7927684068777927047740132565343313934218327980063205744067499101373535804602167911558491297487976302815973550130955003937231855705147054106923733299558971131683738592149601534200057150009587115324535226617830439373542270210081795360929288142278563650062450937624784716569252271301208677894121085666347156648836091482191960024526383996329943809068858391886961580124880252687267853680946205238627921731328436970073572807195385187535415903275787862865197435112541054010914753688827988399144627086688316830203803779420404811507179287436352918042647587165518488892577593188273226011710209211752317845566762096263794507156547601</span>, <span class="number">1895418630250936354700049120537197440921142322782583120614287082760222149208599779383034756701446917126100744778377653395641114501543663864578153693544038765210164184443335302573193473506184683882699484604377957345271970739054457104120427588151127994450621087632056347875233086546173688268326403894777960508379281098122541746793859976078451896549329593440857327501873637891358568304856773543789426468901626954957456921547353566703564246561129954591019813855581040558470546828305842915106405267670959794687781084239402560192202154097398176878233704836534672720679759015552005199034571530962787039718987994743486510622246177</span>, <span class="number">10870275403422134284519269232622625079217655376677798130539731249970465856112203546034627070508022238954476170777732851267492558214053161653266038430385864336164489148739641889875060928793452338176509966646408138982795882390667396549500309815547900098090096507214702514292582075215710057214749219460948603770980927555017177711508952233805813776113382673008485057746864898123267907885484266527942161137220879368598477962230571052951124571202585116590053922087563146365214483333022945920809104194344090881596851244838409670443748755286942003395671000841428356877343223561404760569270155106953179992551236279036420125797315289</span>, <span class="number">11280781231365477540798600759233238029156886254034890868565225673311967232542389114924202228673394526068413147995661368002203425631319518118449658992780949528628478413799232511054559315405296670137702267162866567115901045893440031359624835839127040721618639300810238564961739359334646042270004153510047896360496297914216492801552115697450869372356022668009429946053851453248923369349400551734723811676838753133200682437884707399070208360572619267032923604680665041691915972123226167010752366389314694868006078798860392326788933262529005364522594554646147938584251393289502903840847193094381950964734434006881381292005797982</span>, <span class="number">4221447318682475376308881967162474732871438961132762768648024517031763481780607649374121258982041823658360260019502139491298398021263666700224741640828215595422201630338255975119932331867061610638983983661094648673830890394165110459842258062006186378137250972691382698663972256583144152409557915124371489188961179128991338925020973643945490938298032659514857473893944070571760645842328248754874696621018371192969881144152768188597113627231277229564688690431022919874058465354656436806477431658557599885508819968388864585488234133901990903362550159714312965979464562244087209504902185697612213823736822988076530584322776391</span>, <span class="number">2156244625855235376084198594126842596133369805914182306486572593512719752786127665057483411072928078280700982867734160709072490610165336781131558314454433094095865159453347733383800244919077929585650189169099294538414474780892668258758128464394455088213236612880091745151953955453169027909954814504890678527025314500444070371792762317108423015545223996048192603163060851187479655485068758368270026325758596104871827233760616467779238231915869641537290506287345267722203100686095583953719681900660875768168744504008914557177639360303185280791739430943803207496936971332922982357096655724201524518123441185397619959559233166</span>, <span class="number">5445008535286493124251610892481360607167732253697300128821787613473169692373671603295529086410973281706696669791167963711864376876568789605285600732494571035877520112711311445682605010826689316280147942920511784355389013087033373603400560829706936165796276846228200285785903475465219340043856485198734518982669657829846917546608252330907063619622810462413964980778281402922919480224985326937973276307879865918926854256338026833942575209887008393263607831802962907685590012289672030335208987050162306242370688919966216388858226550898084556612675561161041024434768781868830273379095834392297097699708685627156532528299784300</span>, <span class="number">11673110022503574796753105367285794748766045867792965344854840864988259167464586181836183804704494682324970418049833745280922869045604409297947219356082118225162076196562309417078074275098411840664757684204271760747338408136440965618102339045720804034786078266186727660642202464582218183388185756587969749405272734127765225295531355011808890046202739946375523079562475860492673869319164694396064193617629680075393179941677177344552610686265816318550299560752434232685236264033539751265527759854782193437947896460731155437612271057513497707762609028985525402951238240544294457650966817203702274255235304349754536321572545886</span>, <span class="number">994224299033307039203579544081216591452126257653849389377462937853417730171804297192793614042170417240915527127917386254138387253255500370010575742999314488369770226303616213722163246863375092378461986226693676341847396455659597844175321334523084256392837085772314935974132587765935683295952029973141385579172104138994248199919224064905635653958958132588960963919308438170284085344099576116555202872191801831938006319726624540712516671721548363414020154699878326781397416119250104231021627228457590975320691609821968544650129513435299683989583837023371902849797405297537164049124558658894741724953959394431804415155824137</span>, <span class="number">3743333415055156113740907621766452452757020449083590505909382294540647763208563875686665901979123542074844930460731195718339336457235235513745510760006063943411852424103371004859637151870326158477897124365531595256741788380655304262850880109761161091360892726825618542511893536325147589233089592786371163814781613055872178862963583502701254673562978177540316493713309583025642416084530806253108020649729050076037100132219821401705295010081816071658391505601518232552091312774862841922389956774315822111361357559932190321057167827888953342591954026749883557045408723044550730747792185130129384495936794892342287936808245381</span>, <span class="number">1122419208737226187996760422754952233085910403589064925265208846178462945017472406817894365217799535106960004292100597927273933207475218143206999854300734494828861044783584659687514797139491599834156765844001971651488062690041276715358212796268159890967256203524030711043445458424731490880296342471374767277261484531463864680743374908039427756138795899923932711097527202111654655581745636485088400110815157973421609104203719896264493014335965141459751362899593850856011526631122252856460477038656022716355548276403603313635389513197024379390959716619019881373317721149675820760584930231783152598010011269931479845545350167</span>, <span class="number">4069460981696438366932031506383914356954574056071166342163539275094946042824287897576475057020755940427134978721333383300539038546588864186883093712076113992472867824647248566074732128638024030935724362496781576699515401608991489001070362758006159660134381818516900233906598545839788767804020896598386330753640884230767183378647201125139797732717099476777358119127238717561082767041172780150293825682416982693324276737090609511908168077939949473394302688992716758953290871096694129667582698579920743250250155454178545579144330620030884244930163917987852869423668165919363195097704513932540372185199555827766455631780776534</span>, <span class="number">5230208183283545046283645008176767761034902160068488354311577455379555121126298993992804137465435343631865669356019630374237365718722335431791030261296213202893345962102754012342909526636318369054284905662142323764817760733120044904722589671699780219194887568335470022000557496785952673227219644218700415900168214113418288616103443081828305227389845235462267739096241035880812700369543878638432684882997465230215550949011969914833258322570584474141435296504341548344946239659118167941942594876990115337651381791986890155366386074125851186000068453920985276877022708675676198500055311885371190758559852082216360723450000978</span>, <span class="number">8174418608263004643866343083873986717010771670382078016899299757533152405069048470357939921934161233349718530509121692721667574305483003837632483277099749902450515918744152620262334945946573278541840924010754947045740322843754239294805435968994984745667250066418746714270783351067914088154286695509522345397024352028075405532175066208038091122431536341862999248106505544750338720439303363548671611880913577064339068408489204541631968515028038073894257960755361266310318279928898540511252485394153721519122472151162821853539414755752761957510115378518947045559219164325572607680660625746550189153128119252488960269026454610</span>, <span class="number">10834483701877849531761631336274349018440447363766493762697858084341910484844153324554193074487395531211349670537313130004150925192162214812559123121855884378981119675021815379177401208718702366940190806340941440403052290492065094249648698449306999951583283960322033848490064621849818423485596472227257435062670972250475928793612498154136926018284310013678116922592502747779679680266470782171769056120372225319179864122903497853671995947302112737196743500002071605909227006804453100903911246104160590110018012969049199545002395249306592205324807767771665641659059904548726172084745378418309472207956068917123725415846490713</span>, <span class="number">5258947876247267513995590387792876100865627271869600154529372600702383853953366332368062842506261783895660653772300803386892925125664008632901382761018881582630010624653184887218529014677373122509582334820036352654586375463690243370770281487973633345705009768849204531860787354532025742672501370429634780186135353848756006553759500773838155166562545430140045306666249838975465471048688679058367196334385746173165107877220396726185504984027567997311740137453566090142826697527721347893525747260572150121187705977019469899119758601748778673332893243688483811140791217059720133478517748105787256249232554509573995853457101860</span>, <span class="number">3523032116764717414607030475776392998098960347196803707779079063113305449749937407313143958735754697126966379329000288671316255024363837775404126169216385155276842822358757560234953491227193673589518959792924981992554330747443615161235378105684725494877090122844794056754353014686945802606169908060991808403275526804146398734166171277536961829935139912546439444116108618274899331554507289851233891108999114132251618646727484152729231501329580825293390727581347970804154411830061991620685759381966321686945480437940639712504851567534618163316585950112757651836597793179545442335065785647080928105980218106618950706537339353</span>, <span class="number">11443323853518572421067745581802551775097758333341646869828920897084669356716973333924109287680707423017779409089474893493774884461375874707271323579758707961136715582819743725268273808215338810189522064082093018493707178567310330198522692785712741209919694155809004285276604433663614429421755607357405633281090577664155906381423271104275894921961584140413832148583362455418492578668194807400244733081829306875824119205535478739159828470320026601917948572545392651434226131244588159232027869146921466691500266934303323630114993334338006125707802472153651310203402349426857804627145817226176747336542872711346301429036985928</span>, <span class="number">12278473206784298876009438753138450410067255723072719460366652597802124929411652044565058901475729649103622769291118441322766135544907431391057600437801315993834496740172350085626766825470578242220676898913163917743816729100177040740117418635049210060820270177326178087133756560153244352005806786979474690349851359867323741400525591418115808709660950895791794714600785193945890438587907172137643423348727008511858348317369117752139942495315483389303406756977904747321558774374676018579852978213784341703444810006880029424910728950586271505751953975591371671666751185353199753059339659031347213932746215635892556308138407412</span>, <span class="number">8850147662817023428376653377578294001008164620283938693825435384405050603702979113070444608219054605269566571198055022761262416191653988327024221699644536421199702042394327458938145398146093120425356692090972327542252377415215537856966039603251598464257601238807829572343187079109847974330468726158634353373204880359702312962351652250694713966984985759084483631717197592936834135515614367541831891814612152271936175356685857393976227386596333249878428144032460389311965058075858428115058938898921885504529941153751611838405943492914677042451460442039871056181916757733805363136023544704531379589196654969186017012821317058</span>, <span class="number">5263915536049626415574018572481571891724237834997900077682506182179863059613036848473798417004192862527830753468142801671423608603426585944062303036876472773060244495752705067695967804561765294513575692055492870988986133589464383566016450709382498548359624305485586518429928352126786949273802669098348134655347878505025693553888537924962005837442713579591186167994462516339263270507301519637225498963439450311024522174256497905972433664757045042742368649337556664019789785379916689170658464621488378915226242378580609923342966087323938762192137470028475521540376716266584747999096839000960152318089193793127343090252997211</span>, <span class="number">14539911416897169251665133526113394842198117573754897963809622599862312034145384134702408320401722130555267448473608197291304658941263418172834212421318864848314188803498932269085471471761230897371377949868498260879264528324667450240186007296370203128120426850450428269258029300262112214413905534175483220922247461839724128701300334210908287323220578342800274202647731893276242289304791022996226860670401539811861944641972577530810433419056292169326782103577266522610985282450113172050824203575456855411253496190983900505782867902192995617153895114070349519410443037092338574324800019492218236752321360389075045044866776586</span>, <span class="number">14107619584295152877690535214351021030590539706390543727793077924976695179800889374619357101986129840023639954796589804819453996852445423000688464373019497895382816261582254305547609427355624939803422541037461289999382789548610286800094959676759627671757740616119249854463364458745015732267490849157422452268354861745334853138650203189976750966199832285488776557738570387826129027373449636005762160637553657599443534659491522886376431669373273884717571421784703174952248839354310274979206497660802114198911797036785028213657850341090987248144612762312703639941525394051517777388870076504595484646972592471195907832133444179</span>, <span class="number">2284233386839988947227002495964070274282558199022503985886988052458227829436605481695838534318505233405550037294418595997915518527426358020361672385001026996714988712809306021768358644872016678433188207385037791305116403549647964554925731868951015796662178749336393766161616116131811364680941411957836593501046164427066536058995679468921087219680757080953914013032960130829383138583461565927800134634374967789041206447368086566213549250227151877832572401928932697936078993641250085065824634720336182307694213174003195870301223762894211187005713840496053311443400428111639743808987990929600381204282118344738749746668956233</span>, <span class="number">12090080529983104994304367372675835679074119434268951253633189978942073242909452624910620892501805781968491373444873674435741694138272665955381586957690400868483894375228605333970810704975449396114428449280747482398174648179248684525406079277538586813381959839095027034121100887765077510388680122344054009677382688665202177763308607774332882160404400011682051420635026169154582484543358318335015478105844783238071147078827115413069983943828271257111987427608658008537091529471079884726017634360580265847859392180128862622973456900154034870334777640725451510242398867680729047582627881855171517352885916110789102063335214045</span>, <span class="number">8780410594242410454189123048923048128278636247735817978575148168489622305680160366213887932067736140460840815133747356729049647955898009648508564800043441754866109141468001744967167739859897649476767735345121905237443720915124857429127189325595735801145372444313726726536308497941169724398468229920196006075010798496227219153031870691670486105317108317532807399958445105044130157130349494558918951008657822342607930490145976005210270504662146935087065494800985678297142223374695422703802751733358176577615426268960089772682761691036839741790038242960468271102083217548915383242299421064774843685631003247040941593228767555</span>, <span class="number">12638532596286690536931793366027174524704520803329449580487191279815488768267957429530294962265166358110790727045268582010905398583737718923632418352855321816299569893548273253355886360912536787179555443675660626971767578053852932145368413925186775186130189034616600353605973889487478371018132444231428112459552495729029985844112822339751054120097879521401316189871038317733947080612839576942554900727309497216545611425178298041037192145491868916707298985731722657716924198526529317242874335474262264977345486046506312207009363930360413221163552704155627349181747911146069682199322481029869461996380115956283030128300646742</span>, <span class="number">14225693291135908811698481256861433804498034932741873120040292288731800711225001898773780895957051975452843038497064233160778994532883457153869851551779526684301330701780384146965897245766550605593704256474323407484601249890289826408468993061867651459097067836359352490280693500441683237739251760711968406953331646103425115971395938019983240456861118247563886738050381504046093561271969733387276846631761792397332823078606138333691834980274277899948370146839560961198618212477344071805085100489344286798011562967223308356031064641822482690629630439238535979705296303292099272303137067584575592241482073914160049339828743460</span>, <span class="number">1371670846041867260324589060779747235090520844266535521996198703027252534965066155432167957250347116898696089245834653043285897613533451342716539524134897244554432839433863280867709818564304583214122445966696514217618338208412200249320335077945902857539333897623931908357788289063897841985203344008004850311149383426025850199789717445826201731415077049801079165534704181238520325639719580742119306348369420916683290530533306355453512795294878930074341810793303241562580557691620348834633009439601498533767423479873465716693383171542209708107935387189837715680781850228484843541798561174770702316729791473055450285943188265</span>, <span class="number">14708623804859337495233293249705554627856957953621073620574738343860442527437860459714392963432307565548395191553067287274734757641150929665498184091033973576720183502674585730232215192920711432115081065232565013337995748491222320937509734212639300113206532377476575263455729130986937361555117756308715691421831641649823135341333402616684672914850677982415341526608702608573542769062092203386950581245889146839759080652674215267660170986778798088035444904448061916724833904274789061415486957713985215321172801596973918213065262786043657431578763182103447000231844339769996252181071717290376583199617702912965525367542660535</span>, <span class="number">2079525942186153669295901492783740853212676561024193444780638988637847835644756443586890166439134698718932408243774425537995619928125603250628129115417902964735855519616272717379878048344881168224345684347364945700147131969989821058820879460314431635876119848428938120985381125003300617209346969998813735787567448774119589168695501044320014748099471066312674185119281298743032855120434892720428182236503714739337394039640707118038361657304942328498599585592181382144837561952879360025526179800392653477378744457281856741910408517044085784236670891450567973147640935080531824447313097181533661742399531352379822738701176567</span>, <span class="number">14792590665641028843033432480061660678975535819902801605571661546859426944131644568533395689046584811184391064144364792722577364068548209812474918806539788935075918298444261756722804477814663215497569069435454115120970529083814165863023872402563758552891206856042823668630816466927169339616898566240975080602419989584571252545007212013771626517775440419830425518552096774200225677449669460551889774509420628915115620873014862248765180503211726719165513374467773188013372007320110305669595026735996749618153282645159688914676920961714313055226046583528196528706063553983176539656599868939612854821053695656456430891836046092</span>, <span class="number">5421429792702568956729448569045195983852090988415758953575732945204333711957283060401211013931083588517500706846881352630854446235353695717332891228089451477378334669684360562646633015073537524338852194521249427314890306475465753890159977531883008697154603946794774313081972383969295442439137905948514986021418741247625670140599363209300238798422485012201480741035076590484076842740075780444289079509316382144446939083621783753965961898295535663162366825928320927006075967490264774219761948688976913098380134041630258553195459377700387995095857287227516370666281688103676000985604139928039764842944488391533010282401307918</span>, <span class="number">16178649325955842402878726248274823977309882506287302051961519684678802473114984617129333886148676799264635697963162832407100014691313801065797257437738519413038009847443318468797712116507107655903883044657970891310434813181545857360877275166548832189441979343030869350342946775702769146866214177165615311698901131147756167307227871668925809119371545250957131383939530183858600239845959699502960614528416837991687740058988062457118493477726348647535783604491447947002705228049650535453941845139580036524797171208903103984021381203471446362051930563808412078372484826383291672504121158412234425121958956560049726681796458734</span>, <span class="number">12609070105293050032848354708018025837063434503582939534855910239145322982669910473099388994113585907117312785941621522138076245516915577287852137982922803644060389479313880830623331634893838694405730013003743693865572486882307987016754787497582569571661406019033781198714521464606337359283147168906981614965735718230451877685435341337703571146714065735073556120719072348605350825240780876718002822374738460929998616328204174997582615499347552490165673535936109614190286423405201342438329251427185192818400581782142365403936506839499607039824377039122860846979829061386657756765366423303110962894985948551557898044626520095</span>, <span class="number">9424965984496651484696657367909446260942288240190190698080921833233653936277820348366348390264424261125141209375609118804226748811202714702967509258633148036415861309844015290410849991983709975340404728355494662203464963072235301554629381315134034783443037192238889932533301386357067633343193806816389244330084958270436126743642138397636786107253658973748153321925404243737725838101876051556793957537338106495518601017626816023679179074471278491918165145736726928755193593981174950170246606456222849178073824126075666917676831714930509928718405241759798553287221291664744401366668653741945990878092081172185103150896602330</span>, <span class="number">15116293680355608338382791908385195283995972537295926894651657778746497438491427943524354548499488171820197683012030663683009969734274886185767682528288749245942824531167213740939529660288282528025448769877881201963613912521520383794047380940601728197607425184251757234478463578833143818325215615477550188629794292013102489486566656942696426311298741696919903494480394822253005781518237470439964919901355722461444434410078168995692467731258451461849270266711569207791040632693282795598661262568749935159035305150669987269220844848184218436833596127591160110003781920164166758213975872142293778849841543045307561185605113401</span>, <span class="number">1925238780806008102331032014237481353073397536634789799780429015027648664934529654073221644947817960511486112318301594817736082765502076327789930564296518837005007795961552049501019490821880634700284284306694114847827819156811008668558676520544849867590766448108687206550783084199492021214339226151215819239963158100824675703324701240211222614703150885619803722271810351872083128322252115758690757299997463743499088521978157395068004235755181332814982338144201686541896056301556512030112746666153349320356084364709773383265777676988901698155268493906326020459185891222641964911152490415118379628499580159035557298181418290</span>, <span class="number">6821849778594062649763965434134147407981452386318528626049695128123610596804507486709291218053525228591339504038628576822848502138629519482167041154933105202131743197025133753406343212154773378664369808778950824953150391692115439636038281207318564530422025116063083561199444521236903613135585947543910910387167551982579105450569703737345719081978256626998176599150666634267571212434728450900702104872971864246156985076624004994146096408054023255040510677521305488234666884264243967139738435724930192717598240505994041162031562208515957026565435496680211293045131394063363315639312247735761004084950672659526629560827232941</span>, <span class="number">11981658011637873125680072618645994877624974013490208181802570503366160145273496194862623908588507029909145260125047107768764622482979310794547412998167142447953991400201229952905629766207486104328013007982288279354665890858545171420935476023773195871424546693467474150593391025768275500016977515166160189274993869882233828204705286795205657154575481111744059893515156011082485636881326837499293773034052147746640263638446885444421593297652460492447419834930083193292556328827661748026267333937588974753235170684027180848719469966309281347273505332264604442713377431337824526264857750170389969931851540203502894039498691967</span>, <span class="number">11256187409460270898265956394919678546929858727894223405333146256596470748947568358990433496164501643161730637614822508248765153092768766403694929925847705408792551692872276134518982137483584503721024087826406608103314996701570229190632978246419763933567142024184547947234530444612320108228238688804560571233110645182028817928582954949635282409260517213694673281160430235903401583991245835254121494686959061154478141094037987083918064542081105776691719972726391443985512291367926752898233233685180826635774222221703327119039039619107375045711773427582069998788349194225275031270464603676060061131743763511360826998034100991</span>, <span class="number">3319411965977730047648576917115688681976487870497815679902781110387252550220069019764562095986350303663002203821987514988421271558817221111338171556585872726565037061707807664741784768360668802006071574833246269217766938363474498862500197198370431931173791572421237207825891865985215814966857698153030397761236161957563601153665960536567949074742904655863603013948776579645484745161923464067657660239853804008863759163376848796762923763270847767153196111649856562654450306169666851528000816678125042428968196740859821974508588002054755848189988129603586891365220858852353693110249092425685104763097043924139904088800060521</span>, <span class="number">12440733317606575382710352654318473546589355635168021140657311851351055049847357265508697455805212918041025852751144015875248385455958299170054295854074464215581465263695823276600100679497078078322749491562405691274733378272823429315886588020768610470548278605470535075891323522097959489061870147238336983777144580058079600244467447792703903044627942703163070641612348212379039433161926552680997068363633596337504852569005001761539244734999135715440517028678902856488108828144264464893776800718718769958123168739501612398053156833948455014893392750135833482573323635978924922526215270385957216940667132162533975033895346775</span>, <span class="number">5757567941375580530435243651475354104501304019243937132799740546112033707027787914785768694342613775393744981241875527473314336947343193046466811789827733032642693667836972992206328861262460815481283166148914250630615316898458133055858878316444987377662565209542565056651965583081675595077558270488418534841546646235033376395051972428946326063968947133466955959425308477840732694061795833483179676288375644160800443024134992004563418806064994731107175193062378828884502809042962669482278048331982443799467318391557500729421837035812255908651432139645293591708317718612904319634655922778481117799526048985085267704172550041</span>, <span class="number">9829609956686583539845069342696192764417537911788107771859991393028091055220219008364425207849530065035154708694451213195271189116553389726957933134001936390978467737576421151103158874895274463488487765290953286298411444402871366777853110162314320038942558116305509076778891448363467504402514360289853588404894996298931303558346072378994874744743151838536819125707671305088120463629820871750181161777604563619897177298201988691579822105396918784197227480834608483198525121412178838344219369353861507273954874828624243451208368171223558656148999897034543214094636582878880955458855203080241088957507238168846515021722590366</span>, <span class="number">903703112768796183752069095763743554139797329197818971787841058004305700873207795820933992676806887620939596382846897408637351844794124411428902053648778006381126009317839874111084800541365808374023555938251717267473357191672167482202178157424570290263028939328749310167594541509949940210031310343596411750505234867344384444828089529554118151805058227356571346033364555417594766601791035174426960534074575507876829870106496985014718717331094109927348344717736408835527237280542510019005294523453490783084257941123449565664192188834403616442808417208937363198937058818592325903996360057972740547659042534740843072009139249</span>, <span class="number">4563431876926279903130938771973599753940044870201518046127908129409343089167342982354018725080391717464418066015241113361936860070231381602919316276969174866674035834321486781239937851119742414306767123060674749136547608888260951563444903884008810600799956465626549802548489024365405139230435972233252715513445481429533830151912566960320815379604390194802689334888564099349600886696470080642472404932839931517971905017769157249769345864132437402613647889332517219347314966089012391356518890836394547508933891335220586269002333185336386567891310665204219719676264881128639830424174841904902298242722065731296746803365913815</span>]</span><br><span class="line">ct = <span class="string">b&#x27;\xb7\x91\xcd\x11\xdc\x8f\x89\xbe\x02x\xcd4U\xf6\xfaE\xee\xa6\x96a\xab\x08zw3\x1bo&amp;\xc4\xc7\x00\x9b\xb7\x02_\xc0\xdd\xae\xa4\xf5\n\x15\x8e\xb5\x1fHUm\xe3Z\x92\x10Ys\xc9v\xf6\xee\x99&#x27;</span></span><br><span class="line">iv = <span class="string">b&#x27;DO\xf4Kc\x1f?7&#x27;</span></span><br></pre></td></tr></table></figure>
<p>题目给了一个很奇怪的运算magic_op，为了方便表示就把他记为$f$，然后给出了以下几个奇怪的值：</p>
<script type="math/tex; mode=display">
f(314159,h)</script><script type="math/tex; mode=display">
f(271828,h)</script><p>然后又给了很多组：</p>
<script type="math/tex; mode=display">
f(k_i,h) , i \in \{0,1,2,...,63\}</script><p>其中k都是未知的，要求解出k才能解AES，此外h是某个未知的SHA512值。</p>
<p>做这个题的时候真是一点头脑也摸不到，因为magic_op看上去是个矩阵之类的运算，但是想上手写发现完全不会写，最后也没有一点进展。</p>
<p>赛后看maple的wp，才知道这个神奇的运算其实是某种群的运算，由于经测试，对于任意x，下列条件有且仅有一个成立：</p>
<script type="math/tex; mode=display">
f(x,p-1) = 1</script><script type="math/tex; mode=display">
f(x,p+1) = 1</script><p>也就是说这一定同构于一个阶为p-1或阶为p+1的子群，并且所有元素x一定在其中一个里。而分解一下p-1和p+1可以发现，p-1有一部分是光滑的，而p+1甚至可以完全分解。并且经过测试得到：</p>
<script type="math/tex; mode=display">
f(314159,p-1) = 1</script><script type="math/tex; mode=display">
f(271828,p+1) = 1</script><p>所以由于p+1的因子全部知道，因此对第二组数据在p+1下求dlp，如果有个512bit的h，那就是h本身了。</p>
<blockquote>
<p>因为如果的确在p+1这个子群下，实际上求出来的是h % (p+1)，也就是h本身</p>
</blockquote>
<p>然而实操的时候发现，虽然p+1能完全分解掉，但是最后一个因子38738895416631107有接近60bit，不是很利于求dlp，所以maple的方法是分别对两组数据的光滑因子求pohlig-hellman，然后crt起来得到最终的h，以h的大小是否接近512bit来判定是不是正确。</p>
<blockquote>
<p>这个部分是我这题最昏的地方，这群太神奇了，不知道为什么一定需要映射到二次扩域上才能dlp，我这里直接在一次的乘法群上去pohlig-hellman一直打不通。同时也不知道为啥还要分正负crt，先将就着用吧，之后再回头看</p>
</blockquote>
<p>求出了h之后，那么我们现在等于拥有多个如下形式的值：</p>
<script type="math/tex; mode=display">
hk_i , i \in \{0,1,2,...,63\}</script><p>由群的知识可以知道，如果ki在阶为p-1的群中，那么hki当然也在，所以依然可以通过magic_op来判定某个元素在哪个群中，然后求h关于群阶的逆元就可以解密了。</p>
<p>但是有一个问题就是h求出来是个偶数，所以会有多解，难以确定到底哪个解才是真正的ki。但这个问题也很容易，由于我们知道每个ki中有且仅有一个是正确的，并且所有正确的ki的和是AES的key，仅仅只有128bit，所以其和很小，可以用noise_crt的类似做法来规约出这个很小的和以及真正的系数。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">proof.<span class="built_in">all</span>(<span class="literal">False</span>)</span><br><span class="line">p = <span class="number">0x7AADA0BA1C05D63803BA6BCE66CB6BC091C7ADA62B5CB5BC9F924B528FC113971D4BC54C7FAF3C146ADEB0548BFB9258DFF316741266B802DD7A2F46F77593BAD983E6DF394C1519E8DB0130289FA5A9C628E3ABCE58C63B3379DB7088AAC7A40B63776959774B1B57B8FD316C650AE3C012A91EE653477443446050438A99E79B89B69745BD1918EECB08A0C9D45EF3C61639137F24D979FF380D65C7ABD08785F1AF99729A62F3690747AEC4CCBDA99BAE6E990A0FEFF6F1AB9ABEAFE7FB5BDDB8471C607DEC16198A2AE7776C56B5B6CA24B4C0A2441A047A18EB23302B46CC49ADFF6188FC97C886D5BF67B4B0EFF56762C4E48AAD3F02E7CFE8AA157FB1789B1</span></span><br><span class="line">F = GF(p)</span><br><span class="line">K = GF(p**<span class="number">2</span>, <span class="string">&quot;a&quot;</span>)</span><br><span class="line"><span class="comment">#p-1</span></span><br><span class="line">r1 = <span class="number">32090597631875496964875824460641091296628030027330309270573588881699593258049492214648292205225010111468663778228033045339445804490552722382348336318865847719914851913737484451240783616294102245396637177371574819217147012208300441560023891282015402732149110315530519720930056963731560649365139635779017776119600025753742823545028690464302214723068726007943829580947008199206705401817636950825543787766807185293761967238938853522371566190222852636237278457796298025574931849223290873819297382019894964502598331073287197009</span></span><br><span class="line"><span class="comment">#p+1</span></span><br><span class="line">r2 = <span class="number">38738895416631107</span>^<span class="number">30</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################################################## part1 get h</span></span><br><span class="line">magic_pi = <span class="number">5148814821900119542741261450055292586113647535732067369080655482691554380052565459741879836667166985122205831918390644340336597281539053251470086499523221365132775020379803159725553942273967210168653981106714132657280843578263021148705351143778776029557496571051812809658662726067976153186472043930315453925013490294642486555939775792002395538684028065710983702501767061099948677637628170785784723184512036672606688238070423752236657778483603721097906556034261993570775222774608063476541749544916702299880398045617340589746748928485972604335018907462971390470546547369413439887745742610507865846805659916187409855769246066</span></span><br><span class="line">magic_e = <span class="number">8878447123397871032793353635483327299966719603604645637163456750260006046180515857865901833307682085912071015731199110455704373871473760113314701165784769078987667181963959211583330276422824395469710749484200091258769774857850449793872245975923747504359937479437427303903459396846176850418095454020049581060468731625620525480615177381749700411805412315918132064189892840156850179530864345864647263106024656636294433888042438876427957061597712325859489700850421088851945938854380725546034619592618176214387229401345980744871213452008057033238556317427000191355488935507225718920441262097316074944129216518797230562213963417</span></span><br><span class="line">obfuscated_keys = [<span class="number">4326140824521956487976279790363299848688143578937727990023522238815491662350740671721514230013411757331597683368571625352388582695882636582128941646360484347134795459111236569160279150663909457407768124309279392312476336344636337502713652117848919644108537912289537322494307490254659660165575733974835847622467835578814965651031527438243253655951024082459516351436633862436384099126043526729739695974589408793403726945561938878282572240502275350253088156244371636214730224202958258359181350999902964201837940328230260016200721331892104987949025868469034207768217318927673717244644296580381717696704066699126629784882249232</span>, <span class="number">12443852187166196720263773487283365969361609467991060481955407164652241510433853083928163146416567316676178025363217117728278664255221809057719433687467466810275886907447175232228490675449517397426150486389494934608476560374723991695971918174805214710490057914531786288570435609287394946783260974440895393003319981553282456016796554678387442213355808029672092760088108657118016146417856066386654143854772884893910982387205388649305692130861026577511931693062669287514031657669618200317062312320313349947602797108676439966773727374368065488296578198977712288313471741297817131246080749281776495523725045728152013076716579287</span>, <span class="number">11783892783845819822870118117095038815104455351866333000589560749098466628752885114729156400211030676341184493016854273358000235184460998133226442870016165406925974147322395625126526284591834524316625582610271803528810859130264343844762295212699648111891630832643731292496671469062044728522576285172558908261266622769714284479597883494141193293192677562309270395117167944341612647620710597355169080040700649466338521642057317942930919487129785167269418353236763384167693221489620632450146502489746343324216092314796389520608070296144713060449325563373049259850316522648892100988388281194612063333448453461429502953505069573</span>, <span class="number">13894156638324199491589780325830647932652544899161564463071559483309546467286093405223520828169135501264802636698144156608516453216427423472361615961466613487013592996735628692789112084183006911770462544909904292646886178154723635982076885329756051981361999710089024689789416873999180519387091759639949808128828934335034206105630671166162493389440566346219873666954802229378089406087408880266698641655763151660357376758272844138884041995102251835611568833358273437505601811703195992793903089434782951182383020836633876990785303163382566116745854956335998834081239653710801745824302726034711674184913396042435545055571133792</span>, <span class="number">12678288448580042671186572469150275732822504483478141616732256941827239948358904046737688494183857567091488922251145171949955786859542694797167065162005340117661944911268231110365173088594730916095260828201812295288827844523549888068807701993173707879018614183865756424790518035581212078705997387207032364954604468540347928656995060619874359690897177473562379276785605496954007349277266990144216846433687645615455380199763058723951535981176833824218307933431198927899563580987508956169389119542592287655511500141123922463707224972886223356516031479459516982361186926716312866603420168263730649073879243570182239773829095085</span>, <span class="number">3007294520795497281042971612618310128844540139916958409280017009726485825242140286348730829573687277581285784645978145514923002927378011382555890942158454315298297591905311675413392708087984705879729621808091506645665118979702634105332675233169240984774154598329480151952278439600932572470639284867323341033534137891365118246922101858574197390664866438229887716525686547585157980145986494912912295787917764249358350330661650836463245385940512988395266502602200283381141770165120289620346213668626042898791413973369493560174862894317322568496707343437438692540388002805570813541847298532205661707949133935540996986490197477</span>, <span class="number">5150414151397048173102333802347899058497038712155283257579690234348639298884383272819016174034348114780339516279305495231131724756072480756216642522839955109208180547993963876310060836688786183828797203759791107954479064101319067743130419359786634495088015088493786197431686444905326641918372318519306288465236243786592906055846211726340837454969044165821652342742330946992403889900251785709671384558725336003250724388886409390053154050836598054959226233970754686197878915813683465988719736372179906009484488351295985183480786596004188150714175199309727969280951208386123046273613599881884323800194747636149997390176321906</span>, <span class="number">8822452485847643520056531376202657760622284461200511783685206377039813796522800232415414044464110636630309232224302892600444641934122119055647819332327533614937140614103432257826287539431363148634901301220582119950287451208090864057654810424554936975154842031917205172176217829936212424366780193081899826932340562262173489922623021011888700027727161681179146061578675674953774712387442828288434487112421184725603899915290848923075636826371960550156431176653732343229298639253640765030942086287099937580145176065193329233345632075574482989413898228726132603082154846923022856677416631598629159315889124923811272270816112735</span>, <span class="number">5530564345741667565286560935175431459904864931664757434615456196761126412190962500743165982324652394148165576198585786356807915341477218949522508476530779037517844295317564441013718727992899643842959246771073995705020705792438613183147422022822943490655629684949923020837284054212713341821314161023870400593265968850042379012837763781351761617351226946259593070029631072747837766000848785340917178837516178566179269374753220218105863917440840691005317767118783100733694368217259812166023342996922603420967961201491494881784504075759246277161159474600935372661828760637878000801501311176081503494232370265935972434405520645</span>, <span class="number">7050786732312699449019042060515010786769858607414797421582874796853275354694990669744329864630573503999226250486662967599507849745693933350481328409438454122855417386040729798833455681742061762649547726320348142063520857313221343169576590484210648746479267342322840074012017851181993087895151453981118025188771093875123268201991044281746804534260244159408849894067763479881138344976015120895300646428677400346532666225014576713571119035212998022785661234985825154866291499934926726495897257676539602704034498082339228273979951306506807247793996532403451666020129429241687379968747177124983264617320204852923682913234764987</span>, <span class="number">5039276900659266398047276548145800363446446135192214581000699675060748984346104329635667375864374083669634210849847418399402955979107949072879526290055742048319963262617321741342070063692686759985479585016894937813184093826899774787805239230982723417453911184162810655919905421268754500360609454992705830496127032285926105428672485457581172316502943305979906188456501864178709625419860050562423790107653334719999154288618946089692006847992353294712460587566251634295749564398614502158516435977797837971295255274676756336459773503001898760372828684943173035798590537886997931193573162596458101167538732250834146345969659402</span>, <span class="number">5758979144226805331210475341135327946794182699365039410088158661602138541980306673893490938905010737448041530716212543360799837605674386476048258400311741790612235657539127504614765749970084036923234722025542743703512663617133820923351137814232964714666962702878505756411219726379798159531641295570221073018042985371298809828748239340353138662907286081441293855801916674878274249926448224232275175009437867092552751245262672575806810591868632575749171767194711371225223372211564267601300128744626987017744296805117130178270938858378849326239396002268917135705050799878759162808707533012057361126013078728940721792329243108</span>, <span class="number">1702895159056171468823854947589757749228140952532080385767221090170681843555269830130551394169176690540877327837112589046144967382421591437316136148294182775816724844383034072754894526183914063087907480127483399963483948979682367931489901920500452695725151093453409410170499306787904328629621318142578909623702509467797750928863512942677686932651156236732110943353279609314490030773734639558099704027890802037569219394059333203706397847857186463593731003179309828197760781216778269268992723276653980577701472054566370211611480145528194475546669854954494087728968004515339040903714334173424117589940469697063029858293294963</span>, <span class="number">8118346686273198384298416566359739860453494777349905084314865188502216025263404196850082499071566905418671867183045095253865605532239496804112347373745439811316233249074655944105447871837733902201305216878086604539079113088078270005144382641828549894767427450020886657941741757778929216118221738333256855672918473863478310226765092064782539556466893117217230996820778216662238210243497144596968331573201579210318881796905724804697788221408330127669062281529824482501508975578102099915280088267191020727557864716435138436958250707577380361741140390514594512388292611226495585650776974775157748491808584012483243342824000654</span>, <span class="number">9859440924791794452856268296823119423269312136038813936175037949820316447248967428345383597176392641982989783210956358750539196959190343489376075059334431525446467443100739290888118438980165121928942078295181491070959121001316679784682153603078143960481506405191514941843945555738565342915055811309094729223228571036764543242632461378734882285850105027013899076391107921800039945347881723334009092620443056218859999777120746421606896661287093802181731089895032285072504061676559599152748585728992344369734651854875141083832024831749094638192094030867160130321447621984987651283940845177224428883974777987291775428361920170</span>, <span class="number">8827798874736088922209564411102702400436158486164907253829643715345394081838754458054076414210244038292929230844437285376812111434356350058445227863483114026053641737856793397482869702075779170413607658219387301243604060157441503154355673942290925864510030941412866143755338470735266159417444150836630211894840757839615014191694812501431705113376722561203958380285600633601957161971607073652999563544473273653131077459753334266791377137195124504451040521851116080049024730871437594896946591210681044717333528384921936917082029160018243978884921805335548907280756156218363196248520199505075700364198590208581088569467606556</span>, <span class="number">2461672925442236135088701785284090922635949358193800363966849184053285317198224183864003566531997883925488867215129530806281877848369895575310559797872529892257552837382755682043786800830508073424073512462946259164295558860527520996471517316770499020992271812945267958392786878593021817136104455717105142877716645527092679113274170546306023239118511199202413429216860908324460544151174993813913987719927736936215787066930172854884534723710066377097301484334733086107195420735492694188365084071809083394209016684596595876144458412488557189655051820026094495792445623034692387711532858244703246179167669945229204210165919806</span>, <span class="number">7927684068777927047740132565343313934218327980063205744067499101373535804602167911558491297487976302815973550130955003937231855705147054106923733299558971131683738592149601534200057150009587115324535226617830439373542270210081795360929288142278563650062450937624784716569252271301208677894121085666347156648836091482191960024526383996329943809068858391886961580124880252687267853680946205238627921731328436970073572807195385187535415903275787862865197435112541054010914753688827988399144627086688316830203803779420404811507179287436352918042647587165518488892577593188273226011710209211752317845566762096263794507156547601</span>, <span class="number">1895418630250936354700049120537197440921142322782583120614287082760222149208599779383034756701446917126100744778377653395641114501543663864578153693544038765210164184443335302573193473506184683882699484604377957345271970739054457104120427588151127994450621087632056347875233086546173688268326403894777960508379281098122541746793859976078451896549329593440857327501873637891358568304856773543789426468901626954957456921547353566703564246561129954591019813855581040558470546828305842915106405267670959794687781084239402560192202154097398176878233704836534672720679759015552005199034571530962787039718987994743486510622246177</span>, <span class="number">10870275403422134284519269232622625079217655376677798130539731249970465856112203546034627070508022238954476170777732851267492558214053161653266038430385864336164489148739641889875060928793452338176509966646408138982795882390667396549500309815547900098090096507214702514292582075215710057214749219460948603770980927555017177711508952233805813776113382673008485057746864898123267907885484266527942161137220879368598477962230571052951124571202585116590053922087563146365214483333022945920809104194344090881596851244838409670443748755286942003395671000841428356877343223561404760569270155106953179992551236279036420125797315289</span>, <span class="number">11280781231365477540798600759233238029156886254034890868565225673311967232542389114924202228673394526068413147995661368002203425631319518118449658992780949528628478413799232511054559315405296670137702267162866567115901045893440031359624835839127040721618639300810238564961739359334646042270004153510047896360496297914216492801552115697450869372356022668009429946053851453248923369349400551734723811676838753133200682437884707399070208360572619267032923604680665041691915972123226167010752366389314694868006078798860392326788933262529005364522594554646147938584251393289502903840847193094381950964734434006881381292005797982</span>, <span class="number">4221447318682475376308881967162474732871438961132762768648024517031763481780607649374121258982041823658360260019502139491298398021263666700224741640828215595422201630338255975119932331867061610638983983661094648673830890394165110459842258062006186378137250972691382698663972256583144152409557915124371489188961179128991338925020973643945490938298032659514857473893944070571760645842328248754874696621018371192969881144152768188597113627231277229564688690431022919874058465354656436806477431658557599885508819968388864585488234133901990903362550159714312965979464562244087209504902185697612213823736822988076530584322776391</span>, <span class="number">2156244625855235376084198594126842596133369805914182306486572593512719752786127665057483411072928078280700982867734160709072490610165336781131558314454433094095865159453347733383800244919077929585650189169099294538414474780892668258758128464394455088213236612880091745151953955453169027909954814504890678527025314500444070371792762317108423015545223996048192603163060851187479655485068758368270026325758596104871827233760616467779238231915869641537290506287345267722203100686095583953719681900660875768168744504008914557177639360303185280791739430943803207496936971332922982357096655724201524518123441185397619959559233166</span>, <span class="number">5445008535286493124251610892481360607167732253697300128821787613473169692373671603295529086410973281706696669791167963711864376876568789605285600732494571035877520112711311445682605010826689316280147942920511784355389013087033373603400560829706936165796276846228200285785903475465219340043856485198734518982669657829846917546608252330907063619622810462413964980778281402922919480224985326937973276307879865918926854256338026833942575209887008393263607831802962907685590012289672030335208987050162306242370688919966216388858226550898084556612675561161041024434768781868830273379095834392297097699708685627156532528299784300</span>, <span class="number">11673110022503574796753105367285794748766045867792965344854840864988259167464586181836183804704494682324970418049833745280922869045604409297947219356082118225162076196562309417078074275098411840664757684204271760747338408136440965618102339045720804034786078266186727660642202464582218183388185756587969749405272734127765225295531355011808890046202739946375523079562475860492673869319164694396064193617629680075393179941677177344552610686265816318550299560752434232685236264033539751265527759854782193437947896460731155437612271057513497707762609028985525402951238240544294457650966817203702274255235304349754536321572545886</span>, <span class="number">994224299033307039203579544081216591452126257653849389377462937853417730171804297192793614042170417240915527127917386254138387253255500370010575742999314488369770226303616213722163246863375092378461986226693676341847396455659597844175321334523084256392837085772314935974132587765935683295952029973141385579172104138994248199919224064905635653958958132588960963919308438170284085344099576116555202872191801831938006319726624540712516671721548363414020154699878326781397416119250104231021627228457590975320691609821968544650129513435299683989583837023371902849797405297537164049124558658894741724953959394431804415155824137</span>, <span class="number">3743333415055156113740907621766452452757020449083590505909382294540647763208563875686665901979123542074844930460731195718339336457235235513745510760006063943411852424103371004859637151870326158477897124365531595256741788380655304262850880109761161091360892726825618542511893536325147589233089592786371163814781613055872178862963583502701254673562978177540316493713309583025642416084530806253108020649729050076037100132219821401705295010081816071658391505601518232552091312774862841922389956774315822111361357559932190321057167827888953342591954026749883557045408723044550730747792185130129384495936794892342287936808245381</span>, <span class="number">1122419208737226187996760422754952233085910403589064925265208846178462945017472406817894365217799535106960004292100597927273933207475218143206999854300734494828861044783584659687514797139491599834156765844001971651488062690041276715358212796268159890967256203524030711043445458424731490880296342471374767277261484531463864680743374908039427756138795899923932711097527202111654655581745636485088400110815157973421609104203719896264493014335965141459751362899593850856011526631122252856460477038656022716355548276403603313635389513197024379390959716619019881373317721149675820760584930231783152598010011269931479845545350167</span>, <span class="number">4069460981696438366932031506383914356954574056071166342163539275094946042824287897576475057020755940427134978721333383300539038546588864186883093712076113992472867824647248566074732128638024030935724362496781576699515401608991489001070362758006159660134381818516900233906598545839788767804020896598386330753640884230767183378647201125139797732717099476777358119127238717561082767041172780150293825682416982693324276737090609511908168077939949473394302688992716758953290871096694129667582698579920743250250155454178545579144330620030884244930163917987852869423668165919363195097704513932540372185199555827766455631780776534</span>, <span class="number">5230208183283545046283645008176767761034902160068488354311577455379555121126298993992804137465435343631865669356019630374237365718722335431791030261296213202893345962102754012342909526636318369054284905662142323764817760733120044904722589671699780219194887568335470022000557496785952673227219644218700415900168214113418288616103443081828305227389845235462267739096241035880812700369543878638432684882997465230215550949011969914833258322570584474141435296504341548344946239659118167941942594876990115337651381791986890155366386074125851186000068453920985276877022708675676198500055311885371190758559852082216360723450000978</span>, <span class="number">8174418608263004643866343083873986717010771670382078016899299757533152405069048470357939921934161233349718530509121692721667574305483003837632483277099749902450515918744152620262334945946573278541840924010754947045740322843754239294805435968994984745667250066418746714270783351067914088154286695509522345397024352028075405532175066208038091122431536341862999248106505544750338720439303363548671611880913577064339068408489204541631968515028038073894257960755361266310318279928898540511252485394153721519122472151162821853539414755752761957510115378518947045559219164325572607680660625746550189153128119252488960269026454610</span>, <span class="number">10834483701877849531761631336274349018440447363766493762697858084341910484844153324554193074487395531211349670537313130004150925192162214812559123121855884378981119675021815379177401208718702366940190806340941440403052290492065094249648698449306999951583283960322033848490064621849818423485596472227257435062670972250475928793612498154136926018284310013678116922592502747779679680266470782171769056120372225319179864122903497853671995947302112737196743500002071605909227006804453100903911246104160590110018012969049199545002395249306592205324807767771665641659059904548726172084745378418309472207956068917123725415846490713</span>, <span class="number">5258947876247267513995590387792876100865627271869600154529372600702383853953366332368062842506261783895660653772300803386892925125664008632901382761018881582630010624653184887218529014677373122509582334820036352654586375463690243370770281487973633345705009768849204531860787354532025742672501370429634780186135353848756006553759500773838155166562545430140045306666249838975465471048688679058367196334385746173165107877220396726185504984027567997311740137453566090142826697527721347893525747260572150121187705977019469899119758601748778673332893243688483811140791217059720133478517748105787256249232554509573995853457101860</span>, <span class="number">3523032116764717414607030475776392998098960347196803707779079063113305449749937407313143958735754697126966379329000288671316255024363837775404126169216385155276842822358757560234953491227193673589518959792924981992554330747443615161235378105684725494877090122844794056754353014686945802606169908060991808403275526804146398734166171277536961829935139912546439444116108618274899331554507289851233891108999114132251618646727484152729231501329580825293390727581347970804154411830061991620685759381966321686945480437940639712504851567534618163316585950112757651836597793179545442335065785647080928105980218106618950706537339353</span>, <span class="number">11443323853518572421067745581802551775097758333341646869828920897084669356716973333924109287680707423017779409089474893493774884461375874707271323579758707961136715582819743725268273808215338810189522064082093018493707178567310330198522692785712741209919694155809004285276604433663614429421755607357405633281090577664155906381423271104275894921961584140413832148583362455418492578668194807400244733081829306875824119205535478739159828470320026601917948572545392651434226131244588159232027869146921466691500266934303323630114993334338006125707802472153651310203402349426857804627145817226176747336542872711346301429036985928</span>, <span class="number">12278473206784298876009438753138450410067255723072719460366652597802124929411652044565058901475729649103622769291118441322766135544907431391057600437801315993834496740172350085626766825470578242220676898913163917743816729100177040740117418635049210060820270177326178087133756560153244352005806786979474690349851359867323741400525591418115808709660950895791794714600785193945890438587907172137643423348727008511858348317369117752139942495315483389303406756977904747321558774374676018579852978213784341703444810006880029424910728950586271505751953975591371671666751185353199753059339659031347213932746215635892556308138407412</span>, <span class="number">8850147662817023428376653377578294001008164620283938693825435384405050603702979113070444608219054605269566571198055022761262416191653988327024221699644536421199702042394327458938145398146093120425356692090972327542252377415215537856966039603251598464257601238807829572343187079109847974330468726158634353373204880359702312962351652250694713966984985759084483631717197592936834135515614367541831891814612152271936175356685857393976227386596333249878428144032460389311965058075858428115058938898921885504529941153751611838405943492914677042451460442039871056181916757733805363136023544704531379589196654969186017012821317058</span>, <span class="number">5263915536049626415574018572481571891724237834997900077682506182179863059613036848473798417004192862527830753468142801671423608603426585944062303036876472773060244495752705067695967804561765294513575692055492870988986133589464383566016450709382498548359624305485586518429928352126786949273802669098348134655347878505025693553888537924962005837442713579591186167994462516339263270507301519637225498963439450311024522174256497905972433664757045042742368649337556664019789785379916689170658464621488378915226242378580609923342966087323938762192137470028475521540376716266584747999096839000960152318089193793127343090252997211</span>, <span class="number">14539911416897169251665133526113394842198117573754897963809622599862312034145384134702408320401722130555267448473608197291304658941263418172834212421318864848314188803498932269085471471761230897371377949868498260879264528324667450240186007296370203128120426850450428269258029300262112214413905534175483220922247461839724128701300334210908287323220578342800274202647731893276242289304791022996226860670401539811861944641972577530810433419056292169326782103577266522610985282450113172050824203575456855411253496190983900505782867902192995617153895114070349519410443037092338574324800019492218236752321360389075045044866776586</span>, <span class="number">14107619584295152877690535214351021030590539706390543727793077924976695179800889374619357101986129840023639954796589804819453996852445423000688464373019497895382816261582254305547609427355624939803422541037461289999382789548610286800094959676759627671757740616119249854463364458745015732267490849157422452268354861745334853138650203189976750966199832285488776557738570387826129027373449636005762160637553657599443534659491522886376431669373273884717571421784703174952248839354310274979206497660802114198911797036785028213657850341090987248144612762312703639941525394051517777388870076504595484646972592471195907832133444179</span>, <span class="number">2284233386839988947227002495964070274282558199022503985886988052458227829436605481695838534318505233405550037294418595997915518527426358020361672385001026996714988712809306021768358644872016678433188207385037791305116403549647964554925731868951015796662178749336393766161616116131811364680941411957836593501046164427066536058995679468921087219680757080953914013032960130829383138583461565927800134634374967789041206447368086566213549250227151877832572401928932697936078993641250085065824634720336182307694213174003195870301223762894211187005713840496053311443400428111639743808987990929600381204282118344738749746668956233</span>, <span class="number">12090080529983104994304367372675835679074119434268951253633189978942073242909452624910620892501805781968491373444873674435741694138272665955381586957690400868483894375228605333970810704975449396114428449280747482398174648179248684525406079277538586813381959839095027034121100887765077510388680122344054009677382688665202177763308607774332882160404400011682051420635026169154582484543358318335015478105844783238071147078827115413069983943828271257111987427608658008537091529471079884726017634360580265847859392180128862622973456900154034870334777640725451510242398867680729047582627881855171517352885916110789102063335214045</span>, <span class="number">8780410594242410454189123048923048128278636247735817978575148168489622305680160366213887932067736140460840815133747356729049647955898009648508564800043441754866109141468001744967167739859897649476767735345121905237443720915124857429127189325595735801145372444313726726536308497941169724398468229920196006075010798496227219153031870691670486105317108317532807399958445105044130157130349494558918951008657822342607930490145976005210270504662146935087065494800985678297142223374695422703802751733358176577615426268960089772682761691036839741790038242960468271102083217548915383242299421064774843685631003247040941593228767555</span>, <span class="number">12638532596286690536931793366027174524704520803329449580487191279815488768267957429530294962265166358110790727045268582010905398583737718923632418352855321816299569893548273253355886360912536787179555443675660626971767578053852932145368413925186775186130189034616600353605973889487478371018132444231428112459552495729029985844112822339751054120097879521401316189871038317733947080612839576942554900727309497216545611425178298041037192145491868916707298985731722657716924198526529317242874335474262264977345486046506312207009363930360413221163552704155627349181747911146069682199322481029869461996380115956283030128300646742</span>, <span class="number">14225693291135908811698481256861433804498034932741873120040292288731800711225001898773780895957051975452843038497064233160778994532883457153869851551779526684301330701780384146965897245766550605593704256474323407484601249890289826408468993061867651459097067836359352490280693500441683237739251760711968406953331646103425115971395938019983240456861118247563886738050381504046093561271969733387276846631761792397332823078606138333691834980274277899948370146839560961198618212477344071805085100489344286798011562967223308356031064641822482690629630439238535979705296303292099272303137067584575592241482073914160049339828743460</span>, <span class="number">1371670846041867260324589060779747235090520844266535521996198703027252534965066155432167957250347116898696089245834653043285897613533451342716539524134897244554432839433863280867709818564304583214122445966696514217618338208412200249320335077945902857539333897623931908357788289063897841985203344008004850311149383426025850199789717445826201731415077049801079165534704181238520325639719580742119306348369420916683290530533306355453512795294878930074341810793303241562580557691620348834633009439601498533767423479873465716693383171542209708107935387189837715680781850228484843541798561174770702316729791473055450285943188265</span>, <span class="number">14708623804859337495233293249705554627856957953621073620574738343860442527437860459714392963432307565548395191553067287274734757641150929665498184091033973576720183502674585730232215192920711432115081065232565013337995748491222320937509734212639300113206532377476575263455729130986937361555117756308715691421831641649823135341333402616684672914850677982415341526608702608573542769062092203386950581245889146839759080652674215267660170986778798088035444904448061916724833904274789061415486957713985215321172801596973918213065262786043657431578763182103447000231844339769996252181071717290376583199617702912965525367542660535</span>, <span class="number">2079525942186153669295901492783740853212676561024193444780638988637847835644756443586890166439134698718932408243774425537995619928125603250628129115417902964735855519616272717379878048344881168224345684347364945700147131969989821058820879460314431635876119848428938120985381125003300617209346969998813735787567448774119589168695501044320014748099471066312674185119281298743032855120434892720428182236503714739337394039640707118038361657304942328498599585592181382144837561952879360025526179800392653477378744457281856741910408517044085784236670891450567973147640935080531824447313097181533661742399531352379822738701176567</span>, <span class="number">14792590665641028843033432480061660678975535819902801605571661546859426944131644568533395689046584811184391064144364792722577364068548209812474918806539788935075918298444261756722804477814663215497569069435454115120970529083814165863023872402563758552891206856042823668630816466927169339616898566240975080602419989584571252545007212013771626517775440419830425518552096774200225677449669460551889774509420628915115620873014862248765180503211726719165513374467773188013372007320110305669595026735996749618153282645159688914676920961714313055226046583528196528706063553983176539656599868939612854821053695656456430891836046092</span>, <span class="number">5421429792702568956729448569045195983852090988415758953575732945204333711957283060401211013931083588517500706846881352630854446235353695717332891228089451477378334669684360562646633015073537524338852194521249427314890306475465753890159977531883008697154603946794774313081972383969295442439137905948514986021418741247625670140599363209300238798422485012201480741035076590484076842740075780444289079509316382144446939083621783753965961898295535663162366825928320927006075967490264774219761948688976913098380134041630258553195459377700387995095857287227516370666281688103676000985604139928039764842944488391533010282401307918</span>, <span class="number">16178649325955842402878726248274823977309882506287302051961519684678802473114984617129333886148676799264635697963162832407100014691313801065797257437738519413038009847443318468797712116507107655903883044657970891310434813181545857360877275166548832189441979343030869350342946775702769146866214177165615311698901131147756167307227871668925809119371545250957131383939530183858600239845959699502960614528416837991687740058988062457118493477726348647535783604491447947002705228049650535453941845139580036524797171208903103984021381203471446362051930563808412078372484826383291672504121158412234425121958956560049726681796458734</span>, <span class="number">12609070105293050032848354708018025837063434503582939534855910239145322982669910473099388994113585907117312785941621522138076245516915577287852137982922803644060389479313880830623331634893838694405730013003743693865572486882307987016754787497582569571661406019033781198714521464606337359283147168906981614965735718230451877685435341337703571146714065735073556120719072348605350825240780876718002822374738460929998616328204174997582615499347552490165673535936109614190286423405201342438329251427185192818400581782142365403936506839499607039824377039122860846979829061386657756765366423303110962894985948551557898044626520095</span>, <span class="number">9424965984496651484696657367909446260942288240190190698080921833233653936277820348366348390264424261125141209375609118804226748811202714702967509258633148036415861309844015290410849991983709975340404728355494662203464963072235301554629381315134034783443037192238889932533301386357067633343193806816389244330084958270436126743642138397636786107253658973748153321925404243737725838101876051556793957537338106495518601017626816023679179074471278491918165145736726928755193593981174950170246606456222849178073824126075666917676831714930509928718405241759798553287221291664744401366668653741945990878092081172185103150896602330</span>, <span class="number">15116293680355608338382791908385195283995972537295926894651657778746497438491427943524354548499488171820197683012030663683009969734274886185767682528288749245942824531167213740939529660288282528025448769877881201963613912521520383794047380940601728197607425184251757234478463578833143818325215615477550188629794292013102489486566656942696426311298741696919903494480394822253005781518237470439964919901355722461444434410078168995692467731258451461849270266711569207791040632693282795598661262568749935159035305150669987269220844848184218436833596127591160110003781920164166758213975872142293778849841543045307561185605113401</span>, <span class="number">1925238780806008102331032014237481353073397536634789799780429015027648664934529654073221644947817960511486112318301594817736082765502076327789930564296518837005007795961552049501019490821880634700284284306694114847827819156811008668558676520544849867590766448108687206550783084199492021214339226151215819239963158100824675703324701240211222614703150885619803722271810351872083128322252115758690757299997463743499088521978157395068004235755181332814982338144201686541896056301556512030112746666153349320356084364709773383265777676988901698155268493906326020459185891222641964911152490415118379628499580159035557298181418290</span>, <span class="number">6821849778594062649763965434134147407981452386318528626049695128123610596804507486709291218053525228591339504038628576822848502138629519482167041154933105202131743197025133753406343212154773378664369808778950824953150391692115439636038281207318564530422025116063083561199444521236903613135585947543910910387167551982579105450569703737345719081978256626998176599150666634267571212434728450900702104872971864246156985076624004994146096408054023255040510677521305488234666884264243967139738435724930192717598240505994041162031562208515957026565435496680211293045131394063363315639312247735761004084950672659526629560827232941</span>, <span class="number">11981658011637873125680072618645994877624974013490208181802570503366160145273496194862623908588507029909145260125047107768764622482979310794547412998167142447953991400201229952905629766207486104328013007982288279354665890858545171420935476023773195871424546693467474150593391025768275500016977515166160189274993869882233828204705286795205657154575481111744059893515156011082485636881326837499293773034052147746640263638446885444421593297652460492447419834930083193292556328827661748026267333937588974753235170684027180848719469966309281347273505332264604442713377431337824526264857750170389969931851540203502894039498691967</span>, <span class="number">11256187409460270898265956394919678546929858727894223405333146256596470748947568358990433496164501643161730637614822508248765153092768766403694929925847705408792551692872276134518982137483584503721024087826406608103314996701570229190632978246419763933567142024184547947234530444612320108228238688804560571233110645182028817928582954949635282409260517213694673281160430235903401583991245835254121494686959061154478141094037987083918064542081105776691719972726391443985512291367926752898233233685180826635774222221703327119039039619107375045711773427582069998788349194225275031270464603676060061131743763511360826998034100991</span>, <span class="number">3319411965977730047648576917115688681976487870497815679902781110387252550220069019764562095986350303663002203821987514988421271558817221111338171556585872726565037061707807664741784768360668802006071574833246269217766938363474498862500197198370431931173791572421237207825891865985215814966857698153030397761236161957563601153665960536567949074742904655863603013948776579645484745161923464067657660239853804008863759163376848796762923763270847767153196111649856562654450306169666851528000816678125042428968196740859821974508588002054755848189988129603586891365220858852353693110249092425685104763097043924139904088800060521</span>, <span class="number">12440733317606575382710352654318473546589355635168021140657311851351055049847357265508697455805212918041025852751144015875248385455958299170054295854074464215581465263695823276600100679497078078322749491562405691274733378272823429315886588020768610470548278605470535075891323522097959489061870147238336983777144580058079600244467447792703903044627942703163070641612348212379039433161926552680997068363633596337504852569005001761539244734999135715440517028678902856488108828144264464893776800718718769958123168739501612398053156833948455014893392750135833482573323635978924922526215270385957216940667132162533975033895346775</span>, <span class="number">5757567941375580530435243651475354104501304019243937132799740546112033707027787914785768694342613775393744981241875527473314336947343193046466811789827733032642693667836972992206328861262460815481283166148914250630615316898458133055858878316444987377662565209542565056651965583081675595077558270488418534841546646235033376395051972428946326063968947133466955959425308477840732694061795833483179676288375644160800443024134992004563418806064994731107175193062378828884502809042962669482278048331982443799467318391557500729421837035812255908651432139645293591708317718612904319634655922778481117799526048985085267704172550041</span>, <span class="number">9829609956686583539845069342696192764417537911788107771859991393028091055220219008364425207849530065035154708694451213195271189116553389726957933134001936390978467737576421151103158874895274463488487765290953286298411444402871366777853110162314320038942558116305509076778891448363467504402514360289853588404894996298931303558346072378994874744743151838536819125707671305088120463629820871750181161777604563619897177298201988691579822105396918784197227480834608483198525121412178838344219369353861507273954874828624243451208368171223558656148999897034543214094636582878880955458855203080241088957507238168846515021722590366</span>, <span class="number">903703112768796183752069095763743554139797329197818971787841058004305700873207795820933992676806887620939596382846897408637351844794124411428902053648778006381126009317839874111084800541365808374023555938251717267473357191672167482202178157424570290263028939328749310167594541509949940210031310343596411750505234867344384444828089529554118151805058227356571346033364555417594766601791035174426960534074575507876829870106496985014718717331094109927348344717736408835527237280542510019005294523453490783084257941123449565664192188834403616442808417208937363198937058818592325903996360057972740547659042534740843072009139249</span>, <span class="number">4563431876926279903130938771973599753940044870201518046127908129409343089167342982354018725080391717464418066015241113361936860070231381602919316276969174866674035834321486781239937851119742414306767123060674749136547608888260951563444903884008810600799956465626549802548489024365405139230435972233252715513445481429533830151912566960320815379604390194802689334888564099349600886696470080642472404932839931517971905017769157249769345864132437402613647889332517219347314966089012391356518890836394547508933891335220586269002333185336386567891310665204219719676264881128639830424174841904902298242722065731296746803365913815</span>]</span><br><span class="line">ct = <span class="string">b&#x27;\xb7\x91\xcd\x11\xdc\x8f\x89\xbe\x02x\xcd4U\xf6\xfaE\xee\xa6\x96a\xab\x08zw3\x1bo&amp;\xc4\xc7\x00\x9b\xb7\x02_\xc0\xdd\xae\xa4\xf5\n\x15\x8e\xb5\x1fHUm\xe3Z\x92\x10Ys\xc9v\xf6\xee\x99&#x27;</span></span><br><span class="line">iv = <span class="string">b&#x27;DO\xf4Kc\x1f?7&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">phi</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x + sqrt(x**<span class="number">2</span> - <span class="number">1</span>)</span><br><span class="line">ord1 = (p-<span class="number">1</span>)//r1</span><br><span class="line">ord2 = (p+<span class="number">1</span>)//r2</span><br><span class="line">h1 = discrete_log(phi(K(magic_pi))^r1, phi(K(<span class="number">314159</span>))^r1, <span class="built_in">ord</span>=ord1)</span><br><span class="line">h2 = discrete_log(phi(K(magic_e))^r2, phi(K(<span class="number">271828</span>))^r2, <span class="built_in">ord</span>=ord2)</span><br><span class="line">h = <span class="built_in">min</span>(</span><br><span class="line">    crt([h1, h2], [ord1, ord2]),</span><br><span class="line">    crt([-h1, h2], [ord1, ord2]),</span><br><span class="line">    crt([h1, -h2], [ord1, ord2]),</span><br><span class="line">    crt([-h1, -h2], [ord1, ord2]),</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">################################################## part2 decrypt</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">magic_op</span>(<span class="params">x, n</span>):</span><br><span class="line">    r0, r1 = <span class="number">1</span>, x</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> <span class="string">f&quot;<span class="subst">&#123;n:b&#125;</span>&quot;</span>:</span><br><span class="line">        <span class="keyword">if</span> b == <span class="string">&quot;0&quot;</span>:</span><br><span class="line">            r1 = <span class="number">2</span> * r0 * r1 - x</span><br><span class="line">            r0 = <span class="number">2</span> * r0**<span class="number">2</span> - <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            r0 = <span class="number">2</span> * r0 * r1 - x</span><br><span class="line">            r1 = <span class="number">2</span> * r1**<span class="number">2</span> - <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> r0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(F)</span><br><span class="line">r0, r1 = <span class="number">1</span>, x</span><br><span class="line"><span class="comment">#4 = &quot;100&quot;</span></span><br><span class="line">r0 = <span class="number">2</span> * r0 * r1 - x</span><br><span class="line">r1 = <span class="number">2</span> * r1**<span class="number">2</span> - <span class="number">1</span></span><br><span class="line">r1 = <span class="number">2</span> * r0 * r1 - x</span><br><span class="line">r0 = <span class="number">2</span> * r0**<span class="number">2</span> - <span class="number">1</span></span><br><span class="line">r1 = <span class="number">2</span> * r0 * r1 - x</span><br><span class="line">r0 = <span class="number">2</span> * r0**<span class="number">2</span> - <span class="number">1</span></span><br><span class="line">f = r0</span><br><span class="line"></span><br><span class="line">m = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(obfuscated_keys):</span><br><span class="line">    <span class="keyword">if</span>(magic_op(F(i), p-<span class="number">1</span>) == <span class="number">1</span>):</span><br><span class="line">        temp = magic_op(F(i), inverse(h//<span class="number">4</span>,p-<span class="number">1</span>))</span><br><span class="line">        m += (f-temp).roots(multiplicities=<span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        temp = magic_op(F(i), inverse(h//<span class="number">4</span>,p+<span class="number">1</span>))</span><br><span class="line">        m += (f-temp).roots(multiplicities=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">################################################## part3 LLL and get flag</span></span><br><span class="line">L = block_matrix(ZZ,[</span><br><span class="line">    [<span class="number">1</span>,Matrix(ZZ,m).T],</span><br><span class="line">    [<span class="number">0</span>,p]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">L[:,:-<span class="number">1</span>] *= <span class="number">2</span>^<span class="number">128</span></span><br><span class="line">res = L.LLL()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">    <span class="keyword">if</span>(i[-<span class="number">1</span>] != <span class="number">0</span>):</span><br><span class="line">        key = long_to_bytes(<span class="built_in">abs</span>(i[-<span class="number">1</span>]))</span><br><span class="line">        cipher = AES.new(key, AES.MODE_CTR, nonce=iv)</span><br><span class="line">        flag = cipher.decrypt(ct)</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#ictf&#123;the_weird_magic_operation_is_not_so_magic_after_all..&#125;</span></span><br></pre></td></tr></table></figure>
<p>后面看discord有看到maple提了这个群的名字：</p>
<p><img src="/post/6956167f/image-20240723215429445.png" alt="image-20240723215429445"></p>
<p>然后还有个师傅提供了篇论文，以后再看看吧：</p>
<p><a target="_blank" rel="noopener" href="http://wayback.cecm.sfu.ca/CAG/papers/Cheb.pdf">http://wayback.cecm.sfu.ca/CAG/papers/Cheb.pdf</a> </p>
<p><br></p>
<p><br></p>
<h3 id="pacap"><a href="#pacap" class="headerlink" title="pacap*"></a>pacap*</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">The &quot;capac&quot; challenge from Crypto CTF 2024 can be directly solved by factorizing the modulus, but is it still solvable if the modulus is much larger?</span><br><span class="line"></span><br><span class="line">Original challenge is made by @factoreal.</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">iscube</span>(<span class="params">n, p</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(n, (p - <span class="number">1</span>) // gcd(<span class="number">3</span>, p - <span class="number">1</span>), p) == <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">issquare</span>(<span class="params">n, p</span>):</span><br><span class="line">    <span class="keyword">return</span> Mod(n, p).is_square()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_prime</span>(<span class="params">nbit, t</span>):</span><br><span class="line">    P = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(t):</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            p = getPrime(nbit)</span><br><span class="line">            <span class="keyword">if</span> p % <span class="number">3</span> * p % <span class="number">4</span> == <span class="number">3</span>:</span><br><span class="line">                P.append(p)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> P</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">P, Q, c, n</span>):</span><br><span class="line">    <span class="comment"># Add two points P and Q on curve x^3 + c*y^3 + c^2*z^3 - 3*c*x*y*z = 1 in Zmod(n)</span></span><br><span class="line">    (x1, y1, z1) = P</span><br><span class="line">    (x2, y2, z2) = Q</span><br><span class="line">    x3 = (x1 * x2 + c * (y2 * z1 + y1 * z2)) % n</span><br><span class="line">    y3 = (x2 * y1 + x1 * y2 + c * z1 * z2) % n</span><br><span class="line">    z3 = (y1 * y2 + x2 * z1 + x1 * z2) % n</span><br><span class="line">    <span class="keyword">return</span> (x3, y3, z3)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">P, g, c, n</span>):</span><br><span class="line">    <span class="comment"># Scalar multiplication on curve</span></span><br><span class="line">    (x1, y1, z1) = P</span><br><span class="line">    (x2, y2, z2) = (<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">bin</span>(g)[<span class="number">2</span>:]:</span><br><span class="line">        (x2, y2, z2) = add((x2, y2, z2), (x2, y2, z2), c, n)</span><br><span class="line">        <span class="keyword">if</span> b == <span class="string">&quot;1&quot;</span>:</span><br><span class="line">            (x2, y2, z2) = add((x2, y2, z2), (x1, y1, z1), c, n)</span><br><span class="line">    <span class="keyword">return</span> (x2, y2, z2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">keygen</span>(<span class="params">nbit, r, s</span>):</span><br><span class="line">    p, q = gen_prime(nbit, <span class="number">2</span>)</span><br><span class="line">    n, o = (</span><br><span class="line">        p ^ r * q ^ s,</span><br><span class="line">        p * q * (p ^ <span class="number">2</span> + p + <span class="number">1</span>) * (q ^ <span class="number">2</span> + q + <span class="number">1</span>) * (p - <span class="number">1</span>) ^ <span class="number">2</span> * (q - <span class="number">1</span>) ^ <span class="number">2</span>,</span><br><span class="line">    )</span><br><span class="line">    e = randint(<span class="number">1</span>, n)</span><br><span class="line">    <span class="keyword">while</span> gcd(e, o) != <span class="number">1</span>:</span><br><span class="line">        e = randint(<span class="number">1</span>, n)</span><br><span class="line">    E = [</span><br><span class="line">        p ^ (<span class="number">2</span> * (r - <span class="number">1</span>)) * q ^ (<span class="number">2</span> * (s - <span class="number">1</span>)) * (p ^ <span class="number">2</span> + p + <span class="number">1</span>) * (q ^ <span class="number">2</span> + q + <span class="number">1</span>),</span><br><span class="line">        p ^ (<span class="number">2</span> * (r - <span class="number">1</span>)) * q ^ (<span class="number">2</span> * (s - <span class="number">1</span>)) * (p - <span class="number">1</span>) ^ <span class="number">2</span> * (q - <span class="number">1</span>) ^ <span class="number">2</span>,</span><br><span class="line">        p ^ (<span class="number">2</span> * (r - <span class="number">1</span>)) * q ^ (<span class="number">2</span> * (s - <span class="number">1</span>)) * (p ^ <span class="number">2</span> + p + <span class="number">1</span>) * (q - <span class="number">1</span>) ^ <span class="number">2</span>,</span><br><span class="line">        p ^ (<span class="number">2</span> * (r - <span class="number">1</span>)) * q ^ (<span class="number">2</span> * (s - <span class="number">1</span>)) * (p - <span class="number">1</span>) ^ <span class="number">2</span> * (q ^ <span class="number">2</span> + q + <span class="number">1</span>),</span><br><span class="line">    ]</span><br><span class="line">    D = [inverse(e, _) <span class="keyword">for</span> _ <span class="keyword">in</span> E]</span><br><span class="line">    <span class="keyword">return</span> (n, e), (p, q, D)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m, pubkey</span>):</span><br><span class="line">    (n, e) = pubkey</span><br><span class="line">    (x, y) = m</span><br><span class="line">    c = ((<span class="number">1</span> - x ^ <span class="number">3</span>) * inverse(y ^ <span class="number">3</span>, n)) % n</span><br><span class="line">    enc = mul((x, y, <span class="number">0</span>), e, c, n)</span><br><span class="line">    <span class="keyword">return</span> enc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nbit, r, s = <span class="number">1024</span>, <span class="number">4</span>, <span class="number">6</span></span><br><span class="line">pubkey, _ = keygen(nbit, r, s)</span><br><span class="line"></span><br><span class="line">l = <span class="built_in">len</span>(flag)</span><br><span class="line">m = (bytes_to_long(flag[: l // <span class="number">2</span>]), bytes_to_long(flag[l // <span class="number">2</span> :]))</span><br><span class="line"><span class="keyword">assert</span> m[<span class="number">0</span>] &lt; pubkey[<span class="number">0</span>] <span class="keyword">and</span> m[<span class="number">1</span>] &lt; pubkey[<span class="number">0</span>]</span><br><span class="line">enc = encrypt(m, pubkey)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;pubkey = <span class="subst">&#123;pubkey&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;enc = <span class="subst">&#123;enc&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;l = <span class="subst">&#123;l&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>心酸，自己明明还改过这题，这次没做出来，因为明文实在是太大了。</p>
<blockquote>
<p>改过的那个初级版在：<a target="_blank" rel="noopener" href="https://www.nssctf.cn/problem/5638">Capac’s revenge | NSSCTF</a></p>
</blockquote>
<p>总的来说就是由于明文较小，所以可以利用曲线方程和已知点去构建等式，等式有小根所以可以造格或二元copper。一些技巧是：</p>
<ul>
<li><p>直接造等式的话度会比较大，所以代换变量可以得到度仅为2的等式，利于copper</p>
</li>
<li><p>由于(0,0)是平凡解，所以需要自己找规约出来的一些向量，转化为多项式后观察他的形式，从而确定接下来的求解办法，具体直接看maple的解释吧：<a target="_blank" rel="noopener" href="https://github.com/maple3142/My-CTF-Challenges/tree/master/ImaginaryCTF 2024/pacap">pacap</a></p>
<blockquote>
<p>赛中一直没想到怎么处理好这个平凡解，当时想的是利用明文前缀来确定根，但这样的代价是度会增高到4，不利于copper了，上界就不太够。密码挑战赛过了太久，把自己手提多项式这一招都给忘记了</p>
</blockquote>
</li>
</ul>
<p><br></p>
<p><br></p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>糖醋小鸡块
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://tangcuxiaojikuai.xyz/post/6956167f.html" title="2024-ImaginaryCTF-wp-crypto">https://tangcuxiaojikuai.xyz/post/6956167f.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sacreative/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SACREATIVE</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/post/83b88224.html" rel="prev" title="2024-DASCTF-暑期挑战赛-wp-crypto">
      <i class="fa fa-chevron-left"></i> 2024-DASCTF-暑期挑战赛-wp-crypto
    </a></div>
      <div class="post-nav-item">
    <a href="/post/9388d5f7.html" rel="next" title="2024-corCTF&DeadsecCTF-wp-crypto">
      2024-corCTF&DeadsecCTF-wp-crypto <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#base64"><span class="nav-number">1.</span> <span class="nav-text">base64</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#integrity"><span class="nav-number">2.</span> <span class="nav-text">integrity</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#tango"><span class="nav-number">3.</span> <span class="nav-text">tango</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#solitude"><span class="nav-number">4.</span> <span class="nav-text">solitude</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#lf3r"><span class="nav-number">5.</span> <span class="nav-text">lf3r</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#coast"><span class="nav-number">6.</span> <span class="nav-text">coast</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#lcasm"><span class="nav-number">7.</span> <span class="nav-text">lcasm$</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#notitle"><span class="nav-number">8.</span> <span class="nav-text">notitle*</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pacap"><span class="nav-number">9.</span> <span class="nav-text">pacap*</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="糖醋小鸡块"
      src="/images/image.png">
  <p class="site-author-name" itemprop="name">糖醋小鸡块</p>
  <div class="site-description" itemprop="description">"追风赶月莫停留，平芜尽处是春山"</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">113</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/tangcuxiaojikuai" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;tangcuxiaojikuai" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/1142381085@qq.com" title="E-Mail → 1142381085@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/6394335993" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;6394335993" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">糖醋小鸡块</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>
  <script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'UPEMA7DyYbIIEyOW72ohgytU-gzGzoHsz',
      appKey     : 'M7rXAfeP3JOslroay2n0Jv2R',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
<!-- 引入jQuery -->
<script type="text/javascript" src="//libs.baidu.com/jquery/1.8.3/jquery.min.js"></script>
<!-- 雪花特效2 -->
<script type="text/javascript" src="/js/snow2.js"></script>
