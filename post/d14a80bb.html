<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon_small.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="RnN18ZogmZl_dLVpxZ6y8kjKL73Mu9VLVEkw9d3qrq0" />
  <meta name="msvalidate.01" content="DC3050AD55F30DDF75AAB78517714910" />
  <meta name="baidu-site-verification" content="codeva-PPofu3dNxe" />

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-loading-bar.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"tangcuxiaojikuai.xyz","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="è®°å½•ä¸€ä¸‹é¢˜è§£ï¼Œå¸Œæœ›è‡ªå·±èƒ½å¿«å¿«è¿›æ­¥ã€‚*ä»£è¡¨èµ›ä¸­æœªåšå‡ºçš„é¢˜ç›®ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="2024-N1CTF-junior-wp-crypto">
<meta property="og:url" content="https://tangcuxiaojikuai.xyz/post/d14a80bb.html">
<meta property="og:site_name" content="ç³–é†‹å°é¸¡å—çš„blog">
<meta property="og:description" content="è®°å½•ä¸€ä¸‹é¢˜è§£ï¼Œå¸Œæœ›è‡ªå·±èƒ½å¿«å¿«è¿›æ­¥ã€‚*ä»£è¡¨èµ›ä¸­æœªåšå‡ºçš„é¢˜ç›®ã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-02-03T14:17:17.000Z">
<meta property="article:modified_time" content="2024-02-06T09:34:11.179Z">
<meta property="article:author" content="ç³–é†‹å°é¸¡å—">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://tangcuxiaojikuai.xyz/post/d14a80bb.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>2024-N1CTF-junior-wp-crypto | ç³–é†‹å°é¸¡å—çš„blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ç³–é†‹å°é¸¡å—çš„blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
        <li class="menu-item menu-item-å‹é“¾">

    <a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>å‹é“¾</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tangcuxiaojikuai.xyz/post/d14a80bb.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/image.png">
      <meta itemprop="name" content="ç³–é†‹å°é¸¡å—">
      <meta itemprop="description" content=""è¿½é£èµ¶æœˆè«åœç•™ï¼Œå¹³èŠœå°½å¤„æ˜¯æ˜¥å±±"">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ç³–é†‹å°é¸¡å—çš„blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2024-N1CTF-junior-wp-crypto
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2024-02-03 22:17:17" itemprop="dateCreated datePublished" datetime="2024-02-03T22:17:17+08:00">2024-02-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-02-06 17:34:11" itemprop="dateModified" datetime="2024-02-06T17:34:11+08:00">2024-02-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/wp-crypto/" itemprop="url" rel="index"><span itemprop="name">wp-crypto</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valineï¼š</span>
    
    <a title="valine" href="/post/d14a80bb.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/post/d14a80bb.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>è®°å½•ä¸€ä¸‹é¢˜è§£ï¼Œå¸Œæœ›è‡ªå·±èƒ½å¿«å¿«è¿›æ­¥ã€‚*ä»£è¡¨èµ›ä¸­æœªåšå‡ºçš„é¢˜ç›®ã€‚</p>
<span id="more"></span>
<h3 id="Junior-RSA"><a href="#Junior-RSA" class="headerlink" title="Junior RSA"></a>Junior RSA</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">My p <span class="keyword">and</span> q are generated by an unbreakable algorithm!</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>(<span class="params">bits</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = getPrime(bits)</span><br><span class="line">        b = getPrime(bits)</span><br><span class="line">        c = getPrime(bits)</span><br><span class="line">        p = (a &lt;&lt; (<span class="number">2</span>*bits)) + (b &lt;&lt; bits) + c</span><br><span class="line">        q = (c &lt;&lt; (<span class="number">2</span>*bits)) + (a &lt;&lt; bits) + b</span><br><span class="line">        <span class="keyword">if</span> isPrime(p) <span class="keyword">and</span> isPrime(q):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    n = p * q</span><br><span class="line">    e = <span class="number">65537</span> * a * b * c</span><br><span class="line">    <span class="keyword">return</span> n, e</span><br><span class="line"></span><br><span class="line">n, e = gen(<span class="number">256</span>)</span><br><span class="line">enc = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e = <span class="subst">&#123;e&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;enc = <span class="subst">&#123;enc&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 1224562468550864572988516321107388462006452125881847529675226398144888628055678744854491489016309262856785169494723943649344959507818155642772331582922466943539371681776924160647697558836379614689120727659593775446187326222964118917872973684996317614900715927751822277949264379149585370840318817143291878609357893969588131470982041272505875501444442064552286330626234504767040724907034678080283717062342383737341651784574675215207283219694413200065153603535550259</span></span><br><span class="line"><span class="string">e = 47356701171507751941853094934330097161634963503549196148254287987823089762869775349307331223083118848869825102126184149696632299476124764277876323238594318983922914255635452587035212905468593961720866809724369270149104325019013500377581</span></span><br><span class="line"><span class="string">enc = 307839781648837102719329833689146078918113606357673952357833605392673923316706392387378621203382529480917019155723632239435123748698548640308486267420983085309284306889248702165586731118889200017606360233948688879034822132551452439147516062116990766999765714755923073387252339782026780490661436777023426366620269445376047876173655782230659201893151372247389482285331969025687842851498151565880029377050013378302485301558801016888957357366922840214729734193614497</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>æ˜¯ä¸€ä¸ªåˆ†è§£nçš„RSAé¢˜ç›®ï¼Œè€Œåˆ†è§£çš„å…³é”®åœ¨äºç»™å‡ºäº†ï¼š</p>
<script type="math/tex; mode=display">
n = (2^{512}a+2^{256}b+c)(2^{512}c+2^{256}a+b)</script><script type="math/tex; mode=display">
e = 65537abc</script><p>å…¶ä¸­aã€bã€cåˆ†åˆ«æ˜¯256bitçš„ç´ æ•°ã€‚</p>
<p>é¦–å…ˆéœ€è¦æ³¨æ„åˆ°nçš„é«˜256ä½å’Œä½256ä½ï¼Œå…¶å®åˆ†åˆ«å°±ç­‰äºacä¹˜ç§¯çš„é«˜256ä½ï¼Œä»¥åŠbcä¹˜ç§¯çš„ä½256ä½ã€‚è€Œå¯¹äºeæ¥è¯´å°±åˆ†åˆ«å¯ä»¥å†™ä½œï¼š</p>
<script type="math/tex; mode=display">
e = 65537(2^{256}ac_h+ac_l)b</script><script type="math/tex; mode=display">
e = 65537(2^{256}bc_h+bc_l)a</script><p>å…¶ä¸­å·²çŸ¥é‡æ˜¯achå’Œbclã€‚</p>
<p>é‚£ä¹ˆä¸‹é¢å°±åˆ†åˆ«å™è¿°ä¸€ä¸‹æ€ä¹ˆå¾—åˆ°bå’Œaã€‚ä¸ºäº†å¾—åˆ°bï¼ŒæŠŠç¬¬ä¸€ä¸ªå¼å­å±•å¼€ï¼š</p>
<script type="math/tex; mode=display">
\frac{e}{65537} = 2^{256}ac_hb+ac_lb</script><p>å…¶å®è¿™æ•´ä¸ªå¼å­å°±å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªé™¤æ•°ä¸º2^256achçš„å¸¦ä½™é™¤æ³•ï¼Œåªæ˜¯æœ‰ä¸€ç‚¹ç»†èŠ‚éœ€è¦æ³¨æ„ï¼šaclä¸bçš„ä¹˜ç§¯å¹¶ä¸ä¸€å®šå°äºé™¤æ•°ï¼Œä½†æ˜¯æ•°é‡çº§æ˜¯ç›¸è¿‘çš„ï¼Œå› æ­¤æœ€å¤šä¼šæœ‰ä¸€ä¸ªå¾ˆå°çš„è¯¯å·®ï¼Œæ‰€ä»¥ç›´æ¥æ•´é™¤è¿‡åï¼Œå†çˆ†ç ´ä¸€ä¸‹è¿™ä¸ªè¯¯å·®å°±èƒ½å¾—åˆ°bã€‚</p>
<p>è€Œå¯¹äºaæ¥è¯´ï¼Œå±•å¼€å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
\frac{e}{65537} = 2^{256}bc_ha+bc_la</script><p>è¿™ä¸ªå¼å­åˆ™æ›´åŠ ç®€å•ï¼Œæ³¨æ„åˆ°ç­‰å¼ä¸¤è¾¹åœ¨æ¨¡2^256ä¸‹æœ‰ï¼š</p>
<script type="math/tex; mode=display">
\frac{e}{65537} = bc_la \quad(mod\;2^{256})</script><p>æ‰€ä»¥ç›´æ¥æ±‚ï¼š</p>
<script type="math/tex; mode=display">
bc_l^{-1}\frac{e}{65537} = a \quad(mod\;2^{256})</script><p>å°±èƒ½å¾—åˆ°aï¼Œç„¶åå°±æœ‰nçš„å®Œæ•´åˆ†è§£äº†ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">1224562468550864572988516321107388462006452125881847529675226398144888628055678744854491489016309262856785169494723943649344959507818155642772331582922466943539371681776924160647697558836379614689120727659593775446187326222964118917872973684996317614900715927751822277949264379149585370840318817143291878609357893969588131470982041272505875501444442064552286330626234504767040724907034678080283717062342383737341651784574675215207283219694413200065153603535550259</span></span><br><span class="line">e = <span class="number">47356701171507751941853094934330097161634963503549196148254287987823089762869775349307331223083118848869825102126184149696632299476124764277876323238594318983922914255635452587035212905468593961720866809724369270149104325019013500377581</span></span><br><span class="line">enc = <span class="number">307839781648837102719329833689146078918113606357673952357833605392673923316706392387378621203382529480917019155723632239435123748698548640308486267420983085309284306889248702165586731118889200017606360233948688879034822132551452439147516062116990766999765714755923073387252339782026780490661436777023426366620269445376047876173655782230659201893151372247389482285331969025687842851498151565880029377050013378302485301558801016888957357366922840214729734193614497</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#part1 factor n</span></span><br><span class="line">bcl = n % <span class="number">2</span>**<span class="number">256</span></span><br><span class="line">ach = n // <span class="number">2</span>**(<span class="number">1024</span>+<span class="number">256</span>) * <span class="number">2</span>**<span class="number">256</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    b = e // ach // <span class="number">65537</span> + i</span><br><span class="line">    <span class="keyword">if</span>(GCD(b,e) != <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">ac = e // <span class="number">65537</span> // b</span><br><span class="line">a = inverse(bcl,<span class="number">2</span>**<span class="number">256</span>)*(e//<span class="number">65537</span>%<span class="number">2</span>**<span class="number">256</span>) % <span class="number">2</span>**<span class="number">256</span></span><br><span class="line"></span><br><span class="line">c = e // a // b // <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#part2 get flag</span></span><br><span class="line">bits = <span class="number">256</span></span><br><span class="line"></span><br><span class="line">p = (a &lt;&lt; (<span class="number">2</span>*bits)) + (b &lt;&lt; bits) + c</span><br><span class="line">q = (c &lt;&lt; (<span class="number">2</span>*bits)) + (a &lt;&lt; bits) + b</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">d = inverse(e,phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(enc,d,n))))</span><br><span class="line"></span><br><span class="line"><span class="comment">#ctfpunk&#123;2ffab167-af57-49d2-ba91-81d9864a98ef&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="Masquerade"><a href="#Masquerade" class="headerlink" title="Masquerade"></a>Masquerade</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MasqueradeğŸ­! Admission by ticket!</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> DSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">FLAG = <span class="string">&quot;ctfpunk&#123;XXXX_FAKE_FLAG_XXXX&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">Ticket_Office = DSA.generate(<span class="number">1024</span>).public_key()</span><br><span class="line">Auth_Code = <span class="string">b&quot;ID: @hash_hash &amp; NOTE: L@zy M@n :)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(Ticket_Office._key)</span><br><span class="line">Ticket = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>(<span class="string">&quot;Gimme your ticket: &quot;</span>).split(<span class="string">&#x27;,&#x27;</span>)))</span><br><span class="line"><span class="keyword">assert</span> Auth_Code <span class="keyword">in</span> long_to_bytes(Ticket[<span class="number">2</span>]) \</span><br><span class="line">        <span class="keyword">and</span> Ticket[<span class="number">2</span>]%<span class="built_in">int</span>(Ticket_Office._key[<span class="string">&#x27;p&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> Ticket_Office._verify(Ticket[<span class="number">2</span>], Ticket[:<span class="number">2</span>]):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Welcome to the masquerade, Enjoy it! <span class="subst">&#123;FLAG&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®åŸºäºDSAç­¾åï¼Œæµç¨‹ä¹Ÿå‡ å¥è¯å°±èƒ½è¯´æ¸…æ¥šã€‚è¿ä¸Šé¶æœºåï¼Œç»™å‡ºDSAå…¬é’¥(y,g,p,q)ï¼Œè¦æ±‚è¾“å…¥ç­¾åå¯¹(r,s)ä¸æ¶ˆæ¯mï¼Œå½“è¾“å…¥çš„å€¼æ»¡è¶³ä»¥ä¸‹å‡ ä¸ªæ¡ä»¶å°±å¯ä»¥è·å¾—flagï¼š</p>
<ul>
<li>Auth_CodeåŒ…å«åœ¨mè½¬åŒ–æˆçš„å­—èŠ‚æµä¸­</li>
<li>mæ¨¡pä¸ä¸º0</li>
<li>éªŒç­¾è¦é€šè¿‡</li>
</ul>
<p>å…ˆæ‰¾æºç çœ‹çœ‹ä»€ä¹ˆæƒ…å†µå§ã€‚æºç é‡Œçš„ç­¾åä¸éªŒç­¾æ˜¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">_sign</span>(<span class="params">self, m, k</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> self.has_private():</span><br><span class="line">        <span class="keyword">raise</span> TypeError(<span class="string">&quot;DSA public key cannot be used for signing&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">1</span> &lt; k &lt; self.q):</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;k is not between 2 and q-1&quot;</span>)</span><br><span class="line"></span><br><span class="line">    x, q, p, g = [self._key[comp] <span class="keyword">for</span> comp <span class="keyword">in</span> [<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;g&#x27;</span>]]</span><br><span class="line"></span><br><span class="line">    blind_factor = Integer.random_range(min_inclusive=<span class="number">1</span>,</span><br><span class="line">                                        max_exclusive=q)</span><br><span class="line">    inv_blind_k = (blind_factor * k).inverse(q)</span><br><span class="line">    blind_x = x * blind_factor</span><br><span class="line"></span><br><span class="line">    r = <span class="built_in">pow</span>(g, k, p) % q  <span class="comment"># r = (g**k mod p) mod q</span></span><br><span class="line">    s = (inv_blind_k * (blind_factor * m + blind_x * r)) % q</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">map</span>(<span class="built_in">int</span>, (r, s))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_verify</span>(<span class="params">self, m, sig</span>):</span><br><span class="line">    r, s = sig</span><br><span class="line">    y, q, p, g = [self._key[comp] <span class="keyword">for</span> comp <span class="keyword">in</span> [<span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;g&#x27;</span>]]</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">0</span> &lt; r &lt; q) <span class="keyword">or</span> <span class="keyword">not</span> (<span class="number">0</span> &lt; s &lt; q):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    w = Integer(s).inverse(q)</span><br><span class="line">    u1 = (w * m) % q</span><br><span class="line">    u2 = (w * r) % q</span><br><span class="line">    v = (<span class="built_in">pow</span>(g, u1, p) * <span class="built_in">pow</span>(y, u2, p) % p) % q</span><br><span class="line">    <span class="keyword">return</span> v == r</span><br></pre></td></tr></table></figure>
<p>åº”è¯¥æ³¨æ„åˆ°çš„ä¸€ç‚¹æ˜¯ï¼Œä»–çš„ç­¾åä¸éªŒç­¾ç›¸å¯¹äºæ ‡å‡†çš„DSAæ¥è¯´ï¼Œç¼ºå°‘äº†å¯¹mçš„å“ˆå¸Œï¼Œé‚£ä¹ˆä»–çš„éªŒç­¾è¿‡ç¨‹å°±å¯ä»¥å†™æˆï¼š</p>
<script type="math/tex; mode=display">
r = g^{ms^{-1}}y^{rs^{-1}} \quad(mod\;p)\quad(mod\;q)</script><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ç°åœ¨è¦æƒ³åŠæ³•æ‰¾åˆ°ä¸€ç»„rï¼Œsï¼Œmï¼Œä½¿å¾—ä»–ä»¬æ»¡è¶³é¢˜ç›®å…¶ä»–æ¡ä»¶çš„åŒæ—¶é€šè¿‡è¿™ä¸ªéªŒç­¾å¼ã€‚åŒæ—¶è¦æ³¨æ„_verifyçš„å®ç°é‡Œè¿˜è§„å®šäº†ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">0</span> &lt; r &lt; q) <span class="keyword">or</span> <span class="keyword">not</span> (<span class="number">0</span> &lt; s &lt; q):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯rå’Œsæ²¡æœ‰åŠæ³•ç®€å•å–0ã€‚</p>
<p>å…ˆæƒ³ä¸€ä¸‹æœ€ä¸»è¦çš„å›°éš¾ä¹‹å¤„æ˜¯ä»€ä¹ˆï¼Œå¯¹äºDSAçš„éªŒç­¾æ“ä½œæ¥è¯´ï¼Œæˆ‘ä»¬æ²¡æœ‰ä»–çš„ç§é’¥xï¼Œè€Œç§é’¥xæ»¡è¶³ï¼š</p>
<script type="math/tex; mode=display">
y = g^x \quad(mod\;p)</script><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦éªŒç­¾å¼ä¸­è¿˜å«æœ‰yï¼Œå°±ä¸å¯é¿å…åœ°ä¼šéœ€è¦ç”¨åˆ°xï¼Œæ‰€ä»¥è¦æƒ³åŠæ³•ä»éªŒç­¾å¼ä¸­æ¶ˆå»yæ‰å¯¹ã€‚è€Œæœ€ç›´æ¥çš„æƒ³æ³•å°±æ˜¯åˆ©ç”¨è´¹é©¬å°å®šç†ï¼š</p>
<script type="math/tex; mode=display">
y^{p-1} = 1 \quad(mod\;p)</script><p>é‚£ä¹ˆå¦‚æœæŠŠrå–æˆp-1çš„è¯å°±å¯ä»¥æ¶ˆå»yï¼ŒåŒæ ·çš„é“ç†ä¹Ÿå¯ä»¥åˆ©ç”¨åˆ°gä¸Šã€‚ä½†æ˜¯é—®é¢˜åœ¨äºrå’Œså¿…é¡»æ˜¯0-qçš„æ•°ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸å¯èƒ½çš„ã€‚è¿™ä¹Ÿå°±åŒæ—¶æ–­äº†æŠŠrå–ä¸º0çš„å¿µæƒ³ã€‚</p>
<p>ç„¶åå°±æ³¨æ„åˆ°å¦‚æœrå’Œså€¼æ˜¯ç›¸åŒçš„è¯ï¼Œrs^(-1)åœ¨æ¨¡qä¸‹å°±ç­‰äº1ï¼Œè€Œè¿™æ˜¯è‚¯å®šå¯ä»¥åŠåˆ°çš„ã€‚ä¸æ­¤åŒæ—¶ï¼Œç”±äºyçš„æŒ‡æ•°æ˜¯1ï¼Œå¹¶æ²¡æœ‰å®Œå…¨æ¶ˆæ‰ï¼Œä»£å›åˆ°åˆšæ‰çš„éªŒç­¾å¼ä¸­ï¼š</p>
<script type="math/tex; mode=display">
r = g^{ms^{-1}}y \quad(mod\;p)\quad(mod\;q)</script><p>é‚£ä¹ˆå°±å‘ç°rå–yçš„æ—¶å€™å°±åˆšå¥½å¯ä»¥ä»ç­‰å¼ä¸¤ä¾§æ¶ˆå»yï¼Œæ›´å‡†ç¡®åœ°è¯´ï¼Œrå’Œsåº”è¯¥å–y%qï¼Œè€Œyå’Œgéƒ½æ˜¯æ¨¡pä¸‹çš„qé˜¶å…ƒç´ ï¼Œæ‰€ä»¥æŒ‡æ•°ä¸Šçš„è¿ç®—éƒ½æ˜¯æ­£ç¡®çš„ã€‚</p>
<p>é‚£ä¹ˆéªŒç­¾å¼å°±å˜æˆï¼š</p>
<script type="math/tex; mode=display">
1 = g^{my^{-1}} \quad(mod\;p)\quad(mod\;q)</script><p>y^(-1)å·²ç»ä¸å¤ªå¥½å˜äº†ï¼Œé‚£ä¹ˆè¦è®©è¿™ä¸ªå¼å­æˆç«‹ï¼Œå°±å¿…é¡»æƒ³åŠæ³•ä»¤ï¼š</p>
<script type="math/tex; mode=display">
1 = g^{m} \quad(mod\;p)\quad(mod\;q)</script><p>è€Œé¢˜ç›®å¯¹mçš„è¦æ±‚æ˜¯ï¼š</p>
<ul>
<li>Auth_CodeåŒ…å«åœ¨mè½¬åŒ–æˆçš„å­—èŠ‚æµä¸­</li>
<li>mæ¨¡pä¸ä¸º0</li>
</ul>
<p>è€Œå…ƒç´ gæ¨¡pä¸‹çš„é˜¶æ˜¯qï¼Œå› æ­¤æˆ‘ä»¬åªè¦èƒ½å–åˆ°m=kqï¼Œå°±å¯ä»¥ä½¿g^måœ¨æ¨¡pä¸‹ä¸º1ã€‚é‚£ä¹ˆç°åœ¨çš„é—®é¢˜å°±æ˜¯å¦‚ä½•è®©m=kqçš„åŒæ—¶ï¼Œå…¶è½¬åŒ–æˆçš„å­—èŠ‚æµè¿˜åŒ…å«Authcodeã€‚è€Œè¿™å°±å¾ˆç®€å•äº†ï¼Œæˆ‘ä»¬è®°Authcodeå¯¹åº”çš„æ•´æ•°ä¸ºaï¼Œé‚£ä¹ˆå¯¹äºå½¢å¦‚ä¸‹é¢çš„tï¼š</p>
<script type="math/tex; mode=display">
t = 256^ia</script><p>tä¹Ÿå°±æ˜¯å°†aå·¦ç§»å¤šä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥tè½¬åŒ–çš„å­—èŠ‚æµè‚¯å®šåŒ…å«Authcodeï¼ŒåŒæ—¶æˆ‘ä»¬å¯ä»¥åœ¨ä»–çš„ä½ä½åŠ ä»»æ„æ•°å­—ï¼Œå› ä¸ºè¿™å¹¶ä¸ä¼šå½±å“ä»–çš„é«˜ä½çš„å­—èŠ‚ï¼Œæ‰€ä»¥å…¶å®æˆ‘ä»¬åªéœ€è¦æ‰¾ä¸€ä¸ªæ»¡è¶³ä¸‹é¢æ¡ä»¶çš„bï¼š</p>
<script type="math/tex; mode=display">
t = 256^ia + b = 0 \quad(mod\;q)</script><p>è€Œè¿™ç›´æ¥ç”¨ä¸€ä¸ªå¸¦ä½™é™¤æ³•å°±å¯ä»¥åšåˆ°ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Pwn4Sage.pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&quot;101.34.72.206&quot;</span>,<span class="number">1337</span>)</span><br><span class="line"><span class="built_in">dict</span> = <span class="built_in">eval</span>(sh.recvline().strip().decode())</span><br><span class="line">y = <span class="built_in">dict</span>[<span class="string">&#x27;y&#x27;</span>]</span><br><span class="line">g = <span class="built_in">dict</span>[<span class="string">&#x27;g&#x27;</span>]</span><br><span class="line">p = <span class="built_in">dict</span>[<span class="string">&#x27;p&#x27;</span>]</span><br><span class="line">q = <span class="built_in">dict</span>[<span class="string">&#x27;q&#x27;</span>]</span><br><span class="line"></span><br><span class="line">Auth_Code = <span class="string">b&quot;ID: @hash_hash &amp; NOTE: L@zy M@n :)&quot;</span></span><br><span class="line">k = <span class="number">256</span>**<span class="number">30</span>*bytes_to_long(Auth_Code) // q</span><br><span class="line">r = <span class="number">256</span>**<span class="number">30</span>*bytes_to_long(Auth_Code) % q</span><br><span class="line">m = (<span class="number">256</span>**<span class="number">30</span>*bytes_to_long(Auth_Code)+(q-r))</span><br><span class="line"></span><br><span class="line">sh.sendline((<span class="built_in">str</span>(y%q)+<span class="string">&quot;,&quot;</span>+<span class="built_in">str</span>(y%q)+<span class="string">&quot;,&quot;</span>+<span class="built_in">str</span>(m)).encode())</span><br><span class="line"><span class="built_in">print</span>(sh.recvline())</span><br><span class="line"></span><br><span class="line"><span class="comment">#ctfpunk&#123;Use_h@sh_to_r3si5t_EF@!!&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="CC"><a href="#CC" class="headerlink" title="*CC@"></a>*CC@</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Pursue the ultimate CCA securityğŸ”’.</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> ElGamal</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">FLAG = <span class="string">&quot;ctfpunk&#123;XXXX_FAKE_FLAG_XXXX&#125;&quot;</span></span><br><span class="line">FLAG = bytes_to_long(FLAG[<span class="number">8</span>:-<span class="number">1</span>].encode())</span><br><span class="line"></span><br><span class="line">MENU = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            /----------------------------\\</span></span><br><span class="line"><span class="string">            |          options           |</span></span><br><span class="line"><span class="string">            | [O]racle                   |</span></span><br><span class="line"><span class="string">            | [G]et FLAG                 |</span></span><br><span class="line"><span class="string">            \\----------------------------/</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Oracle</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.Cipher0 = ElGamal.generate(<span class="number">512</span>, os.urandom)</span><br><span class="line">        self.key = os.urandom(<span class="number">16</span>)</span><br><span class="line">        self.T = <span class="number">100</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Cipher1</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> AES.new(self.key, AES.MODE_GCM, nonce=os.urandom(<span class="number">16</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">query</span>(<span class="params">self, data</span>):</span><br><span class="line">        <span class="keyword">assert</span> self.T; self.T -= <span class="number">1</span></span><br><span class="line">        C = long_to_bytes(self.Cipher0._decrypt(data))</span><br><span class="line">        <span class="keyword">return</span> self.Cipher1().decrypt(C)</span><br><span class="line"></span><br><span class="line">sys = Oracle()</span><br><span class="line"><span class="built_in">print</span>(MENU)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    op = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>).lower()</span><br><span class="line">    <span class="keyword">if</span> op == <span class="string">&#x27;o&#x27;</span>:</span><br><span class="line">        data = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>(<span class="string">&quot;data: &quot;</span>).split(<span class="string">&#x27;,&#x27;</span>)))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] <span class="subst">&#123;sys.query(data).<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> op == <span class="string">&#x27;g&#x27;</span>:</span><br><span class="line">        r = getRandomNBitInteger(<span class="number">512</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[*]\nc = <span class="subst">&#123;sys.Cipher0._encrypt(FLAG, r)&#125;</span>\np = <span class="subst">&#123;sys.Cipher0.p&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®åŸºäºelgamalï¼Œè¿æ¥ä¸Šé¶æœºåï¼Œé¶æœºå…ˆç”Ÿæˆå¥½elgamalçš„å¯†é’¥å¯¹åè¿›å…¥äº¤äº’ã€‚äº¤äº’æœ‰ä¸¤ä¸ªé€‰é¡¹ï¼š</p>
<ul>
<li>è¾“å…¥gï¼Œä¼šéšæœºç”Ÿæˆä¸€ä¸ªä¸´æ—¶å¯†é’¥rï¼Œå¹¶ç»™å‡ºelgamalå¯¹flagçš„åŠ å¯†ç»“æœä¸æ¨¡æ•°pã€‚åŠ å¯†ç»“æœä¸ºï¼š</li>
</ul>
<script type="math/tex; mode=display">
C_0 = g^r \quad(mod\;p)</script><script type="math/tex; mode=display">
C_1 = y^rm \quad(mod\;p)</script><ul>
<li>è¾“å…¥oï¼Œå¯ä»¥è¾“å…¥å¯†æ–‡ï¼Œé¶æœºä¼šç”¨elgamalå°†ä»–è§£å¯†åï¼Œè¿”å›AES-GCMæ¨¡å¼è§£å¯†çš„ç»“æœã€‚</li>
</ul>
<p>ç°åœ¨æœ‰æœ€å¤š100æ¬¡çš„äº¤äº’æœºä¼šï¼Œè¦æ±‚è¿˜åŸå‡ºflagã€‚</p>
<h4 id="æˆ‘çš„æ€è·¯"><a href="#æˆ‘çš„æ€è·¯" class="headerlink" title="æˆ‘çš„æ€è·¯"></a>æˆ‘çš„æ€è·¯</h4><p>å¯¹äºelgamalè¿™ä¸€å±‚å¹¶æ²¡æœ‰å¤šå°‘å¥½è¯´çš„ï¼Œæ˜¾ç„¶æˆ‘ä»¬åªèƒ½å…ˆå‘é€gå¾—åˆ°flagçš„å¯†æ–‡ï¼Œç„¶åæ„é€ å¦‚ä¸‹çš„é€‰æ‹©å¯†æ–‡ï¼š</p>
<script type="math/tex; mode=display">
C_0,kC_1</script><p>è¿™æ ·é¶æœºelgamalè§£å¯†åå¾—åˆ°çš„å°±æ˜¯kmäº†ã€‚ä½†æ˜¯ä»–ä¼šç»è¿‡GCMè§£å¯†ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸çŸ¥é“ä»–çš„å…·ä½“å€¼ã€‚ä½†å¾ˆæœ‰æ„æ€çš„ä¸€ç‚¹æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥è·å–kmçš„å­—èŠ‚é•¿åº¦ã€‚</p>
<p>æ¯”å¦‚æˆ‘ä»¬å°±ä»¤kä¸º1ï¼Œè¿”å›çš„æ˜¯21ä¸ªå­—èŠ‚ï¼Œå°±è¯´æ˜flagå…±æœ‰21ä¸ªå­—èŠ‚é•¿ã€‚åŒç†æˆ‘ä»¬å°±å¯ä»¥è·å¾—ä»»æ„kmçš„å­—èŠ‚é•¿åº¦ã€‚ä½†æ˜¯è¿™æœ‰ä¸€ä¸ªå‰æï¼Œé‚£å°±æ˜¯kmæœ¬èº«ä¸å¤§äºpã€‚æ‰€ä»¥è¦æƒ³è·å¾—æ­£ç¡®çš„é•¿åº¦ï¼Œæˆ‘ä»¬çš„kæ˜¯æœ‰å¤§å°é™åˆ¶çš„ï¼Œç”±äºpæ˜¯64å­—èŠ‚çš„é‡ï¼Œflagæ˜¯21å­—èŠ‚ï¼Œæ‰€ä»¥kæœ€å¤šå°±å–åˆ°43ï¼Œå†å¾€ä¸Šå–ï¼Œå¯†æ–‡å°±ä¼šæ¨¡päº†ã€‚</p>
<p>é‚£ä¹ˆè¦æƒ³ä¸€æƒ³æ€ä¹ˆèƒ½åˆ©ç”¨â€èƒ½çœ‹è§é•¿åº¦â€è¿™ä¸€ç‚¹ã€‚æˆ‘æƒ³åˆ°äº†ä¸€ä¸ªç±»ä¼¼äºäºŒåˆ†çš„æ€è·¯ã€‚è¦è¯´æ¸…æ¥šè¿™ä¸ªæ€è·¯è¦å…ˆä»ä¸‹é¢æ–¹å¼å¼€å§‹é˜è¿°ï¼š</p>
<ul>
<li><p>å¦‚æœå°†kä»1é€æ¸å¢å¤§ï¼Œé‚£ä¹ˆå¾—åˆ°çš„kmä¹Ÿé€æ¸å¢å¤§ã€‚</p>
</li>
<li><p>å½“kä¸º256æ—¶ï¼Œå¾—åˆ°çš„kmä¸€å®šæ˜¯22å­—èŠ‚(ç­‰ä»·äºå·¦ç§»ä¸€å­—èŠ‚)</p>
</li>
<li>è¿™è¯´æ˜ï¼Œkåœ¨1-256ä¹‹é—´ï¼Œä¸€å®šå­˜åœ¨ä¸€ä¸ªå€¼ï¼Œä½¿å¾—ï¼škm ä¸º21å­—èŠ‚ï¼Œ(k+1)mä¸º22å­—èŠ‚</li>
</ul>
<p>è€Œå¯¹è¿™æ ·çš„kï¼Œåˆå¯ä»¥ç”¨å¦‚ä¸‹ç­‰å¼å¯¹ä»–è¿›è¡Œæè¿°ï¼š</p>
<script type="math/tex; mode=display">
256^{20} < km < 256^{21}</script><script type="math/tex; mode=display">
256^{21} < (k+1)m < 256^{22}</script><p>éœ€è¦æ³¨æ„åˆ°ï¼Œä¸¤ä¸ªä¸ç­‰å¼å…¶å®éƒ½åªæœ‰ä¸€ä¾§æœ‰ç”¨ã€‚è¿™å°±å¯ä»¥åˆ’å‡ºä¸€ä¸ªmçš„èŒƒå›´ï¼š</p>
<script type="math/tex; mode=display">
\frac{256^{21}}{k+1} < m < \frac{256^{21}}{k}</script><p>è€Œæ‰¾åˆ°è¿™ä¸ªkçš„æ–¹æ³•å°±æ˜¯ç”¨äºŒåˆ†ã€‚å¹¶ä¸”kæ˜¯åœ¨æ¯ä¸€ä¸ªå½¢å¦‚å¦‚ä¸‹çš„åŒºé—´éƒ½å­˜åœ¨çš„ï¼š</p>
<script type="math/tex; mode=display">
(20,21),(21,22),(22,23),...,(63,64)</script><p>è¿™æ ·å°±å¯ä»¥å¯¹æ¯ä¸ªåŒºé—´éƒ½äºŒåˆ†æ‰¾åˆ°å¯¹åº”çš„kï¼Œç„¶ååˆ’å‡ºå¯¹åº”çš„mçš„èŒƒå›´ï¼Œç„¶åå–å‡ºå…¶ä¸­èŒƒå›´æœ€å°çš„ï¼Œå°±æ˜¯èƒ½ç•Œå®šåˆ°çš„mçš„æœ€ç²¾ç¡®çš„èŒƒå›´äº†ã€‚</p>
<p>ç„¶åå¯ä»¥å‘ç°mæœ€ç»ˆçš„èŒƒå›´æ˜¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="number">152626665263510331007404672103917694625051871477736</span>,<span class="number">152626665263510331007404672115803739317421271516525</span>)</span><br></pre></td></tr></table></figure>
<p>è¿™å…¶å®å·²ç»å¯ä»¥è½¬æˆbytesï¼Œçœ‹åˆ°flagçš„é«˜å­—èŠ‚ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hnp_m@kes_cc</span><br></pre></td></tr></table></figure>
<p>è¿™å°±æç¤ºé¢„æœŸæ˜¯hnpï¼Œä¸è¿‡hnpçš„æ€è·¯æˆ‘ç›´åˆ°æ¯”èµ›ç»“æŸéƒ½æ²¡æœ‰æƒ³åˆ°ï¼Œä½†æ˜¯èµ›åè¯·æ•™äº†hashhashå¸ˆå‚…æ˜ç™½äº†è¯¥æ€ä¹ˆåšï¼Œä¸€ä¼šå„¿ä¼šå†™åœ¨åé¢ã€‚</p>
<p>å…ˆé¡ºç€ç°åœ¨è¿™ä¸ªæ€è·¯ç»§ç»­è¯´å®Œã€‚flagä¸€å…±21ä¸ªå­—èŠ‚ï¼Œè€Œæˆ‘ä»¬ç°åœ¨æœ‰12ä¸ªå­—èŠ‚ï¼Œè¿˜ç¼ºå°‘9ä¸ªå­—èŠ‚ã€‚ä¸è¿‡flagæ˜¾ç„¶æ˜¯æœ‰ä¸€å®šè¯­ä¹‰çš„ã€‚æ¯”å¦‚å¾ˆè‡ªç„¶å°±ä¼šè§‰å¾—æ¥ä¸‹æ¥çš„ä¸¤ä¸ªå­—èŠ‚æ˜¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@_</span></span><br></pre></td></tr></table></figure>
<p>å› æ­¤å…¶å®æœ¬è´¨ä¸Šæ¥è¯´è¿˜å·®ä¸ƒä¸ªå­—èŠ‚æœªçŸ¥ï¼ŒæŒ‰é“ç†æ¥è¯´å¯ä»¥çŒœä¸€çŒœã€‚ä½†æ˜¯å…¶å®å¹¶ä¸æ˜¯éå¸¸å¥½çŒœå¯¹(æ¯•ç«Ÿä¸€ç›´äº¤é”™çš„flagæœ¬èº«ä¹Ÿæ˜¯ä¸ªå¾ˆå¥‡æ€ªçš„äº‹æƒ…)ï¼Œæ‰€ä»¥è¿˜è¦æƒ³æƒ³åŠæ³•ã€‚</p>
<p>æˆ‘è¿™é‡Œçš„æƒ³æ³•æ˜¯ï¼šä»2å¼€å§‹éå†ç´ æ•°ï¼Œå½“ä½œkã€‚æ­¤æ—¶æˆ‘ä»¬å‘é€C0ï¼Œk^(-1)C1ï¼Œè¿™æ ·æˆ‘ä»¬ä¼šå¾—åˆ°k^(-1)mæ¨¡pä¸‹çš„å€¼ï¼Œè€Œè¿™ä¸ªæ—¶å€™å°±ä¼šå‡ºç°ä¸¤ç§æƒ…å†µï¼š</p>
<ul>
<li>å¦‚æœå¾—åˆ°çš„ç»“æœæ˜¯ä¸€ä¸ªè¾ƒçŸ­çš„é‡(åå‡ äºŒåå­—èŠ‚)ï¼Œè¿™å…¶å®è¯´æ˜kæ˜¯flagçš„å› å­</li>
<li>å¦‚æœå¾—åˆ°çš„ç»“æœæ¥è¿‘äºä¹±ç (å…­åå¤šä¸ªå­—èŠ‚)ï¼Œè¯´æ˜kä¸æ˜¯flagçš„å› å­</li>
</ul>
<p>è€Œè¿™å¯¹æ±‚flagæœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿæˆ‘ä»¬å°†å·²çŸ¥çš„14ä¸ªå­—èŠ‚â€hnp_m@kes_cc@_â€è®°ä½œaï¼ŒæœªçŸ¥çš„7ä¸ªå­—èŠ‚è®°ä½œbã€‚é‚£ä¹ˆflagå¯ä»¥å†™æˆï¼š</p>
<script type="math/tex; mode=display">
256^7a+b</script><p>è€Œå‡å¦‚æˆ‘ä»¬èƒ½é€šè¿‡éå†ä¸€äº›å°ç´ æ•°çš„æ–¹å¼ï¼Œå¾—åˆ°flagçš„ä¸€äº›ç´ å› å­ï¼Œè®°è¿™äº›ç´ å› å­ä¹˜ç§¯ä¸ºnï¼Œé‚£ä¹ˆå°±æœ‰ï¼š</p>
<script type="math/tex; mode=display">
256^7a+b = 0 \quad(mod\;n)</script><p>å°±å¯ä»¥ç›´æ¥æ±‚å¾—bæ¨¡nä¸‹çš„å€¼ï¼š</p>
<script type="math/tex; mode=display">
b = -256^7a \quad (mod\;n)</script><p>è€Œæˆ‘ä»¬ç¼ºå°‘7å­—èŠ‚ï¼Œå¹¶ä¸”ç”±äºbåº”è¯¥æ˜¯å¯è§å­—ç¬¦æ‰“å¤´ï¼Œæ‰€ä»¥båº”è¯¥åœ¨53bitå¾€ä¸‹ï¼Œé‚£ä¹ˆåªè¦æˆ‘ä»¬èƒ½æ‰¾åˆ°ä¹˜ç§¯è‡³å°‘æœ‰ä¸ªäºŒä¸‰åbitçš„ä¸€äº›ç´ å› å­ï¼Œå°±å¯ä»¥é€šè¿‡çˆ†ç ´æ¥æœ€ç»ˆç¡®å®šæœ€åä¸ƒä¸ªå­—ç¬¦äº†ã€‚</p>
<p>ä½†æ˜¯å¾ˆé—æ†¾çš„æ˜¯ï¼Œflagèƒ½æ‰¾åˆ°çš„ä¸€äº›å°ç´ å› å­åªæœ‰2ã€13ã€31ï¼Œäº”åä¸‡ä»¥å†…éƒ½æ²¡æœ‰å…¶ä»–å› å­äº†ï¼Œæ‰€ä»¥çˆ†ç ´ä¸äº†ã€‚</p>
<p>ä¸è¿‡è¿˜æœ‰æœ€åä¸€æ‰‹å°±æ˜¯ç¡¬çŒœï¼Œè¿™ä¹Ÿæœ‰ä¸€äº›å°æŠ€å·§ï¼Œæ¯”å¦‚æ³¨æ„åˆ°æœ€åä¸¤ä¸ªbitä¸€å®šæ˜¯10ï¼Œæ‰€ä»¥ç»ä¸ä¼šæ˜¯ç”¨æ„Ÿå¹å·ç»“æŸï¼Œå› æ­¤å¤§æ¦‚ç‡æ˜¯ä¸€ä¸ªé•¿ä¸º7çš„ã€æ¢äº†ä¸€ç‚¹å­—ç¬¦çš„å•è¯ã€‚ç„¶åcheckçš„æ–¹å¼å°±æ˜¯çœ‹æ»¡ä¸æ»¡è¶³ä¸‹é¢çš„ç­‰å¼ï¼š</p>
<script type="math/tex; mode=display">
b = -256^7a \quad (mod\;2\times 13 \times 31)</script><p>ä½†æ˜¯çŒœäº†åŠå°æ—¶ä¹Ÿæ²¡çŒœå‡ºä»»ä½•ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„ï¼Œç¡®å®è¿˜æ˜¯æœ‰ç‚¹èƒŒäº†å“ˆå“ˆå“ˆã€‚</p>
<p>expï¼š</p>
<p>binary_searchï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">current_num = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">left = <span class="number">256</span>**<span class="number">20</span></span><br><span class="line">right = <span class="number">256</span>**<span class="number">21</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    current_num += <span class="number">1</span></span><br><span class="line">    left1 = <span class="number">256</span>**(current_num-<span class="number">1</span>)</span><br><span class="line">    right1 = <span class="number">256</span>**(current_num)</span><br><span class="line">    sh = remote(<span class="string">&quot;101.34.72.206&quot;</span>,<span class="number">1338</span>)</span><br><span class="line"></span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&quot;g&quot;</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;c = &quot;</span>)</span><br><span class="line">    c = <span class="built_in">eval</span>(sh.recvline().strip().decode())</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;p = &quot;</span>)</span><br><span class="line">    p = <span class="built_in">eval</span>(sh.recvline().strip().decode())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> trange(<span class="number">100</span>):</span><br><span class="line">        temp = (left1+right1)//<span class="number">2</span></span><br><span class="line">        sh.sendline(<span class="string">b&quot;o&quot;</span>)</span><br><span class="line">        sh.sendline(<span class="built_in">str</span>(c[<span class="number">0</span>]).encode()+<span class="string">b&quot;,&quot;</span>+<span class="built_in">str</span>(temp*c[<span class="number">1</span>]).encode())</span><br><span class="line">        sh.recvuntil(<span class="string">b&quot;&gt; data: [+] &quot;</span>)</span><br><span class="line"></span><br><span class="line">        clen = <span class="built_in">len</span>(sh.recvline().strip().decode())//<span class="number">2</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(clen == current_num+<span class="number">21</span>):</span><br><span class="line">            right1 = temp</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            left1 = temp</span><br><span class="line">        <span class="comment">#print(left1,right1)</span></span><br><span class="line">        <span class="keyword">if</span>(left1 &gt;= right1-<span class="number">1</span>):</span><br><span class="line">            templ = <span class="number">256</span>**(current_num+<span class="number">21</span>-<span class="number">1</span>) // (left1+<span class="number">1</span>)</span><br><span class="line">            tempr = <span class="number">256</span>**(current_num+<span class="number">21</span>-<span class="number">1</span>) // left1</span><br><span class="line">            <span class="keyword">if</span>(left &lt; templ):</span><br><span class="line">                left = templ</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;l&quot;</span>,left)</span><br><span class="line">            <span class="keyword">if</span>(right &gt; tempr):</span><br><span class="line">                right = tempr</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;r&quot;</span>,right)</span><br><span class="line">            sh.close()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    sh.close()</span><br><span class="line"></span><br><span class="line"><span class="comment">#hnp_m@kes_c</span></span><br></pre></td></tr></table></figure>
<p>getprimeï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> prod</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> next_prime</span><br><span class="line"></span><br><span class="line">primes = [<span class="number">2</span>,<span class="number">13</span>,<span class="number">31</span>]</span><br><span class="line"></span><br><span class="line">init = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    <span class="built_in">print</span>(init)</span><br><span class="line">    sh = remote(<span class="string">&quot;101.34.72.206&quot;</span>,<span class="number">1338</span>)</span><br><span class="line"></span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&quot;g&quot;</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;c = &quot;</span>)</span><br><span class="line">    c = <span class="built_in">eval</span>(sh.recvline().strip().decode())</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;p = &quot;</span>)</span><br><span class="line">    p = <span class="built_in">eval</span>(sh.recvline().strip().decode())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> trange(<span class="number">100</span>):</span><br><span class="line">        init = next_prime(init)</span><br><span class="line">        sh.sendline(<span class="string">b&quot;o&quot;</span>)</span><br><span class="line">        sh.sendline(<span class="built_in">str</span>(c[<span class="number">0</span>]).encode()+<span class="string">b&quot;,&quot;</span>+<span class="built_in">str</span>(inverse(init,p)*c[<span class="number">1</span>]).encode())</span><br><span class="line">        sh.recvuntil(<span class="string">b&quot;&gt; data: [+] &quot;</span>)</span><br><span class="line"></span><br><span class="line">        clen = <span class="built_in">len</span>(sh.recvline().strip().decode())//<span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span>(clen &lt; <span class="number">30</span>):</span><br><span class="line">            primes.append(init)</span><br><span class="line">            <span class="built_in">print</span>(primes)</span><br><span class="line">    sh.close()</span><br></pre></td></tr></table></figure>
<p>å¥‡æ€ªçš„ä¸€ç‚¹æ˜¯ï¼Œæˆ‘æœ€åæ•´ç†è„šæœ¬ï¼Œå®Œå…¨æ•´ç†æˆæˆ‘çš„è¿™ä¸ªäºŒåˆ†æ€è·¯åï¼Œå‘ç°å¾—ä¸åˆ°ä¸Šé¢å†™çš„é‚£ä¸ªç²¾ç¡®èŒƒå›´äº†ï¼Œåªèƒ½è·å¾—å‰11ä¸ªå­—èŠ‚ï¼Œæ›´åŠ éš¾çŒœã€‚</p>
<p>é‚£ä¹‹å‰é‚£ä¸ªèŒƒå›´æ˜¯æ€ä¹ˆäºŒåˆ†å‡ºæ¥çš„ï¼Ÿä¹Ÿè®¸ä¸€ä¸ªè«åå…¶å¦™çš„bugå…¶å®æŒ‡ç¤ºäº†ä¸€ä¸ªæ›´åˆç†çš„äºŒåˆ†æ€è·¯ï¼Ÿæœ‰å…´è¶£çš„å¸ˆå‚…å¯ä»¥çœ‹ä¸€çœ‹ï¼Œè¿™æ˜¯å‰ä¸€ä¸ªèŒƒå›´çš„äºŒåˆ†è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">left = <span class="number">256</span>**<span class="number">20</span></span><br><span class="line">right = <span class="number">256</span>**<span class="number">21</span></span><br><span class="line"></span><br><span class="line">current_num = <span class="number">3</span></span><br><span class="line">left1 = <span class="number">256</span>**(current_num-<span class="number">1</span>)</span><br><span class="line">right1 = <span class="number">256</span>**(current_num)</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    current_num += <span class="number">1</span></span><br><span class="line">    left1 = <span class="number">256</span>**(current_num-<span class="number">1</span>)</span><br><span class="line">    right1 = <span class="number">256</span>**(current_num)</span><br><span class="line">    sh = remote(<span class="string">&quot;101.34.72.206&quot;</span>,<span class="number">1338</span>)</span><br><span class="line"></span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&quot;g&quot;</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;c = &quot;</span>)</span><br><span class="line">    c = <span class="built_in">eval</span>(sh.recvline().strip().decode())</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;p = &quot;</span>)</span><br><span class="line">    p = <span class="built_in">eval</span>(sh.recvline().strip().decode())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> trange(<span class="number">100</span>):</span><br><span class="line">        temp = (left1+right1)//<span class="number">2</span></span><br><span class="line">        sh.sendline(<span class="string">b&quot;o&quot;</span>)</span><br><span class="line">        sh.sendline(<span class="built_in">str</span>(c[<span class="number">0</span>]).encode()+<span class="string">b&quot;,&quot;</span>+<span class="built_in">str</span>(temp*c[<span class="number">1</span>]).encode())</span><br><span class="line">        sh.recvuntil(<span class="string">b&quot;&gt; data: [+] &quot;</span>)</span><br><span class="line"></span><br><span class="line">        clen = <span class="built_in">len</span>(sh.recvline().strip().decode())//<span class="number">2</span></span><br><span class="line">        templ = <span class="number">256</span>**(clen-<span class="number">1</span>)//temp</span><br><span class="line">        tempr = <span class="number">256</span>**clen//temp</span><br><span class="line">        <span class="keyword">if</span>(clen == current_num+<span class="number">21</span>):</span><br><span class="line">            right1 = temp</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            left1 = temp</span><br><span class="line">        <span class="keyword">if</span>(left &lt; templ):</span><br><span class="line">            left = templ</span><br><span class="line">            <span class="built_in">print</span>(left,right)</span><br><span class="line">        <span class="keyword">if</span>(right &gt; tempr):</span><br><span class="line">            right = tempr</span><br><span class="line">            <span class="built_in">print</span>(left,right)</span><br><span class="line">    sh.close()</span><br><span class="line"></span><br><span class="line"><span class="comment">#152626665263510331007404672103917694625051871477736</span></span><br><span class="line"><span class="comment">#152626665263510331007404672115803739317421271516525</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">#hnp_m@kes_cc</span></span><br><span class="line"><span class="comment">#@_easier!!</span></span><br></pre></td></tr></table></figure>
<h4 id="é¢„æœŸæ€è·¯-hnp"><a href="#é¢„æœŸæ€è·¯-hnp" class="headerlink" title="é¢„æœŸæ€è·¯(hnp)"></a>é¢„æœŸæ€è·¯(hnp)</h4><p>æ„é€ å¯†æ–‡çš„æ–¹å¼è¿˜æ˜¯ä¸€æ ·ï¼Œå‘é€C0,kC1ï¼Œå¾—åˆ°kmæ¨¡pä¸‹çš„AES-GCMè§£å¯†ç»“æœã€‚</p>
<p>åªæ˜¯æœ‰ä¸€ç‚¹ä¸åŒï¼Œè¿™é‡Œå¯¹kæ²¡æœ‰ä»»ä½•é™åˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥ä»»é€‰kå‘é€ï¼Œä½†æ˜¯æˆ‘ä»¬åªä¼šå–ç”¨<strong>ä¸è¶³64å­—èŠ‚çš„å¯†æ–‡</strong>ã€‚è¿™æ ·åšçš„æ„ä¹‰åœ¨äºï¼š</p>
<script type="math/tex; mode=display">
c_i = k_im \quad(mod\;p)</script><p>ä¸­çš„ciå°±ä¼šæ˜¯ä¸€ä¸ªæœ€å¤š504bitçš„å°é‡ã€‚è€Œä»–åˆå¯ä»¥å†™æˆç­‰å¼ï¼š</p>
<script type="math/tex; mode=display">
c_i = k_im + t_ip</script><p>æ‰€ä»¥æ”¶é›†å¤šç»„kiï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„é€ å¦‚ä¸‹æ ¼ï¼š</p>
<script type="math/tex; mode=display">
\left(\begin{matrix}
1&k_1&k_2&...&k_n\\
&p_1\\
&&p_2\\
&&&...\\
&&&&p_n
\end{matrix}\right)</script><p>è¿™ä¸ªæ ¼å…·æœ‰çš„çº¿æ€§å…³ç³»æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
(m,t_1,t_2,...,t_n)
\left(\begin{matrix}
1&k_1&k_2&...&k_n\\
&p_1\\
&&p_2\\
&&&...\\
&&&&p_n
\end{matrix}\right)
=
(m,c_1,c_2,...,c_n)</script><p>ç„¶åé…ä¸€ä¸‹ç³»æ•°å°±å¯ä»¥è§„çº¦å‡ºå«mçš„ç›®æ ‡å‘é‡äº†ã€‚</p>
<p>è‡³äºè¦å¤šå°‘ç»„æ•°æ®ï¼Œæˆ‘ç”¨é«˜æ–¯å¯å‘å¼ç²—ç•¥ç®—äº†ä¸€ä¸‹æ€ä¹ˆéƒ½è¦äºŒåç»„å¾€ä¸Šæ‰å¤Ÿï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>,<span class="number">50</span>):</span><br><span class="line">    T = <span class="number">256</span>^(<span class="number">63</span>-<span class="number">21</span>)</span><br><span class="line">    L = Matrix(ZZ,l+<span class="number">1</span>,l+<span class="number">1</span>)</span><br><span class="line">    L[<span class="number">0</span>,<span class="number">0</span>] = T</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">        L[i+<span class="number">1</span>,i+<span class="number">1</span>] = p</span><br><span class="line"></span><br><span class="line">    <span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">guass_Heuristic</span>(<span class="params">L</span>):</span><br><span class="line">        n = L.nrows()</span><br><span class="line">        efficient = (n/(<span class="number">2</span>*pi*e))**(<span class="number">0.5</span>)</span><br><span class="line">        <span class="built_in">print</span>(l,<span class="built_in">len</span>(<span class="built_in">bin</span>(<span class="built_in">int</span>(efficient*iroot(<span class="built_in">abs</span>(L.det()),n)[<span class="number">0</span>]))[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line">    guass_Heuristic(L)</span><br></pre></td></tr></table></figure>
<p>ç¨³å¦¥èµ·è§æˆ‘å–äº†å››åç»„ã€‚ä½†æ˜¯è¿™æ ·åšçš„ä¸€ä¸ªå°ç¼ºç‚¹æ˜¯ï¼Œkiéšæœºå–çš„è¯ï¼Œé‚£ä¹ˆè¿”å›çš„é‡ä¹Ÿå¯ä»¥è¿‘ä¼¼çœ‹ä½œæ¨¡pä¸‹çš„éšæœºæ•°ï¼Œé‚£ä¹ˆä»–å°äº504bitçš„æœºä¼šä¹Ÿåªæœ‰1/256å·¦å³ï¼Œä¸€èˆ¬æ¥è¯´éœ€è¦ä¸¤ä¸‰ç»„æ‰èƒ½å–åˆ°ä¸€ä¸ªè¿™æ ·çš„aã€‚æ‰€ä»¥è¦è·å–å‡ åç»„æ•°æ®çš„è¯ï¼Œè¿æ°”ä¸å¥½å¯èƒ½ä¼šæ¯”è¾ƒèŠ±æ—¶é—´ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Pwn4Sage.pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a = []</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    sh = remote(<span class="string">&quot;101.34.72.206&quot;</span>,<span class="number">1338</span>)</span><br><span class="line"></span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&quot;g&quot;</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;c = &quot;</span>)</span><br><span class="line">    c = <span class="built_in">eval</span>(sh.recvline().strip().decode())</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;p = &quot;</span>)</span><br><span class="line">    p = <span class="built_in">eval</span>(sh.recvline().strip().decode())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">        k = randint((p-<span class="number">1</span>)//<span class="number">2</span>,p-<span class="number">1</span>)</span><br><span class="line">        sh.sendline(<span class="string">b&quot;o&quot;</span>)</span><br><span class="line">        sh.sendline(<span class="built_in">str</span>(c[<span class="number">0</span>]).encode()+<span class="string">b&quot;,&quot;</span>+<span class="built_in">str</span>(k*c[<span class="number">1</span>]).encode())</span><br><span class="line">        sh.recvuntil(<span class="string">b&quot;&gt; data: [+] &quot;</span>)</span><br><span class="line"></span><br><span class="line">        clen = <span class="built_in">len</span>(sh.recvline().strip().decode())//<span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span>(clen == <span class="number">63</span>):</span><br><span class="line">            a.append((k,p))</span><br><span class="line">    sh.close()</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(a))</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">len</span>(a) &gt;= <span class="number">40</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">T = <span class="number">256</span>^(<span class="number">63</span>-<span class="number">21</span>)</span><br><span class="line">L = matrix(ZZ,<span class="built_in">len</span>(a)+<span class="number">1</span>,<span class="built_in">len</span>(a)+<span class="number">1</span>)</span><br><span class="line">L[<span class="number">0</span>,<span class="number">0</span>] = T</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    L[<span class="number">0</span>,i+<span class="number">1</span>] = a[i][<span class="number">0</span>]</span><br><span class="line">    L[i+<span class="number">1</span>,i+<span class="number">1</span>] = a[i][<span class="number">1</span>]</span><br><span class="line">res = L.BKZ()[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">abs</span>(<span class="built_in">int</span>(res[<span class="number">0</span>]//T))))</span><br><span class="line"></span><br><span class="line"><span class="comment">#ctfpunk&#123;hnp_m@kes_cc@_m0re_e2&#125;</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åæ±‚å‡ºäº†flagï¼Œçœ‹çœ‹ä»–çš„åˆ†è§£ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span> Â· <span class="number">13</span> Â· <span class="number">31</span> Â· <span class="number">189363108267382544674199345043360000978136712867</span></span><br></pre></td></tr></table></figure>
<p>å¥½å§ï¼Œç¡®å®æ­»çš„ä¸å†¤ã€‚çŒœä¹Ÿæ˜¯çŒœä¸åˆ°çš„ï¼Œå› ä¸ºè™½ç„¶æ„æ€ä¸€æ ·ï¼Œä½†æˆ‘åªè€ƒè™‘è¿‡easierï¼Œå¹¶ä¸”é•¿åº¦è¿˜å¯¹ä¸ä¸Š</p>
<h4 id="ï¼ˆ2-6æ›´æ–°ï¼‰"><a href="#ï¼ˆ2-6æ›´æ–°ï¼‰" class="headerlink" title="ï¼ˆ2.6æ›´æ–°ï¼‰"></a>ï¼ˆ2.6æ›´æ–°ï¼‰</h4><p>ä»Šå¤©å›äº†è¶Ÿè€å®¶ï¼Œååœ¨è½¦ä¸Šçš„æ—¶å€™ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œçªç„¶æƒ³æ˜ç™½äº†è‡ªå·±èµ›ä¸­çš„äºŒåˆ†ä¸ºä»€ä¹ˆåªèƒ½å‡ºå‰12ä¸ªå­—èŠ‚ã€‚</p>
<p>è¿™æ˜¯å› ä¸ºï¼Œæˆ‘åœ¨æ¯æ¬¡ä½¿ç”¨äºŒåˆ†çš„æ—¶å€™ï¼Œéƒ½åªç”¨äº†100æ¬¡äº¤äº’æœºä¼šã€‚è€Œå†å›é¡¾æˆ‘ä»¬ä¹‹å‰çš„äºŒåˆ†åˆ’çš„èŒƒå›´ï¼š</p>
<script type="math/tex; mode=display">
\frac{256^{21}}{k+1} < m < \frac{256^{21}}{k}</script><p>è¿™æ˜¯å¯¹ç¬¬ä¸€æ¬¡äºŒåˆ†è€Œè¨€çš„ï¼Œæ­¤æ—¶kçš„èŒƒå›´åœ¨1-256ä¹‹é—´ï¼Œkçš„å«ä¹‰æ˜¯<strong>ä½¿(k+1)mä¸º22å­—èŠ‚ï¼Œkmä¸º21å­—èŠ‚</strong>çš„kã€‚é‚£ä¹ˆæˆ‘ä»¬è¿™æ—¶å€™ç”¨äºŒåˆ†æ¥æ‰¾è¿™æ ·çš„kï¼Œç”±äº256=2^8ï¼Œæœ€å¤šéœ€è¦å…«æ¬¡ã€‚</p>
<p>è€Œå¯¹äºç¬¬äºŒæ¬¡äºŒåˆ†ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ–°kï¼Œå…¶å«ä¹‰ä¸å˜ï¼Œåªæ˜¯è¿™ä¸€æ¬¡æˆ‘ä»¬è¦æ‰¾åˆ°çš„æ˜¯<strong>ä½¿(k+1)mä¸º23å­—èŠ‚ï¼Œkmä¸º22å­—èŠ‚</strong>çš„kï¼Œå› æ­¤è¿™ä¸€æ¬¡äºŒåˆ†ï¼Œkçš„èŒƒå›´åœ¨256-256^2ï¼Œæ‰€ä»¥äºŒåˆ†æœ€å¤šéœ€è¦16æ¬¡ã€‚</p>
<p>è€Œè¿™æ ·åˆ’åˆ†èŒƒå›´å…¶å®å¾ˆå®¹æ˜“å°±èƒ½æ˜ç™½ï¼Œå…¶å®è¶Šå¤§çš„kå…¶ç²¾åº¦å°±è¶Šé«˜ï¼Œä½†æ˜¯äºŒåˆ†æ¬¡æ•°ä¹Ÿå°±éœ€è¦è¶Šå¤šã€‚æ¯”å¦‚æˆ‘ä»¬å¦‚æœæ‰¾åˆ°<strong>ä½¿(k+1)mä¸º43å­—èŠ‚ï¼Œkmä¸º42å­—èŠ‚</strong>çš„kï¼Œå¾—åˆ°çš„é‚£ä¸ªèŒƒå›´å°±å¾ˆå°äº†ï¼Œä¹Ÿå°±åŸºæœ¬ä¸Šæ˜¯mçš„å‡†ç¡®å€¼ã€‚ä½†æ˜¯æ³¨æ„ï¼Œæ­¤æ—¶éœ€è¦æ‰¾çš„kåœ¨256^21-256^22ä¹‹é—´ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦çš„äºŒåˆ†æ¬¡æ•°ä¹Ÿå°±æœ€å¤šéœ€è¦åˆ°172æ¬¡ã€‚è¿™å…¶å®ä¹Ÿå°±ä¾§é¢è¯´æ˜ï¼Œæˆ‘ä»¬äº¤äº’172æ¬¡å°±èƒ½å¾—åˆ°ä¸€ä¸ªéå¸¸ç²¾ç¡®çš„flagèŒƒå›´äº†ã€‚</p>
<p>æ‰€ä»¥ï¼Œå…¶å®æˆ‘ä»¬æ ¹æœ¬ä¸éœ€è¦ä»1-256å¼€å§‹ï¼Œæ…¢æ…¢çš„å»æ‰¾256-256^2ï¼Œ256^2-256^3â€¦.è¿™æ¯ä¸ªé˜¶æ®µå¯¹åº”çš„k(å› ä¸ºè¶Šåé¢ç²¾åº¦è¶Šé«˜)ã€‚è€Œå¯ä»¥ç›´æ¥å»äºŒåˆ†æ‰¾åˆ°<strong>ä½¿(k+1)mä¸º43å­—èŠ‚ï¼Œkmä¸º42å­—èŠ‚</strong>çš„kã€‚è™½ç„¶ä¸€æ¬¡åªèƒ½äº¤äº’100æ¬¡è€Œä¸€å…±éœ€è¦170+æ¬¡ï¼Œä½†é—®é¢˜ä¸å¤§ï¼Œåˆ†ä¸¤æ¬¡äº¤äº’å°±å¯ä»¥ã€‚</p>
<p>æ‰€ä»¥è¯´ï¼Œä¹‹æ‰€ä»¥åªèƒ½å‡ºå‰åäºŒä¸ªå­—èŠ‚ï¼Œæ˜¯å› ä¸ºèµ›ä¸­æ¯ä¸€æ¬¡äºŒåˆ†æˆ‘éƒ½æœ€å¤šåªç”¨äº†ä¸€æ¬¡äº¤äº’ã€‚æ‰€ä»¥è¶…è¿‡12ä¸ªå­—èŠ‚ä¹‹åçš„èŒƒå›´å…¶å®ä¸æ˜¯ç²¾åº¦ä¸å¤Ÿï¼Œè€Œæ˜¯è¶…è¿‡äº†100bitï¼Œæ ¹æœ¬å°±æ²¡äºŒåˆ†å®Œã€æ ¹æœ¬å°±æ²¡æ‰¾åˆ°kï¼Œæ‰€ä»¥æ‰ä¸å‡ºç»“æœã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">current_num = <span class="number">23</span></span><br><span class="line"></span><br><span class="line">left1 = <span class="number">256</span>**(current_num-<span class="number">1</span>)</span><br><span class="line">right1 = <span class="number">256</span>**(current_num)</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    sh = remote(<span class="string">&quot;101.34.72.206&quot;</span>,<span class="number">1338</span>)</span><br><span class="line"></span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&quot;g&quot;</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;c = &quot;</span>)</span><br><span class="line">    c = <span class="built_in">eval</span>(sh.recvline().strip().decode())</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;p = &quot;</span>)</span><br><span class="line">    p = <span class="built_in">eval</span>(sh.recvline().strip().decode())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> trange(<span class="number">100</span>):</span><br><span class="line">        temp = (left1+right1)//<span class="number">2</span></span><br><span class="line">        sh.sendline(<span class="string">b&quot;o&quot;</span>)</span><br><span class="line">        sh.sendline(<span class="built_in">str</span>(c[<span class="number">0</span>]).encode()+<span class="string">b&quot;,&quot;</span>+<span class="built_in">str</span>(temp*c[<span class="number">1</span>]).encode())</span><br><span class="line">        sh.recvuntil(<span class="string">b&quot;&gt; data: [+] &quot;</span>)</span><br><span class="line"></span><br><span class="line">        clen = <span class="built_in">len</span>(sh.recvline().strip().decode())//<span class="number">2</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(clen == current_num+<span class="number">21</span>):</span><br><span class="line">            right1 = temp</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            left1 = temp</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(left1 &gt;= right1-<span class="number">1</span>):</span><br><span class="line">            tempr = <span class="number">256</span>**(current_num+<span class="number">21</span>-<span class="number">1</span>) // left1</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(tempr))</span><br><span class="line">            sh.close()</span><br><span class="line">            exit()</span><br><span class="line"></span><br><span class="line">    sh.close()</span><br><span class="line"></span><br><span class="line"><span class="comment">#hnp_m@kes_cc@_m0re_e2</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>ç³–é†‹å°é¸¡å—
  </li>
  <li class="post-copyright-link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="https://tangcuxiaojikuai.xyz/post/d14a80bb.html" title="2024-N1CTF-junior-wp-crypto">https://tangcuxiaojikuai.xyz/post/d14a80bb.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sacreative/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SACREATIVE</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>
</div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/post/e052b7cc.html" rel="prev" title="2023-N1CTF-junior-wp-crypto">
      <i class="fa fa-chevron-left"></i> 2023-N1CTF-junior-wp-crypto
    </a></div>
      <div class="post-nav-item">
    <a href="/post/5b8f1174.html" rel="next" title="2024-BeginCTF-wp-crypto">
      2024-BeginCTF-wp-crypto <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Junior-RSA"><span class="nav-number">1.</span> <span class="nav-text">Junior RSA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Masquerade"><span class="nav-number">2.</span> <span class="nav-text">Masquerade</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CC"><span class="nav-number">3.</span> <span class="nav-text">*CC@</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%88%91%E7%9A%84%E6%80%9D%E8%B7%AF"><span class="nav-number">3.1.</span> <span class="nav-text">æˆ‘çš„æ€è·¯</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A2%84%E6%9C%9F%E6%80%9D%E8%B7%AF-hnp"><span class="nav-number">3.2.</span> <span class="nav-text">é¢„æœŸæ€è·¯(hnp)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%882-6%E6%9B%B4%E6%96%B0%EF%BC%89"><span class="nav-number">3.3.</span> <span class="nav-text">ï¼ˆ2.6æ›´æ–°ï¼‰</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="ç³–é†‹å°é¸¡å—"
      src="/images/image.png">
  <p class="site-author-name" itemprop="name">ç³–é†‹å°é¸¡å—</p>
  <div class="site-description" itemprop="description">"è¿½é£èµ¶æœˆè«åœç•™ï¼Œå¹³èŠœå°½å¤„æ˜¯æ˜¥å±±"</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">81</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="/1142381085@qq.com" title="E-Mail â†’ 1142381085@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/6394335993" title="Weibo â†’ https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;6394335993" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ç³–é†‹å°é¸¡å—</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> å¼ºåŠ›é©±åŠ¨
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>
  <script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'UPEMA7DyYbIIEyOW72ohgytU-gzGzoHsz',
      appKey     : 'M7rXAfeP3JOslroay2n0Jv2R',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
<!-- å¼•å…¥jQuery -->
<script type="text/javascript" src="//libs.baidu.com/jquery/1.8.3/jquery.min.js"></script>
<!-- é›ªèŠ±ç‰¹æ•ˆ2 -->
<script type="text/javascript" src="/js/snow2.js"></script>
