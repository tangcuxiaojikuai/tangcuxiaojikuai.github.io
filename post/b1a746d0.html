<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon_small.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="RnN18ZogmZl_dLVpxZ6y8kjKL73Mu9VLVEkw9d3qrq0" />
  <meta name="msvalidate.01" content="DC3050AD55F30DDF75AAB78517714910" />
  <meta name="baidu-site-verification" content="codeva-PPofu3dNxe" />

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-loading-bar.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"tangcuxiaojikuai.xyz","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="记录一下DASCTF系列赛。">
<meta property="og:type" content="article">
<meta property="og:title" content="2024-DASCTF十月挑战赛-wp-crypto">
<meta property="og:url" content="https://tangcuxiaojikuai.xyz/post/b1a746d0.html">
<meta property="og:site_name" content="糖醋小鸡块的blog">
<meta property="og:description" content="记录一下DASCTF系列赛。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-10-19T14:02:37.000Z">
<meta property="article:modified_time" content="2024-10-20T04:35:43.778Z">
<meta property="article:author" content="糖醋小鸡块">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://tangcuxiaojikuai.xyz/post/b1a746d0.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>2024-DASCTF十月挑战赛-wp-crypto | 糖醋小鸡块的blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">糖醋小鸡块的blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-友链">

    <a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tangcuxiaojikuai.xyz/post/b1a746d0.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/image.png">
      <meta itemprop="name" content="糖醋小鸡块">
      <meta itemprop="description" content=""追风赶月莫停留，平芜尽处是春山"">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="糖醋小鸡块的blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2024-DASCTF十月挑战赛-wp-crypto
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-10-19 22:02:37" itemprop="dateCreated datePublished" datetime="2024-10-19T22:02:37+08:00">2024-10-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-10-20 12:35:43" itemprop="dateModified" datetime="2024-10-20T12:35:43+08:00">2024-10-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/wp-crypto/" itemprop="url" rel="index"><span itemprop="name">wp-crypto</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/post/b1a746d0.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/post/b1a746d0.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>记录一下DASCTF系列赛。</p>
<span id="more"></span>
<h3 id="ez-RSA"><a href="#ez-RSA" class="headerlink" title="ez_RSA"></a>ez_RSA</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">一道简单的RSA</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">num1 = getPrime(<span class="number">512</span>)</span><br><span class="line">num2 = getPrime(<span class="number">512</span>)</span><br><span class="line"><span class="keyword">while</span> num1&lt;num2 :</span><br><span class="line">    num2 = getPrime(<span class="number">512</span>)</span><br><span class="line">ring = RealField(<span class="number">1050</span>)</span><br><span class="line">num3 = ring(num1) /ring(num2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;num3=&quot;</span>,num3)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n=p*q</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"></span><br><span class="line">n2 = getPrime(<span class="number">512</span>) * getPrime(<span class="number">512</span>)</span><br><span class="line">e1 = randint(<span class="number">1000</span>,<span class="number">2000</span>)</span><br><span class="line">e2 = randint(<span class="number">1000</span>,<span class="number">2000</span>)</span><br><span class="line">c1 = <span class="built_in">pow</span>(p+num1,e1,n2)</span><br><span class="line">c2 = <span class="built_in">pow</span>(p+num2,e2,n2)</span><br><span class="line"></span><br><span class="line">q1 = getPrime(<span class="number">512</span>)</span><br><span class="line">leak1 = <span class="built_in">pow</span>(q+q1,<span class="number">2024</span>,n)</span><br><span class="line">leak2 = <span class="built_in">pow</span>(q1+<span class="number">2024</span>,q,n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n2=&quot;</span>,n2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e1=&quot;</span>,e1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e2=&quot;</span>,e2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c1=&quot;</span>,c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c2=&quot;</span>,c2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;leak1=&quot;</span>,leak1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;leak2=&quot;</span>,leak2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">num3= 1.36557212221826657073387899060669771982679822943621690677450888408226656788387273887547841291114809989272635809810564202247340711087479554863446719786359395466961253205133910506682801159622545780721946115442033391600881399634390008053822158098121985270501317972263356522400827768601773721146954464269212959784543085</span></span><br><span class="line"><span class="string">n= 85105083975491693151454182116844944807066048677068373328227644321539783064315677834754866742549592569194223084173286381150626593510265361114796714226058887906219454795525438819082646860141163940340082006344850825956811992304447978369108606993344902286569100146695092703383844402883938506877787042873586279543</span></span><br><span class="line"><span class="string">c= 8090472119640930864901421058741085326954308673260202542020919764880488559370287585797498390920330336595858609617432370825503480936376306766495089200286004922821787548265246289552343468177624634434613746605553770994437785042510225956023382347023663125411103947669109085411939772215657220674436476279268458980</span></span><br><span class="line"><span class="string">n2= 101642316595332652021348165259853423287787139517550249986161819826180514401858258316466101056877182367161299111697465439636861942636526396547011727147471566130633614685728563576613692851860684686033186826342178072882901576159305747639645374751566751967096281105148714033096611618024355982220235949274576036321</span></span><br><span class="line"><span class="string">e1= 1630</span></span><br><span class="line"><span class="string">e2= 1866</span></span><br><span class="line"><span class="string">c1= 8857135083997055103287497833179378469532619748945804429057682575070405217145941944821968708809563240261403711644389684947851643865895254406194464015430673347359589677809515117412321862622147634752091324365628790687343748145339949310696116239361890881096088375070083053010564890401663562726144984405628773323</span></span><br><span class="line"><span class="string">c2= 44531030636557714647477473185500183066851251320453194953972504422367649302810396344051696851757189817391648356459225688318373454949578822468293099948132700460437006478679492801335689493431764882835346904225119630026545592437198370606462285405519745361570058335573353886454277790277663038008240372746639859253</span></span><br><span class="line"><span class="string">leak1= 82301473255013183706458389946960254392188270550712533886416705365418418731488346328643954589202172816597173052792573628245245948345810581701878535280775967863966009605872386693838526935762655380705962833467046779524956212498594045378770790026387120339093736625186401934354434702063802537686761251873173518029</span></span><br><span class="line"><span class="string">leak2= 43580171648136008789232340619597144591536098696024883687397347933098380327258730482377138309020375265135558484586783368757872008322883985094403855691297725907800406097129735499961231236473313141257901326737291586051506797429883866846199683028143924054925109557329949641367848264351523500925115860458645738192</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>题目比较套但也很常规，一步一步来。</p>
<h4 id="part1"><a href="#part1" class="headerlink" title="part1"></a>part1</h4><p>给出$R = RealField(1050)$上的：</p>
<script type="math/tex; mode=display">
num_3 = \frac{R(num_1)}{R(num_2)}</script><p>其中num1、num2都是512bit的素数，连分数展开一下并做check就有num1和num2了。</p>
<h4 id="part2"><a href="#part2" class="headerlink" title="part2"></a>part2</h4><p>生成两个512bit的素数乘积n2，并给出：</p>
<script type="math/tex; mode=display">
c_1 = (p+num_1)^{e_1} \quad(mod\;n_2)</script><script type="math/tex; mode=display">
c_2 = (p+num_2)^{e_2} \quad(mod\;n_2)</script><p>而这个式子里除了p我们什么都有，并且e也不大，所以做个gcd就有p了。得到p之后自然也能求出q，所以其实已经完全可以求解flag。</p>
<h4 id="part3"><a href="#part3" class="headerlink" title="part3"></a>part3</h4><p>这里把第三部分也做一做，第三部分先生成一个512bit的随机素数q，并给出了：</p>
<script type="math/tex; mode=display">
leak_1 = (q+q_1)^{2024} \quad(mod\;n)</script><script type="math/tex; mode=display">
leak_2 = (q_1 + 2024)^q \quad(mod\;n)</script><p>显然在模q下有：</p>
<script type="math/tex; mode=display">
leak_1 = q_1^{2024} \quad(mod\;q)</script><script type="math/tex; mode=display">
leak_2 = q_1 + 2024 \quad(mod\;q)</script><p>所以有：</p>
<script type="math/tex; mode=display">
q = gcd(leak_1 - (leak_2-2024)^{2024} \quad , \quad n)</script><h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">HGCD</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="number">2</span> * b.degree() &lt;= a.degree() <span class="keyword">or</span> a.degree() == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    m = a.degree() // <span class="number">2</span></span><br><span class="line">    a_top, a_bot = a.quo_rem(x^m)</span><br><span class="line">    b_top, b_bot = b.quo_rem(x^m)</span><br><span class="line">    R00, R01, R10, R11 = HGCD(a_top, b_top)</span><br><span class="line">    c = R00 * a + R01 * b</span><br><span class="line">    d = R10 * a + R11 * b</span><br><span class="line">    q, e = c.quo_rem(d)</span><br><span class="line">    d_top, d_bot = d.quo_rem(x^(m // <span class="number">2</span>))</span><br><span class="line">    e_top, e_bot = e.quo_rem(x^(m // <span class="number">2</span>))</span><br><span class="line">    S00, S01, S10, S11 = HGCD(d_top, e_top)</span><br><span class="line">    RET00 = S01 * R00 + (S00 - q * S01) * R10</span><br><span class="line">    RET01 = S01 * R01 + (S00 - q * S01) * R11</span><br><span class="line">    RET10 = S11 * R00 + (S10 - q * S11) * R10</span><br><span class="line">    RET11 = S11 * R01 + (S10 - q * S11) * R11</span><br><span class="line">    <span class="keyword">return</span> RET00, RET01, RET10, RET11</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GCD</span>(<span class="params">a, b</span>):</span><br><span class="line">    q, r = a.quo_rem(b)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line">    R00, R01, R10, R11 = HGCD(a, b)</span><br><span class="line">    c = R00 * a + R01 * b</span><br><span class="line">    d = R10 * a + R11 * b</span><br><span class="line">    <span class="keyword">if</span> d == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> c.monic()</span><br><span class="line">    q, r = c.quo_rem(d)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> d</span><br><span class="line">    <span class="keyword">return</span> GCD(d, r)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">num3= <span class="number">1.36557212221826657073387899060669771982679822943621690677450888408226656788387273887547841291114809989272635809810564202247340711087479554863446719786359395466961253205133910506682801159622545780721946115442033391600881399634390008053822158098121985270501317972263356522400827768601773721146954464269212959784543085</span></span><br><span class="line">n= <span class="number">85105083975491693151454182116844944807066048677068373328227644321539783064315677834754866742549592569194223084173286381150626593510265361114796714226058887906219454795525438819082646860141163940340082006344850825956811992304447978369108606993344902286569100146695092703383844402883938506877787042873586279543</span></span><br><span class="line">c= <span class="number">8090472119640930864901421058741085326954308673260202542020919764880488559370287585797498390920330336595858609617432370825503480936376306766495089200286004922821787548265246289552343468177624634434613746605553770994437785042510225956023382347023663125411103947669109085411939772215657220674436476279268458980</span></span><br><span class="line">n2= <span class="number">101642316595332652021348165259853423287787139517550249986161819826180514401858258316466101056877182367161299111697465439636861942636526396547011727147471566130633614685728563576613692851860684686033186826342178072882901576159305747639645374751566751967096281105148714033096611618024355982220235949274576036321</span></span><br><span class="line">e1= <span class="number">1630</span></span><br><span class="line">e2= <span class="number">1866</span></span><br><span class="line">c1= <span class="number">8857135083997055103287497833179378469532619748945804429057682575070405217145941944821968708809563240261403711644389684947851643865895254406194464015430673347359589677809515117412321862622147634752091324365628790687343748145339949310696116239361890881096088375070083053010564890401663562726144984405628773323</span></span><br><span class="line">c2= <span class="number">44531030636557714647477473185500183066851251320453194953972504422367649302810396344051696851757189817391648356459225688318373454949578822468293099948132700460437006478679492801335689493431764882835346904225119630026545592437198370606462285405519745361570058335573353886454277790277663038008240372746639859253</span></span><br><span class="line">leak1= <span class="number">82301473255013183706458389946960254392188270550712533886416705365418418731488346328643954589202172816597173052792573628245245948345810581701878535280775967863966009605872386693838526935762655380705962833467046779524956212498594045378770790026387120339093736625186401934354434702063802537686761251873173518029</span></span><br><span class="line">leak2= <span class="number">43580171648136008789232340619597144591536098696024883687397347933098380327258730482377138309020375265135558484586783368757872008322883985094403855691297725907800406097129735499961231236473313141257901326737291586051506797429883866846199683028143924054925109557329949641367848264351523500925115860458645738192</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">################################################# 1</span></span><br><span class="line">t = continued_fraction(num3)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    num1 = t.numerator(i)</span><br><span class="line">    <span class="keyword">if</span>(isPrime(num1) <span class="keyword">and</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(num1)[<span class="number">2</span>:]) == <span class="number">512</span>):</span><br><span class="line">        num2 = t.denominator(i)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################################################# 2</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n2))</span><br><span class="line">f1 = (x + num1)^e1 - c1</span><br><span class="line">f2 = (x + num2)^e2 - c2</span><br><span class="line">res = GCD(f1,f2)</span><br><span class="line">P = -res.monic().coefficients()[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">Q = n // P</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(c,inverse(<span class="number">65537</span>,(P-<span class="number">1</span>)*(Q-<span class="number">1</span>)),P*Q))))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">################################################# 3</span></span><br><span class="line">q = gcd(leak1 - (leak2 - <span class="number">2024</span>)^<span class="number">2024</span>, n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#DASCTF&#123;c0ngr4tu1ati0n$_0n_$ucccc3$$1ng_1n!&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="easy-xor"><a href="#easy-xor" class="headerlink" title="easy_xor"></a>easy_xor</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xor is an interesting operation.</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">msg</span>):</span><br><span class="line">    p = getPrime(<span class="number">256</span>)</span><br><span class="line">    n = <span class="number">2</span>^<span class="number">512</span></span><br><span class="line">    x = msg[<span class="number">0</span>] &lt;&lt; <span class="number">7</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> msg:</span><br><span class="line">        x = <span class="built_in">int</span>(x*p % n)</span><br><span class="line">        x ^^= i</span><br><span class="line">    <span class="keyword">return</span> x ^^ <span class="built_in">len</span>(msg) ,p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">prime_to_matrix</span>(<span class="params">p , n</span>):</span><br><span class="line">    </span><br><span class="line">    binary_rep = <span class="built_in">bin</span>(p)[<span class="number">2</span>:].zfill(n^<span class="number">2</span>)</span><br><span class="line">    matrix = Matrix(GF(<span class="number">2</span>), n, n, [<span class="built_in">int</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> binary_rep])</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> matrix</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix_to_prime</span>(<span class="params">matrix, n</span>):</span><br><span class="line"></span><br><span class="line">    binary_rep = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">str</span>(matrix[i, j]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n))</span><br><span class="line">    p = <span class="built_in">int</span>(binary_rep, <span class="number">2</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line">key = os.urandom(<span class="number">16</span>)</span><br><span class="line">key_list = [i <span class="keyword">for</span> i <span class="keyword">in</span> key]</span><br><span class="line">c,p = encrypt(key_list)</span><br><span class="line"></span><br><span class="line">P = prime_to_matrix(p,<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">q = getPrime(<span class="number">256</span>) </span><br><span class="line">Q = prime_to_matrix(q,<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">R = P*Q</span><br><span class="line">r = matrix_to_prime(R,<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">s = p^^r</span><br><span class="line">S = prime_to_matrix(s,<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">array_q = []</span><br><span class="line">t = q</span><br><span class="line"><span class="keyword">while</span> t &gt; <span class="number">0</span>:</span><br><span class="line">    array_q.append(t%<span class="number">256</span>)</span><br><span class="line">    t = t//<span class="number">256</span></span><br><span class="line"></span><br><span class="line">m = <span class="built_in">len</span>(array_q)</span><br><span class="line">A = matrix(ZZ,m,m)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span>  <span class="built_in">range</span>(m):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        A[i,j] = randint(<span class="number">65537</span>//<span class="number">2</span>,<span class="number">65537</span>)</span><br><span class="line"></span><br><span class="line">x = matrix(ZZ,[array_q])</span><br><span class="line">x = x.T</span><br><span class="line">e = matrix(ZZ,m,<span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    e[i,<span class="number">0</span>] = randint(<span class="number">1</span>,<span class="number">256</span>)</span><br><span class="line">b = A*x + e  </span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;out.txt&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">f&quot;S = <span class="subst">&#123;S&#125;</span>\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">f&quot;A = <span class="subst">&#123;A&#125;</span>\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">f&quot;b = <span class="subst">&#123;b&#125;</span>\n&quot;</span>)</span><br><span class="line">    </span><br><span class="line">flag = <span class="string">&quot;CBCTF&#123;&quot;</span>+sha256(key).hexdigest()+<span class="string">&quot;&#125;&quot;</span></span><br></pre></td></tr></table></figure>
<p>仍然比较套，流程有三个主要步骤：</p>
<ul>
<li><p>先生成一个16字节的随机key，并按如下方式对key进行加密：</p>
<script type="math/tex; mode=display">
c = ((((2^7k_1)p \oplus k_1)p \oplus k_2)p ...)p \oplus k_{16} \oplus 16 \quad(mod\;2^{512})</script><p>其中p是个256bit的素数，暂时没有给出，仅仅给出了c</p>
</li>
<li><p>随机生成256bit的素数q，并按比特生成一个16x16的矩阵，记为Q，同时也记p的矩阵为P，计算：</p>
<script type="math/tex; mode=display">
R = PQ</script><p>将R转为256bit的数字r，然后计算：</p>
<script type="math/tex; mode=display">
s = p \oplus r</script><p>将s对应的矩阵记为S，给出S</p>
</li>
<li><p>最后一步是将q的256进制表示成一个向量x，然后生成随机矩阵A和误差向量e，计算：</p>
<script type="math/tex; mode=display">
b = Ax + e</script><p>并给出b、A</p>
</li>
</ul>
<p>从后往前，首先最后一步显然是ZZ上的LWE样本，所以可以得到向量x，得到向量x也就得到了q，自然也就得到了对应的矩阵Q。</p>
<p>那么对于第二步，我们有下面两个式子：</p>
<script type="math/tex; mode=display">
R = PQ</script><script type="math/tex; mode=display">
s = p \oplus r</script><p>其实第二个式子在模2下也可以写成矩阵形式：</p>
<script type="math/tex; mode=display">
S = P + R</script><p>我们有Q和S，所以联立两个式子可以得到：</p>
<script type="math/tex; mode=display">
S = P + PQ</script><p>所以解矩阵方程就可以得到P：</p>
<script type="math/tex; mode=display">
P(Q + E) = S</script><blockquote>
<p>模2下加减号其实没差</p>
</blockquote>
<p>得到P之后自然有p，那么最后一步就是根据p、c以及如下关系式计算key：</p>
<script type="math/tex; mode=display">
c = ((((2^7k_1)p \oplus k_1)p \oplus k_2)p ...)p \oplus k_{16} \oplus 16 \quad(mod\;2^{512})</script><p>这在国赛其实有出现过，由于异或其实也就是加一个-256到256的数字，所以上式其实就是：</p>
<script type="math/tex; mode=display">
c \oplus 16 = ((((2^7k_1)p + k'_1)p + k'_2)p ...)p + k'_{16} \quad(mod\;2^{512})</script><p>可以看出这是个关于p的迭代多项式，所以展开一下就是：</p>
<script type="math/tex; mode=display">
c \oplus 16 = 2^7k_1p^{16} + {k'}_1p^{15} + {k'}_2p^{14} + ... + k'_{16} \quad(mod\;2^{512})</script><p>多项式系数都很小，所以LLL一下就能得到全部系数，之后从后往前两两做差并异或，就可以把系数转化回key了。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">prime_to_matrix</span>(<span class="params">p , n</span>):</span><br><span class="line">    </span><br><span class="line">    binary_rep = <span class="built_in">bin</span>(p)[<span class="number">2</span>:].zfill(n^<span class="number">2</span>)</span><br><span class="line">    matrix = Matrix(GF(<span class="number">2</span>), n, n, [<span class="built_in">int</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> binary_rep])</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> matrix</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix_to_prime</span>(<span class="params">matrix, n</span>):</span><br><span class="line"></span><br><span class="line">    binary_rep = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">str</span>(matrix[i, j]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n))</span><br><span class="line">    p = <span class="built_in">int</span>(binary_rep, <span class="number">2</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line">c = <span class="number">3235165504936419327001182958857604252407894106191511594689199770239529482330201776634335054024549532136197669522057846845936856432300465191006002492337710</span></span><br><span class="line">S = [[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>],</span><br><span class="line">[<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">[<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>],</span><br><span class="line">[<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>],</span><br><span class="line">[<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>],</span><br><span class="line">[<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>],</span><br><span class="line">[<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>],</span><br><span class="line">[<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">[<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>],</span><br><span class="line">[<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>],</span><br><span class="line">[<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>],</span><br><span class="line">[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>],</span><br><span class="line">[<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>],</span><br><span class="line">[<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>],</span><br><span class="line">[<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>],</span><br><span class="line">[<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]]</span><br><span class="line">A = [[<span class="number">58759</span>,<span class="number">40201</span>,<span class="number">39541</span>,<span class="number">50266</span>,<span class="number">35606</span>,<span class="number">44877</span>,<span class="number">56746</span>,<span class="number">51320</span>,<span class="number">40748</span>,<span class="number">58265</span>,<span class="number">48198</span>,<span class="number">36126</span>,<span class="number">48722</span>,<span class="number">38757</span>,<span class="number">34645</span>,<span class="number">49875</span>,<span class="number">39713</span>,<span class="number">39344</span>,<span class="number">34596</span>,<span class="number">44689</span>,<span class="number">40300</span>,<span class="number">55926</span>,<span class="number">43000</span>,<span class="number">56106</span>,<span class="number">63327</span>,<span class="number">47482</span>,<span class="number">39178</span>,<span class="number">49257</span>,<span class="number">45418</span>,<span class="number">48650</span>,<span class="number">50427</span>,<span class="number">41214</span>],</span><br><span class="line">[<span class="number">37223</span>,<span class="number">34740</span>,<span class="number">55875</span>,<span class="number">61596</span>,<span class="number">60851</span>,<span class="number">42409</span>,<span class="number">41726</span>,<span class="number">54223</span>,<span class="number">37354</span>,<span class="number">44483</span>,<span class="number">35507</span>,<span class="number">64442</span>,<span class="number">65181</span>,<span class="number">65016</span>,<span class="number">52834</span>,<span class="number">59838</span>,<span class="number">45696</span>,<span class="number">50951</span>,<span class="number">64689</span>,<span class="number">55931</span>,<span class="number">44398</span>,<span class="number">62595</span>,<span class="number">54959</span>,<span class="number">40901</span>,<span class="number">53153</span>,<span class="number">37642</span>,<span class="number">49294</span>,<span class="number">44606</span>,<span class="number">54073</span>,<span class="number">65437</span>,<span class="number">35212</span>,<span class="number">45412</span>],</span><br><span class="line">[<span class="number">48231</span>,<span class="number">47498</span>,<span class="number">50751</span>,<span class="number">54438</span>,<span class="number">52483</span>,<span class="number">45749</span>,<span class="number">46482</span>,<span class="number">53434</span>,<span class="number">64253</span>,<span class="number">62408</span>,<span class="number">48700</span>,<span class="number">34564</span>,<span class="number">57730</span>,<span class="number">54295</span>,<span class="number">53081</span>,<span class="number">42645</span>,<span class="number">56470</span>,<span class="number">49043</span>,<span class="number">41516</span>,<span class="number">35479</span>,<span class="number">61962</span>,<span class="number">56805</span>,<span class="number">64471</span>,<span class="number">48806</span>,<span class="number">56148</span>,<span class="number">64688</span>,<span class="number">50255</span>,<span class="number">50303</span>,<span class="number">48066</span>,<span class="number">63253</span>,<span class="number">45081</span>,<span class="number">37202</span>],</span><br><span class="line">[<span class="number">39500</span>,<span class="number">47944</span>,<span class="number">47148</span>,<span class="number">55510</span>,<span class="number">41735</span>,<span class="number">34408</span>,<span class="number">42033</span>,<span class="number">47874</span>,<span class="number">52667</span>,<span class="number">65230</span>,<span class="number">38185</span>,<span class="number">57224</span>,<span class="number">57960</span>,<span class="number">57242</span>,<span class="number">43751</span>,<span class="number">40229</span>,<span class="number">50706</span>,<span class="number">48842</span>,<span class="number">56675</span>,<span class="number">63792</span>,<span class="number">38602</span>,<span class="number">43856</span>,<span class="number">47968</span>,<span class="number">36029</span>,<span class="number">46316</span>,<span class="number">33861</span>,<span class="number">43062</span>,<span class="number">52545</span>,<span class="number">36833</span>,<span class="number">38576</span>,<span class="number">33160</span>,<span class="number">47188</span>],</span><br><span class="line">[<span class="number">34763</span>,<span class="number">52602</span>,<span class="number">34003</span>,<span class="number">38138</span>,<span class="number">52214</span>,<span class="number">37082</span>,<span class="number">46267</span>,<span class="number">41357</span>,<span class="number">53209</span>,<span class="number">46658</span>,<span class="number">37405</span>,<span class="number">38698</span>,<span class="number">48689</span>,<span class="number">58684</span>,<span class="number">65468</span>,<span class="number">53156</span>,<span class="number">37151</span>,<span class="number">42127</span>,<span class="number">52088</span>,<span class="number">60960</span>,<span class="number">40078</span>,<span class="number">54636</span>,<span class="number">55496</span>,<span class="number">63227</span>,<span class="number">39694</span>,<span class="number">39226</span>,<span class="number">42924</span>,<span class="number">46628</span>,<span class="number">51678</span>,<span class="number">47049</span>,<span class="number">57251</span>,<span class="number">39950</span>],</span><br><span class="line">[<span class="number">47060</span>,<span class="number">53229</span>,<span class="number">53324</span>,<span class="number">34857</span>,<span class="number">53402</span>,<span class="number">57558</span>,<span class="number">41164</span>,<span class="number">32890</span>,<span class="number">40952</span>,<span class="number">63714</span>,<span class="number">59742</span>,<span class="number">64510</span>,<span class="number">45578</span>,<span class="number">35856</span>,<span class="number">53314</span>,<span class="number">33442</span>,<span class="number">55935</span>,<span class="number">53065</span>,<span class="number">47134</span>,<span class="number">46908</span>,<span class="number">34203</span>,<span class="number">63156</span>,<span class="number">40093</span>,<span class="number">40012</span>,<span class="number">42585</span>,<span class="number">48353</span>,<span class="number">42197</span>,<span class="number">40052</span>,<span class="number">55471</span>,<span class="number">56463</span>,<span class="number">59090</span>,<span class="number">43410</span>],</span><br><span class="line">[<span class="number">42707</span>,<span class="number">46054</span>,<span class="number">36404</span>,<span class="number">47963</span>,<span class="number">47992</span>,<span class="number">38350</span>,<span class="number">33551</span>,<span class="number">63065</span>,<span class="number">53172</span>,<span class="number">62321</span>,<span class="number">51122</span>,<span class="number">42997</span>,<span class="number">60500</span>,<span class="number">47212</span>,<span class="number">39884</span>,<span class="number">38212</span>,<span class="number">35359</span>,<span class="number">64344</span>,<span class="number">35149</span>,<span class="number">36069</span>,<span class="number">49665</span>,<span class="number">34591</span>,<span class="number">34888</span>,<span class="number">46184</span>,<span class="number">46025</span>,<span class="number">43702</span>,<span class="number">50458</span>,<span class="number">43440</span>,<span class="number">42957</span>,<span class="number">55777</span>,<span class="number">38349</span>,<span class="number">62364</span>],</span><br><span class="line">[<span class="number">45114</span>,<span class="number">54936</span>,<span class="number">52699</span>,<span class="number">38175</span>,<span class="number">56136</span>,<span class="number">37236</span>,<span class="number">42829</span>,<span class="number">36618</span>,<span class="number">60030</span>,<span class="number">45321</span>,<span class="number">63661</span>,<span class="number">42951</span>,<span class="number">62906</span>,<span class="number">57387</span>,<span class="number">39828</span>,<span class="number">65151</span>,<span class="number">46434</span>,<span class="number">48641</span>,<span class="number">48942</span>,<span class="number">46877</span>,<span class="number">64558</span>,<span class="number">62541</span>,<span class="number">54391</span>,<span class="number">42591</span>,<span class="number">63174</span>,<span class="number">60575</span>,<span class="number">57658</span>,<span class="number">43790</span>,<span class="number">61543</span>,<span class="number">61629</span>,<span class="number">43407</span>,<span class="number">39256</span>],</span><br><span class="line">[<span class="number">41315</span>,<span class="number">61872</span>,<span class="number">47514</span>,<span class="number">42455</span>,<span class="number">60909</span>,<span class="number">54071</span>,<span class="number">50796</span>,<span class="number">40555</span>,<span class="number">40903</span>,<span class="number">48007</span>,<span class="number">58870</span>,<span class="number">48415</span>,<span class="number">59960</span>,<span class="number">52920</span>,<span class="number">54333</span>,<span class="number">49750</span>,<span class="number">43868</span>,<span class="number">36540</span>,<span class="number">53277</span>,<span class="number">55958</span>,<span class="number">56116</span>,<span class="number">55847</span>,<span class="number">50861</span>,<span class="number">39109</span>,<span class="number">63323</span>,<span class="number">51663</span>,<span class="number">40245</span>,<span class="number">61514</span>,<span class="number">49405</span>,<span class="number">38631</span>,<span class="number">40884</span>,<span class="number">41575</span>],</span><br><span class="line">[<span class="number">58569</span>,<span class="number">51882</span>,<span class="number">33541</span>,<span class="number">51174</span>,<span class="number">56449</span>,<span class="number">62583</span>,<span class="number">39528</span>,<span class="number">52284</span>,<span class="number">61467</span>,<span class="number">61079</span>,<span class="number">35129</span>,<span class="number">38211</span>,<span class="number">46027</span>,<span class="number">45383</span>,<span class="number">51330</span>,<span class="number">56124</span>,<span class="number">62629</span>,<span class="number">44368</span>,<span class="number">42101</span>,<span class="number">58060</span>,<span class="number">50492</span>,<span class="number">44668</span>,<span class="number">56796</span>,<span class="number">60349</span>,<span class="number">52581</span>,<span class="number">56199</span>,<span class="number">61597</span>,<span class="number">42695</span>,<span class="number">38011</span>,<span class="number">57044</span>,<span class="number">53206</span>,<span class="number">54786</span>],</span><br><span class="line">[<span class="number">47321</span>,<span class="number">62828</span>,<span class="number">42621</span>,<span class="number">47424</span>,<span class="number">33743</span>,<span class="number">62088</span>,<span class="number">49711</span>,<span class="number">61521</span>,<span class="number">57670</span>,<span class="number">43704</span>,<span class="number">57504</span>,<span class="number">64149</span>,<span class="number">48406</span>,<span class="number">61490</span>,<span class="number">35062</span>,<span class="number">47479</span>,<span class="number">49000</span>,<span class="number">53346</span>,<span class="number">34652</span>,<span class="number">64934</span>,<span class="number">60709</span>,<span class="number">42379</span>,<span class="number">55886</span>,<span class="number">38403</span>,<span class="number">32818</span>,<span class="number">49335</span>,<span class="number">34353</span>,<span class="number">38220</span>,<span class="number">55492</span>,<span class="number">53597</span>,<span class="number">43511</span>,<span class="number">65458</span>],</span><br><span class="line">[<span class="number">36970</span>,<span class="number">58823</span>,<span class="number">43553</span>,<span class="number">34488</span>,<span class="number">45459</span>,<span class="number">54107</span>,<span class="number">36469</span>,<span class="number">33268</span>,<span class="number">48487</span>,<span class="number">37195</span>,<span class="number">50544</span>,<span class="number">41167</span>,<span class="number">64538</span>,<span class="number">44132</span>,<span class="number">47555</span>,<span class="number">52965</span>,<span class="number">33728</span>,<span class="number">38671</span>,<span class="number">60378</span>,<span class="number">51219</span>,<span class="number">42761</span>,<span class="number">33794</span>,<span class="number">35819</span>,<span class="number">52469</span>,<span class="number">48730</span>,<span class="number">57793</span>,<span class="number">59596</span>,<span class="number">54642</span>,<span class="number">34866</span>,<span class="number">65462</span>,<span class="number">60317</span>,<span class="number">58309</span>],</span><br><span class="line">[<span class="number">57083</span>,<span class="number">59902</span>,<span class="number">43498</span>,<span class="number">58168</span>,<span class="number">51020</span>,<span class="number">48060</span>,<span class="number">40540</span>,<span class="number">40849</span>,<span class="number">52773</span>,<span class="number">34442</span>,<span class="number">56495</span>,<span class="number">51822</span>,<span class="number">52167</span>,<span class="number">36704</span>,<span class="number">56534</span>,<span class="number">38609</span>,<span class="number">65188</span>,<span class="number">36395</span>,<span class="number">63399</span>,<span class="number">58948</span>,<span class="number">64253</span>,<span class="number">61676</span>,<span class="number">42001</span>,<span class="number">40624</span>,<span class="number">42533</span>,<span class="number">61537</span>,<span class="number">65194</span>,<span class="number">50368</span>,<span class="number">37166</span>,<span class="number">55338</span>,<span class="number">64318</span>,<span class="number">60883</span>],</span><br><span class="line">[<span class="number">38819</span>,<span class="number">55867</span>,<span class="number">35918</span>,<span class="number">36263</span>,<span class="number">55150</span>,<span class="number">61800</span>,<span class="number">40998</span>,<span class="number">51487</span>,<span class="number">60551</span>,<span class="number">55103</span>,<span class="number">64935</span>,<span class="number">37621</span>,<span class="number">44826</span>,<span class="number">60725</span>,<span class="number">37993</span>,<span class="number">59843</span>,<span class="number">54224</span>,<span class="number">55716</span>,<span class="number">36215</span>,<span class="number">37215</span>,<span class="number">41474</span>,<span class="number">33618</span>,<span class="number">63366</span>,<span class="number">43856</span>,<span class="number">50237</span>,<span class="number">58623</span>,<span class="number">37522</span>,<span class="number">50735</span>,<span class="number">44656</span>,<span class="number">38173</span>,<span class="number">50608</span>,<span class="number">53558</span>],</span><br><span class="line">[<span class="number">34900</span>,<span class="number">37778</span>,<span class="number">46423</span>,<span class="number">39412</span>,<span class="number">60092</span>,<span class="number">51148</span>,<span class="number">38323</span>,<span class="number">53310</span>,<span class="number">56808</span>,<span class="number">51387</span>,<span class="number">45360</span>,<span class="number">51882</span>,<span class="number">33763</span>,<span class="number">52239</span>,<span class="number">58031</span>,<span class="number">38137</span>,<span class="number">53084</span>,<span class="number">57559</span>,<span class="number">42893</span>,<span class="number">47903</span>,<span class="number">53781</span>,<span class="number">44518</span>,<span class="number">57306</span>,<span class="number">50958</span>,<span class="number">39625</span>,<span class="number">64130</span>,<span class="number">54299</span>,<span class="number">36323</span>,<span class="number">55685</span>,<span class="number">39663</span>,<span class="number">32956</span>,<span class="number">40248</span>],</span><br><span class="line">[<span class="number">52223</span>,<span class="number">62894</span>,<span class="number">35658</span>,<span class="number">47955</span>,<span class="number">53222</span>,<span class="number">33292</span>,<span class="number">40082</span>,<span class="number">55850</span>,<span class="number">35931</span>,<span class="number">57385</span>,<span class="number">61556</span>,<span class="number">36711</span>,<span class="number">55509</span>,<span class="number">64333</span>,<span class="number">55598</span>,<span class="number">63410</span>,<span class="number">54748</span>,<span class="number">33026</span>,<span class="number">44444</span>,<span class="number">46688</span>,<span class="number">34221</span>,<span class="number">41402</span>,<span class="number">37978</span>,<span class="number">56794</span>,<span class="number">51509</span>,<span class="number">33728</span>,<span class="number">46849</span>,<span class="number">58278</span>,<span class="number">51893</span>,<span class="number">41375</span>,<span class="number">47226</span>,<span class="number">46681</span>],</span><br><span class="line">[<span class="number">52976</span>,<span class="number">34891</span>,<span class="number">47925</span>,<span class="number">43442</span>,<span class="number">59515</span>,<span class="number">34153</span>,<span class="number">59957</span>,<span class="number">55001</span>,<span class="number">55731</span>,<span class="number">51519</span>,<span class="number">58333</span>,<span class="number">49760</span>,<span class="number">55771</span>,<span class="number">35969</span>,<span class="number">37262</span>,<span class="number">34006</span>,<span class="number">51319</span>,<span class="number">33088</span>,<span class="number">58729</span>,<span class="number">43841</span>,<span class="number">61794</span>,<span class="number">46314</span>,<span class="number">60137</span>,<span class="number">36895</span>,<span class="number">64435</span>,<span class="number">37994</span>,<span class="number">60705</span>,<span class="number">48788</span>,<span class="number">37855</span>,<span class="number">61710</span>,<span class="number">47819</span>,<span class="number">42593</span>],</span><br><span class="line">[<span class="number">61352</span>,<span class="number">40709</span>,<span class="number">36161</span>,<span class="number">47983</span>,<span class="number">45760</span>,<span class="number">53141</span>,<span class="number">39843</span>,<span class="number">64766</span>,<span class="number">43219</span>,<span class="number">59102</span>,<span class="number">41023</span>,<span class="number">35212</span>,<span class="number">34127</span>,<span class="number">55560</span>,<span class="number">59265</span>,<span class="number">51853</span>,<span class="number">36176</span>,<span class="number">36365</span>,<span class="number">64261</span>,<span class="number">58669</span>,<span class="number">55196</span>,<span class="number">54380</span>,<span class="number">54787</span>,<span class="number">56392</span>,<span class="number">51638</span>,<span class="number">46506</span>,<span class="number">33332</span>,<span class="number">64068</span>,<span class="number">47810</span>,<span class="number">64586</span>,<span class="number">55243</span>,<span class="number">34259</span>],</span><br><span class="line">[<span class="number">55770</span>,<span class="number">57863</span>,<span class="number">57900</span>,<span class="number">49538</span>,<span class="number">62388</span>,<span class="number">49553</span>,<span class="number">49700</span>,<span class="number">65293</span>,<span class="number">59573</span>,<span class="number">34557</span>,<span class="number">45202</span>,<span class="number">38030</span>,<span class="number">37606</span>,<span class="number">63523</span>,<span class="number">60307</span>,<span class="number">60828</span>,<span class="number">56235</span>,<span class="number">34309</span>,<span class="number">33666</span>,<span class="number">54514</span>,<span class="number">61250</span>,<span class="number">36319</span>,<span class="number">34338</span>,<span class="number">64016</span>,<span class="number">48939</span>,<span class="number">64224</span>,<span class="number">60796</span>,<span class="number">39570</span>,<span class="number">47126</span>,<span class="number">57106</span>,<span class="number">64591</span>,<span class="number">52600</span>],</span><br><span class="line">[<span class="number">44615</span>,<span class="number">45732</span>,<span class="number">55786</span>,<span class="number">36582</span>,<span class="number">42334</span>,<span class="number">49303</span>,<span class="number">60246</span>,<span class="number">33709</span>,<span class="number">48035</span>,<span class="number">45869</span>,<span class="number">51532</span>,<span class="number">55821</span>,<span class="number">50199</span>,<span class="number">54772</span>,<span class="number">44909</span>,<span class="number">50088</span>,<span class="number">38610</span>,<span class="number">45149</span>,<span class="number">39935</span>,<span class="number">64626</span>,<span class="number">41655</span>,<span class="number">57944</span>,<span class="number">53886</span>,<span class="number">40673</span>,<span class="number">36939</span>,<span class="number">33676</span>,<span class="number">40293</span>,<span class="number">50839</span>,<span class="number">61527</span>,<span class="number">60699</span>,<span class="number">51922</span>,<span class="number">44106</span>],</span><br><span class="line">[<span class="number">65377</span>,<span class="number">62356</span>,<span class="number">55220</span>,<span class="number">59201</span>,<span class="number">43963</span>,<span class="number">64568</span>,<span class="number">37991</span>,<span class="number">40846</span>,<span class="number">45998</span>,<span class="number">51359</span>,<span class="number">47140</span>,<span class="number">54987</span>,<span class="number">52330</span>,<span class="number">44097</span>,<span class="number">48724</span>,<span class="number">40654</span>,<span class="number">33688</span>,<span class="number">44820</span>,<span class="number">44244</span>,<span class="number">50178</span>,<span class="number">57279</span>,<span class="number">55648</span>,<span class="number">63665</span>,<span class="number">41583</span>,<span class="number">32832</span>,<span class="number">57810</span>,<span class="number">57402</span>,<span class="number">59925</span>,<span class="number">51002</span>,<span class="number">58322</span>,<span class="number">36333</span>,<span class="number">51125</span>],</span><br><span class="line">[<span class="number">41287</span>,<span class="number">34166</span>,<span class="number">56834</span>,<span class="number">40393</span>,<span class="number">59397</span>,<span class="number">38911</span>,<span class="number">49904</span>,<span class="number">36849</span>,<span class="number">58510</span>,<span class="number">35840</span>,<span class="number">57339</span>,<span class="number">54476</span>,<span class="number">40809</span>,<span class="number">39457</span>,<span class="number">50758</span>,<span class="number">40572</span>,<span class="number">46317</span>,<span class="number">61096</span>,<span class="number">62870</span>,<span class="number">49606</span>,<span class="number">38598</span>,<span class="number">47450</span>,<span class="number">60284</span>,<span class="number">58987</span>,<span class="number">51986</span>,<span class="number">45080</span>,<span class="number">63220</span>,<span class="number">40176</span>,<span class="number">36875</span>,<span class="number">45807</span>,<span class="number">43529</span>,<span class="number">56068</span>],</span><br><span class="line">[<span class="number">48193</span>,<span class="number">48774</span>,<span class="number">33289</span>,<span class="number">42145</span>,<span class="number">49312</span>,<span class="number">47521</span>,<span class="number">39914</span>,<span class="number">51925</span>,<span class="number">39917</span>,<span class="number">48165</span>,<span class="number">47224</span>,<span class="number">63940</span>,<span class="number">49652</span>,<span class="number">57371</span>,<span class="number">39924</span>,<span class="number">48775</span>,<span class="number">41194</span>,<span class="number">48318</span>,<span class="number">48655</span>,<span class="number">46114</span>,<span class="number">53818</span>,<span class="number">42672</span>,<span class="number">52893</span>,<span class="number">63011</span>,<span class="number">62802</span>,<span class="number">44759</span>,<span class="number">46134</span>,<span class="number">47433</span>,<span class="number">54340</span>,<span class="number">36563</span>,<span class="number">41569</span>,<span class="number">60490</span>],</span><br><span class="line">[<span class="number">44350</span>,<span class="number">46084</span>,<span class="number">52253</span>,<span class="number">34130</span>,<span class="number">42256</span>,<span class="number">42059</span>,<span class="number">57465</span>,<span class="number">53689</span>,<span class="number">55189</span>,<span class="number">58968</span>,<span class="number">57975</span>,<span class="number">36629</span>,<span class="number">59833</span>,<span class="number">56538</span>,<span class="number">41512</span>,<span class="number">53160</span>,<span class="number">65479</span>,<span class="number">57214</span>,<span class="number">42956</span>,<span class="number">59310</span>,<span class="number">44119</span>,<span class="number">58409</span>,<span class="number">56941</span>,<span class="number">43799</span>,<span class="number">63205</span>,<span class="number">64438</span>,<span class="number">62116</span>,<span class="number">46552</span>,<span class="number">64986</span>,<span class="number">55088</span>,<span class="number">63289</span>,<span class="number">64992</span>],</span><br><span class="line">[<span class="number">59981</span>,<span class="number">65120</span>,<span class="number">50830</span>,<span class="number">49306</span>,<span class="number">65152</span>,<span class="number">33117</span>,<span class="number">45446</span>,<span class="number">59937</span>,<span class="number">59628</span>,<span class="number">50051</span>,<span class="number">52405</span>,<span class="number">58739</span>,<span class="number">51865</span>,<span class="number">50946</span>,<span class="number">39868</span>,<span class="number">43945</span>,<span class="number">51093</span>,<span class="number">43390</span>,<span class="number">51371</span>,<span class="number">56690</span>,<span class="number">54484</span>,<span class="number">59380</span>,<span class="number">34086</span>,<span class="number">55929</span>,<span class="number">35559</span>,<span class="number">57879</span>,<span class="number">57400</span>,<span class="number">62067</span>,<span class="number">39189</span>,<span class="number">35199</span>,<span class="number">36107</span>,<span class="number">60269</span>],</span><br><span class="line">[<span class="number">53525</span>,<span class="number">51814</span>,<span class="number">63825</span>,<span class="number">54602</span>,<span class="number">63470</span>,<span class="number">51388</span>,<span class="number">41444</span>,<span class="number">42796</span>,<span class="number">64239</span>,<span class="number">39348</span>,<span class="number">32780</span>,<span class="number">34184</span>,<span class="number">40353</span>,<span class="number">46874</span>,<span class="number">46188</span>,<span class="number">56655</span>,<span class="number">49280</span>,<span class="number">44606</span>,<span class="number">53601</span>,<span class="number">52204</span>,<span class="number">51605</span>,<span class="number">61067</span>,<span class="number">38266</span>,<span class="number">53926</span>,<span class="number">50113</span>,<span class="number">62374</span>,<span class="number">55836</span>,<span class="number">35390</span>,<span class="number">58903</span>,<span class="number">55867</span>,<span class="number">62906</span>,<span class="number">35522</span>],</span><br><span class="line">[<span class="number">63603</span>,<span class="number">53936</span>,<span class="number">57720</span>,<span class="number">64444</span>,<span class="number">34320</span>,<span class="number">61868</span>,<span class="number">51306</span>,<span class="number">64322</span>,<span class="number">38351</span>,<span class="number">42819</span>,<span class="number">53198</span>,<span class="number">49825</span>,<span class="number">43151</span>,<span class="number">39952</span>,<span class="number">36588</span>,<span class="number">43407</span>,<span class="number">63775</span>,<span class="number">44609</span>,<span class="number">50383</span>,<span class="number">55258</span>,<span class="number">56905</span>,<span class="number">32794</span>,<span class="number">64407</span>,<span class="number">42274</span>,<span class="number">42412</span>,<span class="number">32771</span>,<span class="number">37915</span>,<span class="number">52745</span>,<span class="number">36204</span>,<span class="number">61105</span>,<span class="number">44689</span>,<span class="number">57883</span>],</span><br><span class="line">[<span class="number">57362</span>,<span class="number">57294</span>,<span class="number">63492</span>,<span class="number">60398</span>,<span class="number">45797</span>,<span class="number">53784</span>,<span class="number">56740</span>,<span class="number">33939</span>,<span class="number">44595</span>,<span class="number">65455</span>,<span class="number">37575</span>,<span class="number">33954</span>,<span class="number">53422</span>,<span class="number">57271</span>,<span class="number">52175</span>,<span class="number">55068</span>,<span class="number">49522</span>,<span class="number">40490</span>,<span class="number">53837</span>,<span class="number">56155</span>,<span class="number">46962</span>,<span class="number">51752</span>,<span class="number">60461</span>,<span class="number">45680</span>,<span class="number">32875</span>,<span class="number">44901</span>,<span class="number">33050</span>,<span class="number">46546</span>,<span class="number">41262</span>,<span class="number">51455</span>,<span class="number">35039</span>,<span class="number">60243</span>],</span><br><span class="line">[<span class="number">41721</span>,<span class="number">44309</span>,<span class="number">60714</span>,<span class="number">49640</span>,<span class="number">38811</span>,<span class="number">50954</span>,<span class="number">35039</span>,<span class="number">61157</span>,<span class="number">55683</span>,<span class="number">37992</span>,<span class="number">64013</span>,<span class="number">38705</span>,<span class="number">41688</span>,<span class="number">61244</span>,<span class="number">55284</span>,<span class="number">39208</span>,<span class="number">34102</span>,<span class="number">44140</span>,<span class="number">42076</span>,<span class="number">44126</span>,<span class="number">39098</span>,<span class="number">37919</span>,<span class="number">47494</span>,<span class="number">38276</span>,<span class="number">39471</span>,<span class="number">57038</span>,<span class="number">39324</span>,<span class="number">45531</span>,<span class="number">33300</span>,<span class="number">32850</span>,<span class="number">63827</span>,<span class="number">61734</span>],</span><br><span class="line">[<span class="number">50638</span>,<span class="number">49699</span>,<span class="number">44478</span>,<span class="number">58948</span>,<span class="number">41101</span>,<span class="number">54366</span>,<span class="number">56564</span>,<span class="number">44044</span>,<span class="number">51920</span>,<span class="number">45510</span>,<span class="number">56763</span>,<span class="number">59125</span>,<span class="number">61576</span>,<span class="number">43849</span>,<span class="number">48245</span>,<span class="number">38731</span>,<span class="number">34149</span>,<span class="number">35902</span>,<span class="number">64669</span>,<span class="number">50273</span>,<span class="number">51014</span>,<span class="number">54000</span>,<span class="number">59856</span>,<span class="number">41923</span>,<span class="number">53353</span>,<span class="number">35259</span>,<span class="number">60315</span>,<span class="number">48177</span>,<span class="number">43783</span>,<span class="number">58570</span>,<span class="number">39743</span>,<span class="number">33108</span>],</span><br><span class="line">[<span class="number">60559</span>,<span class="number">36829</span>,<span class="number">47021</span>,<span class="number">64117</span>,<span class="number">52389</span>,<span class="number">38518</span>,<span class="number">49663</span>,<span class="number">63281</span>,<span class="number">45882</span>,<span class="number">53052</span>,<span class="number">42438</span>,<span class="number">58989</span>,<span class="number">53339</span>,<span class="number">34039</span>,<span class="number">48095</span>,<span class="number">43454</span>,<span class="number">64678</span>,<span class="number">64406</span>,<span class="number">48996</span>,<span class="number">40125</span>,<span class="number">44353</span>,<span class="number">45907</span>,<span class="number">42903</span>,<span class="number">62292</span>,<span class="number">63644</span>,<span class="number">55109</span>,<span class="number">43597</span>,<span class="number">49842</span>,<span class="number">61754</span>,<span class="number">49182</span>,<span class="number">55595</span>,<span class="number">34419</span>],</span><br><span class="line">[<span class="number">43089</span>,<span class="number">62593</span>,<span class="number">42823</span>,<span class="number">39712</span>,<span class="number">41287</span>,<span class="number">63496</span>,<span class="number">48540</span>,<span class="number">37423</span>,<span class="number">33935</span>,<span class="number">65267</span>,<span class="number">40334</span>,<span class="number">41665</span>,<span class="number">42970</span>,<span class="number">38119</span>,<span class="number">36223</span>,<span class="number">45388</span>,<span class="number">41159</span>,<span class="number">38337</span>,<span class="number">48393</span>,<span class="number">60078</span>,<span class="number">57130</span>,<span class="number">48281</span>,<span class="number">32779</span>,<span class="number">33470</span>,<span class="number">63099</span>,<span class="number">38404</span>,<span class="number">58265</span>,<span class="number">40245</span>,<span class="number">59839</span>,<span class="number">56526</span>,<span class="number">63269</span>,<span class="number">65521</span>]]</span><br><span class="line">b = [[<span class="number">199010799</span>],</span><br><span class="line">[<span class="number">211695410</span>],</span><br><span class="line">[<span class="number">210217770</span>],</span><br><span class="line">[<span class="number">187225056</span>],</span><br><span class="line">[<span class="number">190479150</span>],</span><br><span class="line">[<span class="number">194625008</span>],</span><br><span class="line">[<span class="number">185661914</span>],</span><br><span class="line">[<span class="number">211167858</span>],</span><br><span class="line">[<span class="number">206237868</span>],</span><br><span class="line">[<span class="number">212420633</span>],</span><br><span class="line">[<span class="number">201482391</span>],</span><br><span class="line">[<span class="number">194210580</span>],</span><br><span class="line">[<span class="number">213090600</span>],</span><br><span class="line">[<span class="number">195153487</span>],</span><br><span class="line">[<span class="number">184935683</span>],</span><br><span class="line">[<span class="number">200284604</span>],</span><br><span class="line">[<span class="number">201920950</span>],</span><br><span class="line">[<span class="number">207287467</span>],</span><br><span class="line">[<span class="number">212872468</span>],</span><br><span class="line">[<span class="number">198033410</span>],</span><br><span class="line">[<span class="number">205187404</span>],</span><br><span class="line">[<span class="number">192392168</span>],</span><br><span class="line">[<span class="number">196682634</span>],</span><br><span class="line">[<span class="number">221830743</span>],</span><br><span class="line">[<span class="number">207500337</span>],</span><br><span class="line">[<span class="number">208973913</span>],</span><br><span class="line">[<span class="number">206595711</span>],</span><br><span class="line">[<span class="number">203711457</span>],</span><br><span class="line">[<span class="number">185840896</span>],</span><br><span class="line">[<span class="number">199676057</span>],</span><br><span class="line">[<span class="number">212282405</span>],</span><br><span class="line">[<span class="number">197217773</span>]]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#################################################################################### part1 LWE to get q</span></span><br><span class="line"><span class="comment">#primal_attack1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">primal_attack1</span>(<span class="params">A,b,m,n,esz</span>):</span><br><span class="line">    L = block_matrix(</span><br><span class="line">        [</span><br><span class="line">            <span class="comment">#[matrix.identity(m)*p,matrix.zero(m, n+1)],</span></span><br><span class="line">            [(matrix(A).T).stack(-vector(b)).change_ring(ZZ),matrix.identity(n+<span class="number">1</span>)],</span><br><span class="line">        ]</span><br><span class="line">    )</span><br><span class="line">    L = L.LLL()</span><br><span class="line">    e = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">abs</span>,L[<span class="number">0</span>][:m]))</span><br><span class="line">    s = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">abs</span>,L[<span class="number">0</span>][m:-<span class="number">1</span>]))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> (s,e)</span><br><span class="line"></span><br><span class="line">A = Matrix(ZZ,A)</span><br><span class="line">b = Matrix(ZZ,b)</span><br><span class="line">m, n = A.dimensions()</span><br><span class="line">array_q, e = primal_attack1(A,b,m,n,<span class="number">128</span>)</span><br><span class="line">q = <span class="built_in">sum</span>([array_q[i]*<span class="number">256</span>^i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(array_q))])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#################################################################################### part2 get p</span></span><br><span class="line">Q = prime_to_matrix(q,<span class="number">16</span>)</span><br><span class="line">S = Matrix(GF(<span class="number">2</span>), S)</span><br><span class="line">E = Matrix(GF(<span class="number">2</span>), identity_matrix(<span class="number">16</span>))</span><br><span class="line">P = (Q-E).solve_left(S)</span><br><span class="line">p = matrix_to_prime(P, <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#################################################################################### part3 LLL to get key and flag</span></span><br><span class="line">nums = <span class="number">16</span></span><br><span class="line">c = c ^^ nums</span><br><span class="line">n = <span class="number">2</span>^<span class="number">512</span></span><br><span class="line">L = block_matrix(ZZ, [</span><br><span class="line">    [<span class="number">1</span>, (Matrix(ZZ,[<span class="built_in">pow</span>(p,(nums-i),n) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nums)]).T).stack(vector(ZZ,[-c]))],</span><br><span class="line">    [<span class="number">0</span>,n]</span><br><span class="line">])</span><br><span class="line">ans = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, L.LLL()[<span class="number">0</span>]))</span><br><span class="line">ans = ans[:-<span class="number">2</span>] + [-ans[-<span class="number">1</span>]]</span><br><span class="line">ans = ans[::-<span class="number">1</span>]</span><br><span class="line">ans = [ans[-<span class="number">1</span>]//<span class="built_in">abs</span>(ans[-<span class="number">1</span>]) * i <span class="keyword">for</span> i <span class="keyword">in</span> ans]</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ans[:-<span class="number">1</span>])):</span><br><span class="line">    key += long_to_bytes((c - ans[i]) ^^ c)</span><br><span class="line">    c = (c - ans[i]) % n</span><br><span class="line">    c = c * inverse(p,n) % n</span><br><span class="line">key = key[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;CBCTF&#123;&quot;</span>+sha256(key).hexdigest()+<span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#CBCTF&#123;0d3f156b0c831817e366a437fc80c0e2c14a5e36ebd5c27f9ad835dd9d6a3855&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="symmetric-cipher"><a href="#symmetric-cipher" class="headerlink" title="symmetric_cipher"></a>symmetric_cipher</h3><p>题目描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">do you know symmetric_cipher?</span><br></pre></td></tr></table></figure>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line">r_con = (<span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x40</span>,<span class="number">0x80</span>, <span class="number">0x1B</span>, <span class="number">0x36</span>)</span><br><span class="line">s_box = [</span><br><span class="line">    <span class="number">0x63</span>, <span class="number">0x7C</span>, <span class="number">0x77</span>, <span class="number">0x7B</span>, <span class="number">0xF2</span>, <span class="number">0x6B</span>, <span class="number">0x6F</span>, <span class="number">0xC5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2B</span>, <span class="number">0xFE</span>, <span class="number">0xD7</span>, <span class="number">0xAB</span>, <span class="number">0x76</span>,</span><br><span class="line">    <span class="number">0xCA</span>, <span class="number">0x82</span>, <span class="number">0xC9</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xF0</span>, <span class="number">0xAD</span>, <span class="number">0xD4</span>, <span class="number">0xA2</span>, <span class="number">0xAF</span>, <span class="number">0x9C</span>, <span class="number">0xA4</span>, <span class="number">0x72</span>, <span class="number">0xC0</span>,</span><br><span class="line">    <span class="number">0xB7</span>, <span class="number">0xFD</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3F</span>, <span class="number">0xF7</span>, <span class="number">0xCC</span>, <span class="number">0x34</span>, <span class="number">0xA5</span>, <span class="number">0xE5</span>, <span class="number">0xF1</span>, <span class="number">0x71</span>, <span class="number">0xD8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,</span><br><span class="line">    <span class="number">0x04</span>, <span class="number">0xC7</span>, <span class="number">0x23</span>, <span class="number">0xC3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9A</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>, <span class="number">0xEB</span>, <span class="number">0x27</span>, <span class="number">0xB2</span>, <span class="number">0x75</span>,</span><br><span class="line">    <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2C</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x6E</span>, <span class="number">0x5A</span>, <span class="number">0xA0</span>, <span class="number">0x52</span>, <span class="number">0x3B</span>, <span class="number">0xD6</span>, <span class="number">0xB3</span>, <span class="number">0x29</span>, <span class="number">0xE3</span>, <span class="number">0x2F</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x53</span>, <span class="number">0xD1</span>, <span class="number">0x00</span>, <span class="number">0xED</span>, <span class="number">0x20</span>, <span class="number">0xFC</span>, <span class="number">0xB1</span>, <span class="number">0x5B</span>, <span class="number">0x6A</span>, <span class="number">0xCB</span>, <span class="number">0xBE</span>, <span class="number">0x39</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0xCF</span>,</span><br><span class="line">    <span class="number">0xD0</span>, <span class="number">0xEF</span>, <span class="number">0xAA</span>, <span class="number">0xFB</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xF9</span>, <span class="number">0x02</span>, <span class="number">0x7F</span>, <span class="number">0x50</span>, <span class="number">0x3C</span>, <span class="number">0x9F</span>, <span class="number">0xA8</span>,</span><br><span class="line">    <span class="number">0x51</span>, <span class="number">0xA3</span>, <span class="number">0x40</span>, <span class="number">0x8F</span>, <span class="number">0x92</span>, <span class="number">0x9D</span>, <span class="number">0x38</span>, <span class="number">0xF5</span>, <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xDA</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xFF</span>, <span class="number">0xF3</span>, <span class="number">0xD2</span>,</span><br><span class="line">    <span class="number">0xCD</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xC4</span>, <span class="number">0xA7</span>, <span class="number">0x7E</span>, <span class="number">0x3D</span>, <span class="number">0x64</span>, <span class="number">0x5D</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,</span><br><span class="line">    <span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4F</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>, <span class="number">0x2A</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xEE</span>, <span class="number">0xB8</span>, <span class="number">0x14</span>, <span class="number">0xDE</span>, <span class="number">0x5E</span>, <span class="number">0x0B</span>, <span class="number">0xDB</span>,</span><br><span class="line">    <span class="number">0xE0</span>, <span class="number">0x32</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0xC2</span>, <span class="number">0xD3</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>,</span><br><span class="line">    <span class="number">0xE7</span>, <span class="number">0xC8</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>, <span class="number">0x8D</span>, <span class="number">0xD5</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xEA</span>, <span class="number">0x65</span>, <span class="number">0x7A</span>, <span class="number">0xAE</span>, <span class="number">0x08</span>,</span><br><span class="line">    <span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0xA6</span>, <span class="number">0xB4</span>, <span class="number">0xC6</span>, <span class="number">0xE8</span>, <span class="number">0xDD</span>, <span class="number">0x74</span>, <span class="number">0x1F</span>, <span class="number">0x4B</span>, <span class="number">0xBD</span>, <span class="number">0x8B</span>, <span class="number">0x8A</span>,</span><br><span class="line">    <span class="number">0x70</span>, <span class="number">0x3E</span>, <span class="number">0xB5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xB9</span>, <span class="number">0x86</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0x9E</span>,</span><br><span class="line">    <span class="number">0xE1</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xD9</span>, <span class="number">0x8E</span>, <span class="number">0x94</span>, <span class="number">0x9B</span>, <span class="number">0x1E</span>, <span class="number">0x87</span>, <span class="number">0xE9</span>, <span class="number">0xCE</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xDF</span>,</span><br><span class="line">    <span class="number">0x8C</span>, <span class="number">0xA1</span>, <span class="number">0x89</span>, <span class="number">0x0D</span>, <span class="number">0xBF</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2D</span>, <span class="number">0x0F</span>, <span class="number">0xB0</span>, <span class="number">0x54</span>, <span class="number">0xBB</span>, <span class="number">0x16</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">     </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor_bytes</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(i^j <span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">zip</span>(a, b))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_round_key</span>(<span class="params">s, k</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            s[i][j] ^= k[i][j]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_bytes</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            s[i][j] = s_box[s[i][j]]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shift_rows</span>(<span class="params">s</span>):</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>] = s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>], s[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>], s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>] = s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>], s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>]</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>], s[<span class="number">3</span>][<span class="number">3</span>] = s[<span class="number">3</span>][<span class="number">3</span>], s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">xtime = <span class="keyword">lambda</span> a: (((a &lt;&lt; <span class="number">1</span>) ^ <span class="number">0x1B</span>) &amp; <span class="number">0xFF</span>) <span class="keyword">if</span> (a &amp; <span class="number">0x80</span>) <span class="keyword">else</span> (a &lt;&lt; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mix_single_column</span>(<span class="params">a</span>):</span><br><span class="line">    </span><br><span class="line">    t = a[<span class="number">0</span>] ^ a[<span class="number">1</span>] ^ a[<span class="number">2</span>] ^ a[<span class="number">3</span>]</span><br><span class="line">    u = a[<span class="number">0</span>]</span><br><span class="line">    a[<span class="number">0</span>] ^= t ^ xtime(a[<span class="number">0</span>] ^ a[<span class="number">1</span>])</span><br><span class="line">    a[<span class="number">1</span>] ^= t ^ xtime(a[<span class="number">1</span>] ^ a[<span class="number">2</span>])</span><br><span class="line">    a[<span class="number">2</span>] ^= t ^ xtime(a[<span class="number">2</span>] ^ a[<span class="number">3</span>])</span><br><span class="line">    a[<span class="number">3</span>] ^= t ^ xtime(a[<span class="number">3</span>] ^ u)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mix_columns</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        mix_single_column(s[i])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_expand_key</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        word = <span class="built_in">list</span>(s[-<span class="number">1</span>])</span><br><span class="line">        word.append(word.pop(<span class="number">0</span>))</span><br><span class="line">        word = [s_box[b] <span class="keyword">for</span> b <span class="keyword">in</span> word] </span><br><span class="line">        word[<span class="number">0</span>] ^= r_con[i]</span><br><span class="line"></span><br><span class="line">        s.append(xor_bytes(word, s[-<span class="number">4</span>]))</span><br><span class="line">        s.append(xor_bytes(s[-<span class="number">1</span>], s[-<span class="number">4</span>]))</span><br><span class="line">        s.append(xor_bytes(s[-<span class="number">1</span>], s[-<span class="number">4</span>]))</span><br><span class="line">        s.append(xor_bytes(s[-<span class="number">1</span>], s[-<span class="number">4</span>]))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [s[<span class="number">4</span>*i : <span class="number">4</span>*(i+<span class="number">1</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s) // <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bytes2matrix</span>(<span class="params">text</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">list</span>(text[i:i+<span class="number">4</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(text), <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">plain,r,skeys</span>):</span><br><span class="line">    plain = bytes2matrix(plain)</span><br><span class="line">    add_round_key(plain, skeys[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, r+<span class="number">1</span>):</span><br><span class="line">        sub_bytes(plain)</span><br><span class="line">        <span class="keyword">if</span> i %<span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">            shift_rows(plain)</span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span> :</span><br><span class="line">            mix_columns(plain)</span><br><span class="line">         </span><br><span class="line">        add_round_key(plain, skeys[i])</span><br><span class="line">    enc = <span class="built_in">bytes</span>(plain[<span class="number">0</span>]+plain[<span class="number">1</span>]+plain[<span class="number">2</span>]+plain[<span class="number">3</span>])</span><br><span class="line">    <span class="keyword">return</span> enc</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">key = os.urandom(<span class="number">16</span>)</span><br><span class="line">flag = <span class="string">&quot;DASCTF&#123;&quot;</span>+ sha256(key).digest().<span class="built_in">hex</span>()+<span class="string">&quot;&#125;&quot;</span></span><br><span class="line">skeys = _expand_key(bytes2matrix(key))</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">pt = []</span><br><span class="line">ct = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">        p = <span class="string">b&quot;\x00&quot;</span> + <span class="string">b&quot;\xCB&quot;</span>*<span class="number">15</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        p = long_to_bytes(i) + <span class="string">b&quot;\xCB&quot;</span>*<span class="number">15</span></span><br><span class="line">    pt.append(p)</span><br><span class="line">    c = encrypt(p,<span class="number">7</span>,skeys)</span><br><span class="line">    ct.append(c)</span><br><span class="line"></span><br><span class="line">pt_serializable = [<span class="built_in">list</span>(p) <span class="keyword">for</span> p <span class="keyword">in</span> pt] </span><br><span class="line">ct_serializable = [<span class="built_in">list</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> ct]  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">&#x27;pt&#x27;</span>: pt_serializable, <span class="string">&#x27;ct&#x27;</span>: ct_serializable&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;out.json&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    json.dump(data, f)</span><br></pre></td></tr></table></figure>
<p>本题基于AES，其与AES的标准实现主要区别在：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">plain,r,skeys</span>):</span><br><span class="line">    plain = bytes2matrix(plain)</span><br><span class="line">    add_round_key(plain, skeys[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, r+<span class="number">1</span>):</span><br><span class="line">        sub_bytes(plain)</span><br><span class="line">        <span class="keyword">if</span> i %<span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">            shift_rows(plain)</span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span> :</span><br><span class="line">            mix_columns(plain)</span><br><span class="line">         </span><br><span class="line">        add_round_key(plain, skeys[i])</span><br><span class="line">    enc = <span class="built_in">bytes</span>(plain[<span class="number">0</span>]+plain[<span class="number">1</span>]+plain[<span class="number">2</span>]+plain[<span class="number">3</span>])</span><br><span class="line">    <span class="keyword">return</span> enc</span><br></pre></td></tr></table></figure>
<p>对明文的加密只有7轮，并且每一轮中，奇数轮会进行行移位，偶数轮会进行列混合。</p>
<p>而我们能获得的数据为如下明文的加密结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">long_to_bytes(i,<span class="number">1</span>) + <span class="string">b&quot;\xCB&quot;</span>*<span class="number">15</span> (i <span class="keyword">from</span> <span class="number">0</span> to <span class="number">255</span>)</span><br></pre></td></tr></table></figure>
<p>这显然对应着square attack里面的$\Lambda$集，有关square attack的详细解释可以看春乎：</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/589141550">初探AES square attack：以0ctf 2016 - people square为例 - 知乎 (zhihu.com)</a></p>
<p>要注意，虽然题目AES加密是七轮，然而列混淆其实仅有三轮，而影响$\Lambda$集性质的只有列混淆，因此其实对应的是4轮的square attack。</p>
<p>主要思路在于，在三轮列混淆后，同一位置的所有明文具有一个特性——相加起来为0，而最后一轮操作为：</p>
<ul>
<li>字节代换——破坏了这个特性</li>
<li>行移位</li>
<li>轮密钥加</li>
</ul>
<p>也就是说，在进行这三个操作之前，同一位置的所有明文应当相加起来为0，而字节代换破坏了这个性质。然而，我们可以逐字节爆破最后一轮的轮密钥，然后倒过去做字节代换，检查该位置的明文是否具有这个特性，就可以获得第七轮轮密钥的可能值。</p>
<p>之后对所有可能的轮密钥反推主密钥，然后检查加密结果是否等于给定值就可以确定哪个才是正确的主密钥了。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;D:\CTF_challs\py\crypto\2024\DASCTF 2024 0rays\output.json&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    c = json.load(f)</span><br><span class="line"></span><br><span class="line">pt = c[<span class="string">&#x27;pt&#x27;</span>]</span><br><span class="line">ct = c[<span class="string">&#x27;ct&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">################################################################################# part1 gen sbox</span></span><br><span class="line">r_con = (<span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x40</span>,<span class="number">0x80</span>, <span class="number">0x1B</span>, <span class="number">0x36</span>)</span><br><span class="line">s_box = [</span><br><span class="line">    <span class="number">0x63</span>, <span class="number">0x7C</span>, <span class="number">0x77</span>, <span class="number">0x7B</span>, <span class="number">0xF2</span>, <span class="number">0x6B</span>, <span class="number">0x6F</span>, <span class="number">0xC5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2B</span>, <span class="number">0xFE</span>, <span class="number">0xD7</span>, <span class="number">0xAB</span>, <span class="number">0x76</span>,</span><br><span class="line">    <span class="number">0xCA</span>, <span class="number">0x82</span>, <span class="number">0xC9</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xF0</span>, <span class="number">0xAD</span>, <span class="number">0xD4</span>, <span class="number">0xA2</span>, <span class="number">0xAF</span>, <span class="number">0x9C</span>, <span class="number">0xA4</span>, <span class="number">0x72</span>, <span class="number">0xC0</span>,</span><br><span class="line">    <span class="number">0xB7</span>, <span class="number">0xFD</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3F</span>, <span class="number">0xF7</span>, <span class="number">0xCC</span>, <span class="number">0x34</span>, <span class="number">0xA5</span>, <span class="number">0xE5</span>, <span class="number">0xF1</span>, <span class="number">0x71</span>, <span class="number">0xD8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,</span><br><span class="line">    <span class="number">0x04</span>, <span class="number">0xC7</span>, <span class="number">0x23</span>, <span class="number">0xC3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9A</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>, <span class="number">0xEB</span>, <span class="number">0x27</span>, <span class="number">0xB2</span>, <span class="number">0x75</span>,</span><br><span class="line">    <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2C</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x6E</span>, <span class="number">0x5A</span>, <span class="number">0xA0</span>, <span class="number">0x52</span>, <span class="number">0x3B</span>, <span class="number">0xD6</span>, <span class="number">0xB3</span>, <span class="number">0x29</span>, <span class="number">0xE3</span>, <span class="number">0x2F</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x53</span>, <span class="number">0xD1</span>, <span class="number">0x00</span>, <span class="number">0xED</span>, <span class="number">0x20</span>, <span class="number">0xFC</span>, <span class="number">0xB1</span>, <span class="number">0x5B</span>, <span class="number">0x6A</span>, <span class="number">0xCB</span>, <span class="number">0xBE</span>, <span class="number">0x39</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0xCF</span>,</span><br><span class="line">    <span class="number">0xD0</span>, <span class="number">0xEF</span>, <span class="number">0xAA</span>, <span class="number">0xFB</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xF9</span>, <span class="number">0x02</span>, <span class="number">0x7F</span>, <span class="number">0x50</span>, <span class="number">0x3C</span>, <span class="number">0x9F</span>, <span class="number">0xA8</span>,</span><br><span class="line">    <span class="number">0x51</span>, <span class="number">0xA3</span>, <span class="number">0x40</span>, <span class="number">0x8F</span>, <span class="number">0x92</span>, <span class="number">0x9D</span>, <span class="number">0x38</span>, <span class="number">0xF5</span>, <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xDA</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xFF</span>, <span class="number">0xF3</span>, <span class="number">0xD2</span>,</span><br><span class="line">    <span class="number">0xCD</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xC4</span>, <span class="number">0xA7</span>, <span class="number">0x7E</span>, <span class="number">0x3D</span>, <span class="number">0x64</span>, <span class="number">0x5D</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,</span><br><span class="line">    <span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4F</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>, <span class="number">0x2A</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xEE</span>, <span class="number">0xB8</span>, <span class="number">0x14</span>, <span class="number">0xDE</span>, <span class="number">0x5E</span>, <span class="number">0x0B</span>, <span class="number">0xDB</span>,</span><br><span class="line">    <span class="number">0xE0</span>, <span class="number">0x32</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0xC2</span>, <span class="number">0xD3</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>,</span><br><span class="line">    <span class="number">0xE7</span>, <span class="number">0xC8</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>, <span class="number">0x8D</span>, <span class="number">0xD5</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xEA</span>, <span class="number">0x65</span>, <span class="number">0x7A</span>, <span class="number">0xAE</span>, <span class="number">0x08</span>,</span><br><span class="line">    <span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0xA6</span>, <span class="number">0xB4</span>, <span class="number">0xC6</span>, <span class="number">0xE8</span>, <span class="number">0xDD</span>, <span class="number">0x74</span>, <span class="number">0x1F</span>, <span class="number">0x4B</span>, <span class="number">0xBD</span>, <span class="number">0x8B</span>, <span class="number">0x8A</span>,</span><br><span class="line">    <span class="number">0x70</span>, <span class="number">0x3E</span>, <span class="number">0xB5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xB9</span>, <span class="number">0x86</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0x9E</span>,</span><br><span class="line">    <span class="number">0xE1</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xD9</span>, <span class="number">0x8E</span>, <span class="number">0x94</span>, <span class="number">0x9B</span>, <span class="number">0x1E</span>, <span class="number">0x87</span>, <span class="number">0xE9</span>, <span class="number">0xCE</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xDF</span>,</span><br><span class="line">    <span class="number">0x8C</span>, <span class="number">0xA1</span>, <span class="number">0x89</span>, <span class="number">0x0D</span>, <span class="number">0xBF</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2D</span>, <span class="number">0x0F</span>, <span class="number">0xB0</span>, <span class="number">0x54</span>, <span class="number">0xBB</span>, <span class="number">0x16</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">     </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor_bytes</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(i^j <span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">zip</span>(a, b))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_round_key</span>(<span class="params">s, k</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            s[i][j] ^= k[i][j]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_bytes</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            s[i][j] = s_box[s[i][j]]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shift_rows</span>(<span class="params">s</span>):</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>] = s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>], s[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>], s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>] = s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>], s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>]</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>], s[<span class="number">3</span>][<span class="number">3</span>] = s[<span class="number">3</span>][<span class="number">3</span>], s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">xtime = <span class="keyword">lambda</span> a: (((a &lt;&lt; <span class="number">1</span>) ^ <span class="number">0x1B</span>) &amp; <span class="number">0xFF</span>) <span class="keyword">if</span> (a &amp; <span class="number">0x80</span>) <span class="keyword">else</span> (a &lt;&lt; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mix_single_column</span>(<span class="params">a</span>):</span><br><span class="line">    </span><br><span class="line">    t = a[<span class="number">0</span>] ^ a[<span class="number">1</span>] ^ a[<span class="number">2</span>] ^ a[<span class="number">3</span>]</span><br><span class="line">    u = a[<span class="number">0</span>]</span><br><span class="line">    a[<span class="number">0</span>] ^= t ^ xtime(a[<span class="number">0</span>] ^ a[<span class="number">1</span>])</span><br><span class="line">    a[<span class="number">1</span>] ^= t ^ xtime(a[<span class="number">1</span>] ^ a[<span class="number">2</span>])</span><br><span class="line">    a[<span class="number">2</span>] ^= t ^ xtime(a[<span class="number">2</span>] ^ a[<span class="number">3</span>])</span><br><span class="line">    a[<span class="number">3</span>] ^= t ^ xtime(a[<span class="number">3</span>] ^ u)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mix_columns</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        mix_single_column(s[i])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_expand_key</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        word = <span class="built_in">list</span>(s[-<span class="number">1</span>])</span><br><span class="line">        word.append(word.pop(<span class="number">0</span>))</span><br><span class="line">        word = [s_box[b] <span class="keyword">for</span> b <span class="keyword">in</span> word] </span><br><span class="line">        word[<span class="number">0</span>] ^= r_con[i]</span><br><span class="line"></span><br><span class="line">        s.append(xor_bytes(word, s[-<span class="number">4</span>]))</span><br><span class="line">        s.append(xor_bytes(s[-<span class="number">1</span>], s[-<span class="number">4</span>]))</span><br><span class="line">        s.append(xor_bytes(s[-<span class="number">1</span>], s[-<span class="number">4</span>]))</span><br><span class="line">        s.append(xor_bytes(s[-<span class="number">1</span>], s[-<span class="number">4</span>]))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [s[<span class="number">4</span>*i : <span class="number">4</span>*(i+<span class="number">1</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s) // <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bytes2matrix</span>(<span class="params">text</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">list</span>(text[i:i+<span class="number">4</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(text), <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">plain,r,skeys</span>):</span><br><span class="line">    plain = bytes2matrix(plain)</span><br><span class="line">    add_round_key(plain, skeys[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, r+<span class="number">1</span>):</span><br><span class="line">        sub_bytes(plain)</span><br><span class="line">        <span class="keyword">if</span> i %<span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">            shift_rows(plain)</span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span> :</span><br><span class="line">            mix_columns(plain)</span><br><span class="line">         </span><br><span class="line">        add_round_key(plain, skeys[i])</span><br><span class="line">    enc = <span class="built_in">bytes</span>(plain[<span class="number">0</span>]+plain[<span class="number">1</span>]+plain[<span class="number">2</span>]+plain[<span class="number">3</span>])</span><br><span class="line">    <span class="keyword">return</span> enc</span><br><span class="line"></span><br><span class="line">invS = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    invS[s_box[i]] = i</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">################################################################################# part2 get possible Round key</span></span><br><span class="line">Roundkey = [[] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    <span class="keyword">for</span> ki <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        temp = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> ind <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            temp ^= invS[ct[ind][i] ^ ki]</span><br><span class="line">        <span class="keyword">if</span>(temp == <span class="number">0</span>):</span><br><span class="line">            Roundkey[i].append(ki)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">################################################################################# part3 brute key</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">k, ind</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ind)[::-<span class="number">1</span>]:</span><br><span class="line">        tmp = [</span><br><span class="line">            xor_bytes(k[-<span class="number">3</span>], k[-<span class="number">4</span>]),</span><br><span class="line">            xor_bytes(k[-<span class="number">2</span>], k[-<span class="number">3</span>]),</span><br><span class="line">            xor_bytes(k[-<span class="number">1</span>], k[-<span class="number">2</span>]),</span><br><span class="line">        ]</span><br><span class="line">        word = <span class="built_in">list</span>(tmp[-<span class="number">1</span>])</span><br><span class="line">        word.append(word.pop(<span class="number">0</span>))</span><br><span class="line">        word = [s_box[b] <span class="keyword">for</span> b <span class="keyword">in</span> word] </span><br><span class="line">        word[<span class="number">0</span>] ^= r_con[i]</span><br><span class="line">        tmp = [xor_bytes(k[-<span class="number">4</span>], word)] + tmp</span><br><span class="line">        k = tmp</span><br><span class="line">    <span class="keyword">return</span> <span class="string">b&#x27;&#x27;</span>.join(k)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> possible_key <span class="keyword">in</span> product(*Roundkey):</span><br><span class="line">    key = func([<span class="built_in">bytes</span>(possible_key[i:i+<span class="number">4</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">16</span>, <span class="number">4</span>)], <span class="number">7</span>)</span><br><span class="line">    skeys = _expand_key(bytes2matrix(key))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">8</span>):</span><br><span class="line">        pti = pt[i]</span><br><span class="line">        cti = ct[i]</span><br><span class="line">        <span class="keyword">if</span> encrypt(pti, <span class="number">7</span>, skeys) != <span class="built_in">bytes</span>(cti):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;DASCTF&#123;&quot;</span>+ sha256(key).digest().<span class="built_in">hex</span>()+<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#DASCTF&#123;e52c1ddd360fd584b5f3da33f9813d6f9d29d330113d8f6c78aa6cf904081369&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>糖醋小鸡块
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://tangcuxiaojikuai.xyz/post/b1a746d0.html" title="2024-DASCTF十月挑战赛-wp-crypto">https://tangcuxiaojikuai.xyz/post/b1a746d0.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sacreative/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SACREATIVE</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/post/fbcce62e.html" rel="prev" title="2024-ASISCTF-Quals-wp-crypto">
      <i class="fa fa-chevron-left"></i> 2024-ASISCTF-Quals-wp-crypto
    </a></div>
      <div class="post-nav-item">
    <a href="/post/d783fbc0.html" rel="next" title="2024-强网拟态-wp-crypto">
      2024-强网拟态-wp-crypto <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#ez-RSA"><span class="nav-number">1.</span> <span class="nav-text">ez_RSA</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#part1"><span class="nav-number">1.1.</span> <span class="nav-text">part1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#part2"><span class="nav-number">1.2.</span> <span class="nav-text">part2</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#part3"><span class="nav-number">1.3.</span> <span class="nav-text">part3</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exp"><span class="nav-number">1.4.</span> <span class="nav-text">exp</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easy-xor"><span class="nav-number">2.</span> <span class="nav-text">easy_xor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#symmetric-cipher"><span class="nav-number">3.</span> <span class="nav-text">symmetric_cipher</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="糖醋小鸡块"
      src="/images/image.png">
  <p class="site-author-name" itemprop="name">糖醋小鸡块</p>
  <div class="site-description" itemprop="description">"追风赶月莫停留，平芜尽处是春山"</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">98</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="/1142381085@qq.com" title="E-Mail → 1142381085@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/6394335993" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;6394335993" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">糖醋小鸡块</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>
  <script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'UPEMA7DyYbIIEyOW72ohgytU-gzGzoHsz',
      appKey     : 'M7rXAfeP3JOslroay2n0Jv2R',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
<!-- 引入jQuery -->
<script type="text/javascript" src="//libs.baidu.com/jquery/1.8.3/jquery.min.js"></script>
<!-- 雪花特效2 -->
<script type="text/javascript" src="/js/snow2.js"></script>
