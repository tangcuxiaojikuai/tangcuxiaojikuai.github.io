<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>2023-0xGame_week1-wp-crypto</title>
    <url>/post/6a80d23a.html</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="9ac3c1d515ae487d5cc0fae1c2e812878206cbfe5071a214601c920df3daa167">ec2ed2ef45af1bf0b778879cd9a74cc2449632e6aa2eeffa6a56de8f9e24bb5776a272f8dd6861d7c4cc64a0c9b8822f9f29908bff1ea91a18ab3bae46825051aff1c817641eab468ccc86d1e6d52a5b45cad1dfe35df478af40095815f19688887ebbc8d1bded211605e10ac7dca584c6693d9a92c4a406c5be9c704f2fc4a18f3444c53f68df26a28ceea4ba90cbabc51eb0cee6f5735d30f2290224808baacda483a4464e9eb07712988a2c8febc7aa32fb31277120f845b9f244fffdd9206eae56f24a2e9c6b802b40c2d5f2cbb363571f304073b67e132ee7ea5849c0c84dfbdcd9bfc2d5ddd7a69e3aab5fa4ff68b5413fb51b679b7d72dcac5f0c745332e7e545b692b63b34a9a949cbe563628e9b783389142cbee7775d261bd4e44f80bc8a08fbbe5b1849e4f578528dee238b855fb2019742007c1cf27117e4bfd82a91d8698f258ecf3ac2b54fc8e0766694ca00c38a33079ddcee8799af96ce56e6c8e4c1e2128631f4409ba44d4c13043a1b8c51531cce1ec8f0c43ea344416446935d3a7ce2b28e20764238e38d04f53aea99b995796d9e6310486a52c68716cf79eb1484ec31b38bb8e87aaad408bd7b0fd3743401c710368bd32f94605cad9f128fdcede7c6f2209bd8408d704128e213c7ca661b6406bf3ab75efd9df14becc7af68c163724f9ef37444f51b5eddf7dbf1f6a5a26f1bba77cd8e1dbe0a595dce7f186698154140dd722b4c820b419c16f315ff169fe69a6b46e51711f2d3b5d21dbefab57169cf51954f6332fad27815b4b8df5305f7e3db41c6a8b557b18a26a061593f84fd744af64a791ba19fddf1b45add817e7e1eb06ba3d27e44c9492eb8e6e76d525c7dd1038a067874cd5aae4472aa760ccb72db346f18d5555287a0f7d7679b0a9ff0386a8370a44d10c28594d3867015dc2579d5322734a8438f9a07ef3f8981601858f7447b9e7a18ff91d019e126a28924275cc7366900d7a39c4f8a593282554ab81cc69f63243988a08d9ae1b4ec7254bc91ed33c5d9eeea47251c8670c5bfcce18501268c284430c1f4f40b5373aa279e34b9bfdda3cb8e027c7a8f3df87b1bfa6062d76b03b31c1116943be38db666481f0e85b2613aa7a9108f3e3afc5b37587fce6cee10d1585f4ef1df59808b23dacfee0172b974e45b04db7e6e204146900449baafeb977e2c6c2cfb3784bfe298114dfff3a5471548acc058f49965fdeee64e44beb86480b4fae53163a310009bd68bab5a6913027169a9e57a04d359f5fcc22433461791067b613f2f691e4f1f954fc4083d46bcd5ccce10eb67e036e631f91e8b8f4f7df5aca8405384ffb0a274f03498e9b8b014c3121fbb694375d30f96c100c84a3c54247def7a979beeb9a5563274c0389f3c988cb5046c646764a754dceabcd66c8a1874226bc421259df7009c0c396d9def3fe93af7558d6b4089e9f268327ddbb37dafa27dc980219f62ed847fdceb318d1ebea15a17737fcc90974fda0731ed98d70f95e40b2b9200876580d00ee7b104156b31e2a77d962a7bf8fe524689bc3bb82c7bc53735d41ff28d948399eee3152e4f04b00509d8c27da240646e7567b7e8e10d6140bc343a7bd186acdbae4d1e039e3bac61130464e73de3f297214b876034a70ada92866f68575b12c34d600c1d25a442713f30292534c9eec9c3cd0b554f7cd93d18b74b1363a1619f80ae6a2e40e8ca3a79e145435419da55f27bec6fbcb6ae6d27fb340d72199c3b4574cbab8136372b366d5264a5f78900163b975fcab61dc5aff7ce19da83c75eb88c4005d8796fcd52cdd8da844e5d8af3f632e784428bc0cb3b3be0d1753d414e4c25374b4e393a07a0eb456b6438835093cb04de0474982cdcf4934dfb491680554acaec46c45d6e86654d247f5e3511c8adaaf95e24aedb6f4654bae7e39abba742330c8386f432ce247aeaf320cc7cef5a72ea0a76aab2acd60cb4ca42d5585bb846d23bc1326a5388575b940a11392efb825be5d65e81ce40031a215dd128527374c9ccf888f26973d0a1cf38b88fdd016711d056859f4231df919f1911a8d00bb859d1cf3e42128fa4957d992d983ff442fa49c3224e2893c944bd1bb222f6f3465a9e24526086c05daf3010820347df1174a68829ec06b55331bad708a27b51913d14d660e2de7874298b264e318fb20066fb7af7e9fbf6ab63575478b98986c53ca4888af3deb7fe17d87e7ef29502ecbfda043fbc0009454aec4b9164509c1309a30c04e6d14e441c936bc1f2a81d298d5e33f89731aae9bb1f10f47922a9bb16092757ccf6a148cb33857f8b5f891a7d2f9c8c9e597f046a2ad275c00bfccfd5acf6a9ee8bcfafa8db17d7fc1eb5fd035db18dfb8673f266e1b69f50e4da96a3a396b35a73ea60933bc772febb07be7538a75707a68574c2a28af1b7ef56ce4ad0d3074b11755d8c9970c3a87488517aad44166b7e1e9261d81c47b7e88126f89cb8aa180f2575132e8692120e4bf341169390dea99146ff01acd206fcc895d2640fe4115a0f34c78322ebd58fdb25f76e5fb2e6003f18744ebfd384d7f711e80638c933151ebd6f6a2faa4fe63eb0772817d5fbdc91f2c40a23099188da69d16bd07e1b3d2609c345550426b6b0db73a06ca3cc38960dafd883a881e6b0879f7a4a5111f30c6115dc10ca6866bedfe0260d04829e9924c3e5e4cc304f591858c9f903b39c571a08f382b0ad3495dcc6f190ab79b62977deadaa6401858ec4b5a5fa07c691bc86dbb57a5701af7f9d04b119b96954cb3b81d8dbef583269f02d75779e58da33a958bad1dc4a92cd8508770521bfe3a07038bd86a8e4120ce0589d0b8222776bbb9227a062fa4d8bbf5bae5a9fde20f4ca513b3c41d4af456411db1fb7bcf0b705168d7cfdaf4c7a7ca2b4faf7b7c7569eb91ae18a50cb5c7c5a20ecc797bd041f807da4d4a1b4fb405797f74b5aedbfe3ab73091a8f55c96e0930de224a43832b3defcb03e573b6a611334e0e19a314dd7b9502d2ba3554440243049eae14d6519f1f3f701dc48cf37b121350692c63efaf4edf2ce8490e0be8fa582fac922fc945e364c4ed7f814a9bc129f9acce8af400a42d12563b702b6ee6889888de3a4b8b925152922ef40345ca4a19d1dd1e7ee6a73e9bd12166a7facf2fe03632365381fad8dc23af443ad14a651e789d66b80f8af27c09e710d8b941b3d1257084d1cecd7a183a9938333ba2c46fac7718a0c051e3c8aad9641d0e19c43a5dbf33e6229e5d3391cf0351567df66a174eccb3c12d5da388280a11bbb20ea78cba5c6f733d7f295153320b7919b802156a11d44cbfb824aecee46f9a746872746e0b0f6af44b4863b51bd89ef421b372eb288632e727cb16a6668d14f00bf3bacdd5d7c319ce377777390310a296182c0ad6f41b8e74b1fd6f3db91e41b2863578ad270e3279f4f956fe74f38da2bfd00255ee79fec9c8771216e9e3b94bf5921ae6f3fb03c94ea0d9e22fc8b6c6a3e7902263be9eb29f7e698c2f7d272de5d9d46eeebf7b719585114975a23f8ec3448f88c9af8a4ab4bb02f1ecd81702916c989598b614db69f8105559891533957a08e80c41c942032622203744f5bfea924684df3c8d9ab20246cb05441243cbe631b80c165b085cc548ef1e7fcbe8f65069ca60b8cb41d5f2dfa8c44ca561eef65235d159e6d94ed16477682c0cfaf87053a887b37c9134d2021a3c45da83b207e22eb93382ddcb8320f689cbf5a21951a87cbe5ad88062ad666edbb8d98c59035da027daf05d4fef2d957f0fc483870bf77935149bbea7d90349e373d9d0e152e81fba025c8d3a34940a78d02a2a732b3299d6cb48af579dec0096189bff492d6601b5cfa09272a3ff96925609ca9f07c85a00b4749ff533d65f416fef527b0f93750cd07a5fcc6c1d2fa05376d03030828df0d61256e8c7810547fcd04e57fc63a729eb8a30a651216718fb588a48a481698124da832a4ea47f0f8ba7714aae8d50cefc6da39077d05244a69d39b040b38723b7401c4386bca466bd364152aa52ba0e94ebcdc1013cb53e986699c7db26382a68c7b7fd2e2f32c60ca061913b88391329ab4e76f3cb318180c299cafcfdee4b0f63d508e7dbd5eda508f8b58f877d309c11081b60e047cb3621c1fb6f98c766c3f0cd2efa9a909acdd9b2422a15a0edbd80bb592e6a137fa337a71e2b1577ff828224c848c641ca3e2086d71a27f7feb49147ce7ca6bfbfec9c883750baaecf8ca715431a2005a1a12b3d924a56774ea322897cfbb09ad326626458103a17baa249bbdadc17a8a3f90187cd787a3b84056feae732de4b1e458b45ca2420f9a98f0823677227964639b3556339beed904c563732787fffe0a9ab99f66c839fda29f29c2416f9b39d7fad47c96a0bbfbcc7fdd0704781397bb339bc3f16eb12292193c5a549a6f1b78f7f81bc330a6c837e28e84c484a627fe72a8b78967cb74d6051c51ad72f19458b8f56e98a3a1371a560105769a2bbec47dc83f6c1bcaaeaf1ee1328471b3a19989f293d9385c7eb97112349772d30df78161f88fef3979b172606ee291bab59d2e0a3c4063777ca2b574d7ea4f5b7f9511bda49e50071b9403aeda24301941ca9063ea95998065cce6a00ee4027f63c8e96a4a03661ba0ba052dc5688aa32ac6acfbe0df93c130cd73e496f20d0537a9d7bef889a9a3e6a9011d220b3130e7d186dd7b4925f400c68b300da3f1594d6f5ed9789a8dcc4d50c671a5199770552febe0f6a0f76c7767ff6db2a6a378e705651d1c3fbc86be5cf8f3e300c735bfad66ca588305c710cee989b137c0302d6add1e7a908c0d055f24b77eca51f96ff77d913d41518de421122f735d4de09891fd8d1b98436594e40923db0a272122bceb00bef6539d339dab364921a2e3a4c21e399d1577414d4f7c334c9383c4e3ef44cdab0350ff65187ddfa822c53f5f8eacb9a689b3ffc2087eca01e65fb5460a89001449942fd64c87dcaf093186b83cf7b8515a17d2ee50ec29623255b17ea90087fb2d21a0fae6d3c1ee16197abdd836cb2ec7c52954ecf4b7e099ea0ce1530d6f43c2181377feb1029db90b48c570ff898a1edc32062bc1b0473716dc51af55eca2e762096edb3715388bbb307a5e9e38fd96e2802dbc757922e5608440a49931105be1942ce9bcd55dc41fedc73d5c55742441debbf3e499315025795c3a8abee6f3b9290b4fa381c8d82aa6695c8fcb081abfbe7e87c5d604f9bb6594c75b5939cacbbe3193a686a0fe68f0739bbd26c2ff89ae34c481fbed2876a7a6a558a1a7b6c10639d7fd266fa42efe1baf5c4bf2971788439e8818dd3c14345b44fa60d4cb3a6228ddc81a039e64717ac52a065f3c1c23a69a730e9f1e505bbe309e6dd7200f7d4c1ba6d83fec829d1c5c5d4a93071eb8b0938deaa3805e28bc75c326e8b5823d5996649c0a071869567b758fb00eb31111115d98e5bf1aa9d10aa14a1c84f9154e6ac551062390f2ed6e37b63b042f2647247a10df4bc24e342dce466cc7b489518afdece282ab881249acfab60ec0351d9297b92b2ec373c192dbac5d5c05d85192bd9a099f96b5dc424a6c15d7ab22debb54785ac1cd9e27979fa370fb9607f99323384274ebf68016b2bc7981ae20974ad85436af88a053bce37e8e62a511dba9f1ca9b20e71e0cf4bb8335412fe962172e9b9ceaa845bac8ea3b6f4eb90fa22373f1cbba1e87b2524c2ec4fcbea55e55e277a6398ba4ece36fc1e26e1ae47838644526debc9bcab9398bd65ceb4abab8b986ebb447dbb5eab10d126aacf5e3da2469e4ce4886575d558b75aa6b3125791acfd467498b844d9d3b7a789dda0aaaf05aa82085db4d82550ffaa597f1aa542f6d8c43c63e0016e3e313c76748ad890a8f325759b5d5abfde6cc9a492ee4b2c2f3c3440e3f4b0d6b91f5c2cea3a01292c2fbd2b06c0d42a49f999c2901bdb4a184b31124b65692fdf0aa24524f48e4c4f6bbff8a5c94e9b58eeb53114aaac0870fa66b7811cec7b8ceb308a540cdae503b43a7b261766cd3a88ef6a4c3ca5fd907ac4697cf62c58d7c022b4a3cc789eaaf168cf4e52d94079a6082a082d46cb12fc13df55e29200990ae8ce5470f8ed901e2499bdf26c19c39bc0274c3938ba9d43faf20a9cc8b8d053952fde1eed1804730d67970d66e75605843ed29d1abb22ce65492df11211d8aaf706b00a819ae3baa0ce06af93931075a8e07d2b8ea81ed2365ceac992a9dc69307f4d991bb9215bf594c915c835d6292b6628541934c89b9b83c6f9323bdf1e780a027964caad9533605fb8cadd146f3e013c10f55426bdd9437bd85ed90fedc6b1ed75aa695168068d139a9546e820705edaffafc722850dfb7b2051fef55901b46b04432cd30637d93b55f3e7168a917ef7a1ff8349251e05cefac79203de521033b6311fe36fead92be226c4f3cefbeb753f6783809718855103c5049eccdf499ebadfb68d546e1b459e16d84a12540df7e2a4e1039b717156ee24507cf68f017b4ea30eae2f7e153123dc1499a0ab8debcccf57552a3d2d074a04743285e989d7a0fb6319cba718113bfae3318d4666c212c48b397a48c1a40758c33e49d72c0fb27ea12554d7bfdf2ad570afc3cf3a87f39126f251008f6ba465d14b6a02a63136c8ffb21a5b682f06b8ada840e7428b1046ce4d31811afbd4adf1c68445f6297bd055c0e40b97699ca10d35ada5d0df6affae3387726cb0fa91fdfedfda6d0eafd3b99f92fefe16f7c82cf210b5e634b035b0998749fef8ac4c3fcce33827516865cc07d989d8a7262683a74b9faabadbde6fc6dd04b32320ab2d40d069d85937baedb60d0b6ee9c01d6eec10ff9261d9a003341a3d1411085453c22168c886407a01e90ab88bb220cdb5356b0b1ac4007b408fd8cb41db10bdf6af03525f508133e3bab0b8635e722e2a7f0a3448cf2299ab3eb9b24edb0345ee2fe384db70190ba6ef0ddad26a78cc8bd0c70272a6327aeda732993495cca154f587a0f367d23ffbf547636f0c3fcc96d6e8a3492b6b70fe6add558ff4c3ecbb6d305cb70b03ea2d0d8b2c0d27a0aa2a8cc04ae58ef3b932ae7cb7ff2e321f59d7195a23205bce321f282bad8ecf644bfb62501b156983604b4c7d2a59bd078b1dea73508942af209593074747c3c5c4a0e42bb445c41d499a010426fbed39d61e22e6b6e9cb0420681a8e03f775c19c1908cc9a9135c35ca458eb222b7bbcdf96ffffbf9df8a7e349579ae91d372b19496485facc99beb69195f213e1aa60f84a9c752fde9f6ad8de99d98c4483b6f289739dd5a27b4463163cb40c830aab8b539ff09cda4970d7590ed7e223c5f177cfcc69433c48d305f5cdafce690c41c0de713c6a143653c136167d255edffc70d02641c2f07e9ec1914679f1031efe9beb2c52ab5a372920231acba995df73a580f0a4831796bf33818a93f1c4f29c2f217d9cc38308d845f240b86cf36a8d5d09cfc05fca8765618d7dda98f571353130dda2b0550776b902f56a87675d32b17d676c6ebf85d050f9121ec018a6c89ff48a9715e3872fe1992188a635465463c5c1a18add5f86a6ab080bd81fe425d801139c8f3f022553a7974e910fb4aa61e2e169247443f01bd81557301b881482113bd56382939dfc60fc8558ce6081d3afac8143f4beb501d575ac4f8a41c961023509678b140de7b020fbb8a97e398f0dbfeb8ac03cdaf422e3a05cebca4c0aefeaa586e4b6887a33e0be87122d3708cbcd2a6f1c695070ebba799c505a0d78716db15cf3d4f9bc8c6cd7c7878362dbc38054c216f73d60b6f2c22cc89a6bc6d466c0a00431f07c5d6e779b029b358e09f4ee300d0f14b61541ec3c40a1e949c35878500f176813ed319140b0e6996feb6d345bd473b81c19e3396f056b11024510598afefd05837d6ccfe41c82cd6808264698e80ada6fc74e53e4b5bf3cc1f3b5f73f8db3abab2f1db86608c417600b1bd9b052d806c02a1166046382dc0443f76db90b63e96fa8a6f43f4649aa1063e65b0afa9830fe1cc41b5dcffc27cd26060814fbc690970b814fc4de98d6ea5c3b1330af42c63d76e81cb80e6df5b44d1898036ad7a99abb54930211f9aa82a2d1c96294f60e9fd86816718178e0bd0eed27dff9dca3337cc956a13515f222bef1f8b0509477301ca1620a559f4fdc301cb1e9cb6dcfa91c56dc81f31771a6a29964df524522403bad44134195e1d3c7339dac58e0422cb369e75f3961d78e91f9ebd1b76c6863b6fcf26d3e7957cec253f097591f6a1efa8c36b9026e03eaeb55ca5a4b3b15a9cab39aa2f43b78b8841a4a638fe26bc4c944347f824658e56fb52d7e3c3825ef6e839014e0ea2b9e90dc950ed9114456c8c29402063b389d71b2f7b96cae9bb845ea7ebb41140603d1530f9fd6225ae6a1c24c9b66eed2e1fe9a313c2f94f82a1730e36cd2a15358ff2dd06ea5f3d3b8583491a7d57d63cc464e5b8c6e799f31e7501873844d280e961b8f9d20e1af33b504f1220ac3bf02c26e6b24b179186944c7598525fa103f75f950d4e722312d0e75b5c7bdbd750110c1f493456bc396da20889b3ddc6c242cf5f65b32bb1a9a95e81671bb841fbc8ed813477be807fda30f57e690f04947a17f22c2738b65e1041b7dc8be25e182f5a7ef5aab8df84889d92ed72343ffdbfa5ea51c414cf1df915704f8cb2744456d0a197f8f6a2e529d8e1731136cd081b99f04e9a2f92365d50c3d6505c2760da6055635c626fd8e185e7c4c65fdc881ab348dfef4fc4032a0bd7617dd4319542c6b92f38b27783065ffea9cab2072c40ed0886bfaf671eb63fef03be32c80204ca9745579a59915a8d4373f46caef8a12d373fddf2e8ad3c7eaa788ba247d87f39fab09f93145962286811daf3e24a3f0cee35bdeb066d042918c0d27bfb28ed60214c17934db5a2fc6051587dad7c8ec7a6b48912ff84913bf7aee3ccdba1e7d38dced0428b0aad660e409c2c5d90f200c4013a37f0cb06cb74689c1de6d2015597af1642afe03dd53b9005b59fcc6cdd3bb94ee3809d984ad1baad08f236eb78e58670ec0333836662dbd22902bdfe6db0c33c4c4e77926b28427639d2f6492885feaf058763bb6ed88db0bdbfa91acb52873d6e1ff29f14a77cdd37642db7cac22f4cc81b86ce5b9f0404c17d0860abad8b2ca2d0042bf7738e5570b7a07e7ada11133758104d7bdbce278f9b12678fb404020d7c06bf137f05f075c17f43f5a6d04e38a66915c45e3a307dd4f21f730bc934f274039ca496502b23a54727ed5887dbf546e2b5e4ff435f4fb6266d239e1ee0378832a4be500b33ebe252a0b85df650df56d4256bbe73c628eb49b37ab8d21d1be0d6cc27e902fc1d850d830b8e896a7c26368f23fc9b69ed6fce99ea9d2f3fe6ecebc56ce36b2a2d255ecd8b376916eb0eab2533de21436409c7827a6df59ed32987647cd99dffcd86e5950350ec4f7e6f8c4f01880d2e065389c8de013e74fbf534d9cbf5fe539eca24f1a3f5841b0076450c2f9316ce0ea8529f917974c2057c99211597fc0aecb4008e01c4d4b1fbda0a4900986d4da6001d7841f073982ed3cafbd52c91121a2fcfb405a9f550cd3efc14965dace3569b8fd9e3395d859d58cff81635d6ccd24492df4e947641591c6f0b96dfd1d2adc5281c9990f5ef6911896abe52ff9769be6f2abbb8ca2096986204a17fb27d3115bbb5223cbd60a43f421f4e7219ad32e7f444c2b3fab3863d5eb24f96d6614c4dfe956cf92a2509a096152ea137fc678dfa5a772d6e0a6f70128fbce660caa28ce68cf273274d8324e50f0af367f8367892af21e14ec58f5d751872d66cf9f177079717456e70cf0ee31a3ee06bdc9fd77c6969a726295fe72b430a56a04bd37d51784c10f75b72779ff40538deeaf607fbde14c913b3266964c68a5b4c4ad2d593acceb579ceb7fdc671f78b38c039095acbc962df9214ac38dce34e8e6f00b27ecf5bc6572df9a4d287fb9629afdcc5eb5a13607e56ff3bae63b43d222c626bcf20914d0fab40fe4c7c299fb20bfba7df2ec3eeded41898e5c933894f0ff7143ee595c7e7a06982b6b8600414c8ce35273d5189abba9f9234de086cf6c4fd1e881d86947cf7022aee6ffac60bf8b88bf05db643a0e03954212427160d3c2e2763cc227c9637a0d6d327256f845b8a6e9013d18b9422a6f39f1af48f5cd23adb37a44a4dce376c646b596c2f89ce5b056c789c5a4acd5c10fe597ba87c17c9dba25b3efbf2701d4524b3552de7920d9521ebac6b456530e93bcee97c5d0a220506cc2a57f1f66a302b9a89be2d7e34b1f2f0eaad9e390c0d1ce8b6c20bf86eacea16f7459cf123192ed20ef62fd691940ec9542ca81d8a5011198f4bd49e4c1413ffbf16df28b3a1ac00caa7a7a56a213b35dd19a8f18b32d0202ccc17f8c3178ebf3e917206d9c2cbfb6a94f94570877facdd0acd1f3c666cb07ed8637658fcce5400e275b22afb052cde610a40d8d2fb32c39313a1db64ee9264e4a89b48b37ae1681290a9f3a0c94c0d0dbfa0062707a783d1576dad0085f9a2dc44a0586c426011ff54ffe53cb19551de59bae58ebdebbd77fc53f3725aafe8b59d57f2d84f71318b4d6f677adcdd8af1eef864bc1d25ecef0d4355d7670e18cc8f2ec1a9430ae021bf202bc5944437aa21993c041868fa1f38695be19d4683adffc9c2ffb020583a9de95e4a4448c9ff07ef0402bc44f5c1c3a61d1a902bd3131c89dc5677a8618fb2fe3a9189efc62739e9bf65d3dc8733b55277780498aa526e00693de79968e2a2998b1660bbecca511c113c4fd58e8383f03309095d5192ce1841f2c440e2aa733e236ecbae9be1ef260af4483a02a0d59ddb3707fbeac289b6f3babf273c6d9fc696656ada7c3ceb3f6df9ace2e775ecb43a8111564eecbf340de8af9e510415555197249b280048fc404657685e3c61ffc976fab3da57323d7156fdb920128fcdf0214b6283984d64b2a7445d83963843e235aec8cdd26fb2ace9efc9b33764ae8acaa3e68ba9dd48ad39d939067bbaa801315926dbae3d6065c1d2e12812cdd0e9a3676d654cc618fcc53b0db611007e2c91c0ed3e5fb518cc5bd80cde2032a78d06933554b47f6eab2d96f96c09d1fd778ce24fe9b74f1fba8a99be7324c190c241b80e5c7a9818167683b15250bd241ecfc46e03f6c5f7479900fe8723e57e210bdb976bb66cce67f5835e906c999252fbd8282dedeee61d6ca53283263034da29b3b5e9c34b2bbcd5820219b2f6fb3f2f40d00f09bb765804bd8bc708759411a56b01f3033c21a530e20b7d93ba9b41cb9cd5aeb7316ea00161e7c1ef7e6553dfa6acf34323dfd0620cf575810433d291552e0b1cef0d52a8e6c4b072628fcc741373753477ae1177847a72b211b1d5c83931b6d2685d7cef352c8036ceb635ede59552e6164dc09c6fecc6935856e433cc664aeb23cecdf62783a4bb015a17ddae764b35ee74604c2e9542ba6e2413d06bf778dc85655548de6c80daf237a3a9e29207f721ff641b2c03611c282cc67ec7531d0064b0163e7525ea6d74ac254d0666eb5a2e3e6ca62849c4626f28325ce60c17f9aaf404716f93c63984208884569ecd47c7f79c67c23b68e9a771ce4940677883645a409b6821eda05e3d678085aa3e5e3c78ff74dcb4be9da17b6d86a5cece34a9c368c6753dacb444d596bf19a4894de10040b9e837fd95f996e81984fd5b6a732807b4cc067ec48fba459bf49842347b11e6b5204854d22297642e10426dc1ef4614b5e4285b3e09b2c38c24d82fec98aadec432c06f8df7e33cb9a17933f9a54c54556bdcb646d9d25addaf0ea89bf85175e56e24d78558eb2669e722b344d2c47e1bb797fd6f2c320f9ccd6e7cf58a0821b733cccbf666aa57e5c848f4d8c7c595ce08049178f5eca2f0e3218b6c8e4bc619bfc758617c42ee9100e5dba017bdeb0e04c5b8d550bf49bee0ecf55f927cf4a6a1499daf1af1c85edc375ea94f6558ec6e77d502b975c7d1ec86660ae40b5367ca7028fa21dc7648d655e27ee9f462cb424dea6bf41bb9368ea276cc7a92d32c122ce12a41ee76e5b6f1c90ead1e44f2307fbb5ac2d6c658278d61da0baa0abf2f952b6522366afc34f69c1557ee0546d033460311e32556e1be0b330fae752cc498ae9345af2f085fb58e25a62947454229f69f34aa6ba5f9b47735d2e298f8614ab221b323ea94f1b3ac2df6a06d58be0dfb76d33b94ff8961ef1cc78915fbfff89876c463db6a0d41dc72618206a6e9dc46c1c92d7276d06f70a058ce56d70a621d66fd5eb1f8baf4ffec4a1b4b8b8b08d027f155d2053a8b4f6ea1ac93e535893db4b4761f83255d93b0358ceb4d8c1528df21a286a27a647b5d655a598a5de90e5a97d3e1aabd26326d318ecb030f802274e010699c6f8fea693dea870720906bbb9dbc9b8c7a643f58769f58e8782f23314f49ca2d37aff893e2bbbc53e2c3c673bb90d491137e3fa226f95ff90f50950eba71bee8c00409be841cbf4f89382a1a0a52d1d3e7d47d864e2b517f42b8e019bee43a03c7417aca57b3790a364b95f91f049eace93ae15205f940940c8df86f965c07b463ca7b1a5a5e86a021eccf2cabe5ebad4ab3b713a11f55680a1037e7b9077a21bf6ac6adf9ac22253a9f04905ad44334537479518d8022b5c9ed81fcaef5907d8c52f405f13e44597732ede4974550c9debec209f0eb30cebab438943069eb85498241e3ff88d137250b2bd42138410fb22d9e64d9ce6f88c3a1c6167fa80a412087c96d8f198cf965198d70bdf33d16727d9f0d2147309823ca6e872b8b437c33116c9a9a4efd4029a7a39f27ee6b37c339d961c76d5da6ffa8b24d57230b496f88d29230d46c918ef6c71f54729b3af275b18b81f04453bd0e6faba6113d7ce33e9937cff7caacf7df89dae63ac1f0830a86ab5c0461a0bb2348d79be5f3a2795a61f010747812173162f96d1e095806140c86acda3e0d4e3eb41b900dbabdd211024c71cedf35d50f3ae5d65a5c3d96bdd84328cd990a69ad479ab7e21b4a377d1a279cc75168e9556a3a94eed1d21fb7c4786fd8cc48f136e3872fc793660b6f8a94bf945b2d65a2175bc229a8d17c7634bd741fcd5420599e2282bbc445cce658bec53354fa5e99b1f87f70a1868dbe3e4fdbc752c286c585dc04286ae57b6f9a53faf758cb7e012084e1840128d8e4337294e9f46a1beda7c7eb155bb4576851f9cda2ed8c9f025023e46767fe92b3dbebc5432e3c08133113d13dd7d69732e7642bc3a69f2c9cbf76a34b1a476246218a69f7aeb83c2377c605f7a79060cd17ce91edcc4a4afba4db9ede14bad9cd3d9e2fb7ee28db36f1f91a962e33619ed16c5b501ad78efbb4a579b48bb71dc172330c4b91e36bc9ace39ee932fe970e2299f92165bfcdeb4498790992eef48313461d38fd78d1727145a3e7ef847de1b1e140bfc9d7a5607b26447b9c2ef5b95e4b6147ffd5a178009a9c053ab0d2e6521491e6c1334c3136fdd7dc636e5e62fcaa5004d2be75734ed6872eef8d4d253d724cf0891af342ca98bf6cd344ccd85ccfd29ddb8fb0464c9f21043c52cc3b8294cff0f3029ac5ef1ebaaa6566a446db3571a59c768e1b670b63d43fdb05c6d83a3917b70c2c48264126da67373b04de9895416e0529d76a3309cd1190aa69521bdbdb01348fde1cf97acbc69795b70a581bb6f023a7237aedabd92c7f0bd65422d365b35b9871cfe1872ca09d7b80fcdcfc41feda28011fad72958d473f6cb9a5b491335e5bf05750ae143527213c9e66de0485a990cdf2ee40445505f7d33d4e60501f65ea7379393945fb9a8945446440b0e62f6db92607599153db39ca897a06f41f24b0a221e68cdc5689bab3fbd355cc0f4752c469e048e7f77864644ed0a9f047c38caa4507a9a6822b431f87ef96342d3c6030fedd47f5e582e35ca646cb8ddfd9e622ef7b65b4522b33e413fde7eaf3d6a9586a9ee45878d943d20352a64a1981de7baa3160e4ef24420ca071b49bae355ca620777ead99d9560c5a670e4a8963de9c61e74bc0f66013e1731c520c46f8d1da3981cb2bb2c7d1879c4fd8c320c066404f94a05efb14c92a56c82434f4152b19085ca2ef65ffe7b6e3791b140bad6254f9a4f6fe946dab9d5ae63c818a048774bc494bfda84e235fbcdf797260197df7598e08bd16d7c875bca36cd94e209d472913340d1df16218b144007e32b0986bdfd7e96724d59e8a99a2f0b56da111b3114e12b3cab3c749a4f5edade5712ed93c73429a2c2aa20fde3a5139f033dd424185a3bb111cbd178c7ccdce67feb3072f3d8cdbe009217d838fcf267fd3567cdf15380df33f4a7d81b143f76ac72f9c070ead985e49773636db8bc173387cd2ed8033901fc1422024fa3c05d1a7e504c4f7d625046e69c630703c4abf01a8eecd7f88758370e104cf15c3728a1d80083841ecbf1013094a2f3011cb5872c46e35f9de9361c536857d12472c1c191d2649d0923f2ed0c38f108c4d50f31271aa648ac54bb963a2788d92f9082d344c730f630a44c11a6ee95b6a6726f1c3262ad3fd219e519e2519593d8ffb1a0686747c4b6d6600833c683771675494c1b9a051a1e92d716d87552d26d22d8969d54345adc07583424778675fd7fed0309de102bbd7a1a68d610e4de3cea6c8679c35104890fa5968d5bf79467cd2d1b2103a12a5ce0db5bb45013bdde54abe00aaa4877faa5140819e7ae2fecd6b83e0fbc266b08eadcd71bcb0cc7ee8bb0ea051565434e4f2b7a599de604bcd680a2aabe9e1566265dbc8adcea92fb860f2e380839a20aa4cd78f621d7ec9a509e0f8245d1d964ffda488fef434568962690916a73ac67cfbc24d2a99e0bbb1c8ac59342d367315ec7a3493a42d54edd3ab05d0dd47c87fc69f6f35da20e7160e473bdbc84da3b4cef582884bcc40cee0297ab924d16a38c645d338cf4e60354ae2592704f5080f1c56180b6a947f1709db28163d7fa372af67af20b7cab4998f5cdea805a1b899b50d19d7cff36637351776186e56ed81d575110aa617c13b66551e10494b855e1fd14ba36a418a7f13cc4608e6e08643537fa36adfde418ccf83bfec2abf23bab7cb11d6511ac6646868061ad9358763f044483828126911f0d5b0e3d92f1a19165c178ee6d465a0b5162efdb1e702cc5eb7472fbcd5390b620a049e48eb4e2477f5c2de59075c2b4dd3f502037c14e7ff38d888610bd12b2c9cbdb21eadb082780b4bab6a578177a116b9bf6c25bd5c7d1c0e199f9c76631bcfba1690dd699fdffba977eac470fc3e4af8b04a0c7b60056f9bd4ba02a906abbde1e7a3e5b87aceb27e088cea6eed2003886c3fe33c87f4bf46702fa7e5122ae9406776e00494f984420ba69d409eaa060bd871dbd116e43e1d9e68c05a87aeaf67b512b68c914a8fa8cc75e59911a128e5b0203d04f5c154e3598c4ea2263cc843a8f54b876c6e8ad589fc9d32580cf1a701ef5bdc48bbd3c4bab8194395f33b865a519b9bfc4a413818ad7b3a18fed76fdbd4789d2ac8cf704ba86fc347c51baaf563e30cbaa5015206f2d0adbddafec2e021a0a097d362c7da704d3f42ad0484af31bc539f3e15960a892ff651c14cc98fd7f3f4471cf4177246912ff551d25c64ba0f70e1b64f94a06403d786da91d9b776449db5fbcb0fd100d37ab76c54b24993f2196614cd3bb72d8452e047e60b4e09b0f45c7b3f8a775c3c062855460c50817b74e2abfb8d673e429e202fda69b019a28908319fe611a2ebf392caa3343f84a11faed3325fb14d90232df94cf8dc66efff88896488cce8d2b1d2aa7e09c777cee6009a06b72b93c37e6238707252abf36f2749e5402ca3e5c0c021cd6bca0c0071e17f3dc0ce6082f80f982bb110ecdd5f631ccc12065d812c9f214ceca5d5386e3c83b8276ff2f5dd9586e329a985aca73c9010d0ab5304bfb117236c1e2bdeea836547a03041eab9094c38c693ee57dc67dd7b2179e9ffdba7a8387726afa2f220cf05f53265ffa2bdda499c3381affd0722acfc54e4b7aca59128224a5ba94e139bfbe1b9849b11b63185da7abcf0c96c549477ebd2c9a1700ae74446178ef37bb8612c02c692a3227f7b50688749750e03b125f29eabc15e5a69a1c787eb1a34da2b5d84f3b8e7cadef9f919fcee7a11d2f4b6071f5e8a506c8ef110721607b5964eb3800b16dbcb4a6734c7efc686ade6bc7f9e57c8d6d6db0b37131a923539e892cfa3e808eec41f12a350888ae99e39c5f9be53332265d5bc6779c02d0413e71a78becab3d7a435d1b2a0d90b8c90eb4fae66c5cd45737d98537df884ce5c1e6d95705e231357a4535fc97bad860e41f80f108d3b0f4134494efc892434ee7b908eb46b431a2ba77ea3942da7ddd3572c5c9f647be5ae837737f86c2cb01ef1085dbea64668bc7f43c28411d9fea4e1bf0f0f882a9907967f073c9d414cd025805ffb97c1b06ef4c423b27e416fd0847d1fde222791df16405bfc2feadd78afa94ee7bf997d9742b6eae0fb5875a021d9e9cb8880a6837b4d1ff9ca450073d15313c521316b06a27b3df6dfae9b8908c5c1986664bb258dae27f1908ed831b4fc7f791d77de4e58c3035b76f797d7a36d15ae6d7987b34b14bd78f650139bc7720a6f6bd49614fd11bf87db051c779a3274a8db5f49348446a7b7e9c99f09322ad4d180b0100bbc95ca0c4057ebfe6246be0f7a5fd8b56c37f6011b34cd391c93a3549d10d5bce5e08e677616006b8d659825682b8b835042c96c41722058f2482867e4633d131dc8bd7c2bf22cc6fb60e737d5a5ad495f74629a99f098c13b60ad95ea020b0da0b30de50a7f9afd6a0df2f2f9c3903005c15ce858f88faf46629479324af03bdc5398e18190ea646dcf731c9b5eac9e30f4970d53fb714d77a53e5fc4690c743a0dede16188a71c2ba3257caf34847ef414cd6b62e52ad9e9bfbd7d11d35b2d2d76ddc6bc53dc24a6ff60117fa1e3e4c7173cfc43d0c52aa0ddc6f1cc723ebf42d7b2b7e598b3f211baba7044e8f9894c44abf4dbb9afc8672148b41b4f75f585bb19d4103f765ba5d4e3c9b6ee01eb4bfab7c913fe39c5b1db717765b6e5165db6f4a4952f32b74e3dd9f98eb7f81c0f73e79e3316b928c6a3d8cdf6c6a3ae98523601f0453385acc08e19137ecfbbd68e20c283715b046df2d168049cf921c7cd9e29e177ab0e45f343294c5ede7e154033a35902b2b2d1cc53115fd0a25d1d116f4f7bb762bf97f55d4e38949048bc5a0285e739d7e3706ec75032976a2f2bd750e3eac2521510289e1a15edab93aee2cebd783a84505de91ce8fe0fb801644c6ceae61e89ce2f7c8a847bdf36bd5edf2252f95c0eb2ca4cf6162f00d26f87ef62a20babe3787299b4b2168a8fa362df8e7b690c2e4a3b42279b90a91a792be02600730b6851e64628493938716e97522beb39a0fec26a785d3a52ae3647bb3857ef10f1940e557b61c9b4695b4862bde27dd4478b054ed2e30b9c1d8a7afdd2b57400278d4f389c640f4f31686b17ee9d238fdc1f7254b9da918b238be10dd6be78924a4ea3cb3d35fb17732feffe9d7ef76520f7c70c83f3a884db21a00c0345f20a119a589e72517c2941313935f842ad4ef28b9e2df84f1186409bd8d23f06115a7bedf9befa5f48deb8f319b505b84078e133853d1f39067ccae9bc2f3d80c4b1ae947817c9a4dda431b809582a5e3b657ec8accbc8a89cfac5d631aa1e843401312e793c149b685430cc1603f9642dc23842bf9a654b419e8e05ca9a3cf309032540f28ddb88528fa913dd06afc8591fc734998a8213b17b09650acf52e4a630dd06e451056059096fd7fe3a5779e12e788890e1b4f0c88b892d56a2f81b54ec730cbfec9aa25be3a54cbddd6082a9c69d7a591e2cb0e151db27d2f4426187333beaaad4951f2ff8ce71f917270ca18c48be6eca17bb5c9c4d63c46e93abc3c5b6372ac214db32ce54c2c32a8c27c7dbb36552e9f0fbef8079e361d70c485a38e5bf456ca7bedd59fd71bbf20087a239d925ae6ad9844ae7bebf9965e6b1db312b873fd368ee8071bd2f85e61422f0867d1fc1193bfdcefc9b521e314daf4ff1588a9708327d6350397de427089d3655e7df4b5a44d106cc49d78aaa7f6521320c5f37625fb7034a3b458e69e7045dc870165a59f6b961f3d7d86f3e2b23839c594dceab0d0c2e8d1b6f914a523110309d2d51b7f3011e70b8344c09358c9f0aa5433602e6c52a38a63ffe3479a0e5dff19e3df516fb89030b00f8b6c51a446323c7117f817f2d63f3c7b196b41d2ee123813af9ccb4d8cc91cd83fc127a9c77e7bdc0b13843b45b2d528ac94f5a0c2b553d1a5fcd4bcbe9a0f1eebe57f7ec630ab595fc37886aa3c68dae4c08fad070ad9b5229d06c46690b359de33993eabda6af26aa6e8d2e45fe7380d9d0c6c6f1d02914031ba00c87f33ce8135ca71fd36c1724a7ad49ab5b547d4d2461c21e36cb9038de585c8b9a0999506791bcd6a7663c9e4b70cc958fab134501ad0efad3319cd15a70b26ea90cd74d09b84ae62cb7f4d2203506eb2e301bf6150547b30d416f94107f510f181d822716699e2635278cd8de7f39c07b26d23f68bc01a93acf0b68dbdde20f6840d7e8f05bf263ef016fd4b17109f2c6278756dfc3eaa15c7d8155b38fef265ff998f3ad749185f1cd4fcb88fcb07c208961f374d9c00f4839c9858948790284774f48ecfc371329fecc88096babf78c82b3b06206c82c6d71b9feb8c1208df0272d9409e1400b9fd495eadcd236cf7071398d73eb81d5b1203ad445eaffb51178a0cbd7887a5fc613e501db559d2087db526f1a6801d75133b5e29d45c87e368861305516eea214795abe9bc75b47cbffe6b2f9d025a21cb4bc25269c7a085ae317cc908129b44abd15044b496348a46a208142381fc5c87310f41054f84d689bcb296a6d68a022371e29f27519a7e7267fb5019e6ab6240be577f1cc3c87e218b36624251b74b7e86ef0ba9c3b4e2738a51eb7e560c13b5b66751c98bd022312c2ce9afb670eb1ef6e3474701deecdbf17e3ceace16f9052405a53f4128dcd717fd39a8b1a6bdce65e51d794927dcc35a36122dc9736cec677e766501f324237137cf2fc1f1e74fff0643694c3df6990441372aa5e4caf8bcd16a8561f0e0b57cb385b2d99b3b4bd5d566136b63ce3e73d28717b5e247fdadc5eb05c1c9bf339b0e2db1242acb5731ce194ca6f0126c2665db37ed07b6fe105aafbb2d012ef6ebbb523b1c22387fa196731013d5cdaccc46327b185e6b887469271bfe0765ee0a952abdac503a13e6ff18a6e703596ff3601ee3b1ba8596de9e3f0ba8728a00cb832272b52c4df0394688265c6acf017bebce3a242af2ccbcbea56518144ef0cde8ef8ecfd8d366f8c7f6b27546c609e761710e0d48b50624421160dbaf3f02b4d941b15df0b801b8c798e54ee170a7f486a4dc4e2c4f2f93ff874a1f9b803982ce957cd8e55daba5c75ca855efacb43de55ad49d34d18ef333bfba42c39b0944ed93826559b40f8aefc4962af18b6870615d04d17ceb45f8700bfa059e4c2e4d6b226a3a733f55aab0dc942cefddd340420944c8d753b3da961bca376a2f8695a5703ad87fe7c590f534065f4ea5ebb1963ed1a96bc4437d450bdaa70493b84db3eb08d275726e7e5d117e9778a5a3cd9a6d5e78fc9fd5f5b489fbd532709f596dba851727bf19006923aa1a0ce0c3d7704da689249d1eade72527a3c3d33375fc95b9196fa249f38db282cc68dd30af5728eea98aa291bf3c663a14fe32846a3cad43b86fa4a65920e8d07c1cbe224d299849cace6e71a61da294dcafd2ad6c6a2deb9db19aa805e63a2ac9fe54d0245759f87e03e038f775f7f0f9dedca3c42024c454aa8f20f609deade8130ac8a87f3efc09860e4666e579315b4da977478a9705fc4ae0fd2a5eb8edce8790910d299c14bdf36ddcda6ac5cc16ac1d15b9a9fb30761b95c8dd0f31624b019015b17c5002384a822433061c255e8509f5af2dd17c54aa5ad1be650fe7494a9042be9d80ea970fe36cd92ecf09f87940463e668e670f86dcab87091c7b02391d2e408a13365ab2dd58b494cbebdacfbd832f492cfc7b73e08246640e60432823470c9d8ff4f069af5bb5d1a19d2ff3df41f4fdd75d39c2aa9cd0cd32892f40fb0d0912781d8efedc02dda55bd10891c67fe2cd493d231a3cab64f7f5dcae98bcf349cdd36b7ba4caf2a61013b7d8ae125020f148156a9241a5c421b56d70454d7cb038a13653437dd1c2eb1b2f7929d27a7710f2b212ae2c3352129cf866690c0f92937fa95d2bbad07e5f7516d5786a4bd5477de6de02a5e23029d1540e36f01c3a579f2d9e2a8d6c6d96c0843d0f7039d5a09dae61a7edead36d92f00da601f4068487274e6b4ff804e1fe26cf6610fcee546caa8ea8a3e80209925fc368bc33fbac1a27e96d9e61036a6e6bc8e44d250d90858a67a43aecbe577baca9bc8a172dec97cf09f5a4cbe93139fb379b82d1db39f1e6b225540a13db0ae680fd371e04f842d02625531e5759be9baba75f838559d5846363a7277f2605f0d6199e33b6fca83bf4a62726c7e6340e359d171fc9f21b78dadce72038f43bf2a81714f65ddfb035abd40f627e75927c62d3cdcbf9968cd3607d23990f378b9bce7b2a790829258ec645f89a4f558fa52d78a7058f11fddf42f438cea6052bc7d452d36de7a480b99186421a7d19d65a392ac45a3a85ae36a71581c959af863f522e2ccc8871b165841f7f2e300dc68d645c52611d03dbdece70fc5a6b7fa750c1127ee31ee1d43b5d5515b82db977918bb7015f63ecf621357acf712545707a295b717cfb85677b4abe5d8b9707168c6acfa835ae7f18d2721c7b75abb85ded9556833dcee109656cbf382479ea227533b0487307377549fce28e63f13fcef2a1665bd8f22833e41aaa4f681b8f679185c81cb2d7a73c249e9a5c81d3e9b0c45ff5aa21932107eedb0db92ae35a782fb19ccdf17c01d404c7c5c8116f8fdeae847a8331ed591029d34130276462884f3973d2404f73f660fff3d8b160e3ba450053703cb11c33558434c1bc724736e848793ef2a8001938e836aa996fbc16a6d4a5351ea43fa3d36c6e6e5f27679eb62a7b7f09d98b5d673b78bf62a99137693763e1768810cf0d9d77aeca1ee3812236db2a15fb6eec3a7f74824ef2a65e58fe4f9a89dfb5b10989cb7045f697576c08b1926d5fc4f58d26959ea28c28faa1511343f9d85879aa5d40f0a7e695cf3cade822915ee6a591a2bf18259806fad915da3a7c045e13365187a75dd7c417ce29225137252b3da856f574a80efd18a91507cdca2e65eae56b2861f831dcb448d11ff8dc92bfa02864a49931362f5d83e8068c7af640991a18e065618ea716c69eed8a2af1d46d57e677fc7a24434f2958b704839bc608b89454a10692be09cb1c6032f85e86b753f272daadf61e771cea5a316cf83d3c5602a838d146dfa4a1c6e6d8de2f802c6ba21e6a7e531f2fe5f4723495e23fbe49d8fc55c93128c6d8863f7d36b78f29f6c4fe3679f1c5fecdc5c8bd6688ed35938793b75e15058f39a66f7e9c26f97a86ce8ae9046c768f5edbd621be9f26aa348fcbb691f35c6ca037ef871d8a3500845a0d8deba4bc4502b27acc3b21a824ca24cc4457ca33e1dfcfad721dcfb6d6a7b51cec0ef3d7e0c2430163a5728b12eedf9a8fa310eb7d6cfd017b5a66b6871355f87fc52f2ed8f48f98420dd70012d5bfc5a48d2c4b2a71ea6810a003e25f0d25a5dccfa75fcee10dd6dc46824c47e1ef8d6619f6ad556e910abe3519f88b10f7ada565013a1ad24bf793ea222ddba4a82d9ddf09acb4be0d2fad18f576df2dd7183e445eb245f3b7bc809989086d16191466151fff159600ea8ee97c1b873c2c0ed4ebac68f0cbe2697ab238ca4128906a6cd26cd6b22e0ea80c25f777081b1d8a87dd59b2e80c27eddec87e1cadbe4c37eb0829e657d89ed2bd3e396cf16521e3d921e2eb40cff80409d85a487b5b58fc510966a7dacaf2f0a362b32c54e2261a09612945a37d15b8bfaf1c192f9a287da266dcd1feff6b33767013f38c2dfe8b7f51094b91912998f4a04b5c230260c45021fd05ad6dffd95ffcc05e0b4721d2c2c260edede5fff5f5174dcc27cdcfe7069e5426511768ce555d6338762071463063c500dde3fb6f7052681322c20761e22916fb04fec47f5cf4997160996f8954c30fd4c025a9232c6c612aa49d9810db96c1b57b52a383c750592de2d5ad7e190c330e7fe14c73fa4bb62f22376cf8a1baa100164c6eb4bbaf33646f69f85a6251577db8c5aa4bc1b7a25813a1c626098fe7d92a023b46ec8ee10a1f5130b2bb2236a48f4525a75dcc099a73220d62fe84c826d6eac1599043501a842900813a9411e1b61a1f71ece964c6e09bc1245b5f76b0a5350b4fc74739726be1394f51ee16ec525237289a9569b8d68c4e78e138798a35cdb67a1ab6fde2bf993020da2225860919b50bf780b689afc31ed4153f0a01100dc6dd6ad4a8ca48b46b3266f41da7f0bedb6e52538b76eb200cb2f4f8381606fb2b06a2e819ac2e0876970a913d4d8e9dfd13411fa7f24245d796df8f4f812c0165b1f47f8045b485e52728548e09b9b1b89a43e5d7a8d72f2c42d967d6fea0ab6857325e5a97797960cddd5fa08b6e6ee72d2d474a3d4f2105c44d4b68603874b2edf41ed8aba6748d1aab12dfd128e7857d720c4f13b0e054ae64a41e7b7a65aabe6e7f6bbb0e6cb0aecec05f98ba622f9a5bd27a14a3b58e0cb4a7ada9c1a19a7f5a54c2d67162d22c52ae27019344c38a3dab49f1be813db708878ce81037e4a50bed68e82113918c36a0828e7b4926141ba63cebe1680f83443ce1147a126dd23f8aec8690c7c3efd04eb9979a5f1f8df54c9764a5dd88209707b36279af61eb8c4820228b0307d35b6da11be4d8f1ca47859189a3cd99a077bb8d20cc4715eae8ab287cd7aec8c23241e2e76030840bbc9b1f4abba6483e3bb71fb18d28ac876b82f41bc057e0ea95ddbf4d1c13cb091bdf15f58e094f381b073d373d0c126f714fefb09d90fb5738f4bb16b26d2093f8f5815e3470b7c726f407688d720c7510f7d42d90e44e98c345e7e9b91a05d371d4a8f80abdc142fb0cac4ef10ec849cf2ec45cbd362154bc318c61160cf6b2c1cc99a778574f9be2a2cf1852a545a617c6f253fc346aced35e09bd0e6d5df29450c82dff2206bd3149da9c8d2d718dac5ad62e5d006e2e6161616aaae2f347a3f6cf287bc8c8a155fcf015c1a6127afa725b27aecccebb95ba53af9dbd59fd6b844d86d80d3aaa31f845ae5d85c76def49df9fe05984f31c60d43066df0a6a46292ed2bb96ce89a2060aa71bcf34a88f7450af22a88152e7d333ef140fd9ce30c289e96b7bd72db22c33214af41b793d77142dee2f23374f8d887326d18abfaef0eb5ccad1069e63aabd672b88a5924f284ecaa2fc7377ce9cd87d3147912ac4171869ba4fe2b9cf1060755c32922f0a294100109b0b5ff5f1879883754c1210b966c6ec768714f5b77b3e5b0174e8c1963fc4e0166aff6adb759b878cfed575df898775e75ba900b4d770733278882557a56c73fdc598200582b167c4389d0f4ed593f9b8db124bdf31470c430e21fef740eed29c087a256457deb382ce1eb0b8ff46988eb2bbf0ea237cd1fba38c59aadbbbe1c0f9bd053d499722d760e3effc44550b78d8610320ab5fc6cfebc73e0c947375c2db9e679759a8e44fea0dc7fbd9249c6faf9a0d9c90499489f7764d86397b7279407adb1912965076f0e3da372e20f61efb127d52b3939522cb031dcbcb3bf318433d88464b91cb49fadf92bc3bf87af19810a141f1001434a10ce17861e557e5c3e63b78468ace3ef5f8e14ad560781557855843c2fdd1bf7bc1fb9867d848735baadce1452aa32358143142c6fb8dad33e22e706650db890f7c183c221becc5c3dfd9e8a2c53ec3891a56c6fa1158264e538a1fcf4384118ac93f8a46c300b63bb5687dfe44a86ad86f54b2e6c7afaa024b0b1d4d200c7825af02d789260407994cd847ed21a27df3ae0875eeb7f0926b193c380330d16c4dffacd4f381c53ed9f2d759502fba096de97c8fa157e8fd8cf85cebcdc8e81994b38fde1d1ae47601b16627d71bdf19973acb3c07a15380e0edb561b8cfa96d8896c0c12dcf2667dd5e0466cfff8361ed4c981a75c2d81f2ee5ff9e2257de75b463d2d3f2407e0f539a68ab952356691ad7b4e83e61f855d9d30911635d3213b11d0501b49dd87930a0bdaa6c4b4ae2fa623a37fc9256a4e59ad4ae02e84ed9c18c57f68dcd03091d3c7b43a2dd985b7818d3122ab88486ec5a1978fc73e7f5063db34d5fbc35fd9ddc42ba991539f340ad8007e7118016a9bbeac5fc8c0f8e2c4a5eac6efcd327fe158544b34620a5d8a552b6881c248996e4791f71ff5dfc474822e5ccd60d39b5df52dd4ce5ff8e8c6603503d954b253981412ba558616f74432d44e80f03606b2470a053c3db1a2eaf9bb65a4190895ad35a753e5e9c96810ab62905c65318488416d8da15f1b40a7e97532c04d8d765f18824076c7f672b5c3e8a4ea387e6000f1f853a7f2cc37a3767ad1d3024ab0ea5fc92033ac744478fe4dc30d97edba48a3558656f64c300f13cf5f4ae437b743cdeae5d29d19ebd9c45ebc687f821d46ef4d25a5a724e1d24b26becd5eca30517d9d5264f80961f45f82cbe822381b3bf17c19c45bddbda5bb7c1db78b6b17ac537e1f8b98dcd11321932ea391a76d3452e9e0b3f79dca69ae9425a1e3f1b07525039573a8bc6ffd8b8dcf3eeb8e7ff1faaf6348ccf879f0c721639f57cf3f3b1d631886879c82849cd2655d2ad6eb77ca6654a9bee9f5a1bdd9f4358c0d391d8e2bde8949c48f9df4073a7ce0cccf3dd53f4215ab4b172daf6cf6abc926d9f6423642783a60d8dc7fc65b81591402f963889c3b3e33dc36f56e2fd7775b3a242956df80f68128553661aedc3a2a675988444e3c2d00e27611f069503a8acb960b0237b82e0e8c7ef24d3fbfcab8fa16554db8118c57c129bc21a883b720c701627e41409f08f50f41626197695f51dd54ed83360d0e72a4f540019c6fba21ba51c91b2fcacf478ba106681308276ecccc7e0991ec321376bff83a686afe5024ff5909bed32a6d8554e2c71c23fac898bddb73c1b61bcff09c8db57db6029b2e11f974d6dc34e487f58da668960ef9ab5e8249303bd44c90ff48758b228ffe054840d3ff337f9c9684bd09005ab1bc1ca16d9aae9397e223265787e1864a4a6af882a7dde73b4ef81f182647af6c65b55506c3b7213b6dd20c2be51ea6c2972074a87deab4d229e54f54d2ce89d434d3bc547f9d557006940eb114d07f3f8679bd5e2bf4d9ad821d41df30025b968dba56aaf497b30a4c3d64e603b119251842f022b7405929e3538bd8a6958745f0bd4fcbd5a4d824626cac0e87ee2fdb21e716f9dffbdcf05fa12b47c2be82db7f055dca3f931777acc4eaa6e7f56e492383d1c9cb298e8a14ab3433c7a2a21558877c6b0c68c09258b1895e333b06ce725d3cd801d9d35c14d98ef3e32712d4337f834b21b16c169af5766d6cbacb2ca8f50cf7ffda42df6e531d02e597a1a1ad3cf929810682b20d84b13914c040c2f7e0acf4177df07669fbac2efada9779dd97238b6f042b7344fa73bd22c0aae3ecafa18e1178fd3fab9f1c14da75dbd7bad64219a514d0ef11b1ac3b8169e286a509eea07d1e96e5d0d9969ba85f829ec627f5358a66f582500a9cef57ea578a54a21defc4a5236c85ec1ab05422f04a19c03fe2dbb0c2a639c97837c6ec333a02c67d020c6bafdc445123070349a638d4465ed844002e7f26ac6d56dada912ff01b794f53c7fbefcec5dd005bf766c10d0bddf1fb3af7b8ead94b22bae8fc14c6e8f10954d65e3c61b3cbfc6a823c243333992db29b9f7e90586d975ee2ada51247c139455ab30209b98778cc47a61d4212ae248b3bb00b38913efd82fa4f04912549cc4e74cdf8b40f1178414138cd9d9b681c6654d618b91cae1cfaac5ab23e110ffa9a3ea21c6b1b4f805e1341c2fbd2dbd06094495d4a8499243a83dcf2a659652425b61e183a6d9e0d55d7ab135d351168bca961257236e3b9138a2dd74707bdac6a600510631d5632793e95eed8f19a0cf6e906d5ed3407cb95f9b95d6af64e2ac3e18808be228ff0018b0ca02c3c50c1f67200b517a9d8231db4f05b21a1b07d86b158058b099e33314a6705bef3d3999da49ddb890e54b529a9a94eac2c0654005a1ff970297fb33c87ed440b3f612ff9155f05f578ebab54678d127958b1729983d801f701b773fceddc561d594cc8663462af7c67fba41c4e0576d03bd9c37f635fbbe30c2312ab51b2528bb57e939d83dd1ca5bbd027bdf66af7e452807fc14f3a49b348d011f87c4dda1c742d9edc7dec2bb26cae4eb94abb91c0667c88b89e25d36a3a1fbca0a7c8bd2e3fd28e76f41309bd10df4b30c725d5bf8c6a1cfaaa17ed8d64c7cf1989b73073251536f6342ef7605ab13acc4ea8f0ddd756d08af6dbe1bb0fe8b4de6c380e921b441e40097df571cc9d55297e82c3c2d5781b21683361ef8c0ed7145783cbbf14b67224ef58f070563c75b5fa03e9e2244e6bbb5dc24b702e0bfd2d447ab09138b872deed0fd66cccf1e399e0582f01c0ae1578611ac0bd2d8ccee9ea2bc94fa53f40a3769b73aea2c16841d74d62d813f57e8c2c887107d13862f7f184a66fbff43f9972322831e566ed474722e0a3a62e1b735a30bb625b6295e24fc294c525c9416f1d78e7defaaa53510245529aa0074f579e0a7312978357dc024a4ee40dd70b319710cd95a1fbae6b094800a41856347ba875015df450e41f8ed620aea09670751a5c99f202dd39d014856d248545b20db737b4b9322e1e6cb4e093e3d7904d36a5576c6340f79375688ba18e53f8c26e407d36118b5356d93a17ac5d5abe46ffec4c3fe228c35fa6b0eb750093a3bc49056d1db487c3fc04cac4ac0d05f0fc2a5939a5fafdcfca9764acfc66f059fc3d1bd2f57c4a96475881eadda284976869068913762eb70fbba6c5764d307a97059d80b205d9595ffd41223491ca05d483e537be07bc5e26ce56007f7cf65815d59ff8d85524787db9d8f258f4fa9633cc964ea759b695d504eb5475d2ca44298b9cc2359de57f99e9adf3b2de223b913a516f7316fa125bf490ce55654072535af99003cd39e237f0370a1d6e143e1ecfcc997e188718463b1535ce9a4f7209991986287abf01138eb49d0793666c0e584030e1668712faeae89db80593c0601f1f4ad07b055fa0e896b9d17a8233f8d6b09377ce4821d12f3665124b6ccfc0c4bb5d853e590268f78e640cbc40f7ea2c09b7f4242f57d866cc185a54f3cd448f373d1bef9a6dd6c9e26015d4ee12bda696e3905cd5e3ee2ad4b4d669a93fd76dd731e8dd2aa69b82fa48352287337746149fdaed7dfd604dc210670d1b573fcd422256a2052551749584bea66463022b6d93f59e52170c0c5017452f20dc6c91360b7c344cb32fb7b23599d5546bcea3741a4eeb7080481c2f3d0c92396b951b6a247b351487e5d958998a3a841874690a85fbc943a90069b15bcb8b0e98eaaad3a8657014578371307f95894b2403510c70e9d58d230069a2eff010f02909018e6e0ab9310c1a60b932d2e51837538509d1c7ad74aa0938a957aff57a9a56387e0521b481cd23996b0df6bef167b7dd1f836692ded9bdc67814eeeb3d0f82c7702d18df357f83c287114169198a89e79c3cb525732649a2caaecb72de235401b5e58089a9138b5e28de162ee67b46c3f5125083926e99cd80f11893cece50713c24676d6d43734aa8fd1b782a2daf12c675b95e41ce5a6793a11a33a19efe15aef7b1017b7182949b84f146ea00039438e6cfebd4d0f0efc0492aa95f7517d4eff48a20fd6ecec98ff8afe9f4ad4738f38bab2b474f389669980ef28c1f5edbabff68f2e829cb08f4c7e861f40884d9732e297b20d018a37b2d90bd9a0bb6856d51701a0d5e9516218890f1ee4da85c7fe44cdde830cb79f29c8daadc11a114ee1e94943e9acdc210c8d2b1a436a608a0e039c24715cb3d761d81d8dc85b640f29250fd86564867a868c3dd79403fc01f8f4db8c4e9b6cad01c00f72cc0ac178a3d0bfa3db83e1aff36c2a862e33cb540fa66982eb7f6d5a97efe7d00f78df7fe7f1c50e6e0d241b5125156ec0cb39f1152352cf1312be96d24f8798a32cabc9471f0c314a77b69cb259a7dffaaf51102d72904ebaf95534beb8fb89b21d807240f8d6b835389ee7ce31ac49d6109c352151fd7fd5bf78aec84dc26e624eafd52144cef60c79b23bbce284b15ad654003f738dd6b9ac82ab126b6a387eb7f0f4006076bb01998e8cc58eabc7049c60d6392cf5466ffdde6c855cabf2ff41997046947d1b14487a0d5090719f8d0b53b04a67ac3eead1ccbe60050dd7314c7cc1f80794696831eb91e3d22f919e33cfa1f9b6203fa4406669d1dc74fddb07d9c79594be78da01d33ad3110309b24090fa8bd5ace66e76521e8a7b31daef8751ab4b73c985b98923a5533de2487029117ed717530a29e77502dbad1cfb9fad0eabfb3c211ddc976dd5c3b20a7ca17fcf4d351c2656cd52b9e4422d2989e128889dd98c27b0462100dae5bd255a5c9586fca8e96fc75862ef433fa29db5648a12285804dc53e3584d27c16ba65999288a3e4794883b3386fc8cb754a23baf56072851dff851cfb1ad74d9ab4d02bdc3515da22758b084839c307846636dfbfc244466a7d91a20a1aa040ae4cd481051ad4d33005fffa5fe48859103e234438565bfca9532aadbff078b2c6c18d32bed7af0c41099f5b6ee43ed82566352e353ac130a37f4f3dac57404212a8954346f5b2ee023362053cefe4a0a5b04385c3cba181546a63b60228eff1ed2c5f5ce8a5bf3991ea5e95524d79b626d7bd02dfc2d7b7df557dab22fe399901f154bc63a16b5baa6eebdb16aa10e6a30804fcdefdde1fde0dd5b1eeaa159e8bfeb74619a24bbca4172176c4f36162a2b64ea1ebba0e3c1e1863e224c515e2c983cecdbb0f7438439f820bb6cfb35b768b94d81f77643f689db9aa5d9e71531412e1f1d1d9ec0ff4f9fd94923a31cad7f55269d0790e61d82092c2ed1855650725182e7f6d5b5ea1509da1639766fa368264ad5869f1cf0605ac70f51dfac11ac20141c15e73c49a0a598629c60e59f3454eebd651dc87b05f004fef576c4bd82860d05209eee009408abd681a6006d186c434b941febc174a7555e825143f9ecf331863af94362524410e75727ba68d1ef17afbdd50cb3564de5edb4c56172ab18a8d488a376be6b98de5d6ec83b67c83f0314446f7115e803027dd0040b0613381ee0f1d75459a3fa055133448b2f859539a457e01ff6412986e49bf830542c3fb1c39c9953dc2bb8067367ded4fc07bd4b653fe976112b757019196bf8c3b0b3abcf8ecb603721ffbb322b92cbdbe6ea5a91a9ecd98e2c616c556547cba42e0eebf15826e6fcb6ce7e01543067351d4746bd7913f2008edbf87f5341b8e8f9ed5f6bfb802fb34a47605171621d65274dea7b555f837e979cfd7fd64b1d3c296b46a44a9935680e8ecdd1c70562a98aa43e27b22db4a3a9d4c04b096e553d4691f39343a7d22743af79cd0c231a1a868cd2827ac923a481b25ed601c3a21f6b8bfc00707349391d0e613449bec2a235378d99274f26439c90d1de6e264af29be70477dabfb47e3fc1988d57cc5ed3668afc5eb0b60a21e815c81f53e2853a8fc08386fca5e48df8b75d5666dc46b61c68aade02a174e7e38bdfbf08d08209ed2f98090032c2cd703925e7a6336dde6c6a3750cf0764f3276c377d3c523dcfce86c2e6918474c23e3b7de67a1c8e92d7ea6a0a5b12eaec6e785f061350e9808e04d674607cb492f929035544c80dff4181e2b03fefe2eedf665cfabb8255d5e305957407c686c34cb3e8049010974483cbebe40b79f4ee387608b31436c44ff23d274e55ad67fefcca4c5816821eeed58de61170f273f275b82ff2bed31e2b61d791a778a4aae221c3e8c6ae61d7f77e0f3277890163701dbd8f3d92bd3cd09f50d59365314bdd807f499c5e960cdbdfb69910da062df54ae0355d746a5ce6d9b93972cec38a64c22a0280eb1332696e0647af5d5ded14c7ca7acb129e704a20841ee37b6527e08c88dd1ded4c8bf4901dff621bddd81c3d7790a3e517dfb5dd126bd167158ddeb911c1ec54d7d1f86aa0c83e8afdec1f982b81a3b0b1f3fe0366e939e6dc2c1fdace9d27a42c9c8476df25036b888ba727ac287170f3551befba34fb70f41b42909df077b78c097ea312fff8b8a6371b89fa560f917198ea1f13641225c2545420107cd9a9d7b645061f0014871f772329674f07a5c80f7ffc675f67289f3e8bfbf018219dc989c12ae2400bcac72193699116264235e8af896ef0f5336ae22bf6442df528619c1c9ad1da98e1d8bff20963a9ad826bd14fbf9439b6305d927a159a41b85912b8f871ca69cdc9243425a936f18d17e6c791e98c543adcffddc87c563b37f2478b07d40f890010ed5c92dc544c44ff2021ff800d2743342ec712797b37cb1d49c454c12eaf7255965930a37956f53022c92f54d9006085c381af7c8d4b846c7fbde882055932135bdca1c537b62bfb03488f318e589dccc03e27e25bcce20cde71d554216a1f9c17e4364a3ee311ae70c38dadbbd5c50a99c55d61899c86cf0b8b1f4121c9a3f89b8d61acbb0d5ef01d7fef8a67662a3d74b42e64e59cfab2822cb66ada4d0c9af8e7be2d935dc5ee62ee18e5238cb0a8291dd106ccfaddb28c4e6b2509a71988886668706078a524f74dd90b81cac4fef636cde864081fbdc00f621d09f2a724954e9425fb751a9a93aec46212eab01cc0609c2af84fdbfd2f809268bfc0139386b9555ef585e0d2f687951fd73cee98d45275e1e39eb3aa68500a8ff940ad241ebea56560eade9da44e9ed93b2125a3a7b3bf140e89e7597e974abce834f5c8e6da7fa656823ed3cafb0fbc9be43a084fa28405c5eda14bde2148dcc3aa6a072a547337de907e1d974cef51dd5a410f08bd6e4a771dfcdfbd00d9f085ec4de1a24897f4087cbe7233ed3048860335ab2a7c7ff43b217bafd42ece8fe822d3ba7584bf9a2b697a7534e74b7ab3fa23602a5fe56f6ce969126d7395225ff91ad23da77f47b0a81d9a74cbfd04eca3a809daeaaaeb4f925f9062e84d1282329b2584d1d72f4ce043e699d5344e8892ee7a34756950db264e83779adaeae8447a4ff2643bb143bc652c2751e5bec18d8b488a0cce7a808da94f4be7215adacfe1ef5a10deb38b795257778db4073729a534118e0757002ee085acb95b08eb012d4e22f86deb709fe8bd2610137d0f530d576bac473adfbddec0b31cd6213333fd27d00413e261eeaeb9dd9e9508ed03429a5c520e5eacbe03c2c60c67eca3517b7f79f7fa45b47791aaa10eee62dd6288fe334e6fa320ce091b1da3d3920bf7f091d68b9588142c433249a936307167311e727284a6ea0b1bb2843bd3d731519e87a83cee996663a84ec88bb6df97e6a2edf52f595a8b6d805d511dc4520c8676614baaf8d7b026f43671072d54e0d00fcfae5c593e7bb20fbe656713949295ab48d90b8a328ab90957ba009ec2b082d9e31ae20d1942e4d4dd8a0157186e583fc20aecfe9b3db21b8d6eebe719a65d0656a300848d6db1661504319c1f9d27c98fff213ff24ab9f161a9f680b2a80ae634b80cf1d74e97d322cf7cbed1c20dda700b5161a130e163ba6d01382b58b181819e31f5c58bb0ceddb3d2aefacaefe861a930f2869f0ca17358f9404d7dc14a7d8566eeb04711e6a35d95274b31b67239833cb0012b65d3e771edc5b502f250d35ce706f5466d7479008dba3346d25ea7746868db86ed8270e0d2634e4cc6cc4a476b4e1acf70b628735fe7d206be712e325bc886c93774248bcbb4dab6e0230deb9d882061ff7bf0b3e4c7f653c5ce4b7af0b58ba91ef8cbfccb3a78ba90841e8007f2ebd267c761c0832736ac80a5f828285f770db28346bec4b1ed3016e50c1872c5507b8eb97f0cee361afa927c8d3df82daacb2d1f9f2d798f261bb5e995bf3d547ce16a1dae1eacef0a9f5db4f2525ec59c591a50a9e829a281f45cc7fb844a71736af0158a3e0907c83a3fdb8f165a6519697ff5a49a61ed690c7ae4b36c70362b34f07a053c39bfbdedbf33cc48d2b355222618af52ba9bcbd9be1f1a03aca264245417786b07cdeb42ce49162fa5e03bc268639c0994a9c105c1b33839560b2330a2cb2912c0ff961dbf85c0991148204fd077eeae8ce15fe325fbaaef5fad484f505eec65bde361c2b28e1684aaf7a3e8d3493afb7eb1df23adf2d18f3d1c5874fa95b4d1bedfe4e4f937572e2cb60a498d4c0c9e903a1525575e5028f51bdcf84a6c814807ca5f76ea117b544d2e268e3e9757f061f81c543c8bb169f4cec937c88cc624419b12bf238067a3685bc4a9879ef52c8547f5bb835c80db0e2755c2386fa304fbbac51bb1a576e09546b5429defaf30f8b9319d4e2ae1c5d723a229a62b890e2f6284a1296ebda2a151b980c4a916be96562db540d4dae20c8e7cb5271ec307421d8e1216e2ae2e03a421996aeb1aed49b86e3a5e06fcb6772249d147e189ba9844d32c799bcd15df74c64ff5d75661a7594033e6eaeab0a369e8a8dd082015a0fd04573df23b71390337f9be81590c32cb05bd5c0c97ab3027d861f9cbd69aa9c7efe37fe57dab7add4f6dc87c721b02851cdc5c1746cbd300d16689d968495e1a95eb75cfd0cb0c854b17871e563bc6ca797114b312c345b514b89b7fb758d5d019c1a2d15ce0f677a1f7e77b53def46449865ad499f9cb788f3a171dfd2d9cf68f03511cee553f578a019f608938dd24e7aeea713e7d87e91af84a521f86acaee8d01ada3b09d560861b7d562f5ba2be0c2950ea256efee2d68b81d2636df32d71f4871569bc5f40f7ea571f3d44783400fa176ae76d8948d181923bf7fb6d0284050e9978416e3409d06e1f59b596f54449edea4698a17ecfc750c65c7d84109dfd9e3f233214d3304b4690e5eb66c5d873e2596aaf50d95e88b668448257d3bf0b12f1e3995522235179974793f51bdff85fe0a5a96caffe45c1fbb97d485707bc47c5c62502427bd04c37cbbf57c05b76443a8072a2f1a6e01200fa5b8f6c83ef2f3110eb1d9e9f7a6718e90511121a2f37d4844fa9cec5f139b11f2b21427457c38d5b8a81a5b70fd8ff3e1df4afb2b68519be8ff0f58159d5b18807d0c4acaa0a8a19f80c4efeb4882483f7a759ba4b5affa3a8652422d72f86106fad2e6379c736d6f6f1083dd554e909d71a11d93fc7954acb6eef5d9092542090ee3849b30920444b07794c993e0212f354dc15e83f63f3912e1525c890d01967bf14f0a3f9fd303b7f0982ff0eb3545e3c23fe96beb9e86ac4429d554c219004d641b086e3648d447dfc70d184b98cdd681d5d5a56ef5f39963bc87fab601df84c5f635c44883e37443c4c9d8598fda9f3fcab282eabdb126082b07aaa121120a9b0d07cc9fa5629be2be2f953dd778c29b450ed4a127f288c98e49c252c1ed1f1692a40288888b1751b731a663ace6fa02acd0e77be581dc882089990043efb12383d8b3a0cf995715b258c6f4e888b1fde5384a0ce3763b7642985661f32b54c3a0485dadf82afe1a6d12465f611d72cc3bfbd37d02d8b9e73e659a76107642354833879864a7806b0fb5312e60d47bcd5a97669dd1c8128ff2f997d14c3f149be9ac0ab8779f3d18cc9bb5c242230b63b3bbe0928974b500cbe3d5d1fa925515ecd28a0f035ec037e501cfff975e17bfbeebb53ac0a3db9c5389518723d7b67f40652431d982e5f2242ea6388e5b2b466ff8c1c042e4e1deed53f182b098ac5621dfe14d97cd0db63a784929f03e1ec038c1a8631c3e35f0db125fc8dd849d5a8abffc54a8f7478b18629d8b582f40a60e036a657979682bbd232fa767b34e584c1c97b3b8d5b75b61cf15ad31936e36cadde5b6194a103c68ff99400a7d0d1816d10c249e2ea405e456915cfba3bd1671ebfa63db7ba8c19843158c0ec25e75575959393e17c34071d784ec3b8aca098884869f7120761bb09f130a28e581173afc1f462db5ef9abb1d851155c764e8af6ad31c1d17191f0a6486d9d4c52c8fcaf4dfb3e2824dd1ec32be07bac6f924902e1d629e544a3b7bd6d38671b83362c083ef677fef45b70560035b3f92782bd409f231a1df8677766068d6dbe4f630415193eea61e3c3bf1197eac92c284fb7047c9176c6866ce6d075695213a96ad08da65c0f9c4c3215e273dfdc99caba8e041d4c39c4a0e17193299cc79e0083cae4f8d80c7e12c429fff28a461e92670ab0f26670a3720706ae52a003f968d83bcbf58f2b4489e087e2aefafbfc5f2a90dbe4195d965984b9cb56bd824ac4feb14c63bbde7f4d093ef2033e5fffbe0ad9511462cddd66b4659c4ba931ca45b0370176fa4ab3606f64ee4dcb996753683a4f562e3e3bcdbf14e6ba7b9ceb28c19bd3c76b93c7451befe96ed87bf6418bdd2b5d812a47c04f6857705b20f1e9b817d896ed6e28931a34fba539b580a4803792e7c96614c4ba64711b51a542b60db28acc71f364a30ae4831f737a157afd1bf9fc2f9dc64d4bfc0d5e2e1fcca9fb422f28a441f5e7fcf52878f0cd64ba82fcd5f9ad5f3b29e8f1dbd152884d4c128eb0b15dc5438739b95be090e349d0de5e70c88a9207ca68055b67b8a8b9185e17d0cf07a41d755852f13f8aaff076e993d33f2946f3749e27496b9d94789548c1ad043053c88538ba22c6e1b391a7af69b61ab1003c71c15eaeaf5d015b7a4fc86759dedb0171a5760c5ebb638c31740cb40031bfc0b943221dbbbfc361ac752a5937150d74eb4d73c305b24d94192eb14ba3b8253b3477ddea888c8cb7f108fa66e48fc3a862b7bfa93257a936aa17ff022a0d7e7a813ecb18cb6330819204e55eb60fee51e0c061a69cc79818e08a5274b4ce9e2c1ebb3dfdc6a7a9e5da5f464763ba9a09010b2767fff16ee2e2a3b8ff250dc76d0a882d1d36253108b9f758749b8b5273fa95735bd518613b1b139e56728c7fb293bc07701b55a2a302e1cb9d2a7ee71f9004b754d629a97e41a4560cb5a3bfff14c68b7c6943472c74f0c043e21fe6d3a6454aed5f5fc73ea5fb18cca3937c1a8ee9132d61125d2fa6f87aeb6845d3d7fff368be14e6bfb7e7ed3549f92b366d9004c6511e1fe6492e233d9cd6601b7f63994a990fd0283f7ae6f8cc3a0758922515456ee95c84239561d1dbf8937a48823f7f8d532e38973e28ac6a530b61f700f6172d3e85398cf5c0611ef33a722faa1c6365a2d23309f05205d8dad75d5f0d7ba5715941a6103a86b2e8f74ccf197e8ca0d1208d8bd20afaba27c8c6138cba5dceab050ff970fbfef8e8053d77c5eb71d064ed305ac22dca3acebf64f4d81ae99e9dcc89d258cf377cf7e424145279839f2b0c4083495259d214af919527bd1eec114da1fe4616a19aabda0ec775577cd0d6cdacd04d974138d630c4e52b7b868293b151012d50a2bc15b1d4969f01c475511162b7c21da278d33ff082a77c6b71b129290a904b0c4fdfbce289827ecaca561be6a6be8412a7a656e8aa2e441af22e27d20af7beb13c34f4f03b2bea85ab8ee1b2e10b3a926e09b7696bfd20cd08a8d76455d4f8b38cacd7577e0c34b6bf5d9bee6d80e6c24b32fbc1e79d04219d6a02bd5e70693c0835124cefc93fa270bee43f6b5d09ed392113a163c388e440b10a9809d838e8948c7dee195d76b568f5f2ee7a6879de6896e2dd22e2193c1c719286d6a911421884c23b92ed45535b877111eb4c48f33511c1dc359628ecd8cd600dbae824d69edd61af93bcc493b2397d2e9c3c9d534a7e738843d8ddacd292451126c0c008abb8d705e0b351b48fe1c5d7df3e16687f08f5d2baabe343592386383ef8d57496dd88cd8cc429406169de83490cd47595d089dda37176ad9d48730ad2ad08beaffd5f17bc5928502c38a3f69032ab7a4b243d1463549215a8f9a1aa47db1f7f19ba6a3ada26ce89c98dc5a842c60363be22f1a993dce36b90f36f14ef9e37288d84c85aa6cd696c285db484c7e2e99eab6656ef81919ffd545a7830f7d74ffebe9d67b8441f3fb716df0fb53a15b9da73dd3adc2b01ebf2ed7aa41b21fc65cff42de878a412e7f0ab6ca8dbeab8273564244bb3c3b6a9fecb2846279009a87311773e760fa64fa9c6cae73bbd0c9ea1291e8319855095bc508b57ee1b1767935efe117e11229df0627074872608f25a141ce6fa8492ca8af1dc3c98aeaaa56768ab42dc2469d9470c43f1378d469b2bdee46e54796f1ebe16fa43516e9165e88e83088316be52c925cabe355f8e9a5732faae421ff032d1a7f973178fce4fd92c1880184919c6e7c7957c935aa5d2f004d344e82388f84f1769f69f39419fab5761e676d9ff40a476f343ed2d2f06328fbce2bf77624e0bb086d4a875ac5ab719b7eec61b3e23e4340cd7918d2d51cc2fe9f7214a54cbe50421508797ebef319196964e539da74e847b8ecb5d131d2e4e2e1790b036305245782f1d600567e53e126f3f94e5c5513ef31d5f156f3be39a0a53c833bc348c9f77e52fb5c72be2ca306fdc55ec2911d9fc9d8d4c2c865a8613bd8f9fd664bdc8e79d3266335766d7406ed05199e163b6244d707af1a790e2d89332f5d8f6997451b1a3aca0311981a9a36fb7d5177804d6e4b8f4c85a3e2a3c80cd0d728ff414c9ba3d9fddd0898dc367b068c83d0269b4bc1b052dd76e03eb44402368a1d2eba814df4cd275ed3ff59ce3439ee17cd715331a9d9de289479dd89e0d189138f2b0945934a2ceb8cbe198b2b06f0aabb24a9c248900a3e5326c09de43f3a80466c05ae1dc1b701d41ddd481e857644989a92021c2374d609b7556cf10e0e98b4117b2de0a04ade1c02b2204355713f875f03676c75b17413d9a88be902691586270d832bd601c33caf1d8e08593defe870b64431df9f3dc0aac6cde6fed77d0dce395979e507f3f90eb2df408955df473517943f583dd2aeb19ce13e423bdd7b931bdef260f04fc85e41bad122964706e24e17a1121d134ac3b0f10e1a0dc6e5ea6fb4764b86e199349606334060a88ecd8681be25cada575da54a18858c67bceebc8aa239ce63cb00d3743c9098f5f5c2ffbfbb2d9afb4870911bc080056b369e4c4ecad14adef7e873ead8c49153923f8729c1a7357e1467060cf26afc9fe87a476fd3b2350f416153cb130b15cf1e5af1964721d3fc75b00d7d6e2d86c310bfbfb213264761bddb5876b70fb6e383bfa2bf3b7566ebcae12e02eee9bdb48d823be2096728032afde215c90157a0323df335d53325cdb4f594546c40dee0e7fbd234d57f4f8afffa8213c8ec068ecb425e092a9d12d09f335c2056ea5756408942926df44d9870a28756041829b33b1c32a22f5bd266a9679cfd9940499aff676a1bcea58da1022d3d78c697210387e3c3a78b0e34fa7d1689b876c72e27eb2ffa6e6d72440a35f05178c39ed9814fe54b2dc4207cb1942279c031293f06362d668de9d3a373d8371f8fb13cef8e54e19e806ab1006b2fc728c57206e7c9d437572e308ccd3d65a56dfd56f7755f07af017de3a7fe6ff03e944d176f1983b4cc1f6adbffdad6309aa7b69fb362ea7a78ee7ee9967131ad4848d2bd1cae0cfe0a2ff14f46debaae4f6baf344c2b27d9a266fee9643444b3d8c8bf5225738891d3d3ce8165661468aeef02852033b1c168ae251f4c91bdffaa33fd8f731315bba8d200e00b699e027b3ff68f926486069fb96d70ecbabeaf9a0463c8132a72ed3a138ac7e6fe627c46dd355c9c43e8dee1df4684b8912ee5ad8b9e20adc3ef05b384be10b32ac7f3eca17b26ca5982623e7a85e2d9439c16a6f6773eeaa8bfc08ebc83f41f966fdccfb057ef14ff494f76e837b2aee0a5e7f3cece24e56fec5552eec9ce0727cf8cf6127103983638cd3bb8a4bbffce1babf1325b98f8c78ef3475b78146d9dad6fe30345feefc7aa58139fad1733f72f4126cca408ac6f37bbe8b69f7f94462e366b665ca1533d22c59e4c1626826a34db1a2c073375ddd92fcd38184aa496e60b3519cde6b439cc5b3cf0b0a808dd500cfb9a5ff360d73902232b92c2399dcfa652d2349b35e8d50b251286bb6dcb013dec1b44c2007ec33fad098dfac0e55fedc150b6dc59eb79bc1399be07d233c323e1fa3135ab5bce2c102e27cd2210615e7af46b7b068451a8a150ac47531350a5864b30c2a34fb7683c4a2c0db0741dcf848c0f5cb2bfbf9d34d1711f29bb09dc8ad8589607f18a1d19a5a77f3f943605b6f5a7094b2cde9e431b11dd3cd482f2c38971c0d81d3709133d032e29060184ac0f282d9779fd6090408e8e5da24bf534293482a16df5e47cf0505e47a7894056b370482fd96d1ebcdaac46f2adcd51c83ac9fc85bd7280a5decbd1b75571f1dc8037b7db41196661fb02570abefe890d7dc20d0450e9554ce8da03d00b9c75da64f04eb1f1d841d9cb0cbb32a42ccc9ed28e73b19d10f0dac45e338c706298503e00d4a853e87feefa57e2348d14143e8561e76543ee1a786e573cf579f750d781e2dd805d8b9b5952550ef206c7faefe5a5e48e1a0e07389e0a861426d0dca53e05a1f6bc5c47fa3d9c7aa368c4c33c81ed43dac2013c20e04bf24896b569a5a2d4ae5b150f5fac2f5811feb4d790d0b215316205b149b3dba1f67ad8d68cb6f6efddaedd3dfe579950cdf0e73a1cfb141af97cd66249ad2ce48ef36703d0014ac44d5e6ef6e26cd51722f85d45b676da5db36f9568837df5103017310e7dd8d788744b6c5fdafc5bdff8532906c20baca2e65d9fd1fabae53ba703ce6efab278673c36dfe39c219e144d76f3d816cabbe89313f73eb50deb8a5d00553e17949780b9afb0a01ac782e6eb28fd59d5d3ff2174be72c57545068871f0d81b9d6a1f556d0fd4c59915913cdce3f82fa4bd142ff4fac9911d6442fcce2c2658437e39f5df5a5a91a6aec200d01cc396a9c1261de9a409ecd4a0867462ce6703a6e576aaf29af799461595a1f09ab3c3746f6be2e0b300dc714c00601a7bd16dee15475cfd180637792168c8e7c98eb80a776cae59aa7d0214d7cfdafd1f2b0c0672eceaf678207f919d6cae3a0b45396f0bbafa37b5dabdbebe815e5d892bf0b22e427d313e87a6964463a19a26a9ad1b40568ecd643932603d69b29009d73e83ba8f0bf503e1fc7287993ec15f84969eb8f56935912f8285f81a93eb4e96f0d888eb9536bc9a66377d1be9f349c8399f75e4e50858dcd27a040d7e261599b3d5ba92787197097976fddc30739184dc30e8b0770efdf409db56511aa12eb999ba486d584bdbe6f7d1c7e32d110d76bc556f46ff94630bdc3de4eefb8186af0a1a1d3bf80442f4895bf8c92b4e7daa8cb115870c76d8206aebdad0b3b0d6ddfd07dd416b9c3a370a24dfe77fcb236c76ac2c7fed422731300eb18aafb19bea97ea56171c84f2f7eb2ad88831893e2a4e9bd1de09ca64860f6c3ea7ec9aa334074dfd581ad03b39754a9fe3a6e872aa25fc50a686352ff8fe3061f178175f5113f0571773216e0ec6a20697ae8f2f2f8093893a0b87adc91f75511e7deb40ab207e197cdbeedd6b8e249b59350464753a80e48b8dcf38e70d27d04af950962a379a514d496d609eba0bf084e0b9ae5d0184c92b667fe00bb51b19a2db6c07f0f7121ff1b72e782f4b473bad300492fce7964de33fb87767627615513929a948ae19ecb62d7cae38cf587f87920d0975c03d7eeed8bb73af641958d07e686ded30132e17b46ebcd16e61e78907728bfa823e777e41d57b9a6c406cc00628bac5dfea836435213ee5689354de290c475cf7a13e6a4070a3356653d7da2fb52b95eba75738a4cd0ec60f0fd4223d016cd1a31e5e44248c1a510a57451dd1779dc66a89d87f6b252d6eebdf9562422f632981ee1770f9126a2285901d6dc4671546e082cc8f1d8f3b49c3150fc58dd6d09ad84df32fda516285ee43e11a015410d2f9ff0d9f058cb78a4a6ee2e27808a9b061c95b514b16c68f3d6c6d27e06fb14f041af6bbcf206dd3d964f6a023a3457da37a4c778c23b72ad20a45402de4adb7197768ad3f9097f4a1a8dcd2115e076729bfdd2cc5dbb3798001760328f0c09d343461f72153ea4dc70f39e3ad0550eb83842a56786aa69c67a674ae3468800e1b055464e79964d7cdffc653352b88d355b823d039c6a559a162d596535d639cefc6e18885906fd797d6776e308eaf82f3264ba1386908b07e42d830a93758441b54ebae6f5cfdf8a603c84cfa1954d9ce2eac90a251b74f7851e5af173aa6fb04c254368f55e3f2ab46b6c11e9dc41975e20d39982e2280f833b449b96838454b15cec772530fc1a15fe99f2c96c649692553ba88dd1ea72b5c51b5aa35a1dd238c514dabd3586705b8222cd9895c97dd89b3d58e6a7d38d47a718b8c20b5686e000fbd1c2ac2e775fa10634b1cb42735d8115e9c13fdb5671997eadff603f2e197281fdb28b3a8eae239b3882cce8d9a9e898ff8c184661c944b60f6d47394a029e15c28a7aa0f30ff77102a9e0bad4c5fc3e531fcc36b7c3759761731b786c5e23993d008e75df43d42b96bd6500e5e9cd908a35210ed9e22324cee55e4e823e621746335cb61132dca08198ce2c1fa8695575a004aaae77530ab9f978d7cda82f931bf525e9bdb3d4d35f3d4002bd07572a849190e5c4f8df5d47f062b037f937309d4505037c4905758f6ad91fc385bd9d4f9c22eb1bcd4c4abdc1b326d57695b67d41ca464b6a7c34828f153dfc9bbbe4c662118019dd9ab9f8e89e7e1b339c20c1e6898fe2729953e73cfe767eef5dcb028f62e674d4c47dc254938695ed9a4ad8ff043f3c08ae29e51a81d892b780e3dd9502c12b989305011b55c05511c1161a69cd1107706c250373dba39d6bc892a4ba927ed8e51a8e093d4d2f9ef4fbe6134a0f8771308b760f55ac283b730eff3be14ce0512f631d747d95e6148abb858ce9abb8eb46628762e9357b20c7dc074bf01f9e1d938484939e837fd49cfee1800e6f83c2b37c46799f6787dbec3df031a498a69f1e48523a619d8d8e7f86d9867689e3e1d3c32f3684d36d4d3720da4caae8ad2853c571a13d3253b0d3cb0339f9beac58487e562b4515e58745783ce06bba31e4e6e101f2d4a5be2acc6432c557a19e1670c9fe9d8515e9a44b505b009a4037c5933174a65c4248ff092a9609daa6099f998b22221c5e5f0e4bdc834e34d5a20c64dea738f9ffff77ffdd0e01159a3309a506ddbfa393330b469be1f717e4b13553a521e919236afeb0a8a6140e715cb18511d644ba651256d88b8e1337ec2336ec15e0343e7bd1bb7859ad514d69f2f4bcf009e9e214ef75c6334ace8ee283c4d49c9f7cd468485014bb1af4c64ec6899362fa5297eddea2d1ab07904f5347991f6405ec7b28ac71c9276cad0bb3c557234e53a684838158320624d19511c3700774068faceb7ce72636325a505d1cf37cd1b6a174fcff39960dfb0573633ff491e89f8505d6220b68feee23f0961630de3e578eb691e6aa0270eae43548e2be44baeb636c5d749d1dd4a93227e922ede6b8e3005d0f9b04b5a8c850b56fdfcd00c404f24dd3793da4c5815a570c8996543e5a93167c184cb1f8e752f65f59388edb9c438d8b13e89c7bd9b0ac61fdbdde792b4863a299efcaead201ef42bf54589bdb4407e364ec9eb443d6c6fd711d39d9946ee20d6cb2b4ef80c474b002eaa2ee45e650e72002909f96a913f77919256eb8500faaa0637c9b57b7045de1b8e69f9c58b7899a025b85492fd1ac5d70e413150c872aef37f48915b1c1c6b7d309281df0d65e2427370f424956d28968284fe9efb6922b5e3647d99678543bcda19210bbdebf6f7780c5b9b08464de69c61931601a0a083ddcf2b6de62483fb532c6ade930bfbc4f2e613b4fee11868be59c302e29a3d1f78a4c51c4940e95eca2e8471ca6182dfb69755fd49f3fec63acb01b115800e4e045494bd5b8d5b035cd6a84695cf34b96c10739817572f4352427f81d5e64862f8f4b7b8b4fd0546683aa0b7fd5c620c93fc684fe0fba0ef5086d0fcde8f19fd8599d675401c002e245b1d73a4d6a955c0f028d22dcc1ece45b9445141d1732858821d9e85cf906347ab9c7fdff98e30a17db99408fd23fbe538f2e36fa1114832eb2a921caadc40f1303a705859f2952f5ba35b54d73ba26c0e766a39c85e79d7cd994aa3bf6db3908b70f3f78a793de8e6d8be891141869c61ebd7e97bfc3d7eeab8ef00cbda112c5bcb433e401047ca0d038ec944c929a050ab252dc97f912e2d2cd5e38a6558293b29beb19a342e61016b862e4dd51861e3859342d7d8060ae7579916113422dac29ba79d0607cbb1f1485fcb57b7d5179845553dd453528e1c35727ddf488fd45e06c795a7bee0db7e1335394882ddd9dd7ea8717ffec04f6e8960aeb3c0130ad64643d800102a12f1982f36abf44375508d107dded74ddeaa073d8b65a2d8a20e9ae07bcb8b1b7a6894a0b3f60bbc6fd384b8675691b9adbbc990259853c181ac4a21f527eb1f01622b6686e9f0d0d2297ddfe7f38ce8a581c91174a0392feed579257fd7d9a1464a1937af337cac906aa3f31ca6eb4d039a27e147900be88d193738c974026569e28033e4dd0524732050d604cf1547536e0da680d06cb413361c16c3c2bf1c14394b356f986197f07c9f23c56ec640dccab65d935614bab829c81f6210895b3327de2d03dec1544aa23baa9d1f9cd9624ab115ad2142c9c55b77260f012f3168d2c28b3ed9e7cefc2a8f71dd468eb43a7fed02fffbebecef7812b501435d8373e4c73fe5ba9102d0ae63d28bb38a8b7d4e3e7e11e6172312635381875fc1a1881c780f07a294418942f4a6642abc870106eecb5f95e6f69dcbaa30795915f89ea92e644014970ffda4e57fcfd1e73a2c9cbddbeaf2dd895790e9caa46bd7eff13c5289fa4cd69cc5179e997da52039d380bf96c1c7c03743ffc353a83a597db4ef282e8682dbb05de4cef37b3d3d98329c449c79ea68391b1c5be4bd45513928cbc50beeb1240e559e904e58bca4aaf730f39d5570287eda15076f098f1ea7f61c8d8936462e7db1d96e29d65ad43b08cd2342bbd1978018d85acc784415fa8e79306049fa6c9012b7c44b4e20ddd3469a6ae02fdd680ebc18ed501e05dc97717a958cdf84713359c95d7992e1be586095606e13743bdd49cc9396a686df5edfe6e5a50ea7387306beeaf5bfc8eea93db94d78d04236416d7b32ad2af6ec0d2de0b69e8a538cce7e3de0679e8f4fa02ce3cf5db34de9338994fc39fede722e729e92d835be05a3a13c800b4b1a4fcef1b8b954f97d9b0b534a5c4c8ea8b6ef5a56c3b499a2c95312f1c11c3d50e6528e99923427e24f096d8696699f5925c77d567389d4d3f91a79827b991f951ddfc69006eafd42b23ce3526f845f67f1890b062c8e4a3f07de4eea2c021afb9892cb3dd7de297841c5e623a61afbcde544433fb3d4ecbc6f26de7a452629b0a02f0046ef711b58c403bfe16bb15796cc301220a13061a4525fcf9c48473cc0e89c0a81ade47054ec0bc4e8cdd600eb78663f82d8f71965a47c8d52b80763616fa202ca69d34e791ff3ea05043fd5377b2a999ce36a67b405c6b24c0431c551fdcc5705fef17ddd8260a0ad3afaf92e3e8385adfe20ce70eb34ef9d2d2d0149936a74d627542f65c236ead7decbd9907490c8970b7c3f0054c2b2906ac4361677bbe176a0228362eec503b9fdb15cca11c9a6f2a262bf7702dca97bf6910a2574e47e0c56dbc1b89126fc47a562a226cd1c3ae647e9d4de1bb947c614416ef86116b802d01edceb60ed02e01a542b8a2fbc45fb8fe8a89fa36a0b9f7e0652b71652b4ac6da53cfcf798ba5f73974a234c4722c8de229ea0c8df325d7dbc4176f54e06946285cf66c95a798ca844f1c6d0798f0e193fd8fdeb6d414371571381d9ff7226163cb82bcb49da34cf51f18e1a41666da7cc96fd43812dcb54cdd6fce87f01108eea106d991b1a965cc1f91ed37612c02b8a7ef5a45835c4a8b259bb4c934dbc1ba113ef260cfad94c39edc7076bf0719638cce0444520767db14d354ce570f41b7e907be4d680be7a848953131cd6a881fc9a34530fcef27b2e591ac0cfa7a37367ddfd0b6e6c0cca4f83aa680a2bfd5a2f2c25fa6f04310fb94cc0f77e4136bf4f04a0f045a288a90eb855c75f58a95de734ca74124e802a0a80e2061cedf80b2067f0be8f94a93459eddb05b402f7ed79bbb061246c24fe92df15d0f3f556d1e0bd36725d511c7a6d67fc7fd994a78190934cab938070e2feaccdd3e79e9ad28785384ee819c646b250b972237eaaba9e630128b52224910ecf62a6c09bd600bb3bbc1a7fcb0c61f552e67609710f889316a4c35a2c43b6f3204c37078cddbddca5fc9e2a81d085816d1c3ffe49d5035798d3d3e94215b35f3db57255b464943ece71f9714fa8f0c8f26af4fa3c1bc1b465ea6f8e7e72124d1fa7a6b86026a935deb816261953ef8fc359989494b9ec83692dbd797139e6315133231f0146779e068a0c6cc0a880d70b47121223097cf1a062c218c9019391171da8142731a88a24c1f2d6be568944d6dce73a1be295e023bc52590b92a6aed4287a27b61b8d57d7ad79882b0ae0baf3aa1068b8234d89d5018f00ffa82d9c3403ce265fd1eb1d4f0b635b65dcaf5eca10c4b72b8664d4fa44dde7c44168cdbb712e7b66ba03fba59be6d2df80e4d54c4c57adf157c96a283c016f7a47fdaf9a4d8f35e2bef8ab628cd8edbc6123094b1f16ad3fb57d72b8ba41dfc6a9040c563c841e092c7b61ce7ddb2284d162fd88a20529dc014cb735a8fcd1caed0193815c3111da23682f5c6bd8a900269b3bd6040aed9b6684ddc7f05b980554df3fe6234aaf36cc7470567d449ce15d83a629bec95ccbc54920817f3a353c15eaef6ed1701ccad7cc3da8600931b4eeedab72502f53097c4b604fe48d13f7ab753427c10601eb219b296ceb12618b3378b832256e9a90672e2730c1d867df5bd4d5ccad41c1bead792bd27632d94378cfc895f85fe549f78c1362a7907650f5b513ec0ae921e88666e67c9425471b1ed4dec082ac72afb9bd1fafe7f97400653f686a060211b197a7281ec45268609d386b3e3cd3394de089b61db24d1b2411502b55b005d8cb9cdcf817397a047a34dfbc7e97d4ab068646f768575641cd62cba45e7d92e683569fc6eff379f831310de8bea7951cb89f42308d901c377b9fc34861a79272b339915d98729aa243360a5b3d43ee345984883a83bd17d340c52a676b612181de0801cc1f281324f97a9421790d693d7ac83448dc6b986c6701f3b026a309c2ebdc6427568864d02ee431f371c8c21722a7b51867ccdabf27c00db8565bbeffc543fe7d8526593c9bda17d4675a829d6dc5811a241dfac6fedaf7ca0f49334984c5eed0fb9ff56b4dfc1333b0dcee937b75eb1a8b52f9a4e6c009596d2ab9e10a214345ad11aab6fb57860e8514295f8a8d1aba7d8620746910e2e12d52660f3f8cda5dc2ed5d75d59a903db30c17b1d3adc9f0cf0b421e6f2fb8ad2be533f31758ec47eeebe4e33d0796b2b6a8faf0883b544f926dd91b9ad05a0946176aa45a5d5c99ca0b21702c93cd1551b421cf5197fa14f69f678912faf4b7a2c165a9b53f8af8e9b4b7f6e00ae4217cb45cb897e8b1b1e04d9bcb41667207c9f2f03e799598b7130f89b24fab5c06da0b03c46604a60f51e62d03def40f444cc7cbda4e434ff30e24dd997c72ac6d7fdb1d92b40b89212201702b1415ab8e24a7e5a5bd2a9f4fd3fcd74741f6061849570f5155c35b5c5087bbbfb74daf85b48f1175a851f5a94bb74f30dc363bc0e76239d12ef65e8e66cb07c28e3219977d81c9bd489178d281b4fa7fb4670127b38f9dcd7c4c10aaabbdb4830ad5a50f4d2bf3e07d9743d958f6de9900d4f69b0e67e75788a049f6e3c90816e74ab4eadb6c96abd75c2864e5c1a154b69c854be88608226c17276ea825bba682049b0f90448f8689b948c2922fc96a78af89bc1e45dd07705b9d2e2e6ce247d3dbd20521f4b8649bcc1cd699b9035be536302b46ef45a6ab88f4a796b5efa907d91a9e7e0d859ac09a6d4f8f571bb56c40882828fb190fb9097dd6279f4d3d2cca610d1a3446270164652d9e2e38584447bdcafa3386ef1104529c3cf8450c0b3381857f4e0b987d8bed165806c228fdc7ce38229702df2fec7b2bf8c885f430e339dedf11ccacc71bbfdc364ebbd8ed85ccb86b6108e18301f55e989fb1cfd79ad498cace15f9a9bbfb8122d399476cd4343a70613f369fd610051ad12a0a2ba05be08d3e315df2ad7f03d4e4bbea759a14bbb8887e8fbc0983173882d47fb91095ef6be5ef0ed39e8c9e2acbb950b17d02acdebbd8df1d029081834122eb0f0300466816f8dd4ddf462e67a2545d1d69bf42bba52385672109355a2dd2e5e7f92a5b61dcd2a7a0dd325bb840b583297024e08c2f5d9a36d52b8fd208a2f4c5d5e7e31ca9e0fd60b5ff069ddac1abf6c31ff8a05384da920a32a6bee2b9bf43e21baa61dfd50a00eaff32a2ac1107941fdb25c7a06d1d646947169159d569d4bc4e0f4350e4826c80e14eec78f7ddf9585b3d81c40ef7b220ad7f6e6e10df409517d82a4cc28bc5aa19a4bfade26e1e035a24993ec4dc4e4fd23fddc923306cdd648c5689eda8bf02242538cb54e75ae01c507c725813cc27ff2a0d8483d02ddaec6b13c81d9dc04bec64796b9aadaa388b33e3a5a4e517b2e94ad15ca8169c601987136ed7f5df50c8775700e0d3ca30ed0105e8221928d1959c7dbd76cd2fd5596e34ccba86853622ecfb5cc99fb98d3fa830814ccc619079dafc88571e5489ceaee222bdc83bb5096ca7379c0bebe34b8a1db14c9b415995cb9dc6c4c4943f8706689041b08333cb8b10e78f09d5f09efbd99974f39ae4da836df9adf7a8ffea061446544a267bfdc1c548ff7b2ce0f0a7ea43c30b38eff8c9839cebc773070ab6d37caa00a3c16dd0e12b4f786921e196afcb75a0859aec151969e326c576f4edac7d1aed0358d93c903e71af9390227db8e2a0e9f6b7bc7baf59c3ce44fca48c7e660dbea3bc3af0295923b726ddca153ecb2d272082fb08e4b2f2cafb2f35062596ee57f604bb073f1d65a9f8bd725e94be15617ce6da65cb32a428b2b4b8564f2e754363875400006d8fc0389c44b950927300dfa12fbce4edddd6fc09f2b7724a134240fbfe45a4dbabbe23e086dda2e723f14e4f562cec0ed224f073938dc2f504260966dedd1b0b672ced5d18544214ef2ec882392d2e3c87d2df7a045f68171e1fff375cb2cfe021792dc7adb2989fde5580cee049427d517650c1581c6755c21ae7b109809547fb7efea777c1395f729f05d0bf13da6e3aba87581d10ae7a720246bb377d8b0976de3df48aa08547bb6fc9e733acd21e938853e31f606ddc53a4b2a1cee243d072bbcf8a13be5d00130d6439dd9e7d9d993ad2ead250ffb1cee180e140958ba4ef7e988d944345633efb28b6c01e5bb44a321390f4d9986c7177d446d6863d71f3741a7b793d7f922532e87f07399d06f5a222d55198a80f603567299dfc5637ad6ef7616c85bad7cfb281c3fe9ebe21c52850ae35c0b233b44c9547be6af26beafe3eb9efdf53187e547ea4f1f1d6b467495dd728aeec1b8df33a673408fba8e323ef68ee0f878cb6360c153607480ac39c05ba0962ccdafb54344cb6cc134ce525b6504e901dd9f1d3a61729b16d5e737e00f93883fd506ae50500705e6066bfe7ff243ec41393303c4f9264f703d7e4778bff1fdec3ca8d0ed8a784442e986acb9c9fddd7ea39fef40207dbc02c97f3ab3919ec5a71486b1a8520f1a8e318f687917d8c80672adefb50b923d2fc64255df7e23a94bff7b502f70187c3a8abfd6e3a89e1561a2c1e68e3e3f32adc7ac7bb9ea60c020ed085c09c10f2e800e930915e6381988d83a333c81f76ea14e5c23e4f01fb95f01f9e6e2640e7ff4125d5ed37c970c71e97a2607c8eb1db82ac01a6909f4af9fa32b15a5fe5b5acff88f8c9cc9d2acbca3d9de386256d09add81edc987daff68cb39964b7bfdac430d76644de93b8872b64b8d809cb658cd5c1fab41a16f74ffc07a6589dc8ee8bba81565e10ab43b95315acb7de882daddf0d3b1451487ec813ba0181fc0f7ce8a8c0ed39fb26381ae92ae04f1a5580286c6f1e65a626a009274f6829b6d24f737847126ccafaa2305db00dae8b059d8c1621b6c801ef23f241ac59889d1e3dc2c72c8d8fba993702fe29b60c65e3807658940ea0feb47cfeed202451445e7c0e80b5a63f43c75e0586db9f8656a971ee4aff50298fc3c7443ec245a65e306e4d3bf14a6214600f558c013488a8ef7754e15557d41af0fc914459df24951952daf99b3387e5cd71fced3e7eb47dd6e75906a6a6bc717cd0bf8ada15fe683d45babc4d3ee3d57065effa604bff0963313ab51bdd381fd69a294978c2fe9f6f4e81210f4d0121c63bfeb35957e3b90c450ad4abaf3232d6f6ff2cfa5b1c048e5f2fca059c3924adff437592800b6d2637cbf61472eb04052c27738b300285c127c00d64f46413709642c53f90542f217f30293f2c0d7219497b203fe1cbbd4f98730041957ac8f1642605f18571fd9f47eb7090b346bc5defc19ad29a334c5dd760b83bac6f6364fa047bf6917f6dfd3b3c0e58d07ca80a6b837a29107ebe5dfb3b24edc1e57610ff6bdbf769dd2372c75bc961c872efec257ac7794f2afbbe3a89a809f7ec410ba6548f0c73e8bfadfd9eb89f9d4d75c09a6a9126ab698308fd5aac20d7485bc3305a5421f3ab164086f7215fef8744e6872e29d3504b1417f27c999fa39d8c9a4ec171f7c69254a1bcf546a4b8000efcef874e8a750df754a4ee93ab3a5faec529736cfd5ae710fdc7b3e86c932f0e8d69095b4d376b949f5a95b177c71e5d4ef1912c5b6a22b03189ee6e123d94ac06bbd30ef104971ec64f01ac5d5c71f4e5a9a74a9e9ae726ca527d8a8d87d800c2366688b9484ba6fc2c8ea0ebd214db2dab8b4f041c08de409aee8982cf09758154e59e85bc409ebcb7e4c68b3ea31065440e24704beab680623db7090523b459b9e97778d9a6b460e760708442483fb14e4af08d2939437ff52949ec81655c958fac98b45d3999fbca533e26abb09cc059eca1149ef868f9491eb4f70e8de0046c8f3f89d4c97524292d5045eb83d092c8f0257e45232283644015ab5257fe0601e67f3e1fa31c2978b9bdef75bf127a5fd07d03785fcf7190919d2bbe2209f7155f38cf1a12e2f1480739e6abf24a2df9df5c592282ea525c8d8848246de1023fe9425593d0b6773ad842c9fbe54c71bded9e8c71a3df10812e51f775ed58960f9fbf4186fd998820dfac4b77237a15945d59bbd0cbf05a0ac0de22b05aa52f87d2ea8e9a4fb449fae29940b1139b6c93b26b586e3a15dee77247edb43ab2d8ae3b0969d350d9116b666f2755df8f61c2988fd44abc353aa38537330190487b9ba427b740ecedc019415201019a39eb571e67ca4ace24245dd8e6dd3a17184b7ea54234a4d28ee05585a5ad6f57348f04b92f2d12038654034c71cd4440b96c276cd997b1d1722dfc28c79842bfd906142977a14de354d174887288a6b56727127e6a3a4ddb086f0e0e72d110f906a777278094b3dc8b948608c34d80683faefa392adc4be341b133fbcfed54f9a5f8331d8ee2527e980988e58a19e99c828d27d63469d215e9de61a8a434f52953a4a11668527f951932e541e07f6b61cb27a56a27e3f33ce247e0696b6aa8298e9876ba9b2fbdb790213119da916ebcf9b0402b160ee134f489560fbe99a92ee5b5b9f8d3cce834abc565f764d983af178fd6c00c886139fd227d739ed226ad15758962ffc48fb75c8a6f6903317e4035a2c6ebce7615aabaa15d7b674b6c320ab6b064b2dfb7c0f42fe0b1eff66b3941446a646fb4aba32819daa543141c5c4b59541327966e987804a6f2e93a20b91f80ec2cc47d55a5a4d7c2e09d408174816338b7fb690662e0c2a99b88298d08ffbf468e3c724e6b767706ef57e404d0390194f0fc43ada66bfb855db3a8aa37b488dfd11e629573ea42cea1e89988bbb972613a5079149eec397fdca63bff42a1f232920623d548b374322e5400b56d212a59fd94e0fcf16497942ed5ae5f43e8aafeb1980efc91ef1d3b8d8c9674433fed7d8d34afcc8568f0bef65ced3f3dbd307ec336fd345acfeb664ac143bc110538bca9898dfe6e62b318adbccf2ca9eeb92a159344277e909baf6bfdb78d1834c931ec405bfa0bf75302d73df88f2b1b6378b5d33c1c057c5daedab380cbb6d2d52384e77b81093bbca489b638362a8b5cc9c9793d7ee41393391e17b55042ec81f62fa479018f68490117c97e6bd72f093d3f51a2ce462ff05bac5a3a84f0b40d1cbe175de2b8b2fc01f7b2e27c5a71d47ed7f3c462ff5005a402a895469dc8a4179d9f9e5e6446c6579d5f7c990816e788ce8a1afe2c09428073962ebbe8e6b04cb6a2009196e899573283f634789774918c9bed02bc1103a2293046c5ae2a13979f3c277b444f66dd35ad5db270ddcd30d090c745859eb389d39f869a213f661040fa9431a594e53b10bcb6dc32845c5b7781321f3af980c80cfebaee794720f9439a2758516859799c391e18a6b94f9621b9ec3afb8e781c992c7ea0e0a9fa03e1e44e3445c99b0e8df2de043a4f1a42af4505edf91d3e3be613a7a9c97cc72f8f6e3987eafe654b285afcd21bf5e1b146a9ad6fe8bc2621c94db1fc10c7fef5ac0ea6b74c53a2696e32af9873c17877f17d12fabb196cce055a643a7c311e7ea1a18aac39e4eb2ff26e511074be13ffb4c571ede1bddc3fb0ae38feee4af6d846c4b83c403b7a7d3f6111b58d21624261803784f7cbaeda7c004f9f5c6c4889d87e23c025cf51a3e01b1e5edc5de84aae09850cf1c651fc231d979b7743ca643d0eadc85cdc4b1743ed43bf928a1c16f61bcd7d115fa4c3ea8b7637cf3a159512f6182993b442be42e230e62c72498461026cf39cc3bff456175b5d7a035f349803fe10b778b04b2dfecab7afef07e32fec0a52efb38ba2899a51fd085466d9a11474ff95c6f4a0e059967bd038af279ba99e542dff89488037fcf77c8f747b2d5e1498e24aff9f05a27be08699ad45fb4812d800eb79477905a5e8f59e9773614363a573886de7e7623ae67a39d458518692902a391f95bbe3af17474d3d6d507f587257a171099d1ba9d29fd719a5381970c6c347fb873402dfe691f52597d2f98f9020985da89480033d382478c19921072fd10c3aab71c4d6bf3987332a6e6306ef2c9b63267bf88cd83a57a4ca8d9e215f33fe5dada5fdc8711c3ad2427893be9894c5afa95c2118e5d2b4bc6c543a336bf8a371eac04fa78a49e24c10995145e18bedcb61af690223869633083fe3e773714e0394159fae1f6d7f3013dac31a5c5f6eb71f67fd7199e6e69b494d5024dfc52d14db194e016053bbc237ae83df17d160ca363673df51d9e2699a506c416018dc47f5470eb5c807ee33684002e16b58c99229fb9277e602e21f92f88d5c9d6026b1c556cf83083e52fe82bb009d814b34e8ef5a6d9f547715e70c6d3fb32480d117730447849046563e29418723495202d94a0d540ca7f46e0693baa29e9fdd591ebde843c06fc25fc17bad8c7ee07b8eab74fdff0abef8de342cf4aeafd0b812b73431db45ec0de0ce5d2bb3d47dedcfc134e01f175de48f344a1ad5ffaead6a00981e84173bc946ca738fae14c94777ef10b49139944d723115c2f9c1cd0b74d01b0fdf5557ae99aea2dd4e4b2465b84bd7bca08951c13011b801d941f8e82a6d0b9dbaa50f6ab1ff625aac54d21b53420808a68e5e7d91bc4470a1b5d3be4d9099a87efcaf9136d079954ac940dd03f0d4d75bb5d8365a5391b697260d1fd1dc4815a80f46e110378c6a0ec140fd4b5365575e873a8c24626c3cb8fc2731252477d429eeb582f5c3a4a715b71d2bf647098a14a11bdfa13d4a1ba1aec129b65db5926d607e47bb400c20cbe31430d2e8cfad387ea3fdc64904b9ee7437da4e9e951922cb0c2ce3ceebc4e594fa52bc3a2676f6a3f221b0c01d7fd491da46f48b7657d20b8dcf1bcdc6514ec0897de01430f651cf437b34a756e5f3dbcc77b1422db9bc4edb664573e861f968804360303eb28ffa04b931e35e9356dc37be275f6186f4f5c6a51969451d608d3f246d7558772869fe047901c8b5ac4d7dda52816335cce0f8a91556f72af5b5194ccd0d38009d886fb03c47670869d1970578d98de1c946154e717410a1b7938c90153625413441f4bba0f44dda3f2ed5102f2710abb246699f93d6e89778b258a36fa7e6cff42ab960c87ed28702a0498a0f4f1a8db9eacad87e40616d91cc1b4d66d8dafda99f133582cac3690f91ce1a86aad5c03fa4e941fa3598eb57396734a65071f0ab531307729af4a680bc8d452422712249e4076a46cc850828548d97ae6e13525cf71a7f886d44bec289040a10ec4f15ab77b225daf462c88f27c4bf3487a43d8a628cf527d82ecd76abc81e7a6a9435e159dbab12a42c41b9de5078c7706ec8a282d0071eea74b0629ef2a1e8aeb501fd7762ee09e88111552baf0139653b62d9715d738d64c20d2bb66b285ad8a89fe6679393e49a5915c7dd64c3b32f47c09ab239137a8919da93210badfedf127bb82f816a25b54d247a7bb218b8092d93c6ef70683ce228f457f1290cd5f55e10beffbc9c8bd0af5b8d2112cbf8ffa4b80be0ff9083168a3a73ba3f6e569a47658811018f98c17abecd37f402179ab4d267a071ec49f540b43ef987ee6643c5354774095b28c232a710a69dc256b70c6aca09447fbc9b0b1997829587c515600a6ab2079bb061531b7bfece7c8e1de951ef2e497bc744db0d3216a656cb9d469f17e9510882a01a000df060da3b18265c35d466d62538e4261deeebb561fdc80949f6793e075020e0882e3be8019eddee19d88fa649953efdb14a381aec239154e0d3386e8bd777d367b9d4f3176fca3f08cc31e6c6f9ed277f95c636c59fbe78015620a48c39e74d46ac468e8eac132bc360d4fa5f03a8a6fd11e05a0256f74dabf836440ad8dae63def90ac434d2e88d41cbc039bdf5f7a36a195de74149c276626b463cd3adb88f9732fd5f3ee6c6356d3c4ecabcb209caf5bc776bca4478cc52a2688697581db015df2e96df7b066d864d491d6879f70a10fd636bcbb1720f31adada4d2addeda37e3a6e45db14f418772ddba3dfd777f66dd9ea31e85d43be3267fc536b7ed52bcd57e2e52556c9330f5f24c964679ffd7419a30b03d735b44d1637ec64955d04f1cb522e0a1571656b24281109916de79e6681b1c59268493a8856e4746ad9805368327699505e1ef5028ba17671d371bfdf6b3da6772b2e3e9efdadd29ba63ae9e233c90a204b88850538c543b73e3ebcf9340763342848f7434327ad2d3e6159affd53b8b29a3a1778a1a721e4f236a53f5af72fb239b731b93811419af94b9fb51fb21983f9712fa5d550b2a6459bb81584737949552e2c78be6967bbde5fd287392a8016b89fbf27d6f90973bddaba599d117595b9c8076ee0a12bc334b9d3d5e4048b28dd1f145ed993b2046bff0643467a74e33927d62d15e1a2bd130fce02e157195b891d6f82161ffb94f249fe3025151411f103288c660b267c32fa68b28065e03f1f8d680f1e44a36bdd689b1d22092dc0ed9aaee2501bbb9d1bb55d72c114c50809bbb9ad7e6d94f2cc71bc7c7b95db05250fe9b98c7a1ff6af48e4263a0ecc11cfaeb810e70ca37a210da6bfe8958f854ea13d9876cd6738638c1f165379afcaeea86f9a6fbbe5250d8de5e8eef99c82f9138aab4dbe22973c39a75ef80fd788ca88c9c315113ff84b93d7cabe93fbadef7d848890b7123ea8654b710178239cba71e2da92fa7ebb0166c8bf6c16033f3a61d453eb06f54b9477806a6d94437b820bb70bbc0ef3a3789097bf2f77baafc61bad63dad5320a23a8beecc4911ae9167bd98439e20a9e7154e5dc167c7d6de1faea5c0df617cd0488a41847fb006061db59b27dd8db0bdedf9ea33825e84df46cc4fe35958bcb9ce06732ea6f1ebecd0fb4a8bbd98a55b49f091efc615948b43c0d642076b83e0fcd3cdde8eec260edc52c8dfefd9f7a097e00cab8604efd3c2dce67816d5de060b422f1dd707a31a66900587bc876fc874c69f50c5f236b827442f454d4b0232479cafa17b7694a2cbacd85b6a4eaa516564ffff095c56860bfa57e708a14d0573465ddaac880173979d6a5beca100e046b0f0cb1c5b8b1df7b76af71a50a90bb5f058c24409769e1f879f24ead278f7d273b83ddc2856aba5e8b6e0a535f8c1d4b06f5e5c3dd8fd9b854ff677ffa2b9102063f3c07fe0b92e58265095b61d240e0fb17c658db5ac0804a35347820498300c003f87fac2f7529269bc3a7de7cb0f1d9f99ae7d0c730ba80b74e70259e537e700654d4a88bed47d0504e8f5e6bc5c4afe1992659a6c78b1de8c6be777ea5ed860fa5e7958a11932247d69e1d34607942397bdcac8ae1cbeff9874f37ace8fe7e13bf857dbcd34b3820179f98e02fef7b5386d192aa88003adea3a348ced9b291cdc18304b9f0a20288784cff459ae3a4355336eb2392b219910ce8d8a54f5f75ed396346a9f1cd2307ed2981e43bf299be4f6b05be1062aa9ed75ddd5da55950080bc950f2a20f38010cdb4071d1e459279d2d3b14e236fb355d78beb3882b226a24a70fdd2bda162ca8a86654780613b11b0e4a7d5e060365ca3b16cf235752c04b9e44c80343870f30eaca81534ab9b58ac6f6862e9484019296341be1d8744be3461b6489615ad25207cd30db0ce1456b206acb3a94e17092f031ec61e7d8eaf3336914e2317e71cd74ba8ee76c01fea1fd31661b3ad5369b1a57ebfd8663945737b6aac9b5463208f99c2b9b2e68ecfad0a7b3be6abba0510c086f4f8b847f1fb65c1685669d95ab96e99002a4baa1e98efaa3c3bb46476380546f06651dfb81a7734d265eb0e9f25a5ebbc0cc4aaf99b964f1ab17794639258f7fa67ccaa2499a85bb8495f4f0bbfc7c5af3c3f824a524cac1c6eb9bb80612efa12b2501bf1e75a6c46ba1fe8fa805a197d658eadb70b3b32c869c096789339e65cc6b5fcb17cc060a2f41d1c92ef3b7a8d4d661c68dabce56a4dcd08d550c9231ffd4031bed0387db4483134d8f9d64f14a5a52e4092a0f15e339a18db84006551470d4de273f204f54053145cb7e19449f338d065a132d8df0a10584ab25c13160a8471a13ae5f37e055a13496ae4a4c5cbd3c8ca13010326c6316b4067f119329ef715c3fade26b5b42b6db61004eb941fa909846a4cdd72de5b88206dfb22408af632d6b557b4a4e1861f82f5d11e1200f8027ca15a4f8dc5c919826a619791f7c7f59206b9e112ca70b93e0231c4c7bee1149b826a5835d2c939c116b9a91dbfbe267c40d31d1c94888bc6ebb436aa7caa4f3e90a95fc2a84d918426648d54b0241d8ed907ea0bae2d4799500a96fcc4ad989296d89703eff5761b9d436479a90ef8b58a8c9e15ee8ca9592fc7c5fe84d869c70796db7897380b6322daabb1c84a443cc56736521f746af23d1895544615eadb7a1b7a16b662c5c177c431822aaea1c32244e9f0d2241eb1395d80993baeac664ca9abca7e43845c9e111931fed1b5fb7cecaea5f17839ae40d00ab8d8b0949618bab1bfc1d79df35832c8b8de43e7f1c410e947f476a8e08d29a068e4f8c48a325a640b3c25ae362055f748be8cdf518f28d67e7162144c66b37e092366c76e6cebc1845fcb7801719f8a01fbd20ab6b70c8c67351e19b451da348c0a7a720fc74675542c1d9b1b17443462c83ea9a0cfd8811db989eed92f533982791d2768cbcf3a5d3eb6b0617defdec89968e32223455cf4d39d7c23f33e22e899ec429f94f3c0a61c48c5118b6fa0f102412b1189d0307a06f53266ed28734b343073142516aab72904fbc12440e00f11f9622575b680a8c19ea1a08d0d489a0c7663d1bd85c3953552b202f172d697dcc29e332f092a5ccae2b6a8c3f621d5b2f4055a8fa17dd0fd470223ab131664ce7ec7b2c2c1308caa94344ff2ec3ef5aa20069c5e754c232959b92e529fe3b8d99b273c35fb3dbb27ee1a456a860916fd21975b819093088c757dd3c56defeccb2c8f144de72f1e79d0badb3ddae59fa9d82f54ed261243a9c1b24623ebc2f7bb0329c6b161f27efeb28c2de6e4511abcb3c3b9cb668b92979eb895d8a19b768647056d5ba8b31fc4545e1b7ca26b14809363eff16bd84f43d6df2761e09d1369fecbdd54f301c8ed917e909967d4013953002f30e09768338ad0ca2c16117282b1c4b7f63a7a1f0d714371674f2f9196168b3aec737c5dfa817ecf40e9ad46e7ea3af16d8ba67c0a48af4b3afe2a0269aff69ed415de5781cf23991189dadce120bc46ca07ee1296f4c2c3747dae5a7c140ea5dc413be4f2cee860783d29c5dc698f5271ca1aff886006d0037b0201f900479101dd76020209debe06c60995d4cfc80bd4a1ea5b55ba9c365da8cc887dbfcdc46ace85ea4a433b1cf55d0f92db536453b360d56bf9142edc15cff61f39c68ec5ae4e9ba60f2ad5b5d22ee52c78208e303e8e7ca8ce70a06714f93b0c08e8cdb281e3638cbe2eadf633e43a0a629ae57bd490bdb6236c5ee8d5932122ca63e3cfcf803694f90eb215d78d86bea55a9ce452f0270863d1d7946a0904959ff111f2969f0291d89b7172587f187cad71f78debf536c1acae97315ceb482ae48f7e82bbedb825fe10690e112241c40bf6b59dbb8f2b82b9b4a3c638511b96a6392735a014e0660a445f39436cf3b1f17f839f2e9ad7c7850682b99cea1fdec1efc12008ec82162116c6e15c244b76532919dd6cc6503d792d28c0e41ff2ab183253b4ed30b96965b722418af1181fa0d4691d9e70a27a26c0373b33ba583907a7450a541a403a76e7cc415f78c6e5ea1ee249173cfbf370eb5759df69f20a3a6139e8b6989ce7a01976de958b24de544927a1ce8f59aa0b13c86240d289bb897b1ee31705f501e3cea903cbb8a2a563c56ffefd6489298e06e6c366aced2f0e35fbb24d7e724c57baac543c9905e605ba569fe06e1b366e2344e0739139471435d89558dbcddcb78b5ec0eb89b4311ee6ff7c59dd6eefd988494c83baae414709f1f238746e23fea9850dc207c38cd544ca0e828728c0d97b5d6e183f57f9eb84a35b9b0a9a6827647218276b17824fcef24ab5b79104daad507e62878b31ea6d0629bfe3332731ea5e90daf5de6cb469f62ae64907a5855830cb4e50809f9d1d86c22db81ea5aa33f8a74064a5f356c6945128ca594c4e61f77ce5c59f6384dfe4947da54204f239c4e32632be6efc4b2fdc115118e3db0deb2331a84b8ee1ba1c6b81611430a33b96b9d494719438ce97fa4a3e3559f27e14943d3490b30010c63226c47dc42041dba1b17f9dbbb4154ab427c3de692e4023850c0115d0401d8ca06fa327e2b11ac176cca6ade31d4c23b21fa82edf8deb4ba82b6dc4de95d1eeb76ae9f83353aa4cede7a35630087b7bc52303c16852e4d46435f4206dddcbf1ba1fc4bc37e5c714b59fc9ba4fccdd10525f01e32d5879788be12937f6faece611981e808ba3d7fd1a0650777ffb04eb6cadfc74f9e678bebabcacf42796e7a89f2294894b0183ac0d514aca71fe43359368d371bd407fcd96c8f29770289433fb08f9dd2ea75b5576b6d6f150cc53a221a25e2099553b430b179eef250ae53a9ccd767673b2fe3ba16a87b4e493d27c42faf309203ad50de346f7cb3dc2b19bffaf0b3b72674f912c263f8992a10b85f6c30f0e266ff3f434166f83e5d527882a6d68985624f62aaabcf54de6238bb80968ea148dec2abdaccf3639e432d2ac079eb2dd058bfdd53a48325a09b1bdb7dca29c88443176f464bc708e01c24d1dcefe6d544c3444ac46fd5b48019623a9908866699293864f1bcb036d91c9361d92fd3540482ba5a8d8173b3cc6266c7dc3901208209d9c8fa93d54f2e5fa0f898b8a38221500c208a49f05830c71af1813c918aedc91868657a0f77775baa289b52820601de03a180a9dcbb7a1a49a80a99824782c264da7ef16045ac2fd4517f859cf5d001aa0e5ea9657ad0231feee2f692da276468fc7f117fb0a8e23e0c49fdc4d783ef4d573a043519285ea63dd10e4a2c60fcb868e006580e9434aa21003d8c21b2b49970a907c46d38c6994d7e4fd52fdba680f34445c104e36df52d6c40fb5f0957a611c4e5263a90274da92bcdc01473885755bf2d56aff765185656e79c91c9c70c2fde135163eafeb9b597019649a5d7fcbbdfa9cd3d675d8e6e3e62014a1eaf3e16344733958396d06ec170954a9782ca2e5e2e4f5cf828b38e07323b20b0c1c40267db10ad6f79f6aa5dfe8f14f64b753a3b2581e03e06882d161ecfc2dfd4a27a21ac4aa5b770d19eed2c71ba79b76810a544c8faa47bd78defa29ea344f5eb111a10e17d33eae7f9fbd0d1c101832c333475149fb45ec56c02662d6f5d5578f19f5d85e2ff3b768db1088ec08af456cd98162bc9ed479c9bbe0429d50b69f19a889e41d09392a310bdc495adc00bba7b136a24b797d7edb684c910681802af4cdb68e0d41829b214f9346dfd32dded98d609eb0eaf8823cacc5d24bd9b9a5bb34a1f224b633acb0a1b49e85c64daa830e4fa9a05e57818a250ce6d6be69a2af657bc541cec87b6967bc86249850e064fca8afcb866bc3b1d260d8c19728a7877c8a873b0119b26c6c72411b311aa046c575f1c971b485e5529730026e5cca2a33262e4e4b1df14cb18a7ad84238b8f15bc52b7063b090a606d83d69064824008b7f08b4d26d6431c676e77f75b6568422538cdf5b3619813506a649e18db0c8ae57c87b2eca4d0496a3c6cd38da6a6c09f93eef14415e1c3fb27b03876f79b6d99e996cca509067f1d86b504ab3a9d800930f57fdea24c5913ddcbb84900cc358fa4f79ed19fca3fb99b1dea32b44aeb9fc89b9fa06f4479807b1f3eaed543202f0561fd506edf0b886940fecf795f147f6ffa82d133dad45c396f23719e43e5d1d365d0df3dbea301a176efd6bd5b9120360c9b523af89fbedd84300e19f93e4a2b275a5e6cdac0717e0b99d8931da9f8a91d1e9abd4ffa38296eb08901b23bd5021121e0d080288a24ec471c3d4597f9954d8cac4a7fab7b9ed52cd8d8f1dcb416a6468bc92752cb37c8b50c1d10b2148c26438720ffa5f3aac50f31e16efee7eb78aa9a977118a5ca7a8f1543a7ef748891ed56eff34baf11ea8c8487d1ab86464b063092115820dd36e2d69966d3d766cf21bf894c05b1a461df2b39e8719f494b62513c8a513295ab51a606aafb2af2b7a5f4acfa82f9b6945266b570d00efc65bb99d9695c183b58dd20846a80c272afcc528e590c010dfc795529bf0fc58bf178fcb1fbc649b1bc34254d173eb6bf30eec7d54df6ead564e2d23634af31c5caff802d0df0354d9e2c63e4e6763dc61e80d3d81ca09912a587afd0f881ecd17f192594ce9f346b648bca7bddd1a9d9e4e23e09a3493bc4964ddf2ae50a5627802810209efb221fe4d830f62d7e37149689d7df2e54a3cc4ef7d4d2565ab1d6c066d7d83a6bbfa79f6128f56a6ca8cfc07d403d8fe9d9684c2fa2cd0e3615895115b2e4077a932c7b57ec4cd3d93d47d3a7e7ab1098b95a383298be797779d1efb0e90e6c4105426f2048a1d1db95f02fbb8dc9055b01acec41406114087ccd74bb4ac8f3e3806321cb67f82acb2e95459c27e8574129ffcb68aff7d56d3c10ef456105a1f3b3b959bd03539184f84926edd2517b68b8084336b258559da4cfba5138392a9dd0ec05183f7f1bdd2fc6fc75ba753b2abe65f6577997c04a6160592cf9272b7e53ffb705df6669ace7dbbe7aaae1e424bc6bfb02a1928163cd5aec773efa70dc0d711f3de7ca5b9b3257a5c0a78320dbda68429337b1b921152410caca80c78bfcadf49338f73df627368166b24c12b6dd3dc9c178c333feaeb8cde15592cb496b0c844e67377c9f8af6638197e9e1f791bafc66e25155802c6baa671e6aab311d729d69a8d86438cb35271685f25d36ab4951717af8c1f5989268faf50237906103b338650dad70ef1555b39b50b6cbed88ca980226c84484bb0740040ede2b533a9d720bc78a23f3b4f60f6af0643d5c703c6c4e79d31bc9d75a337608dc474f255e6535881be4495988a204a786d52665ee3dd321f01a40bc59d5bb463d15fc63f90e85a09b2527ee42e263aad7c2ec2072db7c2ee88cd5681397a1549b4d68e97606616dbf9cfaa96719ac7ff417986413180a89f7a07dde7019b8f4dd983913d0cd9cd916c57c76f7e089907ddc8cc823a14397a5901d6cc6083b44e19fdbd728b829d99468ffabf48e42909fff7686e336a67463ab4af6cf28ca17f125674f0eec642af4d70435ced842066a6179834f5659a812976899fad1f93c993bbb1632464f209bcacc24eab12768ff7f9850aa93ec63796fed2f0b4ca33982b9b2b36367f75d25c6b31b1fd95a22d7ba7f33a9c8eec731ecc96f759a608a2cc045828e43f4bc9bd0768928ac4c0c0b681f2f1ee4145249ec0d601483e9e63eae32009916b9be2ce24cea081c4e2a8f108c5dfbdb25079f24e2bdd21d1e1d77304e61f95797ce53d32627ba542ff47c5477e519a3b233a9b106f1a7fbbfebccedd5004a5f06846b022174b6dcfdc7b421415ddd49597a3c7bb78764d2e6df16f20df277387dfe09fc6dcc1bd48e3a89589fcc51aa70878d9fffd85034063caef23883ec98f24e70632625077bc4344f1b4937971a6579cb83351bd2f743a422b70f1e0ec02445d86b7aa3f900d30b8d4fd3eefe5c7d24b8f36b46e5a82525e16db09fbd0d84757bdb5da06a18075a519f643c6feb75e78bd7e04cef0562b44ed875db7f8e5efa2c6fca03fa225de71c6624ef0963bea9218768806604841bb60b16bc923162d0ce4de70deb545c758f599c08bb9b096e9952801307a4ae6c6ef749e33159f6012d5177082289d81fd8e0ceb970c7e7b6c0f36e85a67b4be844e2961c9f1f4c4639b3a8df4d916d6483f81dccc920633e63da70fbbfd4b4c77c2a07465721b59a37a65e77c157827ffdabd2047d1265b1b4d02e35cfb4025ac0a9a437b17ca2728c3b597c265dc21317036d684ccf54cdffd855d1ac65520f8fcb6c76e0829684fc76fcf3d21443fe914b4a19d997d5a0e4f4ad8cb70256005366dc057d4c87c7a4292804cc3fcb3e03958d09cd88a035bec62d749183a4fa51e783ef8c282a6d23113f7f9c86481e1c22b193a42c076d6e1bd53ee9643ee6f06d7a560e109f8dd78c2917131a12f243ae4247a08f4b0ebfa5d4117dd6cf4ecaf9cf9f354459fc00d7774685162b94f645f4915e4c4bdbfa65c88ac4f60b4c3ee5f8b3e12a02b3b2e93d1f46836a7efc9880ee421c69ed64ce1af5e93c9033ff51eb51acda31b0588ab8cbb08d91b14a6234f8310edafe1e05ef085985b9eae560b4ccb8f5e94a341c82440251178d28dc848995fce5d7a22be5597a60b4f75374787d73310ebf2315f2855cc03bad907b60d87dbaafa9f5f1d55071a36fa8748309d16cfe161dd339dff3f854eb9a2d50b0f7f73b626736a93e6784970315b6d80fbbfe189f10835b5a722d36796c1205118aa37cee60285d8a5e0691d402897349e27952247e202525ed9510b432229e186eeeb360dc16a0c89b953f541ef701c63e6d0897683ebd36b3d17b8bdaca9e3da60981a2686b01e33f97cab53c5a5220789ea1f588abc3408036bfd7759f1019a3886187ea6d30b8f6e62368d70bd29ba18efcdd1a1270f5179ed70789da4b570a4a8be8af0d234044f3889a4e8de29f5e4ec7e760c3ae75a436832812babd78c7b795ada158c1b16eb95ca623eb243d88d48967dee977ef143ae62928dd33bc32a6d3d482263975a3bf387d23a9ffa716af67c2d94cfbea2f0693c4fa43184d271495b13eb85800561f1f705f35a7064d581a7093cb016a3c372154ef5507785b855c1f89feb27e099023a6bbb2b7c942a4476340b8009ab3d0e6611bcd048b558f64e379ad0ecc17898745327b2fc6aa47bc36a5329aa138fafd94c62b6b4e48e7a3df08e1896e53590bc513521c96b6aeba68d76c101957e728b28f06e033f3945e4db8abb315a1a9484e541af6f0d5eeb53475fd592f8844d807265b3cfccea5e18f010fdeef382d87af2034ab79c54b7630bad1b32b0a95a4de694a2d74b5acf4fc2db8f7569186337bed0b5d402fc1f46d9d95b400af4d3d29ef8f51017fb29434c78f32ad224a64a0940114993f6ec887cbd9ac602af1c7b48cc0bf5e61be4e99a16eb35dea862f49404ddc54d795228ee0a8ad6e5a02f24fb6561b59ce05700e7e55e7c7f2c4add3de525a9879211868b24fe3c606ed31f4c44e46c4bed2dbb5ee544a429ecfb142fdfa64798b29760638d1f1747307a54b677e14b48ca4d36e3c9dd7c34145724bf5bfeaa572bdf38f466e57a9af74455873d81742df46420da4cffeadfa337eed447b011e38ee07014b64839b3c8f24f6f4717d5902cc58dc11eeccd114899fa9dc683e8f4c6eff16287e7b5c58cbee954b094d905ae4cb1f53572c74bbbcf9367fbe29b63980469b7daf7425e9003388a33c3c0d3430dd20093fe0ea000e768168d214e68431d1648a642130ee142c867bf311cf1400e0c265f9a6cb271a55cfda0c27706a4f0cf86ed08bd15876b93e0a1d5324a9837a135a8ff84ce1c4df231d9ee2cb84904d776c740bd53c0e09ca27154385a8afb1b9d8a37922a2dd7a436b082e15665fd375272d9581c5773dc900873be324cba4a75108c65b8863236cd066757a7b10414476cf499c6f7f9ddf5b19a64c6d5c396075e0c2bb6d0352a7768ba11da27dc1713a65c5287a353ff7c028e28dbb14323b8c3d343947460601fcc4ebcf17c34621be3fd917016db0eefdcfe34b7abce0529f012b69fb21e05dbc789db80c653424e1c91cab5bb8daa7e4224d74c0f87f540940921176f4ecffbe16356a0366fb1107c34024affb8e112d7518b1b887b126508e47062e3bfc3315bcadd5f71ca008882247bb2c344229efe7c0de805f75974331ade020928575e3fe706d44905a79bb55cadb17118e4665ba83a4be2af48b21b4cd6fb3603d94c6ba4b91f3d5ddce5c5ee4fae5fa33ce2a00d0b943cc4af8c3de6ad2f433142b37dd38e69e495ebb07a02ca5cba295b405b6728dea83eca2d2bba13e83eb25d7b02c5e3ca599c03252485dc2593439bdc32a0966feeda70be33ce987075f5afc52ea0c8418a97c55fe3cebb41bc0b0fd460e1bfcc8194479711ba8f8c1086e584ce7258fd17c45ee5e67696aea687b5389651615f267965bf6e9fe6c6dbd993c029b379090670c07f0daec3ea71b4be3f6d6dcb2d3a2f7c6fe581763fb094e6fefdc0c5aafa29882d41f21f892f5ee47185ac7069e2ebc099e0e3b5f277b84e609346766d2cf8efe41cbecc34bf618c62e31978a705b581f38f346647dc0c08b04733a4ba4557fb764aa1be2b027c95aa851dbea34df22df6b576db9a1ac4f08741d8d96c86dab92612bcd374ad232c70066a2285481ab5f679d5ed0f58e0ba005ef7fa3f6525b02602865ec3541990d6a1734f648071a04f8c603e07c0562e22a48e8cd53f0dd510e7a92dc0553b810043c5eaa6c69668e47a3519aba4c65503d23f4e2c21b3c66f5b90e1b8d450fa554c6091b40126e7d532b3665f9cd665c139483dc3ecbd538726422912155868d491052171216eab1b39123c437d3d73e0dde1d8a2b49ceba51522a439d3b4f6903d859a2cfe473b9e2b24625b836d1f0bc1a1c3a2d09cab4edfbab8d856c0a411929aeb1b20855a7093a4a36c60a0e97bbd2bfbbd3c61c99491a05bca3bc2677d3d32cd3a146afeac6e3808e39adc2e61c73c24d4b2dae8bb8c71f4748dc69e49c4d7aa49ac9393e5cd070998f27c852dfc302563f1648ffffb563b7f274ec74cd82728d46acda66b7348052c0b61770801461c415de4a5afc351c25d8014d2fd91a1f4b164011289b042c87f753e34a618ced9a4713bc7d7d69f4c880fcb73bcf35835ccf8a989ae48dc73b5ba6eb8127edff3a1baed24273be72ff91bd1c3abefdc1379fe2e73a8df1ab39d33327aff06ac76237a3c4161cad7aa9491e0eec053fdb1972208cac20ffb30c015ab3b4a4dcc84c6297229a44f26c6b30a18816fb5b8b2c5d007a0271d9df394750753f857a107c163279c04899e9b08e616b25fa7d91405bd3a05cd547bcdc2d7cc244c6f26a367f8c1bba90aaa5faae7e4c3a9dbfe4a930a5b1e475f6f5c8023806a25fe905db0d3aa18493d6db3bd5b75f11af4b4b5afd1d69f5cb3f3fe4215a47b86aceff9e63c7a395dedb3ca44f4affe3968f3eebe670752d24e04ed179184b1b0ed092fd89a49f49e12dab604b9212a7996a8c910139d71b27002bddc78ae84ec1b7c2de1c96b1c200453564d0567d04f0e52f924ed87bf385afe9958723d1cadfab0d218350c022d51470fe2fb5dfa9f0be88929147505720091513c9948950f32d8abc7704505403297e76459c8125f2d4fe9d7e2f94af8b416488d056cc9120b1b1aa7caf7e331f8f0214614fe6daf810de7422f462104972ef8e0f3deb260e0882910a16f82a1549c6c55698ba5f29316647056f1e210dd7bd7869a01f0e4abb13a1f6973738290bcabd3170c23173e4d69d94098f193bfc8b262ed2251fdfb61d3ec9466da9aa266c4302ba9b9011c064fda68a60234fb4aa73cdd4bb6bdbe356811735faaebc784c5f97de6fc90e16478b8cac0cfa73bd5c65b8778b3ac80a4f89b80210260faeb5e016fb81d792ce53965ab4e9fb0a1a2575c47ae839f07d1798c8ddad6f8546a7504c967ab06d6bab697d2ced0e573eeadbc012612bf0e0356b7154f191ea4e3197f350bb6e050692e5866f2098abcf5ea2af16a7acd6ce26246d4329175589100bdab6e93b1febd7a791591acb51cbee9ed492b01be8ce87bacce2000f4faf188742dcda895e8c9da33cd9c2a6f6191ffa6673e3f77349dfcd74d023942bc13ca01abf2dbcdfb7070b13dc8c1f76c939f5c8308542bec63da63d9021a911dd40d580684ab00e3e7318bc511af7d75214f348d1400f7254af883dcb18e8e3cc4b783464362ea0075c50ccbdba91424b23f0a580a4c6950df2adc6788a4807ace12fcf28b61b88025e3ce590d6ccfb362a228cb40276cb95bc1983eccdb0e9dbeb16bb501e9598a925e8370eb83b33dd9508f183ed1a00964891cc284c49c9c320e03f608d26be589a418c4fc0f69496784ce44bf20bf9c0136b1268476d07605b6477ad8b17f20996c4d6ce6da7402a8bb0ce59af485b6e828a97f9d7d117f809330443c37ddab8897069d3d87ae98defb864208086c7ee460ec214f4a6f77df424eb11f49c85ecc694b0eecb7bf219e1fb95863325ba752670e2131e0f5d829b89dfbb8410c15058dd2c19ba3a229d404bb7ac3937f9668fb1405cf304ba9809b39799d08ee68fd611680964de0ea206b3d205eee62b7cf55c27e09135cc9ddd493ab8421f8d004e4235f0b6c8adbab69878bc61e549075d7e0314105e6675db5284bb1d1a36bea49f3212f10287fe9d4bd0b46ec41e22380a8b0a9384d4a80bec19c5d71ed4af6c52fb560e925f768c928a5f176213381b906fa3ea8661517ee62a56709a426bba63fbc0e09b1f667925e026b9f6a9a66e49d9f9e36afea33f2523cf07d54123fa1b5fb27da31704f688350b3bf00385f94c8f1a743ab61656aec80db398a68b702d2710de2cd80542c7a65e2ef0ffb088a16d99267d802bbb5d830f73f3468ad81c7406eeb16423c02966089fe17d9220061d04907ed7f79b0a6d3152dd5a9d0d7b80ef3c36e2805a1d92a1e975a0f53f2bcf078f82a0003bcee1f961934cd05fc61832beb3ca05514f717cfcab76d9c614d4b25e7c7247004621c98028d149853c51b16850f6e6231c246bd4c9b628eb482731e63cf8e5670b1cd035ae3291f02714ecf839831c54206815cf75b4aefb83e4d29256dc2609f17b5143a35c6f0f1c27bf9e4cf539d960740d6da4cd5bef42f698d49687c29614e6d4d994176a38472b5e84ac846187203050e23dc512e042b791b26931d957948bac2f913894f4e544b298d616bfa581defb34c2965455e251dffa34d1a5402e6a5cd21850d5d28dd8ea1352a959d4653a13190f8d259a2a482485cd3c265b3f75b6f16dc5fbc60109e0320ceb952ba8ed361201822173a77a9644b066ee147987b3b351794f6cee04cc61fcb2eca44395b96cb259a927628ac184fa6658b7c6e8196c6df2663017021510961a2f4d2143baa1d2adef1753868c2d799720efa61f467902e4dc337c80da2c26a3bc9b075abacd9bcc52355b4ab42a9d9c898a823f53dbbec8a34175ca42f740892a1053aee5da932d4deecad6e96c62f9e3aed4da9bc7b81e180da5dcad0d7198ec4f16745f0c89cab53d7c1ccb1d0201821cec2a18f7de1be250c087c5db2bcc216ea69303981726e6cb2834099137de1b4292d415c70fd807cc932587c5a9742437c62b44d03d96609c7babfe4a8df8e6ad48e539c48384bdc7c0608c1adb32c361de094f2e9f52bcf9d841e75664522037bf94feaee170572acfdc97458680b0dedc20acfe6cf4096506c94e9d1166f2b8b78e4461773080a7715b8735c8f982c96e6654720821987dd1292b76a71fab5e401efcd21e3f56e18c2f1c4a668c21b8fd2c19ae82a69b52b3bdb2b8d631ab1e72ef7f3df096f3579fc043b11d5cccb31a73e337f16718a00208cb3b6c2a8186af7f1edd0f7c1201f384e3e7f75ff7f9bb10652d36f5494bf3f8dbab38ab572d9a57ff24cf89bda5ba5c23fe0838b74f09687dbcfd901ad6caaa9021bfef5f16b0800e01385578c8163c319cf80a76bb3270202c29222dbfb1496b72b6b11070ef60aaa8c0bc27881be4ebc36527d4117714148e81fd10541076f36d1c248ad3dd5ad0233e9dbc1aa4514333ecb1c77cab86c30674809c184e2d3bb8f4fbfcfde3378b8edda10866ff396a7b6000e590cee6f5cc018524e9e8dd1e4b5b40581ca4f5ba6d63695c1a72715d434f442af99cae942704688756d43796c23514e757826a12226c138890dffe5b2a190445b823c8dd4d57babc38c5fde018f4fbde11eb9f0ff7763c5c054a1f17ac11a8bd053133c3f35e6b8194726d62ca0326e898c349c35b6675b00cff5421e74b9b115e56de4ef3ffef9f202769c004b1869feb6382e7553f3c3a9b4f8c32805bf27a2ef33fa396f8b4b36794e47cc71466a0a5c147e9a8d404be4b8bcc8f02e2a1fff590727af0ae8dfe808b9ca0dbeabe370c4442d2981bac33c0fe3a606b42189468eb5e5f19252d573c017138de6ff35f6a226274f844c68ce84e441a044e5db3ce83c217eaabc692c5eb23eed15fd717453f1f2991def4d9c6c023c5906da6e0c99f8038880a4edab4fef907136216904141e460d7feafaddbb1835ccd58f9b0d1a3c818b76c31fa86c06be999074508789dce1d8d496b0dc5e9b560fd38079695fb67c5c537526f37e8987d7ca4645e7bc2674ae23905cc52d858ca49ea9ff49e093749619bcc62dc2013f881a32ce5d280c456a461970ce1d31435b6f82e78bc934a80ad61573368b2bee632f513bd8c9e8fa558b16b3c96137aa9986982398dc4b71ddb39778dd220823c287db4de079f561b98fe5d70f2f7781c73a0456f6a1a960cf16f6245f116198b7418db67231511c417c8329d6177d44950ad0e8d625e863304144917a3cb9df4a052f83bad5f5a3a3c16887eb4932761d5c7ca3d7aa464af4e951d519d617a4a4efccdd7aee9b9e4f87e1f6fe3443522cc1c0bf7a7e73ecb9efc86bf121654a06dabd346fb762c01ee40eecb72d4df4afd1a4e466ee8903e58fdda4083fdaed53a061f5a4855f466dc800c305d5c063ec154d2da7817b46252ecec986d78f24c94c0cc36e8099b67093ddece792e2f04ef191110886dc9ccf1b9dc336abe8acd9fecd965aff6b231c90569fe4094502b7c749fce4ab7e5ad2563dff9f9ac2ad95f9ef3c597660d83c9905e80d27b2352144b4480d885dab48d881bb0331a4c2cf6712c442c6aeff4dcee6b73e09778939e208fd9f48aa743ee6940c9768fd08f927ff1aabf6c476d67cd8654ef6b1927363eedb1f36bcb1c37037f4cd1ad8db93b2ffa652214c39ebbfca246afbaba506d08af04ac1b00b1d160aa3ed603893d02e0d6b59d49ed511fc450de6f3ce384959b5eb451ed668e9887c1fdd07775c5c2d27397191f81293958784ee48a3c36a536b77cccf4e44019bdee12e0d27914b93e4d88412ac95fefb657ad7debaeb1ecc50b6a8ea200704f4ae360d1d17c1a2bff1eded2bd3c48f22f3eefee4cea264898cac3677edb5ecf5765e99da0cbb5162e8fa65b2b30a2a56978c4dec5b6f4b68d9f1739a9b5ff2ba3ac332e8729d2a66e223e1f2911d70a38e897b30b2d4261319359eee25a61ffb5172357449a685ad50e432fb10a3b5b98a264364914205f4b65ba407e985aa139fc853552148c823cbb5d5de25f560f568e6dc080eed8e60bbfb037db158c7d5061156f06080b33ab8f6365e6c6b57514d12b230bd641a2d9299b721feab89523392b8bf343b7fcded01224573cf864a96a830504c1a0720468fa89848756062ec993355bd496ad053255f8b045b9e25cc6d9eff82c3c2682f46f401ff55974889a504dbcd9a99884586ded89e5f6be20dfac77f1980158eb141cd1acfa9f678078528269077e84d32394c3cfbe7c7d69b0a819cb765b9d341723cf69727e3504c65fd476ca0d2a60ec49adfeeb786f3160a9050d3bf6e5f9531afdc1bd3ae2a6245ed5833adbccdccce50daa9ea78ff49d6c5327e29f1f76b66c735b10750b2e44120dfc9c783d4a1fb77c18843a95c706fbb5b146bb5dd6d44e75639c3c8e44cf559d55bce17d7f9d9150ab0e1ef62d4fb2d3bffd0fcc24d9e304e0025079bfc331c4cc672fc4b751677bf0f4f0093b9472321a15234e8e17a71e48d5500adb1dfa7722c3482bb8fd649e64749ef6bb3fbf7989b20c1f0d5c323800c632d22f2de0cf4a465505f77b7465971200a62f003a95fead04d3ae6d3b714669979c4754dbc2bdc3fe4333a0a243b933162c0bc2a7e373c5863b480e311c29e739890a25fb298cfc5655f2fc0b722be4829294b690413a9e08d10658b32d10c3d43b6021444dc283cdf620be87f9a07c5681a57bd0143a96adbf0cb551bc5b4f767389fcc9ff8bd9f1f8c85c317c5bc4d5bb38adb9e212d16f67b0b987717925dbbb45c42bb0034692237b779229ce5a6cc9490c2ae79132b9ab0d0dcf9f7ca9f7fc38b5b4da19b58b6ec13d147f433d8a3be4cd1ad9974911f6280986b782d3d664d7038db5a6d0a11168faf8f463795f867e08e4202934d98ea8761d12ea62c81a9ef5dab9b94b4cdf046e49db73c6a21c206d1c0f06c03dcb5291dc738616a21af93362ebbe625a844e4c74a2dc0c34536fb26e015539c5b27e885803d301af7682700f9c040ef7f87cbf93b66e1b8fd2dc67e8ea1d8589924edbbd94dcc64c8b150c5750798d355551f3f71b26f0ce26b1e291a9fab3f7e0e3ff1d136bf56b000e47a3ae1891b2013e41e0ffda2d6b4224aa26b54ba2c219ad99b157d2821e94b4127675a7adc921c93682b167fcdb71cf4c81fb17d70588d62c1770a8430ad7886886a75544c42d87a0e991a45723ebabf67848adbb74604e977c4dabaf168f6f36bc2c9f400aa4925744d41caeaeb71b9ac6d4eabe7d6dd3dab28ca8690cb09c3eabe7579621c53348c55b14fca8514b1da27c07c64e8e4f96765013e4e819280e4f45eca830d507b10ffe149350b5032c2d033e1d3de967de18e24e0d38c8135649873e97bde5d3ea7659ace2d9151547f911f7405bf9274546eb4e6a147901aa7553273eae1e7c13c21c90250d9f0fea04b1158dc3e37587acb0729dee027b6bdd63137c012eb7ae37a46aa65fb8f7c334866405938c63e2414b670f6fd7d12bb76a850e4e4f0842d17685c9ad8f113f9e2e3c01b7b474d94c1bd73905432a416f86a16848e1a5bf3bfa0ef92edcb9ed5dbb52f02feeb824d70c1ae86e3a62be33d5fc30d70034cb2ea602979c1a277813289dc4106c0c368276728bc81db9f312cd1013afa46456dc8b08471bc4a4b28c4d4132097f51d8cd2b86d948d4b4970fe5059f231c79685506d895022c579abc35ad19c5e0f18052883e8340577c9ea7edb866dce6b58e8f3c569e09b0081ec0aa535c87b9690658557704070c3fe01fd3d4e5766b377d21eda9f12317fbe7b84503ef987405b7c48bca0f8fe669ba3c0af82b26b854cdbfc3fff3bba03ea846c57a56750dc4cbe4d55374f3da6c6579c79d82741135c0363236ec97b70ee93389f82c0fc7dfedc587be4f1a15b40b5f6057344fc79b261874491156d779acd04b258a259509c0b0b32b24bd9a1d91569c09c31be4d92ab59febd5d3a65a4450cbb757f1c6530df214dc4d00e8bf4bba81b97788b1c33242a1bdf3ab463692b6dacf69ab4101c4d9a351b4c4401d373454c36e829dc64bb10cccb5158a3ea24687fdf74cf958b9c1fc18aee9a81ddf062d46a7800d1cdd626bf2234fd9dfcb0e55474e4771ce06278150c1ee263619bceffbe6dc59e8e7613c0548723658304e179f12405a6ffa95b87c056881c04b10f7046efb04322deb6e5afdece0ca3e17d4f7ed999fd0d084969fdcacf67fc6f0af286f75f19f1d084d2ebdc8df753bbe717c8df35da046a20303d1fd1f414db11441a2da0164c9980e9be2e469997b06fa9d831ab3f37f6932decbff2de66ee775d092c6124c07ba317972ce50e95041b90671c35a238deb14600774e010f33807536a05529c0060259353d1c13d7f8abe03771ec3ee7cb373b95c778d03510386106bb6083f8c6a5ef37956e6127bda703c88a3b20eeefd29c4c531129f15bcfb2accb625c1d911e43da935de725ddea13781417dcf5f7216c2b59ba373bb4e38ee7dbac8a151992410d0e8629a0e7548a029f3a0d39d3df1b361b78a4f6a6190bc338929607f9e7dee1793a6ee9cd9c374b215490e2089ed8b1e1500cc0f7d96f2c176261c59c9aae72b910c98fd210b3ac9cebf540a78defbab2290998a9e375fc8b32afe2650230c2cc26b1f49cbee16afc1cbced987c2ca1a2d62bbd4d4fbd97b381fc06df604188cea3bded2e22540d021b6cdb7de8e2a91087cbb26d9d45268dd0c9119f3da65a76d32a8324bb660f1111837461e4329bcf8a661c5a4ae357145e750fcd6923e4d4cf9fbf4c6284a341eb720355e393b6525b0df703a593d79d5a752ee071f75d0362c488b52154bc4b04ce52611b48cde5cf1505ab848ef15a8e3182a0a085b73ab92b69594a96e3a88f8f8cf69f48fc0a726e83b0942eebaaac3defdf8464bc6ba5da6c35913949dbe484b2de4c97fe9d9a8c10af22e663e28bd3bf9637e913cadfd1ce66c55e89eb72c97e6020564032bc1eb476555729021a6c1d9e462aed3e49933a4f3a92c0eb9eb1d6d852e6ecc817e5f24b83e5b94362cd25d921a92457950e438bb80ca93bff3d2f485ff803e02c38c8a710afc0a8d67eb63c3043c332141b26211d6f12501dabd034a25a08c68d22fd57b48a599eb3db4d17cd4645eeb33ae31d5dba5f99ee456899ffed79b8dc5e39befa177cab3362b25518236617f48ac50ede1aeedd7885d021310dde1f1114c1e010f8a2ccb45a1cf4f8de84d92527a395c6d0bf600d18fca15c715608eb2b8e3f07250c0d418a3c3829dd0e76f84565dcb3f70593cf5ccdb2517143beac99727182eeb3c0d3389c8ac9182e1780258745dc7f5ee9a27035f5b75b0a5849367b40eb26e2f90a7df2868c67218c5a771a31f2eb650b8de3d9e767455990c1cbcd04a6867b4847f298d77dc86d2918999b4d2fca6ef85d4daeadce44fb0ad6f35b26799669ca45de34f17d02fadd0d92944e69f9dd133ce29d45433019bf15639ee540bd505e8a151291365e71e98b3e4de1eabd2f4a8c563408fa4cc643241482ade2d1fe55fc850d2e14bd91b5224cba40db9fa9a6a57d755fcfcb98ce584d9f57392311a6b28c21b98541c4fc8d7859ba12996befcf87e7bb50ebaf5c3e7b40e03246ad808798852ffc0359107a33d52d50ae519788387c5e79f7f536b219fc1f99cf8f7b37dcce461aa38cc85ddcd45f77b9114b24266c8a3002b58cf159f90d5a41fd2e53cec16c779f78cba2cf0bba4590e7e28d6337d93ad5a9a670dfd3825057c3d9aa4f937c12ac6af817eaea4fb6b9711fd85fba596f53743cd6d090a00418fbe2fb26bea58fae23e79657546d8005756b2f447da39d3362866cff1d1abfea56974ec2cd3ca4a3aa381009a8181b753b1927a50f7ff1dfbb1599dea1b12366ba05d7a14ddf032ceb4c54d53c37d10e68a1aa778279282ba95f1eff571a1889f49cf5c8e3cf770cf1d6dc3e62be671edd7f701fdd92e5aa70e4cbef4b9943e2570740dd0813b4ce13afd50f9ec7fb57cb6f211277dda6b02fac8f0cf20c0cf8602e372c6363c3e7b61cd5357ebdc9807afc771b3cf644b2548c36877c3a9c83aae510349b6153a5d317f493b21c5cf9e98d1dab8e13899ae3f2d97e3ffac9c2a1a9bc84b3161c6ce13b9f37310d2fb993c838df82edc89f47c0657b9d4ed1d350088432e50b5f0e22236d3400dfc47807b374a59ab16179f6ef652e66a13c13776cd05f38bc5bd3370e3353dafee35a81553dc3976a07514d635becd6974f6f3584382e754574c6c21ebd2611ba64aa7781187507e5c32949102f2a98a38013d944fb678d5c34ac46b1d0de34c2bf396443a998aad6ae4e12e7a0b4af6498f57bccec2875a1ba3c5ca8141626838080d71017324bca62a2a38fb07354933926d937b3c2369eecc0369ff9d8ec4954a643101f36616a5820dc42879a3d07997c0b9734c98a2d574c32447c8c74266af4c9d9502b73862dd0a30e7732f806cc034202b17b5fe7d9935103a409d0f3fddf1fea1c7189e9f385a820d8e820ac577e59887abceddc587a5b35862d08c3367b4ed527adf2f4827e439f794e84384d11358db1ac7c3c2f4efc788c4bc4be6d37229ba160b8e4708defd683cb8647882eb7f5129998df85876b1b61b198d03691b9b884c8fcca962fd422bd67c96faa69f748a1c22dc08ec62ac62566d1aeb03e8aae753cc682aa9a9806923a1ee4a5f18fab5367d018d233c173b29b339a83fccf15452069af459e8419b792ce62418842c5032707aecbecf2be07ebdd066f22db7ea7b2d333e720102b7cfd6cf57ba71d4dcfe0172fcdcea1844f7b6e12d400a946b9964ea0041f9a8f700c2ccc0ade87610e756e8566f1285c382182625a5e05c93566441bc02eccf732804d1cbe4bf6c4b4c507613cd64e939043a62c65ea55c712cfbd3aeb5ce35cb240c61ffbb3009d64edd14539992696e923c3e17cb8e3675198d9a59644647e99a0bc4d7511ed97248abfe7c74f3853dad9791ff6a275d58c40b115ee8e47dd2e51c5a1237925c79080062c6e723f9830e22274744c1ad9da27f401d0b7f85c8504e9692618b1e1b932591a963ba1484c6e5e403c64d6a51af9cb407908d35eb097658311db53b97ca9a3c4eb005488ae09707bf7a44e488c8413f1d03423d3e9f511d5a66f0bcfad9da0f019897717c117c83e93b73702b0b2d601d291894e4a9ec61845d8f8190bc97c2f5c7e320a53e1b56b15919f0ebba18f03e89ecc5557fb9c31bf7d9a2a6a9c26a9f45f81354b3aea2beec9bace6b8f4ff179a8244ee6464e21477a729c3af8de758020dc433363df75460a6bdcd9a858de561ce49ff9aa6f4518df1b53628b7375c9bd9094f425691b0817871316ad9f61b2ea06fb334cd5a43ab19019d6a7fa564b95902ffa431d96fb72b62bb36dd0425e875402374ff4928f2d05de0cfd1d15a36e03ec28ca1273be1e0b82ceb1a064feebdfa01b414ae9390310fb263855acc7d5700c2c4f8b0229efcc0e4f15a2cb663370c6b44631f924764f22661aa817a6f025fd45048cdcd1e665550863d780c4f48c17f88ec4dea33b453b2f607c2b28b52b7f354fd3efa1c1b1bb7028c784d96474f529d6c4decf3dd9eb03c4ba3972648bc03f18e6be7ae2d3b5d19ea227739f1da896f056c7804b857e855e599c066ddf75cd67edcaf63540a8ac483fe4f9209a23599d0750a5272b43826480e4ae65d0026e46a1380b3fdeea2b34afca855a19193bb78fbe4d2622f3080379ad8dd631058115722f9193bd935dc7c2ce3355e432eb8b52044f111a87cedf1b72eb3625a5cd8d1b7b125007c9b419a3c9cd1885a28978fdf10abe091756afac835b7c6cd389f65195046d61ceb0aba21bdca97d275bbc965e19cd49ffec16f8cf3895c9bb61d56189ed04298da16eef3b5598ee08301556c1152f8ef9c47f4c981cb6da219ad7114bcbb777ff9bfe40ef049fb65cdb71b2946f6d238174500a1632866d806218459014160ee5d538454dfe3fdbfebd93e18b71764b2b0d634b6779230ff7e609f8e00b5312d4d7179a38be3d8c51e08d816778b60656250753098256bafca7db42d5858c2cd1c377edbcf357e398eb90c182b8ad1d6fc0a4f34e6dde55e9f8f484c0463b0a41530c5142e4edfd004274c42691e657ed83c4782c0ad14cf6cf1ac4f3722c8c4b0758eec783a61e74a203c44d42618fd321640796a994d915a3f4dcb36039e6879cba16a120141b29279059dfa5c244a6bbeaccbe959d945e724a53bb2d216b1e378d068d18ed7a76d98faa4cac9c530130425e44919143ea145e86dc6349942352fac78704df5395f396a9b70035362cc16f82a84c5237a41de2edd18dbe61784beda2cc67c1b1fe04300db016c2ebbef1e4c6c523e8973cadda7182f5ea19e6db9a0873b1ba1ed6b71b8a9b2573dd86e32e79bfa11dd5e850dbdd06864ec90db247e8a256ef3a87dc5b3592b980fe9ed64ddbcd09ad60f63b70ca3bd8d26f4c7abd8894cd695ba836c284a5d629eb90bab2117ba82a920bf5361f39b24616ddd26c2623642019fee4ad3fe59b85104f52721aedbde376b93efbc9b7e7a6572cf5fd5148336bb44493ea73252cb11897703b9b3abefe1386f756094b18662c4cd784c315dc37f05bd6613bde5cf8231b52af124a3cd0b98b3038e672bd69dbe190bb97eb91c1c61c209b0077956812a5c745cd692dd97c5c8d4374095ad8c53931bf3fe415b0ddb2a5f20949289c496e2e4a95bd7d1f3be4930b54d7be1880f8ee8740d73e44d109c217312315b5bd4c2c29ffc7954c719f1514359f84048266c58aa85d73dc84a25bb1d7a613f5d47952d357a99666b029195634a988e3a4a509828ccf5371c470086854ddf95801f4cd5759bcd35ad5eeb6be70a4a0cbdb5a0fef3c1c205a3ddea482bd4e35059e40120f4305635bf68efcf3873ff94d526f0fba7efb8035a9cd609acf45c84a5a5b44a4c1c7e4d2d38027dac69b97b8fe8353e6a86b02d34eaa9c166e6efd5025fd49c0099efe3323e404fd4c971504cd5af529e586a12cd9ae1eb3ae7bf8440b997fd3503bc0e0f36533e61c511968b9add836a3f83c02bbcfeb7d0f68051cb28288fd139b24dff7ce626e7e96a4b64b801f5c6113e987932fdce01a2bec438313a2e0907197cd234fe868f311780270ba855a70573fcbc503839bbca4658e2167db20cb7133fe708007b2ae8e343ba037030d6bf7e50b14dffba886eafa8b9dd74359667cb261f5b037e2d62325a3161111c297f0001847f0eacc847cff279dfe7bdcb032ead68101fac4b93a49bf34d83ca4819056dc78f04f8ed393109a9772abeba5fd922ce437d1a87b287ce39ba77d5117b861dba05c0d0a618aa1c55851bfa3caf291523e430a50e064392fcb7ac5933eb05b4c8bc404b9bbf17a2383f68118846ca8c3a3b5bec4c0f8a5436ed716915003c9ed542628bed89fc5200df115a39093572c665fe89be975daa0bf940867c1a7813391d5b603ea12d0cbf316548e87ff3a9b56c5db9a1fd7ff26902c2672a7df14c5b44d45a85b86355d005b11dbd10a2512654d80c8de401b7ec9da97093643129bab6c4b2547d0d7b0c8bf4ff6fd71d9896da9a51fc79038db6827508a029c0036320251cc22a489391c6f850ebc6ba43daf97eebe6081effef5c2aa0f5ad7d77b122c2d0ec37eab21203e26bc06e58f67d9a45a729dfed54c02ccb9f4922a377c58bd98c4d038a3e978a897c0458a2f52c048a6f7ad958b667fcfa4999a1f700f40f80314aaeb3c25e639b420d48496035bd4a3e2ffe6cf7bd3f3ef7a040be18aedbeb51b957d677ebe2f6076fda91850d0a858948c3c4b1bfe663608311a710d1f20306a394cbda56b396b8cbedf61e4726c6f04d34a609ed328e3d690f45794d6f5bf6cf18a590f90a9f7249c3bcbb055f635e88de1b11cfbbda138fc99245282222ee8e2ada51ec9d4f73b57b0e329884faca53b46be7eace2ee086b0ca7800fc7a4e877edee7ede7e1e21ab0dbc31f58b6895073828a3a20b9131d92ccbfeef8388a53dbcab111e0536ea260d52d4b766f6d5d06e696fc083f3c293be095c31f9af80f83269e92675733f5a3c0fa1bd60c8478cd0c771273f3f6baa0b60ec76b2361a31f998f2ade456c7cb16d6c156ad1062265cb0bd6d37a5b54d306000e8a27cdc708a6506d8f62b19dac87a7b4382c874d58622709d34be5d21cfe1a189b7ff3853124680567b7b83cf3ea6bd5bbc3a5028141fdce2309f401701d932a8b9f0baec704d9915a5db87829b940156b5cbbe129f26b87406af81f12cd8827409aa6352dbf4c0bd43d191e2eb8e7ed551edf2d549312ed9a02aec1454aa62f4592bfa0cfcd2725ef2b67e987ca361f1d5565c4b594ea4d0c78c6844fa90c755ee1789f4a45ab7023c1f903aa26df23c6d2445294434d41a268491794b1edc30de540d13c1087ddfac2ceef8104f0bb45c893f29e3d0afa1b97ea3d9205a7414c91758df46d921a298eaa64069eaa56427b255f65187f31a1c09bbfcbc369b74be6ce58cbbbb18f12dba9d198eadef09cbbff6545958a8547d522cccd783d8bfac4d8ceb0952bc25d3a66df1eb3eb0dd23676aa17ffa1e8288da32d8816b8b61e77652f97e581469509c1b652464caffea3bbe56a6a10564cdc2cf2b8ff539a38f49df2e62cc6866474303f72028ada6744feef6a9ec0106cf8554d1640d1d6471e1f5c02537da3164fe85fd3518ae941fff9fef27db1ecd829d099fc461e97730fd91005255f38ab3f12ba499ae1c57c28a5dcda6d8c9b54c10c3e357bdd6e6710602728f53a9f2665c54ddec82ba09d832a8db0fd5c0c03195cd617600f59730a6aac3d3fdb31b19feaed07289b439e2dce44ad68ea22b6f12b24e04b47db1412f8f3b53ddcf183c68edf43ef54ebd680e8439ab46fe8805a0697bc2037e1686ab98c0e4cfc718ff60c3eee99b8b6cec05edac296605c03b3cb3184849ef78ea19df754539546483fe1246c5872ad63ffe83b895070d64296ae1a4221a01f4bd5cdfe2b506b1f007d511d0ee8fb8afedf63cf58835f44ea06dde5fdea9917291667994fd8bea2747ac1846aec2b3c46dd9d436f8412e97468fbb40a04aa9e1cfcf760134fff52c2c7ebb53cdc491e39bfda22a03613c2f255048193b176a02da0b184867e3f2395ec06c98573bc9087633b7b0d6bedd4a2ebfb978a12dee3cf01527e4b6a0dbcc35c95b09b330f6649cae6d6967786de18853927a0d9a4785eff66657a8e80bb92865ba0a02547b921bbdde4ec9a2370897ba63c692e31d137a98803f59634f4ee9d2edfe17b1de7fd440a30650fc292c6e2f2910860dcd5ff73a481c9278ba7e2ce1a6e9d932cd77a5c87fe7ca236ebbb89fdcc28b04dec0e0dc4b62a78e6209e9690fd16f4624af495e02873fe494a9ba6b4c2f3a83658e2508b85af9ddce06e6014c8bbc4498842d022e563ddc2715d761e72076869146e5e6e4a5c0b90cb38cf0a204d8ace96cd6461ebcdc209d9920914f9d1bf5e1239180d8223b2e83f2c30f130af41a661db8c712c8edb7b901d1dd39dbd982b5c6eff109b2c56237d600bfbb6dde4f3c6c911d7e14f7b485a140c34be94eac45511ef46916b3038fc842ee1316bf8305a9ef3cb254ed457adbd76052f9757ade1dd266d428e2c6fba9fb7b713e87eb628be7e9a76c52098f071d037fd52c1b2d3cd147efcf42ea8519f54dad62d93b72dec6ee17fbfece26822fb10e8b30e449fce3b1f3feca3ff4582d470f50b6c8765db1aa6f6f305bf3a5ad9c53a8cc94b21990024ced3457d401683d3ec8077d8f3357e5257a72d7914582297b48a8548d0c404684f3d185f3222902410a6b49c7051f702abf7cdb24582a28cc3d5e5fa728b638e3acd02ebe7a5ed3e673bf614aac7883b8d91ef2f822fae806ba8d24e7d373ba4fab2e97f386924e85de520cbc0aa5ea5081cd89fd60422195fcec6c8a8bd27b675552f685181eb0a4ebe0fab4457e305b1087abdcfb89b58f7f35d7196b8c47c43323ac0078849997821958fe1b0a16a492d5b644b7c4df1a2faa081e76e6fb07f0640b9142851fbf5ccecfe348745a95ecc82a0160f283bb0f993350e9f816fbaee3bd177d08446f85b4f19af85286282ea4663137743937782280a63828fe80821935ce697798858d4893044e660bbc585b1d311bb951a605a161f2587d55229e0f96edad1fd4cacbb974f168a50e5e776ed9f2ea8ad5d6e4b7febf9086bf78e6384e5da6b0bb2ffd6ccbbc723cbd60676075de9aa9d131f18e80d5f5cbb8839cd3ccef2549ddfc41038e47bd9dcff7080c97ed81f2ae2dfff6879ddad666ca665bba44972040bf84d9d9fae52b5d31ae2349ff7cf1c9762a2577804be60ca21fc99dddf2533ff7a865ab033b4c7afe508e6d7384f04f59517ed727646eacae190cb53be560b3bed92de350efe70b151429f07ad2caa2ffdaefc755c914b7b81f2b0a6cca268ee1dafa1a9b8461aaa97f8590125e889ea3e272d0bef637f5dd6fc7dbfcb5a70d9e0644a96dfbd0de7344079340b9daa5ba40bb0ac850da709747d5ab36047aa90bb528dd9f9d9f6d7332b72c22a8aec418a09dda722cfad13237903ff9024d3c266089b807e79b17b65fb2e06641abcaec28f51f8e8357c3ccc6b6aca0db7f41cf2f946aa586a37ea9a2503510028eb681a64f05cd61fe1975825a5e71ba892b5e3e88fe25c91599bd3c4242cc5b10a67195ba8effd8daf951a20d061e22d053b13be16590a0fe5c5e49c321a7751f0d3e83d2bb1c441fe0c7d404c11a3b9df119d2ca347afc705f9ec20d8b416e4cdbbb6d82c4a17cc2ee1d188abcf0c3f9e181e987fecb3fd21363bc842befe3224c7e9aab1dc9a45f4dd9d605ef4305c51ab2fd85398a74151d91c344d7a10363bdba84a29fba9aa497a66c94fd6a6268fefa15cc8a17334e3d68be48a3bec5cb6f5af3616af570fc3be3639f1480e6342188e5557ad551e06b255305f71e1d5c6541380952c9e949a5f6b1dca2229bfec199e8135fc76800092e43bb6c5de6b3b2766dfd6276433acaeb7118b0efb66588bc082d2fb094e5604f89de9d76826dbd90472b4c8630cc556a96b48979a36bd4a8c8200807662c9f65d76926c76492e89696ac52e0cae3bdc68379065ae7ac06c8ad01eddad359600b3ee279eda934c2744865cb9d652166597b221ade8790cdca54b1ffcb64cc8a6f0d9c954ec115b7f54264af6d7481b264ca4939cf9f6b62f1008c07c6d4b576970cb4e03889e82db32a02e63c6eea8f6de2aba5440fc6865986565ced51bd8ddc6b7b10a2146bca050970c55b424e337c2b99c16a89b0ae914a3c22f1fe45f8af110254e603911d56325612fad9abc409e90e5586d8dd11f19db27728f56a9039ba24d5180d93d3af13abb130acdd1a4f04d26126c7de35d3d8c9c5de1d1d13d71a2e4aaa77f8ba56a2f495ddf8ad35d6bd978b304ef9c3a02f8c591e243125b1644199a275346d1d5e7b24089fe116009b6755877c392eb7bd7c78fb4a606c9dab88f4cb398b1d59a2b107302cf490437d85f517cfc463c1e7949cce58cba23884cd027daa97b52a4138a6aa1e5efbee83f06840e242430bc2223a89cf25dc3421562a9e48afba32a02f59ca7fc7788aeece68a13e0c6cd6499c6402a7e50b1f1d28cba79551ed5fbb232da033bce563bc8f81c3dac1ae4f4485080fa7976fd079d156d9e5ef4aa717f94fdb09ddc1b5a01fb648acc21b673a8854398c763fd4ce0c0be28be41704e95ac8803b13402add9fd42da532965b90413900eea830129f58bc70131c829dcca15caba1df79956ec2cddc798a745f708282435ba913cbda044a2bd1ee4d0186360121eb80ea4a0ff2f43d17f089d6a533887b30d3ecba68ae3aea1b55bdd739e740c56b425f8d6eb39333c96ca45e99d85d18d8dcd06c680ff3faed2f586fa458ba1619c01502c61f7453d806e18a0a9fe8f4ad70090c8bb3820e9bbdb5e14b01c197e3e134724d128a6dba99702e0e60dcb06da2c7ff86abaf96e7528abc9d2990dc23bd955020d79aebef1cc95b148a2d47a2805b42727137b562b8068d3cf1930f525632dde325a09d0692b3ed64ee746d353fd44ad3e72415f6a41de7bf29b66aa324e0774176d693c646a639a30c7dda26356f6f23a974c67cbdfdefc2a7ad6b159a034a2b96d1bf431a8c97945d8ea433a19b54e727d7846f352883f0ef34995a1a7115aa01eef4c73e39136ddc725af89b86fc01ab6a07f3c80308c600cd1568261059ad5bd09abf868138d65a8dbbde307d2b3df9cf052186d7e185e4cc5d3a569027207d9d84c35551c88f4fa19ae378bdf3f53122eaf91af36c940761dacad0e19573b2f1b133ff08be87b6c12ab8eeec6eaf6cd5bc1354856b7878c1e13f7edc58331a1c429c22e17efb19a24ad4f124736f403e9598a82160e9f908497168d117ceff128e394083dc008b084e631bc0c69f31fbf5ad143bf48bd2d04a46b7186e4395a6feb21d05587bf101d89c7ef2bb55662bcd9538378ba5b3585b3fe4c2e2a871bab87fe92f9b49feebcfddf45b192881b138d136ac60876818fdd01e9093401ccfe2781b03c60f3bb061e1b993597ce47bf8446d28fdf6ba044957ee0f26750a2bee53a5722c47bb47204be65fce1dd65abb14337733ebdb206f7f6c6e3adfdcfba2064b7cb70e60ac46592ae9c24ae5c689c164d649e8f3e27d105402a7d50da0bd4fec4f4c251d76b88a21af5460e4f0d19d3c227eebdcf2d65516cb29f626c5e9352fcf65c585500f5b1abaa84158a128008a6c34b521f4b2fd1cfdcce99fb298b922835e79489a8f1f1ee4897a0d08aaa8d2f8185fe4d0be3f795f06c07bca1b92e44ae9efa1f66c0a55bde4c50c95dfa846d13e7faeb000948547ae052fcac5f43ba5297d0e09511503fe825b6b8db3f0c7580b4f73eaaf5c388687aa0e9eba8a0dfd79f950ab882d578c09f2fa7071336aa6c41a013d6e9b42535b601f084d8bc374f5258558aa9bd8027a91bc4e766ed0c1235f312a200771e8dc4b5d5394451717793ef22df09c212fbdd15d65af710725c9acd5cb0b3aa57e7aa89f7d0cbdcbd733701f6399b37695ff41df296fa109dd5b56897fb4611833aa0e8d10ef3c9294003507326faf6954af5f66bae49d9203a269b3c430053ce8fc89f26ecff3ec33ca5d818a37898cd30b539cfd0a3e884bf0280bfc419b2922dae2c3d78f38942b300ba8d8f6e9affb481cdf55a0aedefbd4ce4f3e42af71a972aded9565ab898a64506f398cb84930a865468a4aa103dc46a37489057a5fc8df41decdb8c03463a5ba7355d3be115b890b4cf80bcc636ba8289200d9108f12131501323ad7eab149589352f8c104d4c462e66ed360e33932e59c06ea85a226884574f670de30ca7417d5c0c06f5c1181231a4700e11d963a0bcd265262642adabe1167ee10ac0e45595e1eb5d2f5f221aa93d1a29d56c05cda83ab34f9d057524ba2796d7a2fb24c40fca42f8110e6effd943ee8994205d167837686ed8470d5db4d0e1f1e860e131aeecb3e117baddb608b0e0be5cb2c8104ac7b7d9b5bfed1e5f4ec3882b5381586d2d774179b67586b8da629fdc5420dba1c7d1bf6b466ebdfd7315bc0613efc5d4a3adb317726b28108ce2c5cf82f77de5e74f44d1731e39ac635b2f6dbfb29cb0fe036009e5f498b9584de47ff20c551926a9eac3e46933ca7b4828e728292f7c46213f128d898381a9a801a07cf7ef54c7b8248e10a96db1a54152af2483d248e797e88993114b3671b3e7144de1ac8f42ee9de6c1ccb4aa8a628be8059b8d56764498a8a6ec6e04120867bfc99ec7b5abff0133f834ff150a6a0f8c3297a7cffc763b1d1e55d41307610b681d4e96fc262dffa1e9147637e5be58890fb8ca4b835e4abd73edeb99e7edf9987aa4ccea1aad15bf364745f03f96556f15d1740764bc86efa48117954edbde5c697e80372904b6e19a15ef857bab3c31cfc87293bbdde6c1d4b76bdc7cdccddd16a6fafd2c6b41c294f30bc4546a5b9ac68d95a12113968d1b08c53f510a4a83513ffcf93452f13ab66fafdb9e4e2c2ed5c25d5c263f8cd346ce604b9488783501676e435e465da9e8ed6920f1d61c17bc93a58c922d57d463c073f4cf0b1af0824cc0c342600fa9556f3148e3708f1763c342d922ad29d24725a00c7d8d795b9e297d5ddfb0ee6db79ec021a5114568adabd8b2d81a4bea8075aa281bdf43f22f680d34c1be7aee906161b560b663bc48d58d39bfa8ceb2c546b2ad4a0dc02e3bacf491e221c670a589e84d5349c3d6d0c548ecd14ab06b43bb536be07f79f2b3eba4fb814cdde6e67710fffa3ea7ffa84d881021efbb55e03fa00f2bafe3d973b8388d7e7e8efa5c46b79e6a17955047340455296bf7c6f7dc02ce400a73f063460446b91611ca1d85c5c81b5e0670d24b5434e8f58968edd3d524089b8928b917d2f53b33fe2fac2286e4f70ad73ca0a7a1376e042d0a48e0c22751d10c9ff4e3b6b53656c599bf0537443516038e50dc1ff1ca1eea216946797f39f5e7305ec842541fe5800a9e95f005ce1e6abfc272297a6634a957c201c79e17f0a91d23a3c11dc5a41a65ea63d5d53dbeb04a1dd2847c3a9ddbc22862f2f03067654aa1453529f66d96767fb1fe096e2cdee229851aaf1b0faa1681f021fd5bea94fc41ae714a21c9fe74a9aadcb6e383049ae7d516ec12a3ea914bf1de4f946224e6c2ad1d9da38d3c72092b6969fd77281e079cc2b4f12a7bb0df85ed5acb1fba3db422eb5d0f9e27cecb3eba362f83a61758226eb84be4fb5fe8f491aa44fbdb971d118223d247ddf8960631250be77302f94d904e61a2d9c191189a6635815b3390f667ddec6ea2afe792c45313099846c8c40c9bb7b736182087a87b9da7b419a596520276b1d9bd5a7bb3dde64d112383a05caba7455622308d389064d231ee508406e64d9041c36c7e3772a88793ed007154a8919ef64d9b2a38aa432680ee59b2fb240f898e27b34d021412b0ce7337fc8a274d3ec0597a058a5692f2c14a63935d10cd587a866949e5be3e5fe2fe4cf46411d6ac38e73f605f4c8c567ea0ec8e891db127d22ee3b72f15e8a2f907fbfb23d26b4c96a7583b20f1020b589aa6ea19c5faf80b8dc48eae6c3538247d418f88e90c313b7688647d38b61568ab2b74a3fe62bf8a707763c9c3bb87dcaf120e8f6ef72be772fa544dc989dafe4557610523a210561384a7685abaa5a24db0253032f77ec9f0a59df4c252ba72a18cfbd4eaaaae4b7d2172dbbb1a230f89893c9ddd810cf111057d6cee38890f10d535763f5fb5739f7116d9a5d41339ceca4012f06df0acf0ec456783ecce952ba2ad47cd4bb17077dd0e26b53d792b804aa536165d5911598cbcd63ceaf01f800128ce984c11a650fef1a52e8495db958ef9344e3fd15e9feab779e3624b76c43a7f519663011fc9e33c5112182b2bea984dd66e917759a0de9f0cadca1e2019093d8a8a62b5c2f603e4dcada7704a3781f66d29bbb7840ee6c8bffd727af6c33989c3b68b6bbb1b9abe573576d9363296b9966abaea6b3ee0202f8c452ee98f25348f8fdeb9767f36dce5b30de26648e6d4ce0def43350f8bdadade1d0bb0a62114881030a018c901a3a66189f7cc3e25f163302e8ac7fc676bd89760bca2a2c010c318e7d2fefffe958ca9593a1c2d1743c02f26f877b43a5b7763a00ed2a10abd42a528c05405eab8ba8225d80450baf31c695cce0d9d7b30ef905b3e374cc6072213fd6cc33d636df29b817d0e766dccc253b11ccfa65c4b1648a4bb23e8156d045a7eb5045fcfbdc9cae6c06da27e7e19874f8391663ec875685b96fd306bec90fe4fa673a7b8a6e08969884fc8fc6b6fdf8808c5ad8007ddd5818b235e780ebf4d50939fc8d840072a656a4085ab0280f579d1ab0914631944d35f8f10c000fe592e28454752ec37a32a83cad1b3b45e225d2e36c19ab6f7e8e38d70f58773f9df156b15340794ac601a1d139ba001a62e593a07bad85f4d5d05d70ecae7e75650614b52b535e4192ea123894ae9e9c6451dcbc100b3f1694add9628c9da75861bae127c66357cea39bd16e8258c867a232c4694e94bf605a31de0cf2abb9bc93fbb68f17a7a6de3996beeee9348999bdf171ab70fc7676084b2b7fddadb83c7394efe86db9e0f3c190726dc47192694488173ae5c9683bc27e257973a7968294d5d3cade6f1ed055e4f09ca614d42f1f92b8530c04f1a49bd2bc76c9456b0dd6aab533b05743fec0169a51ff0db9c628</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>wp-crypto</category>
      </categories>
  </entry>
  <entry>
    <title>2023-CNSS-Summer-wp-crypto</title>
    <url>/post/795314c1.html</url>
    <content><![CDATA[<p>CNSS</p>
<span id="more"></span>
<p>Rank3</p>
<p><img src="/post/795314c1/image-20230916080626025.png" alt="image-20230916080626025"></p>
<h2 id="Crypto-Guideline"><a href="#Crypto-Guideline" class="headerlink" title="Crypto Guideline"></a>Crypto Guideline</h2><p>cryptoflag</p>
<p>flag:</p>
<font size="4" color="red">cnss{Welcome to the world of cryptography!}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="cyclic-group"><a href="#cyclic-group" class="headerlink" title="cyclic group"></a>cyclic group</h2><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag</span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag  <span class="comment">## secret is a local file, flag is unknown to you</span></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = getPrime(<span class="number">512</span>)</span><br><span class="line">c = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(e):</span><br><span class="line">    c *= m   </span><br><span class="line">    c %= p</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p =&#x27;</span>, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;e =&#x27;</span>, e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p = 134994058501022133829793113756450648798182080773931273262418798773562440624857106163310596590759607340807163876539520282102901165977612358002331391089851066812663281502398201018663717659213732276911585751665516661301930410244101046617666467321456930120075263141242119953757880295718825254018040413826880843763</span></span><br><span class="line"><span class="string">e = 12927587515508549311645504126259938927362775210786958053823827936884288861306268493761629822045846148118653977616493302703588300283111036739875491883808759</span></span><br><span class="line"><span class="string">c = 46583597391505868783218970830156160405763802889228578452060606957717500160663392513770581781157233604314178955789908254475724009921579917780127649365498088467948777432657442293331639740286781008682662602974865442032279819833194544535317410041738966384493317240586005380761492762248899523164168679218802048162</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p></p>
<script type="math/tex; mode=display">
m^e\equiv c\quad (mod\;p)</script><p>ep-1cyclic grouppmp-1</p>
<p><br></p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">134994058501022133829793113756450648798182080773931273262418798773562440624857106163310596590759607340807163876539520282102901165977612358002331391089851066812663281502398201018663717659213732276911585751665516661301930410244101046617666467321456930120075263141242119953757880295718825254018040413826880843763</span></span><br><span class="line">e = <span class="number">12927587515508549311645504126259938927362775210786958053823827936884288861306268493761629822045846148118653977616493302703588300283111036739875491883808759</span></span><br><span class="line">c = <span class="number">46583597391505868783218970830156160405763802889228578452060606957717500160663392513770581781157233604314178955789908254475724009921579917780127649365498088467948777432657442293331639740286781008682662602974865442032279819833194544535317410041738966384493317240586005380761492762248899523164168679218802048162</span></span><br><span class="line"></span><br><span class="line">d = inverse(e,p-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,p)))</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{Unbelievable! You know the key of cyclic group!}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="cnss"><a href="#cnss" class="headerlink" title="cnss"></a>cnss</h2><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cnssflag</span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag  </span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">key = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    key.append(getPrime(<span class="number">128</span>))</span><br><span class="line">    </span><br><span class="line">secret = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    secret.append(m % key[i])</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;key =&#x27;</span>, key)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;secret =&#x27;</span>, secret)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">key = [179283057970236760812385016853348861313, 243730152305882610684268424505624182831, 276375013783217805474364273321195364813, 338363147025326331069698214354955107607]</span></span><br><span class="line"><span class="string">secret = [42312333420922777926503668120694248887, 188911830445106862831548334980052602782, 202272400826094059912187609891368651300, 16939666639933430404336668949000187621]</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>
<p></p>
<p><br></p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"><span class="comment">#M = crt(n,c)[0]</span></span><br><span class="line">key = [<span class="number">179283057970236760812385016853348861313</span>, <span class="number">243730152305882610684268424505624182831</span>, <span class="number">276375013783217805474364273321195364813</span>, <span class="number">338363147025326331069698214354955107607</span>]</span><br><span class="line">secret = [<span class="number">42312333420922777926503668120694248887</span>, <span class="number">188911830445106862831548334980052602782</span>, <span class="number">202272400826094059912187609891368651300</span>, <span class="number">16939666639933430404336668949000187621</span>]</span><br><span class="line"></span><br><span class="line">M = crt(key,secret)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(M))</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{Wow!Chinese remainder theorem is so interseting!}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="RSA-"><a href="#RSA-" class="headerlink" title="RSA "></a>RSA </h2><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Can you factorize n ?</span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">mask = getPrime(<span class="number">512</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;mask = <span class="subst">&#123;mask&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(p|mask)</span><br><span class="line"><span class="built_in">print</span>(p&amp;mask)</span><br><span class="line"></span><br><span class="line"><span class="comment">#c = 64949799997326584007544788513993497249594769744995858720976935000014197232306799968807213667255871030075230919683627404813038995304033226711042639925325815395252041199650244620814678407788637241064396318107929964286966081900052163098825412222835465966640369222321472659135622216530966800717417560715221275591</span></span><br><span class="line"><span class="comment">#n = 106750680418525866311589462967145265327203310954735134383588573660691518247034803380198999333962213971657327515092895034635965957228036264848532931376595751503164297061094511187060069380048933807326213369464059701069965785612620370291933800122445966488267918733547599024267999872488061941892122230382138042783</span></span><br><span class="line"><span class="comment">#mask = 12270330408774238331968219216635392599519489634111741706590917012819298856158311310855782884352875794146685141255943386189197362902992928716839082520848927</span></span><br><span class="line"><span class="comment">#13112112110892990771168306272793201342028151601627796725313855804865001339738164412798270175076178951452110894792943424133718769511979832250960465757056799</span></span><br><span class="line"><span class="comment">#11731832079629748669705816329667815638461774924918417348984676937048335348013101619038697983623814812736529127108466295988845879378764866277739393693264401</span></span><br></pre></td></tr></table></figure>
<p>npmask&amp;|</p>
<ul>
<li>&amp;1p1</li>
<li>&amp;0|1mask1p0mask0p1</li>
<li>&amp;0|0p0</li>
</ul>
<p>pRSA</p>
<p><br></p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = <span class="number">64949799997326584007544788513993497249594769744995858720976935000014197232306799968807213667255871030075230919683627404813038995304033226711042639925325815395252041199650244620814678407788637241064396318107929964286966081900052163098825412222835465966640369222321472659135622216530966800717417560715221275591</span></span><br><span class="line">n = <span class="number">106750680418525866311589462967145265327203310954735134383588573660691518247034803380198999333962213971657327515092895034635965957228036264848532931376595751503164297061094511187060069380048933807326213369464059701069965785612620370291933800122445966488267918733547599024267999872488061941892122230382138042783</span></span><br><span class="line">mask = <span class="number">12270330408774238331968219216635392599519489634111741706590917012819298856158311310855782884352875794146685141255943386189197362902992928716839082520848927</span></span><br><span class="line">gift1 = <span class="number">13112112110892990771168306272793201342028151601627796725313855804865001339738164412798270175076178951452110894792943424133718769511979832250960465757056799</span></span><br><span class="line">gift2 = <span class="number">11731832079629748669705816329667815638461774924918417348984676937048335348013101619038697983623814812736529127108466295988845879378764866277739393693264401</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">strmask = <span class="built_in">bin</span>(mask)[<span class="number">2</span>:]</span><br><span class="line">strgift1 = <span class="built_in">bin</span>(gift1)[<span class="number">2</span>:]</span><br><span class="line">strgift2 = <span class="built_in">bin</span>(gift2)[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">strp = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(strmask)):</span><br><span class="line">    <span class="keyword">if</span>(strgift2[i] == <span class="string">&quot;1&quot;</span>):</span><br><span class="line">        strp.append(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span>(strgift1[i] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> strmask[i] == <span class="string">&quot;0&quot;</span>):</span><br><span class="line">            strp.append(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span>(strgift1[i] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> strmask[i] == <span class="string">&quot;1&quot;</span>):</span><br><span class="line">            strp.append(<span class="string">&quot;0&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            strp.append(<span class="string">&quot;0&quot;</span>)</span><br><span class="line"></span><br><span class="line">p = <span class="built_in">int</span>(<span class="string">&quot;&quot;</span>.join(strp),<span class="number">2</span>)</span><br><span class="line">q= n//p       </span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{1t_s33ms_bit_is_useful}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="cnss-"><a href="#cnss-" class="headerlink" title="cnss "></a>cnss </h2><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cnss</span><br><span class="line">Hint: SageMath</span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag  </span><br><span class="line"></span><br><span class="line">p = <span class="number">149223181221309438217142971731290162048502071683234438807455153639165894737664410172266260056805353255967638568356843140306590887937</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">g = <span class="number">7</span></span><br><span class="line">h = <span class="built_in">pow</span>(g, m, p)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;h =&#x27;</span>, h)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">106414500627466044750537699496116452216938505790285966641538755230718107434518035561502262320845803494959251547594598724676292650073</span></span><br></pre></td></tr></table></figure>
<p>sage</p>
<p><br></p>
<p>exp.ipynb</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">149223181221309438217142971731290162048502071683234438807455153639165894737664410172266260056805353255967638568356843140306590887937</span></span><br><span class="line">g = <span class="number">7</span></span><br><span class="line">h = <span class="number">106414500627466044750537699496116452216938505790285966641538755230718107434518035561502262320845803494959251547594598724676292650073</span></span><br><span class="line"></span><br><span class="line">m=discrete_log(mod(h,p),mod(g,p))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{Congratulation! You crack the DLP problem!}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="cnss-"><a href="#cnss-" class="headerlink" title="cnss "></a>cnss </h2><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cnss</span><br><span class="line">Hint:Sage  Matrix  Vector </span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag  </span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">40</span></span><br><span class="line">p = <span class="number">9536720961414799253</span></span><br><span class="line">u = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">40</span>, <span class="number">5</span>):</span><br><span class="line">    u.append(bytes_to_long(flag[i:i+<span class="number">5</span>]))</span><br><span class="line">u = vector(u)</span><br><span class="line">A = random_matrix(Zmod(p), <span class="number">8</span>)</span><br><span class="line">v = u * A</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;A =&#x27;</span>, A)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;v =&#x27;</span>, v)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">A = [7907672172473958392 4938237561047760432 5072996306459844921  800347085054263333 2241217299487989740 5452520396763079026 7354205761061650589 5632270298193588206]</span></span><br><span class="line"><span class="string">[6856262700627435223 7218982369550725117 3069216736555490147 9043167152368671477 6651431740452419751 2904199636400840775 1984801523985180355 9424612078019686546]</span></span><br><span class="line"><span class="string">[ 190015986177831045  594687507332748466 2546708346651205091 3864956414971412519 2586812319675472372 2541554633306459284 2840981234492698127  400426130440806923]</span></span><br><span class="line"><span class="string">[ 354930743948767363  374079227033274174 7821379197355217415 4073976921774664952 8974661879090783904 8725597754431417139 1723115467249027682  914056616366301410]</span></span><br><span class="line"><span class="string">[9032929938905307703  569436029465728354 3230536280479973685 9499318835507740454  460664783708095350 3815328100857956310 6866516203996475375 9142528333783640721]</span></span><br><span class="line"><span class="string">[6647724854667560614 1564543033588842443  980081446425820918 4482664640152609224 9361385831487208956 5729265277086036438 8521779175294512538 7872078731489374461]</span></span><br><span class="line"><span class="string">[2426759667632064565 2564361116290067541 5109836057988930695 3948680632682199428 8561341181219447072 5099840518920477627 9347277712921710222 4364598388067284951]</span></span><br><span class="line"><span class="string">[2143804620259054744 4318231909289693782 6284698432978577252 5529804751795288609 7903556036971407808 3730126758887833322 8782120630459581951 9050476736532525999]</span></span><br><span class="line"><span class="string">v = (4088048241727106122, 258857328202723850, 7303598013681209756, 3446975206276714926, 176458751236949790, 8151363680348349027, 8771366063042882128, 9003511237633705064)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>sage</p>
<p>exp.ipynb</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">9536720961414799253</span></span><br><span class="line">A = [[<span class="number">7907672172473958392</span>,<span class="number">4938237561047760432</span>,<span class="number">5072996306459844921</span>,<span class="number">800347085054263333</span>,<span class="number">2241217299487989740</span>,<span class="number">5452520396763079026</span>,<span class="number">7354205761061650589</span>,<span class="number">5632270298193588206</span>],</span><br><span class="line">[<span class="number">6856262700627435223</span>,<span class="number">7218982369550725117</span>,<span class="number">3069216736555490147</span>,<span class="number">9043167152368671477</span>,<span class="number">6651431740452419751</span>,<span class="number">2904199636400840775</span>,<span class="number">1984801523985180355</span>,<span class="number">9424612078019686546</span>],</span><br><span class="line">[<span class="number">190015986177831045</span>,<span class="number">594687507332748466</span>,<span class="number">2546708346651205091</span>,<span class="number">3864956414971412519</span>,<span class="number">2586812319675472372</span>,<span class="number">2541554633306459284</span>,<span class="number">2840981234492698127</span>,<span class="number">400426130440806923</span>],</span><br><span class="line">[<span class="number">354930743948767363</span>,<span class="number">374079227033274174</span>,<span class="number">7821379197355217415</span>,<span class="number">4073976921774664952</span>,<span class="number">8974661879090783904</span>,<span class="number">8725597754431417139</span>,<span class="number">1723115467249027682</span>,<span class="number">914056616366301410</span>],</span><br><span class="line">[<span class="number">9032929938905307703</span>,<span class="number">569436029465728354</span>,<span class="number">3230536280479973685</span>,<span class="number">9499318835507740454</span>,<span class="number">460664783708095350</span>,<span class="number">3815328100857956310</span>,<span class="number">6866516203996475375</span>,<span class="number">9142528333783640721</span>],</span><br><span class="line">[<span class="number">6647724854667560614</span>,<span class="number">1564543033588842443</span>,<span class="number">980081446425820918</span>,<span class="number">4482664640152609224</span>,<span class="number">9361385831487208956</span>,<span class="number">5729265277086036438</span>,<span class="number">8521779175294512538</span>,<span class="number">7872078731489374461</span>],</span><br><span class="line">[<span class="number">2426759667632064565</span>,<span class="number">2564361116290067541</span>,<span class="number">5109836057988930695</span>,<span class="number">3948680632682199428</span>,<span class="number">8561341181219447072</span>,<span class="number">5099840518920477627</span>,<span class="number">9347277712921710222</span>,<span class="number">4364598388067284951</span>],</span><br><span class="line">[<span class="number">2143804620259054744</span>,<span class="number">4318231909289693782</span>,<span class="number">6284698432978577252</span>,<span class="number">5529804751795288609</span>,<span class="number">7903556036971407808</span>,<span class="number">3730126758887833322</span>,<span class="number">8782120630459581951</span>,<span class="number">9050476736532525999</span>]]</span><br><span class="line"></span><br><span class="line">ans = [<span class="number">4088048241727106122</span>, <span class="number">258857328202723850</span>, <span class="number">7303598013681209756</span>, <span class="number">3446975206276714926</span>, <span class="number">176458751236949790</span>, <span class="number">8151363680348349027</span>, <span class="number">8771366063042882128</span>, <span class="number">9003511237633705064</span>]</span><br><span class="line">A = matrix(A)</span><br><span class="line">ans = matrix(ans)</span><br><span class="line"></span><br><span class="line">flag = ans * A.inverse()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag</span></span><br><span class="line">flag = [<span class="number">256128467098287645152364579619033136532012336082411188262170716121111141373910417997647279385874168289963422098883372524388175789168151018039664118938</span>/<span class="number">201110710500527103391704345109970877861492963385688540350899980246056954432876844511421798766202341953924005687593642435623584608348351172354206968203</span>,-<span class="number">275157020682273200260243873388370073035487413746791277567209773631463468440360425377838149581773104213153845176881963804588249058534505227929576082442</span>/<span class="number">201110710500527103391704345109970877861492963385688540350899980246056954432876844511421798766202341953924005687593642435623584608348351172354206968203</span>,<span class="number">205418055261423253440834873996888852743735400527184165431288083430874722579052114104669136088527642186595043026543683492544648632576976821633919688987</span>/<span class="number">67036903500175701130568115036656959287164321128562846783633326748685651477625614837140599588734113984641335229197880811874528202782783724118068989401</span>,<span class="number">18887682222057954947813918789359532063827948125435329591909175563625225112660734620218938715145807440112704581336669611824654566923603748916776016972</span>/<span class="number">67036903500175701130568115036656959287164321128562846783633326748685651477625614837140599588734113984641335229197880811874528202782783724118068989401</span>,-<span class="number">25792447761509638420556125881168126603544490324749544374648563355312526747005861915100426458158515036632551136815312658182069136958880193280291853604</span>/<span class="number">201110710500527103391704345109970877861492963385688540350899980246056954432876844511421798766202341953924005687593642435623584608348351172354206968203</span>,<span class="number">263743295233022646271965564265774549530140797857736570979958721892220519418537528753856004044323800915867363751008926223858363297878551362225736657993</span>/<span class="number">201110710500527103391704345109970877861492963385688540350899980246056954432876844511421798766202341953924005687593642435623584608348351172354206968203</span>,-<span class="number">839256526384408301445325525932265486477039492555936647496320730347707472223889935476141937534810747723549651396954028900430020396698162916210131940419</span>/<span class="number">201110710500527103391704345109970877861492963385688540350899980246056954432876844511421798766202341953924005687593642435623584608348351172354206968203</span>,<span class="number">165200370960939593750718733159922760922513289005013438437371715048231002848101266223391623531454692435044072426966916629687643829467166749676754679429</span>/<span class="number">67036903500175701130568115036656959287164321128562846783633326748685651477625614837140599588734113984641335229197880811874528202782783724118068989401</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(long_to_bytes(<span class="built_in">int</span>(i % p)))[<span class="number">2</span>:-<span class="number">1</span>],end = <span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{Line8ar alg3ebra 1s 50 i0mportant!}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="HomoBlock"><a href="#HomoBlock" class="headerlink" title="HomoBlock"></a>HomoBlock</h2><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Homo</span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getRandomNBitInteger</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">b&#x27;cnss&#123;I_a&#x27;</span>) <span class="keyword">and</span> flag.endswith(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag)%<span class="number">8</span>==<span class="number">0</span></span><br><span class="line">MASK1 = getRandomNBitInteger(<span class="number">32</span>)|(<span class="number">0xffffffff00000000</span>)</span><br><span class="line">MASK2 = getRandomNBitInteger(<span class="number">32</span>)&lt;&lt;<span class="number">32</span></span><br><span class="line">ROUND = <span class="number">5</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genKey</span>():</span><br><span class="line">    tmp = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ROUND):</span><br><span class="line">        tmp.append(getRandomNBitInteger(<span class="number">64</span>))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">NotHomoFunction</span>(<span class="params">x,iv,key</span>):</span><br><span class="line">    <span class="keyword">return</span> ((x&lt;&lt;iv)&amp;MASK1)^((x&gt;&gt;iv)|MASK2)^key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">message,iv,key</span>):</span><br><span class="line">    cipher = bytes_to_long(message)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ROUND):</span><br><span class="line">        cipher = NotHomoFunction(cipher,iv,key)</span><br><span class="line">    <span class="keyword">return</span> cipher</span><br><span class="line"></span><br><span class="line">cipher = []</span><br><span class="line">iv = <span class="number">32</span></span><br><span class="line">key = getRandomNBitInteger(<span class="number">64</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(flag),<span class="number">8</span>):</span><br><span class="line">    cipher.append(encrypt(flag[i:i+<span class="number">8</span>],iv,key))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(cipher)</span><br><span class="line"><span class="built_in">print</span>(iv)</span><br><span class="line"><span class="built_in">print</span>(MASK2)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot; </span></span><br><span class="line"><span class="string">[4840951631397558164, 5492303526413306583, 6271460196030786735, 6127905759336302986, 601209385465514967]</span></span><br><span class="line"><span class="string">32</span></span><br><span class="line"><span class="string">16500653344889503744</span></span><br></pre></td></tr></table></figure>
<p>:</p>
<ul>
<li>8</li>
<li>32 MASK2 key</li>
</ul>
<p>45 MASK2 keykey</p>
<p><br></p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;cnss&#123;I_a&#x27;</span></span><br><span class="line">f0 = bytes_to_long(flag)</span><br><span class="line">p = [<span class="number">4840951631397558164</span>, <span class="number">5492303526413306583</span>, <span class="number">6271460196030786735</span>, <span class="number">6127905759336302986</span>, <span class="number">601209385465514967</span>]</span><br><span class="line">MASK2 = <span class="number">16500653344889503744</span></span><br><span class="line">f1 = p[<span class="number">0</span>]</span><br><span class="line">hf0, lf0 = (f0 &gt;&gt; <span class="number">32</span>, f0 % (<span class="number">2</span> ** <span class="number">32</span>))</span><br><span class="line">hf1, lf1 = (f1 &gt;&gt; <span class="number">32</span>, f1 % (<span class="number">2</span> ** <span class="number">32</span>))</span><br><span class="line">hk = hf1 ^ lf0 ^ (MASK2 &gt;&gt; <span class="number">32</span>)</span><br><span class="line">lk = lf1 ^ hf0</span><br><span class="line">key = (hk &lt;&lt; <span class="number">32</span>) + lk</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> p:</span><br><span class="line">	l, h = ((i ^ MASK2 ^ key) &gt;&gt; <span class="number">32</span>, (i ^ MASK2 ^ key) % (<span class="number">2</span> ** <span class="number">32</span>))</span><br><span class="line">	flag += long_to_bytes((h &lt;&lt; <span class="number">32</span>) | l).decode()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{I_am_n0t_HHHHHHoooommmmmmmoooo0000}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="ezLFSR"><a href="#ezLFSR" class="headerlink" title="ezLFSR"></a>ezLFSR</h2><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">do you know LFSR?</span><br><span class="line">Hint1: LFSR</span><br><span class="line">Hint2: z3solver </span><br></pre></td></tr></table></figure>
<p></p>
<p>task.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> mask,seed</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LFSR</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed, mask, length</span>):</span><br><span class="line">        self.length_mask = <span class="number">2</span> ** length - <span class="number">1</span></span><br><span class="line">        self.mask = mask &amp; self.length_mask</span><br><span class="line">        self.state = seed &amp; self.length_mask</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        next_state = (self.state &lt;&lt; <span class="number">1</span>) &amp; self.length_mask</span><br><span class="line">        i = self.state &amp; self.mask &amp; self.length_mask</span><br><span class="line">        output = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i != <span class="number">0</span>:</span><br><span class="line">            output ^= (i &amp; <span class="number">1</span>)</span><br><span class="line">            i = i &gt;&gt; <span class="number">1</span></span><br><span class="line">        next_state ^= output</span><br><span class="line">        self.state = next_state</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getrandbit</span>(<span class="params">self, nbit</span>):</span><br><span class="line">        output = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(nbit):</span><br><span class="line">            output = (output &lt;&lt; <span class="number">1</span>) ^ self.<span class="built_in">next</span>()</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">cipher, ipath, opath</span>):</span><br><span class="line">    ifile=<span class="built_in">open</span>(ipath,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">    ofile=<span class="built_in">open</span>(opath,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">    plaintext=ifile.read()</span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> plaintext:</span><br><span class="line">        c=ch^cipher.getrandbit(<span class="number">8</span>)</span><br><span class="line">        ofile.write(long_to_bytes(c))</span><br><span class="line">    ifile.close()</span><br><span class="line">    ofile.close()</span><br><span class="line"></span><br><span class="line">lfsr = LFSR(seed, mask, <span class="number">16</span>)</span><br><span class="line">encrypt(lfsr,<span class="string">&#x27;flag.txt&#x27;</span>,<span class="string">&#x27;cipher.enc&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;seed = <span class="subst">&#123;seed&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># seed = 37285</span></span><br></pre></td></tr></table></figure>
<p>cipher.enc</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">E3306EA1B67E13D02B59A0DEA270AD8C3AF0110FBF60C07740A699A5918E7DC5</span><br></pre></td></tr></table></figure>
<p>mask1665536</p>
<p><br></p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LFSR</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed, mask, length</span>):</span><br><span class="line">        self.length_mask = <span class="number">2</span> ** length - <span class="number">1</span></span><br><span class="line">        self.mask = mask &amp; self.length_mask</span><br><span class="line">        self.state = seed &amp; self.length_mask</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        next_state = (self.state &lt;&lt; <span class="number">1</span>) &amp; self.length_mask</span><br><span class="line">        i = self.state &amp; self.mask &amp; self.length_mask</span><br><span class="line">        output = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i != <span class="number">0</span>:</span><br><span class="line">            output ^= (i &amp; <span class="number">1</span>)</span><br><span class="line">            i = i &gt;&gt; <span class="number">1</span></span><br><span class="line">        next_state ^= output</span><br><span class="line">        self.state = next_state</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getrandbit</span>(<span class="params">self, nbit</span>):</span><br><span class="line">        output = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(nbit):</span><br><span class="line">            output = (output &lt;&lt; <span class="number">1</span>) ^ self.<span class="built_in">next</span>()</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line">seed = <span class="number">37285</span></span><br><span class="line">hex_string = <span class="string">&quot;E3306EA1B67E13D02B59A0DEA270AD8C3AF0110FBF60C07740A699A5918E7DC5&quot;</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line">split_hex = [hex_string[i:i+<span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(hex_string), <span class="number">2</span>)]</span><br><span class="line"></span><br><span class="line">c = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> split_hex:</span><br><span class="line">    c.append(<span class="built_in">int</span>(i,<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">16</span>):</span><br><span class="line">    mask = i</span><br><span class="line">    lfsr = LFSR(seed, mask, <span class="number">16</span>)</span><br><span class="line">    clist = []</span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> c:</span><br><span class="line">        temp=ch^lfsr.getrandbit(<span class="number">8</span>)</span><br><span class="line">        clist.append(<span class="built_in">chr</span>(temp))</span><br><span class="line">    str1 = <span class="string">&quot;&quot;</span>.join(clist)</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">&quot;cnss&quot;</span> <span class="keyword">in</span> str1):</span><br><span class="line">        <span class="built_in">print</span>(str1)</span><br></pre></td></tr></table></figure>
<p>1</p>
<p>flag:</p>
<font size="4" color="red">cnss{Y0u_can_brust_0r_F1nd_seed}</font>

<p>flaghintLFSR</p>
<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="RSA-"><a href="#RSA-" class="headerlink" title="RSA "></a>RSA </h2><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">It&#x27;s more difficult than RSA ,right? Can you factorize n ?</span><br><span class="line">Hint:RSA</span><br></pre></td></tr></table></figure>
<p><a href="https://eprint.iacr.org/2020/1506.pdf">1506.pdf (iacr.org)</a></p>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line">mask1 = <span class="number">8802124635072632944677646490123224379036416333544329119490072003355821545476873187055484863111312282268555945525261726909784693138184611507738758202965723</span></span><br><span class="line">mask2 = <span class="number">10267484648659998697412163107809730542736732193409802323765378917769614002176050843098384409535095473863894691160595931186139418791709781214996751031082601</span></span><br><span class="line"></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">mask1 = getPrime(<span class="number">512</span>)</span><br><span class="line">mask2 = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;mask1 = <span class="subst">&#123;mask1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;mask2 = <span class="subst">&#123;mask2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;h1 = <span class="subst">&#123;p&amp;mask1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;h2 = <span class="subst">&#123;q&amp;mask2&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 21645208345867622053024283678631971385301103104312441336174301067402923208233033116071987870811290403578077414872467955871236843078200772311176723821275372545792521252126496488134168455430882670865862282658077115199048181151105823370547063726203692258934054391552916645628374539820099986794258298843501009240</span></span><br><span class="line"><span class="string">n = 87282921750815275717132715603847471604654006135344540742956637574882193904171665195367477260090328888053170090015909620539666069545618781812315864580009968838414539707616636379202667918204792277927294032362873240288573251987386601263377458038218959813925307265939433229169884527274177006792047369788293125409</span></span><br><span class="line"><span class="string">mask1 = 8802124635072632944677646490123224379036416333544329119490072003355821545476873187055484863111312282268555945525261726909784693138184611507738758202965723</span></span><br><span class="line"><span class="string">mask2 = 10267484648659998697412163107809730542736732193409802323765378917769614002176050843098384409535095473863894691160595931186139418791709781214996751031082601</span></span><br><span class="line"><span class="string">h1 = 6706231204421711988537353586716977912583550778985616494052350868539347641557164021930575245010900470979740623857738159245103694128834121517146255441177729</span></span><br><span class="line"><span class="string">h2 = 6704397956705493482354535847135592349486638396996488745737387153856868045426992197309829534096366784379171117205125136777653995357887539312554042026362473</span></span><br></pre></td></tr></table></figure>
<p>RSA1pq</p>
<ul>
<li>&amp;1p1</li>
<li>&amp;0mask1p0</li>
</ul>
<p>&amp;0mask0ppq</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1pq0512pqn</span><br><span class="line">2pq1512pqn</span><br></pre></td></tr></table></figure>
<p>pq</p>
<p><br></p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">21645208345867622053024283678631971385301103104312441336174301067402923208233033116071987870811290403578077414872467955871236843078200772311176723821275372545792521252126496488134168455430882670865862282658077115199048181151105823370547063726203692258934054391552916645628374539820099986794258298843501009240</span></span><br><span class="line">n = <span class="number">87282921750815275717132715603847471604654006135344540742956637574882193904171665195367477260090328888053170090015909620539666069545618781812315864580009968838414539707616636379202667918204792277927294032362873240288573251987386601263377458038218959813925307265939433229169884527274177006792047369788293125409</span></span><br><span class="line">mask1 = <span class="number">8802124635072632944677646490123224379036416333544329119490072003355821545476873187055484863111312282268555945525261726909784693138184611507738758202965723</span></span><br><span class="line">mask2 = <span class="number">10267484648659998697412163107809730542736732193409802323765378917769614002176050843098384409535095473863894691160595931186139418791709781214996751031082601</span></span><br><span class="line">h1 = <span class="number">6706231204421711988537353586716977912583550778985616494052350868539347641557164021930575245010900470979740623857738159245103694128834121517146255441177729</span></span><br><span class="line">h2 = <span class="number">6704397956705493482354535847135592349486638396996488745737387153856868045426992197309829534096366784379171117205125136777653995357887539312554042026362473</span></span><br><span class="line">mask1 = <span class="built_in">str</span>(<span class="built_in">bin</span>(mask1)[<span class="number">2</span>:])</span><br><span class="line">mask2 = <span class="built_in">str</span>(<span class="built_in">bin</span>(mask2)[<span class="number">2</span>:])</span><br><span class="line">h1 = <span class="built_in">str</span>(<span class="built_in">bin</span>(h1)[<span class="number">2</span>:])</span><br><span class="line">h2 = <span class="built_in">str</span>(<span class="built_in">bin</span>(h2)[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find</span>(<span class="params">p,q</span>):</span><br><span class="line">    l = <span class="built_in">len</span>(p)</span><br><span class="line">    tmp0 = p + (<span class="number">512</span>-l)*<span class="string">&quot;0&quot;</span></span><br><span class="line">    tmp1 = p + (<span class="number">512</span>-l)*<span class="string">&quot;1&quot;</span></span><br><span class="line">    tmq0 = q + (<span class="number">512</span>-l)*<span class="string">&quot;0&quot;</span></span><br><span class="line">    tmq1 = q + (<span class="number">512</span>-l)*<span class="string">&quot;1&quot;</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">int</span>(tmp0,<span class="number">2</span>)*<span class="built_in">int</span>(tmq0,<span class="number">2</span>) &gt; n):</span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    <span class="keyword">elif</span>(<span class="built_in">int</span>(tmp1,<span class="number">2</span>)*<span class="built_in">int</span>(tmq1,<span class="number">2</span>) &lt; n):</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(l == <span class="number">512</span>):</span><br><span class="line">        <span class="comment">#print(tmp0)</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">int</span>(tmp0,<span class="number">2</span>))</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">int</span>(tmq0,<span class="number">2</span>))</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span>((mask1[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;1&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;1&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span>((mask1[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;1&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;0&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span>((mask1[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;1&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;0&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;0&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span>((mask1[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;0&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;1&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span>((mask1[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;0&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;0&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span>((mask1[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;0&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;0&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;0&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">elif</span>((mask1[l] == <span class="string">&quot;0&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;0&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;1&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span>((mask1[l] == <span class="string">&quot;0&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;0&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;0&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span>((mask1[l] == <span class="string">&quot;0&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;0&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;0&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;0&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line"></span><br><span class="line">tempp = <span class="string">&quot;&quot;</span></span><br><span class="line">tempq = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#find(tempp,tempq)</span></span><br><span class="line">P = <span class="number">10172774442863868719013872884099170294615753094066736187886125116462340120031133533430755779832487215255546434139069419394249074006281284289077492708469893</span></span><br><span class="line">Q = <span class="number">8580050824978592226795441601299432164577158891190171233964440597982925469924083252289609500726234367555160732119333211934059529993446003001925910065317613</span></span><br><span class="line">phi = (P-<span class="number">1</span>)*(Q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{A1g0r1thm_1s_5o_hard_for_Me!}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="BabyLattice"><a href="#BabyLattice" class="headerlink" title="BabyLattice"></a>BabyLattice</h2><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Do you know SVP and LLL?</span><br><span class="line">Hint:(Lattice),LLL</span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">32</span></span><br><span class="line">flagArg = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">32</span>,<span class="number">8</span>):</span><br><span class="line">    flag_tmp = bytes_to_long(flag[i:i+<span class="number">8</span>])</span><br><span class="line">    <span class="keyword">assert</span> flag_tmp &lt; <span class="number">2</span>**<span class="number">64</span></span><br><span class="line">    flagArg.append(flag_tmp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Equation</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,arg</span>):</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(arg)==<span class="number">4</span></span><br><span class="line">        self.arg = arg</span><br><span class="line">        self.modulus = getRandomInteger(<span class="number">512</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">output</span>(<span class="params">self</span>):</span><br><span class="line">        ans = <span class="number">0</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;the modulus is <span class="subst">&#123;self.modulus&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            tmp = getRandomInteger(<span class="number">512</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;The number of the <span class="subst">&#123;i&#125;</span> round is <span class="subst">&#123;tmp&#125;</span>&#x27;</span>)</span><br><span class="line">            ans+=self.arg[i]*tmp</span><br><span class="line">        ans = ans%self.modulus</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;The result is <span class="subst">&#123;ans&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">EzLineModulus = Equation(flagArg)</span><br><span class="line">EzLineModulus.output()</span><br><span class="line"></span><br><span class="line"><span class="comment">#the modulus is 4653980939589101565044285021945025573290906789132633751963110127801187748089540230208429714310516635848025358481189017398970169440484136391436220837417791</span></span><br><span class="line"><span class="comment">#The number of the 0 round is 7163515288721018524391838724005494502072524058809935946689587023614778895762400663698973734684519790842142248155478226513293289043832391054661263177469005</span></span><br><span class="line"><span class="comment">#The number of the 1 round is 13155134533945105613277690072743652931283618211062662861216511364398097684219572559463369279253337759860439150691008846033587645344197431244106331100681641</span></span><br><span class="line"><span class="comment">#The number of the 2 round is 8450640520436960190933104494093081291057363628588171820766164606066614201483259024304043681871965360847257453187101669512010469318096007617859083021766564</span></span><br><span class="line"><span class="comment">#The number of the 3 round is 798383352075970107818638521362593273862636131165588181505120596765884650403289567593307005746576184176902675297124272602141002375036927828390204063589274</span></span><br><span class="line"><span class="comment">#The result is 58831711102590059067743519228568722360433408071362335858674496753241059990433991177195518029785828762522018556332340356592798263267784406825183284767956</span></span><br></pre></td></tr></table></figure>
<p>Lattice</p>
<p>Lattice</p>
<p><br></p>
<p>exp.ipynb</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">4653980939589101565044285021945025573290906789132633751963110127801187748089540230208429714310516635848025358481189017398970169440484136391436220837417791</span></span><br><span class="line">a1 = <span class="number">7163515288721018524391838724005494502072524058809935946689587023614778895762400663698973734684519790842142248155478226513293289043832391054661263177469005</span></span><br><span class="line">a2 = <span class="number">13155134533945105613277690072743652931283618211062662861216511364398097684219572559463369279253337759860439150691008846033587645344197431244106331100681641</span></span><br><span class="line">a3 = <span class="number">8450640520436960190933104494093081291057363628588171820766164606066614201483259024304043681871965360847257453187101669512010469318096007617859083021766564</span></span><br><span class="line">a4 = <span class="number">798383352075970107818638521362593273862636131165588181505120596765884650403289567593307005746576184176902675297124272602141002375036927828390204063589274</span></span><br><span class="line">ans = <span class="number">58831711102590059067743519228568722360433408071362335858674496753241059990433991177195518029785828762522018556332340356592798263267784406825183284767956</span></span><br><span class="line">inv = inverse(a1,n)</span><br><span class="line">L = Matrix(ZZ, [[<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,-ans*inv],</span><br><span class="line">                [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>,a2*inv],</span><br><span class="line">                [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>,a3*inv],</span><br><span class="line">                [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>,a4*inv],</span><br><span class="line">                [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,n]])</span><br><span class="line"></span><br><span class="line">v = L.LLL()[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(long_to_bytes(<span class="built_in">abs</span>(v[<span class="number">4</span>])))[<span class="number">2</span>:-<span class="number">1</span>],end = <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(v)-<span class="number">1</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(long_to_bytes(<span class="built_in">abs</span>(v[i])))[<span class="number">2</span>:-<span class="number">1</span>],end = <span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{W0w!Y0u_know_WhatisL4ttice}</font>

<p></p>
<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="ezSignature"><a href="#ezSignature" class="headerlink" title="ezSignature"></a>ezSignature</h2><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">nc 43.156.14.141 6943</span><br><span class="line"></span><br><span class="line">Hint1:pwntools</span><br><span class="line">Hint2: DSA </span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> DSA</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters + string.digits</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DigitalSignatureAlgorithm</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, key</span>):</span><br><span class="line">        self.p = key.p</span><br><span class="line">        self.q = key.q</span><br><span class="line">        self.g = key.g</span><br><span class="line">        self.y = key.y</span><br><span class="line">        self.x = key.x</span><br><span class="line">        self.k = randint(<span class="number">1</span>, self.q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">self, m</span>):</span><br><span class="line">        k = self.k</span><br><span class="line">        h = bytes_to_long(sha256(m).digest())</span><br><span class="line">        r = <span class="built_in">pow</span>(self.g, k, self.p) % self.q</span><br><span class="line">        s = inverse(k, self.q) * (h + self.x * r) % self.q</span><br><span class="line">        <span class="keyword">return</span> r, s</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">self, m, signature</span>):</span><br><span class="line">        r, s = signature</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">not</span> (<span class="number">1</span> &lt;= r &lt;= self.q - <span class="number">1</span>)) <span class="keyword">or</span> (<span class="keyword">not</span> (<span class="number">1</span> &lt;= s &lt;= self.q - <span class="number">1</span>)):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        z = bytes_to_long(sha256(m).digest())</span><br><span class="line">        w = inverse(s, self.q)</span><br><span class="line">        u1 = (z * w) % self.q</span><br><span class="line">        u2 = (r * w) % self.q</span><br><span class="line">        v = (<span class="built_in">pow</span>(self.g, u1, self.p) * <span class="built_in">pow</span>(self.y, u2, self.p)) % self.p % self.q</span><br><span class="line">        <span class="keyword">return</span> r == v</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">myDSA = DigitalSignatureAlgorithm(DSA.generate(<span class="number">1024</span>))</span><br><span class="line">MENU = <span class="string">br&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[1] Sign.</span></span><br><span class="line"><span class="string">[2] Verify.</span></span><br><span class="line"><span class="string">[3] Get_public_key.</span></span><br><span class="line"><span class="string">[4] Exit.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Task</span>(socketserver.BaseRequestHandler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_recvall</span>(<span class="params">self</span>):</span><br><span class="line">        BUFF_SIZE = <span class="number">2048</span></span><br><span class="line">        data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            part = self.request.recv(BUFF_SIZE)</span><br><span class="line">            data += part</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(part) &lt; BUFF_SIZE:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> data.strip()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">send</span>(<span class="params">self, msg, newline=<span class="literal">True</span></span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> newline:</span><br><span class="line">                msg += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line">            self.request.sendall(msg)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">recv</span>(<span class="params">self, prompt=<span class="string">b&#x27;[-] &#x27;</span></span>):</span><br><span class="line">        self.send(prompt, newline=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> self._recvall()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">proof_of_work</span>(<span class="params">self</span>):</span><br><span class="line">        proof = (<span class="string">&#x27;&#x27;</span>.join([choice(table) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>)])).encode()</span><br><span class="line">        sha = sha256(proof).hexdigest().encode()</span><br><span class="line">        self.send(<span class="string">b&quot;[+] sha256(XXXX+&quot;</span> + proof[<span class="number">4</span>:] + <span class="string">b&quot;) == &quot;</span> + sha)</span><br><span class="line">        XXXX = self.recv(prompt=<span class="string">b&#x27;[+] Plz Tell Me XXXX :&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(XXXX) != <span class="number">4</span> <span class="keyword">or</span> sha256(XXXX + proof[<span class="number">4</span>:]).hexdigest().encode() != sha:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">self</span>):</span><br><span class="line">        m1 = <span class="string">b&#x27;I want to tell you a secret&#x27;</span></span><br><span class="line">        m2 = <span class="string">b&#x27;Can you find it?&#x27;</span></span><br><span class="line">        signature1 = myDSA.sign(m1)</span><br><span class="line">        signature2 = myDSA.sign(m2)</span><br><span class="line">        self.send(<span class="string">b&#x27;Your signature1 is:&#x27;</span> + <span class="built_in">str</span>(signature1).encode())</span><br><span class="line">        self.send(<span class="string">b&#x27;Your signature2 is:&#x27;</span> + <span class="built_in">str</span>(signature2).encode())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">self</span>):</span><br><span class="line">        m = self.recv(<span class="string">b&#x27;message:&#x27;</span>)</span><br><span class="line">        r = <span class="built_in">int</span>(self.recv(<span class="string">b&#x27;r:&#x27;</span>))</span><br><span class="line">        s = <span class="built_in">int</span>(self.recv(<span class="string">b&#x27;s:&#x27;</span>))</span><br><span class="line">        signature = (r, s)</span><br><span class="line">        <span class="keyword">if</span> m == <span class="string">b&quot;I&#x27;m Admin.I want flag.&quot;</span>:</span><br><span class="line">            <span class="keyword">if</span> myDSA.verify(m, signature):</span><br><span class="line">                self.send(<span class="string">b&#x27;Hello there.This is what you want.&#x27;</span>)</span><br><span class="line">                self.send(flag)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.send(<span class="string">b&#x27;Who are U?Get out!&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.send(<span class="string">b&#x27;Who are U?Get out!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_public_key</span>(<span class="params">self</span>):</span><br><span class="line">        self.send(<span class="string">b&#x27;p = &#x27;</span> + <span class="built_in">str</span>(myDSA.p).encode())</span><br><span class="line">        self.send(<span class="string">b&#x27;q = &#x27;</span> + <span class="built_in">str</span>(myDSA.q).encode())</span><br><span class="line">        self.send(<span class="string">b&#x27;g = &#x27;</span> + <span class="built_in">str</span>(myDSA.g).encode())</span><br><span class="line">        self.send(<span class="string">b&#x27;y = &#x27;</span> + <span class="built_in">str</span>(myDSA.y).encode())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self</span>):</span><br><span class="line">        signal.alarm(<span class="number">30</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.proof_of_work():</span><br><span class="line">            self.send(<span class="string">b&#x27;You must pass the P0W!!!&#x27;</span>)</span><br><span class="line">            self.request.close()</span><br><span class="line">        <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">            self.send(MENU)</span><br><span class="line">            option = <span class="built_in">int</span>(self.recv(prompt=<span class="string">b&#x27;Give me your option:&#x27;</span>))</span><br><span class="line">            <span class="keyword">if</span> option == <span class="number">1</span>:</span><br><span class="line">                self.sign()</span><br><span class="line">            <span class="keyword">elif</span> option == <span class="number">2</span>:</span><br><span class="line">                self.verify()</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">elif</span> option == <span class="number">3</span>:</span><br><span class="line">                self.get_public_key()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        self.request.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST, PORT = <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">10001</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;HOST:POST &quot;</span> + HOST + <span class="string">&quot;:&quot;</span> + <span class="built_in">str</span>(PORT))</span><br><span class="line">    server = ThreadedServer((HOST, PORT), Task)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure>
<p>DSADSA</p>
<p>signkkkkkk</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line">p = <span class="number">172961942888113119438093761564402163853274437530074061334853565231663662473345365517029153614577994838261528197758562341350007269014020447862968046418219322983982857376325091297503076457294884011022491521807290579653731078712552375942815577480924479760060089879761373677236785972440188569442167867715538948131</span></span><br><span class="line">q = <span class="number">1238294525750070611176801188652181858159488474961</span></span><br><span class="line">g = <span class="number">75657702601417227921344829575623735976532473731371029415534443940309702116075857552168402559956825576158353466597825895213717785384352099702983338787137184850387592826820271959589796127014544636714131043162304391677607332131259874984936943058742638800688694139378157588974460944304847089533750902878536046649</span></span><br><span class="line">y = <span class="number">7749296960818920297640684628219596188301310658741359444363507697372166821952159177715756651776536866582220227892407461198512231438360662343916445812054004711764127526569139925464723782772657462476688091598602960531766048824996984183046388253897618420503521674510979988799110962834514762035965219607971731464</span></span><br><span class="line"></span><br><span class="line">r1,s1 = (<span class="number">952312130113235199710494038379463278196320139331</span>, <span class="number">246708316787437486170638565016913560785356026546</span>)</span><br><span class="line">r2,s2 = (<span class="number">952312130113235199710494038379463278196320139331</span>, <span class="number">604408984593559575502554675534691666132540008638</span>)</span><br><span class="line"></span><br><span class="line">m1 = <span class="string">b&#x27;I want to tell you a secret&#x27;</span></span><br><span class="line">m2 = <span class="string">b&#x27;Can you find it?&#x27;</span></span><br><span class="line">h1 = bytes_to_long(sha256(m1).digest())</span><br><span class="line">h2 = bytes_to_long(sha256(m2).digest())</span><br><span class="line"></span><br><span class="line">k = (h1-h2)*inverse(s1-s2,q)</span><br><span class="line">x = (k*s1 - h1)*inverse(r1,q) % q</span><br><span class="line"></span><br><span class="line">m = <span class="string">b&quot;I&#x27;m Admin.I want flag.&quot;</span></span><br><span class="line">h = bytes_to_long(sha256(m).digest())</span><br><span class="line">r = <span class="built_in">pow</span>(g, k, p) % q</span><br><span class="line">s = inverse(k, q) * (h + x * r) % q</span><br><span class="line"><span class="built_in">print</span>(r)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br></pre></td></tr></table></figure>
<p>(rsxshellsha256rspwntools)</p>
<p>flag:</p>
<font size="4" color="red">cnss{1ts_Dr4nger0us_t0_u5eThe_Same_K}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="StrangeCurve"><a href="#StrangeCurve" class="headerlink" title="StrangeCurve"></a>StrangeCurve</h2><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">The Cruve is SOO0000 Strange!</span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">rom Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">5</span>]==<span class="string">&#x27;cnss&#123;&#x27;</span> <span class="keyword">and</span> flag[-<span class="number">1</span>] == <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">flag_k = bytes_to_long(flag[<span class="number">5</span>:-<span class="number">1</span>].encode())</span><br><span class="line"></span><br><span class="line">p = <span class="number">1096126227998177188652856107362412783873814431647</span></span><br><span class="line">a = <span class="number">0</span></span><br><span class="line">b = <span class="number">5</span></span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> E.order() == p </span><br><span class="line">base_point = E(<span class="number">626099523290649705896889901241128842906228328604</span>,<span class="number">886038875771695334071307095455656761758842526929</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> base_point <span class="keyword">in</span> E</span><br><span class="line"><span class="keyword">assert</span> flag_k &lt; p </span><br><span class="line"></span><br><span class="line">Q = flag_k*base_point</span><br><span class="line"><span class="built_in">print</span>(Q)</span><br><span class="line"></span><br><span class="line"><span class="comment"># (240653647745552223089451307742208085297121769374 : 1041806436100548540817642210994295951394712587396 : 1)</span></span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">assert</span> E.order() == p </span><br></pre></td></tr></table></figure>
<p>Smarts attack</p>
<p><br></p>
<p>exp.ipynb</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SmartAttack</span>(<span class="params">P,Q,p</span>):</span><br><span class="line">    E = P.curve()</span><br><span class="line">    Eqp = EllipticCurve(Qp(p, <span class="number">2</span>), [ ZZ(t) + randint(<span class="number">0</span>,p)*p <span class="keyword">for</span> t <span class="keyword">in</span> E.a_invariants() ])</span><br><span class="line"></span><br><span class="line">    P_Qps = Eqp.lift_x(ZZ(P.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> P_Qp <span class="keyword">in</span> P_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(P_Qp.xy()[<span class="number">1</span>]) == P.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    Q_Qps = Eqp.lift_x(ZZ(Q.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> Q_Qp <span class="keyword">in</span> Q_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(Q_Qp.xy()[<span class="number">1</span>]) == Q.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    p_times_P = p*P_Qp</span><br><span class="line">    p_times_Q = p*Q_Qp</span><br><span class="line"></span><br><span class="line">    x_P,y_P = p_times_P.xy()</span><br><span class="line">    x_Q,y_Q = p_times_Q.xy()</span><br><span class="line"></span><br><span class="line">    phi_P = -(x_P/y_P)</span><br><span class="line">    phi_Q = -(x_Q/y_Q)</span><br><span class="line">    k = phi_Q/phi_P</span><br><span class="line">    <span class="keyword">return</span> ZZ(k)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = <span class="number">1096126227998177188652856107362412783873814431647</span></span><br><span class="line">a = <span class="number">0</span></span><br><span class="line">b = <span class="number">5</span></span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line"></span><br><span class="line">P = E(<span class="number">626099523290649705896889901241128842906228328604</span>,<span class="number">886038875771695334071307095455656761758842526929</span>)</span><br><span class="line">Q = E(<span class="number">240653647745552223089451307742208085297121769374</span>,<span class="number">1041806436100548540817642210994295951394712587396</span>)</span><br><span class="line"></span><br><span class="line">n = SmartAttack(P, Q, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;cnss&#123;&quot;</span> + <span class="built_in">str</span>(long_to_bytes(n))[<span class="number">2</span>:-<span class="number">1</span>] + <span class="string">&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{DLPise45y_if5pecia1}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id=""><a href="#" class="headerlink" title=""></a></h2><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">NTRU,NTR u()</span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> shuffle, getrandbits</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">Zx = PolynomialRing(ZZ, <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">x = Zx.gen()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convolution</span>(<span class="params">f, g, R</span>):</span><br><span class="line">    <span class="keyword">return</span> (f * g) % R</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">balancedmod</span>(<span class="params">f, q, R</span>):</span><br><span class="line">    g = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x: ((x + q//<span class="number">2</span>) % q) - q//<span class="number">2</span>, f.<span class="built_in">list</span>()))</span><br><span class="line">    <span class="keyword">return</span> Zx(g) % R</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">random_poly</span>(<span class="params">n, d1, d2</span>):</span><br><span class="line">    <span class="keyword">assert</span> d1 + d2 &lt;= n</span><br><span class="line">    result = d1 * [<span class="number">1</span>] + d2 * [-<span class="number">1</span>] + (n - d1 - d2) * [<span class="number">0</span>]</span><br><span class="line">    shuffle(result)</span><br><span class="line">    <span class="keyword">return</span> Zx(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_poly_mod_prime</span>(<span class="params">f, R, p</span>):</span><br><span class="line">    T = Zx.change_ring(Integers(p)).quotient(R)</span><br><span class="line">    <span class="keyword">return</span> Zx(lift(<span class="number">1</span> / T(f)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_poly_mod_powerof2</span>(<span class="params">f, R, q</span>):  <span class="comment"># Hensel Lemma </span></span><br><span class="line">    g = invert_poly_mod_prime(f, R, <span class="number">2</span>)</span><br><span class="line">    e = log(q, <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e):</span><br><span class="line">        g = ((<span class="number">2</span> * g - f * g ** <span class="number">2</span>) % R) % q</span><br><span class="line">    <span class="keyword">return</span> g</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NTRUCipher</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, N, p, q, d</span>):</span><br><span class="line">        self.N = N</span><br><span class="line">        self.p = p</span><br><span class="line">        self.q = q</span><br><span class="line">        self.d = d</span><br><span class="line">        self.R = x ** N - <span class="number">1</span></span><br><span class="line">        <span class="comment"># key generation</span></span><br><span class="line">        self.g = random_poly(self.N, d, d)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                self.f = random_poly(self.N, d + <span class="number">1</span>, d)</span><br><span class="line">                self.fp = invert_poly_mod_prime(self.f, self.R, self.p)</span><br><span class="line">                self.fq = invert_poly_mod_powerof2(self.f, self.R, self.q)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        self.h = balancedmod(self.p * convolution(self.fq, self.g, self.R), self.q, self.R)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getPubKey</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.h</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, m</span>):</span><br><span class="line">        r = random_poly(self.N, self.d, self.d)</span><br><span class="line">        <span class="keyword">return</span> balancedmod(convolution(self.h, r, self.R) + m, self.q, self.R)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, c</span>):</span><br><span class="line">        a = balancedmod(convolution(c, self.f, self.R), self.q, self.R)</span><br><span class="line">        <span class="keyword">return</span> balancedmod(convolution(a, self.fp, self.R), self.p, self.R)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">self, val</span>):</span><br><span class="line">        poly = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.N):</span><br><span class="line">            poly += ((val % self.p) - self.p // <span class="number">2</span>) * (x ** i)</span><br><span class="line">            val //= self.p</span><br><span class="line">        <span class="keyword">return</span> poly</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">self, poly</span>):</span><br><span class="line">        result = <span class="number">0</span></span><br><span class="line">        ll = poly.<span class="built_in">list</span>()</span><br><span class="line">        <span class="keyword">for</span> idx, val <span class="keyword">in</span> <span class="built_in">enumerate</span>(ll):</span><br><span class="line">            result += (val + self.p // <span class="number">2</span>) * (self.p ** idx)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">poly_from_list</span>(<span class="params">self, l: <span class="built_in">list</span></span>):</span><br><span class="line">        <span class="keyword">return</span> Zx(l)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    N = <span class="number">160</span></span><br><span class="line">    d = <span class="number">30</span></span><br><span class="line">    p = <span class="number">3</span></span><br><span class="line">    q = <span class="number">65536</span></span><br><span class="line"></span><br><span class="line">    cipher = NTRUCipher(N, p, q, d) </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[PubKey]---------&quot;</span>)</span><br><span class="line">    h = cipher.getPubKey()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;h = <span class="subst">&#123;h&#125;</span>&#x27;</span>)</span><br><span class="line">    msg = bytes_to_long(flag)</span><br><span class="line">    encode_msg = cipher.encode(msg)</span><br><span class="line">    c = cipher.encrypt(encode_msg)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[Cipher]---------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line">    mm = cipher.decrypt(c)</span><br><span class="line">    decode_msg = cipher.decode(mm)</span><br><span class="line">    <span class="keyword">assert</span> decode_msg == msg</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[PubKey]---------</span></span><br><span class="line"><span class="string">h = -11891*x^159 + 16347*x^158 - 32137*x^157 + 14988*x^156 + 16657*x^155 - 25785*x^154 - 21976*x^153 - 31745*x^152 - 4232*x^151 + 29569*x^150 + 27140*x^149 + 19617*x^148 - 16656*x^147 + 8925*x^146 + 8728*x^145 - 8802*x^144 - 10794*x^143 - 28159*x^142 - 6454*x^141 - 10259*x^140 - 19169*x^139 - 14357*x^138 + 3501*x^137 + 9885*x^136 - 7441*x^135 + 18268*x^134 - 27183*x^133 + 26085*x^132 + 19147*x^131 + 17153*x^130 - 22887*x^129 + 32476*x^128 - 21698*x^127 + 19138*x^126 + 11585*x^125 + 22755*x^124 - 5920*x^123 + 7581*x^122 + 25973*x^121 + 13787*x^120 - 22762*x^119 + 29207*x^118 - 17916*x^117 - 11502*x^116 + 18275*x^115 + 318*x^114 - 6890*x^113 - 22751*x^112 - 27677*x^111 - 11114*x^110 + 8623*x^109 - 15725*x^108 - 6835*x^107 - 8288*x^106 - 5235*x^105 - 28697*x^104 + 10696*x^103 + 17117*x^102 + 24696*x^101 - 7801*x^100 - 31874*x^99 - 17668*x^98 - 11204*x^97 + 19147*x^96 + 24644*x^95 - 29380*x^94 - 26237*x^93 - 27390*x^92 + 19982*x^91 + 4074*x^90 - 17248*x^89 - 11027*x^88 - 32690*x^87 + 5124*x^86 - 20823*x^85 - 11779*x^84 + 13781*x^83 + 29356*x^82 - 9740*x^81 - 31484*x^80 - 540*x^79 + 32360*x^78 + 24795*x^77 - 8864*x^76 + 17363*x^75 + 9670*x^74 + 32268*x^73 + 17961*x^72 + 6388*x^71 + 580*x^70 + 128*x^69 + 339*x^68 + 3412*x^67 - 4519*x^66 - 25056*x^65 + 6096*x^64 + 18720*x^63 - 5338*x^62 + 16910*x^61 + 3353*x^60 + 15433*x^59 - 28053*x^58 - 18883*x^57 + 7688*x^56 - 31198*x^55 + 9950*x^54 - 9388*x^53 + 21235*x^52 + 2847*x^51 + 24383*x^50 + 19431*x^49 + 21244*x^48 - 8498*x^47 - 28998*x^46 + 962*x^45 + 20579*x^44 + 28002*x^43 - 6040*x^42 + 4241*x^41 + 11655*x^40 - 32419*x^39 + 21531*x^38 + 7348*x^37 - 5503*x^36 + 29820*x^35 + 28896*x^34 + 8754*x^33 + 17978*x^32 + 7552*x^31 + 27240*x^30 - 29515*x^29 - 20322*x^28 + 2201*x^27 + 8857*x^26 - 50*x^25 - 3780*x^24 - 12138*x^23 + 10893*x^22 + 23133*x^21 + 6142*x^20 - 23798*x^19 - 15236*x^18 + 32564*x^17 + 25683*x^16 - 24010*x^15 - 4355*x^14 + 22552*x^13 - 27155*x^12 + 27649*x^11 + 17781*x^10 + 7115*x^9 + 27465*x^8 - 4369*x^7 + 24882*x^6 - 11675*x^5 - 612*x^4 + 12361*x^3 + 20120*x^2 + 6190*x - 10843</span></span><br><span class="line"><span class="string">[Cipher]---------</span></span><br><span class="line"><span class="string">c = -26801*x^159 - 25103*x^158 + 29811*x^157 - 12251*x^156 - 13386*x^155 - 28030*x^154 - 16511*x^153 + 23761*x^152 + 28329*x^151 - 16406*x^150 + 30931*x^149 + 5326*x^148 + 19877*x^147 - 23165*x^146 - 31540*x^145 - 7923*x^144 + 5880*x^143 - 27078*x^142 - 25436*x^141 - 17162*x^140 + 1471*x^139 + 14486*x^138 + 7702*x^137 - 29890*x^136 + 29315*x^135 + 558*x^134 - 22429*x^133 - 361*x^132 + 19049*x^131 - 30437*x^130 - 32610*x^129 - 3024*x^128 - 4313*x^127 + 29174*x^126 - 2837*x^125 - 2812*x^124 + 13450*x^123 - 15001*x^122 - 25791*x^121 - 8702*x^120 - 4968*x^119 - 15340*x^118 + 31744*x^117 - 32478*x^116 + 19737*x^115 - 12629*x^114 - 27847*x^113 + 27322*x^112 - 31375*x^111 + 14777*x^110 + 29825*x^109 - 25883*x^108 - 13335*x^107 + 32517*x^106 + 14871*x^105 - 7287*x^104 + 13398*x^103 - 32710*x^102 + 20805*x^101 + 29734*x^100 - 14579*x^99 + 17483*x^98 - 16864*x^97 - 26745*x^96 + 3254*x^95 + 7280*x^94 - 29046*x^93 - 7531*x^92 - 8791*x^91 + 15033*x^90 - 1125*x^89 - 14713*x^88 - 12273*x^87 + 8616*x^86 + 2486*x^85 + 31810*x^84 + 27795*x^83 - 21731*x^82 + 21743*x^81 - 27595*x^80 - 3592*x^79 - 27206*x^78 - 32156*x^77 + 32124*x^76 - 11212*x^75 - 6662*x^74 - 23103*x^73 - 3660*x^72 - 31043*x^71 - 17131*x^70 + 24544*x^69 - 32326*x^68 - 31047*x^67 + 19814*x^66 + 10874*x^65 - 8449*x^64 + 11744*x^63 + 2245*x^62 - 967*x^61 + 9120*x^60 + 8983*x^59 - 24573*x^58 + 24885*x^57 + 15649*x^56 - 18970*x^55 + 7354*x^54 - 12282*x^53 - 22474*x^52 + 4395*x^51 + 8428*x^50 - 32592*x^49 + 25980*x^48 - 4599*x^47 + 16310*x^46 + 18559*x^45 + 22897*x^44 + 19080*x^43 - 26065*x^42 - 9*x^41 + 29202*x^40 + 2121*x^39 - 5004*x^38 + 5299*x^37 - 28301*x^36 - 13519*x^35 + 24241*x^34 + 529*x^33 - 20574*x^32 - 27391*x^31 + 31976*x^30 + 22824*x^29 - 31410*x^28 - 20976*x^27 + 21661*x^26 - 15132*x^25 + 1905*x^24 - 30870*x^23 + 18109*x^22 - 17373*x^21 + 5342*x^20 - 22447*x^19 + 1893*x^18 - 17545*x^17 + 30097*x^16 - 21731*x^15 + 17390*x^14 + 10991*x^13 - 5384*x^12 + 15960*x^11 + 24268*x^10 - 29867*x^9 + 22532*x^8 + 10133*x^7 - 26576*x^6 - 5742*x^5 - 16252*x^4 + 13019*x^3 - 25984*x^2 + 14004*x + 22500</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>NTRU()</p>
<p><a href="http://blog.k1rit0.eu.org/2021/03/28/Translation-of-LatticeHacks/">Translation of LatticeHacks  K1rit0s Blog</a> </p>
<p><br></p>
<p>exp.ipynb</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">160</span></span><br><span class="line">d = <span class="number">30</span></span><br><span class="line">p = <span class="number">3</span></span><br><span class="line">q = <span class="number">65536</span></span><br><span class="line">PR = PolynomialRing(ZZ, name = <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">x = PR.gen()</span><br><span class="line">R = PR.quotient_ring(x ^ n - <span class="number">1</span>, names = <span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">y = R.gen()</span><br><span class="line"></span><br><span class="line">pubkey = -<span class="number">11891</span>*x^<span class="number">159</span> + <span class="number">16347</span>*x^<span class="number">158</span> - <span class="number">32137</span>*x^<span class="number">157</span> + <span class="number">14988</span>*x^<span class="number">156</span> + <span class="number">16657</span>*x^<span class="number">155</span> - <span class="number">25785</span>*x^<span class="number">154</span> - <span class="number">21976</span>*x^<span class="number">153</span> - <span class="number">31745</span>*x^<span class="number">152</span> - <span class="number">4232</span>*x^<span class="number">151</span> + <span class="number">29569</span>*x^<span class="number">150</span> + <span class="number">27140</span>*x^<span class="number">149</span> + <span class="number">19617</span>*x^<span class="number">148</span> - <span class="number">16656</span>*x^<span class="number">147</span> + <span class="number">8925</span>*x^<span class="number">146</span> + <span class="number">8728</span>*x^<span class="number">145</span> - <span class="number">8802</span>*x^<span class="number">144</span> - <span class="number">10794</span>*x^<span class="number">143</span> - <span class="number">28159</span>*x^<span class="number">142</span> - <span class="number">6454</span>*x^<span class="number">141</span> - <span class="number">10259</span>*x^<span class="number">140</span> - <span class="number">19169</span>*x^<span class="number">139</span> - <span class="number">14357</span>*x^<span class="number">138</span> + <span class="number">3501</span>*x^<span class="number">137</span> + <span class="number">9885</span>*x^<span class="number">136</span> - <span class="number">7441</span>*x^<span class="number">135</span> + <span class="number">18268</span>*x^<span class="number">134</span> - <span class="number">27183</span>*x^<span class="number">133</span> + <span class="number">26085</span>*x^<span class="number">132</span> + <span class="number">19147</span>*x^<span class="number">131</span> + <span class="number">17153</span>*x^<span class="number">130</span> - <span class="number">22887</span>*x^<span class="number">129</span> + <span class="number">32476</span>*x^<span class="number">128</span> - <span class="number">21698</span>*x^<span class="number">127</span> + <span class="number">19138</span>*x^<span class="number">126</span> + <span class="number">11585</span>*x^<span class="number">125</span> + <span class="number">22755</span>*x^<span class="number">124</span> - <span class="number">5920</span>*x^<span class="number">123</span> + <span class="number">7581</span>*x^<span class="number">122</span> + <span class="number">25973</span>*x^<span class="number">121</span> + <span class="number">13787</span>*x^<span class="number">120</span> - <span class="number">22762</span>*x^<span class="number">119</span> + <span class="number">29207</span>*x^<span class="number">118</span> - <span class="number">17916</span>*x^<span class="number">117</span> - <span class="number">11502</span>*x^<span class="number">116</span> + <span class="number">18275</span>*x^<span class="number">115</span> + <span class="number">318</span>*x^<span class="number">114</span> - <span class="number">6890</span>*x^<span class="number">113</span> - <span class="number">22751</span>*x^<span class="number">112</span> - <span class="number">27677</span>*x^<span class="number">111</span> - <span class="number">11114</span>*x^<span class="number">110</span> + <span class="number">8623</span>*x^<span class="number">109</span> - <span class="number">15725</span>*x^<span class="number">108</span> - <span class="number">6835</span>*x^<span class="number">107</span> - <span class="number">8288</span>*x^<span class="number">106</span> - <span class="number">5235</span>*x^<span class="number">105</span> - <span class="number">28697</span>*x^<span class="number">104</span> + <span class="number">10696</span>*x^<span class="number">103</span> + <span class="number">17117</span>*x^<span class="number">102</span> + <span class="number">24696</span>*x^<span class="number">101</span> - <span class="number">7801</span>*x^<span class="number">100</span> - <span class="number">31874</span>*x^<span class="number">99</span> - <span class="number">17668</span>*x^<span class="number">98</span> - <span class="number">11204</span>*x^<span class="number">97</span> + <span class="number">19147</span>*x^<span class="number">96</span> + <span class="number">24644</span>*x^<span class="number">95</span> - <span class="number">29380</span>*x^<span class="number">94</span> - <span class="number">26237</span>*x^<span class="number">93</span> - <span class="number">27390</span>*x^<span class="number">92</span> + <span class="number">19982</span>*x^<span class="number">91</span> + <span class="number">4074</span>*x^<span class="number">90</span> - <span class="number">17248</span>*x^<span class="number">89</span> - <span class="number">11027</span>*x^<span class="number">88</span> - <span class="number">32690</span>*x^<span class="number">87</span> + <span class="number">5124</span>*x^<span class="number">86</span> - <span class="number">20823</span>*x^<span class="number">85</span> - <span class="number">11779</span>*x^<span class="number">84</span> + <span class="number">13781</span>*x^<span class="number">83</span> + <span class="number">29356</span>*x^<span class="number">82</span> - <span class="number">9740</span>*x^<span class="number">81</span> - <span class="number">31484</span>*x^<span class="number">80</span> - <span class="number">540</span>*x^<span class="number">79</span> + <span class="number">32360</span>*x^<span class="number">78</span> + <span class="number">24795</span>*x^<span class="number">77</span> - <span class="number">8864</span>*x^<span class="number">76</span> + <span class="number">17363</span>*x^<span class="number">75</span> + <span class="number">9670</span>*x^<span class="number">74</span> + <span class="number">32268</span>*x^<span class="number">73</span> + <span class="number">17961</span>*x^<span class="number">72</span> + <span class="number">6388</span>*x^<span class="number">71</span> + <span class="number">580</span>*x^<span class="number">70</span> + <span class="number">128</span>*x^<span class="number">69</span> + <span class="number">339</span>*x^<span class="number">68</span> + <span class="number">3412</span>*x^<span class="number">67</span> - <span class="number">4519</span>*x^<span class="number">66</span> - <span class="number">25056</span>*x^<span class="number">65</span> + <span class="number">6096</span>*x^<span class="number">64</span> + <span class="number">18720</span>*x^<span class="number">63</span> - <span class="number">5338</span>*x^<span class="number">62</span> + <span class="number">16910</span>*x^<span class="number">61</span> + <span class="number">3353</span>*x^<span class="number">60</span> + <span class="number">15433</span>*x^<span class="number">59</span> - <span class="number">28053</span>*x^<span class="number">58</span> - <span class="number">18883</span>*x^<span class="number">57</span> + <span class="number">7688</span>*x^<span class="number">56</span> - <span class="number">31198</span>*x^<span class="number">55</span> + <span class="number">9950</span>*x^<span class="number">54</span> - <span class="number">9388</span>*x^<span class="number">53</span> + <span class="number">21235</span>*x^<span class="number">52</span> + <span class="number">2847</span>*x^<span class="number">51</span> + <span class="number">24383</span>*x^<span class="number">50</span> + <span class="number">19431</span>*x^<span class="number">49</span> + <span class="number">21244</span>*x^<span class="number">48</span> - <span class="number">8498</span>*x^<span class="number">47</span> - <span class="number">28998</span>*x^<span class="number">46</span> + <span class="number">962</span>*x^<span class="number">45</span> + <span class="number">20579</span>*x^<span class="number">44</span> + <span class="number">28002</span>*x^<span class="number">43</span> - <span class="number">6040</span>*x^<span class="number">42</span> + <span class="number">4241</span>*x^<span class="number">41</span> + <span class="number">11655</span>*x^<span class="number">40</span> - <span class="number">32419</span>*x^<span class="number">39</span> + <span class="number">21531</span>*x^<span class="number">38</span> + <span class="number">7348</span>*x^<span class="number">37</span> - <span class="number">5503</span>*x^<span class="number">36</span> + <span class="number">29820</span>*x^<span class="number">35</span> + <span class="number">28896</span>*x^<span class="number">34</span> + <span class="number">8754</span>*x^<span class="number">33</span> + <span class="number">17978</span>*x^<span class="number">32</span> + <span class="number">7552</span>*x^<span class="number">31</span> + <span class="number">27240</span>*x^<span class="number">30</span> - <span class="number">29515</span>*x^<span class="number">29</span> - <span class="number">20322</span>*x^<span class="number">28</span> + <span class="number">2201</span>*x^<span class="number">27</span> + <span class="number">8857</span>*x^<span class="number">26</span> - <span class="number">50</span>*x^<span class="number">25</span> - <span class="number">3780</span>*x^<span class="number">24</span> - <span class="number">12138</span>*x^<span class="number">23</span> + <span class="number">10893</span>*x^<span class="number">22</span> + <span class="number">23133</span>*x^<span class="number">21</span> + <span class="number">6142</span>*x^<span class="number">20</span> - <span class="number">23798</span>*x^<span class="number">19</span> - <span class="number">15236</span>*x^<span class="number">18</span> + <span class="number">32564</span>*x^<span class="number">17</span> + <span class="number">25683</span>*x^<span class="number">16</span> - <span class="number">24010</span>*x^<span class="number">15</span> - <span class="number">4355</span>*x^<span class="number">14</span> + <span class="number">22552</span>*x^<span class="number">13</span> - <span class="number">27155</span>*x^<span class="number">12</span> + <span class="number">27649</span>*x^<span class="number">11</span> + <span class="number">17781</span>*x^<span class="number">10</span> + <span class="number">7115</span>*x^<span class="number">9</span> + <span class="number">27465</span>*x^<span class="number">8</span> - <span class="number">4369</span>*x^<span class="number">7</span> + <span class="number">24882</span>*x^<span class="number">6</span> - <span class="number">11675</span>*x^<span class="number">5</span> - <span class="number">612</span>*x^<span class="number">4</span> + <span class="number">12361</span>*x^<span class="number">3</span> + <span class="number">20120</span>*x^<span class="number">2</span> + <span class="number">6190</span>*x - <span class="number">10843</span></span><br><span class="line">pubkey = R(pubkey)</span><br><span class="line">c = -<span class="number">26801</span>*x^<span class="number">159</span> - <span class="number">25103</span>*x^<span class="number">158</span> + <span class="number">29811</span>*x^<span class="number">157</span> - <span class="number">12251</span>*x^<span class="number">156</span> - <span class="number">13386</span>*x^<span class="number">155</span> - <span class="number">28030</span>*x^<span class="number">154</span> - <span class="number">16511</span>*x^<span class="number">153</span> + <span class="number">23761</span>*x^<span class="number">152</span> + <span class="number">28329</span>*x^<span class="number">151</span> - <span class="number">16406</span>*x^<span class="number">150</span> + <span class="number">30931</span>*x^<span class="number">149</span> + <span class="number">5326</span>*x^<span class="number">148</span> + <span class="number">19877</span>*x^<span class="number">147</span> - <span class="number">23165</span>*x^<span class="number">146</span> - <span class="number">31540</span>*x^<span class="number">145</span> - <span class="number">7923</span>*x^<span class="number">144</span> + <span class="number">5880</span>*x^<span class="number">143</span> - <span class="number">27078</span>*x^<span class="number">142</span> - <span class="number">25436</span>*x^<span class="number">141</span> - <span class="number">17162</span>*x^<span class="number">140</span> + <span class="number">1471</span>*x^<span class="number">139</span> + <span class="number">14486</span>*x^<span class="number">138</span> + <span class="number">7702</span>*x^<span class="number">137</span> - <span class="number">29890</span>*x^<span class="number">136</span> + <span class="number">29315</span>*x^<span class="number">135</span> + <span class="number">558</span>*x^<span class="number">134</span> - <span class="number">22429</span>*x^<span class="number">133</span> - <span class="number">361</span>*x^<span class="number">132</span> + <span class="number">19049</span>*x^<span class="number">131</span> - <span class="number">30437</span>*x^<span class="number">130</span> - <span class="number">32610</span>*x^<span class="number">129</span> - <span class="number">3024</span>*x^<span class="number">128</span> - <span class="number">4313</span>*x^<span class="number">127</span> + <span class="number">29174</span>*x^<span class="number">126</span> - <span class="number">2837</span>*x^<span class="number">125</span> - <span class="number">2812</span>*x^<span class="number">124</span> + <span class="number">13450</span>*x^<span class="number">123</span> - <span class="number">15001</span>*x^<span class="number">122</span> - <span class="number">25791</span>*x^<span class="number">121</span> - <span class="number">8702</span>*x^<span class="number">120</span> - <span class="number">4968</span>*x^<span class="number">119</span> - <span class="number">15340</span>*x^<span class="number">118</span> + <span class="number">31744</span>*x^<span class="number">117</span> - <span class="number">32478</span>*x^<span class="number">116</span> + <span class="number">19737</span>*x^<span class="number">115</span> - <span class="number">12629</span>*x^<span class="number">114</span> - <span class="number">27847</span>*x^<span class="number">113</span> + <span class="number">27322</span>*x^<span class="number">112</span> - <span class="number">31375</span>*x^<span class="number">111</span> + <span class="number">14777</span>*x^<span class="number">110</span> + <span class="number">29825</span>*x^<span class="number">109</span> - <span class="number">25883</span>*x^<span class="number">108</span> - <span class="number">13335</span>*x^<span class="number">107</span> + <span class="number">32517</span>*x^<span class="number">106</span> + <span class="number">14871</span>*x^<span class="number">105</span> - <span class="number">7287</span>*x^<span class="number">104</span> + <span class="number">13398</span>*x^<span class="number">103</span> - <span class="number">32710</span>*x^<span class="number">102</span> + <span class="number">20805</span>*x^<span class="number">101</span> + <span class="number">29734</span>*x^<span class="number">100</span> - <span class="number">14579</span>*x^<span class="number">99</span> + <span class="number">17483</span>*x^<span class="number">98</span> - <span class="number">16864</span>*x^<span class="number">97</span> - <span class="number">26745</span>*x^<span class="number">96</span> + <span class="number">3254</span>*x^<span class="number">95</span> + <span class="number">7280</span>*x^<span class="number">94</span> - <span class="number">29046</span>*x^<span class="number">93</span> - <span class="number">7531</span>*x^<span class="number">92</span> - <span class="number">8791</span>*x^<span class="number">91</span> + <span class="number">15033</span>*x^<span class="number">90</span> - <span class="number">1125</span>*x^<span class="number">89</span> - <span class="number">14713</span>*x^<span class="number">88</span> - <span class="number">12273</span>*x^<span class="number">87</span> + <span class="number">8616</span>*x^<span class="number">86</span> + <span class="number">2486</span>*x^<span class="number">85</span> + <span class="number">31810</span>*x^<span class="number">84</span> + <span class="number">27795</span>*x^<span class="number">83</span> - <span class="number">21731</span>*x^<span class="number">82</span> + <span class="number">21743</span>*x^<span class="number">81</span> - <span class="number">27595</span>*x^<span class="number">80</span> - <span class="number">3592</span>*x^<span class="number">79</span> - <span class="number">27206</span>*x^<span class="number">78</span> - <span class="number">32156</span>*x^<span class="number">77</span> + <span class="number">32124</span>*x^<span class="number">76</span> - <span class="number">11212</span>*x^<span class="number">75</span> - <span class="number">6662</span>*x^<span class="number">74</span> - <span class="number">23103</span>*x^<span class="number">73</span> - <span class="number">3660</span>*x^<span class="number">72</span> - <span class="number">31043</span>*x^<span class="number">71</span> - <span class="number">17131</span>*x^<span class="number">70</span> + <span class="number">24544</span>*x^<span class="number">69</span> - <span class="number">32326</span>*x^<span class="number">68</span> - <span class="number">31047</span>*x^<span class="number">67</span> + <span class="number">19814</span>*x^<span class="number">66</span> + <span class="number">10874</span>*x^<span class="number">65</span> - <span class="number">8449</span>*x^<span class="number">64</span> + <span class="number">11744</span>*x^<span class="number">63</span> + <span class="number">2245</span>*x^<span class="number">62</span> - <span class="number">967</span>*x^<span class="number">61</span> + <span class="number">9120</span>*x^<span class="number">60</span> + <span class="number">8983</span>*x^<span class="number">59</span> - <span class="number">24573</span>*x^<span class="number">58</span> + <span class="number">24885</span>*x^<span class="number">57</span> + <span class="number">15649</span>*x^<span class="number">56</span> - <span class="number">18970</span>*x^<span class="number">55</span> + <span class="number">7354</span>*x^<span class="number">54</span> - <span class="number">12282</span>*x^<span class="number">53</span> - <span class="number">22474</span>*x^<span class="number">52</span> + <span class="number">4395</span>*x^<span class="number">51</span> + <span class="number">8428</span>*x^<span class="number">50</span> - <span class="number">32592</span>*x^<span class="number">49</span> + <span class="number">25980</span>*x^<span class="number">48</span> - <span class="number">4599</span>*x^<span class="number">47</span> + <span class="number">16310</span>*x^<span class="number">46</span> + <span class="number">18559</span>*x^<span class="number">45</span> + <span class="number">22897</span>*x^<span class="number">44</span> + <span class="number">19080</span>*x^<span class="number">43</span> - <span class="number">26065</span>*x^<span class="number">42</span> - <span class="number">9</span>*x^<span class="number">41</span> + <span class="number">29202</span>*x^<span class="number">40</span> + <span class="number">2121</span>*x^<span class="number">39</span> - <span class="number">5004</span>*x^<span class="number">38</span> + <span class="number">5299</span>*x^<span class="number">37</span> - <span class="number">28301</span>*x^<span class="number">36</span> - <span class="number">13519</span>*x^<span class="number">35</span> + <span class="number">24241</span>*x^<span class="number">34</span> + <span class="number">529</span>*x^<span class="number">33</span> - <span class="number">20574</span>*x^<span class="number">32</span> - <span class="number">27391</span>*x^<span class="number">31</span> + <span class="number">31976</span>*x^<span class="number">30</span> + <span class="number">22824</span>*x^<span class="number">29</span> - <span class="number">31410</span>*x^<span class="number">28</span> - <span class="number">20976</span>*x^<span class="number">27</span> + <span class="number">21661</span>*x^<span class="number">26</span> - <span class="number">15132</span>*x^<span class="number">25</span> + <span class="number">1905</span>*x^<span class="number">24</span> - <span class="number">30870</span>*x^<span class="number">23</span> + <span class="number">18109</span>*x^<span class="number">22</span> - <span class="number">17373</span>*x^<span class="number">21</span> + <span class="number">5342</span>*x^<span class="number">20</span> - <span class="number">22447</span>*x^<span class="number">19</span> + <span class="number">1893</span>*x^<span class="number">18</span> - <span class="number">17545</span>*x^<span class="number">17</span> + <span class="number">30097</span>*x^<span class="number">16</span> - <span class="number">21731</span>*x^<span class="number">15</span> + <span class="number">17390</span>*x^<span class="number">14</span> + <span class="number">10991</span>*x^<span class="number">13</span> - <span class="number">5384</span>*x^<span class="number">12</span> + <span class="number">15960</span>*x^<span class="number">11</span> + <span class="number">24268</span>*x^<span class="number">10</span> - <span class="number">29867</span>*x^<span class="number">9</span> + <span class="number">22532</span>*x^<span class="number">8</span> + <span class="number">10133</span>*x^<span class="number">7</span> - <span class="number">26576</span>*x^<span class="number">6</span> - <span class="number">5742</span>*x^<span class="number">5</span> - <span class="number">16252</span>*x^<span class="number">4</span> + <span class="number">13019</span>*x^<span class="number">3</span> - <span class="number">25984</span>*x^<span class="number">2</span> + <span class="number">14004</span>*x + <span class="number">22500</span></span><br><span class="line">c = R(c)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">balance_mod</span>(<span class="params">f, q</span>):</span><br><span class="line">    g = <span class="built_in">list</span>(((f[i] + q // <span class="number">2</span>) % q) - q // <span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n))</span><br><span class="line">    <span class="keyword">return</span> R(g)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_mod_prime</span>(<span class="params">f, p</span>):</span><br><span class="line">    T = R.base().change_ring(Integers(p)).quotient(x ^ n - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> R(<span class="number">1</span> / T(f))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dec</span>(<span class="params">c, prikey</span>):</span><br><span class="line">    f, fp = prikey</span><br><span class="line">    a = balance_mod(c * f, q)</span><br><span class="line">    <span class="keyword">return</span> balance_mod(a * fp, p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack</span>(<span class="params">pubkey, c</span>):</span><br><span class="line">    A = Matrix(ZZ, <span class="number">2</span> * n, <span class="number">2</span> * n)</span><br><span class="line">    hp = inverse(p, q) * pubkey</span><br><span class="line">    hp_list = <span class="built_in">list</span>(hp)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        A[i, i] = q</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n, <span class="number">2</span> * n):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            A[i, j] = hp_list[(j - i) % n]</span><br><span class="line">        A[i, i] = <span class="number">1</span></span><br><span class="line">    AL = A.BKZ()</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> AL:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            f = R(row[n:].<span class="built_in">list</span>())</span><br><span class="line">            fp = invert_mod_prime(f, p)</span><br><span class="line">            <span class="keyword">return</span> dec(c, (f, fp))</span><br><span class="line">            <span class="keyword">break</span> <span class="comment"># may failed with shortest vector(return more if failed)</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line">m = crack(pubkey, c)</span><br><span class="line"></span><br><span class="line">m = m.<span class="built_in">list</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">    m[i] += <span class="number">1</span></span><br><span class="line">    m[i] = <span class="built_in">str</span>(m[i])</span><br><span class="line">str1 = <span class="string">&quot;&quot;</span>.join(m[::-<span class="number">1</span>])</span><br><span class="line">temp = <span class="built_in">int</span>(str1,<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(temp))</span><br></pre></td></tr></table></figure>
<p>()</p>
<p>flag:</p>
<font size="4" color="red">cnss{NTRU_w1th_un5afe_par4}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="MidLattice"><a href="#MidLattice" class="headerlink" title="MidLattice"></a>MidLattice</h2><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gcd</span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">pbit = <span class="number">500</span></span><br><span class="line">qbit = <span class="number">550</span></span><br><span class="line">rbit = <span class="number">200</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_sample</span>():</span><br><span class="line">    x_list  = []</span><br><span class="line">    p = getPrime(pbit)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">120</span>):</span><br><span class="line">        q = getPrime(qbit)</span><br><span class="line">        r = getPrime(rbit)</span><br><span class="line">        x_list.append(q*p + <span class="number">2</span>*r)</span><br><span class="line">    <span class="keyword">return</span> x_list,p</span><br><span class="line">sample,p = get_sample()</span><br><span class="line">flag = <span class="string">&#x27;cnss&#123;&#x27;</span>+hashlib.sha256(long_to_bytes(p)).hexdigest()+<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(<span class="built_in">str</span>(sample))</span><br></pre></td></tr></table></figure>
<p>output.txt</p>
<p>agcd()</p>
<p><br></p>
<p>exp.ipynb</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> permutations</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">P_bits = <span class="number">500</span></span><br><span class="line">Q_bits = <span class="number">550</span></span><br><span class="line">R_bits = <span class="number">200</span></span><br><span class="line">e = <span class="number">0x1337</span></span><br><span class="line">N = <span class="comment">#</span></span><br><span class="line">X = <span class="number">2</span>**R_bits</span><br><span class="line">m = <span class="built_in">len</span>(N)</span><br><span class="line"></span><br><span class="line">PR = PolynomialRing(ZZ, names=[<span class="built_in">str</span>(<span class="string">&#x27;x%d&#x27;</span> % i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1</span> + m)])</span><br><span class="line"></span><br><span class="line">h = <span class="number">3</span></span><br><span class="line">u = <span class="number">1</span></span><br><span class="line">variables = PR.gens()</span><br><span class="line"></span><br><span class="line">gg = []</span><br><span class="line">monomials = [variables[<span class="number">0</span>]**<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    gg.append(N[i] - variables[i])</span><br><span class="line">    monomials.append(variables[i])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(monomials), <span class="built_in">len</span>(gg))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;monomials:&#x27;</span>, monomials)</span><br><span class="line"></span><br><span class="line">B = Matrix(ZZ, <span class="built_in">len</span>(gg), <span class="built_in">len</span>(monomials))</span><br><span class="line"><span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(gg)):</span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(monomials)):</span><br><span class="line">        <span class="keyword">if</span> monomials[jj] <span class="keyword">in</span> gg[ii].monomials():</span><br><span class="line">            B[ii, jj] = gg[ii].monomial_coefficient(monomials[jj]) * monomials[jj]([X] * m)</span><br><span class="line"></span><br><span class="line">B = B.LLL()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-&#x27;</span> * <span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">new_pol = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(gg)):</span><br><span class="line">    tmp_pol = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(monomials)):</span><br><span class="line">        tmp_pol += monomials[j](variables) * B[i, j] / monomials[j]([X] * m)</span><br><span class="line">    new_pol.append(tmp_pol)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(new_pol) &gt; <span class="number">0</span>:</span><br><span class="line">    Ideal = ideal(new_pol[:m-<span class="number">1</span>])</span><br><span class="line">    GB = Ideal.groebner_basis()</span><br><span class="line">    function_variables = var([<span class="built_in">str</span>(<span class="string">&#x27;y%d&#x27;</span> % i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1</span> + m)])</span><br><span class="line">    res = solve([pol(function_variables) <span class="keyword">for</span> pol <span class="keyword">in</span> GB], function_variables)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;got %d basis&#x27;</span> % <span class="built_in">len</span>(GB))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;solved result:&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br><span class="line">    PRRR.&lt; x, y&gt; = PolynomialRing(QQ)</span><br><span class="line">    q = <span class="built_in">abs</span>(PRRR(res[<span class="number">0</span>][<span class="number">0</span>](x, y)).coefficients()[<span class="number">0</span>].denominator())</span><br><span class="line">    p = N[-<span class="number">1</span>] // q</span><br><span class="line"></span><br><span class="line">    flag = <span class="string">&#x27;cnss&#123;&#x27;</span>+hashlib.sha256(long_to_bytes(p)).hexdigest()+<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p></p>
<p>flag:</p>
<font size="4" color="red">cnss{dde0cc3ac3539c66a74ed445a81c3f5b12938c286fa569a3b143b72369c708c9}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id=""><a href="#" class="headerlink" title=""></a></h2><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2^512</span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> isqrt</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p, q = getPrime(<span class="number">512</span>), getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">hint = isqrt(p) ^ isqrt(q)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;hint = &#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 85404423344841677974087657659736161235661371072424467828040714876602706438511794670195915251038316685200550396898521246532238184171610202260808362573973358649489859739377219665083353960986881177279315590581777896976153899765953910931555330824054172366095461986394627542626117519624886018101305667394230690241</span></span><br><span class="line"><span class="string">c = 19771222413844352631385715488753476758377273736688852768996964594019231638669697870409256892886494956719082541038530128231778575768552216334354854019126139003782852207071549956953446472517410158388833668611141062328959917017080292879996106665465487753670322759387144032463518586362415629216383494479440197516</span></span><br><span class="line"><span class="string">hint = 34903932064178830653499046348212332783401351910283782992020948402621276719605</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>p^qRSA isqrt(p) ^ isqrt(q)</p>
<ul>
<li>nisqrt(p*q) </li>
<li>isqrt(p*q) nisqrt(p) ^ isqrt(q)p^qp^q</li>
</ul>
<p></p>
<ul>
<li>pq</li>
<li>isqrt(p)isqrt(q)pq256coppersmith</li>
</ul>
<p>RSA </p>
<p><a href="https://blog.maple3142.net/2023/06/12/seetf-2023-writeups/#shard">https://blog.maple3142.net/2023/06/12/seetf-2023-writeups/#shard</a></p>
<p>coppersmithepsilon0.030.01</p>
<p><br></p>
<p>exp_step1.ipynb(p)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> randbelow</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> re <span class="keyword">import</span> findall</span><br><span class="line"><span class="keyword">from</span> subprocess <span class="keyword">import</span> check_output</span><br><span class="line"><span class="keyword">from</span> binteger <span class="keyword">import</span> Bin</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">self, X=<span class="literal">None</span>, beta=<span class="number">1.0</span>, epsilon=<span class="literal">None</span>, **kwds</span>):</span><br><span class="line">    <span class="keyword">from</span> sage.misc.verbose <span class="keyword">import</span> verbose</span><br><span class="line">    <span class="keyword">from</span> sage.matrix.constructor <span class="keyword">import</span> Matrix</span><br><span class="line">    <span class="keyword">from</span> sage.rings.real_mpfr <span class="keyword">import</span> RR</span><br><span class="line"></span><br><span class="line">    N = self.parent().characteristic()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> self.is_monic():</span><br><span class="line">        <span class="keyword">raise</span> ArithmeticError(<span class="string">&quot;Polynomial must be monic.&quot;</span>)</span><br><span class="line"></span><br><span class="line">    beta = RR(beta)</span><br><span class="line">    <span class="keyword">if</span> beta &lt;= <span class="number">0.0</span> <span class="keyword">or</span> beta &gt; <span class="number">1.0</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;0.0 &lt; beta &lt;= 1.0 not satisfied.&quot;</span>)</span><br><span class="line"></span><br><span class="line">    f = self.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    P, (x,) = f.parent().objgens()</span><br><span class="line"></span><br><span class="line">    delta = f.degree()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> epsilon <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        epsilon = beta / <span class="number">8</span></span><br><span class="line">    verbose(<span class="string">&quot;epsilon = %f&quot;</span> % epsilon, level=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    m = <span class="built_in">max</span>(beta**<span class="number">2</span> / (delta * epsilon), <span class="number">7</span> * beta / delta).ceil()</span><br><span class="line">    verbose(<span class="string">&quot;m = %d&quot;</span> % m, level=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    t = <span class="built_in">int</span>((delta * m * (<span class="number">1</span> / beta - <span class="number">1</span>)).floor())</span><br><span class="line">    verbose(<span class="string">&quot;t = %d&quot;</span> % t, level=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> X <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        X = (<span class="number">0.5</span> * N ** (beta**<span class="number">2</span> / delta - epsilon)).ceil()</span><br><span class="line">    verbose(<span class="string">&quot;X = %s&quot;</span> % X, level=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># we could do this much faster, but this is a cheap step</span></span><br><span class="line">    <span class="comment"># compared to LLL</span></span><br><span class="line">    g = [x**j * N ** (m - i) * f**i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(delta)]</span><br><span class="line">    g.extend([x**i * f**m <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t)])  <span class="comment"># h</span></span><br><span class="line"></span><br><span class="line">    B = Matrix(ZZ, <span class="built_in">len</span>(g), delta * m + <span class="built_in">max</span>(delta, t))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(B.nrows()):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(g[i].degree() + <span class="number">1</span>):</span><br><span class="line">            B[i, j] = g[i][j] * X**j</span><br><span class="line"></span><br><span class="line">    f = <span class="built_in">sum</span>([ZZ(B[<span class="number">0</span>, i] // X**i) * x**i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(B.ncols())])</span><br><span class="line">    R = f.roots()</span><br><span class="line"></span><br><span class="line">    ZmodN = self.base_ring()</span><br><span class="line">    roots = <span class="built_in">set</span>([ZmodN(r) <span class="keyword">for</span> r, m <span class="keyword">in</span> R <span class="keyword">if</span> <span class="built_in">abs</span>(r) &lt;= X])</span><br><span class="line">    Nbeta = N**beta</span><br><span class="line">    <span class="keyword">return</span> [root <span class="keyword">for</span> root <span class="keyword">in</span> roots <span class="keyword">if</span> N.gcd(ZZ(self(root))) &gt;= Nbeta]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pq = <span class="number">85404423344841677974087657659736161235661371072424467828040714876602706438511794670195915251038316685200550396898521246532238184171610202260808362573973358649489859739377219665083353960986881177279315590581777896976153899765953910931555330824054172366095461986394627542626117519624886018101305667394230690241</span></span><br><span class="line">c = <span class="number">19771222413844352631385715488753476758377273736688852768996964594019231638669697870409256892886494956719082541038530128231778575768552216334354854019126139003782852207071549956953446472517410158388833668611141062328959917017080292879996106665465487753670322759387144032463518586362415629216383494479440197516</span></span><br><span class="line">hint = <span class="number">34903932064178830653499046348212332783401351910283782992020948402621276719605</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dfs</span>(<span class="params">spv, i</span>):</span><br><span class="line">    <span class="keyword">if</span> i &gt;= <span class="number">256</span>:</span><br><span class="line">        <span class="keyword">yield</span> Bin(spv, <span class="number">256</span>), Bin(Bin(spv).<span class="built_in">int</span> ^^ hint, <span class="number">256</span>)</span><br><span class="line">    <span class="keyword">if</span> i &gt;= <span class="number">256</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> (<span class="number">1</span>, <span class="number">0</span>):</span><br><span class="line">        spv[i] = b</span><br><span class="line">        tsp = Bin(spv).<span class="built_in">int</span></span><br><span class="line">        tsq = tsp ^^ hint</span><br><span class="line">        p = tsp**<span class="number">2</span></span><br><span class="line">        q = tsq**<span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> &lt;= (pq - p * q) &lt;= <span class="number">2</span> ** (<span class="number">1024</span> - i + <span class="number">1</span>) <span class="keyword">and</span> <span class="number">0</span> &lt;= (</span><br><span class="line">            iroot(pq,<span class="number">2</span>)[<span class="number">0</span>] - tsp * tsq</span><br><span class="line">        ) &lt;= <span class="number">2</span> ** (<span class="number">512</span> - i + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">yield</span> <span class="keyword">from</span> dfs(spv[:], i + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">spv = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line">results = []</span><br><span class="line"><span class="keyword">for</span> spc, sqc <span class="keyword">in</span> dfs(spv, <span class="number">0</span>):</span><br><span class="line">    d = pq - spc.<span class="built_in">int</span>**<span class="number">2</span> * sqc.<span class="built_in">int</span>**<span class="number">2</span></span><br><span class="line">    results.append((d, spc.<span class="built_in">int</span>, sqc.<span class="built_in">int</span>))</span><br><span class="line"><span class="keyword">for</span> i, (_, spci, sqci) <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">sorted</span>(results)):</span><br><span class="line">    <span class="number">1</span></span><br><span class="line">    <span class="comment">#print((spci - (iroot(pq,2)[0] // sqci)).bit_length())</span></span><br><span class="line"><span class="built_in">print</span>(results)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">copp_factor</span>(<span class="params">sp, leak=<span class="number">5</span></span>):</span><br><span class="line">    <span class="keyword">for</span> tb <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span> &lt;&lt; leak):</span><br><span class="line">        <span class="comment">#print(&quot;copp&quot;, tb, int(time.time()))</span></span><br><span class="line">        shift = <span class="number">256</span> - leak + <span class="number">1</span></span><br><span class="line">        P = Zmod(pq)[<span class="string">&quot;x&quot;</span>]</span><br><span class="line">        x = P.gen()</span><br><span class="line">        f = sp.<span class="built_in">int</span>**<span class="number">2</span> + (x &lt;&lt; shift) + <span class="number">2</span>*tb + <span class="number">1</span></span><br><span class="line">        f = f.monic()</span><br><span class="line">        X = <span class="number">2</span> ** (<span class="number">256</span> - leak - <span class="number">1</span>)</span><br><span class="line">        beta = <span class="number">0.499</span></span><br><span class="line">        eps = <span class="number">0.01</span></span><br><span class="line">        rs = f.small_roots(X=X, beta=beta, epsilon=eps)</span><br><span class="line">        <span class="comment">#rs = small_roots(f, X=X, beta=beta, epsilon=eps)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(rs):</span><br><span class="line">            <span class="built_in">print</span>(sp.<span class="built_in">int</span>**<span class="number">2</span> + (tb &lt;&lt; shift) + <span class="built_in">int</span>(rs[<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, (_, spci, _) <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">sorted</span>(results)):</span><br><span class="line">    copp_factor(Bin(spci, <span class="number">256</span>))</span><br></pre></td></tr></table></figure>
<p>sqrtplist</p>
<p><br></p>
<p>exp_step2.ipynb</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="comment">#coppersmith</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line">N = <span class="number">85404423344841677974087657659736161235661371072424467828040714876602706438511794670195915251038316685200550396898521246532238184171610202260808362573973358649489859739377219665083353960986881177279315590581777896976153899765953910931555330824054172366095461986394627542626117519624886018101305667394230690241</span></span><br><span class="line">c = <span class="number">19771222413844352631385715488753476758377273736688852768996964594019231638669697870409256892886494956719082541038530128231778575768552216334354854019126139003782852207071549956953446472517410158388833668611141062328959917017080292879996106665465487753670322759387144032463518586362415629216383494479440197516</span></span><br><span class="line"></span><br><span class="line">sqrtplist = <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">leak = <span class="number">6</span></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(sqrtplist)):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    sp = sqrtplist[i][<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> tb <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span> &lt;&lt; leak):</span><br><span class="line">        <span class="comment">#print(&quot;copp&quot;, tb, int(time.time()))</span></span><br><span class="line">        shift = <span class="number">256</span> - leak</span><br><span class="line">        PR.&lt;x&gt; = PolynomialRing(Zmod(N))</span><br><span class="line">        f = sp**<span class="number">2</span> + (tb &lt;&lt; shift) + x</span><br><span class="line">        f = f.monic()</span><br><span class="line">        X = <span class="number">2</span> ** (<span class="number">256</span> - leak)</span><br><span class="line">        beta = <span class="number">0.499</span></span><br><span class="line">        eps = <span class="number">0.01</span></span><br><span class="line">        res = f.small_roots(X=X, beta=beta, epsilon=eps)</span><br><span class="line">        <span class="keyword">if</span>(res!=[]):</span><br><span class="line">            <span class="built_in">print</span>(res)</span><br><span class="line">            <span class="built_in">print</span>(sp**<span class="number">2</span> + (tb &lt;&lt; shift) + res[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">p = <span class="number">6756521617869105417915102754795944450583448652752246233837766079298009351893501307888859133738834804209006551446537605217981998432259279870915861077557549</span></span><br><span class="line">q = N//p</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,N)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>610</p>
<p>flag:</p>
<font size="4" color="red">cnss{We hav3 n0 0ther ch0ice but c0ppersm1th.}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>(<del></del>)</p>
]]></content>
      <categories>
        <category>wp-crypto</category>
      </categories>
  </entry>
  <entry>
    <title>2023-CNSS-Summer-wp-misc</title>
    <url>/post/22e56931.html</url>
    <content><![CDATA[<p></p>
<span id="more"></span>
<p>Rank3</p>
<p><img src="/post/22e56931/image-20230916080821685.png" alt="image-20230916080821685"></p>
<h3 id="-Signin"><a href="#-Signin" class="headerlink" title=" Signin"></a> Signin</h3><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CNSSflag</span><br><span class="line">431060996</span><br></pre></td></tr></table></figure>
<p>base64flag</p>
<p><img src="/post/22e56931/image-20230911100902419.png" alt="image-20230911100902419"></p>
<p>flag</p>
<p><strong>cnss{W3Lc0m3_7o_Cn55_5umm3r}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="--CNSS-"><a href="#--CNSS-" class="headerlink" title="  CNSS "></a>  CNSS </h3><p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"> CNSS </span><br></pre></td></tr></table></figure>
<p></p>
<p><img src="/post/22e56931/CNSSDoll.png" alt="CNSSDoll"></p>
<p>flag</p>
<p><img src="/post/22e56931/image-20230911101309673.png" alt="image-20230911101309673"></p>
<p>flag</p>
<p><strong>cnss{W0w!!!Y0u_s4ww_m3!}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="--CNSS--OIer"><a href="#--CNSS--OIer" class="headerlink" title="  CNSS  OIer"></a>  CNSS  OIer</h3><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">... OIER  AC </span><br><span class="line"></span><br><span class="line">nc 47.108.140.140 1107</span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">SRC = <span class="string">&#x27;/home/ctf/temp/code.c&#x27;</span></span><br><span class="line">BIN = <span class="string">&#x27;/home/ctf/temp/temp_bin&#x27;</span></span><br><span class="line">DATA = <span class="string">&#x27;/home/ctf/data&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">res_map = &#123;</span><br><span class="line">    <span class="string">&#x27;CE&#x27;</span>: <span class="string">&#x27;Compile Error&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;TLE&#x27;</span>: <span class="string">&#x27;Time Limit Exceeded&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;RE&#x27;</span>: <span class="string">&#x27;Runtime Error&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;WA&#x27;</span>: <span class="string">&#x27;Wrong Answer&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;AC&#x27;</span>: <span class="string">&#x27;Accepted&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_excutable</span>(<span class="params">path, <span class="built_in">input</span>, ans, timeout</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.isfile(path):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;CE&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        p = subprocess.run(</span><br><span class="line">            [<span class="string">f&quot;./<span class="subst">&#123;path&#125;</span>&quot;</span>],</span><br><span class="line">            <span class="built_in">input</span>=<span class="built_in">input</span>,</span><br><span class="line">            stdout=subprocess.PIPE,</span><br><span class="line">            stderr=subprocess.STDOUT,</span><br><span class="line">            timeout=timeout</span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">except</span> subprocess.TimeoutExpired:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;TLE&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> p.returncode != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;RE&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        output = p.stdout.decode()</span><br><span class="line">    <span class="keyword">except</span> UnicodeDecodeError:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;WA&#x27;</span></span><br><span class="line"></span><br><span class="line">    lines = output.strip().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;AC&#x27;</span> <span class="keyword">if</span> lines == ans <span class="keyword">else</span> <span class="string">&#x27;WA&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Enter your code (ending with two blank lines):&quot;</span>)</span><br><span class="line"></span><br><span class="line">    code1 = []</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            line = <span class="built_in">input</span>()</span><br><span class="line">        <span class="keyword">except</span> EOFError:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        code1.append(line)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(code1) &gt;= <span class="number">2</span> <span class="keyword">and</span> code1[-<span class="number">1</span>] == <span class="string">&#x27;&#x27;</span> <span class="keyword">and</span> code1[-<span class="number">2</span>] == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(SRC, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> fd1:</span><br><span class="line">        fd1.write(<span class="string">&#x27;\n&#x27;</span>.join(code1))</span><br><span class="line"></span><br><span class="line">    p = subprocess.run(</span><br><span class="line">        [<span class="string">&quot;gcc&quot;</span>, <span class="string">&quot;-w&quot;</span>, <span class="string">&quot;-O2&quot;</span>, SRC, <span class="string">&quot;-o&quot;</span>, BIN],</span><br><span class="line">        stdout=sys.stdout,</span><br><span class="line">        stdin=subprocess.DEVNULL,</span><br><span class="line">        stderr=subprocess.STDOUT</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(os.path.join(DATA, <span class="string">f&#x27;input.in&#x27;</span>), <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        instr = f.read()</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(os.path.join(DATA, <span class="string">f&#x27;output.out&#x27;</span>), <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        ans = f.read().strip().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    res = check_excutable(BIN, instr, ans, <span class="number">0.5</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Result: &#x27;</span>, res_map[res])</span><br><span class="line">    <span class="keyword">if</span> res == <span class="string">&#x27;AC&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>ccode.cinput.inoutput.outflag</p>
<p>input.inoutput.outoutput.outoutput.outDATAoutput.outc</p>
<p>exp.c</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    FILE *file;</span><br><span class="line">    <span class="type">char</span> filename[] = <span class="string">&quot;/home/ctf/data/output.out&quot;</span>;</span><br><span class="line">    <span class="type">char</span> ch;</span><br><span class="line"></span><br><span class="line">    file = fopen(filename, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">while</span> ((ch = fgetc(file)) != EOF) &#123;</span><br><span class="line">        <span class="built_in">putchar</span>(ch);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fclose(file);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>flag</p>
<p><img src="/post/22e56931/image-20230911102740014.png" alt="image-20230911102740014"></p>
<p>flag</p>
<p><strong>cnss{y0u_4re_U1tim34ate_01er!}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="-CNSS"><a href="#-CNSS" class="headerlink" title=" CNSS"></a> CNSS</h3><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CNSS</span><br></pre></td></tr></table></figure>
<p></p>
<p>flag</p>
<p><img src="/post/22e56931/image-20230911103024312.png" alt="image-20230911103024312"></p>
<p>flag</p>
<p><strong>cnss{L3T_U$_$T4RT!}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="-"><a href="#-" class="headerlink" title=" "></a> </h3><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> flag </span><br><span class="line">Hintflag </span><br></pre></td></tr></table></figure>
<p>th08hintflag</p>
<p>thxx</p>
<p><a href="https://www.bilibili.com/read/cv13353380/">project -  (bilibili.com)</a></p>
<p></p>
<p>1</p>
<p>2(th08)</p>
<p><img src="/post/22e56931/image-20230911103506296.png" alt="image-20230911103506296"></p>
<p>3flag.txt</p>
<p><img src="/post/22e56931/image-20230911103618535.png" alt="image-20230911103618535"></p>
<p>flag</p>
<p><strong>cnss{Y0u_4re_T0uhou_M4st3er_n0w!}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="-Shino--Crypto-"><a href="#-Shino--Crypto-" class="headerlink" title=" Shino  Crypto "></a> Shino  Crypto </h3><p></p>
<p><a href="https://tangcuxiaojikuai.xyz/post/77e39860.html#more">misc() | blog (tangcuxiaojikuai.xyz)</a></p>
<p><br></p>
<p><br></p>
<h3 id="-Hurrison-"><a href="#-Hurrison-" class="headerlink" title=" Hurrison "></a> Hurrison </h3><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Hurrison  Cloudflare  Casio  IP </span><br><span class="line">Hintflag</span><br><span class="line">cnss&#123;IPv4&#125;</span><br><span class="line">IPv4  xxx.xxx.xxx.xxx</span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://cnss2023catchme.hurrison.com/</span><br></pre></td></tr></table></figure>
<p>Cloudflareip</p>
<p><img src="/post/22e56931/image-20230911104238020.png" alt="image-20230911104238020"></p>
<p></p>
<p><img src="/post/22e56931/image-20230911104618404.png" alt="image-20230911104618404"></p>
<p><a href="https://securitytrails.com/">SecurityTrails: Data Security, Threat Hunting, and Attack Surface Management Solutions for Security Teams</a>URLhurrison.com</p>
<p><img src="/post/22e56931/image-20230911111836344.png" alt="image-20230911111836344"></p>
<p>Censys</p>
<p><img src="/post/22e56931/image-20230911112020297.png" alt="image-20230911112020297"></p>
<p>ip</p>
<p>flag</p>
<p><strong>cnss{103.239.247.22}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="-cn55Terminal"><a href="#-cn55Terminal" class="headerlink" title=" cn55Terminal"></a> cn55Terminal</h3><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">curl -sL https://transfer.sh/VKyC2P8CPw/id.txt | nc 124.221.34.13 50024</span><br><span class="line">Update:  cn55Terminal ~</span><br><span class="line"> id.txt</span><br></pre></td></tr></table></figure>
<p>id.txt</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">......................................</span><br><span class="line">......................................</span><br><span class="line">......................................</span><br><span class="line">.@@...........@@......................</span><br><span class="line">.@@...........@@......................</span><br><span class="line">..............@@......................</span><br><span class="line">..............@@......................</span><br><span class="line">..............@@......................</span><br><span class="line">.@@.....@@@@@@@@......................</span><br><span class="line">.@@....@@@@@@@@@......................</span><br><span class="line">.@@...@@@@@@@@@@......................</span><br><span class="line">.@@...@@@....@@@......................</span><br><span class="line">.@@...@@@....@@@......................</span><br><span class="line">.@@...@@@.....@@......................</span><br><span class="line">.@@...@@@....@@@......................</span><br><span class="line">.@@...@@@....@@@......................</span><br><span class="line">.@@...@@@@@@@@@@......................</span><br><span class="line">.@@...@@@@@@@@@@......................</span><br><span class="line">.@@....@@@@@@@@@......................</span><br><span class="line">......................................</span><br><span class="line">......................................</span><br><span class="line">......................................</span><br></pre></td></tr></table></figure>
<p>xshell</p>
<p><img src="/post/22e56931/image-20230911144054892.png" alt="image-20230911144054892"></p>
<p>linuxid</p>
<p><img src="/post/22e56931/image-20230911144414307.png" alt="image-20230911144414307"></p>
<p>idcat flag</p>
<p><img src="/post/22e56931/image-20230911144603284.png" alt="image-20230911144603284"></p>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&#x27;1.png&#x27;</span>)</span><br><span class="line">out_img = img.convert(<span class="string">&#x27;L&#x27;</span>)  <span class="comment"># </span></span><br><span class="line">w, h = out_img.size  <span class="comment"># </span></span><br><span class="line">n=<span class="number">600</span>/<span class="built_in">max</span>(w,h) <span class="comment">#</span></span><br><span class="line"><span class="keyword">if</span> n&lt;<span class="number">1</span>:</span><br><span class="line">   out_img = out_img.resize((<span class="built_in">int</span>(w * n), <span class="built_in">int</span>(h * n*<span class="number">0.5</span>)))  <span class="comment"># 2</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">   out_img = out_img.resize((<span class="built_in">int</span>(w), <span class="built_in">int</span>(h )))</span><br><span class="line">w, h = out_img.size</span><br><span class="line"><span class="comment">#asciis=&#x27;$@B%8&amp;WM#*oahkbdpqwmZO0QLCJUYXzcvunxrjft/\\|()1&#123;&#125;[]?-_+~&lt;&gt;i!lI;:,&quot;^\ &#x27;</span></span><br><span class="line">asciis = <span class="string">&quot;@.&quot;</span>  <span class="comment"># </span></span><br><span class="line">texts = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(h):</span><br><span class="line"> <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(w):</span><br><span class="line">       gray = out_img.getpixel((col, row))</span><br><span class="line">       texts += asciis[<span class="built_in">int</span>(gray / <span class="number">255</span> * (<span class="built_in">len</span>(asciis) - <span class="number">1</span>))]  <span class="comment">#  ASCII </span></span><br><span class="line"> texts += <span class="string">&#x27;\n&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(texts)</span><br><span class="line">    file.close()</span><br></pre></td></tr></table></figure>
<p>1.txt</p>
<p><img src="/post/22e56931/image-20230911144716398.png" alt="image-20230911144716398"></p>
<p>Terminalflag</p>
<p><img src="/post/22e56931/image-20230911144745871.png" alt="image-20230911144745871"></p>
<p>flag</p>
<p><strong>cnss{funny_ascii_ocr_duibudui}</strong></p>
<p><br></p>
<p><br></p>
<h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>misc</p>
]]></content>
      <categories>
        <category>wp-misc</category>
      </categories>
  </entry>
  <entry>
    <title>2023--wp-crypto</title>
    <url>/post/47440.html</url>
    <content><![CDATA[<p>~</p>
<span id="more"></span>
<h2 id="Danger-RSA"><a href="#Danger-RSA" class="headerlink" title="Danger_RSA"></a>Danger_RSA</h2><p>:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">rsa</span><br></pre></td></tr></table></figure>
<p>:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_key</span>(<span class="params">a, nbit</span>):</span><br><span class="line">    <span class="keyword">assert</span> a &gt;= <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        X = getRandomInteger(nbit // a)</span><br><span class="line">        s = getRandomRange(<span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">4</span>), <span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">5</span>))</span><br><span class="line">        p = X ** a + s</span><br><span class="line">        <span class="keyword">if</span> isPrime(p):</span><br><span class="line">            <span class="keyword">return</span> (p, s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p, s = get_key(a, <span class="number">1024</span>)</span><br><span class="line">q, t = get_key(a, <span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">N = p * q</span><br><span class="line">e = s * t</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;N =&quot;</span>, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e =&quot;</span>, e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"><span class="comment"># N = 20289788565671012003324307131062103060859990244423187333725116068731043744218295859587498278382150779775620675092152011336913225797849717782573829179765649320271927359983554162082141908877255319715400550981462988869084618816967398571437725114356308935833701495015311197958172878812521403732038749414005661189594761246154666465178024563227666440066723650451362032162000998737626370987794816660694178305939474922064726534186386488052827919792122844587807300048430756990391177266977583227470089929347969731703368720788359127837289988944365786283419724178187242169399457608505627145016468888402441344333481249304670223</span></span><br><span class="line"><span class="comment"># e = 11079917583</span></span><br><span class="line"><span class="comment"># c = 13354219204055754230025847310134936965811370208880054443449019813095522768684299807719787421318648141224402269593016895821181312342830493800652737679627324687428327297369122017160142465940412477792023917546122283870042482432790385644640286392037986185997262289003477817675380787176650410819568815448960281666117602590863047680652856789877783422272330706693947399620261349458556870056095723068536573904350085124198592111773470010262148170379730937529246069218004969402885134027857991552224816835834207152308645148250837667184968030600819179396545349582556181916861808402629154688779221034610013350165801919342549766</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>get_key:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">X = getRandomInteger(nbit // a)</span><br><span class="line">s = getRandomRange(<span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">4</span>), <span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">5</span>))</span><br></pre></td></tr></table></figure>
<p>a[2,1024],ee</p>
<script type="math/tex; mode=display">
e = 3*7*7*19*691*5741</script><p>a:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">1024</span>):</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">4</span>)*<span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">4</span>) &lt;= e <span class="keyword">and</span> <span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">5</span>)*<span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">5</span>) &gt;= e):</span><br><span class="line">        <span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>
<p>a4esa</p>
<script type="math/tex; mode=display">
s=5741*19\;,\;t=691*3*7*7</script><script type="math/tex; mode=display">
s=5741*3*7\;,\;t=691*7*19</script><p>n</p>
<script type="math/tex; mode=display">
n = (X1^4 + s)*(X2^4 + t)</script><p>stX1X2n4X1*X2n</p>
<script type="math/tex; mode=display">
n = (X1*X2)^4 + t*X1^4 + s*X2^4  + s*t</script><p></p>
<script type="math/tex; mode=display">
(X1*X2)^4 + t*X1^4 + s*X2^4  + s*t - n = 0</script><p>$\; X1^4$:</p>
<script type="math/tex; mode=display">
((X1*X2)^4  + s*t - n)* X1^4 + t*(X1^4)^2 + s*X2^4*X1^4= 0</script><p>$\;x = X1^4$</p>
<script type="math/tex; mode=display">
t*x^2 + ((X1*X2)^4  + s*t - n)* x + s*(X2*X1)^4= 0</script><p>stn</p>
<p>nRSA$\;gcd(e,phi_n)\;!=\;1$$\;3|(p-1)$$\;7|(q-1)$flagpq1024p</p>
<script type="math/tex; mode=display">
m^{e} = (m^3)^{7*7*19*691*5741} \equiv c\quad(mod\;p)</script><p></p>
<script type="math/tex; mode=display">
\quad gcd(7*7*19*691*5741,(p-1)) = 1</script><p>$m^3$RSAp</p>
<p><br></p>
<p>exp.ipynb:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"></span><br><span class="line">N = <span class="number">20289788565671012003324307131062103060859990244423187333725116068731043744218295859587498278382150779775620675092152011336913225797849717782573829179765649320271927359983554162082141908877255319715400550981462988869084618816967398571437725114356308935833701495015311197958172878812521403732038749414005661189594761246154666465178024563227666440066723650451362032162000998737626370987794816660694178305939474922064726534186386488052827919792122844587807300048430756990391177266977583227470089929347969731703368720788359127837289988944365786283419724178187242169399457608505627145016468888402441344333481249304670223</span></span><br><span class="line">e = <span class="number">11079917583</span></span><br><span class="line">c = <span class="number">13354219204055754230025847310134936965811370208880054443449019813095522768684299807719787421318648141224402269593016895821181312342830493800652737679627324687428327297369122017160142465940412477792023917546122283870042482432790385644640286392037986185997262289003477817675380787176650410819568815448960281666117602590863047680652856789877783422272330706693947399620261349458556870056095723068536573904350085124198592111773470010262148170379730937529246069218004969402885134027857991552224816835834207152308645148250837667184968030600819179396545349582556181916861808402629154688779221034610013350165801919342549766</span></span><br><span class="line">elist = [<span class="number">3</span>,<span class="number">7</span>,<span class="number">7</span>,<span class="number">19</span>,<span class="number">691</span>,<span class="number">5741</span>]</span><br><span class="line"></span><br><span class="line">a = <span class="number">2</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">pow</span>(<span class="number">2</span>, i ** <span class="number">2</span> - i + <span class="number">4</span>)*<span class="built_in">pow</span>(<span class="number">2</span>, i ** <span class="number">2</span> - i + <span class="number">4</span>) &lt;= e <span class="keyword">and</span> <span class="built_in">pow</span>(<span class="number">2</span>, i ** <span class="number">2</span> - i + <span class="number">5</span>)*<span class="built_in">pow</span>(<span class="number">2</span>, i ** <span class="number">2</span> - i + <span class="number">5</span>) &gt;= e):</span><br><span class="line">        a = i</span><br><span class="line"></span><br><span class="line">s1 = <span class="number">120561</span> </span><br><span class="line">s2 = <span class="number">91903</span></span><br><span class="line"></span><br><span class="line">ab = iroot(N,<span class="number">4</span>)[<span class="number">0</span>] ** <span class="number">4</span></span><br><span class="line">b = -(N-ab-s1*s2)</span><br><span class="line">a = s2</span><br><span class="line">c1 = s1*ab</span><br><span class="line">x = <span class="built_in">int</span>((-b + iroot(b**<span class="number">2</span>-<span class="number">4</span>*a*c1,<span class="number">2</span>)[<span class="number">0</span>]) // (<span class="number">2</span>*a))</span><br><span class="line">p = x + s1</span><br><span class="line">q = N//p</span><br><span class="line"></span><br><span class="line">d = inverse(e//<span class="number">3</span>,p-<span class="number">1</span>)</span><br><span class="line">m3 = <span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,p))</span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; = Zmod(p)[]</span><br><span class="line">f = x^<span class="number">3</span> - m3</span><br><span class="line">res = f.roots()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">    temp = long_to_bytes(<span class="built_in">int</span>(i[<span class="number">0</span>]))</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">b&quot;DASCTF&quot;</span> <span class="keyword">in</span> temp):</span><br><span class="line">        <span class="built_in">print</span>(temp)</span><br></pre></td></tr></table></figure>
<p>flag</p>
<font color="red">DASCTF{C0nsTruct!n9_Techn1qUe2_f0r_RSA_Pr1me_EnC2ypt10N}</font>

<p><br></p>
<p>p</p>
<p>p-1q-1RSA</p>
<script type="math/tex; mode=display">
\quad c\equiv m^{3*7*7}\quad (mod\;n)</script><p>AMMAMM$7|q-1$49q-1q4977p3</p>
<p>exp.ipynb:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long,long_to_bytes,inverse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = <span class="number">3232774922192317186963877855543094060264001327534643963164572334193887491269409927593188017108306298404437170754762182875998691872041391981365074638343520234882604136837212457817534624895485767634112947143897465253262932526424371614372553023510973107043735041993637367122527503031768408492566328264574062328255875477737300307769891808134846813311720049466136337129654155946431766445576339564816809841942907193731423184669912783673012406488607834333191988772032942474663985054409518153017182678863504596312351140412943307416458908324209967299195302214349899874812717459558411734343869783905720910923365168671056618</span></span><br><span class="line">p = <span class="number">5213351003420231819415242686664610206224730148063270274863722096379841592931572096469136339538500817713355302889731144789372844731378975059329731297860686270736540109105854515590165681366189003405833252270606896051264517339339578167231093908235856718285980689179840159807651185918046198419707669304960745217</span></span><br><span class="line">q = <span class="number">3891889986375336330559716098591764128742918441309724777337583126578227827768865619689858547513951476952436981068109005313431255086775128227872912287517417948310766208005723508039484956447166240210962374423348694952997002274647622939970550008327647559433222317977926773242269276334110863262269534189811138319</span></span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">3</span>*<span class="number">7</span>*<span class="number">7</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">onemod</span>(<span class="params">e, q</span>):</span><br><span class="line">    p = random.randint(<span class="number">1</span>, q-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">pow</span>(p, (q-<span class="number">1</span>)//e, q) == <span class="number">1</span>):  <span class="comment"># (r,s)=1</span></span><br><span class="line">        p = random.randint(<span class="number">1</span>, q)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AMM_rth</span>(<span class="params">o, r, q</span>):  <span class="comment"># r|(q-1</span></span><br><span class="line">    <span class="keyword">assert</span>((q-<span class="number">1</span>) % r == <span class="number">0</span>)</span><br><span class="line">    p = onemod(r, q)</span><br><span class="line"></span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    s = q-<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>(s % r == <span class="number">0</span>):</span><br><span class="line">        s = s//r</span><br><span class="line">        t += <span class="number">1</span></span><br><span class="line">    k = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>((s*k+<span class="number">1</span>) % r != <span class="number">0</span>):</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">    alp = (s*k+<span class="number">1</span>)//r</span><br><span class="line"></span><br><span class="line">    a = <span class="built_in">pow</span>(p, r**(t-<span class="number">1</span>)*s, q)</span><br><span class="line">    b = <span class="built_in">pow</span>(o, r*a-<span class="number">1</span>, q)</span><br><span class="line">    c = <span class="built_in">pow</span>(p, s, q)</span><br><span class="line">    h = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, t-<span class="number">1</span>):</span><br><span class="line">        d = <span class="built_in">pow</span>(<span class="built_in">int</span>(b), r**(t-<span class="number">1</span>-i), q)</span><br><span class="line">        <span class="keyword">if</span> d == <span class="number">1</span>:</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            j = (-math.log(d, a)) % r</span><br><span class="line">        b = (b*(c**(r*j))) % q</span><br><span class="line">        h = (h*c**j) % q</span><br><span class="line">        c = (c*r) % q</span><br><span class="line">    result = (<span class="built_in">pow</span>(o, alp, q)*h)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ALL_Solution</span>(<span class="params">m, q, rt, cq, e</span>):</span><br><span class="line">    mp = []</span><br><span class="line">    <span class="keyword">for</span> pr <span class="keyword">in</span> rt:</span><br><span class="line">        r = (pr*m) % q</span><br><span class="line">        <span class="comment"># assert(pow(r, e, q) == cq)</span></span><br><span class="line">        mp.append(r)</span><br><span class="line">    <span class="keyword">return</span> mp</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calc</span>(<span class="params">mp, mq, e, p, q</span>):</span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    j = <span class="number">1</span></span><br><span class="line">    t1 = inverse(q, p)</span><br><span class="line">    t2 = inverse(p, q)</span><br><span class="line">    <span class="keyword">for</span> mp1 <span class="keyword">in</span> mp:</span><br><span class="line">        <span class="keyword">for</span> mq1 <span class="keyword">in</span> mq:</span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> j % <span class="number">100000</span> == <span class="number">0</span>:</span><br><span class="line">                <span class="built_in">print</span>(j)</span><br><span class="line">            ans = (mp1*t1*q+mq1*t2*p) % (p*q)</span><br><span class="line">            <span class="keyword">if</span> check(ans):</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        a = long_to_bytes(m)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;DASCTF&#x27;</span> <span class="keyword">in</span> a <span class="keyword">or</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> a:</span><br><span class="line">            <span class="built_in">print</span>(a)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ALL_ROOT2</span>(<span class="params">r, q</span>):  <span class="comment"># use function set() and .add() ensure that the generated elements are not repeated</span></span><br><span class="line">    li = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">len</span>(li) &lt; r):</span><br><span class="line">        p = <span class="built_in">pow</span>(random.randint(<span class="number">1</span>, q-<span class="number">1</span>), (q-<span class="number">1</span>)//r, q)</span><br><span class="line">        li.add(p)</span><br><span class="line">    <span class="keyword">return</span> li</span><br><span class="line"></span><br><span class="line">cp = c % p</span><br><span class="line">cq = c % q</span><br><span class="line"></span><br><span class="line">mp = AMM_rth(cp, <span class="number">3</span>, p)</span><br><span class="line">mq = AMM_rth(cq, <span class="number">7</span>, q)</span><br><span class="line"></span><br><span class="line">rt1 = ALL_ROOT2(<span class="number">3</span>, p)</span><br><span class="line">rt2 = ALL_ROOT2(<span class="number">7</span>, q)</span><br><span class="line"></span><br><span class="line">amp = ALL_Solution(mp, p, rt1, cp, <span class="number">3</span>)</span><br><span class="line">amq = ALL_Solution(mq, q, rt2, cq, <span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#q</span></span><br><span class="line">mqs = []</span><br><span class="line"><span class="keyword">for</span> mq <span class="keyword">in</span> amq:</span><br><span class="line">    mqs.append(mq)</span><br><span class="line">amq = mqs</span><br><span class="line">dq = inverse(<span class="number">3</span>, (q-<span class="number">1</span>))</span><br><span class="line">mmqs = []</span><br><span class="line"><span class="keyword">for</span> mq <span class="keyword">in</span> amq:</span><br><span class="line">    mmq = AMM_rth(mq, <span class="number">7</span>, q)</span><br><span class="line"></span><br><span class="line">    rt3 = ALL_ROOT2(<span class="number">7</span>, q)</span><br><span class="line"></span><br><span class="line">    mamq = ALL_Solution(mmq, q, rt3, mq, <span class="number">7</span>)</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> mamq:</span><br><span class="line">        mmqs.append(<span class="built_in">int</span>(<span class="built_in">pow</span>(t,dq,q)))</span><br><span class="line">amq = mmqs</span><br><span class="line"></span><br><span class="line"><span class="comment">#p</span></span><br><span class="line">dp = inverse(<span class="number">49</span>, (p-<span class="number">1</span>))</span><br><span class="line">mps = []</span><br><span class="line"><span class="keyword">for</span> mp <span class="keyword">in</span> amp:</span><br><span class="line">    mps.append(<span class="built_in">int</span>(<span class="built_in">pow</span>(mp, dp, p)))</span><br><span class="line">amp = mps</span><br><span class="line"></span><br><span class="line">calc(amp, amq, e, p, q)</span><br></pre></td></tr></table></figure>
<p></p>
<p>exp.ipynb:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long,long_to_bytes,inverse</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"><span class="comment">#M = crt(n,c)[0]</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">3232774922192317186963877855543094060264001327534643963164572334193887491269409927593188017108306298404437170754762182875998691872041391981365074638343520234882604136837212457817534624895485767634112947143897465253262932526424371614372553023510973107043735041993637367122527503031768408492566328264574062328255875477737300307769891808134846813311720049466136337129654155946431766445576339564816809841942907193731423184669912783673012406488607834333191988772032942474663985054409518153017182678863504596312351140412943307416458908324209967299195302214349899874812717459558411734343869783905720910923365168671056618</span></span><br><span class="line">p = <span class="number">5213351003420231819415242686664610206224730148063270274863722096379841592931572096469136339538500817713355302889731144789372844731378975059329731297860686270736540109105854515590165681366189003405833252270606896051264517339339578167231093908235856718285980689179840159807651185918046198419707669304960745217</span></span><br><span class="line">q = <span class="number">3891889986375336330559716098591764128742918441309724777337583126578227827768865619689858547513951476952436981068109005313431255086775128227872912287517417948310766208005723508039484956447166240210962374423348694952997002274647622939970550008327647559433222317977926773242269276334110863262269534189811138319</span></span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">3</span>*<span class="number">7</span>*<span class="number">7</span></span><br><span class="line"></span><br><span class="line">dp = inverse(<span class="number">49</span>,p-<span class="number">1</span>)</span><br><span class="line">cp = <span class="built_in">pow</span>(c,dp,p)</span><br><span class="line">PR.&lt;x&gt; = Zmod(p)[]</span><br><span class="line">f = x^<span class="number">3</span> - cp</span><br><span class="line">resp = f.roots()</span><br><span class="line"></span><br><span class="line">dq = inverse(<span class="number">3</span>,q-<span class="number">1</span>)</span><br><span class="line">cq = <span class="built_in">pow</span>(c,dq,q)</span><br><span class="line">PR.&lt;x&gt; = Zmod(q)[]</span><br><span class="line">f = x^<span class="number">49</span> - cq</span><br><span class="line">resq = f.roots()</span><br><span class="line"></span><br><span class="line">modlist = [p,q]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> resp:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> resq:</span><br><span class="line">        c = [<span class="built_in">int</span>(i[<span class="number">0</span>]),<span class="built_in">int</span>(j[<span class="number">0</span>])]</span><br><span class="line">        m = crt(modlist,c)[<span class="number">0</span>]</span><br><span class="line">        temp = long_to_bytes(m)</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">b&quot;DASCTF&quot;</span> <span class="keyword">in</span> temp):</span><br><span class="line">            <span class="built_in">print</span>(temp)</span><br></pre></td></tr></table></figure>
<p></p>
<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="Easy-3L"><a href="#Easy-3L" class="headerlink" title="Easy_3L"></a>Easy_3L</h2><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_key</span>():</span><br><span class="line">    p = getPrime(<span class="number">1400</span>)</span><br><span class="line">    f = getRandomNBitInteger(<span class="number">1024</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        q = getPrime(<span class="number">512</span>)</span><br><span class="line">        <span class="keyword">if</span> gcd(f, q) != <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    h = (invert(f, p) * q) % p</span><br><span class="line">    <span class="keyword">return</span> p, h</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt1</span>(<span class="params">m</span>):</span><br><span class="line">    a = getPrime(<span class="number">250</span>)</span><br><span class="line">    b = getRandomNBitInteger(<span class="number">240</span>)</span><br><span class="line">    n = getPrime(<span class="number">512</span>)</span><br><span class="line">    seed = m</span><br><span class="line">    s = [<span class="number">0</span>] * <span class="number">6</span></span><br><span class="line">    s[<span class="number">0</span>] = seed</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">6</span>):</span><br><span class="line">        s[i] = (s[i - <span class="number">1</span>] * a + b) % n</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt2</span>(<span class="params">msg, p, h</span>):</span><br><span class="line">    s = getRandomNBitInteger(<span class="number">512</span>)</span><br><span class="line">    c = (s * h + msg) % p</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s = encrypt1(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;S1 =&quot;</span>, s[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;S2 =&quot;</span>, s[<span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;S4 =&quot;</span>, s[<span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;S5 =&quot;</span>, s[<span class="number">5</span>])</span><br><span class="line"></span><br><span class="line">p, h = get_key()</span><br><span class="line">c = encrypt2(s[<span class="number">3</span>], p, h)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p =&quot;</span>, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;h =&quot;</span>, h)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># S1 = 28572152986082018877402362001567466234043851789360735202177142484311397443337910028526704343260845684960897697228636991096551426116049875141</span></span><br><span class="line"><span class="comment"># S2 = 1267231041216362976881495706209012999926322160351147349200659893781191687605978675590209327810284956626443266982499935032073788984220619657447889609681888</span></span><br><span class="line"><span class="comment"># S4 = 9739918644806242673966205531575183334306589742344399829232076845951304871478438938119813187502023845332528267974698273405630514228632721928260463654612997</span></span><br><span class="line"><span class="comment"># S5 = 9755668823764800147393276745829186812540710004256163127825800861195296361046987938775181398489372822667854079119037446327498475937494635853074634666112736</span></span><br><span class="line"><span class="comment"># p = 25886434964719448194352673440525701654705794467884891063997131230558866479588298264578120588832128279435501897537203249743883076992668855905005985050222145380285378634993563571078034923112985724204131887907198503097115380966366598622251191576354831935118147880783949022370177789175320661630501595157946150891275992785113199863734714343650596491139321990230671901990010723398037081693145723605154355325074739107535905777351</span></span><br><span class="line"><span class="comment"># h = 2332673914418001018316159191702497430320194762477685969994411366563846498561222483921873160125818295447435796015251682805613716554577537183122368080760105458908517619529332931042168173262127728892648742025494771751133664547888267249802368767396121189473647263861691578834674578112521646941677994097088669110583465311980605508259404858000937372665500663077299603396786862387710064061811000146453852819607311367850587534711</span></span><br><span class="line"><span class="comment"># c = 20329058681057003355767546524327270876901063126285410163862577312957425318547938475645814390088863577141554443432653658287774537679738768993301095388221262144278253212238975358868925761055407920504398004143126310247822585095611305912801250788531962681592054588938446210412897150782558115114462054815460318533279921722893020563472010279486838372516063331845966834180751724227249589463408168677246991839581459878242111459287</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>3LLLL</p>
<ul>
<li>LCGflag</li>
<li>NTRULCGS3</li>
</ul>
<p>NTRUS3LCG</p>
<p>(f,g)1024ffS3(2^512 f  (2^512)*gfgNTRU)</p>
<p>S3LCG</p>
<p>exp.ipynb</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">25886434964719448194352673440525701654705794467884891063997131230558866479588298264578120588832128279435501897537203249743883076992668855905005985050222145380285378634993563571078034923112985724204131887907198503097115380966366598622251191576354831935118147880783949022370177789175320661630501595157946150891275992785113199863734714343650596491139321990230671901990010723398037081693145723605154355325074739107535905777351</span></span><br><span class="line">h = <span class="number">2332673914418001018316159191702497430320194762477685969994411366563846498561222483921873160125818295447435796015251682805613716554577537183122368080760105458908517619529332931042168173262127728892648742025494771751133664547888267249802368767396121189473647263861691578834674578112521646941677994097088669110583465311980605508259404858000937372665500663077299603396786862387710064061811000146453852819607311367850587534711</span></span><br><span class="line">c = <span class="number">20329058681057003355767546524327270876901063126285410163862577312957425318547938475645814390088863577141554443432653658287774537679738768993301095388221262144278253212238975358868925761055407920504398004143126310247822585095611305912801250788531962681592054588938446210412897150782558115114462054815460318533279921722893020563472010279486838372516063331845966834180751724227249589463408168677246991839581459878242111459287</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dec</span>(<span class="params">S3</span>):</span><br><span class="line">    S1 = <span class="number">28572152986082018877402362001567466234043851789360735202177142484311397443337910028526704343260845684960897697228636991096551426116049875141</span></span><br><span class="line">    S2 = <span class="number">1267231041216362976881495706209012999926322160351147349200659893781191687605978675590209327810284956626443266982499935032073788984220619657447889609681888</span></span><br><span class="line">    S4 = <span class="number">9739918644806242673966205531575183334306589742344399829232076845951304871478438938119813187502023845332528267974698273405630514228632721928260463654612997</span></span><br><span class="line">    S5 = <span class="number">9755668823764800147393276745829186812540710004256163127825800861195296361046987938775181398489372822667854079119037446327498475937494635853074634666112736</span></span><br><span class="line"></span><br><span class="line">    x = [S1, S2, S3, S4, S5]</span><br><span class="line">    t = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(x)):</span><br><span class="line">        t.append(x[i] - x[i-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    m = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(t)-<span class="number">1</span>):</span><br><span class="line">        m = GCD(t[i+<span class="number">1</span>]*t[i-<span class="number">1</span>] - t[i]*t[i], m)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> sieve_base:</span><br><span class="line">        <span class="keyword">while</span> m % p == <span class="number">0</span>: m //= p</span><br><span class="line">    <span class="keyword">assert</span> isPrime(m)</span><br><span class="line"></span><br><span class="line">    a = (S3 - S2) * inverse(S2 - S1, m)</span><br><span class="line">    b = (S2 - a*S1) % m</span><br><span class="line"></span><br><span class="line">    S1 = (S1-b)*inverse(a, m) % m</span><br><span class="line">    flag = long_to_bytes(S1)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;DASCTF&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">1000</span>):</span><br><span class="line">    L = Matrix(ZZ, [[<span class="number">1</span>, (<span class="number">2</span>**e)*h],</span><br><span class="line">                    [<span class="number">0</span>, (<span class="number">2</span>**e)*p]])</span><br><span class="line">    f, g = L.LLL()[<span class="number">0</span>]</span><br><span class="line">    g = g  // (<span class="number">2</span>**e)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        S3 = (f*c) % p % g * inverse(f, g) % g</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">len</span>(<span class="built_in">bin</span>(S3)) == <span class="number">514</span>):</span><br><span class="line">            dec(S3)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<p>flag</p>
<font color="red">DASCTF{NTRU_L0G_a6e_S1mpLe}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="SigninCrypto"><a href="#SigninCrypto" class="headerlink" title="SigninCrypto"></a>SigninCrypto</h2><p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> key <span class="keyword">import</span> key</span><br><span class="line"><span class="keyword">from</span> iv <span class="keyword">import</span> iv</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"></span><br><span class="line">K1= key</span><br><span class="line">hint1 = os.urandom(<span class="number">2</span>) * <span class="number">8</span></span><br><span class="line">xor =bytes_to_long(hint1)^bytes_to_long(K1)</span><br><span class="line"><span class="built_in">print</span>(xor)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Rand</span>():</span><br><span class="line">    rseed = secrets.randbits(<span class="number">1024</span>)</span><br><span class="line">    List1 = []</span><br><span class="line">    List2 = []</span><br><span class="line">    seed(rseed)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        rand16 = getrandbits(<span class="number">16</span>)</span><br><span class="line">        List1.append(rand16)</span><br><span class="line">    seed(rseed)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">312</span>):</span><br><span class="line">        rand64 = getrandbits(<span class="number">64</span>)</span><br><span class="line">        List2.append(rand64)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;task.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">for</span> rand16 <span class="keyword">in</span> List1:</span><br><span class="line">            file.write(<span class="built_in">hex</span>(rand16)+ <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> rand64 <span class="keyword">in</span> List2:</span><br><span class="line">            file.write(<span class="built_in">hex</span>((rand64 &amp; <span class="number">0xffff</span>) | ((rand64 &gt;&gt; <span class="number">32</span>) &amp; <span class="number">0xffff</span>) &lt;&lt; <span class="number">16</span>) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">Rand()</span><br><span class="line"></span><br><span class="line">K2 = long_to_bytes(getrandbits(<span class="number">64</span>))</span><br><span class="line">K3 = flag[:<span class="number">8</span>]</span><br><span class="line"></span><br><span class="line">KEY = K1 + K2 + K3</span><br><span class="line"></span><br><span class="line">IV=iv</span><br><span class="line"></span><br><span class="line">IV1=IV[:<span class="built_in">len</span>(IV)//<span class="number">2</span>]</span><br><span class="line">IV2=IV[<span class="built_in">len</span>(IV)//<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">digest1 = hashlib.sha512(IV1).digest().<span class="built_in">hex</span>()</span><br><span class="line">digest2 = hashlib.sha512(IV2).digest().<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line">digest=digest1+digest2</span><br><span class="line">hint2=(bytes_to_long(IV)&lt;&lt;<span class="number">32</span>)^bytes_to_long(os.urandom(<span class="number">8</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(bytes_to_long((digest.encode()))))</span><br><span class="line"><span class="built_in">print</span>(hint2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mode = DES3.MODE_CBC</span><br><span class="line">des3 = DES3.new(KEY, mode, IV)</span><br><span class="line"></span><br><span class="line">pad_len = <span class="number">8</span> - <span class="built_in">len</span>(flag) % <span class="number">8</span></span><br><span class="line">padding = <span class="built_in">bytes</span>([pad_len]) * pad_len</span><br><span class="line">flag += padding</span><br><span class="line"></span><br><span class="line">cipher = des3.encrypt(flag)</span><br><span class="line"></span><br><span class="line">ciphertext=cipher.<span class="built_in">hex</span>()</span><br><span class="line"><span class="built_in">print</span>(ciphertext)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 334648638865560142973669981316964458403</span></span><br><span class="line"><span class="comment"># 0x62343937373634656339396239663236643437363738396663393438316230353665353733303939613830616662663633326463626431643139323130616333363363326631363235313661656632636265396134336361623833636165373964343533666537663934646239396462323666316236396232303539336438336234393737363465633939623966323664343736373839666339343831623035366535373330393961383061666266363332646362643164313932313061633336336332663136323531366165663263626539613433636162383363616537396434353366653766393464623939646232366631623639623230353933643833</span></span><br><span class="line"><span class="comment"># 22078953819177294945130027344</span></span><br><span class="line"><span class="comment"># a6546bd93bced0a8533a5039545a54d1fee647007df106612ba643ffae850e201e711f6e193f15d2124ab23b250bd6e1</span></span><br></pre></td></tr></table></figure>
<p>3DESflag3DESkeyiv</p>
<p></p>
<ul>
<li>KEY = K1 + K2 + K3 ,8</li>
<li>IV=iv4</li>
</ul>
<p></p>
<p><strong>K1</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">K1= key</span><br><span class="line">hint1 = os.urandom(2) * 8</span><br><span class="line">xor =bytes_to_long(hint1)^bytes_to_long(K1)</span><br><span class="line">print(xor)</span><br></pre></td></tr></table></figure>
<p>hint116K18xorhint1hint1hint1hint1xorK1</p>
<p><strong>K2</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">Rand</span>():</span><br><span class="line">    rseed = secrets.randbits(<span class="number">1024</span>)</span><br><span class="line">    List1 = []</span><br><span class="line">    List2 = []</span><br><span class="line">    seed(rseed)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        rand16 = getrandbits(<span class="number">16</span>)</span><br><span class="line">        List1.append(rand16)</span><br><span class="line">    seed(rseed)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">312</span>):</span><br><span class="line">        rand64 = getrandbits(<span class="number">64</span>)</span><br><span class="line">        List2.append(rand64)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;task.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">for</span> rand16 <span class="keyword">in</span> List1:</span><br><span class="line">            file.write(<span class="built_in">hex</span>(rand16)+ <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> rand64 <span class="keyword">in</span> List2:</span><br><span class="line">            file.write(<span class="built_in">hex</span>((rand64 &amp; <span class="number">0xffff</span>) | ((rand64 &gt;&gt; <span class="number">32</span>) &amp; <span class="number">0xffff</span>) &lt;&lt; <span class="number">16</span>) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">Rand()</span><br><span class="line"></span><br><span class="line">K2 = long_to_bytes(getrandbits(<span class="number">64</span>))</span><br></pre></td></tr></table></figure>
<p>MT19937randcrack62432bitList1List2List1List2</p>
<p>List1$624<em>16$bitList2$324</em>64 = 624*32$bitList2task.txtList2List1List2K2</p>
<p><strong>K3</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">K3 = flag[:<span class="number">8</span>]</span><br></pre></td></tr></table></figure>
<p>flagDASCTF{K3</p>
<p><strong>IV1IV2</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">IV1=IV[:<span class="built_in">len</span>(IV)//<span class="number">2</span>]</span><br><span class="line">IV2=IV[<span class="built_in">len</span>(IV)//<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">digest1 = hashlib.sha512(IV1).digest().<span class="built_in">hex</span>()</span><br><span class="line">digest2 = hashlib.sha512(IV2).digest().<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line">digest=digest1+digest2</span><br><span class="line">hint2=(bytes_to_long(IV)&lt;&lt;<span class="number">32</span>)^bytes_to_long(os.urandom(<span class="number">8</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(bytes_to_long((digest.encode()))))</span><br><span class="line"><span class="built_in">print</span>(hint2)</span><br></pre></td></tr></table></figure>
<p>IV8hint2IV1IV2.4digest=digest1+digest2digest</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">digest1 = digest2</span><br></pre></td></tr></table></figure>
<p>IV2IV1()</p>
<p>3DES</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3</span><br><span class="line"><span class="keyword">from</span> randcrack <span class="keyword">import</span> RandCrack</span><br><span class="line"></span><br><span class="line">rc = RandCrack()</span><br><span class="line"></span><br><span class="line">cipher = <span class="built_in">int</span>(<span class="string">&quot;a6546bd93bced0a8533a5039545a54d1fee647007df106612ba643ffae850e201e711f6e193f15d2124ab23b250bd6e1&quot;</span>,<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#iv</span></span><br><span class="line">hint2 = <span class="number">22078953819177294945130027344</span></span><br><span class="line">IV1 = long_to_bytes(hint2 &gt;&gt; <span class="number">64</span>)</span><br><span class="line">IV2 = IV1</span><br><span class="line"></span><br><span class="line"><span class="comment">#K2</span></span><br><span class="line">list1 = []</span><br><span class="line">list2 = []</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;task.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        list1.append(<span class="built_in">int</span>(f.readline(),<span class="number">16</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">312</span>):</span><br><span class="line">        list2.append(<span class="built_in">int</span>(f.readline(),<span class="number">16</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">312</span>):</span><br><span class="line">    t1 = (list2[i] &amp; <span class="number">0xffff</span>)</span><br><span class="line">    t2 = ((list2[i] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xffff</span>)</span><br><span class="line">    rc.submit( (list1[<span class="number">2</span>*i]&lt;&lt;<span class="number">16</span>) | (list2[i] &amp; <span class="number">0xffff</span>))</span><br><span class="line">    rc.submit( (list1[<span class="number">2</span>*i+<span class="number">1</span>]&lt;&lt;<span class="number">16</span>) | ((list2[i] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xffff</span>))</span><br><span class="line">K2 = long_to_bytes(rc.predict_getrandbits(<span class="number">64</span>),<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#k3</span></span><br><span class="line">xor = <span class="number">334648638865560142973669981316964458403</span></span><br><span class="line">K1 = (xor ^ (xor&gt;&gt;<span class="number">64</span>)) &amp; <span class="number">0xffffffffffffffff</span></span><br><span class="line">K1 = long_to_bytes(K1)</span><br><span class="line"></span><br><span class="line">temp = bytes_to_long(<span class="string">b&quot;DASCTF&#123;&quot;</span>) &lt;&lt; <span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">8</span>):</span><br><span class="line">    K3 = long_to_bytes(temp + j)</span><br><span class="line">    KEY = K1 + K2 + K3</span><br><span class="line">    IV = IV1 + IV2</span><br><span class="line"></span><br><span class="line">    mode = DES3.MODE_CBC</span><br><span class="line">    des3 = DES3.new(KEY, mode, IV)</span><br><span class="line">    flag = <span class="built_in">str</span>(des3.decrypt(long_to_bytes(cipher)))</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">&quot;DASCTF&quot;</span> <span class="keyword">in</span> flag):</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>flag</p>
<font color="red">DASCTF{8e5ee461-f4e1-4af2-8632-c9d62f4dc073}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="esyRSA"><a href="#esyRSA" class="headerlink" title="esyRSA"></a>esyRSA</h2><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">RSAe</span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> md5 <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> p, q</span><br><span class="line"></span><br><span class="line">e = ?????</span><br><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = invert(e, phi)</span><br><span class="line">ans = gcd(e,phi)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> n, e, d</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;Flag: DASCTF&#123;%s&#125;&quot;</span> %md5(<span class="built_in">str</span>(p + q)).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 8064259277274639864655809758868795854117113170423331934498023294296505063511386001711751916634810056911517464467899780578338013011453082479880809823762824723657495915284790349150975180933698827382368698861967973964030509129133021116919437755292590841218316278732797712538885232908975173746394816520256585937380642592772746398646558097588687958541171131704233319344980232942965050635113860017117519166348100569115174644678997805783380130114530824798808098237628247236574959152847903491509751809336988273823686988619679739640305091291330211169194377552925908412183162787327977125388852329089751737463948165202565859373</span></span><br><span class="line"><span class="string">d = 14218766449983537783699024084862960813708451888387858392014856544340557703876299258990323621963898510226357248200187173211121827541826897886277531706124228848229095880229718049075745233893843373402201077890407507625110061976931591596708901741146750809962128820611844426759462132623616118530705745098783140913</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>nndwienereeedn</p>
<p>exp.py:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">n = <span class="string">&quot;8064259277274639864655809758868795854117113170423331934498023294296505063511386001711751916634810056911517464467899780578338013011453082479880809823762824723657495915284790349150975180933698827382368698861967973964030509129133021116919437755292590841218316278732797712538885232908975173746394816520256585937380642592772746398646558097588687958541171131704233319344980232942965050635113860017117519166348100569115174644678997805783380130114530824798808098237628247236574959152847903491509751809336988273823686988619679739640305091291330211169194377552925908412183162787327977125388852329089751737463948165202565859373&quot;</span></span><br><span class="line">n = <span class="number">80642592772746398646558097588687958541171131704233319344980232942965050635113860017117519166348100569115174644678997805783380130114530824798808098237628247236574959152847903491509751809336988273823686988619679739640305091291330211169194377552925908412183162787327977125388852329089751737463948165202565859373</span></span><br><span class="line">d = <span class="number">14218766449983537783699024084862960813708451888387858392014856544340557703876299258990323621963898510226357248200187173211121827541826897886277531706124228848229095880229718049075745233893843373402201077890407507625110061976931591596708901741146750809962128820611844426759462132623616118530705745098783140913</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>,<span class="number">100000</span>):</span><br><span class="line">    t = e*d - <span class="number">1</span></span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> t % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        s += <span class="number">1</span></span><br><span class="line">        t //= <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    found = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, s):</span><br><span class="line">        c1 = <span class="built_in">pow</span>(<span class="number">2</span>, <span class="built_in">pow</span>(<span class="number">2</span>, i-<span class="number">1</span>, n)*t, n)</span><br><span class="line">        c2 = <span class="built_in">pow</span>(<span class="number">2</span>, <span class="built_in">pow</span>(<span class="number">2</span>, i, n)*t, n)</span><br><span class="line">        <span class="keyword">if</span> c1 != <span class="number">1</span> <span class="keyword">and</span> c1 != (-<span class="number">1</span> % n) <span class="keyword">and</span> c2 == <span class="number">1</span>:</span><br><span class="line">            p = GCD(c1 - <span class="number">1</span>, n)</span><br><span class="line">            q = n // p</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;Flag: DASCTF&#123;%s&#125;&quot;</span> %hashlib.md5(<span class="built_in">str</span>(p + q).encode()).hexdigest())</span><br><span class="line">            exit()   </span><br></pre></td></tr></table></figure>
<p>flag</p>
<font color="red">DASCTF{4ae33bea90f030bfddb7ac4d9222ef8f}</font>

<p>(<del></del>/(o)/~~)</p>
<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="MCeorpkpleer"><a href="#MCeorpkpleer" class="headerlink" title="MCeorpkpleer"></a>MCeorpkpleer</h2><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pubkey</span>(<span class="params"><span class="built_in">list</span>, m, w</span>):</span><br><span class="line">    pubkey_list = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e_bin)):</span><br><span class="line">        pubkey_list.append(w * <span class="built_in">list</span>[i] % m)</span><br><span class="line">    <span class="keyword">return</span> pubkey_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">e_cry</span>(<span class="params">e, pubkey</span>):</span><br><span class="line">    pubkey_list = pubkey</span><br><span class="line">    encode = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e)):</span><br><span class="line">        encode += pubkey_list[i] * <span class="built_in">int</span>(e[i]) % m</span><br><span class="line">    <span class="keyword">return</span> encode</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = getPrime(<span class="number">64</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line">e_bin = (<span class="built_in">bin</span>(e))[<span class="number">2</span>:]</span><br><span class="line"><span class="built_in">list</span> = [<span class="built_in">pow</span>(<span class="number">3</span>, i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e_bin))]</span><br><span class="line">m = getPrime(<span class="built_in">len</span>(<span class="built_in">bin</span>(<span class="built_in">sum</span>(<span class="built_in">list</span>))) - <span class="number">1</span>)</span><br><span class="line">w = getPrime(<span class="number">64</span>)</span><br><span class="line">pubkey = pubkey(<span class="built_in">list</span>, m, w)</span><br><span class="line">en_e = e_cry(e_bin, pubkey)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p = &#123;&#125;\n&#x27;</span></span><br><span class="line">      <span class="string">&#x27;n = &#123;&#125;\n&#x27;</span></span><br><span class="line">      <span class="string">&#x27;c = &#123;&#125;\n&#x27;</span></span><br><span class="line">      <span class="string">&#x27;pubkey = &#123;&#125;\n&#x27;</span></span><br><span class="line">      <span class="string">&#x27;en_e = &#123;&#125;&#x27;</span>.<span class="built_in">format</span>((p &gt;&gt; <span class="number">435</span>) &lt;&lt; <span class="number">435</span>, n, c, pubkey, en_e))</span><br></pre></td></tr></table></figure>
<p>e_cryeecoppersmithp</p>
<p>exp.ipynb</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#step1 ppq</span></span><br><span class="line">p4 = <span class="number">139540788452365306201344680691061363403552933527922544113532931871057569249632300961012384092481349965600565669315386312075890938848151802133991344036696488204791984307057923179655351110456639347861739783538289295071556484465877192913103980697449775104351723521120185802327587352171892429135110880845830815744</span></span><br><span class="line">n = <span class="number">22687275367292715121023165106670108853938361902298846206862771935407158965874027802803638281495587478289987884478175402963651345721058971675312390474130344896656045501040131613951749912121302307319667377206302623735461295814304029815569792081676250351680394603150988291840152045153821466137945680377288968814340125983972875343193067740301088120701811835603840224481300390881804176310419837493233326574694092344562954466888826931087463507145512465506577802975542167456635224555763956520133324723112741833090389521889638959417580386320644108693480886579608925996338215190459826993010122431767343984393826487197759618771</span></span><br><span class="line">pbits = <span class="number">1024</span></span><br><span class="line">kbits= <span class="number">435</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x + p4</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^kbits,beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="keyword">if</span> roots:</span><br><span class="line">    p= p4 + <span class="built_in">int</span>(roots[<span class="number">0</span>])</span><br><span class="line">    q = n//p</span><br><span class="line"></span><br><span class="line"><span class="comment">#step2 e</span></span><br><span class="line">b = [<span class="number">18143710780782459577</span>, <span class="number">54431132342347378731</span>, <span class="number">163293397027042136193</span>, <span class="number">489880191081126408579</span>, <span class="number">1469640573243379225737</span>, <span class="number">4408921719730137677211</span>, <span class="number">13226765159190413031633</span>, <span class="number">39680295477571239094899</span>, <span class="number">119040886432713717284697</span>, <span class="number">357122659298141151854091</span>, <span class="number">1071367977894423455562273</span>, <span class="number">3214103933683270366686819</span>, <span class="number">9642311801049811100060457</span>, <span class="number">28926935403149433300181371</span>, <span class="number">86780806209448299900544113</span>, <span class="number">260342418628344899701632339</span>, <span class="number">781027255885034699104897017</span>, <span class="number">2343081767655104097314691051</span>, <span class="number">7029245302965312291944073153</span>, <span class="number">21087735908895936875832219459</span>, <span class="number">63263207726687810627496658377</span>, <span class="number">189789623180063431882489975131</span>, <span class="number">569368869540190295647469925393</span>, <span class="number">1708106608620570886942409776179</span>, <span class="number">601827224419797931380408071500</span>, <span class="number">1805481673259393794141224214500</span>, <span class="number">893952418336266652976851386463</span>, <span class="number">2681857255008799958930554159389</span>, <span class="number">3523079163584485147344841221130</span>, <span class="number">1524252287869625983140881149316</span>, <span class="number">50264262166963219975822190911</span>, <span class="number">150792786500889659927466572733</span>, <span class="number">452378359502668979782399718199</span>, <span class="number">1357135078508006939347199154597</span>, <span class="number">4071405235524020818041597463791</span>, <span class="number">3169230503688232995231149877299</span>, <span class="number">462706308180869526799807117823</span>, <span class="number">1388118924542608580399421353469</span>, <span class="number">4164356773627825741198264060407</span>, <span class="number">3448085117999647764701149667147</span>, <span class="number">1299270151115113835209806487367</span>, <span class="number">3897810453345341505629419462101</span>, <span class="number">2648446157152195057994615872229</span>, <span class="number">3422845870014670444537026359650</span>, <span class="number">1223552407160181874717436564876</span>, <span class="number">3670657221480545624152309694628</span>, <span class="number">1966986461557807413563286569810</span>, <span class="number">1378466783231507511243038452393</span>, <span class="number">4135400349694522533729115357179</span>, <span class="number">3361215846199738142293703557463</span>, <span class="number">1038662335715384967987468158315</span>, <span class="number">3115987007146154903962404474945</span>, <span class="number">302975818554635252993570910761</span>, <span class="number">908927455663905758980712732283</span>, <span class="number">2726782366991717276942138196849</span>, <span class="number">3657854499533237101379593333510</span>, <span class="number">1928578295715881845245137486456</span>, <span class="number">1263242285705730806288591202331</span>, <span class="number">3789726857117192418865773606993</span>, <span class="number">2324195368467747797703678306905</span>, <span class="number">2450093503961328663664213663678</span>, <span class="number">2827787910442071261545819733997</span>, <span class="number">3960871129884299055190637944954</span>, <span class="number">2837628186769067706678271320788</span>]</span><br><span class="line">c = <span class="number">31087054322877663244023458448558</span></span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(b)</span><br><span class="line">L = Matrix(ZZ, n+<span class="number">1</span>, n+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    L[i,i] = <span class="number">1</span></span><br><span class="line">    L[i,-<span class="number">1</span>] = b[i]</span><br><span class="line">L[-<span class="number">1</span>,-<span class="number">1</span>] = -c</span><br><span class="line"></span><br><span class="line">res = L.LLL()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n + <span class="number">1</span>):</span><br><span class="line">    M = res.row(i).<span class="built_in">list</span>()</span><br><span class="line">    flag = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> M:</span><br><span class="line">        <span class="keyword">if</span> m != <span class="number">0</span> <span class="keyword">and</span> m != <span class="number">1</span>:</span><br><span class="line">            flag = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> flag:</span><br><span class="line">        e = M</span><br><span class="line"></span><br><span class="line"><span class="comment">#step3 RSA</span></span><br><span class="line">c = <span class="number">156879727064293983713540449709354153986555741467040286464656817265584766312996642691830194777204718013294370729900795379967954637233360644687807499775502507899321601376211142933572536311131955278039722631021587570212889988642265055045777870448827343999745781892044969377246509539272350727171791700388478710290244365826497917791913803035343900620641430005143841479362493138179077146820182826098057144121231954895739989984846588790277051812053349488382941698352320246217038444944941841831556417341663611407424355426767987304941762716818718024107781873815837487744195004393262412593608463400216124753724777502286239464</span></span><br><span class="line">n = p*q</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e)):</span><br><span class="line">    e[i] = <span class="built_in">str</span>(e[i])</span><br><span class="line">e = <span class="string">&quot;&quot;</span>.join(e)[:-<span class="number">1</span>]</span><br><span class="line">e = <span class="built_in">int</span>(e,<span class="number">2</span>)</span><br><span class="line">d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n))))</span><br></pre></td></tr></table></figure>
<p>flag</p>
<font color="red">DASCTF{T81I_tPPS_6r7g_xlPi_OO3M_6vyV_Rkba}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="XOR"><a href="#XOR" class="headerlink" title="XOR"></a>XOR</h2><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<p></p>
<p>message.txt</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<p>task.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> enflag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = q * p</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">e = getPrime(<span class="number">17</span>)</span><br><span class="line"><span class="keyword">assert</span> gcd(e, phi) == <span class="number">1</span></span><br><span class="line"><span class="comment"># ,</span></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(enflag, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c = &#x27;</span> + <span class="built_in">str</span>(c))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 91817924748361493215143897386603397612753451291462468066632608541316135642691873237492166541761504834463859351830616117238028454453831120079998631107520871612398404926417683282285787231775479511469825932022611941912754602165499500350038397852503264709127650106856760043956604644700201911063515109074933378818</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>pri.pem</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-----BEGIN PRIVATE KEY-----</span><br><span class="line">MIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBALmtMy+2uH1ZtbIL</span><br><span class="line">SuiAukFthyQRH5mp7UmLyzZQkdg9zEP9/5tgffikQ7ytx5kHySHnazgAO1sOzmYE</span><br><span class="line">N4Axlev6uafiP8B1Eij97v5VkYJ1I9e3mtBNheTbXKoT8op+ASQ1fQaF4A8UzLuW</span><br><span class="line">eZeZI8JTH/SH+bolAK3kiZXDFdkTAgMBAAECgYEAl067LaC7Cvs2A5cMPhfYsESv</span><br><span class="line">IgcKN1CwW4Sd3u8dSphhgu7TgyzIuvwxbuo2g1BC6WwKhaI6vGN+csfw6nh98GEn</span><br><span class="line">/p3D0huNroAYvf/DRRB9UnHdttX7wB+Mv3P0RBDWHgBiCDVvHFuFUV78cIs0tnbn</span><br><span class="line">jxjU07aPV2XRC3AfA2ECQQDqWUNPVg3i6vTyHCL7EGkbeUheYpAAfcKCQrxjc5+5</span><br><span class="line">X6A+XtgHAA1JHwykPlCpHUOmlA85DJF1ejuoImzlgRLJAkEAytTCnQF+MN2r1gaA</span><br><span class="line">UETZyj5qMYT7Th8zKEVVVJjDawLnuX4usJ2FyRnjCkk86U75QSJhw5mMc0QnG25u</span><br><span class="line">Gz3++w==</span><br><span class="line">-----END PRIVATE KEY-----</span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">C0ngr4tulati0n5_y0u_fou^d_m3</span><br></pre></td></tr></table></figure>
<p>RSAbase64</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">b&#x27;30820277020100300d06092a864886f70d0101010500048202613082025d02010002818100b9ad332fb6b87d59b5b20b4ae880ba416d8724111f99a9ed498bcb365091d83dcc43fdff9b607df8a443bcadc79907c921e76b38003b5b0ece660437803195ebfab9a7e23fc0751228fdeefe5591827523d7b79ad04d85e4db5caa13f28a7e0124357d0685e00f14ccbb9679979923c2531ff487f9ba2500ade48995c315d913020301000102818100974ebb2da0bb0afb3603970c3e17d8b044af22070a3750b05b849ddeef1d4a986182eed3832cc8bafc316eea36835042e96c0a85a23abc637e72c7f0ea787df06127fe9dc3d21b8dae8018bdffc345107d5271ddb6d5fbc01f8cbf73f44410d61e006208356f1c5b85515efc708b34b676e78f18d4d3b68f5765d10b701f0361024100ea59434f560de2eaf4f21c22fb10691b79485e6290007dc28242bc63739fb95fa03e5ed807000d491f0ca43e50a91d43a6940f390c91757a3ba8226ce58112c9024100cad4c29d017e30ddabd606805044d9ca3e6a3184fb4e1f332845555498c36b02e7b97e2eb09d85c919e30a493ce94ef9412261c3998c7344271b6e6e1b3dfefb&#x27;</span><br></pre></td></tr></table></figure>
<p>RSA</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">n 028181 00b9ad332fb6b87d59b5b20b4ae880ba416d8724111f99a9ed498bcb365091d83dcc43fdff9b607df8a443bcadc79907c921e76b38003b5b0ece660437803195ebfab9a7e23fc0751228fdeefe5591827523d7b79ad04d85e4db5caa13f28a7e0124357d0685e00f14ccbb9679979923c2531ff487f9ba2500ade48995c315d913</span><br><span class="line">e 0203 010001</span><br><span class="line">d 028181 00974ebb2da0bb0afb3603970c3e17d8b044af22070a3750b05b849ddeef1d4a986182eed3832cc8bafc316eea36835042e96c0a85a23abc637e72c7f0ea787df06127fe9dc3d21b8dae8018bdffc345107d5271ddb6d5fbc01f8cbf73f44410d61e006208356f1c5b85515efc708b34b676e78f18d4d3b68f5765d10b701f0361</span><br><span class="line">p 0241 00ea59434f560de2eaf4f21c22fb10691b79485e6290007dc28242bc63739fb95fa03e5ed807000d491f0ca43e50a91d43a6940f390c91757a3ba8226ce58112c9</span><br><span class="line">q 0241 00cad4c29d017e30ddabd606805044d9ca3e6a3184fb4e1f332845555498c36b02e7b97e2eb09d85c919e30a493ce94ef9412261c3998c7344271b6e6e1b3dfefb&quot;</span><br></pre></td></tr></table></figure>
<p>dpdqinv(q,p)RSA</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DASCTF&#123;0e287wQ\x08R\x17\x00FGXYFZ\x07V\x03kIUCn\x02VDg\x01f\x0cN</span><br></pre></td></tr></table></figure>
<p>XOR</p>
<p>flag</p>
<font color="red">DASCTF{0e2874af5e422482378640e61d919e9a}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id=""><a href="#" class="headerlink" title=""></a></h2><p></p>
]]></content>
      <categories>
        <category>wp-crypto</category>
      </categories>
  </entry>
  <entry>
    <title>Crypto-Lattice</title>
    <url>/post/9b40da15.html</url>
    <content><![CDATA[<p></p>
<span id="more"></span>
<h3 id="AGCD"><a href="#AGCD" class="headerlink" title="AGCD"></a>AGCD</h3><p></p>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">nbits = <span class="number">512</span></span><br><span class="line">delta = <span class="number">.93</span></span><br><span class="line">kbits = <span class="built_in">int</span>(nbits*delta) &gt;&gt; <span class="number">1</span></span><br><span class="line">bound = <span class="number">2</span>**kbits</span><br><span class="line"></span><br><span class="line">m = <span class="number">53</span></span><br><span class="line">p = getPrime(nbits)</span><br><span class="line">x = randint(<span class="number">2</span>, p - <span class="number">1</span>)</span><br><span class="line">a = [randint(<span class="number">2</span>, bound) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m)]</span><br><span class="line">b = [inverse(a[i] * x + randint(<span class="number">2</span>, bound), p) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m)]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;a = &#125;</span>\n<span class="subst">&#123;b = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n = p * getPrime(nbits)</span><br><span class="line">c = <span class="built_in">pow</span>(bytes_to_long(flag), e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;e = &#125;</span>\n<span class="subst">&#123;n = &#125;</span>\n<span class="subst">&#123;c = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">a = [226623173423524660762660587272926713775967113908071780918074044654746571, 99264763681859867816401881797921542580399607408617989905539839585323915, 177386736426181055874933306917112626356703658087900095566603898769091471, 5081587307910189127020749833744000992860852972311811125838243285877024, 411574110749659943703486080205654180795533263258790540505729307655142415, 1932137082695732276757073197845160804183868657578020568122170798605640, 103124563846054461729937757543103647655652920105466714505493351091607258, 65504504807895104765113845019342631211794998326986693051403166347389343, 151981136459515488882551190881724794060443302721456924436833810784219984, 3718222682937746804225225548712093487815785751144078132168082568580360, 113510621144631490440930342566441462111997352193075435129065142534001691, 120974784665251812036673794948678799274628176126865320042025545119228958, 193781634902416477262894357163294897773986019836290716577623654684669134, 24723078645443091017196603549741156206848230267873373213787667300835247, 113165730428784680251415263617027036564335843097634063978942541861726366, 407969345567975756778713582637075079783087682011802438819519567067241979, 151997755976755754648644424339697978791639952976423703068460739754839735, 253811682402531882908516509348937060650658679039884817907013090700281326, 404019046883201096048575369492824679211148242588135515488831100750933, 216725815105749574244056185735609680710954976727370948136589694286539150, 131605791470353972911656132280131756304373156215254629027113994962767833, 180190835657942894146705472335255090682179032409197893415067330574923084, 280086867488286721744184104208965143004904898002959657537412170401510680, 141039650035922882497777354937772530276454847300329950111476878397654053, 319858542602843767926919031049756704694256249776295683733693049522108872, 135633729043152514436339515687850041275739968837263316059461122379487161, 5038078437655552457504448170918674775639811066221990939957937239270167, 31918623105281221407484700216805581554894830335850729735403857505547002, 424092292941284354705774693468403308534554297314522980647422106907791591, 300635399575681097924575337707842439619576566621368558814406755486658723, 323686536134235835297820679361020300261642147835330856978902402517820801, 392620731408972775834827063986182511057173023783228673505487358356342114, 108681888409433100038410892044516773350200560613740266422720530715166828, 182338238967593331173372924666322484559869636981878410128856193538847678, 242630103099393630296862580986126439159331512930513337684897019399319621, 439737851682655515589311041364295341910822514202794661846391952824593066, 84115222835816390632388766236883091861894245716624041418721833768917547, 83926810016448863267608537461154878096011055852547156452557576634691363, 354588657997053098464002945990025178880458974438409486331146607111950617, 170413334241108032297843362994773587930354677207616527135896108692092457, 283185550452196010949673962093382632839937948488235076418296451706429923, 390000015988537819093964185756696910433784324036454283227484980367608884, 121370082693927496814267201484843687844578996855559797026014779421645731, 357164702199289826402900456464935203585119719343409406742172822868770420, 124276883926433089715798954125363260298740714164810098876501303684201565, 122912426324401068572433533096099229494021528981601203447594706478943744, 287527827124819650763642012585104162743364640051014410357971387706781531, 135819408760576908301747047938951002691288880199213610653148681326046091, 239644892459756283997004399339163555215985564639569406081575642996080481, 241513055132921096791997556818670497379598444881679976542299970876463098, 144152466563589166040797814966860917437020789050031353309848917297959088, 120162009732086541189519736083838746833770360960800721525565383293404918, 121547756201941339094205049920057111793191461762212554355070565584802804]</span></span><br><span class="line"><span class="string">b = [6914108949558554967947157128371931777410399406424987472871265954007536210016000226325059466226417032321637768264366355381358552354005990800271210820573485, 4243350947524503250221141283676871054961767761533372535893799777316644277502608136805589201625364130457811586620275507258712882614289496389903620348266876, 7207723049065039433195103268720351560639394404931218738588797743896531445162073256971205066381805731964498662913612257697112297701515506572915529630749649, 9478867353430476119494189313998177997736272254097122188128236485373498544996365281925749885278741955783336542038044934310609039388320259421902808190444639, 10092751897940937230080778690510245631681516769761757712615337492357689455504789850857408988921202275660819814611602363226676960504340172006698418415173603, 5925826079655586275072881965974452367893696237983922405515651101142466142890347074549417916208251973477786424292583294611467079137685936757690986611634840, 2705681917429356111941316419951220642197423059675588735077708172236184161647753066851383893342803615318493417826483637576437939588768131347824859258545037, 5793481213766970753853702438948943122939283534830229656699291673833482520096412620329053619097899786691202045974184168665694248732396928571682405270896258, 3212965229314647637209688663583343281038324880827825190075824389072703574155472958687615046177029380089781167897141334668918512246004114927754397070032450, 507858897452123392345795058512546587866098555419275815786154069852495346820264502978622507708545904809967228104858456493411165322256241259977367791849042, 1910673108437857460691507244808588742883010826641687685721219894695257479961884688001651060796296482279750896861871054549713247272267814842634417960819168, 2886899741243848325873884252302617091514751717162909139186588257257958079130295099942906361136727891394692438504521454612873780003451672796809495226053047, 9475112027697464127079619380873273645977046666164164866182205134451664768516062572467782141714310693479352016031210905832129007401065693258638549100340615, 6500556077535313473248384729914564751019267303740919343852356539545383313100771434642240039386190890442297569489225045989569513367190888305128046797790102, 4352575880916080525863863641402979108455803235156616467981920947190189719209876636528864672410548581564537392488508689158499605332674737341258230577454475, 8855806560115120193748486720541724804359134126331550182497194629659837334220708039976726151383523965042432921330088347099157101222325916589506823343303429, 2774687136241363374520941544838376461935832170671324174983217598018541119488143069001573950404074015672792681188308412236177101695870429933915439814455887, 3592625154014227818614640279472091377202566130067513443394635609406915223429475106920133466069573358784994632708606215548054720669924050172507230811524716, 6955167231829680836198358545532458408492109230130585460528670650387346748536700767474985024643177587060440925065292948599577822789464670224006606550191671, 9194240450171813716718107852597217121362901491312541712415368806074976814988492806542250961496723482200369134039024809109124268301878344007510329535899615, 5950577443108124534632225089717156798651285826327691188035165834526053749015025923590404663092184546183617748745220821771671541995250149683517797527521402, 8147536282406177354958293970877926560729452459282692121940762677425779306283487924160782780299072205173184092679363257393333408904258459452274140791704067, 2559838851622656651952688025212080768394118716136473174419624432065878751831257138924556995347285973152404103332115858073203707432778426111325160735797721, 4949359541993387232537947394033362386729434824378846379892748514319807403496542405321037377319385099259508143211518009425440208974571177165892037150309091, 1811673815510905036234500180939767229691774807773077679609856974935852997557959138952513786288094951891092390620085630282790435640054840555430191851155313, 4777885082419038381870076531532991228660498200204585112220314790970263737966241042846160101892845251352987027168075888559622541458466624868511496707956221, 10238413710887745087366241938666680877364662925315040665408262063559110391570620624035047723405526398382375337996702653261521046541231508963525281969167278, 3473340971529025694371400010471019993671985537666177271712164477185774211271764180735799413043127038518985595844132844447764288680922052782557764949946998, 867350328105510555601266520733196439839458877892746826352327206388533426010006967907349245075237097927904721917883721235095421696529792601733014134854086, 2222551217354471458254572360148123193413834831993026644829243162796014361851880328878269533732240093458365703558737637137958860294765246560791514120259973, 11135205396103944017696365595462393888434601100415179875833418713405171505514194213145570969708606144837327906949671055964664374675657263466390592843391795, 8522093767526974938129274822063573020978729589640216089964237075835492415426711219243729120235033613444547687888110911207624759350428715822663409802746531, 618066223420558653541360712487038985426207412776033652080372792996567809564864490136174039188920973110051946250308952735815050129654446357610891600358247, 9409683398358516350960966400164689353665188916574105692687503875332913200043983566205433723664581043184720605266180639045542588369320481456882129188045630, 10444912184036485133367095187175276878779180732948191228469107836744786278456394810069942330852023901190983084405589604802372025661121698806608507168815980, 5576808818750933483753823503921696491223987341840901931564632327098735945058071342467846031030536056935288275893098409520502499556978787294107531192342888, 11386170831130547392066338523237385342399839863674855226178213470159061980868639851406716227763244070078162813390834461297132500087558187715637626334931068, 9266567474732845229716988973436914937598698459994255583719094874193822181675544832905800318876640152861212158602258489908050910803591150200525814954449464, 783592057196685768383414375510915255040313296240508052297125547577301394194342174502254618660494179262947294784116190346971775913769035176336764690986707, 9105502180406569116340185218615179260760299848734930041602247299415927012355894700609320722623370139135122342263713846033304524885782445949914570572453737, 2297513067567074587355421795953863750627166311403426281361312466297059134183355298180726594771668216966732975569375780641995446201527865824229865021970151, 11188600115372846854366137972585164923834717935898376598627276542371780275188751807941476083838808640337088079259756154889298297211898790479562768420072518, 9656534484640562909118084019762167873291009773232637365213178341424207965285682074941363264934464618450896824843786922345950140473512635227211478685645772, 9343461413426168572561103655466265435717795505657355206522619014228487030194629865342342831380623629471381377128476731390629039248389925891691539701146309, 8681682631345831952913045584970984843073645909076987924890403622460027832467542651987623584349089629585531159664847835287269602153108548311564650707486153, 2656022193773767486949157049738671449721427276944394094199310567891807831351152318018854466905531462256724938253289337125816757790150607033652302227218868, 8508384570273623974802293014504152838556567399448174508834295467479347400327605230626491770497722014885725768213847610504091563629074470937893415637338996, 9716708016762837073052660164394053927821481998442639097920157163041635386583167412600530638659299593644342722890385260143682043966383262553995449944733956, 10231440381205182517403356785692369093270060843919065205063057623835967990844569366866607452179015606536153761832574542432676397053147658371344410148994418, 5146017765041682548648007957706007143803297597587388958721578537741505373387718545092695689770641249769257901519197825087801304735466239843061128683798476, 5222787643951107881679620487297380490422971146509273142662864657570322385794688143091615970726544447887548792995773377472568754141261595697499826832283200, 10464709627510729920064247596403868144579001206027850090117534773353171042729174225448975480540265139445689560336303762183734720331072177316589830221880977, 8615548684371129329547908465444932886632829509038689025840147771114904826804441395348568994340729561487767929565347408386252378372026787346043297419998538]</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">n = 97853623351997296064353255135588846396569970130207954701198599507389250544514082114957455795330569730103385876268186267851194017938003005329258612122178955978821786063623918361705120943030241043571056282806763102278839262572943852578441568495106906583558313075633340995336324665255745279078992160547871869557</span></span><br><span class="line"><span class="string">c = 44431449479567561261917922338101462065458737366369232901780150553091038211618354850829522817943842817713545313017593484450672219262670055539455602698182643653128488160901383204333856589371756831501857423631322915113418699087489759910739942878900174507138454184974875778861767989603951090385047953725189919178</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>53</p>
<script type="math/tex; mode=display">
b_i = (a_i*x + r_i)^{-1} \quad(mod\;p)</script><p></p>
<ul>
<li>x  (2p - 1) 53</li>
<li>ar  (22**238) </li>
<li> a b</li>
</ul>
<p></p>
<p>1ar LLL</p>
<p>2</p>
<p><br></p>
<p></p>
<p>()</p>
<script type="math/tex; mode=display">
inverse(b,n) = inverse(b,p)\quad(mod\;p)</script><p></p>
<p>1<strong>bn</strong></p>
<script type="math/tex; mode=display">
(a_0*x + r_0) = inverse(b_0,p) \quad(mod\;p)</script><p>        </p>
<script type="math/tex; mode=display">
(a_0*x + r_0) = inverse(b_0,n) \quad(mod\;p)</script><p>        </p>
<script type="math/tex; mode=display">
(a_1*x + r_1) = inverse(b_1,n) \quad(mod\;p)</script><p>2<strong></strong></p>
<script type="math/tex; mode=display">
a_1*(a_0*x + r_0) = a_1*inverse(b_0,n) \quad(mod\;p)</script><script type="math/tex; mode=display">
a_0*(a_1*x + r_1) = a_0*inverse(b_1,n) \quad(mod\;p)</script><p>        </p>
<script type="math/tex; mode=display">
a_1*r_0 + a_0*r_1 = a_1*inverse(b_0,n) - a_0*inverse(b_1,n)\quad(mod\;p)</script><p>        </p>
<p>3<strong>AGCD</strong></p>
<p></p>
<script type="math/tex; mode=display">
a_1*inverse(b_0,n) - a_0*inverse(b_1,n) = k*p + a_1*r_0 + a_0*r_1</script><p>        AGCD</p>
<p>        AGCD</p>
<script type="math/tex; mode=display">
X = q*p + r</script><p>        </p>
<script type="math/tex; mode=display">
X = a_1*inverse(b_0,n) - a_0*inverse(b_1,n)</script><script type="math/tex; mode=display">
q = k,\quad
p = p,\quad
r = a_1*r_0 + a_0*r_1</script><p></p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">P_bits = <span class="number">512</span></span><br><span class="line">Q_bits = <span class="number">238</span>+<span class="number">1024</span>-<span class="number">512</span></span><br><span class="line">R_bits = <span class="number">238</span>+<span class="number">238</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">a = [<span class="number">226623173423524660762660587272926713775967113908071780918074044654746571</span>, <span class="number">99264763681859867816401881797921542580399607408617989905539839585323915</span>, <span class="number">177386736426181055874933306917112626356703658087900095566603898769091471</span>, <span class="number">5081587307910189127020749833744000992860852972311811125838243285877024</span>, <span class="number">411574110749659943703486080205654180795533263258790540505729307655142415</span>, <span class="number">1932137082695732276757073197845160804183868657578020568122170798605640</span>, <span class="number">103124563846054461729937757543103647655652920105466714505493351091607258</span>, <span class="number">65504504807895104765113845019342631211794998326986693051403166347389343</span>, <span class="number">151981136459515488882551190881724794060443302721456924436833810784219984</span>, <span class="number">3718222682937746804225225548712093487815785751144078132168082568580360</span>, <span class="number">113510621144631490440930342566441462111997352193075435129065142534001691</span>, <span class="number">120974784665251812036673794948678799274628176126865320042025545119228958</span>, <span class="number">193781634902416477262894357163294897773986019836290716577623654684669134</span>, <span class="number">24723078645443091017196603549741156206848230267873373213787667300835247</span>, <span class="number">113165730428784680251415263617027036564335843097634063978942541861726366</span>, <span class="number">407969345567975756778713582637075079783087682011802438819519567067241979</span>, <span class="number">151997755976755754648644424339697978791639952976423703068460739754839735</span>, <span class="number">253811682402531882908516509348937060650658679039884817907013090700281326</span>, <span class="number">404019046883201096048575369492824679211148242588135515488831100750933</span>, <span class="number">216725815105749574244056185735609680710954976727370948136589694286539150</span>, <span class="number">131605791470353972911656132280131756304373156215254629027113994962767833</span>, <span class="number">180190835657942894146705472335255090682179032409197893415067330574923084</span>, <span class="number">280086867488286721744184104208965143004904898002959657537412170401510680</span>, <span class="number">141039650035922882497777354937772530276454847300329950111476878397654053</span>, <span class="number">319858542602843767926919031049756704694256249776295683733693049522108872</span>, <span class="number">135633729043152514436339515687850041275739968837263316059461122379487161</span>, <span class="number">5038078437655552457504448170918674775639811066221990939957937239270167</span>, <span class="number">31918623105281221407484700216805581554894830335850729735403857505547002</span>, <span class="number">424092292941284354705774693468403308534554297314522980647422106907791591</span>, <span class="number">300635399575681097924575337707842439619576566621368558814406755486658723</span>, <span class="number">323686536134235835297820679361020300261642147835330856978902402517820801</span>, <span class="number">392620731408972775834827063986182511057173023783228673505487358356342114</span>, <span class="number">108681888409433100038410892044516773350200560613740266422720530715166828</span>, <span class="number">182338238967593331173372924666322484559869636981878410128856193538847678</span>, <span class="number">242630103099393630296862580986126439159331512930513337684897019399319621</span>, <span class="number">439737851682655515589311041364295341910822514202794661846391952824593066</span>, <span class="number">84115222835816390632388766236883091861894245716624041418721833768917547</span>, <span class="number">83926810016448863267608537461154878096011055852547156452557576634691363</span>, <span class="number">354588657997053098464002945990025178880458974438409486331146607111950617</span>, <span class="number">170413334241108032297843362994773587930354677207616527135896108692092457</span>, <span class="number">283185550452196010949673962093382632839937948488235076418296451706429923</span>, <span class="number">390000015988537819093964185756696910433784324036454283227484980367608884</span>, <span class="number">121370082693927496814267201484843687844578996855559797026014779421645731</span>, <span class="number">357164702199289826402900456464935203585119719343409406742172822868770420</span>, <span class="number">124276883926433089715798954125363260298740714164810098876501303684201565</span>, <span class="number">122912426324401068572433533096099229494021528981601203447594706478943744</span>, <span class="number">287527827124819650763642012585104162743364640051014410357971387706781531</span>, <span class="number">135819408760576908301747047938951002691288880199213610653148681326046091</span>, <span class="number">239644892459756283997004399339163555215985564639569406081575642996080481</span>, <span class="number">241513055132921096791997556818670497379598444881679976542299970876463098</span>, <span class="number">144152466563589166040797814966860917437020789050031353309848917297959088</span>, <span class="number">120162009732086541189519736083838746833770360960800721525565383293404918</span>, <span class="number">121547756201941339094205049920057111793191461762212554355070565584802804</span>]</span><br><span class="line">b = [<span class="number">6914108949558554967947157128371931777410399406424987472871265954007536210016000226325059466226417032321637768264366355381358552354005990800271210820573485</span>, <span class="number">4243350947524503250221141283676871054961767761533372535893799777316644277502608136805589201625364130457811586620275507258712882614289496389903620348266876</span>, <span class="number">7207723049065039433195103268720351560639394404931218738588797743896531445162073256971205066381805731964498662913612257697112297701515506572915529630749649</span>, <span class="number">9478867353430476119494189313998177997736272254097122188128236485373498544996365281925749885278741955783336542038044934310609039388320259421902808190444639</span>, <span class="number">10092751897940937230080778690510245631681516769761757712615337492357689455504789850857408988921202275660819814611602363226676960504340172006698418415173603</span>, <span class="number">5925826079655586275072881965974452367893696237983922405515651101142466142890347074549417916208251973477786424292583294611467079137685936757690986611634840</span>, <span class="number">2705681917429356111941316419951220642197423059675588735077708172236184161647753066851383893342803615318493417826483637576437939588768131347824859258545037</span>, <span class="number">5793481213766970753853702438948943122939283534830229656699291673833482520096412620329053619097899786691202045974184168665694248732396928571682405270896258</span>, <span class="number">3212965229314647637209688663583343281038324880827825190075824389072703574155472958687615046177029380089781167897141334668918512246004114927754397070032450</span>, <span class="number">507858897452123392345795058512546587866098555419275815786154069852495346820264502978622507708545904809967228104858456493411165322256241259977367791849042</span>, <span class="number">1910673108437857460691507244808588742883010826641687685721219894695257479961884688001651060796296482279750896861871054549713247272267814842634417960819168</span>, <span class="number">2886899741243848325873884252302617091514751717162909139186588257257958079130295099942906361136727891394692438504521454612873780003451672796809495226053047</span>, <span class="number">9475112027697464127079619380873273645977046666164164866182205134451664768516062572467782141714310693479352016031210905832129007401065693258638549100340615</span>, <span class="number">6500556077535313473248384729914564751019267303740919343852356539545383313100771434642240039386190890442297569489225045989569513367190888305128046797790102</span>, <span class="number">4352575880916080525863863641402979108455803235156616467981920947190189719209876636528864672410548581564537392488508689158499605332674737341258230577454475</span>, <span class="number">8855806560115120193748486720541724804359134126331550182497194629659837334220708039976726151383523965042432921330088347099157101222325916589506823343303429</span>, <span class="number">2774687136241363374520941544838376461935832170671324174983217598018541119488143069001573950404074015672792681188308412236177101695870429933915439814455887</span>, <span class="number">3592625154014227818614640279472091377202566130067513443394635609406915223429475106920133466069573358784994632708606215548054720669924050172507230811524716</span>, <span class="number">6955167231829680836198358545532458408492109230130585460528670650387346748536700767474985024643177587060440925065292948599577822789464670224006606550191671</span>, <span class="number">9194240450171813716718107852597217121362901491312541712415368806074976814988492806542250961496723482200369134039024809109124268301878344007510329535899615</span>, <span class="number">5950577443108124534632225089717156798651285826327691188035165834526053749015025923590404663092184546183617748745220821771671541995250149683517797527521402</span>, <span class="number">8147536282406177354958293970877926560729452459282692121940762677425779306283487924160782780299072205173184092679363257393333408904258459452274140791704067</span>, <span class="number">2559838851622656651952688025212080768394118716136473174419624432065878751831257138924556995347285973152404103332115858073203707432778426111325160735797721</span>, <span class="number">4949359541993387232537947394033362386729434824378846379892748514319807403496542405321037377319385099259508143211518009425440208974571177165892037150309091</span>, <span class="number">1811673815510905036234500180939767229691774807773077679609856974935852997557959138952513786288094951891092390620085630282790435640054840555430191851155313</span>, <span class="number">4777885082419038381870076531532991228660498200204585112220314790970263737966241042846160101892845251352987027168075888559622541458466624868511496707956221</span>, <span class="number">10238413710887745087366241938666680877364662925315040665408262063559110391570620624035047723405526398382375337996702653261521046541231508963525281969167278</span>, <span class="number">3473340971529025694371400010471019993671985537666177271712164477185774211271764180735799413043127038518985595844132844447764288680922052782557764949946998</span>, <span class="number">867350328105510555601266520733196439839458877892746826352327206388533426010006967907349245075237097927904721917883721235095421696529792601733014134854086</span>, <span class="number">2222551217354471458254572360148123193413834831993026644829243162796014361851880328878269533732240093458365703558737637137958860294765246560791514120259973</span>, <span class="number">11135205396103944017696365595462393888434601100415179875833418713405171505514194213145570969708606144837327906949671055964664374675657263466390592843391795</span>, <span class="number">8522093767526974938129274822063573020978729589640216089964237075835492415426711219243729120235033613444547687888110911207624759350428715822663409802746531</span>, <span class="number">618066223420558653541360712487038985426207412776033652080372792996567809564864490136174039188920973110051946250308952735815050129654446357610891600358247</span>, <span class="number">9409683398358516350960966400164689353665188916574105692687503875332913200043983566205433723664581043184720605266180639045542588369320481456882129188045630</span>, <span class="number">10444912184036485133367095187175276878779180732948191228469107836744786278456394810069942330852023901190983084405589604802372025661121698806608507168815980</span>, <span class="number">5576808818750933483753823503921696491223987341840901931564632327098735945058071342467846031030536056935288275893098409520502499556978787294107531192342888</span>, <span class="number">11386170831130547392066338523237385342399839863674855226178213470159061980868639851406716227763244070078162813390834461297132500087558187715637626334931068</span>, <span class="number">9266567474732845229716988973436914937598698459994255583719094874193822181675544832905800318876640152861212158602258489908050910803591150200525814954449464</span>, <span class="number">783592057196685768383414375510915255040313296240508052297125547577301394194342174502254618660494179262947294784116190346971775913769035176336764690986707</span>, <span class="number">9105502180406569116340185218615179260760299848734930041602247299415927012355894700609320722623370139135122342263713846033304524885782445949914570572453737</span>, <span class="number">2297513067567074587355421795953863750627166311403426281361312466297059134183355298180726594771668216966732975569375780641995446201527865824229865021970151</span>, <span class="number">11188600115372846854366137972585164923834717935898376598627276542371780275188751807941476083838808640337088079259756154889298297211898790479562768420072518</span>, <span class="number">9656534484640562909118084019762167873291009773232637365213178341424207965285682074941363264934464618450896824843786922345950140473512635227211478685645772</span>, <span class="number">9343461413426168572561103655466265435717795505657355206522619014228487030194629865342342831380623629471381377128476731390629039248389925891691539701146309</span>, <span class="number">8681682631345831952913045584970984843073645909076987924890403622460027832467542651987623584349089629585531159664847835287269602153108548311564650707486153</span>, <span class="number">2656022193773767486949157049738671449721427276944394094199310567891807831351152318018854466905531462256724938253289337125816757790150607033652302227218868</span>, <span class="number">8508384570273623974802293014504152838556567399448174508834295467479347400327605230626491770497722014885725768213847610504091563629074470937893415637338996</span>, <span class="number">9716708016762837073052660164394053927821481998442639097920157163041635386583167412600530638659299593644342722890385260143682043966383262553995449944733956</span>, <span class="number">10231440381205182517403356785692369093270060843919065205063057623835967990844569366866607452179015606536153761832574542432676397053147658371344410148994418</span>, <span class="number">5146017765041682548648007957706007143803297597587388958721578537741505373387718545092695689770641249769257901519197825087801304735466239843061128683798476</span>, <span class="number">5222787643951107881679620487297380490422971146509273142662864657570322385794688143091615970726544447887548792995773377472568754141261595697499826832283200</span>, <span class="number">10464709627510729920064247596403868144579001206027850090117534773353171042729174225448975480540265139445689560336303762183734720331072177316589830221880977</span>, <span class="number">8615548684371129329547908465444932886632829509038689025840147771114904826804441395348568994340729561487767929565347408386252378372026787346043297419998538</span>]</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">97853623351997296064353255135588846396569970130207954701198599507389250544514082114957455795330569730103385876268186267851194017938003005329258612122178955978821786063623918361705120943030241043571056282806763102278839262572943852578441568495106906583558313075633340995336324665255745279078992160547871869557</span></span><br><span class="line">c = <span class="number">44431449479567561261917922338101462065458737366369232901780150553091038211618354850829522817943842817713545313017593484450672219262670055539455602698182643653128488160901383204333856589371756831501857423631322915113418699087489759910739942878900174507138454184974875778861767989603951090385047953725189919178</span></span><br><span class="line"></span><br><span class="line">N = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">51</span>):</span><br><span class="line">    N.append(a[i+<span class="number">1</span>]*inverse(b[i],n) - a[i]*inverse(b[i+<span class="number">1</span>],n))</span><br><span class="line">X = <span class="number">2</span>**R_bits</span><br><span class="line">m = <span class="built_in">len</span>(N)</span><br><span class="line"></span><br><span class="line">PR = PolynomialRing(ZZ, names=[<span class="built_in">str</span>(<span class="string">&#x27;x%d&#x27;</span> % i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1</span> + m)])</span><br><span class="line"></span><br><span class="line">h = <span class="number">3</span></span><br><span class="line">u = <span class="number">1</span></span><br><span class="line">variables = PR.gens()</span><br><span class="line"></span><br><span class="line">gg = []</span><br><span class="line">monomials = [variables[<span class="number">0</span>]**<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    gg.append(N[i] - variables[i])</span><br><span class="line">    monomials.append(variables[i])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(monomials), <span class="built_in">len</span>(gg))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;monomials:&#x27;</span>, monomials)</span><br><span class="line"></span><br><span class="line">B = Matrix(ZZ, <span class="built_in">len</span>(gg), <span class="built_in">len</span>(monomials))</span><br><span class="line"><span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(gg)):</span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(monomials)):</span><br><span class="line">        <span class="keyword">if</span> monomials[jj] <span class="keyword">in</span> gg[ii].monomials():</span><br><span class="line">            B[ii, jj] = gg[ii].monomial_coefficient(monomials[jj]) * monomials[jj]([X] * m)</span><br><span class="line"></span><br><span class="line">B = B.LLL()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-&#x27;</span> * <span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">new_pol = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(gg)):</span><br><span class="line">    tmp_pol = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(monomials)):</span><br><span class="line">        tmp_pol += monomials[j](variables) * B[i, j] / monomials[j]([X] * m)</span><br><span class="line">    new_pol.append(tmp_pol)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(new_pol) &gt; <span class="number">0</span>:</span><br><span class="line">    Ideal = ideal(new_pol[:m-<span class="number">1</span>])</span><br><span class="line">    GB = Ideal.groebner_basis()</span><br><span class="line">    function_variables = var([<span class="built_in">str</span>(<span class="string">&#x27;y%d&#x27;</span> % i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1</span> + m)])</span><br><span class="line">    res = solve([pol(function_variables) <span class="keyword">for</span> pol <span class="keyword">in</span> GB], function_variables)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;got %d basis&#x27;</span> % <span class="built_in">len</span>(GB))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;solved result:&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br><span class="line">    PRRR.&lt; x, y&gt; = PolynomialRing(QQ)</span><br><span class="line">    q = <span class="built_in">abs</span>(PRRR(res[<span class="number">0</span>][<span class="number">0</span>](x, y)).coefficients()[<span class="number">0</span>].denominator())</span><br><span class="line">    p = N[-<span class="number">1</span>] // q</span><br><span class="line"></span><br><span class="line">p = <span class="built_in">abs</span>(<span class="built_in">int</span>(p))</span><br><span class="line">q = n//p</span><br><span class="line">d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<p><strong>flag{755f85c2723bb39381c7379a604160d8}</strong></p>
<p><br></p>
<p><br></p>
]]></content>
      <categories>
        <category>crypto</category>
      </categories>
  </entry>
  <entry>
    <title>Crypto-RSA</title>
    <url>/post/ea445335.html</url>
    <content><![CDATA[<p>RSA</p>
<span id="more"></span>
<h3 id="RSA3"><a href="#RSA3" class="headerlink" title="RSA3"></a>RSA3</h3><p>2023</p>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p1, q1 = getPrime(<span class="number">512</span>), getPrime(<span class="number">512</span>)</span><br><span class="line">n1 = p1*q1</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">p2, q2 = getPrime(<span class="number">512</span>), getPrime(<span class="number">512</span>)</span><br><span class="line">n2 = p2*q2</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n1 = <span class="subst">&#123;n1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n2 = <span class="subst">&#123;n2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c1 = <span class="subst">&#123;<span class="built_in">pow</span>(m,e,n2)&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c2 = <span class="subst">&#123;<span class="built_in">pow</span>(n1-m,e,n2)&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n1 = 52579135273678950581073020233998071974221658902576724000130040488018033110534210901239397446395736563148970863970460542205225993317478251099451639165369081820130823165642873594136020122857712288395352930384057524510346112486008850200845915783772351449146183974239444691330777565342525218070680067550270554767</span></span><br><span class="line"><span class="comment"># n2 = 68210568831848267339414957973218186686176324296418282565773310695862151827108036984694027795077376921170907068110296451176263520249799154781062517066423984526868547296781709439425857993705489037768605485740968600877866332458671029054092942851472208033494968784822459369206497698469167909174346042658361616469</span></span><br><span class="line"><span class="comment"># c1 = 42941712708129054668823891960764339394032538100909746015733801598044118605733969558717842106784388091495719003761324737091667431446354282990525549196642753967283958283202592037329821712755519455155110675327321252333824912095517427885925854391047828862338332559137577789387455868761466777370476884779752953853</span></span><br><span class="line"><span class="comment"># c2 = 62704043252861638895370674827559804184650708692227789532879941590038911799857232898692335429773480889624046167792573885125945511356456073688435911975161053231589019934427151230924004944847291434167067905803180207183209888082275583120633408232749119300200555327883719466349164062163459300518993952046873724005</span></span><br></pre></td></tr></table></figure>
<p>gcd</p>
<p>egcd(30-40)Half-gcd</p>
<p><a href="https://www.cnblogs.com/whx1003/p/16217087.html"> gcd Half-GCD  - whx1003 -  (cnblogs.com)</a></p>
<p>exp.ipynb:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">HGCD</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="number">2</span> * b.degree() &lt;= a.degree() <span class="keyword">or</span> a.degree() == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    m = a.degree() // <span class="number">2</span></span><br><span class="line">    a_top, a_bot = a.quo_rem(x^m)</span><br><span class="line">    b_top, b_bot = b.quo_rem(x^m)</span><br><span class="line">    R00, R01, R10, R11 = HGCD(a_top, b_top)</span><br><span class="line">    c = R00 * a + R01 * b</span><br><span class="line">    d = R10 * a + R11 * b</span><br><span class="line">    q, e = c.quo_rem(d)</span><br><span class="line">    d_top, d_bot = d.quo_rem(x^(m // <span class="number">2</span>))</span><br><span class="line">    e_top, e_bot = e.quo_rem(x^(m // <span class="number">2</span>))</span><br><span class="line">    S00, S01, S10, S11 = HGCD(d_top, e_top)</span><br><span class="line">    RET00 = S01 * R00 + (S00 - q * S01) * R10</span><br><span class="line">    RET01 = S01 * R01 + (S00 - q * S01) * R11</span><br><span class="line">    RET10 = S11 * R00 + (S10 - q * S11) * R10</span><br><span class="line">    RET11 = S11 * R01 + (S10 - q * S11) * R11</span><br><span class="line">    <span class="keyword">return</span> RET00, RET01, RET10, RET11</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GCD</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="built_in">print</span>(a.degree(), b.degree())</span><br><span class="line">    q, r = a.quo_rem(b)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line">    R00, R01, R10, R11 = HGCD(a, b)</span><br><span class="line">    c = R00 * a + R01 * b</span><br><span class="line">    d = R10 * a + R11 * b</span><br><span class="line">    <span class="keyword">if</span> d == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> c.monic()</span><br><span class="line">    q, r = c.quo_rem(d)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> d</span><br><span class="line">    <span class="keyword">return</span> GCD(d, r)</span><br><span class="line"></span><br><span class="line">sys.setrecursionlimit(<span class="number">500000</span>)</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n1 = <span class="number">52579135273678950581073020233998071974221658902576724000130040488018033110534210901239397446395736563148970863970460542205225993317478251099451639165369081820130823165642873594136020122857712288395352930384057524510346112486008850200845915783772351449146183974239444691330777565342525218070680067550270554767</span></span><br><span class="line">n2 = <span class="number">68210568831848267339414957973218186686176324296418282565773310695862151827108036984694027795077376921170907068110296451176263520249799154781062517066423984526868547296781709439425857993705489037768605485740968600877866332458671029054092942851472208033494968784822459369206497698469167909174346042658361616469</span></span><br><span class="line">c1 = <span class="number">42941712708129054668823891960764339394032538100909746015733801598044118605733969558717842106784388091495719003761324737091667431446354282990525549196642753967283958283202592037329821712755519455155110675327321252333824912095517427885925854391047828862338332559137577789387455868761466777370476884779752953853</span></span><br><span class="line">c2 = <span class="number">62704043252861638895370674827559804184650708692227789532879941590038911799857232898692335429773480889624046167792573885125945511356456073688435911975161053231589019934427151230924004944847291434167067905803180207183209888082275583120633408232749119300200555327883719466349164062163459300518993952046873724005</span></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n2))</span><br><span class="line">f = x^e - c1</span><br><span class="line">g = (n1 - x)^e - c2</span><br><span class="line"></span><br><span class="line">res = GCD(f,g)</span><br><span class="line"></span><br><span class="line">m = -res.monic().coefficients()[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line">flag = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<p><strong>CnHongKe{Fr4nkl1n_R31ter_4nd_gcD}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="BUAA-AITMCLAB-amp-Level4"><a href="#BUAA-AITMCLAB-amp-Level4" class="headerlink" title="BUAA^AITMCLAB&amp;Level4"></a>BUAA^AITMCLAB&amp;Level4</h3><p>BUAA^AITMCLAB</p>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nextprime</span>(<span class="params">n</span>):</span><br><span class="line">    n = (n + <span class="number">1</span>) | <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> isPrime(n):</span><br><span class="line">        n += <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;********************&quot;</span></span><br><span class="line"></span><br><span class="line">m = s2n(flag)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">The getPrime() may not function properly, </span></span><br><span class="line"><span class="string">but it does not affect your understanding of the problem.</span></span><br><span class="line"><span class="string">lzh hopes you could attack successfully!</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        p = getPrime(<span class="number">512</span>)</span><br><span class="line">        q = nextprime(p + randint(<span class="number">0</span>, <span class="number">2</span> ** <span class="number">421</span>))</span><br><span class="line">        n = p * q</span><br><span class="line">        phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">        d = randint(<span class="number">0</span>, n ** <span class="number">0.32</span>)</span><br><span class="line">        e = invmod(d, phi)</span><br><span class="line">        c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e = %d&quot;</span> % e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n = %d&quot;</span> % n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c = %d&quot;</span> % c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">e = 127036799282947905048902487711584293137462029654908427023257952239618526367628289911517200900560275901894224980635962598874227610508820071266987288647014766036842887978917984803634331617282487399497533040203094883612898714070428079645997317171821336677275458853187399657424389496685642081231802149635762872559</span></span><br><span class="line"><span class="string">n = 132088710602356228013302555046538954329350662026107113731378784700414952971644185280357218688811203701759378494801162526951176546636432770036424692378302192072727185223575484138108758895692654294532714346938723454356449079919300753046965831240595578485766587254369907195552714255698916905317581605325719354369</span></span><br><span class="line"><span class="string">c = 37469551975972446825344827206550506280313465311789923639857075387733761352303008843234906464758618751401773666419762541561815375332688727694620079867717788238335220300725633402928195673814423768862538733435901134624477748268790427128392777900896313025911483334568923415572174037203375831796896263863229112204</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># try to find the flag</span></span><br><span class="line"><span class="comment"># and don&#x27;t forget to submit it to the platform</span></span><br></pre></td></tr></table></figure>
<p></p>
<ul>
<li>pq</li>
<li>dn^0.32</li>
</ul>
<p>dwiener attackboneh and durfee attack</p>
<ul>
<li>wiener attackd$ \frac{1}{3}n^{\frac{1}{4}}$</li>
<li>boneh and durfee attackdn^0.292</li>
</ul>
<p>0.32boneh and durfee attack1/8(d(0,n^0.32)1/8(0,n^0.29))</p>
<p>pqdXenny</p>
<p><a href="http://ijns.jalaxy.com.tw/contents/ijns-v14-n2/ijns-2012-v14-n2-p80-85.pdf">http://ijns.jalaxy.com.tw/contents/ijns-v14-n2/ijns-2012-v14-n2-p80-85.pdf</a></p>
<p></p>
<p><img src="/post/ea445335/image-20231001174839341.png" alt="image-20231001174839341"></p>
<p><img src="/post/ea445335/image-20231001174939785.png" alt="image-20231001174939785"></p>
<p>pq$\frac{e}{n-2\sqrt{n}+1}$  $\frac{k}{d}$ wiener attackd</p>
<p>wiener attack n  $n-2\sqrt{n}+1$ </p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">127036799282947905048902487711584293137462029654908427023257952239618526367628289911517200900560275901894224980635962598874227610508820071266987288647014766036842887978917984803634331617282487399497533040203094883612898714070428079645997317171821336677275458853187399657424389496685642081231802149635762872559</span></span><br><span class="line">n = <span class="number">132088710602356228013302555046538954329350662026107113731378784700414952971644185280357218688811203701759378494801162526951176546636432770036424692378302192072727185223575484138108758895692654294532714346938723454356449079919300753046965831240595578485766587254369907195552714255698916905317581605325719354369</span></span><br><span class="line">c = <span class="number">37469551975972446825344827206550506280313465311789923639857075387733761352303008843234906464758618751401773666419762541561815375332688727694620079867717788238335220300725633402928195673814423768862538733435901134624477748268790427128392777900896313025911483334568923415572174037203375831796896263863229112204</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ContinuedFraction</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, numerator, denumerator</span>):</span><br><span class="line">        self.numberlist = []  <span class="comment"># number in continued fraction</span></span><br><span class="line">        self.fractionlist = []  <span class="comment"># the near fraction list</span></span><br><span class="line">        self.GenerateNumberList(numerator, denumerator)</span><br><span class="line">        self.GenerateFractionList()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">GenerateNumberList</span>(<span class="params">self, numerator, denumerator</span>):</span><br><span class="line">        <span class="keyword">while</span> numerator != <span class="number">1</span>:</span><br><span class="line">            quotient = numerator // denumerator</span><br><span class="line">            remainder = numerator % denumerator</span><br><span class="line">            self.numberlist.append(quotient)</span><br><span class="line">            numerator = denumerator</span><br><span class="line">            denumerator = remainder</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">GenerateFractionList</span>(<span class="params">self</span>):</span><br><span class="line">        self.fractionlist.append([self.numberlist[<span class="number">0</span>], <span class="number">1</span>])</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(self.numberlist)):</span><br><span class="line">            numerator = self.numberlist[i]</span><br><span class="line">            denumerator = <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i):</span><br><span class="line">                temp = numerator</span><br><span class="line">                numerator = denumerator + numerator * self.numberlist[i - j - <span class="number">1</span>]</span><br><span class="line">                denumerator = temp</span><br><span class="line">            self.fractionlist.append([numerator, denumerator])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = ContinuedFraction(e, n-<span class="number">2</span>*iroot(n,<span class="number">2</span>)[<span class="number">0</span>]+<span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> k, d <span class="keyword">in</span> a.fractionlist:</span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">    flag = long_to_bytes(m)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;aitmc&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<p><strong>aitmc{W0Oo!!Y0u_3re_a_m3ster_of_W1ener_H3ck!!}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="AITMCLAB-quiz2"><a href="#AITMCLAB-quiz2" class="headerlink" title="AITMCLAB quiz2"></a>AITMCLAB quiz2</h3><p>AITMCLAB</p>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Welcome to quiz2!!!</span></span><br><span class="line"><span class="keyword">from</span> AITMCLab.libnum <span class="keyword">import</span> s2n</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> isPrime</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line">p = <span class="number">104879397075344024438671231239628115011303349344697797964879592144922079000957</span> </span><br><span class="line">q = <span class="number">104879397075344024438671231239628115011303349344697797964879592144922079001013</span></span><br><span class="line"><span class="keyword">assert</span> isPrime(p) <span class="keyword">and</span> isPrime(q)</span><br><span class="line">n = p * q</span><br><span class="line">flag = s2n(<span class="string">&#x27;flag&#123;************&#125;&#x27;</span>)</span><br><span class="line">r = randint(<span class="number">1</span>, n)</span><br><span class="line">c = (<span class="built_in">pow</span>(n + <span class="number">1</span>, flag, n * n) * <span class="built_in">pow</span>(r, n, n * n)) % (n * n)</span><br><span class="line"><span class="built_in">print</span> (c)</span><br><span class="line"><span class="comment"># 13134489820394613222282607681686272081419875146946401883172682167011759113388373349180457979897848113275982219264879081189886853062717764580364698888338032141434053832247476010400449272010082460437747190468766740274587999336359171283098137261396013153130265440425676242061845667887640808895666325466803989428</span></span><br></pre></td></tr></table></figure>
<p>pq</p>
<p></p>
<script type="math/tex; mode=display">
c\equiv (n+1)^{flag}*r^n\quad(mod\;n^2)</script><p>r</p>
<p> $ n^2$ $ (n+1)^{flag}$ </p>
<script type="math/tex; mode=display">
(n+1)^{flag} \equiv n*flag+1\quad(mod\;n^2)</script><p> $ c\equiv (n<em>flag+1)</em>r^n\quad(mod\;n^2)$ </p>
<p>r  r  RSA </p>
<p></p>
<script type="math/tex; mode=display">
\phi(n^2) = \phi(p^2q^2) = \phi(p^2)\phi(q^2) = pq(p-1)(q-1)</script><p> </p>
<script type="math/tex; mode=display">
c^{(p-1)(q-1)} \equiv ((n*flag+1)*r^n)^{(p-1)(q-1)} \quad(mod\;n^2)</script><p> </p>
<script type="math/tex; mode=display">
c^{(p-1)(q-1)} \equiv (n*flag+1)^{(p-1)(q-1)}*r^{n(p-1)(q-1)} \quad(mod\;n^2)</script><p></p>
<script type="math/tex; mode=display">
r^{n(p-1)(q-1)}\equiv r^{\phi(n^2)}\equiv 1\quad(mod\;n^2)</script><p> r</p>
<script type="math/tex; mode=display">
c^{(p-1)(q-1)} \equiv (n*flag+1)^{(p-1)(q-1)} \quad(mod\;n^2)</script><p></p>
<script type="math/tex; mode=display">
(n*flag+1)^{(p-1)(q-1)}\equiv (p-1)(q-1)n*flag+1 \quad(mod\;n^2)</script><p></p>
<script type="math/tex; mode=display">
c^{(p-1)(q-1)}\equiv (p-1)(q-1)n*flag+1 \quad(mod\;n^2)</script><p>n(p-1)(q-1)n^2 n^2  flag flag  n flag</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">104879397075344024438671231239628115011303349344697797964879592144922079000957</span> </span><br><span class="line">q = <span class="number">104879397075344024438671231239628115011303349344697797964879592144922079001013</span></span><br><span class="line">n = p * q</span><br><span class="line">c = <span class="number">13134489820394613222282607681686272081419875146946401883172682167011759113388373349180457979897848113275982219264879081189886853062717764580364698888338032141434053832247476010400449272010082460437747190468766740274587999336359171283098137261396013153130265440425676242061845667887640808895666325466803989428</span></span><br><span class="line"></span><br><span class="line">m = (<span class="built_in">pow</span>(c,(p-<span class="number">1</span>)*(q-<span class="number">1</span>),n**<span class="number">2</span>) - <span class="number">1</span>) // n * inverse((p-<span class="number">1</span>)*(q-<span class="number">1</span>),n**<span class="number">2</span>) % n</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flag</p>
<p><strong>flag{can_you_find_me??}</strong></p>
<p><br></p>
<p><br></p>
]]></content>
      <categories>
        <category>crypto</category>
      </categories>
  </entry>
  <entry>
    <title>Crypto-</title>
    <url>/post/342113ee.html</url>
    <content><![CDATA[<p></p>
<span id="more"></span>
<h3 id=""><a href="#" class="headerlink" title=""></a></h3><p></p>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">256</span>)</span><br><span class="line">q = getPrime(<span class="number">256</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">_q = <span class="built_in">int</span>(<span class="built_in">bin</span>(q)[<span class="number">2</span>:][::-<span class="number">1</span>] , <span class="number">2</span>)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(p ^ _q)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">47761879279815109356923025519387920397647575481870870315845640832106405230526</span></span><br><span class="line"><span class="string">10310021142875344535823132048350287610122830618624222175188882916320750885684668357543070611134424902255744858233485983896082731376191044874283981089774677</span></span><br><span class="line"><span class="string">999963120986258459742830847940927620860107164857685447047839375819380831715400110131705491405902374029088041611909274341590559275004502111124764419485191</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><strong></strong></p>
<ul>
<li>p  q 256bitpxorq</li>
</ul>
<p><strong></strong></p>
<ul>
<li><p></p>
</li>
<li><p> pxorq bitpxorq pqpxorq pq ()</p>
</li>
<li>1p1q0p0q1</li>
</ul>
<p><strong></strong></p>
<ul>
<li>pq0n</li>
<li>pq1n</li>
<li>pq  k  k  n  k </li>
</ul>
<p></p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.setrecursionlimit(<span class="number">1500</span>)</span><br><span class="line"></span><br><span class="line">pxorq = <span class="number">47761879279815109356923025519387920397647575481870870315845640832106405230526</span></span><br><span class="line">n = <span class="number">10310021142875344535823132048350287610122830618624222175188882916320750885684668357543070611134424902255744858233485983896082731376191044874283981089774677</span></span><br><span class="line">c = <span class="number">999963120986258459742830847940927620860107164857685447047839375819380831715400110131705491405902374029088041611909274341590559275004502111124764419485191</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">pxorq = <span class="built_in">str</span>(<span class="built_in">bin</span>(pxorq)[<span class="number">2</span>:]).zfill(<span class="number">256</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find</span>(<span class="params">ph,qh,pl,ql</span>):</span><br><span class="line">    l = <span class="built_in">len</span>(ph)</span><br><span class="line">    tmp0 = ph + (<span class="number">256</span>-<span class="number">2</span>*l)*<span class="string">&quot;0&quot;</span> + pl</span><br><span class="line">    tmp1 = ph + (<span class="number">256</span>-<span class="number">2</span>*l)*<span class="string">&quot;1&quot;</span> + pl</span><br><span class="line">    tmq0 = qh + (<span class="number">256</span>-<span class="number">2</span>*l)*<span class="string">&quot;0&quot;</span> + ql</span><br><span class="line">    tmq1 = qh + (<span class="number">256</span>-<span class="number">2</span>*l)*<span class="string">&quot;1&quot;</span> + ql</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">int</span>(tmp0,<span class="number">2</span>)*<span class="built_in">int</span>(tmq0,<span class="number">2</span>) &gt; n):</span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">int</span>(tmp1,<span class="number">2</span>)*<span class="built_in">int</span>(tmq1,<span class="number">2</span>) &lt; n):</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">int</span>(pl,<span class="number">2</span>)*<span class="built_in">int</span>(ql,<span class="number">2</span>) % (<span class="number">2</span>**(l-<span class="number">1</span>)) != n % (<span class="number">2</span>**(l-<span class="number">1</span>))):</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(l == <span class="number">128</span>):</span><br><span class="line">        pp0 = <span class="built_in">int</span>(tmp0,<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span>(n % pp0 == <span class="number">0</span>):</span><br><span class="line">            pf = pp0</span><br><span class="line">            qf = n//pp0</span><br><span class="line">            phi = (pf-<span class="number">1</span>)*(qf-<span class="number">1</span>)</span><br><span class="line">            d = inverse(e,phi)</span><br><span class="line">            m1 = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(m1))</span><br><span class="line">            exit()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span>(pxorq[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> pxorq[<span class="number">255</span>-l] == <span class="string">&quot;1&quot;</span>):</span><br><span class="line">            find(ph+<span class="string">&quot;1&quot;</span>,qh+<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>+pl,<span class="string">&quot;0&quot;</span>+ql)</span><br><span class="line">            find(ph+<span class="string">&quot;0&quot;</span>,qh+<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>+pl,<span class="string">&quot;1&quot;</span>+ql)</span><br><span class="line">            find(ph+<span class="string">&quot;1&quot;</span>,qh+<span class="string">&quot;1&quot;</span>,<span class="string">&quot;0&quot;</span>+pl,<span class="string">&quot;0&quot;</span>+ql)</span><br><span class="line">            find(ph+<span class="string">&quot;0&quot;</span>,qh+<span class="string">&quot;1&quot;</span>,<span class="string">&quot;0&quot;</span>+pl,<span class="string">&quot;1&quot;</span>+ql)</span><br><span class="line">        <span class="keyword">elif</span>(pxorq[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> pxorq[<span class="number">255</span>-l] == <span class="string">&quot;0&quot;</span>):</span><br><span class="line">            find(ph+<span class="string">&quot;1&quot;</span>,qh+<span class="string">&quot;0&quot;</span>,<span class="string">&quot;0&quot;</span>+pl,<span class="string">&quot;0&quot;</span>+ql)</span><br><span class="line">            find(ph+<span class="string">&quot;0&quot;</span>,qh+<span class="string">&quot;0&quot;</span>,<span class="string">&quot;0&quot;</span>+pl,<span class="string">&quot;1&quot;</span>+ql)</span><br><span class="line">            find(ph+<span class="string">&quot;1&quot;</span>,qh+<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>+pl,<span class="string">&quot;0&quot;</span>+ql)</span><br><span class="line">            find(ph+<span class="string">&quot;0&quot;</span>,qh+<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>+pl,<span class="string">&quot;1&quot;</span>+ql)</span><br><span class="line">        <span class="keyword">elif</span>(pxorq[l] == <span class="string">&quot;0&quot;</span> <span class="keyword">and</span> pxorq[<span class="number">255</span>-l] == <span class="string">&quot;1&quot;</span>):</span><br><span class="line">            find(ph+<span class="string">&quot;0&quot;</span>,qh+<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>+pl,<span class="string">&quot;0&quot;</span>+ql)</span><br><span class="line">            find(ph+<span class="string">&quot;0&quot;</span>,qh+<span class="string">&quot;1&quot;</span>,<span class="string">&quot;0&quot;</span>+pl,<span class="string">&quot;0&quot;</span>+ql)</span><br><span class="line">            find(ph+<span class="string">&quot;1&quot;</span>,qh+<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>+pl,<span class="string">&quot;1&quot;</span>+ql)</span><br><span class="line">            find(ph+<span class="string">&quot;1&quot;</span>,qh+<span class="string">&quot;1&quot;</span>,<span class="string">&quot;0&quot;</span>+pl,<span class="string">&quot;1&quot;</span>+ql)</span><br><span class="line">        <span class="keyword">elif</span>(pxorq[l] == <span class="string">&quot;0&quot;</span> <span class="keyword">and</span> pxorq[<span class="number">255</span>-l] == <span class="string">&quot;0&quot;</span>):</span><br><span class="line">            find(ph+<span class="string">&quot;0&quot;</span>,qh+<span class="string">&quot;0&quot;</span>,<span class="string">&quot;0&quot;</span>+pl,<span class="string">&quot;0&quot;</span>+ql)</span><br><span class="line">            find(ph+<span class="string">&quot;1&quot;</span>,qh+<span class="string">&quot;0&quot;</span>,<span class="string">&quot;0&quot;</span>+pl,<span class="string">&quot;1&quot;</span>+ql)</span><br><span class="line">            find(ph+<span class="string">&quot;0&quot;</span>,qh+<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>+pl,<span class="string">&quot;0&quot;</span>+ql)</span><br><span class="line">            find(ph+<span class="string">&quot;1&quot;</span>,qh+<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>+pl,<span class="string">&quot;1&quot;</span>+ql)</span><br><span class="line"></span><br><span class="line">find(<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<p><strong>flag{f55a2740-c15d-af88-1815-a1b4aab19ccf}</strong></p>
<p><br></p>
<p><br></p>
<h3 id=""><a href="#" class="headerlink" title=""></a></h3><p></p>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p1 = sympy.randprime(<span class="number">2</span> ** <span class="number">1023</span>,<span class="number">2</span> ** <span class="number">1024</span>)</span><br><span class="line">q1 = sympy.randprime(<span class="number">2</span> ** <span class="number">1023</span>,<span class="number">2</span> ** <span class="number">1024</span>)</span><br><span class="line">a1 = p1 ^ q1</span><br><span class="line">b1 = p1 * q1</span><br><span class="line">c1 = <span class="built_in">pow</span>(bytes_to_long(flag[:<span class="number">19</span>]),e,p1*q1)</span><br><span class="line">p2 = sympy.randprime(<span class="number">2</span> ** <span class="number">511</span>, <span class="number">2</span> ** <span class="number">512</span>)</span><br><span class="line">q2 = sympy.randprime(<span class="number">2</span> ** <span class="number">511</span>, <span class="number">2</span> ** <span class="number">512</span>)</span><br><span class="line">a2 = (p2 * q2) ^ (p2 + q2)</span><br><span class="line">b2 = (p2 * q2) ^ (p2 - q2)</span><br><span class="line">c2 = <span class="built_in">pow</span>(bytes_to_long(flag[<span class="number">19</span>:]),e,p2*q2)</span><br><span class="line">f= <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(a1)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(b1)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(c1)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(a2)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(b2)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(c2)+<span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>txt</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a1=<span class="number">67739512154277162085770157687437441198363095490607019903179640765859289435128844487312739643781929328039885340492248268381181927215444058044731882600621443249379470235583032722854561171610662253187419453432598163528304052508578209017561499836803166110456130462444164049945234353225230736363194196935115979960</span></span><br><span class="line">b1=<span class="number">17185396829856546439605443867156437815015135756541052637907770783830686534153389303291740769607944691156059669175157827203495395745826694347428694508457493991041224390283763876476601200114028282946724348906485066220181559142937065978299071246507281834301352443856315199896106182934770582627129779923357891915723961923663378398066801894395956482176730300442901078199030200112352639266103862753546370851947797706641058966862813099369195689336228579744994641830699890792017097474275824545664085264972274642572927392940910981115837831275773192989084712813373293435228956787629490757407431010258942490818726318175944867633</span></span><br><span class="line">c1=<span class="number">2180773316568266715369209198734610509148388893757598741330158376506447322216176787253641696053169188685408469718202047474660716095850135317790263924418449270019680259700945680062960717565507426032265137192689118286560945331123730529355709043463330231284484658907466172538703301303440062783852136344472063837313195697915205569416630439851250171277336484771753816776835527532090668694986220968152676688392975798850738947165707984817923309381811015047150056144403783079156300625762879231698942313672034730244627530962258121618021680413439757194393609777357848156392150372631861473658135778661768208071991812674187273360</span></span><br><span class="line">a2=<span class="number">102834527596695950719979111423985349726489864165244791755647652205679952999516919199218636781810880771255724153293007819995198831162629014290926266777774940370836206596205967641213842702547665263659933022253549718321445029287279257463914991950587622466780705329578580061019164231870445205566240956950369224751</span></span><br><span class="line">b2=<span class="number">102834527596695950719979111423985349726489864165244791755647652205679952999516919199218636781810880771255724153293007819995198831162629014290926266777774949520538413350277489291427420271328741830415622921056457371226207219443304838109001023043838810016379140438034881290332449739051404396455209891630254998985</span></span><br><span class="line">c2=<span class="number">46285230821397377383998198689981002335902850753318921384068480704506522918467396194184971163720421808774010121239873784436865080818119851642074388303787396280596526597467664310187113430990219486840906481260493087443528880139543560763852844535689852804877233056126591516506599561944164619603448246607830867682</span></span><br></pre></td></tr></table></figure>
<p></p>
<h4 id=""><a href="#" class="headerlink" title=""></a></h4><p><strong></strong></p>
<ul>
<li>p1  q1 1024bita1</li>
</ul>
<p><strong></strong></p>
<ul>
<li><p></p>
</li>
<li><p> a1 </p>
</li>
<li> a1 1p1q0p0q1</li>
</ul>
<p><strong></strong></p>
<ul>
<li>p1q10n</li>
<li>p1q11n</li>
<li>p1 &gt; q1p1q1</li>
</ul>
<h4 id=""><a href="#" class="headerlink" title=""></a></h4><p><strong></strong></p>
<ul>
<li>(p2 * q2)(p2 + q2)a2</li>
<li>(p2 * q2)(p2 - q2)b2</li>
</ul>
<p><strong></strong></p>
<ul>
<li><p></p>
</li>
<li><p> a2b2 </p>
</li>
<li>00011011</li>
</ul>
<p><strong></strong></p>
<ul>
<li> k </li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">t1 = (<span class="built_in">int</span>(p,<span class="number">2</span>)*<span class="built_in">int</span>(q,<span class="number">2</span>))</span><br><span class="line">t2 = (<span class="built_in">int</span>(p,<span class="number">2</span>)+<span class="built_in">int</span>(q,<span class="number">2</span>))</span><br><span class="line">t3 = (<span class="built_in">int</span>(p,<span class="number">2</span>)-<span class="built_in">int</span>(q,<span class="number">2</span>))</span><br><span class="line">mask = <span class="number">2</span>**k-<span class="number">1</span></span><br><span class="line"></span><br><span class="line">((t1^t2)&amp;mask) == (a2&amp;mask) <span class="keyword">and</span> ((t1^t3)&amp;mask) == (b2&amp;mask)</span><br></pre></td></tr></table></figure>
<p>p2q2</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.setrecursionlimit(<span class="number">1500</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#part1,</span></span><br><span class="line">a1=<span class="number">67739512154277162085770157687437441198363095490607019903179640765859289435128844487312739643781929328039885340492248268381181927215444058044731882600621443249379470235583032722854561171610662253187419453432598163528304052508578209017561499836803166110456130462444164049945234353225230736363194196935115979960</span></span><br><span class="line">b1=<span class="number">17185396829856546439605443867156437815015135756541052637907770783830686534153389303291740769607944691156059669175157827203495395745826694347428694508457493991041224390283763876476601200114028282946724348906485066220181559142937065978299071246507281834301352443856315199896106182934770582627129779923357891915723961923663378398066801894395956482176730300442901078199030200112352639266103862753546370851947797706641058966862813099369195689336228579744994641830699890792017097474275824545664085264972274642572927392940910981115837831275773192989084712813373293435228956787629490757407431010258942490818726318175944867633</span></span><br><span class="line">c1=<span class="number">2180773316568266715369209198734610509148388893757598741330158376506447322216176787253641696053169188685408469718202047474660716095850135317790263924418449270019680259700945680062960717565507426032265137192689118286560945331123730529355709043463330231284484658907466172538703301303440062783852136344472063837313195697915205569416630439851250171277336484771753816776835527532090668694986220968152676688392975798850738947165707984817923309381811015047150056144403783079156300625762879231698942313672034730244627530962258121618021680413439757194393609777357848156392150372631861473658135778661768208071991812674187273360</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">a1 = <span class="string">&quot;0&quot;</span> + <span class="built_in">str</span>(<span class="built_in">bin</span>(a1)[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find</span>(<span class="params">p,q</span>):</span><br><span class="line">    l = <span class="built_in">len</span>(p)</span><br><span class="line">    tmp0 = p + (<span class="number">1024</span>-l)*<span class="string">&quot;0&quot;</span></span><br><span class="line">    tmp1 = p + (<span class="number">1024</span>-l)*<span class="string">&quot;1&quot;</span></span><br><span class="line">    tmq0 = q + (<span class="number">1024</span>-l)*<span class="string">&quot;0&quot;</span></span><br><span class="line">    tmq1 = q + (<span class="number">1024</span>-l)*<span class="string">&quot;1&quot;</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">int</span>(tmp0,<span class="number">2</span>) &lt; <span class="built_in">int</span>(tmq0,<span class="number">2</span>)):</span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">int</span>(tmp0,<span class="number">2</span>)*<span class="built_in">int</span>(tmq0,<span class="number">2</span>) &gt; b1):</span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    <span class="keyword">elif</span>(<span class="built_in">int</span>(tmp1,<span class="number">2</span>)*<span class="built_in">int</span>(tmq1,<span class="number">2</span>) &lt; b1):</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(l == <span class="number">1024</span>):</span><br><span class="line">        pp = <span class="built_in">int</span>(tmp0,<span class="number">2</span>)</span><br><span class="line">        qq = <span class="built_in">int</span>(tmq0,<span class="number">2</span>)</span><br><span class="line">        d = inverse(e,(pp-<span class="number">1</span>)*(qq-<span class="number">1</span>))</span><br><span class="line">        m = long_to_bytes(<span class="built_in">pow</span>(c1,d,pp*qq))</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(m)[<span class="number">2</span>:-<span class="number">1</span>],end = <span class="string">&quot;&quot;</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span>(a1[l] == <span class="string">&quot;1&quot;</span>):</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line"></span><br><span class="line">tempp = <span class="string">&quot;&quot;</span></span><br><span class="line">tempq = <span class="string">&quot;&quot;</span></span><br><span class="line">find(tempp,tempq)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#part2 </span></span><br><span class="line">a2=<span class="number">102834527596695950719979111423985349726489864165244791755647652205679952999516919199218636781810880771255724153293007819995198831162629014290926266777774940370836206596205967641213842702547665263659933022253549718321445029287279257463914991950587622466780705329578580061019164231870445205566240956950369224751</span></span><br><span class="line">b2=<span class="number">102834527596695950719979111423985349726489864165244791755647652205679952999516919199218636781810880771255724153293007819995198831162629014290926266777774949520538413350277489291427420271328741830415622921056457371226207219443304838109001023043838810016379140438034881290332449739051404396455209891630254998985</span></span><br><span class="line">c2=<span class="number">46285230821397377383998198689981002335902850753318921384068480704506522918467396194184971163720421808774010121239873784436865080818119851642074388303787396280596526597467664310187113430990219486840906481260493087443528880139543560763852844535689852804877233056126591516506599561944164619603448246607830867682</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find</span>(<span class="params">p,q,k</span>):</span><br><span class="line">    mask = <span class="number">2</span>**k-<span class="number">1</span></span><br><span class="line"></span><br><span class="line">    t1 = (<span class="built_in">int</span>(p,<span class="number">2</span>)*<span class="built_in">int</span>(q,<span class="number">2</span>))</span><br><span class="line">    t2 = (<span class="built_in">int</span>(p,<span class="number">2</span>)+<span class="built_in">int</span>(q,<span class="number">2</span>))</span><br><span class="line">    t3 = (<span class="built_in">int</span>(p,<span class="number">2</span>)-<span class="built_in">int</span>(q,<span class="number">2</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">len</span>(<span class="built_in">bin</span>(<span class="built_in">int</span>(p,<span class="number">2</span>))[<span class="number">2</span>:]) == <span class="number">512</span> <span class="keyword">and</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(<span class="built_in">int</span>(q,<span class="number">2</span>))[<span class="number">2</span>:]) == <span class="number">512</span>):</span><br><span class="line">        pp = <span class="built_in">int</span>(p,<span class="number">2</span>)</span><br><span class="line">        qq = <span class="built_in">int</span>(q,<span class="number">2</span>)</span><br><span class="line">        d = inverse(e,(pp-<span class="number">1</span>)*(qq-<span class="number">1</span>))</span><br><span class="line">        m = long_to_bytes(<span class="built_in">pow</span>(c2,d,pp*qq))</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">len</span>(m) &lt; <span class="number">20</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(m)[<span class="number">2</span>:-<span class="number">1</span>])</span><br><span class="line">            exit()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(((t1^t2)&amp;mask) == (a2&amp;mask) <span class="keyword">and</span> ((t1^t3)&amp;mask) == (b2&amp;mask)):</span><br><span class="line">        find(<span class="string">&quot;0&quot;</span>+p,<span class="string">&quot;0&quot;</span>+q,k+<span class="number">1</span>)</span><br><span class="line">        find(<span class="string">&quot;0&quot;</span>+p,<span class="string">&quot;1&quot;</span>+q,k+<span class="number">1</span>)</span><br><span class="line">        find(<span class="string">&quot;1&quot;</span>+p,<span class="string">&quot;0&quot;</span>+q,k+<span class="number">1</span>)</span><br><span class="line">        find(<span class="string">&quot;1&quot;</span>+p,<span class="string">&quot;1&quot;</span>+q,k+<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">p = <span class="string">&quot;1&quot;</span></span><br><span class="line">q = <span class="string">&quot;1&quot;</span></span><br><span class="line"></span><br><span class="line">find(p,q,<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p></p>
<p>flag</p>
<p><strong>flag{u2w6tnettv2a9fbo5qh73k8082h2q9j3}</strong></p>
<p><br></p>
<p><br></p>
]]></content>
      <categories>
        <category>crypto</category>
      </categories>
  </entry>
  <entry>
    <title>Crypto-</title>
    <url>/post/97bbcbc9.html</url>
    <content><![CDATA[<p></p>
<span id="more"></span>
<h3 id="Shamir"><a href="#Shamir" class="headerlink" title="Shamir"></a>Shamir</h3><p></p>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">Shamirfag<span class="number">9</span><span class="number">5</span>flag.:</span><br><span class="line">p=<span class="number">0x3b9f64aeadae9545d899102c8c1874e3d4f12caf6ded3eb8454c27fd7058ff31a5742aee60b2b7</span></span><br><span class="line"><span class="number">5</span>:</span><br><span class="line"><span class="number">0x13570e530aaa3639e622d02ca8a0f89089ad0ee3ba51edd95490653b684aaeedd3a762938d08b3</span></span><br><span class="line"><span class="number">0xb583b75e84190f9d081234088b23e6b634110bda167a21bdfb4b5608a65e7283e8531547623d8</span></span><br><span class="line"><span class="number">0x8d3bbbb28592b1a00885c11633369568fcb8bbfdec3cbf4d8cd5546728ca99f24cbe0ac214a39</span></span><br><span class="line"><span class="number">0x13816f03e972210516c17b13a008ee8fd9b888839d6e1ce203fd7723f5e8e0443c2c6279c8dab9</span></span><br><span class="line"><span class="number">0x1553e323763e4c3ba53f6f93e0feb01d6b168fdda30fd87e949664eb4c8f2fd8414e2c14df8f5e</span></span><br><span class="line">flag</span><br></pre></td></tr></table></figure>
<p>ShamirShamir:</p>
<p>1<strong></strong></p>
<ul>
<li> secret</li>
<li> t 5flagt=5</li>
<li> p </li>
<li> t-1 </li>
</ul>
<script type="math/tex; mode=display">
f(x) = a_{t-1}*x^{t-1}+a_{t-2}*x^{t-2}+...+a_{2}*x^{2}+a_{1}*x^{1}+a_0 \quad(mod\;p)</script><script type="math/tex; mode=display">
a_1a_2...a_{t-2}a_{t-1}a0=secret</script><ul>
<li> x=0  f(x)=f(0)=a0=secret</li>
</ul>
<p><br></p>
<p>2<strong></strong></p>
<ul>
<li> n  1~n(n) f(x)n</li>
</ul>
<script type="math/tex; mode=display">
(1f(1))(2,f(2))...(n-1,f(n-1))(n,f(n))</script><ul>
<li> n  n </li>
</ul>
<p><br></p>
<p>3<strong></strong></p>
<p><br></p>
<p>Shamir t  n  (t,n) - </p>
<p>(&gt;=t) secret:</p>
<script type="math/tex; mode=display">
(x_1f(x_1))(x_2,f(x_2))...(x_{n-1},f(x_{n-1}))(x_n,f(x_n))</script><p></p>
<script type="math/tex; mode=display">
f(x) = \sum_{i=1}^{t}[{f(x_i)}*\prod_{j=1,j\neq i}^{t}{\frac{x-x_j}{x_i-x_j}}]\quad(mod\;p)</script><p></p>
<script type="math/tex; mode=display">
f(x) = f(x_1)\frac{(x-x_2)(x-x_3)...(x-x_t)}{(x1-x_2)(x1-x_3)...(x1-x_t)} + f(x_2)\frac{(x-x_1)(x-x_3)...(x-x_t)}{(x2-x_1)(x2-x_3)...(x2-x_t)} + ... +
f(x_t)\frac{(x-x_1)(x-x_2)...(x-x_{t-1})}{(x_t-x_1)(x_t-x_2)...(x_t-x_{t-1})}
\quad(mod\;p)</script><p></p>
<ul>
<li> t-1 </li>
<li></li>
</ul>
<script type="math/tex; mode=display">
(x_1f(x_1))(x_2,f(x_2))...(x_{n-1},f(x_{n-1}))(x_n,f(x_n))</script><ul>
<li>00 x1 </li>
</ul>
<script type="math/tex; mode=display">
f(x_1) = f(x_1)\frac{(x_1-x_2)(x_1-x_3)...(x_1-x_t)}{(x1-x_2)(x1-x_3)...(x1-x_t)} + f(x_2)\frac{(x_1-x_1)(x_1-x_3)...(x_1-x_t)}{(x2-x_1)(x2-x_3)...(x2-x_t)} + ... +
f(x_t)\frac{(x_1-x_1)(x_1-x_2)...(x_1-x_{t-1})}{(x_t-x_1)(x_t-x_2)...(x_t-x_{t-1})}
\quad(mod\;p)</script><ul>
<li></li>
</ul>
<script type="math/tex; mode=display">
f(x_1) = f(x_1)*1 + f(x_2)*0 + ... +
f(x_t)*0
\quad(mod\;p)</script><script type="math/tex; mode=display">
 f(x_1) = f(x_1)
\quad(mod\;p)</script><p>( t-1  t ) 0  secret</p>
<p><br></p>
<p>Shamir59</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> permutations</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">0x3b9f64aeadae9545d899102c8c1874e3d4f12caf6ded3eb8454c27fd7058ff31a5742aee60b2b7</span></span><br><span class="line">c = [<span class="number">0x13570e530aaa3639e622d02ca8a0f89089ad0ee3ba51edd95490653b684aaeedd3a762938d08b3</span>,<span class="number">0xb583b75e84190f9d081234088b23e6b634110bda167a21bdfb4b5608a65e7283e8531547623d8</span>,<span class="number">0x8d3bbbb28592b1a00885c11633369568fcb8bbfdec3cbf4d8cd5546728ca99f24cbe0ac214a39</span>,<span class="number">0x13816f03e972210516c17b13a008ee8fd9b888839d6e1ce203fd7723f5e8e0443c2c6279c8dab9</span>,<span class="number">0x1553e323763e4c3ba53f6f93e0feb01d6b168fdda30fd87e949664eb4c8f2fd8414e2c14df8f5e</span>]</span><br><span class="line"></span><br><span class="line">m = ([<span class="number">0</span>, c[<span class="number">0</span>]],[<span class="number">0</span>, c[<span class="number">1</span>]],[<span class="number">0</span>, c[<span class="number">2</span>]],[<span class="number">0</span>, c[<span class="number">3</span>]],[<span class="number">0</span>, c[<span class="number">4</span>]])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> permutations(<span class="built_in">range</span>(<span class="number">9</span>),<span class="number">5</span>):</span><br><span class="line">        m[<span class="number">0</span>][<span class="number">0</span>] = i[<span class="number">0</span>]</span><br><span class="line">        m[<span class="number">1</span>][<span class="number">0</span>] = i[<span class="number">1</span>]</span><br><span class="line">        m[<span class="number">2</span>][<span class="number">0</span>] = i[<span class="number">2</span>]</span><br><span class="line">        m[<span class="number">3</span>][<span class="number">0</span>] = i[<span class="number">3</span>]</span><br><span class="line">        m[<span class="number">4</span>][<span class="number">0</span>] = i[<span class="number">4</span>]</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = (</span><br><span class="line">                m[<span class="number">0</span>][<span class="number">1</span>] * (<span class="number">0</span> - m[<span class="number">1</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">2</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">3</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">4</span>][<span class="number">0</span>]) * inverse((m[<span class="number">0</span>][<span class="number">0</span>] - m[<span class="number">1</span>][<span class="number">0</span>]) * (m[<span class="number">0</span>][<span class="number">0</span>] - m[<span class="number">2</span>][<span class="number">0</span>]) * (m[<span class="number">0</span>][<span class="number">0</span>] - m[<span class="number">3</span>][<span class="number">0</span>]) * (m[<span class="number">0</span>][<span class="number">0</span>] - m[<span class="number">4</span>][<span class="number">0</span>]), p) +</span><br><span class="line">                m[<span class="number">1</span>][<span class="number">1</span>] * (<span class="number">0</span> - m[<span class="number">0</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">2</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">3</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">4</span>][<span class="number">0</span>]) * inverse((m[<span class="number">1</span>][<span class="number">0</span>] - m[<span class="number">0</span>][<span class="number">0</span>]) * (m[<span class="number">1</span>][<span class="number">0</span>] - m[<span class="number">2</span>][<span class="number">0</span>]) * (m[<span class="number">1</span>][<span class="number">0</span>] - m[<span class="number">3</span>][<span class="number">0</span>]) * (m[<span class="number">1</span>][<span class="number">0</span>] - m[<span class="number">4</span>][<span class="number">0</span>]), p) +</span><br><span class="line">                m[<span class="number">2</span>][<span class="number">1</span>] * (<span class="number">0</span> - m[<span class="number">1</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">0</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">3</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">4</span>][<span class="number">0</span>]) * inverse((m[<span class="number">2</span>][<span class="number">0</span>] - m[<span class="number">1</span>][<span class="number">0</span>]) * (m[<span class="number">2</span>][<span class="number">0</span>] - m[<span class="number">0</span>][<span class="number">0</span>]) * (m[<span class="number">2</span>][<span class="number">0</span>] - m[<span class="number">3</span>][<span class="number">0</span>]) * (m[<span class="number">2</span>][<span class="number">0</span>] - m[<span class="number">4</span>][<span class="number">0</span>]), p) +</span><br><span class="line">                m[<span class="number">3</span>][<span class="number">1</span>] * (<span class="number">0</span> - m[<span class="number">1</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">2</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">0</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">4</span>][<span class="number">0</span>]) * inverse((m[<span class="number">3</span>][<span class="number">0</span>] - m[<span class="number">1</span>][<span class="number">0</span>]) * (m[<span class="number">3</span>][<span class="number">0</span>] - m[<span class="number">2</span>][<span class="number">0</span>]) * (m[<span class="number">3</span>][<span class="number">0</span>] - m[<span class="number">0</span>][<span class="number">0</span>]) * (m[<span class="number">3</span>][<span class="number">0</span>] - m[<span class="number">4</span>][<span class="number">0</span>]), p) +</span><br><span class="line">                m[<span class="number">4</span>][<span class="number">1</span>] * (<span class="number">0</span> - m[<span class="number">1</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">2</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">3</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">0</span>][<span class="number">0</span>]) * inverse((m[<span class="number">4</span>][<span class="number">0</span>] - m[<span class="number">1</span>][<span class="number">0</span>]) * (m[<span class="number">4</span>][<span class="number">0</span>] - m[<span class="number">2</span>][<span class="number">0</span>]) * (m[<span class="number">4</span>][<span class="number">0</span>] - m[<span class="number">3</span>][<span class="number">0</span>]) * (m[<span class="number">4</span>][<span class="number">0</span>] - m[<span class="number">0</span>][<span class="number">0</span>]), p)</span><br><span class="line">                ) % p</span><br><span class="line">            temp = <span class="built_in">str</span>(long_to_bytes(r))</span><br><span class="line">            <span class="keyword">if</span>(<span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> temp):</span><br><span class="line">                <span class="built_in">print</span>(temp)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<p>flag:</p>
<p><strong>flag{b14f4963671a457cf22ec271356e0f78}</strong></p>
<p><br></p>
<p><br></p>
<h3 id=""><a href="#" class="headerlink" title=""></a></h3><p></p>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">P = Permutations(<span class="number">256</span>).random_element()</span><br><span class="line"><span class="built_in">print</span>(P**<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>([x^y <span class="keyword">for</span> x,y <span class="keyword">in</span> <span class="built_in">zip</span>(hashlib.sha512(<span class="built_in">str</span>(P).encode()).digest(), <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read())])</span><br></pre></td></tr></table></figure>
<p>txt</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[41, 124, 256, 27, 201, 93, 40, 133, 47, 10, 69, 253, 13, 245, 165, 166, 118, 230, 197, 249, 115, 18, 71, 24, 100, 14, 160, 28, 251, 96, 106, 5, 244, 58, 67, 44, 150, 42, 255, 74, 168, 182, 153, 209, 227, 232, 159, 128, 125, 11, 135, 90, 76, 30, 84, 31, 1, 149, 48, 95, 216, 94, 157, 131, 196, 172, 105, 169, 202, 203, 121, 210, 53, 9, 147, 89, 39, 68, 59, 141, 87, 207, 51, 180, 19, 81, 57, 103, 228, 77, 12, 129, 185, 85, 45, 123, 50, 116, 65, 213, 104, 64, 54, 155, 222, 112, 3, 252, 21, 33, 138, 151, 211, 233, 204, 97, 239, 113, 82, 200, 23, 231, 177, 26, 72, 4, 78, 183, 199, 6, 49, 29, 250, 119, 32, 56, 110, 187, 35, 143, 83, 25, 70, 2, 66, 101, 217, 120, 224, 142, 191, 136, 189, 127, 132, 36, 174, 146, 152, 140, 193, 62, 178, 17, 148, 248, 167, 88, 73, 229, 134, 156, 158, 60, 63, 242, 221, 34, 214, 20, 171, 139, 226, 186, 164, 181, 236, 107, 111, 61, 99, 108, 179, 223, 137, 212, 237, 102, 161, 145, 184, 173, 247, 162, 205, 154, 55, 117, 254, 38, 75, 234, 7, 46, 109, 22, 175, 144, 219, 220, 195, 190, 98, 79, 15, 170, 80, 235, 52, 8, 37, 243, 198, 86, 43, 192, 241, 240, 208, 130, 188, 114, 218, 215, 206, 176, 238, 16, 246, 126, 122, 163, 225, 92, 91, 194]</span><br><span class="line">[18, 188, 48, 47, 100, 234, 225, 8, 187, 34, 124, 113, 118, 252, 137, 196, 125, 20, 251, 168, 167, 5, 225, 134, 66, 203, 26, 148, 63, 181, 213, 124, 170, 234, 35, 120, 47, 69, 157, 69, 194]</span><br></pre></td></tr></table></figure>
<p></p>
<ul>
<li>256 P</li>
<li></li>
<li> P  sha512 flag</li>
</ul>
<p>flag</p>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">C[i] = P[P[i]]</span><br></pre></td></tr></table></figure>
<p></p>
<p></p>
<p><strong>()</strong></p>
<p><img src="/post/97bbcbc9/image-20230926104953693.png" alt="image-20230926104953693"></p>
<p>011250</p>
<p>011202</p>
<p></p>
<p><img src="/post/97bbcbc9/image-20230926105347447.png" alt="image-20230926105347447"></p>
<p></p>
<p><img src="/post/97bbcbc9/image-20230926105546460.png" alt="image-20230926105546460"></p>
<p></p>
<p></p>
<p><strong>()</strong></p>
<p><img src="/post/97bbcbc9/image-20230926105945860.png" alt="image-20230926105945860"></p>
<p><strong></strong></p>
<p><img src="/post/97bbcbc9/image-20230926110200084.png" alt="image-20230926110200084"></p>
<p></p>
<p></p>
<p>1<strong></strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#</span></span><br><span class="line">n = [<span class="number">18</span>, <span class="number">188</span>, <span class="number">48</span>, <span class="number">47</span>, <span class="number">100</span>, <span class="number">234</span>, <span class="number">225</span>, <span class="number">8</span>, <span class="number">187</span>, <span class="number">34</span>, <span class="number">124</span>, <span class="number">113</span>, <span class="number">118</span>, <span class="number">252</span>, <span class="number">137</span>, <span class="number">196</span>, <span class="number">125</span>, <span class="number">20</span>, <span class="number">251</span>, <span class="number">168</span>, <span class="number">167</span>, <span class="number">5</span>, <span class="number">225</span>, <span class="number">134</span>, <span class="number">66</span>, <span class="number">203</span>, <span class="number">26</span>, <span class="number">148</span>, <span class="number">63</span>, <span class="number">181</span>, <span class="number">213</span>, <span class="number">124</span>, <span class="number">170</span>, <span class="number">234</span>, <span class="number">35</span>, <span class="number">120</span>, <span class="number">47</span>, <span class="number">69</span>, <span class="number">157</span>, <span class="number">69</span>, <span class="number">194</span>]</span><br><span class="line"></span><br><span class="line">P2 = [<span class="number">41</span>, <span class="number">124</span>, <span class="number">256</span>, <span class="number">27</span>, <span class="number">201</span>, <span class="number">93</span>, <span class="number">40</span>, <span class="number">133</span>, <span class="number">47</span>, <span class="number">10</span>, <span class="number">69</span>, <span class="number">253</span>, <span class="number">13</span>, <span class="number">245</span>, <span class="number">165</span>, <span class="number">166</span>, <span class="number">118</span>, <span class="number">230</span>, <span class="number">197</span>, <span class="number">249</span>, <span class="number">115</span>, <span class="number">18</span>, <span class="number">71</span>, <span class="number">24</span>, <span class="number">100</span>, <span class="number">14</span>, <span class="number">160</span>, <span class="number">28</span>, <span class="number">251</span>, <span class="number">96</span>, <span class="number">106</span>, <span class="number">5</span>, <span class="number">244</span>, <span class="number">58</span>, <span class="number">67</span>, <span class="number">44</span>, <span class="number">150</span>, <span class="number">42</span>, <span class="number">255</span>, <span class="number">74</span>, <span class="number">168</span>, <span class="number">182</span>, <span class="number">153</span>, <span class="number">209</span>, <span class="number">227</span>, <span class="number">232</span>, <span class="number">159</span>, <span class="number">128</span>, <span class="number">125</span>, <span class="number">11</span>, <span class="number">135</span>, <span class="number">90</span>, <span class="number">76</span>, <span class="number">30</span>, <span class="number">84</span>, <span class="number">31</span>, <span class="number">1</span>, <span class="number">149</span>, <span class="number">48</span>, <span class="number">95</span>, <span class="number">216</span>, <span class="number">94</span>, <span class="number">157</span>, <span class="number">131</span>, <span class="number">196</span>, <span class="number">172</span>, <span class="number">105</span>, <span class="number">169</span>, <span class="number">202</span>, <span class="number">203</span>, <span class="number">121</span>, <span class="number">210</span>, <span class="number">53</span>, <span class="number">9</span>, <span class="number">147</span>, <span class="number">89</span>, <span class="number">39</span>, <span class="number">68</span>, <span class="number">59</span>, <span class="number">141</span>, <span class="number">87</span>, <span class="number">207</span>, <span class="number">51</span>, <span class="number">180</span>, <span class="number">19</span>, <span class="number">81</span>, <span class="number">57</span>, <span class="number">103</span>, <span class="number">228</span>, <span class="number">77</span>, <span class="number">12</span>, <span class="number">129</span>, <span class="number">185</span>, <span class="number">85</span>, <span class="number">45</span>, <span class="number">123</span>, <span class="number">50</span>, <span class="number">116</span>, <span class="number">65</span>, <span class="number">213</span>, <span class="number">104</span>, <span class="number">64</span>, <span class="number">54</span>, <span class="number">155</span>, <span class="number">222</span>, <span class="number">112</span>, <span class="number">3</span>, <span class="number">252</span>, <span class="number">21</span>, <span class="number">33</span>, <span class="number">138</span>, <span class="number">151</span>, <span class="number">211</span>, <span class="number">233</span>, <span class="number">204</span>, <span class="number">97</span>, <span class="number">239</span>, <span class="number">113</span>, <span class="number">82</span>, <span class="number">200</span>, <span class="number">23</span>, <span class="number">231</span>, <span class="number">177</span>, <span class="number">26</span>, <span class="number">72</span>, <span class="number">4</span>, <span class="number">78</span>, <span class="number">183</span>, <span class="number">199</span>, <span class="number">6</span>, <span class="number">49</span>, <span class="number">29</span>, <span class="number">250</span>, <span class="number">119</span>, <span class="number">32</span>, <span class="number">56</span>, <span class="number">110</span>, <span class="number">187</span>, <span class="number">35</span>, <span class="number">143</span>, <span class="number">83</span>, <span class="number">25</span>, <span class="number">70</span>, <span class="number">2</span>, <span class="number">66</span>, <span class="number">101</span>, <span class="number">217</span>, <span class="number">120</span>, <span class="number">224</span>, <span class="number">142</span>, <span class="number">191</span>, <span class="number">136</span>, <span class="number">189</span>, <span class="number">127</span>, <span class="number">132</span>, <span class="number">36</span>, <span class="number">174</span>, <span class="number">146</span>, <span class="number">152</span>, <span class="number">140</span>, <span class="number">193</span>, <span class="number">62</span>, <span class="number">178</span>, <span class="number">17</span>, <span class="number">148</span>, <span class="number">248</span>, <span class="number">167</span>, <span class="number">88</span>, <span class="number">73</span>, <span class="number">229</span>, <span class="number">134</span>, <span class="number">156</span>, <span class="number">158</span>, <span class="number">60</span>, <span class="number">63</span>, <span class="number">242</span>, <span class="number">221</span>, <span class="number">34</span>, <span class="number">214</span>, <span class="number">20</span>, <span class="number">171</span>, <span class="number">139</span>, <span class="number">226</span>, <span class="number">186</span>, <span class="number">164</span>, <span class="number">181</span>, <span class="number">236</span>, <span class="number">107</span>, <span class="number">111</span>, <span class="number">61</span>, <span class="number">99</span>, <span class="number">108</span>, <span class="number">179</span>, <span class="number">223</span>, <span class="number">137</span>, <span class="number">212</span>, <span class="number">237</span>, <span class="number">102</span>, <span class="number">161</span>, <span class="number">145</span>, <span class="number">184</span>, <span class="number">173</span>, <span class="number">247</span>, <span class="number">162</span>, <span class="number">205</span>, <span class="number">154</span>, <span class="number">55</span>, <span class="number">117</span>, <span class="number">254</span>, <span class="number">38</span>, <span class="number">75</span>, <span class="number">234</span>, <span class="number">7</span>, <span class="number">46</span>, <span class="number">109</span>, <span class="number">22</span>, <span class="number">175</span>, <span class="number">144</span>, <span class="number">219</span>, <span class="number">220</span>, <span class="number">195</span>, <span class="number">190</span>, <span class="number">98</span>, <span class="number">79</span>, <span class="number">15</span>, <span class="number">170</span>, <span class="number">80</span>, <span class="number">235</span>, <span class="number">52</span>, <span class="number">8</span>, <span class="number">37</span>, <span class="number">243</span>, <span class="number">198</span>, <span class="number">86</span>, <span class="number">43</span>, <span class="number">192</span>, <span class="number">241</span>, <span class="number">240</span>, <span class="number">208</span>, <span class="number">130</span>, <span class="number">188</span>, <span class="number">114</span>, <span class="number">218</span>, <span class="number">215</span>, <span class="number">206</span>, <span class="number">176</span>, <span class="number">238</span>, <span class="number">16</span>, <span class="number">246</span>, <span class="number">126</span>, <span class="number">122</span>, <span class="number">163</span>, <span class="number">225</span>, <span class="number">92</span>, <span class="number">91</span>, <span class="number">194</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(P2)):</span><br><span class="line">    P2[i] -= <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(P2[<span class="number">204</span>])</span><br><span class="line">lenlist = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(P2)):</span><br><span class="line">    <span class="built_in">len</span> = <span class="number">1</span></span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    loc = P2[i]</span><br><span class="line">    chain = [loc]</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">        t = P2[loc]</span><br><span class="line">        loc = t</span><br><span class="line">        chain.append(loc)</span><br><span class="line">        <span class="built_in">len</span> += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(t == i):</span><br><span class="line">            <span class="comment">#print(i,&quot;,&quot;,len)</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">len</span> == <span class="number">2</span>):</span><br><span class="line">                <span class="built_in">print</span>(chain)</span><br><span class="line">                <span class="built_in">print</span>(i+<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="comment">#print(lenlist.count(2))</span></span><br><span class="line"><span class="comment">#2*82 + 75 + 3*3 + 1*8</span></span><br></pre></td></tr></table></figure>
<p> </p>
<ul>
<li>2 82 </li>
<li>175</li>
<li>33</li>
<li>8</li>
</ul>
<p><br></p>
<p>2<strong></strong></p>
<ul>
<li> 82  164 </li>
<li> 75  75 </li>
<li>33 3  3  3  6 </li>
<li>8 8  1-4  2 </li>
</ul>
<p>flagflag()</p>
<p> () </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">82*1*4*C(8,2)*C(6,2)*C(4,2)*16</span><br></pre></td></tr></table></figure>
<p></p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> combinations</span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = [18, 188, 48, 47, 100, 234, 225, 8, 187, 34, 124, 113, 118, 252, 137, 196, 125, 20, 251, 168, 167, 5, 225, 134, 66, 203, 26, 148, 63, 181, 213, 124, 170, 234, 35, 120, 47, 69, 157, 69, 194]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">P2 = [41, 124, 256, 27, 201, 93, 40, 133, 47, 10, 69, 253, 13, 245, 165, 166, 118, 230, 197, 249, 115, 18, 71, 24, 100, 14, 160, 28, 251, 96, 106, 5, 244, 58, 67, 44, 150, 42, 255, 74, 168, 182, 153, 209, 227, 232, 159, 128, 125, 11, 135, 90, 76, 30, 84, 31, 1, 149, 48, 95, 216, 94, 157, 131, 196, 172, 105, 169, 202, 203, 121, 210, 53, 9, 147, 89, 39, 68, 59, 141, 87, 207, 51, 180, 19, 81, 57, 103, 228, 77, 12, 129, 185, 85, 45, 123, 50, 116, 65, 213, 104, 64, 54, 155, 222, 112, 3, 252, 21, 33, 138, 151, 211, 233, 204, 97, 239, 113, 82, 200, 23, 231, 177, 26, 72, 4, 78, 183, 199, 6, 49, 29, 250, 119, 32, 56, 110, 187, 35, 143, 83, 25, 70, 2, 66, 101, 217, 120, 224, 142, 191, 136, 189, 127, 132, 36, 174, 146, 152, 140, 193, 62, 178, 17, 148, 248, 167, 88, 73, 229, 134, 156, 158, 60, 63, 242, 221, 34, 214, 20, 171, 139, 226, 186, 164, 181, 236, 107, 111, 61, 99, 108, 179, 223, 137, 212, 237, 102, 161, 145, 184, 173, 247, 162, 205, 154, 55, 117, 254, 38, 75, 234, 7, 46, 109, 22, 175, 144, 219, 220, 195, 190, 98, 79, 15, 170, 80, 235, 52, 8, 37, 243, 198, 86, 43, 192, 241, 240, 208, 130, 188, 114, 218, 215, 206, 176, 238, 16, 246, 126, 122, 163, 225, 92, 91, 194]</span></span><br><span class="line"><span class="string">for i in range(len(P2)):</span></span><br><span class="line"><span class="string">    P2[i] -= 1</span></span><br><span class="line"><span class="string">print(P2[204])</span></span><br><span class="line"><span class="string">lenlist = []</span></span><br><span class="line"><span class="string">for i in range(len(P2)):</span></span><br><span class="line"><span class="string">    len = 1</span></span><br><span class="line"><span class="string">    t = 0</span></span><br><span class="line"><span class="string">    loc = P2[i]</span></span><br><span class="line"><span class="string">    chain = [loc]</span></span><br><span class="line"><span class="string">    while(1):</span></span><br><span class="line"><span class="string">        t = P2[loc]</span></span><br><span class="line"><span class="string">        loc = t</span></span><br><span class="line"><span class="string">        chain.append(loc)</span></span><br><span class="line"><span class="string">        len += 1</span></span><br><span class="line"><span class="string">        if(t == i):</span></span><br><span class="line"><span class="string">            #print(i,&quot;,&quot;,len)</span></span><br><span class="line"><span class="string">            if(len == 2):</span></span><br><span class="line"><span class="string">                print(chain)</span></span><br><span class="line"><span class="string">                print(i+1)</span></span><br><span class="line"><span class="string">            break</span></span><br><span class="line"><span class="string">#print(lenlist.count(2))</span></span><br><span class="line"><span class="string">#2*82 + 75 + 3*3 + 1*8</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        tt = [0 for k in range(256)]</span></span><br><span class="line"><span class="string">        for k in range(256):</span></span><br><span class="line"><span class="string">            tt[k] = P[P[k]] + 1</span></span><br><span class="line"><span class="string">        for k in range(256):</span></span><br><span class="line"><span class="string">            if(tt[k]!= c[k]):</span></span><br><span class="line"><span class="string">                print(k)</span></span><br><span class="line"><span class="string">        exit()</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">chain1 = [<span class="number">9</span>,<span class="number">12</span>,<span class="number">23</span>,<span class="number">27</span>,<span class="number">166</span>,<span class="number">204</span>,<span class="number">218</span>,<span class="number">219</span>]</span><br><span class="line">group_size = <span class="number">2</span></span><br><span class="line">num_groups = <span class="number">4</span></span><br><span class="line">all_groupings = <span class="built_in">list</span>(combinations(chain1, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_groupings</span>(<span class="params">chain1, group_size, num_groups</span>):</span><br><span class="line">    <span class="keyword">if</span> num_groups == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">yield</span> [chain1]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> combo <span class="keyword">in</span> combinations(chain1, group_size):</span><br><span class="line">            remaining_chain1 = [e <span class="keyword">for</span> e <span class="keyword">in</span> chain1 <span class="keyword">if</span> e <span class="keyword">not</span> <span class="keyword">in</span> combo]</span><br><span class="line">            <span class="keyword">for</span> rest_grouping <span class="keyword">in</span> generate_groupings(remaining_chain1, group_size, num_groups - <span class="number">1</span>):</span><br><span class="line">                <span class="keyword">yield</span> [<span class="built_in">list</span>(combo)] + rest_grouping</span><br><span class="line"></span><br><span class="line">chain1r = <span class="built_in">list</span>(generate_groupings(chain1, group_size, num_groups))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = [<span class="number">18</span>, <span class="number">188</span>, <span class="number">48</span>, <span class="number">47</span>, <span class="number">100</span>, <span class="number">234</span>, <span class="number">225</span>, <span class="number">8</span>, <span class="number">187</span>, <span class="number">34</span>, <span class="number">124</span>, <span class="number">113</span>, <span class="number">118</span>, <span class="number">252</span>, <span class="number">137</span>, <span class="number">196</span>, <span class="number">125</span>, <span class="number">20</span>, <span class="number">251</span>, <span class="number">168</span>, <span class="number">167</span>, <span class="number">5</span>, <span class="number">225</span>, <span class="number">134</span>, <span class="number">66</span>, <span class="number">203</span>, <span class="number">26</span>, <span class="number">148</span>, <span class="number">63</span>, <span class="number">181</span>, <span class="number">213</span>, <span class="number">124</span>, <span class="number">170</span>, <span class="number">234</span>, <span class="number">35</span>, <span class="number">120</span>, <span class="number">47</span>, <span class="number">69</span>, <span class="number">157</span>, <span class="number">69</span>, <span class="number">194</span>]</span><br><span class="line">c = [<span class="number">41</span>, <span class="number">124</span>, <span class="number">256</span>, <span class="number">27</span>, <span class="number">201</span>, <span class="number">93</span>, <span class="number">40</span>, <span class="number">133</span>, <span class="number">47</span>, <span class="number">10</span>, <span class="number">69</span>, <span class="number">253</span>, <span class="number">13</span>, <span class="number">245</span>, <span class="number">165</span>, <span class="number">166</span>, <span class="number">118</span>, <span class="number">230</span>, <span class="number">197</span>, <span class="number">249</span>, <span class="number">115</span>, <span class="number">18</span>, <span class="number">71</span>, <span class="number">24</span>, <span class="number">100</span>, <span class="number">14</span>, <span class="number">160</span>, <span class="number">28</span>, <span class="number">251</span>, <span class="number">96</span>, <span class="number">106</span>, <span class="number">5</span>, <span class="number">244</span>, <span class="number">58</span>, <span class="number">67</span>, <span class="number">44</span>, <span class="number">150</span>, <span class="number">42</span>, <span class="number">255</span>, <span class="number">74</span>, <span class="number">168</span>, <span class="number">182</span>, <span class="number">153</span>, <span class="number">209</span>, <span class="number">227</span>, <span class="number">232</span>, <span class="number">159</span>, <span class="number">128</span>, <span class="number">125</span>, <span class="number">11</span>, <span class="number">135</span>, <span class="number">90</span>, <span class="number">76</span>, <span class="number">30</span>, <span class="number">84</span>, <span class="number">31</span>, <span class="number">1</span>, <span class="number">149</span>, <span class="number">48</span>, <span class="number">95</span>, <span class="number">216</span>, <span class="number">94</span>, <span class="number">157</span>, <span class="number">131</span>, <span class="number">196</span>, <span class="number">172</span>, <span class="number">105</span>, <span class="number">169</span>, <span class="number">202</span>, <span class="number">203</span>, <span class="number">121</span>, <span class="number">210</span>, <span class="number">53</span>, <span class="number">9</span>, <span class="number">147</span>, <span class="number">89</span>, <span class="number">39</span>, <span class="number">68</span>, <span class="number">59</span>, <span class="number">141</span>, <span class="number">87</span>, <span class="number">207</span>, <span class="number">51</span>, <span class="number">180</span>, <span class="number">19</span>, <span class="number">81</span>, <span class="number">57</span>, <span class="number">103</span>, <span class="number">228</span>, <span class="number">77</span>, <span class="number">12</span>, <span class="number">129</span>, <span class="number">185</span>, <span class="number">85</span>, <span class="number">45</span>, <span class="number">123</span>, <span class="number">50</span>, <span class="number">116</span>, <span class="number">65</span>, <span class="number">213</span>, <span class="number">104</span>, <span class="number">64</span>, <span class="number">54</span>, <span class="number">155</span>, <span class="number">222</span>, <span class="number">112</span>, <span class="number">3</span>, <span class="number">252</span>, <span class="number">21</span>, <span class="number">33</span>, <span class="number">138</span>, <span class="number">151</span>, <span class="number">211</span>, <span class="number">233</span>, <span class="number">204</span>, <span class="number">97</span>, <span class="number">239</span>, <span class="number">113</span>, <span class="number">82</span>, <span class="number">200</span>, <span class="number">23</span>, <span class="number">231</span>, <span class="number">177</span>, <span class="number">26</span>, <span class="number">72</span>, <span class="number">4</span>, <span class="number">78</span>, <span class="number">183</span>, <span class="number">199</span>, <span class="number">6</span>, <span class="number">49</span>, <span class="number">29</span>, <span class="number">250</span>, <span class="number">119</span>, <span class="number">32</span>, <span class="number">56</span>, <span class="number">110</span>, <span class="number">187</span>, <span class="number">35</span>, <span class="number">143</span>, <span class="number">83</span>, <span class="number">25</span>, <span class="number">70</span>, <span class="number">2</span>, <span class="number">66</span>, <span class="number">101</span>, <span class="number">217</span>, <span class="number">120</span>, <span class="number">224</span>, <span class="number">142</span>, <span class="number">191</span>, <span class="number">136</span>, <span class="number">189</span>, <span class="number">127</span>, <span class="number">132</span>, <span class="number">36</span>, <span class="number">174</span>, <span class="number">146</span>, <span class="number">152</span>, <span class="number">140</span>, <span class="number">193</span>, <span class="number">62</span>, <span class="number">178</span>, <span class="number">17</span>, <span class="number">148</span>, <span class="number">248</span>, <span class="number">167</span>, <span class="number">88</span>, <span class="number">73</span>, <span class="number">229</span>, <span class="number">134</span>, <span class="number">156</span>, <span class="number">158</span>, <span class="number">60</span>, <span class="number">63</span>, <span class="number">242</span>, <span class="number">221</span>, <span class="number">34</span>, <span class="number">214</span>, <span class="number">20</span>, <span class="number">171</span>, <span class="number">139</span>, <span class="number">226</span>, <span class="number">186</span>, <span class="number">164</span>, <span class="number">181</span>, <span class="number">236</span>, <span class="number">107</span>, <span class="number">111</span>, <span class="number">61</span>, <span class="number">99</span>, <span class="number">108</span>, <span class="number">179</span>, <span class="number">223</span>, <span class="number">137</span>, <span class="number">212</span>, <span class="number">237</span>, <span class="number">102</span>, <span class="number">161</span>, <span class="number">145</span>, <span class="number">184</span>, <span class="number">173</span>, <span class="number">247</span>, <span class="number">162</span>, <span class="number">205</span>, <span class="number">154</span>, <span class="number">55</span>, <span class="number">117</span>, <span class="number">254</span>, <span class="number">38</span>, <span class="number">75</span>, <span class="number">234</span>, <span class="number">7</span>, <span class="number">46</span>, <span class="number">109</span>, <span class="number">22</span>, <span class="number">175</span>, <span class="number">144</span>, <span class="number">219</span>, <span class="number">220</span>, <span class="number">195</span>, <span class="number">190</span>, <span class="number">98</span>, <span class="number">79</span>, <span class="number">15</span>, <span class="number">170</span>, <span class="number">80</span>, <span class="number">235</span>, <span class="number">52</span>, <span class="number">8</span>, <span class="number">37</span>, <span class="number">243</span>, <span class="number">198</span>, <span class="number">86</span>, <span class="number">43</span>, <span class="number">192</span>, <span class="number">241</span>, <span class="number">240</span>, <span class="number">208</span>, <span class="number">130</span>, <span class="number">188</span>, <span class="number">114</span>, <span class="number">218</span>, <span class="number">215</span>, <span class="number">206</span>, <span class="number">176</span>, <span class="number">238</span>, <span class="number">16</span>, <span class="number">246</span>, <span class="number">126</span>, <span class="number">122</span>, <span class="number">163</span>, <span class="number">225</span>, <span class="number">92</span>, <span class="number">91</span>, <span class="number">194</span>]</span><br><span class="line"></span><br><span class="line">chain821 = [<span class="number">193</span>, <span class="number">222</span>, <span class="number">97</span>, <span class="number">115</span>, <span class="number">96</span>, <span class="number">49</span>, <span class="number">10</span>, <span class="number">68</span>, <span class="number">201</span>, <span class="number">172</span>, <span class="number">157</span>, <span class="number">145</span>, <span class="number">100</span>, <span class="number">103</span>, <span class="number">154</span>, <span class="number">131</span>, <span class="number">28</span>, <span class="number">250</span>, <span class="number">121</span>, <span class="number">230</span>, <span class="number">36</span>, <span class="number">149</span>, <span class="number">141</span>, <span class="number">24</span>, <span class="number">99</span>, <span class="number">212</span>, <span class="number">6</span>, <span class="number">39</span>, <span class="number">73</span>, <span class="number">8</span>, <span class="number">46</span>, <span class="number">158</span>, <span class="number">151</span>, <span class="number">135</span>, <span class="number">55</span>, <span class="number">30</span>, <span class="number">105</span>, <span class="number">111</span>, <span class="number">150</span>, <span class="number">190</span>, <span class="number">98</span>, <span class="number">64</span>, <span class="number">195</span>, <span class="number">211</span>, <span class="number">233</span>, <span class="number">85</span>, <span class="number">80</span>, <span class="number">86</span>, <span class="number">56</span>, <span class="number">0</span>, <span class="number">40</span>, <span class="number">167</span>, <span class="number">87</span>, <span class="number">102</span>, <span class="number">53</span>, <span class="number">29</span>, <span class="number">95</span>, <span class="number">122</span>, <span class="number">176</span>, <span class="number">220</span>, <span class="number">194</span>, <span class="number">136</span>, <span class="number">109</span>, <span class="number">32</span>, <span class="number">243</span>, <span class="number">214</span>, <span class="number">108</span>, <span class="number">20</span>, <span class="number">114</span>, <span class="number">203</span>, <span class="number">161</span>, <span class="number">61</span>, <span class="number">93</span>, <span class="number">84</span>, <span class="number">18</span>, <span class="number">196</span>, <span class="number">236</span>, <span class="number">240</span>, <span class="number">187</span>, <span class="number">106</span>, <span class="number">2</span>, <span class="number">255</span>]</span><br><span class="line">chain822 = [<span class="number">125</span>, <span class="number">3</span>, <span class="number">26</span>, <span class="number">159</span>, <span class="number">139</span>, <span class="number">142</span>, <span class="number">69</span>, <span class="number">202</span>, <span class="number">246</span>, <span class="number">237</span>, <span class="number">239</span>, <span class="number">129</span>, <span class="number">5</span>, <span class="number">92</span>, <span class="number">184</span>, <span class="number">163</span>, <span class="number">16</span>, <span class="number">117</span>, <span class="number">112</span>, <span class="number">210</span>, <span class="number">74</span>, <span class="number">146</span>, <span class="number">216</span>, <span class="number">174</span>, <span class="number">62</span>, <span class="number">156</span>, <span class="number">173</span>, <span class="number">59</span>, <span class="number">94</span>, <span class="number">44</span>, <span class="number">226</span>, <span class="number">79</span>, <span class="number">140</span>, <span class="number">82</span>, <span class="number">50</span>, <span class="number">134</span>, <span class="number">31</span>, <span class="number">4</span>, <span class="number">200</span>, <span class="number">183</span>, <span class="number">185</span>, <span class="number">180</span>, <span class="number">170</span>, <span class="number">133</span>, <span class="number">118</span>, <span class="number">81</span>, <span class="number">206</span>, <span class="number">54</span>, <span class="number">83</span>, <span class="number">179</span>, <span class="number">19</span>, <span class="number">248</span>, <span class="number">245</span>, <span class="number">175</span>, <span class="number">241</span>, <span class="number">113</span>, <span class="number">232</span>, <span class="number">197</span>, <span class="number">101</span>, <span class="number">63</span>, <span class="number">130</span>, <span class="number">48</span>, <span class="number">124</span>, <span class="number">71</span>, <span class="number">209</span>, <span class="number">37</span>, <span class="number">41</span>, <span class="number">181</span>, <span class="number">138</span>, <span class="number">34</span>, <span class="number">66</span>, <span class="number">104</span>, <span class="number">221</span>, <span class="number">189</span>, <span class="number">60</span>, <span class="number">215</span>, <span class="number">21</span>, <span class="number">17</span>, <span class="number">229</span>, <span class="number">7</span>, <span class="number">132</span>, <span class="number">249</span>]</span><br><span class="line">chain75 = [<span class="number">90</span>, <span class="number">11</span>, <span class="number">252</span>, <span class="number">224</span>, <span class="number">14</span>, <span class="number">164</span>, <span class="number">147</span>, <span class="number">119</span>, <span class="number">199</span>, <span class="number">144</span>, <span class="number">65</span>, <span class="number">171</span>, <span class="number">155</span>, <span class="number">35</span>, <span class="number">43</span>, <span class="number">208</span>, <span class="number">253</span>, <span class="number">91</span>, <span class="number">128</span>, <span class="number">198</span>, <span class="number">160</span>, <span class="number">192</span>, <span class="number">178</span>, <span class="number">213</span>, <span class="number">45</span>, <span class="number">231</span>, <span class="number">242</span>, <span class="number">217</span>, <span class="number">143</span>, <span class="number">1</span>, <span class="number">123</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">244</span>, <span class="number">205</span>, <span class="number">153</span>, <span class="number">126</span>, <span class="number">77</span>, <span class="number">67</span>, <span class="number">168</span>, <span class="number">72</span>, <span class="number">52</span>, <span class="number">75</span>, <span class="number">88</span>, <span class="number">227</span>, <span class="number">234</span>, <span class="number">42</span>, <span class="number">152</span>, <span class="number">188</span>, <span class="number">110</span>, <span class="number">137</span>, <span class="number">186</span>, <span class="number">235</span>, <span class="number">191</span>, <span class="number">107</span>, <span class="number">251</span>, <span class="number">162</span>, <span class="number">177</span>, <span class="number">33</span>, <span class="number">57</span>, <span class="number">148</span>, <span class="number">223</span>, <span class="number">78</span>, <span class="number">58</span>, <span class="number">47</span>, <span class="number">127</span>, <span class="number">182</span>, <span class="number">225</span>, <span class="number">169</span>, <span class="number">228</span>, <span class="number">51</span>, <span class="number">89</span>, <span class="number">76</span>, <span class="number">38</span>, <span class="number">254</span>]</span><br><span class="line">chain31 = [<span class="number">15</span>, <span class="number">165</span>, <span class="number">247</span>]</span><br><span class="line">chain32 = [<span class="number">207</span>, <span class="number">116</span>, <span class="number">238</span>]</span><br><span class="line">chain33 = [<span class="number">120</span>, <span class="number">22</span>, <span class="number">70</span>]</span><br><span class="line">chain1 = [<span class="number">9</span>,<span class="number">12</span>,<span class="number">23</span>,<span class="number">27</span>,<span class="number">166</span>,<span class="number">204</span>,<span class="number">218</span>,<span class="number">219</span>]</span><br><span class="line"></span><br><span class="line">locdic = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#chain3()</span></span><br><span class="line"><span class="comment">#13</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span>):</span><br><span class="line">    chain31r = [<span class="number">15</span>, <span class="number">247</span>, <span class="number">165</span>]</span><br><span class="line">    chain32r = [<span class="number">207</span>, <span class="number">238</span>, <span class="number">116</span>]</span><br><span class="line">    chain33r = [<span class="number">120</span>, <span class="number">70</span>, <span class="number">22</span>]</span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        locdic[chain31r[i]] = chain31r[(i+<span class="number">1</span>)%<span class="number">3</span>]</span><br><span class="line">        locdic[chain32r[i]] = chain32r[(i+<span class="number">1</span>)%<span class="number">3</span>]</span><br><span class="line">        locdic[chain33r[i]] = chain33r[(i+<span class="number">1</span>)%<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#2:1,1</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span>):</span><br><span class="line">    chain31r = [<span class="number">15</span>, <span class="number">247</span>, <span class="number">165</span>]</span><br><span class="line">    chain6r = [<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>)]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        <span class="keyword">if</span>(j % <span class="number">2</span> == <span class="number">0</span>):</span><br><span class="line">            chain6r[j] = chain32[j//<span class="number">2</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            chain6r[j] = chain33[(j//<span class="number">2</span> + <span class="number">0</span>) % <span class="number">6</span>] </span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        locdic[chain31r[i]] = chain31r[(i+<span class="number">1</span>)%<span class="number">3</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        locdic[chain6r[i]] = chain6r[(i+<span class="number">1</span>)%<span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span>):</span><br><span class="line">    chain32r = [<span class="number">120</span>, <span class="number">70</span>, <span class="number">22</span>]</span><br><span class="line">    chain6r = [<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>)]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        <span class="keyword">if</span>(j % <span class="number">2</span> == <span class="number">0</span>):</span><br><span class="line">            chain6r[j] = chain31[j//<span class="number">2</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            chain6r[j] = chain33[(j//<span class="number">2</span> + <span class="number">0</span>) % <span class="number">6</span>] </span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        locdic[chain32r[i]] = chain32r[(i+<span class="number">1</span>)%<span class="number">3</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        locdic[chain6r[i]] = chain6r[(i+<span class="number">1</span>)%<span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span>):</span><br><span class="line">    chain33r = [<span class="number">120</span>, <span class="number">70</span>, <span class="number">22</span>]</span><br><span class="line">    chain6r = [<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>)]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        <span class="keyword">if</span>(j % <span class="number">2</span> == <span class="number">0</span>):</span><br><span class="line">            chain6r[j] = chain31[j//<span class="number">2</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            chain6r[j] = chain32[(j//<span class="number">2</span> + <span class="number">0</span>) % <span class="number">6</span>] </span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        locdic[chain33r[i]] = chain33r[(i+<span class="number">1</span>)%<span class="number">3</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        locdic[chain6r[i]] = chain6r[(i+<span class="number">1</span>)%<span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#chain75()</span></span><br><span class="line">chain75r = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">75</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">75</span>):</span><br><span class="line">    chain75r[<span class="number">2</span>*i%<span class="number">75</span>] = chain75[i]</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">75</span>):</span><br><span class="line">    locdic[chain75r[i]] = chain75r[(i+<span class="number">1</span>)%<span class="number">75</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">82</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    locdic1 = locdic</span><br><span class="line">    chain164r = [<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">164</span>)]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">164</span>):</span><br><span class="line">        <span class="keyword">if</span>(j % <span class="number">2</span> == <span class="number">0</span>):</span><br><span class="line">            chain164r[j] = chain821[j//<span class="number">2</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            chain164r[j] = chain822[(j//<span class="number">2</span> + i) % <span class="number">82</span>] </span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">164</span>):</span><br><span class="line">        locdic1[chain164r[i]] = chain164r[(i+<span class="number">1</span>)%<span class="number">164</span>]</span><br><span class="line">      </span><br><span class="line">    <span class="comment">#4</span></span><br><span class="line">    <span class="keyword">for</span> mm <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        ttt = <span class="built_in">bin</span>(mm)[<span class="number">2</span>:].zfill(<span class="number">4</span>)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(chain1r)):</span><br><span class="line">            locdic2 = locdic1</span><br><span class="line">            <span class="keyword">if</span>(ttt[<span class="number">0</span>] == <span class="string">&quot;1&quot;</span>):</span><br><span class="line">                locdic2[chain1r[j][<span class="number">0</span>][<span class="number">0</span>]] = chain1r[j][<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">                locdic2[chain1r[j][<span class="number">0</span>][<span class="number">1</span>]] = chain1r[j][<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                locdic2[chain1r[j][<span class="number">0</span>][<span class="number">0</span>]] = chain1r[j][<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">                locdic2[chain1r[j][<span class="number">0</span>][<span class="number">1</span>]] = chain1r[j][<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span>(ttt[<span class="number">1</span>] == <span class="string">&quot;1&quot;</span>):</span><br><span class="line">                locdic2[chain1r[j][<span class="number">1</span>][<span class="number">0</span>]] = chain1r[j][<span class="number">1</span>][<span class="number">1</span>]</span><br><span class="line">                locdic2[chain1r[j][<span class="number">1</span>][<span class="number">1</span>]] = chain1r[j][<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                locdic2[chain1r[j][<span class="number">1</span>][<span class="number">0</span>]] = chain1r[j][<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line">                locdic2[chain1r[j][<span class="number">1</span>][<span class="number">1</span>]] = chain1r[j][<span class="number">1</span>][<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span>(ttt[<span class="number">2</span>] == <span class="string">&quot;1&quot;</span>):</span><br><span class="line">                locdic2[chain1r[j][<span class="number">2</span>][<span class="number">0</span>]] = chain1r[j][<span class="number">2</span>][<span class="number">1</span>]</span><br><span class="line">                locdic2[chain1r[j][<span class="number">2</span>][<span class="number">1</span>]] = chain1r[j][<span class="number">2</span>][<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                locdic2[chain1r[j][<span class="number">2</span>][<span class="number">0</span>]] = chain1r[j][<span class="number">2</span>][<span class="number">0</span>]</span><br><span class="line">                locdic2[chain1r[j][<span class="number">2</span>][<span class="number">1</span>]] = chain1r[j][<span class="number">2</span>][<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span>(ttt[<span class="number">3</span>] == <span class="string">&quot;1&quot;</span>):</span><br><span class="line">                locdic2[chain1r[j][<span class="number">3</span>][<span class="number">0</span>]] = chain1r[j][<span class="number">3</span>][<span class="number">1</span>]</span><br><span class="line">                locdic2[chain1r[j][<span class="number">3</span>][<span class="number">1</span>]] = chain1r[j][<span class="number">3</span>][<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                locdic2[chain1r[j][<span class="number">3</span>][<span class="number">0</span>]] = chain1r[j][<span class="number">3</span>][<span class="number">0</span>]</span><br><span class="line">                locdic2[chain1r[j][<span class="number">3</span>][<span class="number">1</span>]] = chain1r[j][<span class="number">3</span>][<span class="number">1</span>]</span><br><span class="line">            P = [locdic2[j]+<span class="number">1</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)]</span><br><span class="line">            </span><br><span class="line">            t = <span class="string">&quot;&quot;</span></span><br><span class="line">            <span class="keyword">for</span> x,y <span class="keyword">in</span> <span class="built_in">zip</span>(hashlib.sha512(<span class="built_in">str</span>(P).encode()).digest(), n):</span><br><span class="line">                <span class="keyword">if</span>((x^y)&gt;=<span class="number">32</span> <span class="keyword">and</span> (x^y)&lt;=<span class="number">127</span>):</span><br><span class="line">                    t+=<span class="built_in">chr</span>(x^y)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">len</span>(t) &gt; <span class="number">10</span>):</span><br><span class="line">                <span class="built_in">print</span>(t)</span><br><span class="line">                exit()</span><br></pre></td></tr></table></figure>
<p></p>
<p>flag</p>
<p><strong>brics+{ab99943f6dae4f20595c8645fcf8289e}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="prng-"><a href="#prng-" class="headerlink" title="prng()"></a>prng()</h3><p>()</p>
<p></p>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">base</span>(<span class="params">n, l</span>):</span><br><span class="line">    bb = []</span><br><span class="line">    <span class="keyword">while</span> n &gt; <span class="number">0</span>:</span><br><span class="line">        n, r = <span class="built_in">divmod</span>(n, l)</span><br><span class="line">        bb.append(r)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">str</span>(d) <span class="keyword">for</span> d <span class="keyword">in</span> bb[::-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">prng</span>(<span class="params">secret</span>):</span><br><span class="line">	seed = base(secret, <span class="number">5</span>)</span><br><span class="line">	seed = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(seed)]</span><br><span class="line">	length = <span class="built_in">len</span>(seed)</span><br><span class="line">	R = [[ random.randint(<span class="number">0</span>,<span class="number">4</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length**<span class="number">2</span>)]</span><br><span class="line">	S = []</span><br><span class="line">	<span class="keyword">for</span> r <span class="keyword">in</span> R:</span><br><span class="line">		s = <span class="number">0</span></span><br><span class="line">		<span class="keyword">for</span> index <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">			s += (r[index] + seed[index]) % <span class="number">5</span></span><br><span class="line">		s %= <span class="number">2</span></span><br><span class="line">		S.append(s)</span><br><span class="line">	<span class="keyword">return</span> R, S</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">R, S = prng(m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	f.write(<span class="string">f&#x27;R = <span class="subst">&#123;R&#125;</span>\nS = <span class="subst">&#123;S&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p></p>
<ul>
<li>flagseed</li>
<li>seedn</li>
<li> $ n^2*n$ R0-4</li>
<li>Rseed($ i=1,2n^2$)</li>
</ul>
<script type="math/tex; mode=display">
s_i=\sum_{j=1}^{n}{(({r_{ij}+seed_i})(mod\;5))} \quad(mod\;2)</script><ul>
<li> $ s_i$ SRS</li>
</ul>
<p> ZM.J wp</p>
<p><a href="https://zhuanlan.zhihu.com/p/643573246">[CryptoCTF] CryptoCTF 2023 tough writeup -  (zhihu.com)</a></p>
<p></p>
<p>seed0-4m</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0 : (1,0,0,0,0)</span><br><span class="line">1 : (0,1,0,0,0)</span><br><span class="line">2 : (0,0,1,0,0)</span><br><span class="line">3 : (0,0,0,1,0)</span><br><span class="line">4 : (0,0,0,0,1)</span><br></pre></td></tr></table></figure>
<p>0-4</p>
<script type="math/tex; mode=display">
m = x_0 + x_1 + x_2 + x_3 + x_4</script><p> $ x_i$ 010-4m $ x_i$ 10</p>
<p>52</p>
<p>$ r_{ij},seed_i$ 0-452</p>
<div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>4</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
<p> r  i seed  j  i  j $ (r+seed)\;(mod\;5)\;(mod\;2)$ </p>
<p></p>
<p>$ s = 2m_0+3m_1+4m_2 \;(mod\;5)\;(mod\;2)$</p>
<p> $ m_i$ </p>
<script type="math/tex; mode=display">
m_0 = x_{00} + x_{01} + x_{02} + x_{03} + x_{04}</script><script type="math/tex; mode=display">
m_1 = x_{10} + x_{11} + x_{12} + x_{13} + x_{14}</script><script type="math/tex; mode=display">
m_2 = x_{20} + x_{21} + x_{22} + x_{23} + x_{24}</script><p>r</p>
<p>r=2214110r=3303110r=4424110</p>
<p>$ s = 2m_0+3m_1+4m_2 \;(mod\;5)\;(mod\;2)$ 52</p>
<script type="math/tex; mode=display">
s = (0,1,0,0,1)*\left(
 \begin{matrix}
   x_{00} \\
   x_{01} \\
   x_{02} \\
   x_{03}  \\
   x_{04}  \\
  \end{matrix}
  \right)
  + (1,0,0,1,0)*\left(
 \begin{matrix}
   x_{10} \\
   x_{11} \\
   x_{12} \\
   x_{13}  \\
   x_{14}  \\
  \end{matrix}
  \right)
  + (0,0,1,0,1) * \left(
 \begin{matrix}
   x_{20} \\
   x_{21} \\
   x_{22} \\
   x_{23}  \\
   x_{24}  \\
  \end{matrix}
  \right)
  \quad(mod\;2)</script><p>seedn5n5nm</p>
<p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0 : (1,0,0,0,0)</span><br><span class="line">1 : (0,1,0,0,0)</span><br><span class="line">2 : (0,0,1,0,0)</span><br><span class="line">3 : (0,0,0,1,0)</span><br><span class="line">4 : (0,0,0,0,1)</span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(1,1,1,1,0)</span><br></pre></td></tr></table></figure>
<p>m4(1,1,1,1,0)4</p>
<p>exp.ipynb:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&#x27;E:\vscode\output4.txt&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="built_in">exec</span>(f.read())</span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(R[<span class="number">0</span>])</span><br><span class="line">A = []</span><br><span class="line">B = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span> * n):</span><br><span class="line">    a = []</span><br><span class="line">    B.append(S[i])</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        <span class="keyword">if</span> (R[i][j] == <span class="number">0</span>):</span><br><span class="line">            a.extend([<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span> ,<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">elif</span> (R[i][j] == <span class="number">1</span>):</span><br><span class="line">            a.extend([<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>])</span><br><span class="line">        <span class="keyword">elif</span> (R[i][j] == <span class="number">2</span>):</span><br><span class="line">            a.extend([<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>])</span><br><span class="line">        <span class="keyword">elif</span> (R[i][j] == <span class="number">3</span>):</span><br><span class="line">            a.extend([<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>])</span><br><span class="line">        <span class="keyword">elif</span> (R[i][j] == <span class="number">4</span>):</span><br><span class="line">            a.extend([<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>])</span><br><span class="line">    A.append(a)</span><br><span class="line"></span><br><span class="line">A = matrix(GF(<span class="number">2</span>), A)</span><br><span class="line">B = vector(GF(<span class="number">2</span>), B)</span><br><span class="line">x = A.solve_right(B)</span><br><span class="line"><span class="comment">#print(x)</span></span><br><span class="line"></span><br><span class="line">flag = []</span><br><span class="line">temp = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    <span class="keyword">if</span> (x[<span class="number">5</span>*i] == <span class="number">1</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">1</span>] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">2</span>] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">3</span>] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">4</span>] == <span class="number">0</span>):</span><br><span class="line">        flag.append(<span class="string">&quot;0&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> (x[<span class="number">5</span>*i] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">1</span>] == <span class="number">1</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">2</span>] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">3</span>] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">4</span>] == <span class="number">0</span>):</span><br><span class="line">        flag.append(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> (x[<span class="number">5</span>*i] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">1</span>] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">2</span>] == <span class="number">1</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">3</span>] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">4</span>] == <span class="number">0</span>):</span><br><span class="line">        flag.append(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> (x[<span class="number">5</span>*i] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">1</span>] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">2</span>] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">3</span>] == <span class="number">1</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">4</span>] == <span class="number">0</span>):</span><br><span class="line">        flag.append(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> (x[<span class="number">5</span>*i] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">1</span>] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">2</span>] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">3</span>] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">4</span>] == <span class="number">1</span>):</span><br><span class="line">        flag.append(<span class="string">&quot;4&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> (x[<span class="number">5</span>*i] == <span class="number">1</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">1</span>] == <span class="number">1</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">2</span>] == <span class="number">1</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">3</span>] == <span class="number">1</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">4</span>] == <span class="number">0</span>):</span><br><span class="line">        flag.append(<span class="string">&quot;4&quot;</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span>.join(flag)</span><br><span class="line">flag = long_to_bytes(<span class="built_in">int</span>(flag, <span class="number">5</span>))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<p><strong>CnHongKe{179bdc38ea135c35f1f973c039a422a7}</strong></p>
<p>()</p>
<p><br></p>
<p><br></p>
]]></content>
      <categories>
        <category>crypto</category>
      </categories>
  </entry>
  <entry>
    <title>Crypto-</title>
    <url>/post/165cec8c.html</url>
    <content><![CDATA[<p></p>
<span id="more"></span>
<h3 id="Ex-Viginere"><a href="#Ex-Viginere" class="headerlink" title="Ex Viginere?"></a>Ex Viginere?</h3><p>MoeCTF 2021</p>
<h4 id=""><a href="#" class="headerlink" title=""></a></h4><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">text is a plain English text which only consists of lowercase letters (without any symbol)</span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> a, b, text, key, flag</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">table = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> key <span class="keyword">in</span> text</span><br><span class="line"><span class="keyword">assert</span> a * b &lt; <span class="number">100</span></span><br><span class="line"><span class="keyword">assert</span> flag == <span class="string">b&#x27;moectf&#123;&#x27;</span> + key.encode() + <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> md5(key.encode()+<span class="string">b&#x27;How_Interesting_the_Cryptography_Is&#x27;</span>).hexdigest() == <span class="string">&#x27;196cf7098c7ea6e3e4d03691fb9d4f58&#x27;</span></span><br><span class="line"></span><br><span class="line">k1 = []</span><br><span class="line">k2 = []</span><br><span class="line"></span><br><span class="line">sequence = [<span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line">n = randint(<span class="number">114514</span>,<span class="number">1919810</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65536</span>):<span class="comment">#2**16</span></span><br><span class="line">    sequence.append((sequence[-<span class="number">1</span>] + sequence[-<span class="number">2</span>]) % n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(a):</span><br><span class="line">    k1.append(sequence[randint(<span class="number">0</span>, <span class="number">65536</span>)] % <span class="number">26</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(b):</span><br><span class="line">    k2.append(sequence[randint(<span class="number">0</span>, <span class="number">65536</span>)] % <span class="number">26</span>)</span><br><span class="line"></span><br><span class="line">c = <span class="string">&#x27;&#x27;</span>.join(table[((<span class="built_in">ord</span>(x) - <span class="number">97</span>) * (k1[i % a]) + k2[i % b]) % <span class="number">26</span>] <span class="keyword">for</span> i, x <span class="keyword">in</span> <span class="built_in">enumerate</span>(text))</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">r&#x27;./cipher&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(c)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
<p>cipher108361</p>
<p><img src="/post/165cec8c/image-20230929101431427.png" alt="image-20230929101431427"></p>
<p></p>
<ul>
<li> flag  key  key </li>
<li>key </li>
<li> n sequence </li>
<li>sequence  n  65536 </li>
<li> sequence  a  26 k1 </li>
<li> sequence  b  26 k2 </li>
<li> m  A  k1[i % a]B  k2[i % b]</li>
</ul>
<p></p>
<ul>
<li> key md5</li>
<li>a*b &lt; 100</li>
</ul>
<h4 id=""><a href="#" class="headerlink" title=""></a></h4><p><strong></strong><strong></strong>( In ,p(a) a )</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">In = p(a)*p(a) + p(b)*p(b) + p(c)*p(c) + ... + p(z)*p(z)</span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">table = ascii_lowercase</span><br><span class="line"></span><br><span class="line"><span class="comment">#obj:  #sec:</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cut</span>(<span class="params">obj, sec</span>):</span><br><span class="line">    <span class="keyword">return</span> [obj[i:i+sec] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(obj),sec)]</span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">In</span>(<span class="params">c</span>):</span><br><span class="line">    freq = &#123;i:<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> table&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(table)):</span><br><span class="line">        freq[table[i]] = c.count(table[i]) / <span class="built_in">len</span>(c)</span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> table:</span><br><span class="line">        index += freq[i] * freq[i]</span><br><span class="line">    <span class="keyword">return</span> index</span><br></pre></td></tr></table></figure>
<p>()</p>
<p>1(26 1/26)</p>
<p>2(26)</p>
<p><img src="/post/165cec8c/image-20230930103629784.png" alt="image-20230930103629784"></p>
<p>1</p>
<script type="math/tex; mode=display">
In = \sum_{i=1}^{26}{(\frac{1}{26})^2} = \frac{1}{26} \approx 0.038</script><p>2</p>
<script type="math/tex; mode=display">
In = \sum_{i=1}^{26}{p(i)^2}  \approx 0.065</script><p></p>
<h4 id=""><a href="#" class="headerlink" title=""></a></h4><h5 id="part1"><a href="#part1" class="headerlink" title="part1"></a>part1</h5><p>(ab)()</p>
<p> gcd(a,b) , a*b &lt; 100</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#part1 a*b=77</span></span><br><span class="line">t = c</span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">        temp = cut(t,i)</span><br><span class="line">        temp1 = [<span class="string">&quot;&quot;</span> <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(i)]</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(temp)-<span class="number">1</span>):</span><br><span class="line">            temp1[<span class="number">0</span>] += temp[k][<span class="number">0</span>]</span><br><span class="line">        index = In(<span class="string">&quot;&quot;</span>.join(temp1[<span class="number">0</span>]))</span><br><span class="line">        <span class="keyword">if</span>(index &gt; <span class="number">0.060</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;lenkey = &quot;</span>,i,<span class="string">&quot;   In = &quot;</span>,index)</span><br></pre></td></tr></table></figure>
<p>a*b = 77a=7b=11a=11b=7</p>
<h5 id="part2"><a href="#part2" class="headerlink" title="part2"></a>part2</h5><p> k1k2</p>
<p> trick sequence mod 26 sequence  0-25 </p>
<p></p>
<p> $ p1, p2 , p3, pn$( $ p1\geq p2 \geq p3\geq pn$ )$ q1, q2 , q3, qn$ $ q1, q2 , q3, qn$ $ q1, q2 , q3, qn$ </p>
<script type="math/tex; mode=display">
\sum_{i=1}^{26}{pi*qi'}</script><p></p>
<p> 77 k1[0]k2[0]12*26 = 312()</p>
<p>0.065 e zpq</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#part2 k1k2</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">        <span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">            <span class="keyword">if</span> GCD(a,<span class="number">26</span>)!= <span class="number">1</span> :</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">                temp = cut(t,<span class="number">77</span>)</span><br><span class="line">                temp1 = [<span class="string">&quot;&quot;</span> <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">77</span>)]</span><br><span class="line">                <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(temp)-<span class="number">1</span>):</span><br><span class="line">                    temp1[i] += temp[k][i]</span><br><span class="line">                m = <span class="string">&#x27;&#x27;</span></span><br><span class="line">                <span class="keyword">for</span> x <span class="keyword">in</span> temp1[i]:</span><br><span class="line">                    m += table[((table.index(x)-b)*inverse(a,<span class="number">26</span>))%<span class="number">26</span>]</span><br><span class="line">                index = In_m(<span class="string">&quot;&quot;</span>.join(m))</span><br><span class="line">                <span class="comment">#print(index)</span></span><br><span class="line">                <span class="keyword">if</span>(index &gt; <span class="number">0.060</span>):</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;a = &quot;</span>,a,<span class="string">&quot;   b = &quot;</span>,b,<span class="string">&quot;,index = &quot;</span>,index)</span><br></pre></td></tr></table></figure>
<p>117711k1k2</p>
<h5 id="part3md5"><a href="#part3md5" class="headerlink" title="part3md5"></a>part3md5</h5><p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#part3 md5</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span>):</span><br><span class="line">    m = <span class="string">&quot;&quot;</span></span><br><span class="line">    k1 = [<span class="number">9</span>,<span class="number">7</span>,<span class="number">25</span>,<span class="number">11</span>,<span class="number">11</span>,<span class="number">19</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">25</span>,<span class="number">9</span>,<span class="number">7</span>]</span><br><span class="line">    k2 = [<span class="number">25</span>,<span class="number">19</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">25</span>,<span class="number">20</span>,<span class="number">8</span>]</span><br><span class="line">    a = <span class="number">11</span></span><br><span class="line">    b = <span class="number">7</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(t)):</span><br><span class="line">        temp = ((table.index(t[i])-k2[i%b])*inverse(k1[i%a],<span class="number">26</span>))%<span class="number">26</span></span><br><span class="line">        m += table[temp]</span><br><span class="line"></span><br><span class="line">    Pad = <span class="string">b&#x27;How_Interesting_the_Cryptography_Is&#x27;</span></span><br><span class="line">    MD5 = <span class="string">&#x27;196cf7098c7ea6e3e4d03691fb9d4f58&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)-i):</span><br><span class="line">            key = m[j:j+i]</span><br><span class="line">            <span class="keyword">if</span> (md5(key.encode()+Pad).hexdigest() == MD5):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;moectf&#123;&#x27;</span>+key+<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>exp(if)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&#x27;E:\vscode\cipher&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    c = f.read()</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line">table = ascii_lowercase</span><br><span class="line">dic = &#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">0.08167</span>,<span class="string">&#x27;b&#x27;</span>: <span class="number">0.01492</span>,<span class="string">&#x27;c&#x27;</span>: <span class="number">0.02782</span>,<span class="string">&#x27;d&#x27;</span>:<span class="number">0.04253</span>,<span class="string">&#x27;e&#x27;</span>: <span class="number">0.12702</span>,<span class="string">&#x27;f&#x27;</span>:<span class="number">0.02228</span>,<span class="string">&#x27;g&#x27;</span>: <span class="number">0.02015</span>,<span class="string">&#x27;h&#x27;</span>:<span class="number">0.06094</span>,<span class="string">&#x27;i&#x27;</span>:<span class="number">0.06966</span>,<span class="string">&#x27;j&#x27;</span>:<span class="number">0.00153</span>,<span class="string">&#x27;k&#x27;</span>:<span class="number">0.00772</span>,<span class="string">&#x27;l&#x27;</span>:<span class="number">0.04025</span>,<span class="string">&#x27;m&#x27;</span>:<span class="number">0.02406</span>,<span class="string">&#x27;n&#x27;</span>:<span class="number">0.06749</span>,<span class="string">&#x27;o&#x27;</span>:<span class="number">0.07507</span>,<span class="string">&#x27;p&#x27;</span>:<span class="number">0.01929</span>,<span class="string">&#x27;q&#x27;</span>:<span class="number">0.00095</span>,<span class="string">&#x27;r&#x27;</span>:<span class="number">0.05987</span>,<span class="string">&#x27;s&#x27;</span>:<span class="number">0.06327</span>,<span class="string">&#x27;t&#x27;</span>:<span class="number">0.09056</span>,<span class="string">&#x27;u&#x27;</span>:<span class="number">0.02758</span>,<span class="string">&#x27;v&#x27;</span>:<span class="number">0.00978</span>,<span class="string">&#x27;w&#x27;</span>:<span class="number">0.02360</span>,<span class="string">&#x27;x&#x27;</span>:<span class="number">0.00150</span>,<span class="string">&#x27;y&#x27;</span>:<span class="number">0.01974</span>,<span class="string">&#x27;z&#x27;</span>:<span class="number">0.00074</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#obj:  #sec:</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cut</span>(<span class="params">obj, sec</span>):</span><br><span class="line">    <span class="keyword">return</span> [obj[i:i+sec] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(obj),sec)]</span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">In</span>(<span class="params">c</span>):</span><br><span class="line">    freq = &#123;i:<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> table&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(table)):</span><br><span class="line">        freq[table[i]] = c.count(table[i]) / <span class="built_in">len</span>(c)</span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> table:</span><br><span class="line">        index += freq[i] * freq[i]</span><br><span class="line">    <span class="keyword">return</span> index</span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">In_m</span>(<span class="params">c</span>):</span><br><span class="line">    freq = &#123;i:<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> table&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(table)):</span><br><span class="line">        freq[table[i]] = c.count(table[i]) / <span class="built_in">len</span>(c)</span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> table:</span><br><span class="line">        index += freq[i] * dic[i]</span><br><span class="line">    <span class="keyword">return</span> index</span><br><span class="line"></span><br><span class="line"><span class="comment">#part1 a*b=77</span></span><br><span class="line">t = c</span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">        temp = cut(t,i)</span><br><span class="line">        temp1 = [<span class="string">&quot;&quot;</span> <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(i)]</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(temp)-<span class="number">1</span>):</span><br><span class="line">            temp1[<span class="number">0</span>] += temp[k][<span class="number">0</span>]</span><br><span class="line">        index = In(<span class="string">&quot;&quot;</span>.join(temp1[<span class="number">0</span>]))</span><br><span class="line">        <span class="keyword">if</span>(index &gt; <span class="number">0.060</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;lenkey = &quot;</span>,i,<span class="string">&quot;   In = &quot;</span>,index)</span><br><span class="line"></span><br><span class="line"><span class="comment">#part2 k1k2</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">        <span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">            <span class="keyword">if</span> GCD(a,<span class="number">26</span>)!= <span class="number">1</span> :</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">                temp = cut(t,<span class="number">77</span>)</span><br><span class="line">                temp1 = [<span class="string">&quot;&quot;</span> <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">77</span>)]</span><br><span class="line">                <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(temp)-<span class="number">1</span>):</span><br><span class="line">                    temp1[i] += temp[k][i]</span><br><span class="line">                m = <span class="string">&#x27;&#x27;</span></span><br><span class="line">                <span class="keyword">for</span> x <span class="keyword">in</span> temp1[i]:</span><br><span class="line">                    m += table[((table.index(x)-b)*inverse(a,<span class="number">26</span>))%<span class="number">26</span>]</span><br><span class="line">                index = In_m(<span class="string">&quot;&quot;</span>.join(m))</span><br><span class="line">                <span class="comment">#print(index)</span></span><br><span class="line">                <span class="keyword">if</span>(index &gt; <span class="number">0.060</span>):</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;a = &quot;</span>,a,<span class="string">&quot;   b = &quot;</span>,b,<span class="string">&quot;,index = &quot;</span>,index)</span><br><span class="line"></span><br><span class="line"><span class="comment">#part3 md5</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span>):</span><br><span class="line">    m = <span class="string">&quot;&quot;</span></span><br><span class="line">    k1 = [<span class="number">9</span>,<span class="number">7</span>,<span class="number">25</span>,<span class="number">11</span>,<span class="number">11</span>,<span class="number">19</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">25</span>,<span class="number">9</span>,<span class="number">7</span>]</span><br><span class="line">    k2 = [<span class="number">25</span>,<span class="number">19</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">25</span>,<span class="number">20</span>,<span class="number">8</span>]</span><br><span class="line">    a = <span class="number">11</span></span><br><span class="line">    b = <span class="number">7</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(t)):</span><br><span class="line">        temp = ((table.index(t[i])-k2[i%b])*inverse(k1[i%a],<span class="number">26</span>))%<span class="number">26</span></span><br><span class="line">        m += table[temp]</span><br><span class="line"></span><br><span class="line">    Pad = <span class="string">b&#x27;How_Interesting_the_Cryptography_Is&#x27;</span></span><br><span class="line">    MD5 = <span class="string">&#x27;196cf7098c7ea6e3e4d03691fb9d4f58&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)-i):</span><br><span class="line">            key = m[j:j+i]</span><br><span class="line">            <span class="keyword">if</span> (md5(key.encode()+Pad).hexdigest() == MD5):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;moectf&#123;&#x27;</span>+key+<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line">                exit()</span><br></pre></td></tr></table></figure>
<p>flag</p>
<p><strong>moectf{pieceofchocolate}</strong></p>
<p></p>
<p><br><br></p>
]]></content>
      <categories>
        <category>crypto</category>
      </categories>
  </entry>
  <entry>
    <title>Crypto-</title>
    <url>/post/187210a7.html</url>
    <content><![CDATA[<p></p>
<span id="more"></span>
<h3 id="EdRSA"><a href="#EdRSA" class="headerlink" title="EdRSA"></a>EdRSA</h3><p></p>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sagemath</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">P, Q</span>):</span><br><span class="line">    (x1, y1) = P</span><br><span class="line">    (x2, y2) = Q</span><br><span class="line"></span><br><span class="line">    x3 = (x1*y2 + y1*x2) * inverse(<span class="number">1</span> + d*x1*x2*y1*y2, p) % p</span><br><span class="line">    y3 = (y1*y2 - a*x1*x2) * inverse(<span class="number">1</span> - d*x1*x2*y1*y2, p) % p</span><br><span class="line">    <span class="keyword">return</span> (x3, y3)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">x, P</span>):</span><br><span class="line">    Q = (<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span> x &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> x % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">            Q = add(Q, P)</span><br><span class="line">        P = add(P, P)</span><br><span class="line">        x = x &gt;&gt; <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> Q</span><br><span class="line"></span><br><span class="line">p = <span class="number">64141017538026690847507665744072764126523219720088055136531450296140542176327</span></span><br><span class="line">a = <span class="number">362</span></span><br><span class="line">d = <span class="number">7</span></span><br><span class="line">gx=bytes_to_long(flag)</span><br><span class="line">PR.&lt;y&gt;=PolynomialRing(Zmod(p))</span><br><span class="line">f=(d*gx^<span class="number">2</span>-<span class="number">1</span>)*y^<span class="number">2</span>+(<span class="number">1</span>-a*gx^<span class="number">2</span>)</span><br><span class="line">gy=<span class="built_in">int</span>(f.roots()[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> (a*gx^<span class="number">2</span>+gy^<span class="number">2</span>)%p==(<span class="number">1</span>+d*gx^<span class="number">2</span>*gy^<span class="number">2</span>)%p</span><br><span class="line"></span><br><span class="line">G=(gx,gy)</span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;eG = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(mul(e, G)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#eG = (602246821311345089174443402780402388933602410138142480089649941718527311147, 17625197557740535449294773567986004828160284887369041337984750097736030549853)</span></span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">assert</span> (a*gx^<span class="number">2</span>+gy^<span class="number">2</span>)%p==(<span class="number">1</span>+d*gx^<span class="number">2</span>*gy^<span class="number">2</span>)%p</span><br></pre></td></tr></table></figure>
<p></p>
<script type="math/tex; mode=display">
ax^2+y^2 = 1+dx^2y^2\quad(mod\;p)</script><p>(Twisted Edwards Curves)</p>
<p><a href="https://lazzzaro.github.io/2021/01/20/crypto-/"> | Lazzaro (lazzzaro.github.io)</a></p>
<p>EdcurveeeGflag</p>
<p></p>
<ul>
<li>sageorder()n</li>
<li>ent</li>
<li>G=t*(eG)</li>
</ul>
<p>EdcurvesageEdcurve</p>
<ul>
<li>Edcurve</li>
<li>s</li>
<li>G = s*(eG)</li>
<li>GEdcurveG</li>
</ul>
<p><strong>()</strong></p>
<p><strong></strong>(Montgomery)</p>
<p><a href="https://christianepeters.files.wordpress.com/2012/10/20080620-rennes.pdf">Edwards Curves (wordpress.com)</a></p>
<script type="math/tex; mode=display">
x' = \frac{1+y}{1-y}</script><script type="math/tex; mode=display">
y'=\frac{1+y}{x(1-y)}</script><script type="math/tex; mode=display">
B=\frac{4}{a-d}</script><script type="math/tex; mode=display">
A=\frac{2(a+d)}{a-d}</script><p>Edcurve</p>
<script type="math/tex; mode=display">
B(y')^2 = (x')^3+A(x')^2+(x')\quad(mod\;p)</script><p><strong></strong>(Weierstrass)</p>
<p><a href="https://en.wikipedia.org/wiki/Montgomery_curve">Montgomery curve - Wikipedia</a></p>
<script type="math/tex; mode=display">
x'' = \frac{3x'+A}{3B}</script><script type="math/tex; mode=display">
y''=\frac{y'}{B}</script><script type="math/tex; mode=display">
a=\frac{3-A^2}{3B^2}</script><script type="math/tex; mode=display">
b=\frac{2A^3-9A}{27B^3}</script><p></p>
<script type="math/tex; mode=display">
(y'')^2 = (x'')^3+a(x'')+b\quad(mod\;p)</script><p>GEdcurveflag</p>
<p>exp.ipynb</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p = <span class="number">64141017538026690847507665744072764126523219720088055136531450296140542176327</span></span><br><span class="line">a = <span class="number">362</span></span><br><span class="line">d = <span class="number">7</span></span><br><span class="line">c = <span class="number">1</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">P, Q</span>):</span><br><span class="line">    (x1, y1) = P</span><br><span class="line">    (x2, y2) = Q</span><br><span class="line"></span><br><span class="line">    x3 = (x1*y2 + y1*x2) * inverse(<span class="number">1</span> + d*x1*x2*y1*y2, p) % p</span><br><span class="line">    y3 = (y1*y2 - a*x1*x2) * inverse(<span class="number">1</span> - d*x1*x2*y1*y2, p) % p</span><br><span class="line">    <span class="keyword">return</span> (x3, y3)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">x, P</span>):</span><br><span class="line">    Q = (<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span> x &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> x % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">            Q = add(Q, P)</span><br><span class="line">        P = add(P, P)</span><br><span class="line">        x = x &gt;&gt; <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> Q</span><br><span class="line"></span><br><span class="line">P.&lt;z&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">aa = a</span><br><span class="line">dd = (d*c^<span class="number">4</span>)%p</span><br><span class="line">J = (<span class="number">2</span>*(aa+dd)*inverse(aa-dd,p))%p</span><br><span class="line">K = (<span class="number">4</span>*inverse(aa-dd,p))%p</span><br><span class="line">A = ((<span class="number">3</span>-J^<span class="number">2</span>)*inverse(<span class="number">3</span>*K^<span class="number">2</span>,p))%p</span><br><span class="line">B = ((<span class="number">2</span>*J^<span class="number">3</span>-<span class="number">9</span>*J)*inverse(<span class="number">27</span>*K^<span class="number">3</span>,p))%p</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span>  P(z^<span class="number">3</span>+A*z+B).roots():</span><br><span class="line">    alpha = <span class="built_in">int</span>(i[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> P(z^<span class="number">2</span>-(<span class="number">3</span>*alpha^<span class="number">2</span>+A)).roots():</span><br><span class="line">        s = <span class="built_in">int</span>(j[<span class="number">0</span>])</span><br><span class="line">        s = inverse(s, p)</span><br><span class="line">        <span class="keyword">if</span> J==alpha*<span class="number">3</span>*s%p:</span><br><span class="line">            Alpha = alpha</span><br><span class="line">            S = s</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">twist_to_weier</span>(<span class="params">x,y</span>):</span><br><span class="line">    v = x*inverse(c,p)%p</span><br><span class="line">    w = y*inverse(c,p)%p</span><br><span class="line">    <span class="keyword">assert</span> (aa*v^<span class="number">2</span>+w^<span class="number">2</span>)%p==(<span class="number">1</span>+dd*v^<span class="number">2</span>*w^<span class="number">2</span>)%p</span><br><span class="line">    s = (<span class="number">1</span>+w)*inverse(<span class="number">1</span>-w,p)%p</span><br><span class="line">    t = s*inverse(v,p)%p</span><br><span class="line">    <span class="keyword">assert</span> (K*t^<span class="number">2</span>)%p==(s^<span class="number">3</span>+J*s^<span class="number">2</span>+s)%p</span><br><span class="line">    xW = (<span class="number">3</span>*s+J) * inverse(<span class="number">3</span>*K, p) % p</span><br><span class="line">    yW = t * inverse(K, p) % p</span><br><span class="line">    <span class="keyword">assert</span> yW^<span class="number">2</span> % p == (xW^<span class="number">3</span>+A*xW+B) % p</span><br><span class="line">    <span class="keyword">return</span> (xW,yW)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">weier_to_twist</span>(<span class="params">x,y</span>):</span><br><span class="line">    xM=S*(x-Alpha)%p</span><br><span class="line">    yM=S*y%p</span><br><span class="line">    <span class="keyword">assert</span> (K*yM^<span class="number">2</span>)%p==(xM^<span class="number">3</span>+J*xM^<span class="number">2</span>+xM)%p</span><br><span class="line">    xe = xM*inverse(yM,p)%p</span><br><span class="line">    ye = (xM-<span class="number">1</span>)*inverse(xM+<span class="number">1</span>,p)%p</span><br><span class="line">    <span class="keyword">assert</span> (aa*xe^<span class="number">2</span>+ye^<span class="number">2</span>)%p==(<span class="number">1</span>+dd*xe^<span class="number">2</span>*ye^<span class="number">2</span>)%p</span><br><span class="line">    xq = xe*c%p</span><br><span class="line">    yq = ye*c%p</span><br><span class="line">    <span class="keyword">assert</span> (a*xq^<span class="number">2</span>+yq^<span class="number">2</span>)%p==c^<span class="number">2</span>*(<span class="number">1</span>+d*xq^<span class="number">2</span>*yq^<span class="number">2</span>)%p</span><br><span class="line">    <span class="keyword">return</span> (xq,yq)</span><br><span class="line"> </span><br><span class="line">E = EllipticCurve(GF(p), [A, B])</span><br><span class="line">order = E.order()</span><br><span class="line">eG = (<span class="number">602246821311345089174443402780402388933602410138142480089649941718527311147</span>, <span class="number">17625197557740535449294773567986004828160284887369041337984750097736030549853</span>)</span><br><span class="line">eG = twist_to_weier(<span class="number">602246821311345089174443402780402388933602410138142480089649941718527311147</span>, <span class="number">17625197557740535449294773567986004828160284887369041337984750097736030549853</span>)</span><br><span class="line"><span class="comment">#print(eG)</span></span><br><span class="line">eG = E(eG)</span><br><span class="line">t = inverse(e,order)</span><br><span class="line">G = t*eG</span><br><span class="line"><span class="comment">#print(G)</span></span><br><span class="line"><span class="comment">#(36261107889873779109466209751550197981810668464592052789439409682189116521876 , 28177359502202272008748289223947413248814289299639597442379536527477393059697)</span></span><br><span class="line">G = weier_to_twist(<span class="number">36261107889873779109466209751550197981810668464592052789439409682189116521876</span> , <span class="number">28177359502202272008748289223947413248814289299639597442379536527477393059697</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(G[<span class="number">0</span>])))</span><br></pre></td></tr></table></figure>
<p>flag</p>
<p><strong>DASCTF{y0u_kn0w_edcurv3_w3LL!!}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="EC-Party-I"><a href="#EC-Party-I" class="headerlink" title="EC_Party-I"></a>EC_Party-I</h3><p></p>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">5</span>]==<span class="string">b&#x27;flag&#123;&#x27;</span> <span class="keyword">and</span> flag[-<span class="number">1</span>:]==<span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line">flag = flag[<span class="number">5</span>:-<span class="number">1</span>]</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rabin</span>(<span class="params">m</span>):</span><br><span class="line">    m = m+os.urandom(<span class="number">32</span>)</span><br><span class="line">    p = getPrime(<span class="number">384</span>)</span><br><span class="line">    q = getPrime(<span class="number">384</span>)</span><br><span class="line">    Fp = GF(p)</span><br><span class="line">    Fq = GF(q)</span><br><span class="line">    n = p*q</span><br><span class="line">    e = <span class="number">2</span></span><br><span class="line">    a = random.randint(<span class="number">0</span>, p-<span class="number">1</span>)</span><br><span class="line">    b = random.randint(<span class="number">0</span>, p-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    Ep = EllipticCurve(Zmod(p), [a, b])</span><br><span class="line">    Eq = EllipticCurve(Zmod(q), [a, b])</span><br><span class="line">    En = EllipticCurve(Zmod(n), [a, b])</span><br><span class="line">    ord_p = Ep.order()</span><br><span class="line">    ord_q = Eq.order()</span><br><span class="line"></span><br><span class="line">    xm = bytes_to_long(m)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            Gp = Ep.lift_x(Fp(xm))</span><br><span class="line">            Gq = Eq.lift_x(Fq(xm))</span><br><span class="line">            ym = crt([<span class="built_in">int</span>(Gp.xy()[<span class="number">1</span>]),<span class="built_in">int</span>(Gq.xy()[<span class="number">1</span>])],[p,q])</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> :</span><br><span class="line">            xm += <span class="number">1</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    M = En((xm,ym))</span><br><span class="line">    C = e*M</span><br><span class="line">    pk = [a, b, n, C]</span><br><span class="line">    leak = ord_p*ord_q</span><br><span class="line">    <span class="keyword">return</span> pk, leak</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(rabin(flag))</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">[138681122158674534796479818810828100269024674330030901179877002756402543027343312824423418859769980312713625658733, 4989541340743108588577899263469059346332852532421276369038720203527706762720292559751463880310075002363945271507040, 762981334990685089884160169295988791471426441106522959345412318178660817286272606245181160960267776171409174142433857335352402619564485470678152764621235882232914864951345067231483720755544188962798600739631026707678945887174897543, (19591102741441427006422487362547101973286873135330241799412389205281057650306427438686318050682578531286702107543065985988634367524715153650482199099194389191525898366546842016339136884277515665890331906261550080128989942048438965, 728465071542637655949094554469510039681717865811604984652385614821789556549826602178972137405550902004858456181137844771163710123158955524137202319902378503104952106036911634918189377295743976966073577013775200078470659428344462772), 762981334990685089884160169295988791471426441106522959345445792076415993922016249232021560266153453470937452118572318136597282436269660557904217923887981072203978473274822142705255987334355747997513083011853917049784914749699536828]</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p></p>
<ul>
<li>flagM</li>
<li>pqn=p*q</li>
<li>abEpEqEn</li>
<li>MEpEq</li>
<li>leak=order(Ep)*order(Eq)</li>
</ul>
<p>nleakn()</p>
<p><a href="https://github.com/maple3142/My-CTF-Challenges/blob/master/HITCON CTF 2022/Chimera/README.md">My-CTF-Challenges/HITCON CTF 2022/Chimera/README.md at master  maple3142/My-CTF-Challenges (github.com)</a></p>
<p>leak</p>
<p><img src="/post/187210a7/image-20230930114139546.png" alt="image-20230930114139546"></p>
<p>leak=order(Ep)*order(Eq)leakEnEpEqO()leakCEpEqnsagekpn()</p>
<p><img src="/post/187210a7/image-20230930114719034.png" alt="image-20230930114719034"></p>
<p>kpngcdpn</p>
<p><a href="https://en.wikipedia.org/wiki/Lenstra_elliptic-curve_factorization">Lenstra elliptic-curve factorization</a>.</p>
<p>pq(2M)</p>
<p>122</p>
<p>2</p>
<p>2EqEp(M(x1,y1),2M(x2,y2))</p>
<script type="math/tex; mode=display">
y^2=x^3+ax+b\quad(mod\;p)</script><script type="math/tex; mode=display">
x_2=k^22x_1\quad(mod\;p)</script><script type="math/tex; mode=display">
k = \frac{3x_1^2 + a}{2y_1}\quad(mod\;p)</script><p></p>
<script type="math/tex; mode=display">
\frac{(3x_1^2+a)^2}{(2y_1)^2} - 2x_1 - x_2 = 0\quad(mod\;p)</script><p></p>
<script type="math/tex; mode=display">
(3x_1^2+a)^2 - 2x_1*4(x_1^3+ax_1+b) - x_2*4(x_1^3+ax_1+b) = 0\quad(mod\;p)</script><p>x1ppqflag</p>
<p>exp.ipynb</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">2</span></span><br><span class="line">a,b,n,C,leak = [<span class="number">138681122158674534796479818810828100269024674330030901179877002756402543027343312824423418859769980312713625658733</span>, <span class="number">4989541340743108588577899263469059346332852532421276369038720203527706762720292559751463880310075002363945271507040</span>, <span class="number">762981334990685089884160169295988791471426441106522959345412318178660817286272606245181160960267776171409174142433857335352402619564485470678152764621235882232914864951345067231483720755544188962798600739631026707678945887174897543</span>, (<span class="number">19591102741441427006422487362547101973286873135330241799412389205281057650306427438686318050682578531286702107543065985988634367524715153650482199099194389191525898366546842016339136884277515665890331906261550080128989942048438965</span>, <span class="number">728465071542637655949094554469510039681717865811604984652385614821789556549826602178972137405550902004858456181137844771163710123158955524137202319902378503104952106036911634918189377295743976966073577013775200078470659428344462772</span>), <span class="number">762981334990685089884160169295988791471426441106522959345445792076415993922016249232021560266153453470937452118572318136597282436269660557904217923887981072203978473274822142705255987334355747997513083011853917049784914749699536828</span>]</span><br><span class="line">E = EllipticCurve(Zmod(n),[a,b])</span><br><span class="line">C = E(C)</span><br><span class="line"></span><br><span class="line"><span class="comment">#factordb</span></span><br><span class="line"><span class="comment">#2^2,3^4,13,199,307,647,157259,297617,8452217,411927661365999433,1157516701716180046249,1338688620929080207819,31226697952255326809332037614333,581208663471376553417319728009366348095695079579751839149645355600351572890241761173016580183555305805091712621</span></span><br><span class="line">leak_fac = [<span class="number">2</span>,<span class="number">3</span>,<span class="number">13</span>,<span class="number">199</span>,<span class="number">307</span>,<span class="number">647</span>,<span class="number">157259</span>,<span class="number">297617</span>,<span class="number">8452217</span>,<span class="number">411927661365999433</span>,<span class="number">1157516701716180046249</span>,<span class="number">1338688620929080207819</span>,<span class="number">31226697952255326809332037614333</span>,<span class="number">581208663471376553417319728009366348095695079579751839149645355600351572890241761173016580183555305805091712621</span>]</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">for i in leak_fac:</span></span><br><span class="line"><span class="string">    temp = leak // i * C</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">kp = <span class="number">422522588482185975632147929645103216180089543839772868484032620301855259044079430236142637458472152787337779544279109415705783248825091269039840404202119229567311048216047356951966653331710686649176005328509793328313264251738045723</span></span><br><span class="line">p = GCD(kp,n)</span><br><span class="line">q = n//p</span><br><span class="line"></span><br><span class="line">Ep = EllipticCurve(Zmod(p), [a, b])</span><br><span class="line">Eq = EllipticCurve(Zmod(q), [a, b])</span><br><span class="line">ord_p = Ep.order()</span><br><span class="line">ord_q = Eq.order()</span><br><span class="line"><span class="comment">#print(ord_p)</span></span><br><span class="line"><span class="comment">#print(ord_q)</span></span><br><span class="line"></span><br><span class="line">dq = inverse(e,ord_q)</span><br><span class="line">Q = dq*Eq(C)</span><br><span class="line">mq = <span class="built_in">int</span>(Q[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(Ep(C))</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(GF(p))</span><br><span class="line">f = (<span class="number">3</span>*(x**<span class="number">2</span>)+a)**<span class="number">2</span> - <span class="number">2</span>*x*(<span class="number">4</span>*(x**<span class="number">3</span>+a*x+b)) - <span class="built_in">int</span>(C[<span class="number">0</span>])*<span class="number">4</span>*(x**<span class="number">3</span>+a*x+b)</span><br><span class="line">res = f.roots()</span><br><span class="line"><span class="comment">#print(res)</span></span><br><span class="line"></span><br><span class="line">n = [p,q]</span><br><span class="line"><span class="keyword">if</span>(res):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">        c = [<span class="built_in">int</span>(i[<span class="number">0</span>]),mq]</span><br><span class="line">        m = crt(c,n)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flag</p>
<p><strong>flag{3crab1n_s0unds_go0d}</strong></p>
<p><br></p>
<p><br></p>
]]></content>
      <categories>
        <category>crypto</category>
      </categories>
  </entry>
  <entry>
    <title>NSSCTF-2nd-wp-crypto</title>
    <url>/post/39588.html</url>
    <content><![CDATA[<p>crypto</p>
<span id="more"></span>
<h2 id="EzRSA"><a href="#EzRSA" class="headerlink" title="EzRSA"></a>EzRSA</h2><p>:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">assert</span> m.bit_length()&lt;<span class="number">200</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">kbits = <span class="number">103</span></span><br><span class="line">m = (m &gt;&gt; kbits) &lt;&lt; kbits</span><br><span class="line">Mod = getPrime(<span class="number">1024</span>)</span><br><span class="line">hint1 = (<span class="number">2021</span>-<span class="number">2023</span>*m) % Mod</span><br><span class="line">hint2 = <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">2023</span>, Mod)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;hint1 =&#x27;</span>,hint1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;hint2 =&#x27;</span>,hint2)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = ...</span></span><br><span class="line"><span class="string">c = ...</span></span><br><span class="line"><span class="string">hint1 = ...</span></span><br><span class="line"><span class="string">hint2 = ...</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>:</p>
<ul>
<li>m.bit_length()&lt;200 , </li>
<li>kbits = 103 , m = (m &gt;&gt; kbits) &lt;&lt; kbits , </li>
<li>hint1 = (2021-2023*m) % Mod</li>
<li>hint2 = pow(2, 2023, Mod)</li>
</ul>
<p>coppersmith , hint2</p>
<script type="math/tex; mode=display">
hint2  \equiv  2^{2023}  mod(Mod)</script><p>,</p>
<script type="math/tex; mode=display">
2^{2023} - hint2 = k*Mod</script><p>Modk,k*Modhint1mm</p>
<p><br></p>
<p>exp.ipynb:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = ...</span><br><span class="line">c = ...</span><br><span class="line">hint1 = ...</span><br><span class="line">hint2 = ...</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">kM = <span class="number">2</span>**<span class="number">2023</span>-hint2</span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(kM))</span><br><span class="line">f = <span class="number">2023</span>*x + hint1 - <span class="number">2021</span></span><br><span class="line">f = f.monic()</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^<span class="number">200</span>,beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="keyword">if</span> roots:</span><br><span class="line">    mhigh = roots[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">mhigh = <span class="number">1746716778150027565782467891299010283212636160</span></span><br><span class="line">PR.&lt;y&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = (mhigh + y)^<span class="number">3</span> - c</span><br><span class="line">f = f.monic()</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^<span class="number">104</span>,beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="keyword">if</span> roots:</span><br><span class="line">    m = mhigh + roots[<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">print</span>(m)</span><br><span class="line">m = <span class="number">1746716778150037336346788439252154990602710653</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">NSSCTF{Rea1_Si9n3n}</font>

<p><br></p>
<p>(funnyencrypt)</p>
<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="FunnyEncrypt"><a href="#FunnyEncrypt" class="headerlink" title="FunnyEncrypt"></a>FunnyEncrypt</h2><p>:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">    ,    .   , ,  .        ,       .       ,     .              ,        .     ,    ,     ,          .</span><br><span class="line">       - &#x27;       , ,  .   &#x27;       :      .      .   .    .  , &#x27;  .</span><br><span class="line">      .     ,     ,     .       ,      . , ,   .   ,      ,         .     ,     ,       .</span><br><span class="line">            .    , &#x27;  ,  &#x27;    .  &#x27;  ,       .</span><br><span class="line">           .        .                    ,         .</span><br><span class="line">  ,     .   :&#123;_____&#x27;___&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;_____&#x27;___&#125;</span><br></pre></td></tr></table></figure>
<p>nssctfquipqiup</p>
<p>exp.py:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    ,    .   , ,  .        ,       .       ,     .              ,        .     ,    ,     ,          .</span></span><br><span class="line"><span class="string">       - &#x27;       , ,  .   &#x27;       :      .      .   .    .  , &#x27;  .</span></span><br><span class="line"><span class="string">      .     ,     ,     .       ,      . , ,   .   ,      ,         .     ,     ,       .</span></span><br><span class="line"><span class="string">            .    , &#x27;  ,  &#x27;    .  &#x27;  ,       .</span></span><br><span class="line"><span class="string">           .        .                    ,         .</span></span><br><span class="line"><span class="string">  ,     .   :&#123;_____&#x27;___&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">table = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz&#123;&#125; _-,.&#x27;:&quot;</span></span><br><span class="line">list1 = [<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>] </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(list1))</span><br><span class="line"></span><br><span class="line">cfinal = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">    <span class="keyword">if</span>(c[i] <span class="keyword">not</span> <span class="keyword">in</span> table):</span><br><span class="line">        <span class="keyword">if</span>(c[i] == <span class="string">&quot;\n&quot;</span>):</span><br><span class="line">            cfinal.append(c[i])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ind = list1.index(c[i])</span><br><span class="line">            cfinal.append(table[ind])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        cfinal.append(c[i])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(cfinal))</span><br><span class="line"></span><br><span class="line"><span class="comment">#quipqiup</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">six</span></span><br><span class="line"><span class="string">in the flood of darkness, hope is the light. it brings comfort, faith, and confidence. it gives us guidance when we are lost, and gives support when we are afraid. and the moment we give up hope, we give up our lives. the world we live in is disintegrating into a place of malice and hatred, where we need hope and find it harder. in this world of fear, hope to find better, but easier said than done, the more meaningful life of faith will make life meaningful.</span></span><br><span class="line"><span class="string">sometimes we think of dreams as fantasies - it&#x27;s easy to do when you have money, rent, and work. but you can&#x27;t prepare yourself </span></span><br><span class="line"><span class="string">and jump off the cliff: you should grow your wings first. a little bit toward the dream. step by step. take a step forward. after all, it&#x27;s your mission.</span></span><br><span class="line"><span class="string">keep faith and hope for the future. make your most sincere dreams, and when the opportunities come, they will fight for them. it may take a season or more, but the ending will not change. ambition, best, become a reality. an uncertain future, only one step at a time, the hope can realize the dream of the highest. we must treasure the dream, to protect it a season, let it in the heart quietly germinal.</span></span><br><span class="line"><span class="string">only when you understand the true meaning of life can you live truly. bittersweet as life is, it&#x27;s still wonderful, and it&#x27;s fascinating even in tragedy. if you&#x27;re just alive, try harder and try to live wonderfully.</span></span><br><span class="line"><span class="string">i believe there is a person who brings sunshine into your life. that person may have enough to spread around. but if you really </span></span><br><span class="line"><span class="string">have to wait for someone to bring you the sun and give you a good feeling, then you may have to wait a long time.</span></span><br><span class="line"><span class="string">in a word,i hope you will like cryptography.this is your flag:nssctf&#123;crypto_is_so_interesting_why_don&#x27;t_you_join_us&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">NSSCTF{crypto_is_so_interesting_why_don't_you_join_us}</font>

<p>()</p>
<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="Math"><a href="#Math" class="headerlink" title="Math"></a>Math</h2><p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">length = <span class="built_in">len</span>(flag)</span><br><span class="line">flag1 = flag[:length//<span class="number">2</span>]</span><br><span class="line">flag2 = flag[length//<span class="number">2</span>:]</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">m1 = bytes_to_long(flag1)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line"></span><br><span class="line">p1 = gmpy2.invert(p,q)</span><br><span class="line">q1 = gmpy2.invert(q,p)</span><br><span class="line">c = <span class="built_in">pow</span>(m1,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p1=&quot;</span>,p1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;q1=&quot;</span>,q1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;phi=&quot;</span>,phi)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">p1= ...</span></span><br><span class="line"><span class="string">q1= ...</span></span><br><span class="line"><span class="string">c= ...</span></span><br><span class="line"><span class="string">phi= ...</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">m2 = bytes_to_long(flag2)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">c = <span class="built_in">pow</span>(m2, e, n)</span><br><span class="line">hint = <span class="built_in">pow</span>(<span class="number">2023</span> * p + <span class="number">114514</span>, q, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;hint=&quot;</span>,hint)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n= ...</span></span><br><span class="line"><span class="string">c= ...</span></span><br><span class="line"><span class="string">hint= ...</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>flag</p>
<ul>
<li></li>
</ul>
<p>pqqphitconctf 2019 quals<a href="[AiDai|HITCON CTF 2019 Quals-Writeup (aidaip.github.io"></a>](<a href="https://aidaip.github.io/ctf/2019/10/16/HITCON-CTF-2019-Quals-Writeup.html">https://aidaip.github.io/ctf/2019/10/16/HITCON-CTF-2019-Quals-Writeup.html</a>))</p>
<ul>
<li></li>
</ul>
<p></p>
<script type="math/tex; mode=display">
hint \equiv (2023*p + 114514)^q  (mod n)</script><p>pqngcd</p>
<script type="math/tex; mode=display">
hint \equiv (2023*p + 114514)^q  (mod p)</script><script type="math/tex; mode=display">
hint \equiv (2023*p + 114514)^q  (mod q)</script><p>:</p>
<script type="math/tex; mode=display">
hint \equiv 2023*p + 114514  (mod q)</script><p>pqngcd</p>
<p>qmod p</p>
<script type="math/tex; mode=display">
hint \equiv 114514^q  (mod p)</script><p>()</p>
<script type="math/tex; mode=display">
a \equiv a^p  (mod p)</script><p> $114514^q$ a</p>
<script type="math/tex; mode=display">
(114514^q) \equiv (114514^q)^p \equiv 114514^n (mod p)</script><p></p>
<script type="math/tex; mode=display">
hint \equiv 114514^n  (mod p)</script><script type="math/tex; mode=display">
hint = 114514^n + k*p</script><p>$(hint - 114514^n)$ngcdpRSA</p>
<p><br></p>
<p>exp.py:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">a, b</span>):</span><br><span class="line">  <span class="keyword">while</span>(b): </span><br><span class="line">    a,b = b, a % b </span><br><span class="line">  <span class="keyword">return</span> a </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mysqrt</span>(<span class="params">d</span>):</span><br><span class="line">  st = <span class="number">1</span></span><br><span class="line">  en = <span class="number">10</span>**<span class="number">1300</span></span><br><span class="line">  <span class="keyword">while</span> st&lt;=en:</span><br><span class="line">    mid = (st+en)//<span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> mid*mid == d: <span class="keyword">return</span> mid</span><br><span class="line">    <span class="keyword">if</span> mid*mid &lt; d: st=mid+<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>: en=mid-<span class="number">1</span></span><br><span class="line">  <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a1, a2</span>):</span><br><span class="line">    x1, x2 = <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    y1, y2 = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> a2:</span><br><span class="line">        q = a1 // a2</span><br><span class="line">        a1, a2 = a2, a1 - q * a2</span><br><span class="line">        x1, x2 = x2, x1 - q * x2</span><br><span class="line">        y1, y2 = y2, y1 - q * y2</span><br><span class="line">    <span class="keyword">return</span> (x1, y1, a1)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line">ipmq= ...</span><br><span class="line">iqmp= ...</span><br><span class="line">phi= ...</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">enc = ...</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">gg = gcd(iqmp-<span class="number">1</span>,ipmq-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">c = phi // gg</span><br><span class="line">a = (ipmq-<span class="number">1</span>)//gg</span><br><span class="line">b = (iqmp-<span class="number">1</span>)//gg</span><br><span class="line"><span class="comment"># p*a + q*b = c</span></span><br><span class="line">pmod = inverse(a, b)*c%b</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>):</span><br><span class="line">    p = pmod + j*b</span><br><span class="line">    <span class="keyword">if</span> p &gt; (<span class="number">1</span>&lt;&lt;<span class="number">1024</span>): <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> isPrime(p): <span class="keyword">continue</span></span><br><span class="line">    q = (c-p*a)//b</span><br><span class="line">    <span class="keyword">assert</span>(p*a+q*b==c)</span><br><span class="line">    <span class="keyword">if</span> (iqmp*q-<span class="number">1</span>)%p == <span class="number">0</span> <span class="keyword">and</span> (ipmq*p-<span class="number">1</span>)%q == <span class="number">0</span>:</span><br><span class="line">        M = <span class="built_in">pow</span>(enc,d,p*q)</span><br><span class="line">        flag += <span class="built_in">str</span>(long_to_bytes(M))[<span class="number">2</span>:-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2</span></span><br><span class="line">n= ...</span><br><span class="line">c= ...</span><br><span class="line">hint= ...</span><br><span class="line">h2 = <span class="built_in">pow</span>(<span class="number">114514</span>,n,n)</span><br><span class="line">p = GCD(n,hint-h2)</span><br><span class="line">q = n//p</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">flag += <span class="built_in">str</span>(long_to_bytes(m))[<span class="number">2</span>:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">NSSCTF{e713afa4-fcd8-419f-a1a6-959449b4df5a}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="LatticeLCG"><a href="#LatticeLCG" class="headerlink" title="LatticeLCG"></a>LatticeLCG</h2><p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;NSSCTF&#123;******************************&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">a = getPrime(<span class="number">512</span>)</span><br><span class="line">seed = getPrime(<span class="number">512</span>)</span><br><span class="line">b = bytes_to_long(flag)</span><br><span class="line">n = getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">e1 = <span class="number">2333</span></span><br><span class="line">e2 = <span class="number">23333</span></span><br><span class="line">c1 = <span class="built_in">pow</span>(a,e1,n)</span><br><span class="line">c2 = <span class="built_in">pow</span>(a,e2,n)</span><br><span class="line"></span><br><span class="line">output = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    seed = (a*seed+b)%n</span><br><span class="line">    output.append(seed)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c1 = &quot;</span>,c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c2 = &quot;</span>,c2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;output1 = &quot;</span>,output[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;output2 = &quot;</span>,output[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = [getPrime(<span class="number">128</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)]</span><br><span class="line">out = []</span><br><span class="line">m = getPrime(<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> e:</span><br><span class="line">    out.append(<span class="built_in">pow</span>(m,i,n))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e=&quot;</span>,e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;out=&quot;</span>,out)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">c1 = ...</span></span><br><span class="line"><span class="string">c2 = ...</span></span><br><span class="line"><span class="string">output1 = ...</span></span><br><span class="line"><span class="string">output2 = ...</span></span><br><span class="line"><span class="string">e= []</span></span><br><span class="line"><span class="string">out= []</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>ctfer</p>
<p></p>
<ul>
<li></li>
<li>LCG</li>
<li>Lattice</li>
</ul>
<p>flagLCGbLCGLCGbanna</p>
<ol>
<li>Latticen</li>
<li>a</li>
<li>LCGbflag</li>
</ol>
<p><strong>n</strong> <strong>n</strong></p>
<p>64bitm20128bitRSA<strong></strong> <strong></strong>crypto()</p>
<p>mnnn</p>
<p>20</p>
<script type="math/tex; mode=display">
out1 \equiv m^{e1} \; (mod\;  n)</script><script type="math/tex; mode=display">
out2 \equiv m^{e2} \; (mod\;  n)</script><script type="math/tex; mode=display">
out3 \equiv m^{e3} \; (mod\;  n)</script><p>e1e2ab</p>
<script type="math/tex; mode=display">
a*e1+b*e2 = 1</script><p></p>
<script type="math/tex; mode=display">
out1^{a}*out2^{b}\equiv m^{a*e1+b*e2} \equiv m \quad (mod \;n)</script><p>2313</p>
<script type="math/tex; mode=display">
out1^{a}*out2^{b} \equiv m \quad (mod \;n)\qquad--1</script><script type="math/tex; mode=display">
out2^{c}*out3^{d} \equiv m \quad (mod \;n)\qquad--2</script><script type="math/tex; mode=display">
out1^{f}*out3^{g} \equiv m \quad (mod \;n)\qquad--3</script><p>1223</p>
<script type="math/tex; mode=display">
out1^{a}*out2^{b} -out2^{c}*out3^{d}\equiv 0 \quad (mod \;n)</script><script type="math/tex; mode=display">
out1^{f}*out3^{g} -out2^{c}*out3^{d}\equiv 0 \quad (mod \;n)</script><p>(a,b,c,d,f,g)gcdn</p>
<p><strong>ab()</strong></p>
<p><strong></strong>LatticeLLL20ab</p>
<p>20ea1a2a3a20</p>
<script type="math/tex; mode=display">
a1*e1+a2*e2+a3*e3+...a20*e20 = 1</script><p></p>
<script type="math/tex; mode=display">
\left[\begin{matrix}
a1 & a2 & a3 ... & a20
\end{matrix}\right] 

*
\left[\begin{matrix}
e1 & 1 & 0 & 0 ... & 0\\
e2 & 0 & 1 & 0 ... & 0\\
e3 & 0 & 0 & 1 ... & 0\\
...\\
e20 & 0 & 0 & 0 ... & 1\\
\end{matrix}\right]

=

\left[\begin{matrix}
1 & a1 & a2 ... & a20
\end{matrix}\right]</script><p></p>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">[ <span class="number">45</span> -<span class="number">58</span>   <span class="number">5</span> -<span class="number">16</span>  <span class="number">12</span>  -<span class="number">7</span> -<span class="number">27</span>  <span class="number">19</span>   <span class="number">6</span>  <span class="number">14</span>  <span class="number">29</span> -<span class="number">23</span> -<span class="number">36</span>  <span class="number">44</span> -<span class="number">15</span>   <span class="number">1</span>   <span class="number">8</span>  <span class="number">14</span>  -<span class="number">7</span>  <span class="number">11</span>  -<span class="number">9</span>]</span><br><span class="line">[-<span class="number">14</span> -<span class="number">27</span>  <span class="number">20</span>   <span class="number">6</span> -<span class="number">40</span>  <span class="number">20</span> -<span class="number">34</span>  -<span class="number">2</span> -<span class="number">16</span>  <span class="number">51</span>  <span class="number">35</span> -<span class="number">23</span> -<span class="number">51</span>  <span class="number">13</span>   <span class="number">3</span> -<span class="number">21</span>   <span class="number">0</span>  <span class="number">17</span>  <span class="number">11</span>  -<span class="number">7</span>   <span class="number">1</span>]</span><br><span class="line">[ <span class="number">15</span> -<span class="number">36</span> -<span class="number">21</span> -<span class="number">13</span>   <span class="number">6</span>  -<span class="number">7</span>  -<span class="number">1</span> -<span class="number">59</span> -<span class="number">23</span>  <span class="number">42</span> -<span class="number">33</span>  <span class="number">15</span> -<span class="number">30</span>  -<span class="number">4</span>  <span class="number">39</span>  <span class="number">26</span>  <span class="number">41</span>   <span class="number">1</span>  <span class="number">19</span>  <span class="number">10</span>   <span class="number">9</span>]</span><br><span class="line">[-<span class="number">23</span>   <span class="number">4</span>  <span class="number">49</span> -<span class="number">19</span>  <span class="number">22</span>  -<span class="number">9</span>  <span class="number">24</span> -<span class="number">20</span> -<span class="number">20</span>   <span class="number">3</span> -<span class="number">24</span>   <span class="number">4</span> -<span class="number">43</span> -<span class="number">86</span>  <span class="number">40</span>  <span class="number">44</span>  -<span class="number">1</span>  -<span class="number">1</span>  <span class="number">26</span>  <span class="number">25</span>   <span class="number">1</span>]</span><br><span class="line">[ <span class="number">72</span>  <span class="number">15</span> -<span class="number">11</span> -<span class="number">19</span>  <span class="number">26</span> -<span class="number">31</span> -<span class="number">56</span> -<span class="number">25</span>   <span class="number">5</span>  <span class="number">33</span> -<span class="number">27</span> -<span class="number">23</span>  <span class="number">12</span>  <span class="number">22</span>  <span class="number">11</span>  -<span class="number">1</span>  <span class="number">21</span> -<span class="number">17</span>  <span class="number">51</span> -<span class="number">31</span>   <span class="number">9</span>]</span><br><span class="line">[-<span class="number">35</span> -<span class="number">73</span>  -<span class="number">8</span>  <span class="number">19</span> -<span class="number">29</span>  <span class="number">23</span>  -<span class="number">3</span>  <span class="number">20</span> -<span class="number">10</span>  <span class="number">18</span>  <span class="number">46</span>  <span class="number">29</span>  -<span class="number">9</span>  <span class="number">69</span> -<span class="number">30</span>   <span class="number">9</span> -<span class="number">64</span>  <span class="number">13</span>  <span class="number">10</span> -<span class="number">26</span>   <span class="number">3</span>]</span><br><span class="line">[ <span class="number">20</span>  <span class="number">46</span>  <span class="number">12</span>  -<span class="number">3</span>  <span class="number">28</span>  -<span class="number">1</span> -<span class="number">68</span>  <span class="number">15</span>   <span class="number">3</span> -<span class="number">21</span> -<span class="number">48</span> -<span class="number">20</span>  <span class="number">43</span>  <span class="number">54</span>   <span class="number">9</span>  <span class="number">14</span>  -<span class="number">5</span>   <span class="number">0</span> -<span class="number">44</span> -<span class="number">24</span>   <span class="number">8</span>]</span><br><span class="line">[ <span class="number">49</span>   <span class="number">0</span> -<span class="number">10</span>   <span class="number">0</span> -<span class="number">46</span> -<span class="number">47</span>  <span class="number">24</span>  -<span class="number">2</span>  <span class="number">13</span>  <span class="number">10</span>  -<span class="number">3</span>  <span class="number">48</span>  <span class="number">43</span> -<span class="number">28</span>  -<span class="number">3</span>  <span class="number">53</span> -<span class="number">15</span>  -<span class="number">6</span>  <span class="number">31</span> -<span class="number">23</span>  <span class="number">12</span>]</span><br><span class="line">[ -<span class="number">6</span>   <span class="number">0</span>   <span class="number">9</span>  <span class="number">42</span> -<span class="number">49</span> -<span class="number">38</span>   <span class="number">8</span>  <span class="number">12</span>   <span class="number">7</span>  <span class="number">39</span>  <span class="number">30</span> -<span class="number">26</span>  <span class="number">18</span>  <span class="number">37</span>  <span class="number">28</span> -<span class="number">28</span>   <span class="number">8</span>   <span class="number">2</span> -<span class="number">67</span> -<span class="number">21</span> -<span class="number">15</span>]</span><br><span class="line">[-<span class="number">56</span>  <span class="number">23</span>  <span class="number">22</span>  <span class="number">29</span>  -<span class="number">7</span> -<span class="number">19</span>  <span class="number">19</span>  -<span class="number">8</span>   <span class="number">6</span>  <span class="number">35</span>   <span class="number">4</span>  -<span class="number">8</span>  <span class="number">22</span>  -<span class="number">2</span> -<span class="number">44</span> -<span class="number">69</span>  <span class="number">16</span>  -<span class="number">8</span>  -<span class="number">7</span> -<span class="number">45</span>  <span class="number">21</span>]</span><br><span class="line">[-<span class="number">21</span>  <span class="number">16</span>  <span class="number">34</span> -<span class="number">39</span>  <span class="number">36</span>   <span class="number">1</span>  <span class="number">57</span> -<span class="number">30</span>  -<span class="number">2</span>  -<span class="number">2</span> -<span class="number">36</span>  -<span class="number">9</span>   <span class="number">9</span> -<span class="number">27</span>   <span class="number">8</span> -<span class="number">31</span> -<span class="number">31</span>  <span class="number">32</span>  <span class="number">12</span>  -<span class="number">2</span>  <span class="number">15</span>]</span><br><span class="line">[ -<span class="number">9</span>  -<span class="number">7</span>   <span class="number">6</span>  <span class="number">40</span>  <span class="number">32</span> -<span class="number">49</span> -<span class="number">26</span> -<span class="number">60</span>  <span class="number">17</span>   <span class="number">0</span> -<span class="number">13</span>   <span class="number">7</span>  <span class="number">25</span>  <span class="number">57</span> -<span class="number">19</span>  <span class="number">28</span>  -<span class="number">3</span> -<span class="number">34</span>  <span class="number">11</span> -<span class="number">12</span> -<span class="number">17</span>]</span><br><span class="line">[-<span class="number">30</span> -<span class="number">13</span>  <span class="number">28</span> -<span class="number">42</span>   <span class="number">8</span> -<span class="number">46</span>  <span class="number">56</span>  <span class="number">33</span> -<span class="number">56</span> -<span class="number">40</span> -<span class="number">24</span>   <span class="number">4</span>  <span class="number">10</span>  <span class="number">15</span>  <span class="number">46</span>  <span class="number">50</span> -<span class="number">13</span>  <span class="number">18</span> -<span class="number">21</span>  <span class="number">17</span>  <span class="number">16</span>]</span><br><span class="line">[-<span class="number">17</span> -<span class="number">11</span>  -<span class="number">5</span>  <span class="number">29</span>  <span class="number">14</span>   <span class="number">6</span> -<span class="number">13</span>   <span class="number">4</span>  <span class="number">42</span> -<span class="number">69</span>  <span class="number">30</span>   <span class="number">9</span>   <span class="number">3</span> -<span class="number">37</span>   <span class="number">5</span>   <span class="number">7</span> -<span class="number">17</span>  <span class="number">50</span>   <span class="number">6</span>  <span class="number">14</span> -<span class="number">38</span>]</span><br><span class="line">[ <span class="number">53</span> -<span class="number">12</span>  <span class="number">16</span>  <span class="number">36</span>   <span class="number">1</span>  <span class="number">38</span> -<span class="number">52</span>  <span class="number">25</span> -<span class="number">10</span> -<span class="number">41</span>  -<span class="number">3</span> -<span class="number">37</span>   <span class="number">6</span> -<span class="number">12</span>   <span class="number">1</span>  -<span class="number">4</span> -<span class="number">25</span>  <span class="number">41</span>   <span class="number">5</span>   <span class="number">1</span>  <span class="number">29</span>]</span><br><span class="line">[ -<span class="number">3</span>   <span class="number">1</span>  <span class="number">36</span>  <span class="number">22</span>   <span class="number">7</span>  -<span class="number">5</span> -<span class="number">10</span>  <span class="number">15</span> -<span class="number">10</span> -<span class="number">27</span>  <span class="number">35</span> -<span class="number">60</span> -<span class="number">36</span>   <span class="number">9</span> -<span class="number">57</span>  <span class="number">33</span> -<span class="number">21</span>  <span class="number">43</span>  <span class="number">28</span> -<span class="number">44</span>   <span class="number">8</span>]</span><br><span class="line">[ <span class="number">32</span> -<span class="number">26</span>  <span class="number">18</span>  -<span class="number">9</span>  -<span class="number">5</span>  <span class="number">37</span>  -<span class="number">8</span>   <span class="number">2</span> -<span class="number">36</span> -<span class="number">28</span>  <span class="number">43</span>  <span class="number">10</span> -<span class="number">32</span>  <span class="number">37</span> -<span class="number">24</span> -<span class="number">70</span>  <span class="number">22</span> -<span class="number">35</span>  <span class="number">49</span>  -<span class="number">2</span>  <span class="number">31</span>]</span><br><span class="line">[-<span class="number">33</span>  <span class="number">15</span> -<span class="number">25</span>   <span class="number">1</span> -<span class="number">40</span>   <span class="number">3</span>  -<span class="number">2</span> -<span class="number">32</span>  <span class="number">15</span>   <span class="number">9</span> -<span class="number">20</span> -<span class="number">27</span> -<span class="number">27</span>  <span class="number">35</span>  <span class="number">26</span>  -<span class="number">1</span> -<span class="number">45</span> -<span class="number">12</span>  <span class="number">45</span>  <span class="number">23</span>  <span class="number">36</span>]</span><br><span class="line">[-<span class="number">17</span>   <span class="number">0</span>  <span class="number">18</span> -<span class="number">20</span> -<span class="number">75</span>  -<span class="number">5</span>  <span class="number">55</span>  <span class="number">42</span>  <span class="number">16</span>   <span class="number">8</span> -<span class="number">45</span>   <span class="number">5</span> -<span class="number">24</span> -<span class="number">20</span> -<span class="number">50</span> -<span class="number">11</span>   <span class="number">0</span>  <span class="number">27</span>  <span class="number">40</span>  <span class="number">18</span>   <span class="number">8</span>]</span><br><span class="line">[ <span class="number">11</span>   <span class="number">5</span>  <span class="number">16</span>  <span class="number">37</span>  -<span class="number">2</span>  -<span class="number">6</span>  <span class="number">28</span>  <span class="number">19</span> -<span class="number">21</span>   <span class="number">5</span>  -<span class="number">8</span>  <span class="number">63</span>  -<span class="number">8</span> -<span class="number">21</span>  <span class="number">22</span> -<span class="number">23</span> -<span class="number">57</span>  <span class="number">13</span>  -<span class="number">5</span>  <span class="number">15</span> -<span class="number">39</span>]</span><br></pre></td></tr></table></figure>
<p>11<strong></strong>()0K</p>
<script type="math/tex; mode=display">
\left[\begin{matrix}
K*e1 & 1 & 0 & 0 ... & 0\\
K*e2 & 0 & 1 & 0 ... & 0\\
K*e3 & 0 & 0 & 1 ... & 0\\
...\\
K*e20 & 0 & 0 & 0 ... & 1\\
\end{matrix}\right]</script><p>0(K)100(kn)n</p>
<p><br></p>
<p>recovern.ipynb:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">e= []</span><br><span class="line">c= []</span><br><span class="line"></span><br><span class="line"><span class="comment">#step1</span></span><br><span class="line">L = Matrix(ZZ, <span class="number">20</span>, <span class="number">21</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    L[i,<span class="number">0</span>] = e[i]*<span class="number">1000</span></span><br><span class="line">    L[i,i+<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">L = L.LLL()</span><br><span class="line"></span><br><span class="line">alist1 = L[<span class="number">0</span>][<span class="number">1</span>:]</span><br><span class="line">k1nl = <span class="number">1</span></span><br><span class="line">k1nr = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    <span class="keyword">if</span>(alist1[i]&lt;<span class="number">0</span>):</span><br><span class="line">        k1nr *= c[i]**(-alist1[i])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        k1nl *= c[i]**alist1[i]</span><br><span class="line">k1n = k1nl-k1nr</span><br><span class="line"></span><br><span class="line">alist2 = L[<span class="number">1</span>][<span class="number">1</span>:]</span><br><span class="line">k2nl = <span class="number">1</span></span><br><span class="line">k2nr = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    <span class="keyword">if</span>(alist2[i]&lt;<span class="number">0</span>):</span><br><span class="line">        k2nr *= c[i]**(-alist2[i])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        k2nl *= c[i]**alist2[i]</span><br><span class="line">k2n = k2nl-k2nr</span><br><span class="line"></span><br><span class="line">n = gcd(k1n,k2n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">10000</span>):</span><br><span class="line">    <span class="keyword">while</span>(n % i == <span class="number">0</span>):</span><br><span class="line">        n //= i</span><br><span class="line"></span><br><span class="line"><span class="comment">#n1024bit</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(<span class="built_in">bin</span>(n)[<span class="number">2</span>:]))</span><br><span class="line"><span class="built_in">print</span>(n)</span><br></pre></td></tr></table></figure>
<p>flag</p>
<font size="4" color="red">NSSCTF{407f8832-6ffd-43bf-91a0-6900758cdff7}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id=""><a href="#" class="headerlink" title=""></a></h2><p></p>
<p></p>
]]></content>
      <categories>
        <category>wp-crypto</category>
      </categories>
  </entry>
  <entry>
    <title>2023-SICTF-#Round2-wp-crypto</title>
    <url>/post/445800a5.html</url>
    <content><![CDATA[<p>Crypto</p>
<span id="more"></span>
<p>Rank2</p>
<p><img src="/post/445800a5/image-20230911152911874.png" alt="image-20230911152911874"></p>
<p><br></p>
<p><br></p>
<h3 id="-"><a href="#-" class="headerlink" title="[]"></a>[]</h3><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<p>base100base</p>
<p>1 base100</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2L3EN82QPvhfC6RbmTc34VkwzEkqivF9DcKpindwxwuGYdUcg1XROHOaPCoAL6hZsLJDDe0PS0GEP4CYOsETUpDY2CnFTR9Wiil04p6k8ZZ7KXDnc7TuUnJlNpxoUUViUFRLS4R17rO38aXXErVSVjIyTlqpVeYd7aNiHKyMQfimLda6NzOutnOFJYnSPRSrUv44uz8PCJgZb7eTasrcoqIrYRLGnI4fV20yOPq3L6o4z</span><br></pre></td></tr></table></figure>
<p>2 base62</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">UlhoYUdxZTdaY1FCbXFyaWl5S0ZKaW4yN2ZiWkpTZHhOd2hBVk1wNzRvUWE0VWs2RXVqTlpkTHNvYVpxNHRMUDd3dXk4OGJiSlhlTGJnN2dxR2RkTm15dGs1S1RGdlk3TmpRR0wzenFrQ3BCM3lmUTFTUkY0OU13Z0JjZkFxWjFhNng=</span><br></pre></td></tr></table></figure>
<p>3base64</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">RXhaGqe7ZcQBmqriiyKFJin27fbZJSdxNwhAVMp74oQa4Uk6EujNZdLsoaZq4tLP7wuy88bbJXeLbg7gqGddNmytk5KTFvY7NjQGL3zqkCpB3yfQ1SRF49MwgBcfAqZ1a6x</span><br></pre></td></tr></table></figure>
<p>4 base58</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">G53XC4LIK5DWQ53UIFSGCUTCJFCGM4DSM5UXOYTILBUXU6TXJ5SUUT2DONHTQZ3GJNCFSUDINRXE6MTEINUXOQLVLI4VU===</span><br></pre></td></tr></table></figure>
<p>5 base32</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">7wqqhWGhwtAdaRbIDfprgiwbhXizzwOeJOCsO8gfKDYPhlnO2dCiwAuZ9Z</span><br></pre></td></tr></table></figure>
<p>6base62</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SICTF&#123;fe853b49-8730-462e-86f5-fc8e9789f077&#125;</span><br></pre></td></tr></table></figure>
<p>flag</p>
<p><strong>SICTF{fe853b49-8730-462e-86f5-fc8e9789f077}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="Radio"><a href="#Radio" class="headerlink" title="Radio"></a>Radio</h3><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n1 = p * q</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n2 = p * q</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n3 = p * q</span><br><span class="line">e = <span class="number">17</span></span><br><span class="line">c1 = <span class="built_in">pow</span>(m,e,n1)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m,e,n2)</span><br><span class="line">c3 = <span class="built_in">pow</span>(m,e,n3)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n1 =&quot;</span>,n1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n2 =&quot;</span>,n2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n3 =&quot;</span>,n3)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c1 =&quot;</span>,c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c2 =&quot;</span>,c2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c3 =&quot;</span>,c3)</span><br></pre></td></tr></table></figure>
<p>$\quad mod \; (n1n2n3)\quad$$\quad m^{17}\quad$17</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt </span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n1 = </span><br><span class="line">n2 = </span><br><span class="line">n3 = </span><br><span class="line">c1 = </span><br><span class="line">c2 = </span><br><span class="line">c3 = </span><br><span class="line">e = <span class="number">17</span></span><br><span class="line"></span><br><span class="line">n = [n1,n2,n3]</span><br><span class="line">c = [c1,c2,c3]</span><br><span class="line">M = crt(n,c)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(iroot(M,<span class="number">17</span>)[<span class="number">0</span>]))</span><br></pre></td></tr></table></figure>
<p>flag</p>
<p><strong>SICTF{fdc0afb5-1c81-46b9-a28a-241f5f64419d}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="MingTianPao"><a href="#MingTianPao" class="headerlink" title="MingTianPao"></a>MingTianPao</h3><p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">CTF</span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, message</span><br><span class="line"><span class="comment"># message is a Classic English Story</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    tmp = (message[i*<span class="number">30</span>:(i+<span class="number">1</span>)*<span class="number">30</span>].encode())</span><br><span class="line">    <span class="built_in">print</span>(binascii.hexlify(strxor(tmp,flag)).decode())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1f2037202a1e6d06353b61263d050a0538493b3018544e14171d2b1c4218</span></span><br><span class="line"><span class="comment"># 3769373b66142f31297f291126410e042b01162d59103a0c005221075013</span></span><br><span class="line"><span class="comment"># 37242c202e1e3f743c36371130410c1e2b491a31574406014505291a550e</span></span><br><span class="line"><span class="comment"># 7f6922742e1a213270372e01264105193004532b1f554e120c1e2a145618</span></span><br><span class="line"><span class="comment"># 7d69143c23156d18392b35183141310e3b49213613590003453a291a555d</span></span><br><span class="line"><span class="comment"># 36273731341e297424372454230e0c0f2c49127f005f020245112718545d</span></span><br><span class="line"><span class="comment"># 26396320295b2531227161273c04430f360d533118444e0f0b1d31554615</span></span><br><span class="line"><span class="comment"># 323d6335660c24373b3a2554350f0a063e05533712101905165e66145f19</span></span><br><span class="line"><span class="comment"># 733e222766152220703e27063508074b300f53371e5d40444735291a555d</span></span><br><span class="line"><span class="comment"># 37283a7432146d2d3f2a6d541808171f330c530d12544e360c162f1b565d</span></span><br></pre></td></tr></table></figure>
<p>Many-Time-PadMTPMTP</p>
<p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># message is a Classic English Story</span><br></pre></td></tr></table></figure>
<p>flag<strong>SICTF{</strong></p>
<p></p>
<p><img src="/post/445800a5/image-20230908224043439.png" alt="image-20230908224043439"></p>
<p>Little</p>
<p>Little Prince</p>
<p><img src="/post/445800a5/image-20230908224223829.png" alt="image-20230908224223829"></p>
<p>Little Red Riding Hood</p>
<p><img src="/post/445800a5/image-20230908224336581.png" alt="image-20230908224336581"></p>
<p>flagwonderfulflag</p>
<p><img src="/post/445800a5/image-20230908224509359.png" alt="image-20230908224509359"></p>
<p>flag</p>
<p><strong>SICTF{MTP_AtTack_is_w0nderFu1}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="Easy-CopperSmith"><a href="#Easy-CopperSmith" class="headerlink" title="Easy_CopperSmith"></a>Easy_CopperSmith</h3><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CopperSmith</span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">leak = p &gt;&gt; <span class="number">230</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(leak)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">114007680041157617250208809154392208683967639953423906669116998085115503737001019559692895227927818755160444076128820965038044269092587109196557720941716578025622244634385547194563001079609897387390680250570961313174656874665690193604984942452581886657386063927035039087208310041149977622001887997061312418381</span></span><br><span class="line"><span class="string">6833525680083767201563383553257365403889275861180069149272377788671845720921410137177</span></span><br><span class="line"><span class="string">87627846271126693177889082381507430884663777705438987267317070845965070209704910716182088690758208915234427170455157948022843849997441546596567189456637997191173043345521331111329110083529853409188141263211030032553825858341099759209550785745319223409181813931086979471131074015406202979668575990074985441810</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>p</p>
<p>exp.ipynb</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">114007680041157617250208809154392208683967639953423906669116998085115503737001019559692895227927818755160444076128820965038044269092587109196557720941716578025622244634385547194563001079609897387390680250570961313174656874665690193604984942452581886657386063927035039087208310041149977622001887997061312418381</span></span><br><span class="line">p4 = <span class="number">6833525680083767201563383553257365403889275861180069149272377788671845720921410137177</span></span><br><span class="line">c = <span class="number">87627846271126693177889082381507430884663777705438987267317070845965070209704910716182088690758208915234427170455157948022843849997441546596567189456637997191173043345521331111329110083529853409188141263211030032553825858341099759209550785745319223409181813931086979471131074015406202979668575990074985441810</span></span><br><span class="line">e =  <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">pbits = <span class="number">512</span></span><br><span class="line">kbits=pbits - p4.nbits()</span><br><span class="line">p4 = p4 &lt;&lt; kbits</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x + p4</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^kbits,beta=<span class="number">0.4</span>,epsilon = <span class="number">0.01</span>)</span><br><span class="line"><span class="comment"># np10</span></span><br><span class="line"><span class="keyword">if</span> roots:</span><br><span class="line">    p= p4 + <span class="built_in">int</span>(roots[<span class="number">0</span>])</span><br><span class="line">    q = n//p</span><br><span class="line">d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>
<p>flag</p>
<p><strong>SICTF{3f9366ed-b8e4-412f-bbd0-62616a24115c}</strong></p>
<p><br></p>
<p><br></p>
<h3 id=""><a href="#" class="headerlink" title=""></a></h3><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span>  Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">e = getPrime(<span class="number">10</span>)</span><br><span class="line">n = p*q</span><br><span class="line">c1 = <span class="built_in">pow</span>(<span class="number">114</span>*m+<span class="number">2333</span>,e,n)</span><br><span class="line">c2 = <span class="built_in">pow</span>(<span class="number">514</span>*m+<span class="number">4555</span>,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c1 = <span class="subst">&#123;c1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c2 = <span class="subst">&#123;c2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 18993579800590288733556762316465854395650778003397512624355925069287661487515652428099677335464809283955351330659278915073219733930542167360381688856732762552737791137784222098296804826261681852699742456526979985201331982720936091963830799430264680941164508709453794113576607749669278887105809727027129736803614327631979056934906547015919204770702496676692691248702461766117271815398943842909579917102217310779431999448597899109808086655029624478062317317442297276087073653945439820988375066353157221370129064423613949039895822016206336117081475698987326594199181180346821431242733826487765566154350269651592993856883</span></span><br><span class="line"><span class="string">c1 = 3089900890429368903963127778258893993015616003863275300568951378177309984878857933740319974151823410060583527905656182419531008417050246901514691111335764182779077027419410717272164998075313101695833565450587029584857433998627248705518025411896438130004108810308599666206694770859843696952378804678690327442746359836105117371144846629293505396610982407985241783168161504309420302314102538231774470927864959064261347913286659384383565379900391857812482728653358741387072374314243068833590379370244368317200796927931678203916569721211768082289529948017340699194622234734381555103898784827642197721866114583358940604520</span></span><br><span class="line"><span class="string">c2 = 6062491672599671503583327431533992487890060173533816222838721749216161789662841049274959778509684968479022417053571624473283543736981267659104310293237792925201009775193492423025040929132360886500863823523629213703533794348606076463773478200331006341206053010168741302440409050344170767489936681627020501853981450212305108039373119567034948781143698613084550376070802084805644270376620484786155554275798939105737707005991882264123315436368611647275530607811665999620394422672764116158492214128572456571553281799359243174598812137554860109807481900330449364878168308833006964726761878461761560543284533578701661413931</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p></p>
<script type="math/tex; mode=display">
(114*x+2333)^{e}\equiv c1\quad (mod\;n)</script><script type="math/tex; mode=display">
(514*x+4555)^{e}\equiv c2\quad (mod\;n)</script><p>m</p>
<script type="math/tex; mode=display">
(x-m)</script><p>ne</p>
<p>exp.ipynb</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">18993579800590288733556762316465854395650778003397512624355925069287661487515652428099677335464809283955351330659278915073219733930542167360381688856732762552737791137784222098296804826261681852699742456526979985201331982720936091963830799430264680941164508709453794113576607749669278887105809727027129736803614327631979056934906547015919204770702496676692691248702461766117271815398943842909579917102217310779431999448597899109808086655029624478062317317442297276087073653945439820988375066353157221370129064423613949039895822016206336117081475698987326594199181180346821431242733826487765566154350269651592993856883</span></span><br><span class="line">c1 = <span class="number">3089900890429368903963127778258893993015616003863275300568951378177309984878857933740319974151823410060583527905656182419531008417050246901514691111335764182779077027419410717272164998075313101695833565450587029584857433998627248705518025411896438130004108810308599666206694770859843696952378804678690327442746359836105117371144846629293505396610982407985241783168161504309420302314102538231774470927864959064261347913286659384383565379900391857812482728653358741387072374314243068833590379370244368317200796927931678203916569721211768082289529948017340699194622234734381555103898784827642197721866114583358940604520</span></span><br><span class="line">c2 = <span class="number">6062491672599671503583327431533992487890060173533816222838721749216161789662841049274959778509684968479022417053571624473283543736981267659104310293237792925201009775193492423025040929132360886500863823523629213703533794348606076463773478200331006341206053010168741302440409050344170767489936681627020501853981450212305108039373119567034948781143698613084550376070802084805644270376620484786155554275798939105737707005991882264123315436368611647275530607811665999620394422672764116158492214128572456571553281799359243174598812137554860109807481900330449364878168308833006964726761878461761560543284533578701661413931</span></span><br><span class="line">a1 = <span class="number">114</span></span><br><span class="line">b1 = <span class="number">2333</span></span><br><span class="line">a2 = <span class="number">514</span></span><br><span class="line">b2 = <span class="number">4555</span></span><br><span class="line">elist = [<span class="number">521</span>,<span class="number">523</span>,<span class="number">541</span>,<span class="number">547</span>,<span class="number">557</span>,<span class="number">563</span>,<span class="number">569</span>,<span class="number">571</span>,<span class="number">577</span>,<span class="number">587</span>,<span class="number">593</span>,<span class="number">599</span>,<span class="number">601</span>,<span class="number">607</span>,<span class="number">613</span>,<span class="number">617</span>,<span class="number">619</span>,<span class="number">631</span>,<span class="number">641</span>,<span class="number">643</span>,<span class="number">647</span>,<span class="number">653</span>,<span class="number">659</span>,<span class="number">661</span>,<span class="number">673</span>,<span class="number">677</span>,<span class="number">683</span>,<span class="number">691</span>,<span class="number">701</span>,<span class="number">709</span>,<span class="number">719</span>,<span class="number">727</span>,<span class="number">733</span>,<span class="number">739</span>,<span class="number">743</span>,<span class="number">751</span>,<span class="number">757</span>,<span class="number">761</span>,<span class="number">769</span>,<span class="number">773</span>,<span class="number">787</span>,<span class="number">797</span>,<span class="number">809</span>,<span class="number">811</span>,<span class="number">821</span>,<span class="number">823</span>,<span class="number">827</span>,<span class="number">829</span>,<span class="number">839</span>,<span class="number">853</span>,<span class="number">857</span>,<span class="number">859</span>,<span class="number">863</span>,<span class="number">877</span>,<span class="number">881</span>,<span class="number">883</span>,<span class="number">887</span>,<span class="number">907</span>,<span class="number">911</span>,<span class="number">919</span>,<span class="number">929</span>,<span class="number">937</span>,<span class="number">941</span>,<span class="number">947</span>,<span class="number">953</span>,<span class="number">967</span>,<span class="number">971</span>,<span class="number">977</span>,<span class="number">983</span>,<span class="number">991</span>,<span class="number">997</span>,<span class="number">1009</span>,<span class="number">1013</span>,<span class="number">1019</span>,<span class="number">1021</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>(<span class="params">c1, c2, e, n</span>):</span><br><span class="line">    PR.&lt;x&gt;=PolynomialRing(Zmod(n))</span><br><span class="line">    g1 = (a1*x + b1)^e - c1</span><br><span class="line">    g2 = (a2*x + b2)^e - c2</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">g1, g2</span>):</span><br><span class="line">        <span class="keyword">while</span> g2:</span><br><span class="line">            g1, g2 = g2, g1 % g2</span><br><span class="line">        <span class="keyword">return</span> g1.monic()</span><br><span class="line">    <span class="keyword">return</span> -gcd(g1, g2)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> elist:</span><br><span class="line">    m1 = attack(c1, c2, e, n)</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">b&quot;SICTF&quot;</span> <span class="keyword">in</span> long_to_bytes(<span class="built_in">int</span>(m1))):</span><br><span class="line">        flag = long_to_bytes(<span class="built_in">int</span>(m1))</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>flag</p>
<p><strong>SICTF{hhh!!franklin_reiter_is_easy}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="small-e"><a href="#small-e" class="headerlink" title="small_e"></a>small_e</h3><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line">flag=<span class="string">&quot;SICTF&#123;&quot;</span>+<span class="built_in">str</span>(uuid.uuid4())+<span class="string">&quot;&#125;&quot;</span></span><br><span class="line">m=libnum.s2n(flag)</span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line">n=p*q</span><br><span class="line">e=<span class="number">3</span></span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line">m1=((m&gt;&gt;<span class="number">60</span>)&lt;&lt;<span class="number">60</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e=&quot;</span>,e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;((m&gt;&gt;60)&lt;&lt;60)=&quot;</span>,m1)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n= 23407088262641313744603678186127228163189328033499381357614318160776774708961658114505773173784501557046914457908828086210961235530240151825359345210845219656000760996670856300710703016947799649686427460688236465568188205550456293373157997725204643414082796492333552579250010906010553831060540937802882205118399938918764313169385349293602085310111289583058965780887097301702677087443291977479125263301000328313103296364864396361278863921717374909215078711198899810620522933994481419395021233240234478331179727351050575360886334237633420906629984625441302945112631166021776379103081857393866576659121443879590011160797</span></span><br><span class="line"><span class="string">e= 3</span></span><br><span class="line"><span class="string">c= 1584727211980974717747362694412040878682966138197627512650829607105625096823456063149392973232737929737200028676411430124019573130595696272668927725536797627059576270068695792221537212669276826952363636924278717182163166234322320044764324434683614360641636360301452618063418349310497430566465329766916213742181</span></span><br><span class="line"><span class="string">((m&gt;&gt;60)&lt;&lt;60)= 11658736990073967239197168945911788935424691658202162501032766529463315401599017877851823976178979438592</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p></p>
<p>exp.ipynb</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n= <span class="number">23407088262641313744603678186127228163189328033499381357614318160776774708961658114505773173784501557046914457908828086210961235530240151825359345210845219656000760996670856300710703016947799649686427460688236465568188205550456293373157997725204643414082796492333552579250010906010553831060540937802882205118399938918764313169385349293602085310111289583058965780887097301702677087443291977479125263301000328313103296364864396361278863921717374909215078711198899810620522933994481419395021233240234478331179727351050575360886334237633420906629984625441302945112631166021776379103081857393866576659121443879590011160797</span></span><br><span class="line">e= <span class="number">3</span></span><br><span class="line">c= <span class="number">1584727211980974717747362694412040878682966138197627512650829607105625096823456063149392973232737929737200028676411430124019573130595696272668927725536797627059576270068695792221537212669276826952363636924278717182163166234322320044764324434683614360641636360301452618063418349310497430566465329766916213742181</span></span><br><span class="line">m= <span class="number">11658736990073967239197168945911788935424691658202162501032766529463315401599017877851823976178979438592</span></span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = (m + x)^e - c</span><br><span class="line">f = f.monic()</span><br><span class="line">roots = f.small_roots()</span><br><span class="line"></span><br><span class="line">m = m + <span class="built_in">int</span>(roots[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flag</p>
<p><strong>SICTF{2ca8e589-4a31-4909-80f0-9ecfc8f8cb37}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="easy-math"><a href="#easy-math" class="headerlink" title="easy_math"></a>easy_math</h3><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span>  Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">hint1 = getPrime(<span class="number">13</span>)*p+getPrime(<span class="number">256</span>)*q</span><br><span class="line">hint2 = getPrime(<span class="number">13</span>)*p+getPrime(<span class="number">256</span>)*q</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;hint1 = <span class="subst">&#123;hint1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;hint2 = <span class="subst">&#123;hint2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 68123067052840097285002963401518347625939222208495512245264898037784706226045178539672509359795737570458454279990340789711761542570505016930986418403583534761200927746744298082254959321108829717070206277856970403191060311901559017372393931121345743640657503994132925993800497309703877076541759570410784984067</span></span><br><span class="line"><span class="string">hint1 = 564294243979930441832363430202216879765636227726919016842676871868826273613344463155168512928428069316237289920953421495330355385445649203238665802121198919543532254290185502622234014832349396422316629991217252686524462096711723580</span></span><br><span class="line"><span class="string">hint2 = 484307144682854466149980416084532076579378210225500554261260145338511061452958092407101769145891750844383042274498826787696953308289632616886162073232218214504005935332891893378072083589751354946391146889055039887781077066257013110</span></span><br><span class="line"><span class="string">c = 57751903193610662622957432730720223801836323458721550133101805763463060486486266309568004721657732742899781400754207249733137375171400440423755473421971160000575072519031824740691618617905549725344323721903857290320737224300672847773455169809689188843070599176261204013341324705808617411345132933937680951713</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>hint1hint2</p>
<script type="math/tex; mode=display">
hint1 = a1*p+b1*q</script><script type="math/tex; mode=display">
hint2 = a2*p+b2*q</script><p>pa1a213a1a2</p>
<script type="math/tex; mode=display">
a2*hint1-a1*hint2=a2*(a1*p+b1*q) - a1*(a2*p+b2*q)=(a2*b1-a1*b2)*q</script><p>ngcdqRSA</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span>  Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">68123067052840097285002963401518347625939222208495512245264898037784706226045178539672509359795737570458454279990340789711761542570505016930986418403583534761200927746744298082254959321108829717070206277856970403191060311901559017372393931121345743640657503994132925993800497309703877076541759570410784984067</span></span><br><span class="line">hint1 = <span class="number">564294243979930441832363430202216879765636227726919016842676871868826273613344463155168512928428069316237289920953421495330355385445649203238665802121198919543532254290185502622234014832349396422316629991217252686524462096711723580</span></span><br><span class="line">hint2 = <span class="number">484307144682854466149980416084532076579378210225500554261260145338511061452958092407101769145891750844383042274498826787696953308289632616886162073232218214504005935332891893378072083589751354946391146889055039887781077066257013110</span></span><br><span class="line">c = <span class="number">57751903193610662622957432730720223801836323458721550133101805763463060486486266309568004721657732742899781400754207249733137375171400440423755473421971160000575072519031824740691618617905549725344323721903857290320737224300672847773455169809689188843070599176261204013341324705808617411345132933937680951713</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">primelist = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">12</span>,<span class="number">2</span>**<span class="number">13</span>) <span class="keyword">if</span> isPrime(i)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> primelist:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> primelist:</span><br><span class="line">        <span class="keyword">if</span>(GCD(hint1*i - hint2*j,n) != <span class="number">1</span>):</span><br><span class="line">            q = GCD(hint1*i - hint2*j,n)</span><br><span class="line">p = n//q</span><br><span class="line">d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flag</p>
<p><strong>SICTF{452aebb6-9c16-441a-ac42-fc608bf6063f}</strong></p>
<p><br></p>
<p><br></p>
<h3 id=""><a href="#" class="headerlink" title=""></a></h3><p></p>
]]></content>
      <categories>
        <category>wp-crypto</category>
      </categories>
  </entry>
  <entry>
    <title>2023-SICTF-#Round2-wp-misc</title>
    <url>/post/ccf22797.html</url>
    <content><![CDATA[<p>Cryptomiscmisc</p>
<span id="more"></span>
<p><strong>Rank2</strong></p>
<p><img src="/post/ccf22797/image-20230911152802298.png" alt="image-20230911152802298"></p>
<p><br></p>
<p><br></p>
<h3 id="-Welcome"><a href="#-Welcome" class="headerlink" title="[]Welcome"></a>[]Welcome</h3><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;SICTF2023&quot;flag</span><br></pre></td></tr></table></figure>
<p></p>
<p><img src="/post/ccf22797/image-20230908162949748.png" alt></p>
<p>flag</p>
<p><strong>SICTF{Welcome_to_SICTF2023_#Round2}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="Pixel-art"><a href="#Pixel-art" class="headerlink" title="Pixel_art"></a>Pixel_art</h3><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<p>zip</p>
<p><img src="/post/ccf22797/image-20230908171507928.png" alt="image-20230908171507928"></p>
<p>10</p>
<p><img src="/post/ccf22797/Pixel_art.png" alt="Pixel_art"></p>
<p>stegsolveLSB</p>
<p><img src="/post/ccf22797/image-20230908171812016.png" alt="image-20230908171812016"></p>
<p>png</p>
<p><img src="/post/ccf22797/pixel.png" alt="pixel"></p>
<p></p>
<p><img src="/post/ccf22797/image-20230908171941968.png" alt="image-20230908171941968"></p>
<p>20*20flag</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">image = Image.<span class="built_in">open</span>(<span class="string">&#x27;temp.png&#x27;</span>)  <span class="comment"># </span></span><br><span class="line">width, height = image.size</span><br><span class="line">pixel_data = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">        pixel = image.getpixel((x, y))</span><br><span class="line">        pixel_data.append(pixel)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(pixel_data)</span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">[(<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">33</span>, <span class="number">63</span>, <span class="number">33</span>), (<span class="number">33</span>, <span class="number">46</span>, <span class="number">63</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">63</span>, <span class="number">46</span>, <span class="number">63</span>), (<span class="number">33</span>, <span class="number">46</span>, <span class="number">63</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">33</span>, <span class="number">46</span>), (<span class="number">63</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">33</span>), (<span class="number">63</span>, <span class="number">33</span>, <span class="number">33</span>), (<span class="number">46</span>, <span class="number">63</span>, <span class="number">33</span>), (<span class="number">33</span>, <span class="number">33</span>, <span class="number">33</span>), (<span class="number">33</span>, <span class="number">33</span>, <span class="number">63</span>), (<span class="number">46</span>, <span class="number">63</span>, <span class="number">33</span>), (<span class="number">46</span>, <span class="number">63</span>, <span class="number">33</span>), ......, (<span class="number">46</span>, <span class="number">46</span>, <span class="number">33</span>), (<span class="number">46</span>, <span class="number">63</span>, <span class="number">46</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)]</span><br></pre></td></tr></table></figure>
<p>ASCII</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">46-. </span><br><span class="line">33-!</span><br><span class="line">63-?</span><br></pre></td></tr></table></figure>
<p>Ook</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">image = Image.<span class="built_in">open</span>(<span class="string">&#x27;temp.png&#x27;</span>)  <span class="comment"># </span></span><br><span class="line">width, height = image.size</span><br><span class="line">pixel_data = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">        pixel = image.getpixel((x, y))</span><br><span class="line">        pixel_data.append(pixel)</span><br><span class="line"></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(pixel_data)):</span><br><span class="line">    <span class="keyword">if</span>(pixel_data[i] == (<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>)):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> pixel_data[i]:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Ook&quot;</span>+<span class="built_in">chr</span>(j),end = <span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>
<p></p>
<p><img src="/post/ccf22797/image-20230908172734509.png" alt="image-20230908172734509"></p>
<p>flag</p>
<p><strong>SICTF{0141ac35-ec19-4cee-a906-22805fdbed77}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="baby-zip"><a href="#baby-zip" class="headerlink" title="baby_zip"></a>baby_zip</h3><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<p>ziprellobinwalk</p>
<p></p>
<p><a href="https://hasegawaazusa.github.io/zip-crack-note.html#zip-">zip |  (hasegawaazusa.github.io)</a></p>
<p>12png</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 52</span><br></pre></td></tr></table></figure>
<p>1612()</p>
<p><img src="/post/ccf22797/image-20230909112256733.png" alt="image-20230909112256733"></p>
<p>key.txtzip()</p>
<p><img src="/post/ccf22797/image-20230909112437253.png" alt="image-20230909112437253"></p>
<p></p>
<p><img src="/post/ccf22797/flag1.png" alt="flag1"></p>
<p>flag</p>
<p><img src="/post/ccf22797/image-20230909112540496.png" alt="image-20230909112540496"></p>
<p>flag</p>
<p><strong>SICTF{3a4998b8-345e-4943-a689-d01e8b08defb}</strong></p>
<p><br></p>
<p><br></p>
<h3 id=""><a href="#" class="headerlink" title=""></a></h3><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">HintCobaltStrike</span><br></pre></td></tr></table></figure>
<p>httpkey.zip</p>
<p><img src="/post/ccf22797/image-20230909142543063.png" alt="image-20230909142543063"></p>
<p>keykeykey</p>
<p>hintCobaltStrike(CS_DecryptM2Cryptopippythonpycryptodome)</p>
<p><a href="https://blog.csdn.net/qq_43264813/article/details/120560209">2021-Misc-_-CSDN</a></p>
<p>flag</p>
<p><img src="/post/ccf22797/image-20230909142844158.png" alt="image-20230909142844158"></p>
<p>flag</p>
<p><strong>SICTF{88a39373-e204-43b6-b321-33ac8972fde9}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="QR-QR-QR"><a href="#QR-QR-QR" class="headerlink" title="QR_QR_QR"></a>QR_QR_QR</h3><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pwntools</span><br></pre></td></tr></table></figure>
<p>xshell</p>
<p><img src="/post/ccf22797/image-20230910150031807.png" alt="image-20230910150031807"></p>
<p>01</p>
<p><img src="/post/ccf22797/image-20230910150225007.png" alt="image-20230910150225007"></p>
<p>vscode</p>
<p><img src="/post/ccf22797/image-20230910150358330.png" alt="image-20230910150358330"></p>
<p></p>
<p><img src="/post/ccf22797/image-20230910150429700.png" alt="image-20230910150429700"></p>
<p>flag</p>
<p>debug</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> pyzbar.pyzbar <span class="keyword">import</span> decode</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&quot;210.44.151.51&quot;</span>,<span class="number">10468</span>)</span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    count += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(count)</span><br><span class="line">    data = <span class="built_in">list</span>(r.recvuntil(<span class="string">b&quot;P&quot;</span>)[:-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    width = <span class="number">116</span></span><br><span class="line">    height = <span class="number">116</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    image = Image.new(<span class="string">&quot;1&quot;</span>, (width, height), color=<span class="number">1</span>)  <span class="comment"># 1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    pixels = image.load()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 01</span></span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">            index = y * width + x</span><br><span class="line">            <span class="keyword">if</span> index &lt; <span class="built_in">len</span>(data) <span class="keyword">and</span> data[index] == <span class="number">48</span>:</span><br><span class="line">                pixels[x, y] = <span class="number">0</span>  <span class="comment"># 0</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                pixels[x, y] = <span class="number">1</span>  <span class="comment"># 0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    image.save(<span class="string">&quot;1.png&quot;</span>)</span><br><span class="line">    decocdeQR = decode(Image.<span class="built_in">open</span>(<span class="string">&quot;1.png&quot;</span>))[<span class="number">0</span>].data</span><br><span class="line">    r.sendline(decocdeQR)</span><br><span class="line">    temp = r.recvline()</span><br><span class="line">    <span class="built_in">print</span>(temp)</span><br><span class="line">    temp = r.recvline()</span><br><span class="line">    <span class="built_in">print</span>(temp)</span><br></pre></td></tr></table></figure>
<p>1000flag</p>
<p><strong>SICTF{d7d23552-d917-4ad4-962c-e415dd5b5b6e}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="fast-morse"><a href="#fast-morse" class="headerlink" title="fast_morse"></a>fast_morse</h3><p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flagSICTF&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>Audacity</p>
<p><img src="/post/ccf22797/image-20230910150829891.png" alt="image-20230910150829891"></p>
<p>uuid<del>flag</del></p>
<p><br></p>
<p><br></p>
<h3 id="Easy-Shark"><a href="#Easy-Shark" class="headerlink" title="Easy_Shark"></a>Easy_Shark</h3><p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<p>tcpphp</p>
<p><img src="/post/ccf22797/image-20230910151203093.png" alt="image-20230910151203093"></p>
<p>opensslAES_128base64key()cybercheftcpbase64</p>
<p><img src="/post/ccf22797/image-20230910151658797.png" alt="image-20230910151658797"></p>
<p>base64</p>
<p><img src="/post/ccf22797/image-20230910151851063.png" alt="image-20230910151851063"></p>
<p>cmd</p>
<p>GronKey.txt</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1,50,61,8,9,20,63,41</span><br></pre></td></tr></table></figure>
<p>flag.txt</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">TGLBOMSJNSRAJAZDEZXGHSJNZWHG</span><br></pre></td></tr></table></figure>
<p>flagGronKey.txtGronKeyGronsfeld</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span>  Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pycipher <span class="keyword">import</span> Gronsfeld</span><br><span class="line"></span><br><span class="line">t = [<span class="number">1</span>,<span class="number">50</span>,<span class="number">61</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">20</span>,<span class="number">63</span>,<span class="number">41</span>]</span><br><span class="line">temp = <span class="string">&quot;TGLBOMSJNSRAJAZDEZXGHSJNZWHG&quot;</span></span><br><span class="line"><span class="built_in">print</span> (Gronsfeld(t).decipher(temp))</span><br></pre></td></tr></table></figure>
<p>Gronsfeld0-9()GronGronsfeld</p>
<p><a href="https://www.wishingstarmoye.com/ctf/vigenere">Vigenere / Gronsfeld -  (wishingstarmoye.com)</a></p>
<p>10</p>
<p>T1SG502(26)I</p>
<p></p>
<p>flag</p>
<p><strong>SICTF{SHUMUISAGOODBOYYYYYYYYY}</strong></p>
<p><br></p>
<p><br></p>
<h3 id=""><a href="#" class="headerlink" title=""></a></h3><p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload</span><br><span class="line">Hint1,CS</span><br><span class="line">Hint2we1l</span><br></pre></td></tr></table></figure>
<p>Easy_shark</p>
<p>flag1Ez_shark2</p>
<p>1Ez_sharkAESkeykey2key.zip</p>
<p><img src="/post/ccf22797/image-20230910153507463.png" alt="image-20230910153507463"></p>
<p>key.zipziprellowe1l(Hint)</p>
<p>key</p>
<p><img src="/post/ccf22797/image-20230910153756977.png" alt="image-20230910153756977"></p>
<p><a href="http://330k.github.io/misc_tools/unicode_steganography.html">Unicode Steganography with Zero-Width Characters (330k.github.io)</a></p>
<p><img src="/post/ccf22797/image-20230910154112768.png" alt="image-20230910154112768"></p>
<p></p>
<p><img src="/post/ccf22797/image-20230910154140388.png" alt="image-20230910154140388"></p>
<p>AESkeyEz_Shark1</p>
<p>flag.txt</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SICTF&#123;79e1755e-08a8-4d</span><br></pre></td></tr></table></figure>
<p>key</p>
<p><img src="/post/ccf22797/image-20230910154525684.png" alt="image-20230910154525684"></p>
<p><code>.cobaltstrike.beacon_keys</code>key1.txt</p>
<p>()</p>
<p>1key1.txtprivate_key</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javaobj.v2 <span class="keyword">as</span> javaobj</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;key1.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> fd:</span><br><span class="line">    pobj = javaobj.load(fd)</span><br><span class="line">privateKey = pobj.array.value.privateKey.encoded.data</span><br><span class="line">publicKey = pobj.array.value.publicKey.encoded.data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">privateKey = (</span><br><span class="line">    <span class="string">b&quot;-----BEGIN PRIVATE KEY-----\n&quot;</span></span><br><span class="line">    + base64.encodebytes(<span class="built_in">bytes</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x: x &amp; <span class="number">0xFF</span>, privateKey)))</span><br><span class="line">    + <span class="string">b&quot;-----END PRIVATE KEY-----&quot;</span></span><br><span class="line">)</span><br><span class="line">publicKey = (</span><br><span class="line">    <span class="string">b&quot;-----BEGIN PUBLIC KEY-----\n&quot;</span></span><br><span class="line">    + base64.encodebytes(<span class="built_in">bytes</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x: x &amp; <span class="number">0xFF</span>, publicKey)))</span><br><span class="line">    + <span class="string">b&quot;-----END PUBLIC KEY-----&quot;</span></span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(privateKey.decode())</span><br><span class="line"><span class="built_in">print</span>(publicKey.decode())</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(</span></span><br><span class="line"><span class="comment">#     list(</span></span><br><span class="line"><span class="comment">#         map(</span></span><br><span class="line"><span class="comment">#             lambda x: list(map(lambda y: (y[0].name, y[1]), x.items())),</span></span><br><span class="line"><span class="comment">#             a.field_data.values(),</span></span><br><span class="line"><span class="comment">#         )</span></span><br><span class="line"><span class="comment">#     )</span></span><br><span class="line"><span class="comment"># )</span></span><br></pre></td></tr></table></figure>
<p>2private_keycookieAES keyHMAC keyAESHMACkey</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_v1_5</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hexdump</span><br><span class="line"> </span><br><span class="line">PRIVATE_KEY = <span class="string">&quot;&quot;&quot;-----BEGIN PRIVATE KEY-----</span></span><br><span class="line"><span class="string">MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBAL0M6FR0Cb9dW52Nd5NTA1JUNAs1</span></span><br><span class="line"><span class="string">thS8iXx6QB+UkN/vRJdfsKS8dnOfNuPuPDCtx26B2j8I1FuTJ1VrrfDkzN585sskmXYronFM98Dx</span></span><br><span class="line"><span class="string">50vHaadOcDcDdBBqi8gC5/D3iKflX6T9pSL/5PVLfN1EIaFsyAS9jpWX2wGNi3C/QPSrAgMBAAEC</span></span><br><span class="line"><span class="string">gYAdNhXeGtH4wkWqOhY8aurL+VvTUZjRanJ6C+/FkXCzUWbRVwVV5xMMeZEDNigRw4BZ2HGvJL+f</span></span><br><span class="line"><span class="string">aMT+o3VMkCYBhGbi2/3RPRgigMG7Aa3LWWtYWsdbw8Mw6aqqbTjDUHrQ1kulMf1JvXJL5LBd+pBA</span></span><br><span class="line"><span class="string">Q8kHaYJRMcmnLsT4NeXOFQJBAMNa2r+phrThTlagMB6bj6vl0IVbDy+TJT2VybCSJ76rPgVUQwtP</span></span><br><span class="line"><span class="string">yX3z7UAjt27mE8KK+k7Jidi0drCEPv5Wo60CQQD3vQbO64fko1dlatkNn095GO9KoCuanrsLs+vY   </span></span><br><span class="line"><span class="string">Ohc0ltk4EhHHmP5hEE6dSMZNASKaN0wSYJ14xjnA+dJWOES3AkEApzyYF4vhLefTUIVBrHIvxFCw   </span></span><br><span class="line"><span class="string">+fjCP1AQiXA5gVcdfzTJm3ZPDtf2/kRbzpTE68M7F0gykFAoGcQj92i/JKy24QJAdyVbA+M07Ro9   </span></span><br><span class="line"><span class="string">qxHzJ+EJmMUMOMjFj8xtStiSQeDWTj2KZLQUBvmmxcnQ9UYN0PUNzjtwA5qhwXccSZoctcjECwJA   </span></span><br><span class="line"><span class="string">Zc0TZgGq/OwgnIyj/1+Q9D0A2eg3aw1k+6Vzkf/DdkuF6+XTkYTlBGiETIK/vm1rCH4NcOCL7eK5   </span></span><br><span class="line"><span class="string">qpA1grg+gg==</span></span><br><span class="line"><span class="string">-----END PRIVATE KEY-----&quot;&quot;&quot;</span></span><br><span class="line"> </span><br><span class="line">encode_data = <span class="string">&quot;j+ojKDVPlCr7lT9yzNinkj1DgdkcRaLMT2kL4U+9TvdFBZqGKk7/4WF/W7JhEieC3DoRfngRppMAVHa3yfhp4HZm/ZeNY4bc8rlYL11Q0dXDzpR5JjhqN+hGe9RBqPznoukShgQLhxT/DO7djxE5ROzi6NC52yZAaGPCSeLDyjg=&quot;</span></span><br><span class="line">base64_key = <span class="string">&quot;&quot;&quot;&quot;&quot;&quot;</span></span><br><span class="line"> </span><br><span class="line">private_key = RSA.import_key(PRIVATE_KEY.<span class="built_in">format</span>(base64_key).encode())</span><br><span class="line">cipher = PKCS1_v1_5.new(private_key)</span><br><span class="line">ciphertext = cipher.decrypt(base64.b64decode(encode_data), <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isFlag</span>(<span class="params">var, flag</span>):</span><br><span class="line">	<span class="keyword">return</span> (var &amp; flag) == flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">toIP</span>(<span class="params">var</span>):</span><br><span class="line">	var2 = (var &amp; -<span class="number">16777216</span>) &gt;&gt; <span class="number">24</span></span><br><span class="line">	var4 = (var &amp; <span class="number">16711680</span>) &gt;&gt; <span class="number">16</span></span><br><span class="line">	var6 = (var &amp; <span class="number">65280</span>) &gt;&gt; <span class="number">8</span></span><br><span class="line">	var8 = var &amp; <span class="number">255</span></span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">str</span>(var2) + <span class="string">&quot;.&quot;</span> + <span class="built_in">str</span>(var4) + <span class="string">&quot;.&quot;</span> + <span class="built_in">str</span>(var6) + <span class="string">&quot;.&quot;</span> + <span class="built_in">str</span>(var8)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getName</span>(<span class="params">var0</span>):</span><br><span class="line">	<span class="keyword">if</span> var0 == <span class="number">37</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM037&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">437</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM437&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">500</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM500&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">708</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-6&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">709</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">710</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">720</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM437&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">737</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-IBM737&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">775</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM775&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">850</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM850&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">852</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM852&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">855</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM855&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">857</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM857&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">858</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM00858&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">860</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM860&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">861</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM861&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">862</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM862&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">863</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM863&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">864</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM864&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">865</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM865&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">866</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM866&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">869</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM869&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">870</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM870&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">874</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-windows-874&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">875</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM875&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">932</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Shift_JIS&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">936</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-mswin-936&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">949</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-windows-949&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">950</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Big5&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1026</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM1026&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1047</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM1047&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1140</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01140&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1141</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01141&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1142</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01142&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1143</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01143&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1144</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01144&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1145</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01145&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1146</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01146&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1147</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01147&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1148</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01148&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1149</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01149&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1200</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;UTF-16LE&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1201</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;UTF-16BE&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1250</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1250&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1251</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1251&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1252</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1252&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1253</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1253&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1254</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1254&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1255</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1255&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1256</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1256&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1257</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1257&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1258</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1258&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1361</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-Johab&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10000</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacRoman&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10001</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10002</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10003</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10004</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacArabic&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10005</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacHebrew&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10006</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacGreek&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10007</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacCyrillic&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10008</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10010</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacRomania&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10017</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacUkraine&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10021</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacThai&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10029</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacCentralEurope&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10079</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacIceland&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10081</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacTurkish&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10082</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacCroatian&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">12000</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;UTF-32LE&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">12001</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;UTF-32BE&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20000</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISO-2022-CN-CNS&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20001</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20002</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20003</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20004</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20005</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20105</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20106</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20107</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20108</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20127</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;US-ASCII&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20261</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20269</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20273</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM273&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20277</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM277&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20278</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM278&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20280</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM280&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20284</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM284&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20285</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM285&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20290</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM290&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20297</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM297&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20420</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM420&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20423</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20424</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM424&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20833</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20838</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM-Thai&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20866</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;KOI8-R&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20871</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM871&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20880</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20905</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20924</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20932</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;EUC-JP&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20936</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;GB2312&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20949</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">21025</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-IBM1025&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">21027</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">21866</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;KOI8-U&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28591</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-1&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28592</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-2&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28593</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-3&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28594</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-4&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28595</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-5&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28596</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-6&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28597</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-7&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28598</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-8&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28599</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-9&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28603</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-13&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28605</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-15&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">29001</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">38598</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-8&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50220</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-2022-JP&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50221</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-2022-JP-2&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50222</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-2022-JP&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50225</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-2022-KR&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50227</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-2022-CN&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50229</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-2022-CN&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50930</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-IBM930&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50931</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50933</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-IBM933&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50935</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-IBM935&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50936</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50937</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-IBM937&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50939</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-IBM939&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">51932</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;EUC-JP&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">51936</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;GB2312&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">51949</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;EUC-KR&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">51950</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">52936</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;GB2312&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">54936</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;GB18030&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57002</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57003</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57004</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57005</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57006</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57007</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57008</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57009</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57010</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57011</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">65000</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">65001</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;UTF-8&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ciphertext[<span class="number">0</span>:<span class="number">4</span>] == <span class="string">b&#x27;\x00\x00\xBE\xEF&#x27;</span>:</span><br><span class="line"></span><br><span class="line">	<span class="comment"># 16</span></span><br><span class="line">	raw_aes_keys = ciphertext[<span class="number">8</span>:<span class="number">24</span>]</span><br><span class="line"></span><br><span class="line">	<span class="comment"># 2</span></span><br><span class="line">	var9 = ciphertext[<span class="number">24</span>:<span class="number">26</span>]</span><br><span class="line">	var9 = <span class="built_in">int</span>.from_bytes(var9, byteorder=<span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	var9 = getName(var9)</span><br><span class="line">	<span class="comment"># 2</span></span><br><span class="line">	var10 = ciphertext[<span class="number">26</span>:<span class="number">28</span>]</span><br><span class="line">	var10 = <span class="built_in">int</span>.from_bytes(var10, byteorder=<span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	var10 = getName(var10)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># 4</span></span><br><span class="line">	<span class="built_in">id</span> = ciphertext[<span class="number">28</span>:<span class="number">32</span>]</span><br><span class="line">	<span class="built_in">id</span> = <span class="built_in">int</span>.from_bytes(<span class="built_in">id</span>, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	<span class="comment">#print(&quot;Beacon id:&#123;&#125;&quot;.format(id))</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 4</span></span><br><span class="line">	pid = ciphertext[<span class="number">32</span>:<span class="number">36</span>]</span><br><span class="line">	pid = <span class="built_in">int</span>.from_bytes(pid, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	<span class="comment">#print(&quot;pid:&#123;&#125;&quot;.format(pid))</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 2</span></span><br><span class="line">	port = ciphertext[<span class="number">36</span>:<span class="number">38</span>]</span><br><span class="line">	port = <span class="built_in">int</span>.from_bytes(port, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	<span class="comment">#print(&quot;port:&#123;&#125;&quot;.format(port))</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 1</span></span><br><span class="line">	flag = ciphertext[<span class="number">38</span>:<span class="number">39</span>]</span><br><span class="line">	flag = <span class="built_in">int</span>.from_bytes(flag, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	<span class="comment"># print(flag)</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> isFlag(flag, <span class="number">1</span>):</span><br><span class="line">		barch = <span class="string">&quot;&quot;</span></span><br><span class="line">		pid = <span class="string">&quot;&quot;</span></span><br><span class="line">		is64 = <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> isFlag(flag, <span class="number">2</span>):</span><br><span class="line">		barch = <span class="string">&quot;x64&quot;</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		barch = <span class="string">&quot;x86&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> isFlag(flag, <span class="number">4</span>):</span><br><span class="line">		is64 = <span class="string">&quot;1&quot;</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		is64 = <span class="string">&quot;0&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> isFlag(flag, <span class="number">8</span>):</span><br><span class="line">		bypassuac = <span class="string">&quot;True&quot;</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		bypassuac = <span class="string">&quot;False&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">#print(&quot;barch:&quot; + barch)</span></span><br><span class="line">	<span class="comment">#print(&quot;is64:&quot; + is64)</span></span><br><span class="line">	<span class="comment">#print(&quot;bypass:&quot; + bypassuac)</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 2</span></span><br><span class="line">	var_1 = ciphertext[<span class="number">39</span>:<span class="number">40</span>]</span><br><span class="line">	var_2 = ciphertext[<span class="number">40</span>:<span class="number">41</span>]</span><br><span class="line">	var_1 = <span class="built_in">int</span>.from_bytes(var_1, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	var_2 = <span class="built_in">int</span>.from_bytes(var_2, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	windows_var = <span class="built_in">str</span>(var_1) + <span class="string">&quot;.&quot;</span> + <span class="built_in">str</span>(var_2)</span><br><span class="line">	<span class="comment">#print(&quot;windows var:&quot; + windows_var)</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 2</span></span><br><span class="line">	windows_build = ciphertext[<span class="number">41</span>:<span class="number">43</span>]</span><br><span class="line">	windows_build = <span class="built_in">int</span>.from_bytes(windows_build, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	<span class="comment">#print(&quot;windows build:&#123;&#125;&quot;.format(windows_build))</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 4</span></span><br><span class="line">	x64_P = ciphertext[<span class="number">43</span>:<span class="number">47</span>]</span><br><span class="line"></span><br><span class="line">	<span class="comment"># 4</span></span><br><span class="line">	ptr_gmh = ciphertext[<span class="number">47</span>:<span class="number">51</span>]</span><br><span class="line">	<span class="comment"># 4</span></span><br><span class="line">	ptr_gpa = ciphertext[<span class="number">51</span>:<span class="number">55</span>]</span><br><span class="line"></span><br><span class="line">	<span class="comment"># if (&quot;x64&quot;.equals(this.barch)) &#123;</span></span><br><span class="line">	<span class="comment"># this.ptr_gmh = CommonUtils.join(var10, this.ptr_gmh)</span></span><br><span class="line">	<span class="comment"># this.ptr_gpa = CommonUtils.join(var10, this.ptr_gpa)</span></span><br><span class="line">	<span class="comment"># &#125;</span></span><br><span class="line">	<span class="comment">#</span></span><br><span class="line">	<span class="comment"># this.ptr_gmh = CommonUtils.bswap(this.ptr_gmh)</span></span><br><span class="line">	<span class="comment"># this.ptr_gpa = CommonUtils.bswap(this.ptr_gpa)</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 4</span></span><br><span class="line">	intz = ciphertext[<span class="number">55</span>:<span class="number">59</span>]</span><br><span class="line">	intz = <span class="built_in">int</span>.from_bytes(intz, byteorder=<span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	intz = toIP(intz)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> intz == <span class="string">&quot;0.0.0.0&quot;</span>:</span><br><span class="line">		intz = <span class="string">&quot;unknown&quot;</span></span><br><span class="line">	<span class="comment">#print(&quot;host:&quot; + intz)</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> var9 == <span class="literal">None</span>:</span><br><span class="line">		ddata = ciphertext[<span class="number">59</span>:<span class="built_in">len</span>(ciphertext)].decode(<span class="string">&quot;ISO8859-1&quot;</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="comment"># ??x-mswin-936</span></span><br><span class="line">		<span class="comment"># ddata = ciphertext[59:len(ciphertext)].decode(var9)</span></span><br><span class="line">		ddata = ciphertext[<span class="number">59</span>:<span class="built_in">len</span>(ciphertext)].decode(<span class="string">&quot;ISO8859-1&quot;</span>)</span><br><span class="line"></span><br><span class="line">	ddata = ddata.split(<span class="string">&quot;\t&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(ddata) &gt; <span class="number">0</span>:</span><br><span class="line">		computer = ddata[<span class="number">0</span>]</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(ddata) &gt; <span class="number">1</span>:</span><br><span class="line">		username = ddata[<span class="number">1</span>]</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(ddata) &gt; <span class="number">2</span>:</span><br><span class="line">		process = ddata[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">	<span class="comment">#print(&quot;PC name:&quot; + computer)</span></span><br><span class="line">	<span class="comment">#print(&quot;username:&quot; + username)</span></span><br><span class="line">	<span class="comment">#print(&quot;process name:&quot; + process)</span></span><br><span class="line"></span><br><span class="line">	raw_aes_hash256 = hashlib.sha256(raw_aes_keys)</span><br><span class="line">	digest = raw_aes_hash256.digest()</span><br><span class="line">	aes_key = digest[<span class="number">0</span>:<span class="number">16</span>]</span><br><span class="line">	hmac_key = digest[<span class="number">16</span>:]</span><br><span class="line"></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;AES key:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(aes_key.<span class="built_in">hex</span>()))</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;HMAC key:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(hmac_key.<span class="built_in">hex</span>()))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">#print(hexdump.hexdump(ciphertext))</span></span><br></pre></td></tr></table></figure>
<p>3base64tcp</p>
<p><img src="/post/ccf22797/image-20230910155301194.png" alt="image-20230910155301194"></p>
<p></p>
<p><img src="/post/ccf22797/image-20230910155542125.png" alt="image-20230910155542125"></p>
<p>base64</p>
<p><img src="/post/ccf22797/image-20230910155529969.png" alt="image-20230910155529969"></p>
<p>4</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Beacon</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> hexdump</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compare_mac</span>(<span class="params">mac, mac_verif</span>):</span><br><span class="line">	<span class="keyword">if</span> mac == mac_verif:</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(mac) != <span class="built_in">len</span>(mac_verif):</span><br><span class="line">		<span class="built_in">print</span></span><br><span class="line">		<span class="string">&quot;invalid MAC size&quot;</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">	result = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(mac, mac_verif):</span><br><span class="line">		result |= x ^ y</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> result == <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">encrypted_data, iv_bytes, signature, shared_key, hmac_key</span>):</span><br><span class="line">	<span class="keyword">if</span> <span class="keyword">not</span> compare_mac(hmac.new(hmac_key, encrypted_data, digestmod=<span class="string">&quot;sha256&quot;</span>).digest()[<span class="number">0</span>:<span class="number">16</span>], signature):</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&quot;message authentication failed&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">	cypher = AES.new(shared_key, AES.MODE_CBC, iv_bytes)</span><br><span class="line">	data = cypher.decrypt(encrypted_data)</span><br><span class="line">	<span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="comment">#keyBeacon_metadata_RSA_Decrypt.py</span></span><br><span class="line">SHARED_KEY = binascii.unhexlify(<span class="string">&quot;2f793b0251bb6c09bda982cb159cd611&quot;</span>)</span><br><span class="line">HMAC_KEY = binascii.unhexlify(<span class="string">&quot;e5695e8bf533009cd4a3c950d447b032&quot;</span>)</span><br><span class="line"></span><br><span class="line">encrypt_data=<span class="string">&quot;AAAAwNR1s4ymDHA08b2cCeYKryK3UKJK0G2nKl/svxd3sD2WvktAWL1hS0gvdfXP7XmLpCd3CgYHRMvh9bWGrKW/2ANbWBQEYp1Lv+iIsuBpLdxanTNqAEOnre/71JK8hUKuJ32lY88IsDwgFFjvH0l3lwDOwgtXtOe6mhxvhuxUK8ourv/sii2KGiMOacqaRI2bOtOBcEal00/bBj85FcE+W6PmmGbF0Q9BvUvQmDT9C+J2H12SZqwwAbFGVJwntkDq7Q==&quot;</span></span><br><span class="line"></span><br><span class="line">encrypt_data=base64.b64decode(encrypt_data)</span><br><span class="line"></span><br><span class="line">encrypt_data_length=encrypt_data[<span class="number">0</span>:<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">encrypt_data_length=<span class="built_in">int</span>.from_bytes(encrypt_data_length, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">encrypt_data_l = encrypt_data[<span class="number">4</span>:<span class="built_in">len</span>(encrypt_data)]</span><br><span class="line"></span><br><span class="line">data1=encrypt_data_l[<span class="number">0</span>:encrypt_data_length-<span class="number">16</span>]</span><br><span class="line">signature=encrypt_data_l[encrypt_data_length-<span class="number">16</span>:encrypt_data_length]</span><br><span class="line">iv_bytes = <span class="built_in">bytes</span>(<span class="string">&quot;abcdefghijklmnop&quot;</span>,<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">dec=decrypt(data1,iv_bytes,signature,SHARED_KEY,HMAC_KEY)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">counter = dec[<span class="number">0</span>:<span class="number">4</span>]</span><br><span class="line">counter=<span class="built_in">int</span>.from_bytes(counter, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;counter:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(counter))</span><br><span class="line"></span><br><span class="line">dec_length = dec[<span class="number">4</span>:<span class="number">8</span>]</span><br><span class="line">dec_length=<span class="built_in">int</span>.from_bytes(dec_length, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(dec_length))</span><br><span class="line"></span><br><span class="line">de_data= dec[<span class="number">8</span>:<span class="built_in">len</span>(dec)]</span><br><span class="line">Task_type=de_data[<span class="number">0</span>:<span class="number">4</span>]</span><br><span class="line">Task_type=<span class="built_in">int</span>.from_bytes(Task_type, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(Task_type))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(de_data)</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(hexdump.hexdump(dec))</span></span><br></pre></td></tr></table></figure>
<p>base32</p>
<p><img src="/post/ccf22797/image-20230910155718568.png" alt="image-20230910155718568"></p>
<p>flag</p>
<p><img src="/post/ccf22797/image-20230910155756436.png" alt="image-20230910155756436"></p>
<p>flag</p>
<p><strong>SICTF{79e1755e-08a8-4d3d-9385-4c0541549995}</strong></p>
<p><br></p>
<p><br></p>
<h3 id=""><a href="#" class="headerlink" title=""></a></h3><p></p>
]]></content>
      <categories>
        <category>wp-misc</category>
      </categories>
  </entry>
  <entry>
    <title>misc()</title>
    <url>/post/77e39860.html</url>
    <content><![CDATA[<p>CNSS 2023miscCrypto <strong>misc</strong> </p>
<span id="more"></span>
<h2 id="-Shino--Crypto-"><a href="#-Shino--Crypto-" class="headerlink" title=" Shino  Crypto "></a> Shino  Crypto </h2><p>2023-CNSS-Summer</p>
<p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> Shino  Crypto </span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc 47.108.140.140 11037</span><br></pre></td></tr></table></figure>
<p>Hint</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1pwntools</span><br><span class="line">2cnss&#123;a-zA-Z0-9_&#125;</span><br><span class="line">   &#125; flag </span><br><span class="line">   flag  50</span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> cipher, key</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Encoder</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.stream = self.randomBox(self._init_box(key))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">do_encrypt</span>(<span class="params">self, c</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">ord</span>(c) ^ <span class="built_in">next</span>(self.stream)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_init_box</span>(<span class="params">self, crypt_key</span>):</span><br><span class="line">        Box = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">        key_length = <span class="built_in">len</span>(crypt_key)</span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            index = <span class="built_in">ord</span>(crypt_key[(i % key_length)])</span><br><span class="line">            j = (j + Box[i] + index) % <span class="number">256</span></span><br><span class="line">            Box[i], Box[j] = Box[j], Box[i]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Box</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">randomBox</span>(<span class="params">self, S</span>):</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            i = i + <span class="number">1</span> &amp; <span class="number">255</span></span><br><span class="line">            j = j + S[i] &amp; <span class="number">255</span></span><br><span class="line">            S[i], S[j] = S[j], S[i]</span><br><span class="line">            <span class="keyword">yield</span> S[(S[i] + S[j] &amp; <span class="number">255</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">encoder = Encoder()</span><br><span class="line">flag = <span class="built_in">input</span>(<span class="string">&quot;input flag&gt;&gt; &quot;</span>)</span><br><span class="line">table = string.digits + string.ascii_letters + <span class="string">&quot;&#123;&#125;_&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">correct = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="built_in">len</span>(flag):</span><br><span class="line">    <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(flag) <span class="keyword">and</span> flag[i] <span class="keyword">not</span> <span class="keyword">in</span> table:</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> i &gt;= <span class="built_in">len</span>(flag):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> cipher[i] != encoder.do_encrypt(flag[i]):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong flag!&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        correct += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> correct == <span class="built_in">len</span>(cipher):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Correct flag!&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Wrong flag!&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>RC4RC4</p>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">encoder = Encoder()</span><br><span class="line">flag = <span class="built_in">input</span>(<span class="string">&quot;input flag&gt;&gt; &quot;</span>)</span><br><span class="line">table = string.digits + string.ascii_letters + <span class="string">&quot;&#123;&#125;_&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">correct = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="built_in">len</span>(flag):</span><br><span class="line">    <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(flag) <span class="keyword">and</span> flag[i] <span class="keyword">not</span> <span class="keyword">in</span> table:</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> i &gt;= <span class="built_in">len</span>(flag):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> cipher[i] != encoder.do_encrypt(flag[i]):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong flag!&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        correct += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> correct == <span class="built_in">len</span>(cipher):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Correct flag!&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Wrong flag!&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>flagflagRC4flagCorrect flag!</p>
<p>flagflagRC4(flagsecret)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag = <span class="built_in">input</span>(<span class="string">&quot;input flag&gt;&gt; &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(flag == secret):</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;Correct flag!&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;Wrong flag!&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>flag</p>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> i &lt; <span class="built_in">len</span>(flag):</span><br><span class="line">    <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(flag) <span class="keyword">and</span> flag[i] <span class="keyword">not</span> <span class="keyword">in</span> table:</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> i &gt;= <span class="built_in">len</span>(flag):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> cipher[i] != encoder.do_encrypt(flag[i]):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong flag!&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p></p>
<ul>
<li>flagtabletable i </li>
<li> i flag</li>
<li>cipher[i]encrypt(flag[i])cipher</li>
</ul>
<p></p>
<ul>
<li>flagWrong flag!</li>
<li>cipher[i]</li>
</ul>
<p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag = &quot;cnss&#123;1234567890abcdefgh&#125;&quot;</span><br><span class="line">flag = chr(0) * 50 + &quot;c&quot;</span><br></pre></td></tr></table></figure>
<p></p>
<p>tableflagWrong flag!</p>
<p>ASCII0table</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> i &lt; <span class="built_in">len</span>(flag) <span class="keyword">and</span> flag[i] <span class="keyword">not</span> <span class="keyword">in</span> table:</span><br><span class="line">    i += <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>51cctablei=51flag50</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> cipher[i] != encoder.do_encrypt(flag[i]):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Wrong flag!&quot;</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>cipher[i]Wrong flag!</p>
<p>flag</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag = <span class="built_in">chr</span>(<span class="number">0</span>) * <span class="number">49</span> + <span class="string">&quot;c&quot;</span></span><br><span class="line">flag = <span class="built_in">chr</span>(<span class="number">0</span>) * <span class="number">48</span> + <span class="string">&quot;c&quot;</span></span><br><span class="line">flag = <span class="built_in">chr</span>(<span class="number">0</span>) * <span class="number">47</span> + <span class="string">&quot;c&quot;</span></span><br><span class="line">......</span><br></pre></td></tr></table></figure>
<p>flag30cipher29cipher[30]</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag = <span class="built_in">chr</span>(<span class="number">0</span>) * <span class="number">49</span> + <span class="string">&quot;c&quot;</span></span><br><span class="line">flag = <span class="built_in">chr</span>(<span class="number">0</span>) * <span class="number">48</span> + <span class="string">&quot;c&quot;</span></span><br><span class="line">flag = <span class="built_in">chr</span>(<span class="number">0</span>) * <span class="number">47</span> + <span class="string">&quot;c&quot;</span></span><br><span class="line">......</span><br><span class="line">flag = <span class="built_in">chr</span>(<span class="number">0</span>) * <span class="number">30</span> + <span class="string">&quot;c&quot;</span></span><br></pre></td></tr></table></figure>
<p>flag</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag = <span class="built_in">chr</span>(<span class="number">0</span>) * <span class="number">29</span> + <span class="string">&quot;c&quot;</span></span><br></pre></td></tr></table></figure>
<p>Wrong flag!</p>
<p>flag24</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> table:</span><br><span class="line">	flag = <span class="string">&quot;cnss&#123;&quot;</span> + i + <span class="built_in">chr</span>(<span class="number">0</span>)*<span class="number">100</span> + <span class="string">&quot;a&quot;</span></span><br></pre></td></tr></table></figure>
<p>iWrong flag!a</p>
<p> 1 cnss{</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> table:</span><br><span class="line">	flag = <span class="string">&quot;cnss&#123;1&quot;</span> + i + <span class="built_in">chr</span>(<span class="number">0</span>)*<span class="number">100</span> + <span class="string">&quot;a&quot;</span></span><br></pre></td></tr></table></figure>
<p>flag24</p>
<p>pwntools</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">table = string.digits + string.ascii_letters + <span class="string">&quot;&#123;&#125;_&quot;</span></span><br><span class="line"></span><br><span class="line">init = <span class="string">b&#x27;cnss&#123;&#x27;</span></span><br><span class="line">has_find = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span>(has_find == <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(table)):</span><br><span class="line">        r=remote(<span class="string">&quot;47.108.140.140&quot;</span>,<span class="number">11037</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r.sendline(init + long_to_bytes(<span class="built_in">ord</span>(table[i])) + <span class="string">b&#x27;\x00&#x27;</span>*<span class="number">100</span> + <span class="string">b&quot;a&quot;</span>)</span><br><span class="line">            temp = r.recvline()</span><br><span class="line">            <span class="keyword">if</span>(<span class="string">b&quot;Correct&quot;</span> <span class="keyword">in</span> temp):</span><br><span class="line">                exit(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">len</span>(init) == <span class="number">23</span>):</span><br><span class="line">                has_find = <span class="number">1</span></span><br><span class="line">                r.close()</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            init += long_to_bytes(<span class="built_in">ord</span>(table[i]))</span><br><span class="line">            <span class="built_in">print</span>(init)</span><br><span class="line">            r.close()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        r.close()</span><br><span class="line"><span class="built_in">print</span>(init + <span class="string">b&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>flag</p>
<p><strong>cnss{1nd3X_0Ut_oF_r4nge}</strong></p>
<p><br></p>
<p></p>
]]></content>
      <categories>
        <category>misc</category>
      </categories>
  </entry>
  <entry>
    <title>misc()</title>
    <url>/post/d8d20302.html</url>
    <content><![CDATA[<p>misccrypto</p>
<span id="more"></span>
<h2 id="MISC-3"><a href="#MISC-3" class="headerlink" title="MISC.3"></a>MISC.3</h2><p>CISG 2015</p>
<p></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flagflagflag&#123;&#125;</span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> unpack</span><br><span class="line"></span><br><span class="line">state = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rand</span>():</span><br><span class="line">    <span class="keyword">global</span> state</span><br><span class="line">    state = (state * <span class="number">1103515425</span> + <span class="number">54321</span>) &amp; <span class="number">0x3fffffff</span></span><br><span class="line">    <span class="keyword">return</span> state</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">srand</span>(<span class="params">seed</span>):</span><br><span class="line">    <span class="keyword">global</span> state</span><br><span class="line">    state = seed</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">data,key</span>):</span><br><span class="line">    srand(key)</span><br><span class="line">    cipher = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> data:</span><br><span class="line">        cipher += pack(<span class="string">&quot;i&quot;</span>,(<span class="built_in">ord</span>(c)&lt;&lt;<span class="number">22</span>) + rand())</span><br><span class="line">    <span class="keyword">return</span> cipher</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">data,key</span>):</span><br><span class="line">    srand(key)</span><br><span class="line">    plain = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(data),<span class="number">4</span>):</span><br><span class="line">        temp = unpack(<span class="string">&quot;i&quot;</span>,data[i:i+<span class="number">4</span>])[<span class="number">0</span>] - rand()</span><br><span class="line">        plain += <span class="built_in">chr</span>(temp &gt;&gt; <span class="number">22</span>)</span><br><span class="line">    <span class="keyword">return</span> plain</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    f1 = <span class="built_in">open</span>(<span class="string">&quot;plaintext&quot;</span>,<span class="string">&quot;rb&quot;</span>)</span><br><span class="line">    f2 = <span class="built_in">open</span>(<span class="string">&quot;ciphertext&quot;</span>,<span class="string">&quot;wb&quot;</span>)</span><br><span class="line">    data = f1.read()</span><br><span class="line">    <span class="keyword">from</span> secretfile <span class="keyword">import</span> secretkey</span><br><span class="line">    data = encrypt(data,secretkey)</span><br><span class="line">    f2.write(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()    </span><br></pre></td></tr></table></figure>
<p>ciphertext</p>
<p></p>
<ul>
<li>secretfilesecretkey</li>
<li>ASCII22rand()</li>
<li>packciphertext</li>
</ul>
<p>wp</p>
<p><a href="https://geekorz.com/post/cigs2015/">CISG2015 MISC.3 (geekorz.com)</a></p>
<p></p>
<p><img src="/post/d8d20302/image-20230913142928566.png" alt="image-20230913142928566"></p>
<p>LCGLCG</p>
<ul>
<li>x &amp; 0x3fffffffx</li>
<li>x mod (0x3fffffff + 1)x</li>
</ul>
<p>key</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> unpack</span><br><span class="line"></span><br><span class="line">state = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rand</span>():</span><br><span class="line">    <span class="keyword">global</span> state</span><br><span class="line">    state = (state * <span class="number">1103515425</span> + <span class="number">54321</span>) &amp; <span class="number">0x3fffffff</span></span><br><span class="line">    <span class="keyword">return</span> state</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">srand</span>(<span class="params">seed</span>):</span><br><span class="line">    <span class="keyword">global</span> state</span><br><span class="line">    state = seed</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">data,key</span>):</span><br><span class="line">    srand(key)</span><br><span class="line">    cipher = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> data:</span><br><span class="line">        cipher += pack(<span class="string">&quot;i&quot;</span>,(<span class="built_in">ord</span>(c)&lt;&lt;<span class="number">22</span>) + rand())</span><br><span class="line">    <span class="keyword">return</span> cipher</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">data</span>):</span><br><span class="line">    plain = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(data),<span class="number">4</span>):</span><br><span class="line">        temp = unpack(<span class="string">&quot;i&quot;</span>,data[i:i+<span class="number">4</span>])[<span class="number">0</span>]</span><br><span class="line">        plain.append(temp)</span><br><span class="line">    <span class="keyword">return</span> plain</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    f1 = <span class="built_in">open</span>(<span class="string">&quot;ciphertext&quot;</span>,<span class="string">&quot;rb&quot;</span>)</span><br><span class="line">    data = decrypt(f1.read())</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;j =&quot;</span>,j,<span class="string">&quot;:&quot;</span>,end = <span class="string">&quot; &quot;</span>)</span><br><span class="line">        key = ((data[<span class="number">0</span>] - (j&lt;&lt;<span class="number">22</span>)) - <span class="number">54321</span>) * inverse(<span class="number">1103515425</span>,(<span class="number">0x3fffffff</span> + <span class="number">1</span>))</span><br><span class="line">        <span class="built_in">print</span>(key,end = <span class="string">&quot;  &quot;</span>)</span><br><span class="line">        srand(key)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> data[<span class="number">0</span>:<span class="number">40</span>]:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">chr</span>((i - rand()) &gt;&gt; <span class="number">22</span>),end = <span class="string">&quot;&quot;</span>)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>,end = <span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()    </span><br></pre></td></tr></table></figure>
<p></p>
<ul>
<li>decryptdecryptunpack</li>
<li>main</li>
</ul>
<p>data[0]ordj</p>
<script type="math/tex; mode=display">
data[0] = (j<<22)+rand()</script><p>rand()</p>
<script type="math/tex; mode=display">
rand() = (state * 1103515425 + 54321) \quad (mod\;0x3fffffff + 1)</script><p>j256()256</p>
<p><img src="/post/d8d20302/image-20230913145528744.png" alt="image-20230913145528744"></p>
<p>j105</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line">+0lpfzK92vRhs6zyLUYE20n65i9s9GHFfw04XTb2BqKed1d35nuQX1hD5JRsou3m7dEEKGBIJCxUeAjPDgeixlQrAoZzFAlt541yJoyXxuEMGwaAqTXQlF+7pB/5S4vnZ85Lap2siP8q/jFYp87z7PXHmJ20opxy8yxnBsRPoWEs8glONXf1H+h4kkdTcCg+HfwGXqYrf0jyFBgAAAABJRU5ErkJggg==|flag is hidden in the above data It is a picture and you should base64decode it.</span><br></pre></td></tr></table></figure>
<p>base64</p>
<p><img src="/post/d8d20302/image-20230913145804385.png" alt="image-20230913145804385"></p>
<p></p>
<p>flag</p>
<p><strong>flag{tHis_1s_YOUR_flaaaaag}</strong></p>
<p>LCG</p>
]]></content>
      <categories>
        <category>misc</category>
      </categories>
  </entry>
</search>
