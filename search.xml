<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>2023-CNSS-Summer-wp-misc</title>
    <url>/post/22e56931.html</url>
    <content><![CDATA[<span id="more"></span>
<p>åšé¢˜è®°å½•</p>
<h3 id="â¤ï¸-Signin"><a href="#â¤ï¸-Signin" class="headerlink" title="â¤ï¸ Signin"></a>â¤ï¸ Signin</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¬è¯´æœ‰äººåœ¨CNSSæ‹›æ–°ç¾¤çš„æŸä¸ªåœ°æ–¹è—äº†ä¸€ä¸ªéšç§˜çš„flagï¼Œåˆ°åº•åœ¨å“ªå‘¢ï¼Ÿ</span><br><span class="line">å¿«æ¥åŠ å…¥æ‹›æ–°ç¾¤431060996</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼šæŒ‰ç…§è¦æ±‚æœç´¢ç¾¤èŠï¼Œç¾¤èŠä»‹ç»ä¸­æœ‰ä¸€æ®µbase64ï¼Œè§£å¯†å¾—flagï¼š</p>
<p><img src="/post/22e56931/image-20230911100902419.png" alt="image-20230911100902419"></p>
<p>flagï¼š</p>
<p><strong>cnss{W3Lc0m3_7o_Cn55_5umm3rï¼}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="ğŸ”-ä¾¦æ¢-CNSS-å¨˜çš„ç§˜å¯†"><a href="#ğŸ”-ä¾¦æ¢-CNSS-å¨˜çš„ç§˜å¯†" class="headerlink" title="ğŸ” ä¾¦æ¢ CNSS å¨˜çš„ç§˜å¯†"></a>ğŸ” ä¾¦æ¢ CNSS å¨˜çš„ç§˜å¯†</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">æ‡’å¾—å†™æ–‡æ¡ˆäº†ï¼Œè¯•ç€æ‰¾å‡º CNSS å¨˜çš„ç§˜å¯†å§</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®é™„ä»¶ä¸ºä¸€å¼ å›¾ç‰‡ï¼š</p>
<p><img src="/post/22e56931/CNSSDoll.png" alt="CNSSDoll"></p>
<p>åå…­è¿›åˆ¶æ‰“å¼€ï¼Œåœ¨æ–‡ä»¶æœ«å°¾çœ‹åˆ°flagï¼š</p>
<p><img src="/post/22e56931/image-20230911101309673.png" alt="image-20230911101309673"></p>
<p>flagï¼š</p>
<p><strong>cnss{W0w!!!Y0u_s4ww_m3!}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="ğŸ†-é‡ç”Ÿä¹‹æˆ‘åœ¨-CNSS-å½“-OIer"><a href="#ğŸ†-é‡ç”Ÿä¹‹æˆ‘åœ¨-CNSS-å½“-OIer" class="headerlink" title="ğŸ† é‡ç”Ÿä¹‹æˆ‘åœ¨ CNSS å½“ OIer"></a>ğŸ† é‡ç”Ÿä¹‹æˆ‘åœ¨ CNSS å½“ OIer</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">é¢˜ç›®æè¿°å’Œè¾“å…¥è¾“å‡ºæ ¼å¼éƒ½æ‰¾ä¸åˆ°äº†...ä½†æ˜¯èº«ä¸ºè¶…çº§ OIER çš„ä½ ä¸€å®šå¯ä»¥ AC æœ¬é¢˜å§</span><br><span class="line"></span><br><span class="line">nc 47.108.140.140 1107</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">SRC = <span class="string">&#x27;/home/ctf/temp/code.c&#x27;</span></span><br><span class="line">BIN = <span class="string">&#x27;/home/ctf/temp/temp_bin&#x27;</span></span><br><span class="line">DATA = <span class="string">&#x27;/home/ctf/data&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">res_map = &#123;</span><br><span class="line">    <span class="string">&#x27;CE&#x27;</span>: <span class="string">&#x27;Compile Error&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;TLE&#x27;</span>: <span class="string">&#x27;Time Limit Exceeded&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;RE&#x27;</span>: <span class="string">&#x27;Runtime Error&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;WA&#x27;</span>: <span class="string">&#x27;Wrong Answer&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;AC&#x27;</span>: <span class="string">&#x27;Accepted&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_excutable</span>(<span class="params">path, <span class="built_in">input</span>, ans, timeout</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.isfile(path):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;CE&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        p = subprocess.run(</span><br><span class="line">            [<span class="string">f&quot;./<span class="subst">&#123;path&#125;</span>&quot;</span>],</span><br><span class="line">            <span class="built_in">input</span>=<span class="built_in">input</span>,</span><br><span class="line">            stdout=subprocess.PIPE,</span><br><span class="line">            stderr=subprocess.STDOUT,</span><br><span class="line">            timeout=timeout</span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">except</span> subprocess.TimeoutExpired:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;TLE&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> p.returncode != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;RE&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        output = p.stdout.decode()</span><br><span class="line">    <span class="keyword">except</span> UnicodeDecodeError:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;WA&#x27;</span></span><br><span class="line"></span><br><span class="line">    lines = output.strip().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;AC&#x27;</span> <span class="keyword">if</span> lines == ans <span class="keyword">else</span> <span class="string">&#x27;WA&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Enter your code (ending with two blank lines):&quot;</span>)</span><br><span class="line"></span><br><span class="line">    code1 = []</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            line = <span class="built_in">input</span>()</span><br><span class="line">        <span class="keyword">except</span> EOFError:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        code1.append(line)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(code1) &gt;= <span class="number">2</span> <span class="keyword">and</span> code1[-<span class="number">1</span>] == <span class="string">&#x27;&#x27;</span> <span class="keyword">and</span> code1[-<span class="number">2</span>] == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(SRC, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> fd1:</span><br><span class="line">        fd1.write(<span class="string">&#x27;\n&#x27;</span>.join(code1))</span><br><span class="line"></span><br><span class="line">    p = subprocess.run(</span><br><span class="line">        [<span class="string">&quot;gcc&quot;</span>, <span class="string">&quot;-w&quot;</span>, <span class="string">&quot;-O2&quot;</span>, SRC, <span class="string">&quot;-o&quot;</span>, BIN],</span><br><span class="line">        stdout=sys.stdout,</span><br><span class="line">        stdin=subprocess.DEVNULL,</span><br><span class="line">        stderr=subprocess.STDOUT</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(os.path.join(DATA, <span class="string">f&#x27;input.in&#x27;</span>), <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        instr = f.read()</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(os.path.join(DATA, <span class="string">f&#x27;output.out&#x27;</span>), <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        ans = f.read().strip().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    res = check_excutable(BIN, instr, ans, <span class="number">0.5</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Result: &#x27;</span>, res_map[res])</span><br><span class="line">    <span class="keyword">if</span> res == <span class="string">&#x27;AC&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>ç®€å•ç¿»è¯‘ä¸€ä¸‹ç¨‹åºåŠŸèƒ½ï¼šè¾“å…¥ä¸€æ®µcè¯­è¨€ä»£ç ï¼Œé€è‡³code.cä¸­ï¼Œè¿›è¡Œç¼–è¯‘åï¼Œå°†input.inä¸­çš„å†…å®¹ä½œä¸ºè¾“å…¥æ‰§è¡Œè¿™æ®µç¨‹åºï¼Œå¹¶å°†ç¨‹åºè¾“å‡ºç»“æœä¸output.outä¸­çš„å†…å®¹åšå¯¹æ¯”ï¼Œå¦‚æœç»“æœä¸€è‡´ï¼Œåˆ™ä¼šè¾“å‡ºflagã€‚</p>
<p>é—®é¢˜åœ¨äºï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“input.inä¸output.outçš„å†…å®¹æ˜¯ä»€ä¹ˆï¼Œä¹Ÿå°±æ— æ³•æ ¹æ®éœ€è¦å†™å‡ºå¯¹åº”ç¨‹åºã€‚å¯æ˜¯å…¶å®å†ä»”ç»†æƒ³æƒ³ï¼Œé¢˜ç›®è¦æ±‚å…¶å®ä»…ä»…æ˜¯è¦æ±‚ç¨‹åºå†…å®¹è¾“å‡ºä¸output.outå†…å®¹ä¸€è‡´è€Œå·²ï¼Œè€Œæ ¹æ®é¢˜ç›®é™„ä»¶ï¼Œoutput.outæ–‡ä»¶å°±åœ¨DATAç›®å½•ä¸‹ï¼Œæ‰€ä»¥å…¶å®åªéœ€è¦å†™ä¸€ä¸ªèƒ½æ‰“å°å‡ºoutput.outå†…å®¹çš„cè¯­è¨€ç¨‹åºå³å¯ã€‚</p>
<p>exp.cï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    FILE *file;</span><br><span class="line">    <span class="type">char</span> filename[] = <span class="string">&quot;/home/ctf/data/output.out&quot;</span>;</span><br><span class="line">    <span class="type">char</span> ch;</span><br><span class="line"></span><br><span class="line">    file = fopen(filename, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">while</span> ((ch = fgetc(file)) != EOF) &#123;</span><br><span class="line">        <span class="built_in">putchar</span>(ch);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fclose(file);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flagï¼š</p>
<p><img src="/post/22e56931/image-20230911102740014.png" alt="image-20230911102740014"></p>
<p>flagï¼š</p>
<p><strong>cnss{y0u_4re_U1tim34ate_01er!}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="â“-æ³»è¯ï¼Œäººåœ¨CNSSï¼Œåˆšæ‰“å®Œæ‹›æ–°"><a href="#â“-æ³»è¯ï¼Œäººåœ¨CNSSï¼Œåˆšæ‰“å®Œæ‹›æ–°" class="headerlink" title="â“ æ³»è¯ï¼Œäººåœ¨CNSSï¼Œåˆšæ‰“å®Œæ‹›æ–°"></a>â“ æ³»è¯ï¼Œäººåœ¨CNSSï¼Œåˆšæ‰“å®Œæ‹›æ–°</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å‚åŠ CNSSæ‹›æ–°èµ›æ˜¯ä¸€ç§æ€æ ·çš„ä½“éªŒå‘¢ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®çš„å…¨éƒ¨ä¿¡æ¯åªæœ‰é¢˜ç›®æ ‡é¢˜å’Œé¢˜ç›®æè¿°ï¼Œæ²¡æœ‰é™„ä»¶ã€æ²¡æœ‰é¶æœºï¼Œå› æ­¤åŸºæœ¬å¯ä»¥ç¡®å®šä¸ºç¤¾å·¥é¢˜ã€‚</p>
<p>ç›´æ¥æœç´¢é¢˜ç›®æè¿°ï¼Œå°±èƒ½åœ¨çŸ¥ä¹ä¸Šæœåˆ°ä¸€ä¸ªå›ç­”ï¼Œæœ€åå°±æœ‰flagï¼š</p>
<p><img src="/post/22e56931/image-20230911103024312.png" alt="image-20230911103024312"></p>
<p>flagï¼š</p>
<p><strong>cnss{L3T_U$_$T4RT!}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="ğŸ”®-æ±æ–¹å¸Œç¼‡ç¬¦"><a href="#ğŸ”®-æ±æ–¹å¸Œç¼‡ç¬¦" class="headerlink" title="ğŸ”® æ±æ–¹å¸Œç¼‡ç¬¦"></a>ğŸ”® æ±æ–¹å¸Œç¼‡ç¬¦</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¯•ç€æ‰¾å‡ºæœ€æ–°æœ€çƒ­ï¼ˆç¡®ä¿¡ï¼‰ä¸œæ–¹æ–°ä½œä¸­çš„ flag å§ï¼</span><br><span class="line">Hintï¼šflag åœ¨æ¸¸æˆèµ„æºåŒ…å†…</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ç»™äº†th08çš„æ¸¸æˆåŒ…ï¼Œç»“åˆhintçŸ¥é“åº”è¯¥æ˜¯è¦å¯¹èµ„æºåŒ…è§£åŒ…å¾—flagã€‚</p>
<p>thxxè§£åŒ…å‚è€ƒï¼š</p>
<p><a href="https://www.bilibili.com/read/cv13353380/">å…³äºä¸œæ–¹projectç³»åˆ—æ­£ä½œçš„é­”æ”¹æ•™ç¨‹ä»¥åŠæ³¨æ„äº‹é¡¹ - å“”å“©å“”å“© (bilibili.com)</a></p>
<p>è·Ÿç€ä¸€æ­¥ä¸€æ­¥åšï¼š</p>
<p>1ã€ä¸‹è½½å·¥å…·</p>
<p>2ã€é€‰æ‹©å¥½æ–‡ä»¶ä¸å¯¹åº”æ¸¸æˆ(th08)ï¼Œè¿›è¡Œè§£åŒ…</p>
<p><img src="/post/22e56931/image-20230911103506296.png" alt="image-20230911103506296"></p>
<p>3ã€åœ¨è§£åŒ…å¾—åˆ°çš„èµ„æºä¸­å‘ç°flag.txt</p>
<p><img src="/post/22e56931/image-20230911103618535.png" alt="image-20230911103618535"></p>
<p>flagï¼š</p>
<p><strong>cnss{Y0u_4re_T0uhou_M4st3er_n0w!}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="ğŸ”‘-Shino-çš„-Crypto-æ¢¦æƒ³"><a href="#ğŸ”‘-Shino-çš„-Crypto-æ¢¦æƒ³" class="headerlink" title="ğŸ”‘ Shino çš„ Crypto æ¢¦æƒ³"></a>ğŸ”‘ Shino çš„ Crypto æ¢¦æƒ³</h3><p>å‚è€ƒæˆ‘å¦ä¸€ç¯‡æ–‡ç« ï¼š</p>
<p><a href="https://tangcuxiaojikuai.xyz/post/77e39860.html#more">miscè¶£é¢˜(ä¸€) | ç³–é†‹å°é¸¡å—çš„blog (tangcuxiaojikuai.xyz)</a></p>
<p><br></p>
<p><br></p>
<h3 id="â˜ï¸-Hurrison-çš„ç½‘ç«™"><a href="#â˜ï¸-Hurrison-çš„ç½‘ç«™" class="headerlink" title="â˜ï¸ Hurrison çš„ç½‘ç«™"></a>â˜ï¸ Hurrison çš„ç½‘ç«™</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Hurrison åˆšåˆšå­¦ä¼šæ­å»ºç½‘ç«™ï¼Œå¬è¯´å¥—äº† Cloudflare ä¹‹åå¤§é»‘å®¢ Casio å°±æ‰¾ä¸åˆ°æœåŠ¡å™¨ IP äº†</span><br><span class="line">Hintï¼šflagæ ¼å¼å¦‚ä¸‹ï¼š</span><br><span class="line">cnss&#123;IPv4&#125;</span><br><span class="line">IPv4 æ ¼å¼ä¸º xxx.xxx.xxx.xxx</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://cnss2023catchme.hurrison.com/</span><br></pre></td></tr></table></figure>
<p>æ ¹æ®é¢˜ç›®æè¿°ï¼Œè¿™é¢˜æ˜¯è¦å¯»æ‰¾éšè—åœ¨Cloudflareä¸‹çš„æœåŠ¡å™¨ipåœ°å€ï¼Œç›´æ¥å¯¹è¿™ä¸ªè¦æ±‚è¿›è¡Œæœç´¢ï¼š</p>
<p><img src="/post/22e56931/image-20230911104238020.png" alt="image-20230911104238020"></p>
<p>é€ä¸ªå°è¯•æ–‡ç« ä¸­çš„æ–¹æ³•ï¼Œæœ€åå‘ç°è¿™ä¸ªæ–¹æ³•å¾ˆæœ‰æ•ˆæœï¼š</p>
<p><img src="/post/22e56931/image-20230911104618404.png" alt="image-20230911104618404"></p>
<p>åˆ°<a href="https://securitytrails.com/">SecurityTrails: Data Security, Threat Hunting, and Attack Surface Management Solutions for Security Teams</a>æœç´¢å¯¹åº”URLï¼Œå¹¶ä¸èƒ½ç›´æ¥åœ¨å†å²æ•°æ®é‡Œçœ‹åˆ°ç»“æœã€‚å¼€ä¸€å¼€è„‘æ´ï¼Œæœç´¢hurrison.comï¼Œå°±æœ‰å¾ˆå¤šå­åŸŸåï¼š</p>
<p><img src="/post/22e56931/image-20230911111836344.png" alt="image-20230911111836344"></p>
<p>é€ä¸ªæŸ¥çœ‹ï¼Œå¹¶ç»“åˆCensysé€ä¸ªæœç´¢åŸŸåï¼Œå¦‚ä¸‹ï¼š</p>
<p><img src="/post/22e56931/image-20230911112020297.png" alt="image-20230911112020297"></p>
<p>æ‰¾åˆ°ä¸€ä¸ªåœ¨ç»™å®šèŒƒå›´å†…çš„ipåœ°å€å°±å¯ä»¥äº†ã€‚</p>
<p>flagï¼š</p>
<p><strong>cnss{103.239.247.22}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="ğŸ’»-cn55Terminal"><a href="#ğŸ’»-cn55Terminal" class="headerlink" title="ğŸ’» cn55Terminal"></a>ğŸ’» cn55Terminal</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc 124.221.34.13 50024</span><br></pre></td></tr></table></figure>
<p>xshellæ‰“å¼€ï¼Œç¼©å°ç•Œé¢çœ‹åˆ°çš„å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<p><img src="/post/22e56931/image-20230911144054892.png" alt="image-20230911144054892"></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå‘½ä»¤è¡Œå‰çš„å†…å®¹ä»¥å­—ç¬¦ç”»çš„å½¢å¼å±•ç¤ºå‡ºæ¥äº†ï¼Œåˆç†çŒœæµ‹ï¼Œè¿™é“é¢˜çš„æ„æ€æ˜¯è¯†åˆ«å­—ç¬¦ç”»å½¢å¼çš„æŒ‡ä»¤å¹¶æ‰§è¡Œã€‚è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å°±éœ€è¦è¾“å…¥å­—ç¬¦ç”»å½¢å¼çš„linuxæŒ‡ä»¤ã€‚å…ˆè¯•ä¸€è¯•å°†é¢˜ç›®ç»™å‡ºçš„idä¸Šä¼ ï¼Œçœ‹çœ‹è¿”å›å†…å®¹ï¼š</p>
<p><img src="/post/22e56931/image-20230911144414307.png" alt="image-20230911144414307"></p>
<p>å¯ä»¥çœ‹å‡ºç¡®å®å’Œæƒ³è±¡çš„ä¸€æ¨¡ä¸€æ ·ï¼Œç»ˆç«¯æ‰§è¡Œäº†idæŒ‡ä»¤ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯æ‰¾è„šæœ¬ï¼Œå°†â€cat flagâ€ç”Ÿæˆä¸ºå­—ç¬¦ç”»ã€‚æœ€åæ‰¾åˆ°äº†ä¸€ä¸ªè„šæœ¬ï¼Œä½†æ˜¯ä»–åªèƒ½å°†å›¾ç‰‡è½¬åŒ–ä¸ºå­—ç¬¦ç”»ï¼Œæ²¡äº‹ï¼Œå…ˆç”Ÿæˆä¸€å¼ å›¾ç‰‡ï¼š</p>
<p><img src="/post/22e56931/image-20230911144603284.png" alt="image-20230911144603284"></p>
<p>ç„¶åç”¨å¦‚ä¸‹è„šæœ¬è½¬åŒ–ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&#x27;1.png&#x27;</span>)</span><br><span class="line">out_img = img.convert(<span class="string">&#x27;L&#x27;</span>)  <span class="comment"># å›¾ç‰‡è½¬æ¢ä¸ºç°åº¦æ¨¡å¼</span></span><br><span class="line">w, h = out_img.size  <span class="comment"># è¿”å›å›¾ç‰‡å¤§å°</span></span><br><span class="line">n=<span class="number">600</span>/<span class="built_in">max</span>(w,h) <span class="comment">#å›¾åƒç¼©å°å€æ•°ï¼Œä¸ç„¶å›¾ç‰‡è½¬æ¢åä¼šå¾ˆå¤§</span></span><br><span class="line"><span class="keyword">if</span> n&lt;<span class="number">1</span>:</span><br><span class="line">   out_img = out_img.resize((<span class="built_in">int</span>(w * n), <span class="built_in">int</span>(h * n*<span class="number">0.5</span>)))  <span class="comment"># å› å­—ç¬¦çš„å®½åº¦ä¸€èˆ¬å¤§äº2å€çš„é«˜åº¦</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">   out_img = out_img.resize((<span class="built_in">int</span>(w), <span class="built_in">int</span>(h )))</span><br><span class="line">w, h = out_img.size</span><br><span class="line"><span class="comment">#asciis=&#x27;$@B%8&amp;WM#*oahkbdpqwmZO0QLCJUYXzcvunxrjft/\\|()1&#123;&#125;[]?-_+~&lt;&gt;i!lI;:,&quot;^\ &#x27;</span></span><br><span class="line">asciis = <span class="string">&quot;@.&quot;</span>  <span class="comment"># ç°åº¦è¡¨</span></span><br><span class="line">texts = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(h):</span><br><span class="line"> <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(w):</span><br><span class="line">       gray = out_img.getpixel((col, row))</span><br><span class="line">       texts += asciis[<span class="built_in">int</span>(gray / <span class="number">255</span> * (<span class="built_in">len</span>(asciis) - <span class="number">1</span>))]  <span class="comment"># æ ¹æ®ç°åº¦å€¼é€‰æ‹©ä¸åŒå¤æ‚åº¦çš„ ASCII å­—ç¬¦</span></span><br><span class="line"> texts += <span class="string">&#x27;\n&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(texts)</span><br><span class="line">    file.close()</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°1.txtæ–‡ä»¶ï¼Œæ‰“å¼€å³æ˜¯å­—ç¬¦ç”»ï¼š</p>
<p><img src="/post/22e56931/image-20230911144716398.png" alt="image-20230911144716398"></p>
<p>ä¸Šä¼ ç»™Terminalï¼Œå³å¾—åˆ°flagï¼š</p>
<p><img src="/post/22e56931/image-20230911144745871.png" alt="image-20230911144745871"></p>
<p>flagï¼š</p>
<p><strong>cnss{funny_ascii_ocr_duibudui}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>miscçš„çŸ¥è¯†é¢æ¶‰åŠå¾ˆå¹¿ï¼Œå¾ˆå¤šçŸ¥è¯†éƒ½æ˜¯è¾¹åšé¢˜è¾¹å­¦ï¼Œå¾ˆå¤šå·¥å…·ä¹Ÿæ˜¯è¾¹åšé¢˜è¾¹ä¸‹çš„ï¼Œä¸€ç‚¹ä¸€ç‚¹ç§¯ç´¯å§ã€‚</p>
]]></content>
      <categories>
        <category>wp-misc</category>
      </categories>
  </entry>
  <entry>
    <title>2023-CNSS-Summer-wp-crypto</title>
    <url>/post/795314c1.html</url>
    <content><![CDATA[<span id="more"></span>
<p>è¦ç»™è‡ªå·±å­¦æ ¡çš„æ‹›æ–°èµ›å‡ºé¢˜äº†ï¼Œäºæ˜¯æ··è¿›CNSSæ‹›æ–°èµ›å‰çš„å¤ä»¤è¥æ‰¾æ‰¾å‡ºé¢˜çµæ„Ÿï¼Œä¸å¾—ä¸è¯´ï¼Œå¾ˆå¤šé¢˜ç›®éƒ½å‡ºçš„å¾ˆä¸é”™ï¼Œéš¾åº¦ä¸çŸ¥è¯†ç‚¹æ§åˆ¶çš„å¾ˆå¥½ï¼Œäºæ˜¯åœ¨æ­¤è®°å½•ä¸€ä¸‹ã€‚</p>
<h2 id="Crypto-Guideline"><a href="#Crypto-Guideline" class="headerlink" title="Crypto Guideline"></a>Crypto Guideline</h2><p>ç­¾åˆ°é¢˜ï¼Œæ ‡å¿—ç€cryptoæ–¹å‘é¢˜ç›®çš„å¼€å§‹ï¼Œç›´æ¥æäº¤flagå³å¯ã€‚</p>
<p>flag:</p>
<font size="4" color="red">cnss{Welcome to the world of cryptography!}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="cyclic-group"><a href="#cyclic-group" class="headerlink" title="cyclic group"></a>cyclic group</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¯ä»¥æ‰¾åˆ°æˆ‘è—åœ¨å¾ªç¯ç¾¤ä¸­çš„flagå—ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®å†…å®¹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag  <span class="comment">## secret is a local file, flag is unknown to you</span></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = getPrime(<span class="number">512</span>)</span><br><span class="line">c = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(e):</span><br><span class="line">    c *= m   </span><br><span class="line">    c %= p</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p =&#x27;</span>, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;e =&#x27;</span>, e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p = 134994058501022133829793113756450648798182080773931273262418798773562440624857106163310596590759607340807163876539520282102901165977612358002331391089851066812663281502398201018663717659213732276911585751665516661301930410244101046617666467321456930120075263141242119953757880295718825254018040413826880843763</span></span><br><span class="line"><span class="string">e = 12927587515508549311645504126259938927362775210786958053823827936884288861306268493761629822045846148118653977616493302703588300283111036739875491883808759</span></span><br><span class="line"><span class="string">c = 46583597391505868783218970830156160405763802889228578452060606957717500160663392513770581781157233604314178955789908254475724009921579917780127649365498088467948777432657442293331639740286781008682662602974865442032279819833194544535317410041738966384493317240586005380761492762248899523164168679218802048162</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå®é™…ä¸Šå°±æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
m^e\equiv c\quad (mod\;p)</script><p>å› æ­¤ç›´æ¥å¹‚ä¹˜eå…³äºp-1çš„é€†å…ƒå³å¯ã€‚è€Œæœ¬é¢˜çš„é¢˜ç›®åå­—cyclic groupæŒ‡ä»£çš„æ˜¯å¾ªç¯ç¾¤ï¼Œåœ¨è¿™é‡Œå³æ˜¯åœ¨è¯´ï¼Œç”±äºæ¨¡æ•°pä¸ºç´ æ•°ï¼Œé‚£ä¹ˆmçš„é˜¶å°±ä¸ºp-1ï¼Œå› æ­¤å¯ä»¥ç›´æ¥æ±‚æŒ‡æ•°å…³äºå…¶é˜¶çš„é€†å…ƒæ±‚è§£é¢˜ç›®ã€‚</p>
<p><br></p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">134994058501022133829793113756450648798182080773931273262418798773562440624857106163310596590759607340807163876539520282102901165977612358002331391089851066812663281502398201018663717659213732276911585751665516661301930410244101046617666467321456930120075263141242119953757880295718825254018040413826880843763</span></span><br><span class="line">e = <span class="number">12927587515508549311645504126259938927362775210786958053823827936884288861306268493761629822045846148118653977616493302703588300283111036739875491883808759</span></span><br><span class="line">c = <span class="number">46583597391505868783218970830156160405763802889228578452060606957717500160663392513770581781157233604314178955789908254475724009921579917780127649365498088467948777432657442293331639740286781008682662602974865442032279819833194544535317410041738966384493317240586005380761492762248899523164168679218802048162</span></span><br><span class="line"></span><br><span class="line">d = inverse(e,p-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,p)))</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{Unbelievable! You know the key of cyclic group!}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="cnsså¨˜çš„ä»£ç â… "><a href="#cnsså¨˜çš„ä»£ç â… " class="headerlink" title="cnsså¨˜çš„ä»£ç â… "></a>cnsså¨˜çš„ä»£ç â… </h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cnsså¨˜å†™äº†ä¸€æ®µæ„Ÿè§‰æ„ä¹‰ä¸æ˜çš„ä»£ç ï¼Œä½ èƒ½å¸®å¥¹æ‰¾åˆ°flagå—ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag  </span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">key = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    key.append(getPrime(<span class="number">128</span>))</span><br><span class="line">    </span><br><span class="line">secret = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    secret.append(m % key[i])</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;key =&#x27;</span>, key)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;secret =&#x27;</span>, secret)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">key = [179283057970236760812385016853348861313, 243730152305882610684268424505624182831, 276375013783217805474364273321195364813, 338363147025326331069698214354955107607]</span></span><br><span class="line"><span class="string">secret = [42312333420922777926503668120694248887, 188911830445106862831548334980052602782, 202272400826094059912187609891368651300, 16939666639933430404336668949000187621]</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>
<p>ç®€æ´æ˜äº†åœ°è€ƒå¯Ÿä¸­å›½å‰©ä½™å®šç†ã€‚</p>
<p><br></p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"><span class="comment">#ä½¿ç”¨å¦‚ï¼šM = crt(n,c)[0]</span></span><br><span class="line">key = [<span class="number">179283057970236760812385016853348861313</span>, <span class="number">243730152305882610684268424505624182831</span>, <span class="number">276375013783217805474364273321195364813</span>, <span class="number">338363147025326331069698214354955107607</span>]</span><br><span class="line">secret = [<span class="number">42312333420922777926503668120694248887</span>, <span class="number">188911830445106862831548334980052602782</span>, <span class="number">202272400826094059912187609891368651300</span>, <span class="number">16939666639933430404336668949000187621</span>]</span><br><span class="line"></span><br><span class="line">M = crt(key,secret)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(M))</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{Wow!Chinese remainder theorem is so interseting!}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="RSA-â… "><a href="#RSA-â… " class="headerlink" title="RSA â… "></a>RSA â… </h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Can you factorize n ?</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">mask = getPrime(<span class="number">512</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;mask = <span class="subst">&#123;mask&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(p|mask)</span><br><span class="line"><span class="built_in">print</span>(p&amp;mask)</span><br><span class="line"></span><br><span class="line"><span class="comment">#c = 64949799997326584007544788513993497249594769744995858720976935000014197232306799968807213667255871030075230919683627404813038995304033226711042639925325815395252041199650244620814678407788637241064396318107929964286966081900052163098825412222835465966640369222321472659135622216530966800717417560715221275591</span></span><br><span class="line"><span class="comment">#n = 106750680418525866311589462967145265327203310954735134383588573660691518247034803380198999333962213971657327515092895034635965957228036264848532931376595751503164297061094511187060069380048933807326213369464059701069965785612620370291933800122445966488267918733547599024267999872488061941892122230382138042783</span></span><br><span class="line"><span class="comment">#mask = 12270330408774238331968219216635392599519489634111741706590917012819298856158311310855782884352875794146685141255943386189197362902992928716839082520848927</span></span><br><span class="line"><span class="comment">#13112112110892990771168306272793201342028151601627796725313855804865001339738164412798270175076178951452110894792943424133718769511979832250960465757056799</span></span><br><span class="line"><span class="comment">#11731832079629748669705816329667815638461774924918417348984676937048335348013101619038697983623814812736529127108466295988845879378764866277739393693264401</span></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ç»™äº†nçš„ä¸€ä¸ªç´ å› å­pä¸maskçš„&amp;åŠ|ä½è¿ç®—ç»“æœï¼Œé‚£ä¹ˆå¯¹äºæ¯ä¸€ä½ï¼Œå¯ä»¥ç®€å•æšä¸¾ä¸€ä¸‹æ‰€æœ‰å¯èƒ½æ€§ï¼š</p>
<ul>
<li>&amp;è¿ç®—ä¸º1ï¼Œåˆ™pè¯¥ä½ä¸º1</li>
<li>&amp;è¿ç®—ä¸º0ï¼Œ|è¿ç®—ä¸º1ï¼Œåˆ™å½“maskè¯¥ä½ä¸º1æ—¶ï¼Œpè¯¥ä½ä¸º0ï¼›å½“maskè¯¥ä½ä¸º0æ—¶ï¼Œpè¯¥ä½ä¸º1</li>
<li>&amp;è¿ç®—ä¸º0ï¼Œ|è¿ç®—ä¸º0ï¼Œåˆ™pè¯¥ä½ä¸º0</li>
</ul>
<p>å› æ­¤å¯ä»¥è¿˜åŸpçš„æ‰€æœ‰æ¯”ç‰¹ä½ï¼Œè¿›è€Œè§£å¯†RSAã€‚</p>
<p><br></p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = <span class="number">64949799997326584007544788513993497249594769744995858720976935000014197232306799968807213667255871030075230919683627404813038995304033226711042639925325815395252041199650244620814678407788637241064396318107929964286966081900052163098825412222835465966640369222321472659135622216530966800717417560715221275591</span></span><br><span class="line">n = <span class="number">106750680418525866311589462967145265327203310954735134383588573660691518247034803380198999333962213971657327515092895034635965957228036264848532931376595751503164297061094511187060069380048933807326213369464059701069965785612620370291933800122445966488267918733547599024267999872488061941892122230382138042783</span></span><br><span class="line">mask = <span class="number">12270330408774238331968219216635392599519489634111741706590917012819298856158311310855782884352875794146685141255943386189197362902992928716839082520848927</span></span><br><span class="line">gift1 = <span class="number">13112112110892990771168306272793201342028151601627796725313855804865001339738164412798270175076178951452110894792943424133718769511979832250960465757056799</span></span><br><span class="line">gift2 = <span class="number">11731832079629748669705816329667815638461774924918417348984676937048335348013101619038697983623814812736529127108466295988845879378764866277739393693264401</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">strmask = <span class="built_in">bin</span>(mask)[<span class="number">2</span>:]</span><br><span class="line">strgift1 = <span class="built_in">bin</span>(gift1)[<span class="number">2</span>:]</span><br><span class="line">strgift2 = <span class="built_in">bin</span>(gift2)[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">strp = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(strmask)):</span><br><span class="line">    <span class="keyword">if</span>(strgift2[i] == <span class="string">&quot;1&quot;</span>):</span><br><span class="line">        strp.append(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span>(strgift1[i] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> strmask[i] == <span class="string">&quot;0&quot;</span>):</span><br><span class="line">            strp.append(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span>(strgift1[i] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> strmask[i] == <span class="string">&quot;1&quot;</span>):</span><br><span class="line">            strp.append(<span class="string">&quot;0&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            strp.append(<span class="string">&quot;0&quot;</span>)</span><br><span class="line"></span><br><span class="line">p = <span class="built_in">int</span>(<span class="string">&quot;&quot;</span>.join(strp),<span class="number">2</span>)</span><br><span class="line">q= n//p       </span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{1t_s33ms_bit_is_useful}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="cnsså¨˜çš„ä»£ç -â…¡"><a href="#cnsså¨˜çš„ä»£ç -â…¡" class="headerlink" title="cnsså¨˜çš„ä»£ç  â…¡"></a>cnsså¨˜çš„ä»£ç  â…¡</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cnsså¨˜æœ€è¿‘åœ¨ç ”ç©¶ä¸€ç±»æ•°è®ºä¸­çš„éš¾é¢˜ï¼Œä½ å¯ä»¥å¸®åŠ©å¥¹å—ï¼Ÿ</span><br><span class="line">Hint: SageMathçš„ä½¿ç”¨å¯ä»¥è®©ä½ äº‹åŠåŠŸå€</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag  </span><br><span class="line"></span><br><span class="line">p = <span class="number">149223181221309438217142971731290162048502071683234438807455153639165894737664410172266260056805353255967638568356843140306590887937</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">g = <span class="number">7</span></span><br><span class="line">h = <span class="built_in">pow</span>(g, m, p)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;h =&#x27;</span>, h)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">106414500627466044750537699496116452216938505790285966641538755230718107434518035561502262320845803494959251547594598724676292650073</span></span><br></pre></td></tr></table></figure>
<p>ç›´æ¥ç”¨sageæ±‚è§£ç¦»æ•£å¯¹æ•°å³å¯ã€‚</p>
<p><br></p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">149223181221309438217142971731290162048502071683234438807455153639165894737664410172266260056805353255967638568356843140306590887937</span></span><br><span class="line">g = <span class="number">7</span></span><br><span class="line">h = <span class="number">106414500627466044750537699496116452216938505790285966641538755230718107434518035561502262320845803494959251547594598724676292650073</span></span><br><span class="line"></span><br><span class="line">m=discrete_log(mod(h,p),mod(g,p))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{Congratulation! You crack the DLP problem!}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="cnsså¨˜çš„ä»£ç -â…¢"><a href="#cnsså¨˜çš„ä»£ç -â…¢" class="headerlink" title="cnsså¨˜çš„ä»£ç  â…¢"></a>cnsså¨˜çš„ä»£ç  â…¢</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cnsså¨˜æœ€è¿‘åœ¨å­¦ä¹ çº¿æ€§ä»£æ•°ï¼Œä½ å¯ä»¥å¸®å¥¹è§£å‡ºè¿™é“é¢˜å—ï¼Ÿ</span><br><span class="line">Hint:Sage ä¸­è‡ªå¸¦æœ‰ Matrix å’Œ Vector ç±»ã€‚</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag  </span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">40</span></span><br><span class="line">p = <span class="number">9536720961414799253</span></span><br><span class="line">u = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">40</span>, <span class="number">5</span>):</span><br><span class="line">    u.append(bytes_to_long(flag[i:i+<span class="number">5</span>]))</span><br><span class="line">u = vector(u)</span><br><span class="line">A = random_matrix(Zmod(p), <span class="number">8</span>)</span><br><span class="line">v = u * A</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;A =&#x27;</span>, A)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;v =&#x27;</span>, v)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">A = [7907672172473958392 4938237561047760432 5072996306459844921  800347085054263333 2241217299487989740 5452520396763079026 7354205761061650589 5632270298193588206]</span></span><br><span class="line"><span class="string">[6856262700627435223 7218982369550725117 3069216736555490147 9043167152368671477 6651431740452419751 2904199636400840775 1984801523985180355 9424612078019686546]</span></span><br><span class="line"><span class="string">[ 190015986177831045  594687507332748466 2546708346651205091 3864956414971412519 2586812319675472372 2541554633306459284 2840981234492698127  400426130440806923]</span></span><br><span class="line"><span class="string">[ 354930743948767363  374079227033274174 7821379197355217415 4073976921774664952 8974661879090783904 8725597754431417139 1723115467249027682  914056616366301410]</span></span><br><span class="line"><span class="string">[9032929938905307703  569436029465728354 3230536280479973685 9499318835507740454  460664783708095350 3815328100857956310 6866516203996475375 9142528333783640721]</span></span><br><span class="line"><span class="string">[6647724854667560614 1564543033588842443  980081446425820918 4482664640152609224 9361385831487208956 5729265277086036438 8521779175294512538 7872078731489374461]</span></span><br><span class="line"><span class="string">[2426759667632064565 2564361116290067541 5109836057988930695 3948680632682199428 8561341181219447072 5099840518920477627 9347277712921710222 4364598388067284951]</span></span><br><span class="line"><span class="string">[2143804620259054744 4318231909289693782 6284698432978577252 5529804751795288609 7903556036971407808 3730126758887833322 8782120630459581951 9050476736532525999]</span></span><br><span class="line"><span class="string">v = (4088048241727106122, 258857328202723850, 7303598013681209756, 3446975206276714926, 176458751236949790, 8151363680348349027, 8771366063042882128, 9003511237633705064)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>ç›´æ¥åœ¨sageä¸­æ±‚è§£é€†çŸ©é˜µå³å¯</p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">9536720961414799253</span></span><br><span class="line">A = [[<span class="number">7907672172473958392</span>,<span class="number">4938237561047760432</span>,<span class="number">5072996306459844921</span>,<span class="number">800347085054263333</span>,<span class="number">2241217299487989740</span>,<span class="number">5452520396763079026</span>,<span class="number">7354205761061650589</span>,<span class="number">5632270298193588206</span>],</span><br><span class="line">[<span class="number">6856262700627435223</span>,<span class="number">7218982369550725117</span>,<span class="number">3069216736555490147</span>,<span class="number">9043167152368671477</span>,<span class="number">6651431740452419751</span>,<span class="number">2904199636400840775</span>,<span class="number">1984801523985180355</span>,<span class="number">9424612078019686546</span>],</span><br><span class="line">[<span class="number">190015986177831045</span>,<span class="number">594687507332748466</span>,<span class="number">2546708346651205091</span>,<span class="number">3864956414971412519</span>,<span class="number">2586812319675472372</span>,<span class="number">2541554633306459284</span>,<span class="number">2840981234492698127</span>,<span class="number">400426130440806923</span>],</span><br><span class="line">[<span class="number">354930743948767363</span>,<span class="number">374079227033274174</span>,<span class="number">7821379197355217415</span>,<span class="number">4073976921774664952</span>,<span class="number">8974661879090783904</span>,<span class="number">8725597754431417139</span>,<span class="number">1723115467249027682</span>,<span class="number">914056616366301410</span>],</span><br><span class="line">[<span class="number">9032929938905307703</span>,<span class="number">569436029465728354</span>,<span class="number">3230536280479973685</span>,<span class="number">9499318835507740454</span>,<span class="number">460664783708095350</span>,<span class="number">3815328100857956310</span>,<span class="number">6866516203996475375</span>,<span class="number">9142528333783640721</span>],</span><br><span class="line">[<span class="number">6647724854667560614</span>,<span class="number">1564543033588842443</span>,<span class="number">980081446425820918</span>,<span class="number">4482664640152609224</span>,<span class="number">9361385831487208956</span>,<span class="number">5729265277086036438</span>,<span class="number">8521779175294512538</span>,<span class="number">7872078731489374461</span>],</span><br><span class="line">[<span class="number">2426759667632064565</span>,<span class="number">2564361116290067541</span>,<span class="number">5109836057988930695</span>,<span class="number">3948680632682199428</span>,<span class="number">8561341181219447072</span>,<span class="number">5099840518920477627</span>,<span class="number">9347277712921710222</span>,<span class="number">4364598388067284951</span>],</span><br><span class="line">[<span class="number">2143804620259054744</span>,<span class="number">4318231909289693782</span>,<span class="number">6284698432978577252</span>,<span class="number">5529804751795288609</span>,<span class="number">7903556036971407808</span>,<span class="number">3730126758887833322</span>,<span class="number">8782120630459581951</span>,<span class="number">9050476736532525999</span>]]</span><br><span class="line"></span><br><span class="line">ans = [<span class="number">4088048241727106122</span>, <span class="number">258857328202723850</span>, <span class="number">7303598013681209756</span>, <span class="number">3446975206276714926</span>, <span class="number">176458751236949790</span>, <span class="number">8151363680348349027</span>, <span class="number">8771366063042882128</span>, <span class="number">9003511237633705064</span>]</span><br><span class="line">A = matrix(A)</span><br><span class="line">ans = matrix(ans)</span><br><span class="line"></span><br><span class="line">flag = ans * A.inverse()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¾—åˆ°flagåè½¬åŒ–ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">flag = [<span class="number">256128467098287645152364579619033136532012336082411188262170716121111141373910417997647279385874168289963422098883372524388175789168151018039664118938</span>/<span class="number">201110710500527103391704345109970877861492963385688540350899980246056954432876844511421798766202341953924005687593642435623584608348351172354206968203</span>,-<span class="number">275157020682273200260243873388370073035487413746791277567209773631463468440360425377838149581773104213153845176881963804588249058534505227929576082442</span>/<span class="number">201110710500527103391704345109970877861492963385688540350899980246056954432876844511421798766202341953924005687593642435623584608348351172354206968203</span>,<span class="number">205418055261423253440834873996888852743735400527184165431288083430874722579052114104669136088527642186595043026543683492544648632576976821633919688987</span>/<span class="number">67036903500175701130568115036656959287164321128562846783633326748685651477625614837140599588734113984641335229197880811874528202782783724118068989401</span>,<span class="number">18887682222057954947813918789359532063827948125435329591909175563625225112660734620218938715145807440112704581336669611824654566923603748916776016972</span>/<span class="number">67036903500175701130568115036656959287164321128562846783633326748685651477625614837140599588734113984641335229197880811874528202782783724118068989401</span>,-<span class="number">25792447761509638420556125881168126603544490324749544374648563355312526747005861915100426458158515036632551136815312658182069136958880193280291853604</span>/<span class="number">201110710500527103391704345109970877861492963385688540350899980246056954432876844511421798766202341953924005687593642435623584608348351172354206968203</span>,<span class="number">263743295233022646271965564265774549530140797857736570979958721892220519418537528753856004044323800915867363751008926223858363297878551362225736657993</span>/<span class="number">201110710500527103391704345109970877861492963385688540350899980246056954432876844511421798766202341953924005687593642435623584608348351172354206968203</span>,-<span class="number">839256526384408301445325525932265486477039492555936647496320730347707472223889935476141937534810747723549651396954028900430020396698162916210131940419</span>/<span class="number">201110710500527103391704345109970877861492963385688540350899980246056954432876844511421798766202341953924005687593642435623584608348351172354206968203</span>,<span class="number">165200370960939593750718733159922760922513289005013438437371715048231002848101266223391623531454692435044072426966916629687643829467166749676754679429</span>/<span class="number">67036903500175701130568115036656959287164321128562846783633326748685651477625614837140599588734113984641335229197880811874528202782783724118068989401</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(long_to_bytes(<span class="built_in">int</span>(i % p)))[<span class="number">2</span>:-<span class="number">1</span>],end = <span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{Line8ar alg3ebra 1s 50 i0mportant!}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="HomoBlock"><a href="#HomoBlock" class="headerlink" title="HomoBlock"></a>HomoBlock</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä½ æ˜¯ä¸€ä¸ªï¼Œä¸€ä¸ªä¸€ä¸ªä¸€ä¸ªHomoå•Šå•Šå•Šå•Šå•Šå•Šå•Š</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getRandomNBitInteger</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">b&#x27;cnss&#123;I_a&#x27;</span>) <span class="keyword">and</span> flag.endswith(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag)%<span class="number">8</span>==<span class="number">0</span></span><br><span class="line">MASK1 = getRandomNBitInteger(<span class="number">32</span>)|(<span class="number">0xffffffff00000000</span>)</span><br><span class="line">MASK2 = getRandomNBitInteger(<span class="number">32</span>)&lt;&lt;<span class="number">32</span></span><br><span class="line">ROUND = <span class="number">5</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genKey</span>():</span><br><span class="line">    tmp = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ROUND):</span><br><span class="line">        tmp.append(getRandomNBitInteger(<span class="number">64</span>))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">NotHomoFunction</span>(<span class="params">x,iv,key</span>):</span><br><span class="line">    <span class="keyword">return</span> ((x&lt;&lt;iv)&amp;MASK1)^((x&gt;&gt;iv)|MASK2)^key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">message,iv,key</span>):</span><br><span class="line">    cipher = bytes_to_long(message)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ROUND):</span><br><span class="line">        cipher = NotHomoFunction(cipher,iv,key)</span><br><span class="line">    <span class="keyword">return</span> cipher</span><br><span class="line"></span><br><span class="line">cipher = []</span><br><span class="line">iv = <span class="number">32</span></span><br><span class="line">key = getRandomNBitInteger(<span class="number">64</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(flag),<span class="number">8</span>):</span><br><span class="line">    cipher.append(encrypt(flag[i:i+<span class="number">8</span>],iv,key))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(cipher)</span><br><span class="line"><span class="built_in">print</span>(iv)</span><br><span class="line"><span class="built_in">print</span>(MASK2)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot; </span></span><br><span class="line"><span class="string">[4840951631397558164, 5492303526413306583, 6271460196030786735, 6127905759336302986, 601209385465514967]</span></span><br><span class="line"><span class="string">32</span></span><br><span class="line"><span class="string">16500653344889503744</span></span><br></pre></td></tr></table></figure>
<p>è§‚å¯ŸåŠ å¯†æ–¹å¼ï¼Œå‘ç°å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹:</p>
<ul>
<li>æ˜æ–‡æŒ‰é•¿åº¦ä¸º8åˆ†ç»„ï¼Œåˆ†åˆ«åŠ å¯†</li>
<li>æ¯ä¸€è½®äº¤æ¢ä¸Šä¸€è½®å¾—åˆ°ç»“æœçš„é«˜ä½32ä½ï¼Œç„¶åå¼‚æˆ– MASK2 ï¼Œå¼‚æˆ–keyã€‚</li>
</ul>
<p>å¯ä»¥å‘ç°ï¼Œè¿™æ ·äº¤æ¢4æ¬¡åå°±ä¼šæ¢å¤åˆå€¼ï¼Œæ‰€ä»¥å®é™…äº¤æ¢5æ¬¡åï¼Œå°±èƒ½å¾—åˆ°åˆå§‹å€¼å¼‚æˆ– MASK2 å¹¶å¼‚æˆ–keyçš„ç»“æœã€‚åˆå› ä¸ºæ˜æ–‡çš„ç¬¬ä¸€éƒ¨åˆ†å·²ç»ç»™å‡ºï¼Œæ‰€ä»¥å¯ä»¥æ ¹æ®è¿™ä¸ªæ˜æ–‡æ¢å¤keyï¼Œåç»­é€æ­¥æ¢å¤å³å¯ã€‚</p>
<p><br></p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;cnss&#123;I_a&#x27;</span></span><br><span class="line">f0 = bytes_to_long(flag)</span><br><span class="line">p = [<span class="number">4840951631397558164</span>, <span class="number">5492303526413306583</span>, <span class="number">6271460196030786735</span>, <span class="number">6127905759336302986</span>, <span class="number">601209385465514967</span>]</span><br><span class="line">MASK2 = <span class="number">16500653344889503744</span></span><br><span class="line">f1 = p[<span class="number">0</span>]</span><br><span class="line">hf0, lf0 = (f0 &gt;&gt; <span class="number">32</span>, f0 % (<span class="number">2</span> ** <span class="number">32</span>))</span><br><span class="line">hf1, lf1 = (f1 &gt;&gt; <span class="number">32</span>, f1 % (<span class="number">2</span> ** <span class="number">32</span>))</span><br><span class="line">hk = hf1 ^ lf0 ^ (MASK2 &gt;&gt; <span class="number">32</span>)</span><br><span class="line">lk = lf1 ^ hf0</span><br><span class="line">key = (hk &lt;&lt; <span class="number">32</span>) + lk</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> p:</span><br><span class="line">	l, h = ((i ^ MASK2 ^ key) &gt;&gt; <span class="number">32</span>, (i ^ MASK2 ^ key) % (<span class="number">2</span> ** <span class="number">32</span>))</span><br><span class="line">	flag += long_to_bytes((h &lt;&lt; <span class="number">32</span>) | l).decode()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{I_am_n0t_HHHHHHoooommmmmmmoooo0000}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="ezLFSR"><a href="#ezLFSR" class="headerlink" title="ezLFSR"></a>ezLFSR</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">do you know LFSR?</span><br><span class="line">Hint1:è€ƒç‚¹ï¼š LFSRæµå¯†ç </span><br><span class="line">Hint2:å¯ä»¥ä½¿ç”¨ z3solver ã€‚</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<p>task.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> mask,seed</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LFSR</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed, mask, length</span>):</span><br><span class="line">        self.length_mask = <span class="number">2</span> ** length - <span class="number">1</span></span><br><span class="line">        self.mask = mask &amp; self.length_mask</span><br><span class="line">        self.state = seed &amp; self.length_mask</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        next_state = (self.state &lt;&lt; <span class="number">1</span>) &amp; self.length_mask</span><br><span class="line">        i = self.state &amp; self.mask &amp; self.length_mask</span><br><span class="line">        output = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i != <span class="number">0</span>:</span><br><span class="line">            output ^= (i &amp; <span class="number">1</span>)</span><br><span class="line">            i = i &gt;&gt; <span class="number">1</span></span><br><span class="line">        next_state ^= output</span><br><span class="line">        self.state = next_state</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getrandbit</span>(<span class="params">self, nbit</span>):</span><br><span class="line">        output = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(nbit):</span><br><span class="line">            output = (output &lt;&lt; <span class="number">1</span>) ^ self.<span class="built_in">next</span>()</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">cipher, ipath, opath</span>):</span><br><span class="line">    ifile=<span class="built_in">open</span>(ipath,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">    ofile=<span class="built_in">open</span>(opath,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">    plaintext=ifile.read()</span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> plaintext:</span><br><span class="line">        c=ch^cipher.getrandbit(<span class="number">8</span>)</span><br><span class="line">        ofile.write(long_to_bytes(c))</span><br><span class="line">    ifile.close()</span><br><span class="line">    ofile.close()</span><br><span class="line"></span><br><span class="line">lfsr = LFSR(seed, mask, <span class="number">16</span>)</span><br><span class="line">encrypt(lfsr,<span class="string">&#x27;flag.txt&#x27;</span>,<span class="string">&#x27;cipher.enc&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;seed = <span class="subst">&#123;seed&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># seed = 37285</span></span><br></pre></td></tr></table></figure>
<p>cipher.encï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">E3306EA1B67E13D02B59A0DEA270AD8C3AF0110FBF60C07740A699A5918E7DC5</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„åˆ°maskä¹Ÿä»…å–äº†ä½16ä½ï¼Œé‚£ä¹ˆçˆ†ç ´çš„èŒƒå›´ä¹Ÿä»…æœ‰65536ï¼Œå› æ­¤ç›´æ¥çˆ†ç ´å‡ºç¬¦åˆè¦æ±‚çš„æ˜æ–‡ä¸²å³å¯ã€‚</p>
<p><br></p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LFSR</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed, mask, length</span>):</span><br><span class="line">        self.length_mask = <span class="number">2</span> ** length - <span class="number">1</span></span><br><span class="line">        self.mask = mask &amp; self.length_mask</span><br><span class="line">        self.state = seed &amp; self.length_mask</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        next_state = (self.state &lt;&lt; <span class="number">1</span>) &amp; self.length_mask</span><br><span class="line">        i = self.state &amp; self.mask &amp; self.length_mask</span><br><span class="line">        output = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i != <span class="number">0</span>:</span><br><span class="line">            output ^= (i &amp; <span class="number">1</span>)</span><br><span class="line">            i = i &gt;&gt; <span class="number">1</span></span><br><span class="line">        next_state ^= output</span><br><span class="line">        self.state = next_state</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getrandbit</span>(<span class="params">self, nbit</span>):</span><br><span class="line">        output = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(nbit):</span><br><span class="line">            output = (output &lt;&lt; <span class="number">1</span>) ^ self.<span class="built_in">next</span>()</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line">seed = <span class="number">37285</span></span><br><span class="line">hex_string = <span class="string">&quot;E3306EA1B67E13D02B59A0DEA270AD8C3AF0110FBF60C07740A699A5918E7DC5&quot;</span></span><br><span class="line"><span class="comment"># æ¯ä¸¤ä¸ªå­—ç¬¦ä¸€ç»„æ‹†åˆ†</span></span><br><span class="line">split_hex = [hex_string[i:i+<span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(hex_string), <span class="number">2</span>)]</span><br><span class="line"></span><br><span class="line">c = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> split_hex:</span><br><span class="line">    c.append(<span class="built_in">int</span>(i,<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">16</span>):</span><br><span class="line">    mask = i</span><br><span class="line">    lfsr = LFSR(seed, mask, <span class="number">16</span>)</span><br><span class="line">    clist = []</span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> c:</span><br><span class="line">        temp=ch^lfsr.getrandbit(<span class="number">8</span>)</span><br><span class="line">        clist.append(<span class="built_in">chr</span>(temp))</span><br><span class="line">    str1 = <span class="string">&quot;&quot;</span>.join(clist)</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">&quot;cnss&quot;</span> <span class="keyword">in</span> str1):</span><br><span class="line">        <span class="built_in">print</span>(str1)</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œæ—¶é—´å¤§æ¦‚éœ€è¦ä¸åˆ°1åˆ†é’Ÿã€‚</p>
<p>flag:</p>
<font size="4" color="red">cnss{Y0u_can_brust_0r_F1nd_seed}</font>

<p>ä»flagä¸²ä»¥åŠhintå¯ä»¥çœ‹å‡ºï¼Œæœ¬é¢˜åº”è¯¥æ˜¯å¯ä»¥é€šè¿‡LFSRçš„æ–¹å¼æ¢å¤æ˜æ–‡çš„ï¼Œä½†æ˜¯æ•°é‡çº§å¤ªå°ï¼Œæ²¡å¿…è¦ã€‚</p>
<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="RSA-â…¡"><a href="#RSA-â…¡" class="headerlink" title="RSA â…¡"></a>RSA â…¡</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">It&#x27;s more difficult than RSA â… ,right? Can you factorize n ?</span><br><span class="line">Hint:æŸ¥æ‰¾æœ‰å…³RSAæ”»å‡»çš„èµ„æ–™æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„æŠ€èƒ½ã€‚</span><br></pre></td></tr></table></figure>
<p>å¹¶æä¾›äº†ä¸€ç¯‡è®ºæ–‡é“¾æ¥ï¼š<a href="https://eprint.iacr.org/2020/1506.pdf">1506.pdf (iacr.org)</a></p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line">mask1 = <span class="number">8802124635072632944677646490123224379036416333544329119490072003355821545476873187055484863111312282268555945525261726909784693138184611507738758202965723</span></span><br><span class="line">mask2 = <span class="number">10267484648659998697412163107809730542736732193409802323765378917769614002176050843098384409535095473863894691160595931186139418791709781214996751031082601</span></span><br><span class="line"></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">mask1 = getPrime(<span class="number">512</span>)</span><br><span class="line">mask2 = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;mask1 = <span class="subst">&#123;mask1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;mask2 = <span class="subst">&#123;mask2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;h1 = <span class="subst">&#123;p&amp;mask1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;h2 = <span class="subst">&#123;q&amp;mask2&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 21645208345867622053024283678631971385301103104312441336174301067402923208233033116071987870811290403578077414872467955871236843078200772311176723821275372545792521252126496488134168455430882670865862282658077115199048181151105823370547063726203692258934054391552916645628374539820099986794258298843501009240</span></span><br><span class="line"><span class="string">n = 87282921750815275717132715603847471604654006135344540742956637574882193904171665195367477260090328888053170090015909620539666069545618781812315864580009968838414539707616636379202667918204792277927294032362873240288573251987386601263377458038218959813925307265939433229169884527274177006792047369788293125409</span></span><br><span class="line"><span class="string">mask1 = 8802124635072632944677646490123224379036416333544329119490072003355821545476873187055484863111312282268555945525261726909784693138184611507738758202965723</span></span><br><span class="line"><span class="string">mask2 = 10267484648659998697412163107809730542736732193409802323765378917769614002176050843098384409535095473863894691160595931186139418791709781214996751031082601</span></span><br><span class="line"><span class="string">h1 = 6706231204421711988537353586716977912583550778985616494052350868539347641557164021930575245010900470979740623857738159245103694128834121517146255441177729</span></span><br><span class="line"><span class="string">h2 = 6704397956705493482354535847135592349486638396996488745737387153856868045426992197309829534096366784379171117205125136777653995357887539312554042026362473</span></span><br></pre></td></tr></table></figure>
<p>ç›¸è¾ƒäºRSA1ï¼Œè¿™ä¸€æ¬¡ä¸èƒ½æ ¹æ®ä½è¿ç®—ç»“æœå®Œå…¨ç¡®å®šå‡ºpã€qçš„æ¯”ç‰¹ä½äº†ï¼Œä¸è¿‡ä»ç„¶å¯ä»¥åˆ©ç”¨ä»¥ä¸‹çº¿ç´¢è¿˜åŸï¼š</p>
<ul>
<li>&amp;è¿ç®—ä¸º1ï¼Œåˆ™pè¯¥ä½å¿…ä¸º1</li>
<li>&amp;è¿ç®—ä¸º0ï¼Œmaskè¯¥ä½ä¸º1ï¼Œåˆ™pè¯¥ä½å¿…ä¸º0</li>
</ul>
<p>è€Œå½“&amp;è¿ç®—ä¸º0ï¼Œmaskä¹Ÿä¸º0æ—¶ï¼Œpçš„è¯¥æ¯”ç‰¹ä½å°±å­˜åœ¨ä¸¤ç§ç»“æœï¼Œæ— æ³•å®Œå…¨ç¡®å®šã€‚å¯æ˜¯è¿™é¢˜ä¸ä»…ç»™äº†pï¼Œè¿˜ç»™äº†qçš„ä½è¿ç®—ç»“æœï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸‹é¢è¿™ä¸€ç‚¹ä¿¡æ¯ï¼Œä»é«˜ä½å‘ä½ä½è¿›è¡Œæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œæ˜¾è‘—é™ä½å¤æ‚åº¦ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1ã€å°†pã€qå½“å‰ç¡®å®šçš„äºŒè¿›åˆ¶ä½åæ–¹å…¨éƒ¨å¡«å……0ï¼Œç›´è‡³å¡«æ»¡512ä½ï¼Œæ­¤æ—¶pã€qä¹˜ç§¯åº”å°äºnã€‚</span><br><span class="line">2ã€å°†pã€qå½“å‰ç¡®å®šçš„äºŒè¿›åˆ¶ä½åæ–¹å…¨éƒ¨å¡«å……1ï¼Œç›´è‡³å¡«æ»¡512ä½ï¼Œæ­¤æ—¶pã€qä¹˜ç§¯åº”å¤§äºnã€‚</span><br></pre></td></tr></table></figure>
<p>å¦‚æ­¤å°±èƒ½åœ¨æçŸ­æ—¶é—´å†…è¿˜åŸå‡ºpã€qã€‚</p>
<p><br></p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">21645208345867622053024283678631971385301103104312441336174301067402923208233033116071987870811290403578077414872467955871236843078200772311176723821275372545792521252126496488134168455430882670865862282658077115199048181151105823370547063726203692258934054391552916645628374539820099986794258298843501009240</span></span><br><span class="line">n = <span class="number">87282921750815275717132715603847471604654006135344540742956637574882193904171665195367477260090328888053170090015909620539666069545618781812315864580009968838414539707616636379202667918204792277927294032362873240288573251987386601263377458038218959813925307265939433229169884527274177006792047369788293125409</span></span><br><span class="line">mask1 = <span class="number">8802124635072632944677646490123224379036416333544329119490072003355821545476873187055484863111312282268555945525261726909784693138184611507738758202965723</span></span><br><span class="line">mask2 = <span class="number">10267484648659998697412163107809730542736732193409802323765378917769614002176050843098384409535095473863894691160595931186139418791709781214996751031082601</span></span><br><span class="line">h1 = <span class="number">6706231204421711988537353586716977912583550778985616494052350868539347641557164021930575245010900470979740623857738159245103694128834121517146255441177729</span></span><br><span class="line">h2 = <span class="number">6704397956705493482354535847135592349486638396996488745737387153856868045426992197309829534096366784379171117205125136777653995357887539312554042026362473</span></span><br><span class="line">mask1 = <span class="built_in">str</span>(<span class="built_in">bin</span>(mask1)[<span class="number">2</span>:])</span><br><span class="line">mask2 = <span class="built_in">str</span>(<span class="built_in">bin</span>(mask2)[<span class="number">2</span>:])</span><br><span class="line">h1 = <span class="built_in">str</span>(<span class="built_in">bin</span>(h1)[<span class="number">2</span>:])</span><br><span class="line">h2 = <span class="built_in">str</span>(<span class="built_in">bin</span>(h2)[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find</span>(<span class="params">p,q</span>):</span><br><span class="line">    l = <span class="built_in">len</span>(p)</span><br><span class="line">    tmp0 = p + (<span class="number">512</span>-l)*<span class="string">&quot;0&quot;</span></span><br><span class="line">    tmp1 = p + (<span class="number">512</span>-l)*<span class="string">&quot;1&quot;</span></span><br><span class="line">    tmq0 = q + (<span class="number">512</span>-l)*<span class="string">&quot;0&quot;</span></span><br><span class="line">    tmq1 = q + (<span class="number">512</span>-l)*<span class="string">&quot;1&quot;</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">int</span>(tmp0,<span class="number">2</span>)*<span class="built_in">int</span>(tmq0,<span class="number">2</span>) &gt; n):</span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    <span class="keyword">elif</span>(<span class="built_in">int</span>(tmp1,<span class="number">2</span>)*<span class="built_in">int</span>(tmq1,<span class="number">2</span>) &lt; n):</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(l == <span class="number">512</span>):</span><br><span class="line">        <span class="comment">#print(tmp0)</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">int</span>(tmp0,<span class="number">2</span>))</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">int</span>(tmq0,<span class="number">2</span>))</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span>((mask1[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;1&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;1&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span>((mask1[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;1&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;0&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span>((mask1[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;1&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;0&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;0&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span>((mask1[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;0&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;1&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span>((mask1[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;0&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;0&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span>((mask1[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;0&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;0&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;0&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">elif</span>((mask1[l] == <span class="string">&quot;0&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;0&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;1&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span>((mask1[l] == <span class="string">&quot;0&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;0&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;0&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span>((mask1[l] == <span class="string">&quot;0&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;0&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;0&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;0&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line"></span><br><span class="line">tempp = <span class="string">&quot;&quot;</span></span><br><span class="line">tempq = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#find(tempp,tempq)</span></span><br><span class="line">P = <span class="number">10172774442863868719013872884099170294615753094066736187886125116462340120031133533430755779832487215255546434139069419394249074006281284289077492708469893</span></span><br><span class="line">Q = <span class="number">8580050824978592226795441601299432164577158891190171233964440597982925469924083252289609500726234367555160732119333211934059529993446003001925910065317613</span></span><br><span class="line">phi = (P-<span class="number">1</span>)*(Q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{A1g0r1thm_1s_5o_hard_for_Me!}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="BabyLattice"><a href="#BabyLattice" class="headerlink" title="BabyLattice"></a>BabyLattice</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Do you know SVP and LLL?</span><br><span class="line">Hint:åœ¨è§£å†³æœ¬é¢˜çš„è¿‡ç¨‹ä¸­ä½ ä¼šæ¥è§¦åˆ°æ ¼(Lattice)çš„ä¸€äº›åŸºæœ¬æ¦‚å¿µ,ä»¥åŠLLLç®—æ³•ã€‚</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">32</span></span><br><span class="line">flagArg = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">32</span>,<span class="number">8</span>):</span><br><span class="line">    flag_tmp = bytes_to_long(flag[i:i+<span class="number">8</span>])</span><br><span class="line">    <span class="keyword">assert</span> flag_tmp &lt; <span class="number">2</span>**<span class="number">64</span></span><br><span class="line">    flagArg.append(flag_tmp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Equation</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,arg</span>):</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(arg)==<span class="number">4</span></span><br><span class="line">        self.arg = arg</span><br><span class="line">        self.modulus = getRandomInteger(<span class="number">512</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">output</span>(<span class="params">self</span>):</span><br><span class="line">        ans = <span class="number">0</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;the modulus is <span class="subst">&#123;self.modulus&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            tmp = getRandomInteger(<span class="number">512</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;The number of the <span class="subst">&#123;i&#125;</span> round is <span class="subst">&#123;tmp&#125;</span>&#x27;</span>)</span><br><span class="line">            ans+=self.arg[i]*tmp</span><br><span class="line">        ans = ans%self.modulus</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;The result is <span class="subst">&#123;ans&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">EzLineModulus = Equation(flagArg)</span><br><span class="line">EzLineModulus.output()</span><br><span class="line"></span><br><span class="line"><span class="comment">#the modulus is 4653980939589101565044285021945025573290906789132633751963110127801187748089540230208429714310516635848025358481189017398970169440484136391436220837417791</span></span><br><span class="line"><span class="comment">#The number of the 0 round is 7163515288721018524391838724005494502072524058809935946689587023614778895762400663698973734684519790842142248155478226513293289043832391054661263177469005</span></span><br><span class="line"><span class="comment">#The number of the 1 round is 13155134533945105613277690072743652931283618211062662861216511364398097684219572559463369279253337759860439150691008846033587645344197431244106331100681641</span></span><br><span class="line"><span class="comment">#The number of the 2 round is 8450640520436960190933104494093081291057363628588171820766164606066614201483259024304043681871965360847257453187101669512010469318096007617859083021766564</span></span><br><span class="line"><span class="comment">#The number of the 3 round is 798383352075970107818638521362593273862636131165588181505120596765884650403289567593307005746576184176902675297124272602141002375036927828390204063589274</span></span><br><span class="line"><span class="comment">#The result is 58831711102590059067743519228568722360433408071362335858674496753241059990433991177195518029785828762522018556332340356592798263267784406825183284767956</span></span><br></pre></td></tr></table></figure>
<p>æ‹›æ–°èµ›å‰çš„å¤ä»¤è¥å°±å‡ºLatticeçš„é¢˜ç›®äº†ã€‚ã€‚ç¡®å®ç‹ </p>
<p>ä¸è¿‡ç¡®å®æ˜¯æœ€åŸºç¡€çš„Latticeé¢˜ç›®äº†ï¼Œå¤§è‡´æ€è·¯å°±æ˜¯åˆ—å‡ºçº¿æ€§å…³ç³»å¼ï¼Œè½¬åŒ–ä¸ºçŸ©é˜µå½¢å¼ï¼Œå¹¶ä¿è¯è¾ƒçŸ­å‘é‡éƒ½åœ¨ç­‰å¼å³ä¾§ï¼Œå³å¯å¯¹æ„é€ å‡ºæ¥çš„æ ¼è¿›è¡Œè§„çº¦å¾—åˆ°çŸ­å‘é‡ã€‚</p>
<p><br></p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">4653980939589101565044285021945025573290906789132633751963110127801187748089540230208429714310516635848025358481189017398970169440484136391436220837417791</span></span><br><span class="line">a1 = <span class="number">7163515288721018524391838724005494502072524058809935946689587023614778895762400663698973734684519790842142248155478226513293289043832391054661263177469005</span></span><br><span class="line">a2 = <span class="number">13155134533945105613277690072743652931283618211062662861216511364398097684219572559463369279253337759860439150691008846033587645344197431244106331100681641</span></span><br><span class="line">a3 = <span class="number">8450640520436960190933104494093081291057363628588171820766164606066614201483259024304043681871965360847257453187101669512010469318096007617859083021766564</span></span><br><span class="line">a4 = <span class="number">798383352075970107818638521362593273862636131165588181505120596765884650403289567593307005746576184176902675297124272602141002375036927828390204063589274</span></span><br><span class="line">ans = <span class="number">58831711102590059067743519228568722360433408071362335858674496753241059990433991177195518029785828762522018556332340356592798263267784406825183284767956</span></span><br><span class="line">inv = inverse(a1,n)</span><br><span class="line">L = Matrix(ZZ, [[<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,-ans*inv],</span><br><span class="line">                [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>,a2*inv],</span><br><span class="line">                [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>,a3*inv],</span><br><span class="line">                [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>,a4*inv],</span><br><span class="line">                [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,n]])</span><br><span class="line"></span><br><span class="line">v = L.LLL()[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(long_to_bytes(<span class="built_in">abs</span>(v[<span class="number">4</span>])))[<span class="number">2</span>:-<span class="number">1</span>],end = <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(v)-<span class="number">1</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(long_to_bytes(<span class="built_in">abs</span>(v[i])))[<span class="number">2</span>:-<span class="number">1</span>],end = <span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{W0w!Y0u_know_WhatisL4ttice}</font>

<p>ï¼ˆæœ‰å…³æ ¼çš„é—®é¢˜æœ¬ç¯‡ä¸ä¼šå±•å¼€è®²ï¼Œå› ä¸ºå®ƒéœ€è¦å¯¹ä¸€äº›åŸºæœ¬åŸç†çš„äº†è§£ï¼Œæƒ³è¦æ˜ç™½æ­¤ç±»é—®é¢˜éœ€è¦å…ˆè‡ªè¡ŒæŸ¥é˜…ä¸€äº›æ ¼ç›¸å…³çš„åŸºæœ¬æ¦‚å¿µï¼‰</p>
<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="ezSignature"><a href="#ezSignature" class="headerlink" title="ezSignature"></a>ezSignature</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¿™æ ·ä½¿ç”¨æ•°å­—ç­¾åæ˜¯å¦å®‰å…¨å‘¢ï¼Ÿ</span><br><span class="line">nc 43.156.14.141 6943</span><br><span class="line"></span><br><span class="line">Hint1:æ¨èä½¿ç”¨pwntoolsè¿›è¡Œäº¤äº’ã€‚</span><br><span class="line">Hint2:å»ºè®®å…ˆäº†è§£ DSA æ•°å­—ç­¾åæµç¨‹ã€‚</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> DSA</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters + string.digits</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DigitalSignatureAlgorithm</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, key</span>):</span><br><span class="line">        self.p = key.p</span><br><span class="line">        self.q = key.q</span><br><span class="line">        self.g = key.g</span><br><span class="line">        self.y = key.y</span><br><span class="line">        self.x = key.x</span><br><span class="line">        self.k = randint(<span class="number">1</span>, self.q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">self, m</span>):</span><br><span class="line">        k = self.k</span><br><span class="line">        h = bytes_to_long(sha256(m).digest())</span><br><span class="line">        r = <span class="built_in">pow</span>(self.g, k, self.p) % self.q</span><br><span class="line">        s = inverse(k, self.q) * (h + self.x * r) % self.q</span><br><span class="line">        <span class="keyword">return</span> r, s</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">self, m, signature</span>):</span><br><span class="line">        r, s = signature</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">not</span> (<span class="number">1</span> &lt;= r &lt;= self.q - <span class="number">1</span>)) <span class="keyword">or</span> (<span class="keyword">not</span> (<span class="number">1</span> &lt;= s &lt;= self.q - <span class="number">1</span>)):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        z = bytes_to_long(sha256(m).digest())</span><br><span class="line">        w = inverse(s, self.q)</span><br><span class="line">        u1 = (z * w) % self.q</span><br><span class="line">        u2 = (r * w) % self.q</span><br><span class="line">        v = (<span class="built_in">pow</span>(self.g, u1, self.p) * <span class="built_in">pow</span>(self.y, u2, self.p)) % self.p % self.q</span><br><span class="line">        <span class="keyword">return</span> r == v</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">myDSA = DigitalSignatureAlgorithm(DSA.generate(<span class="number">1024</span>))</span><br><span class="line">MENU = <span class="string">br&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[1] Sign.</span></span><br><span class="line"><span class="string">[2] Verify.</span></span><br><span class="line"><span class="string">[3] Get_public_key.</span></span><br><span class="line"><span class="string">[4] Exit.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Task</span>(socketserver.BaseRequestHandler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_recvall</span>(<span class="params">self</span>):</span><br><span class="line">        BUFF_SIZE = <span class="number">2048</span></span><br><span class="line">        data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            part = self.request.recv(BUFF_SIZE)</span><br><span class="line">            data += part</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(part) &lt; BUFF_SIZE:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> data.strip()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">send</span>(<span class="params">self, msg, newline=<span class="literal">True</span></span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> newline:</span><br><span class="line">                msg += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line">            self.request.sendall(msg)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">recv</span>(<span class="params">self, prompt=<span class="string">b&#x27;[-] &#x27;</span></span>):</span><br><span class="line">        self.send(prompt, newline=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> self._recvall()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">proof_of_work</span>(<span class="params">self</span>):</span><br><span class="line">        proof = (<span class="string">&#x27;&#x27;</span>.join([choice(table) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>)])).encode()</span><br><span class="line">        sha = sha256(proof).hexdigest().encode()</span><br><span class="line">        self.send(<span class="string">b&quot;[+] sha256(XXXX+&quot;</span> + proof[<span class="number">4</span>:] + <span class="string">b&quot;) == &quot;</span> + sha)</span><br><span class="line">        XXXX = self.recv(prompt=<span class="string">b&#x27;[+] Plz Tell Me XXXX :&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(XXXX) != <span class="number">4</span> <span class="keyword">or</span> sha256(XXXX + proof[<span class="number">4</span>:]).hexdigest().encode() != sha:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">self</span>):</span><br><span class="line">        m1 = <span class="string">b&#x27;I want to tell you a secret&#x27;</span></span><br><span class="line">        m2 = <span class="string">b&#x27;Can you find it?&#x27;</span></span><br><span class="line">        signature1 = myDSA.sign(m1)</span><br><span class="line">        signature2 = myDSA.sign(m2)</span><br><span class="line">        self.send(<span class="string">b&#x27;Your signature1 is:&#x27;</span> + <span class="built_in">str</span>(signature1).encode())</span><br><span class="line">        self.send(<span class="string">b&#x27;Your signature2 is:&#x27;</span> + <span class="built_in">str</span>(signature2).encode())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">self</span>):</span><br><span class="line">        m = self.recv(<span class="string">b&#x27;message:&#x27;</span>)</span><br><span class="line">        r = <span class="built_in">int</span>(self.recv(<span class="string">b&#x27;r:&#x27;</span>))</span><br><span class="line">        s = <span class="built_in">int</span>(self.recv(<span class="string">b&#x27;s:&#x27;</span>))</span><br><span class="line">        signature = (r, s)</span><br><span class="line">        <span class="keyword">if</span> m == <span class="string">b&quot;I&#x27;m Admin.I want flag.&quot;</span>:</span><br><span class="line">            <span class="keyword">if</span> myDSA.verify(m, signature):</span><br><span class="line">                self.send(<span class="string">b&#x27;Hello there.This is what you want.&#x27;</span>)</span><br><span class="line">                self.send(flag)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.send(<span class="string">b&#x27;Who are U?Get out!&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.send(<span class="string">b&#x27;Who are U?Get out!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_public_key</span>(<span class="params">self</span>):</span><br><span class="line">        self.send(<span class="string">b&#x27;p = &#x27;</span> + <span class="built_in">str</span>(myDSA.p).encode())</span><br><span class="line">        self.send(<span class="string">b&#x27;q = &#x27;</span> + <span class="built_in">str</span>(myDSA.q).encode())</span><br><span class="line">        self.send(<span class="string">b&#x27;g = &#x27;</span> + <span class="built_in">str</span>(myDSA.g).encode())</span><br><span class="line">        self.send(<span class="string">b&#x27;y = &#x27;</span> + <span class="built_in">str</span>(myDSA.y).encode())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self</span>):</span><br><span class="line">        signal.alarm(<span class="number">30</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.proof_of_work():</span><br><span class="line">            self.send(<span class="string">b&#x27;You must pass the P0W!!!&#x27;</span>)</span><br><span class="line">            self.request.close()</span><br><span class="line">        <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">            self.send(MENU)</span><br><span class="line">            option = <span class="built_in">int</span>(self.recv(prompt=<span class="string">b&#x27;Give me your option:&#x27;</span>))</span><br><span class="line">            <span class="keyword">if</span> option == <span class="number">1</span>:</span><br><span class="line">                self.sign()</span><br><span class="line">            <span class="keyword">elif</span> option == <span class="number">2</span>:</span><br><span class="line">                self.verify()</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">elif</span> option == <span class="number">3</span>:</span><br><span class="line">                self.get_public_key()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        self.request.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST, PORT = <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">10001</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;HOST:POST &quot;</span> + HOST + <span class="string">&quot;:&quot;</span> + <span class="built_in">str</span>(PORT))</span><br><span class="line">    server = ThreadedServer((HOST, PORT), Task)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure>
<p>ä¸€é“é¶æœºäº¤äº’é¢˜ï¼Œä»£ç è¾ƒé•¿ï¼Œä½†æ˜¯å…¶å®å¤§éƒ¨åˆ†æ˜¯äº¤äº’ç›¸å…³çš„å‡½æ•°ï¼Œç»†è¯»å‘ç°æ˜¯å¾ˆæ­£å¸¸çš„DSAï¼Œéœ€è¦ç”¨ç»™å®šæ˜æ–‡é€šè¿‡ä»–çš„éªŒç­¾æ“ä½œã€‚ï¼ˆå¦‚æœä¸ç†Ÿæ‚‰DSAç­¾åæµç¨‹ï¼Œä¸€å®šè¦è‡ªè¡ŒæŸ¥é˜…äº†è§£ä¸€ä¸‹ï¼‰</p>
<p>æ£€æŸ¥ä»£ç å‘ç°æ¼æ´å‡ºåœ¨signï¼Œç”±äºäº¤äº’å¼€å§‹æ—¶ï¼Œéšæœºå¯†é’¥kå°±ä¸ä¼šå†å˜åŠ¨ï¼Œå› æ­¤ä¸¤ä¸ªæ˜æ–‡å…±ç”¨äº†kç”¨ä½œç­¾åï¼Œå› æ­¤ç›´æ¥ä½¿ç”¨å…±äº«kæ”»å‡»å³å¯ï¼Œå…·ä½“åŸç†ä¹Ÿå¾ˆç®€å•ï¼Œè‡ªè¡Œæœç´¢å…±äº«kæ”»å‡»å³å¯ã€‚è¿›é˜¶çš„è¿˜æœ‰å¯¹çº¿æ€§kã€æŒ‡æ•°kç­‰ç›¸å…³æ”»å‡»æ–¹å¼ã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line">p = <span class="number">172961942888113119438093761564402163853274437530074061334853565231663662473345365517029153614577994838261528197758562341350007269014020447862968046418219322983982857376325091297503076457294884011022491521807290579653731078712552375942815577480924479760060089879761373677236785972440188569442167867715538948131</span></span><br><span class="line">q = <span class="number">1238294525750070611176801188652181858159488474961</span></span><br><span class="line">g = <span class="number">75657702601417227921344829575623735976532473731371029415534443940309702116075857552168402559956825576158353466597825895213717785384352099702983338787137184850387592826820271959589796127014544636714131043162304391677607332131259874984936943058742638800688694139378157588974460944304847089533750902878536046649</span></span><br><span class="line">y = <span class="number">7749296960818920297640684628219596188301310658741359444363507697372166821952159177715756651776536866582220227892407461198512231438360662343916445812054004711764127526569139925464723782772657462476688091598602960531766048824996984183046388253897618420503521674510979988799110962834514762035965219607971731464</span></span><br><span class="line"></span><br><span class="line">r1,s1 = (<span class="number">952312130113235199710494038379463278196320139331</span>, <span class="number">246708316787437486170638565016913560785356026546</span>)</span><br><span class="line">r2,s2 = (<span class="number">952312130113235199710494038379463278196320139331</span>, <span class="number">604408984593559575502554675534691666132540008638</span>)</span><br><span class="line"></span><br><span class="line">m1 = <span class="string">b&#x27;I want to tell you a secret&#x27;</span></span><br><span class="line">m2 = <span class="string">b&#x27;Can you find it?&#x27;</span></span><br><span class="line">h1 = bytes_to_long(sha256(m1).digest())</span><br><span class="line">h2 = bytes_to_long(sha256(m2).digest())</span><br><span class="line"></span><br><span class="line">k = (h1-h2)*inverse(s1-s2,q)</span><br><span class="line">x = (k*s1 - h1)*inverse(r1,q) % q</span><br><span class="line"></span><br><span class="line">m = <span class="string">b&quot;I&#x27;m Admin.I want flag.&quot;</span></span><br><span class="line">h = bytes_to_long(sha256(m).digest())</span><br><span class="line">r = <span class="built_in">pow</span>(g, k, p) % q</span><br><span class="line">s = inverse(k, q) * (h + x * r) % q</span><br><span class="line"><span class="built_in">print</span>(r)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br></pre></td></tr></table></figure>
<p>(è¿™é¢˜æ²¡æœ‰å®Œæ•´è„šæœ¬ï¼Œæ‹¿ç€è¿™ä¸ªrï¼Œså»äº¤äº’å°±å¯ä»¥äº†ï¼›å› ä¸ºæ¯”è¾ƒæ‡’ï¼Œå½“æ—¶ç›´æ¥ç”¨xshellè¿æ¥ä¸Šåæ‰‹åŠ¨è¿‡çš„sha256çˆ†ç ´ï¼Œæ‰‹åŠ¨æäº¤çš„rï¼Œsã€‚ã€‚æ‰€ä»¥å°±æ²¡æœ‰å®Œæ•´pwntoolsäº¤äº’è„šæœ¬)</p>
<p>flag:</p>
<font size="4" color="red">cnss{1ts_Dr4nger0us_t0_u5eThe_Same_K}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="StrangeCurve"><a href="#StrangeCurve" class="headerlink" title="StrangeCurve"></a>StrangeCurve</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">The Cruve is SOO0000 Strange!</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">rom Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">5</span>]==<span class="string">&#x27;cnss&#123;&#x27;</span> <span class="keyword">and</span> flag[-<span class="number">1</span>] == <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">flag_k = bytes_to_long(flag[<span class="number">5</span>:-<span class="number">1</span>].encode())</span><br><span class="line"></span><br><span class="line">p = <span class="number">1096126227998177188652856107362412783873814431647</span></span><br><span class="line">a = <span class="number">0</span></span><br><span class="line">b = <span class="number">5</span></span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> E.order() == p </span><br><span class="line">base_point = E(<span class="number">626099523290649705896889901241128842906228328604</span>,<span class="number">886038875771695334071307095455656761758842526929</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> base_point <span class="keyword">in</span> E</span><br><span class="line"><span class="keyword">assert</span> flag_k &lt; p </span><br><span class="line"></span><br><span class="line">Q = flag_k*base_point</span><br><span class="line"><span class="built_in">print</span>(Q)</span><br><span class="line"></span><br><span class="line"><span class="comment"># (240653647745552223089451307742208085297121769374 : 1041806436100548540817642210994295951394712587396 : 1)</span></span><br></pre></td></tr></table></figure>
<p>æ¤­åœ†æ›²çº¿åŠ å¯†ï¼Œä¸‹é¢è¿™è¡Œæ˜¯é‡è¦ä¿¡æ¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">assert</span> E.order() == p </span><br></pre></td></tr></table></figure>
<p>å› æ­¤å¯ä»¥ç¡®å®šæ˜¯Smartâ€™s attackã€‚</p>
<p><br></p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SmartAttack</span>(<span class="params">P,Q,p</span>):</span><br><span class="line">    E = P.curve()</span><br><span class="line">    Eqp = EllipticCurve(Qp(p, <span class="number">2</span>), [ ZZ(t) + randint(<span class="number">0</span>,p)*p <span class="keyword">for</span> t <span class="keyword">in</span> E.a_invariants() ])</span><br><span class="line"></span><br><span class="line">    P_Qps = Eqp.lift_x(ZZ(P.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> P_Qp <span class="keyword">in</span> P_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(P_Qp.xy()[<span class="number">1</span>]) == P.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    Q_Qps = Eqp.lift_x(ZZ(Q.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> Q_Qp <span class="keyword">in</span> Q_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(Q_Qp.xy()[<span class="number">1</span>]) == Q.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    p_times_P = p*P_Qp</span><br><span class="line">    p_times_Q = p*Q_Qp</span><br><span class="line"></span><br><span class="line">    x_P,y_P = p_times_P.xy()</span><br><span class="line">    x_Q,y_Q = p_times_Q.xy()</span><br><span class="line"></span><br><span class="line">    phi_P = -(x_P/y_P)</span><br><span class="line">    phi_Q = -(x_Q/y_Q)</span><br><span class="line">    k = phi_Q/phi_P</span><br><span class="line">    <span class="keyword">return</span> ZZ(k)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = <span class="number">1096126227998177188652856107362412783873814431647</span></span><br><span class="line">a = <span class="number">0</span></span><br><span class="line">b = <span class="number">5</span></span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line"></span><br><span class="line">P = E(<span class="number">626099523290649705896889901241128842906228328604</span>,<span class="number">886038875771695334071307095455656761758842526929</span>)</span><br><span class="line">Q = E(<span class="number">240653647745552223089451307742208085297121769374</span>,<span class="number">1041806436100548540817642210994295951394712587396</span>)</span><br><span class="line"></span><br><span class="line">n = SmartAttack(P, Q, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;cnss&#123;&quot;</span> + <span class="built_in">str</span>(long_to_bytes(n))[<span class="number">2</span>:-<span class="number">1</span>] + <span class="string">&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{DLPise45y_if5pecia1}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="ä¸€ğŸ”ªä¸€ä¸ªç‰›å¤´äºº"><a href="#ä¸€ğŸ”ªä¸€ä¸ªç‰›å¤´äºº" class="headerlink" title="ä¸€ğŸ”ªä¸€ä¸ªç‰›å¤´äºº"></a>ä¸€ğŸ”ªä¸€ä¸ªç‰›å¤´äºº</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å­¦äº†NTRU,å°±è¦NTR u(âŒ)</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> shuffle, getrandbits</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">Zx = PolynomialRing(ZZ, <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">x = Zx.gen()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convolution</span>(<span class="params">f, g, R</span>):</span><br><span class="line">    <span class="keyword">return</span> (f * g) % R</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">balancedmod</span>(<span class="params">f, q, R</span>):</span><br><span class="line">    g = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x: ((x + q//<span class="number">2</span>) % q) - q//<span class="number">2</span>, f.<span class="built_in">list</span>()))</span><br><span class="line">    <span class="keyword">return</span> Zx(g) % R</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">random_poly</span>(<span class="params">n, d1, d2</span>):</span><br><span class="line">    <span class="keyword">assert</span> d1 + d2 &lt;= n</span><br><span class="line">    result = d1 * [<span class="number">1</span>] + d2 * [-<span class="number">1</span>] + (n - d1 - d2) * [<span class="number">0</span>]</span><br><span class="line">    shuffle(result)</span><br><span class="line">    <span class="keyword">return</span> Zx(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_poly_mod_prime</span>(<span class="params">f, R, p</span>):</span><br><span class="line">    T = Zx.change_ring(Integers(p)).quotient(R)</span><br><span class="line">    <span class="keyword">return</span> Zx(lift(<span class="number">1</span> / T(f)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_poly_mod_powerof2</span>(<span class="params">f, R, q</span>):  <span class="comment"># Hensel Lemma </span></span><br><span class="line">    g = invert_poly_mod_prime(f, R, <span class="number">2</span>)</span><br><span class="line">    e = log(q, <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e):</span><br><span class="line">        g = ((<span class="number">2</span> * g - f * g ** <span class="number">2</span>) % R) % q</span><br><span class="line">    <span class="keyword">return</span> g</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NTRUCipher</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, N, p, q, d</span>):</span><br><span class="line">        self.N = N</span><br><span class="line">        self.p = p</span><br><span class="line">        self.q = q</span><br><span class="line">        self.d = d</span><br><span class="line">        self.R = x ** N - <span class="number">1</span></span><br><span class="line">        <span class="comment"># key generation</span></span><br><span class="line">        self.g = random_poly(self.N, d, d)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                self.f = random_poly(self.N, d + <span class="number">1</span>, d)</span><br><span class="line">                self.fp = invert_poly_mod_prime(self.f, self.R, self.p)</span><br><span class="line">                self.fq = invert_poly_mod_powerof2(self.f, self.R, self.q)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        self.h = balancedmod(self.p * convolution(self.fq, self.g, self.R), self.q, self.R)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getPubKey</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.h</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, m</span>):</span><br><span class="line">        r = random_poly(self.N, self.d, self.d)</span><br><span class="line">        <span class="keyword">return</span> balancedmod(convolution(self.h, r, self.R) + m, self.q, self.R)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, c</span>):</span><br><span class="line">        a = balancedmod(convolution(c, self.f, self.R), self.q, self.R)</span><br><span class="line">        <span class="keyword">return</span> balancedmod(convolution(a, self.fp, self.R), self.p, self.R)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">self, val</span>):</span><br><span class="line">        poly = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.N):</span><br><span class="line">            poly += ((val % self.p) - self.p // <span class="number">2</span>) * (x ** i)</span><br><span class="line">            val //= self.p</span><br><span class="line">        <span class="keyword">return</span> poly</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">self, poly</span>):</span><br><span class="line">        result = <span class="number">0</span></span><br><span class="line">        ll = poly.<span class="built_in">list</span>()</span><br><span class="line">        <span class="keyword">for</span> idx, val <span class="keyword">in</span> <span class="built_in">enumerate</span>(ll):</span><br><span class="line">            result += (val + self.p // <span class="number">2</span>) * (self.p ** idx)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">poly_from_list</span>(<span class="params">self, l: <span class="built_in">list</span></span>):</span><br><span class="line">        <span class="keyword">return</span> Zx(l)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    N = <span class="number">160</span></span><br><span class="line">    d = <span class="number">30</span></span><br><span class="line">    p = <span class="number">3</span></span><br><span class="line">    q = <span class="number">65536</span></span><br><span class="line"></span><br><span class="line">    cipher = NTRUCipher(N, p, q, d) </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[PubKey]---------&quot;</span>)</span><br><span class="line">    h = cipher.getPubKey()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;h = <span class="subst">&#123;h&#125;</span>&#x27;</span>)</span><br><span class="line">    msg = bytes_to_long(flag)</span><br><span class="line">    encode_msg = cipher.encode(msg)</span><br><span class="line">    c = cipher.encrypt(encode_msg)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[Cipher]---------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line">    mm = cipher.decrypt(c)</span><br><span class="line">    decode_msg = cipher.decode(mm)</span><br><span class="line">    <span class="keyword">assert</span> decode_msg == msg</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[PubKey]---------</span></span><br><span class="line"><span class="string">h = -11891*x^159 + 16347*x^158 - 32137*x^157 + 14988*x^156 + 16657*x^155 - 25785*x^154 - 21976*x^153 - 31745*x^152 - 4232*x^151 + 29569*x^150 + 27140*x^149 + 19617*x^148 - 16656*x^147 + 8925*x^146 + 8728*x^145 - 8802*x^144 - 10794*x^143 - 28159*x^142 - 6454*x^141 - 10259*x^140 - 19169*x^139 - 14357*x^138 + 3501*x^137 + 9885*x^136 - 7441*x^135 + 18268*x^134 - 27183*x^133 + 26085*x^132 + 19147*x^131 + 17153*x^130 - 22887*x^129 + 32476*x^128 - 21698*x^127 + 19138*x^126 + 11585*x^125 + 22755*x^124 - 5920*x^123 + 7581*x^122 + 25973*x^121 + 13787*x^120 - 22762*x^119 + 29207*x^118 - 17916*x^117 - 11502*x^116 + 18275*x^115 + 318*x^114 - 6890*x^113 - 22751*x^112 - 27677*x^111 - 11114*x^110 + 8623*x^109 - 15725*x^108 - 6835*x^107 - 8288*x^106 - 5235*x^105 - 28697*x^104 + 10696*x^103 + 17117*x^102 + 24696*x^101 - 7801*x^100 - 31874*x^99 - 17668*x^98 - 11204*x^97 + 19147*x^96 + 24644*x^95 - 29380*x^94 - 26237*x^93 - 27390*x^92 + 19982*x^91 + 4074*x^90 - 17248*x^89 - 11027*x^88 - 32690*x^87 + 5124*x^86 - 20823*x^85 - 11779*x^84 + 13781*x^83 + 29356*x^82 - 9740*x^81 - 31484*x^80 - 540*x^79 + 32360*x^78 + 24795*x^77 - 8864*x^76 + 17363*x^75 + 9670*x^74 + 32268*x^73 + 17961*x^72 + 6388*x^71 + 580*x^70 + 128*x^69 + 339*x^68 + 3412*x^67 - 4519*x^66 - 25056*x^65 + 6096*x^64 + 18720*x^63 - 5338*x^62 + 16910*x^61 + 3353*x^60 + 15433*x^59 - 28053*x^58 - 18883*x^57 + 7688*x^56 - 31198*x^55 + 9950*x^54 - 9388*x^53 + 21235*x^52 + 2847*x^51 + 24383*x^50 + 19431*x^49 + 21244*x^48 - 8498*x^47 - 28998*x^46 + 962*x^45 + 20579*x^44 + 28002*x^43 - 6040*x^42 + 4241*x^41 + 11655*x^40 - 32419*x^39 + 21531*x^38 + 7348*x^37 - 5503*x^36 + 29820*x^35 + 28896*x^34 + 8754*x^33 + 17978*x^32 + 7552*x^31 + 27240*x^30 - 29515*x^29 - 20322*x^28 + 2201*x^27 + 8857*x^26 - 50*x^25 - 3780*x^24 - 12138*x^23 + 10893*x^22 + 23133*x^21 + 6142*x^20 - 23798*x^19 - 15236*x^18 + 32564*x^17 + 25683*x^16 - 24010*x^15 - 4355*x^14 + 22552*x^13 - 27155*x^12 + 27649*x^11 + 17781*x^10 + 7115*x^9 + 27465*x^8 - 4369*x^7 + 24882*x^6 - 11675*x^5 - 612*x^4 + 12361*x^3 + 20120*x^2 + 6190*x - 10843</span></span><br><span class="line"><span class="string">[Cipher]---------</span></span><br><span class="line"><span class="string">c = -26801*x^159 - 25103*x^158 + 29811*x^157 - 12251*x^156 - 13386*x^155 - 28030*x^154 - 16511*x^153 + 23761*x^152 + 28329*x^151 - 16406*x^150 + 30931*x^149 + 5326*x^148 + 19877*x^147 - 23165*x^146 - 31540*x^145 - 7923*x^144 + 5880*x^143 - 27078*x^142 - 25436*x^141 - 17162*x^140 + 1471*x^139 + 14486*x^138 + 7702*x^137 - 29890*x^136 + 29315*x^135 + 558*x^134 - 22429*x^133 - 361*x^132 + 19049*x^131 - 30437*x^130 - 32610*x^129 - 3024*x^128 - 4313*x^127 + 29174*x^126 - 2837*x^125 - 2812*x^124 + 13450*x^123 - 15001*x^122 - 25791*x^121 - 8702*x^120 - 4968*x^119 - 15340*x^118 + 31744*x^117 - 32478*x^116 + 19737*x^115 - 12629*x^114 - 27847*x^113 + 27322*x^112 - 31375*x^111 + 14777*x^110 + 29825*x^109 - 25883*x^108 - 13335*x^107 + 32517*x^106 + 14871*x^105 - 7287*x^104 + 13398*x^103 - 32710*x^102 + 20805*x^101 + 29734*x^100 - 14579*x^99 + 17483*x^98 - 16864*x^97 - 26745*x^96 + 3254*x^95 + 7280*x^94 - 29046*x^93 - 7531*x^92 - 8791*x^91 + 15033*x^90 - 1125*x^89 - 14713*x^88 - 12273*x^87 + 8616*x^86 + 2486*x^85 + 31810*x^84 + 27795*x^83 - 21731*x^82 + 21743*x^81 - 27595*x^80 - 3592*x^79 - 27206*x^78 - 32156*x^77 + 32124*x^76 - 11212*x^75 - 6662*x^74 - 23103*x^73 - 3660*x^72 - 31043*x^71 - 17131*x^70 + 24544*x^69 - 32326*x^68 - 31047*x^67 + 19814*x^66 + 10874*x^65 - 8449*x^64 + 11744*x^63 + 2245*x^62 - 967*x^61 + 9120*x^60 + 8983*x^59 - 24573*x^58 + 24885*x^57 + 15649*x^56 - 18970*x^55 + 7354*x^54 - 12282*x^53 - 22474*x^52 + 4395*x^51 + 8428*x^50 - 32592*x^49 + 25980*x^48 - 4599*x^47 + 16310*x^46 + 18559*x^45 + 22897*x^44 + 19080*x^43 - 26065*x^42 - 9*x^41 + 29202*x^40 + 2121*x^39 - 5004*x^38 + 5299*x^37 - 28301*x^36 - 13519*x^35 + 24241*x^34 + 529*x^33 - 20574*x^32 - 27391*x^31 + 31976*x^30 + 22824*x^29 - 31410*x^28 - 20976*x^27 + 21661*x^26 - 15132*x^25 + 1905*x^24 - 30870*x^23 + 18109*x^22 - 17373*x^21 + 5342*x^20 - 22447*x^19 + 1893*x^18 - 17545*x^17 + 30097*x^16 - 21731*x^15 + 17390*x^14 + 10991*x^13 - 5384*x^12 + 15960*x^11 + 24268*x^10 - 29867*x^9 + 22532*x^8 + 10133*x^7 - 26576*x^6 - 5742*x^5 - 16252*x^4 + 13019*x^3 - 25984*x^2 + 14004*x + 22500</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>ä¸€ä¸ªæ™®é€šçš„NTRUå¤šé¡¹å¼å¯†ç ï¼Œä¹Ÿæ˜¯ä¸æ ¼æœ‰å…³çš„ï¼Œå…¶å…·ä½“åŸç†å¯ä»¥å‚è€ƒï¼š(ç”šè‡³è¯¦ç»†é˜è¿°äº†æ¯ä¸ªå‡½æ•°çš„ä½œç”¨)</p>
<p><a href="http://blog.k1rit0.eu.org/2021/03/28/Translation-of-LatticeHacks/">Translation of LatticeHacks Â· K1rit0â€™s Blog</a> </p>
<p><br></p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">160</span></span><br><span class="line">d = <span class="number">30</span></span><br><span class="line">p = <span class="number">3</span></span><br><span class="line">q = <span class="number">65536</span></span><br><span class="line">PR = PolynomialRing(ZZ, name = <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">x = PR.gen()</span><br><span class="line">R = PR.quotient_ring(x ^ n - <span class="number">1</span>, names = <span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">y = R.gen()</span><br><span class="line"></span><br><span class="line">pubkey = -<span class="number">11891</span>*x^<span class="number">159</span> + <span class="number">16347</span>*x^<span class="number">158</span> - <span class="number">32137</span>*x^<span class="number">157</span> + <span class="number">14988</span>*x^<span class="number">156</span> + <span class="number">16657</span>*x^<span class="number">155</span> - <span class="number">25785</span>*x^<span class="number">154</span> - <span class="number">21976</span>*x^<span class="number">153</span> - <span class="number">31745</span>*x^<span class="number">152</span> - <span class="number">4232</span>*x^<span class="number">151</span> + <span class="number">29569</span>*x^<span class="number">150</span> + <span class="number">27140</span>*x^<span class="number">149</span> + <span class="number">19617</span>*x^<span class="number">148</span> - <span class="number">16656</span>*x^<span class="number">147</span> + <span class="number">8925</span>*x^<span class="number">146</span> + <span class="number">8728</span>*x^<span class="number">145</span> - <span class="number">8802</span>*x^<span class="number">144</span> - <span class="number">10794</span>*x^<span class="number">143</span> - <span class="number">28159</span>*x^<span class="number">142</span> - <span class="number">6454</span>*x^<span class="number">141</span> - <span class="number">10259</span>*x^<span class="number">140</span> - <span class="number">19169</span>*x^<span class="number">139</span> - <span class="number">14357</span>*x^<span class="number">138</span> + <span class="number">3501</span>*x^<span class="number">137</span> + <span class="number">9885</span>*x^<span class="number">136</span> - <span class="number">7441</span>*x^<span class="number">135</span> + <span class="number">18268</span>*x^<span class="number">134</span> - <span class="number">27183</span>*x^<span class="number">133</span> + <span class="number">26085</span>*x^<span class="number">132</span> + <span class="number">19147</span>*x^<span class="number">131</span> + <span class="number">17153</span>*x^<span class="number">130</span> - <span class="number">22887</span>*x^<span class="number">129</span> + <span class="number">32476</span>*x^<span class="number">128</span> - <span class="number">21698</span>*x^<span class="number">127</span> + <span class="number">19138</span>*x^<span class="number">126</span> + <span class="number">11585</span>*x^<span class="number">125</span> + <span class="number">22755</span>*x^<span class="number">124</span> - <span class="number">5920</span>*x^<span class="number">123</span> + <span class="number">7581</span>*x^<span class="number">122</span> + <span class="number">25973</span>*x^<span class="number">121</span> + <span class="number">13787</span>*x^<span class="number">120</span> - <span class="number">22762</span>*x^<span class="number">119</span> + <span class="number">29207</span>*x^<span class="number">118</span> - <span class="number">17916</span>*x^<span class="number">117</span> - <span class="number">11502</span>*x^<span class="number">116</span> + <span class="number">18275</span>*x^<span class="number">115</span> + <span class="number">318</span>*x^<span class="number">114</span> - <span class="number">6890</span>*x^<span class="number">113</span> - <span class="number">22751</span>*x^<span class="number">112</span> - <span class="number">27677</span>*x^<span class="number">111</span> - <span class="number">11114</span>*x^<span class="number">110</span> + <span class="number">8623</span>*x^<span class="number">109</span> - <span class="number">15725</span>*x^<span class="number">108</span> - <span class="number">6835</span>*x^<span class="number">107</span> - <span class="number">8288</span>*x^<span class="number">106</span> - <span class="number">5235</span>*x^<span class="number">105</span> - <span class="number">28697</span>*x^<span class="number">104</span> + <span class="number">10696</span>*x^<span class="number">103</span> + <span class="number">17117</span>*x^<span class="number">102</span> + <span class="number">24696</span>*x^<span class="number">101</span> - <span class="number">7801</span>*x^<span class="number">100</span> - <span class="number">31874</span>*x^<span class="number">99</span> - <span class="number">17668</span>*x^<span class="number">98</span> - <span class="number">11204</span>*x^<span class="number">97</span> + <span class="number">19147</span>*x^<span class="number">96</span> + <span class="number">24644</span>*x^<span class="number">95</span> - <span class="number">29380</span>*x^<span class="number">94</span> - <span class="number">26237</span>*x^<span class="number">93</span> - <span class="number">27390</span>*x^<span class="number">92</span> + <span class="number">19982</span>*x^<span class="number">91</span> + <span class="number">4074</span>*x^<span class="number">90</span> - <span class="number">17248</span>*x^<span class="number">89</span> - <span class="number">11027</span>*x^<span class="number">88</span> - <span class="number">32690</span>*x^<span class="number">87</span> + <span class="number">5124</span>*x^<span class="number">86</span> - <span class="number">20823</span>*x^<span class="number">85</span> - <span class="number">11779</span>*x^<span class="number">84</span> + <span class="number">13781</span>*x^<span class="number">83</span> + <span class="number">29356</span>*x^<span class="number">82</span> - <span class="number">9740</span>*x^<span class="number">81</span> - <span class="number">31484</span>*x^<span class="number">80</span> - <span class="number">540</span>*x^<span class="number">79</span> + <span class="number">32360</span>*x^<span class="number">78</span> + <span class="number">24795</span>*x^<span class="number">77</span> - <span class="number">8864</span>*x^<span class="number">76</span> + <span class="number">17363</span>*x^<span class="number">75</span> + <span class="number">9670</span>*x^<span class="number">74</span> + <span class="number">32268</span>*x^<span class="number">73</span> + <span class="number">17961</span>*x^<span class="number">72</span> + <span class="number">6388</span>*x^<span class="number">71</span> + <span class="number">580</span>*x^<span class="number">70</span> + <span class="number">128</span>*x^<span class="number">69</span> + <span class="number">339</span>*x^<span class="number">68</span> + <span class="number">3412</span>*x^<span class="number">67</span> - <span class="number">4519</span>*x^<span class="number">66</span> - <span class="number">25056</span>*x^<span class="number">65</span> + <span class="number">6096</span>*x^<span class="number">64</span> + <span class="number">18720</span>*x^<span class="number">63</span> - <span class="number">5338</span>*x^<span class="number">62</span> + <span class="number">16910</span>*x^<span class="number">61</span> + <span class="number">3353</span>*x^<span class="number">60</span> + <span class="number">15433</span>*x^<span class="number">59</span> - <span class="number">28053</span>*x^<span class="number">58</span> - <span class="number">18883</span>*x^<span class="number">57</span> + <span class="number">7688</span>*x^<span class="number">56</span> - <span class="number">31198</span>*x^<span class="number">55</span> + <span class="number">9950</span>*x^<span class="number">54</span> - <span class="number">9388</span>*x^<span class="number">53</span> + <span class="number">21235</span>*x^<span class="number">52</span> + <span class="number">2847</span>*x^<span class="number">51</span> + <span class="number">24383</span>*x^<span class="number">50</span> + <span class="number">19431</span>*x^<span class="number">49</span> + <span class="number">21244</span>*x^<span class="number">48</span> - <span class="number">8498</span>*x^<span class="number">47</span> - <span class="number">28998</span>*x^<span class="number">46</span> + <span class="number">962</span>*x^<span class="number">45</span> + <span class="number">20579</span>*x^<span class="number">44</span> + <span class="number">28002</span>*x^<span class="number">43</span> - <span class="number">6040</span>*x^<span class="number">42</span> + <span class="number">4241</span>*x^<span class="number">41</span> + <span class="number">11655</span>*x^<span class="number">40</span> - <span class="number">32419</span>*x^<span class="number">39</span> + <span class="number">21531</span>*x^<span class="number">38</span> + <span class="number">7348</span>*x^<span class="number">37</span> - <span class="number">5503</span>*x^<span class="number">36</span> + <span class="number">29820</span>*x^<span class="number">35</span> + <span class="number">28896</span>*x^<span class="number">34</span> + <span class="number">8754</span>*x^<span class="number">33</span> + <span class="number">17978</span>*x^<span class="number">32</span> + <span class="number">7552</span>*x^<span class="number">31</span> + <span class="number">27240</span>*x^<span class="number">30</span> - <span class="number">29515</span>*x^<span class="number">29</span> - <span class="number">20322</span>*x^<span class="number">28</span> + <span class="number">2201</span>*x^<span class="number">27</span> + <span class="number">8857</span>*x^<span class="number">26</span> - <span class="number">50</span>*x^<span class="number">25</span> - <span class="number">3780</span>*x^<span class="number">24</span> - <span class="number">12138</span>*x^<span class="number">23</span> + <span class="number">10893</span>*x^<span class="number">22</span> + <span class="number">23133</span>*x^<span class="number">21</span> + <span class="number">6142</span>*x^<span class="number">20</span> - <span class="number">23798</span>*x^<span class="number">19</span> - <span class="number">15236</span>*x^<span class="number">18</span> + <span class="number">32564</span>*x^<span class="number">17</span> + <span class="number">25683</span>*x^<span class="number">16</span> - <span class="number">24010</span>*x^<span class="number">15</span> - <span class="number">4355</span>*x^<span class="number">14</span> + <span class="number">22552</span>*x^<span class="number">13</span> - <span class="number">27155</span>*x^<span class="number">12</span> + <span class="number">27649</span>*x^<span class="number">11</span> + <span class="number">17781</span>*x^<span class="number">10</span> + <span class="number">7115</span>*x^<span class="number">9</span> + <span class="number">27465</span>*x^<span class="number">8</span> - <span class="number">4369</span>*x^<span class="number">7</span> + <span class="number">24882</span>*x^<span class="number">6</span> - <span class="number">11675</span>*x^<span class="number">5</span> - <span class="number">612</span>*x^<span class="number">4</span> + <span class="number">12361</span>*x^<span class="number">3</span> + <span class="number">20120</span>*x^<span class="number">2</span> + <span class="number">6190</span>*x - <span class="number">10843</span></span><br><span class="line">pubkey = R(pubkey)</span><br><span class="line">c = -<span class="number">26801</span>*x^<span class="number">159</span> - <span class="number">25103</span>*x^<span class="number">158</span> + <span class="number">29811</span>*x^<span class="number">157</span> - <span class="number">12251</span>*x^<span class="number">156</span> - <span class="number">13386</span>*x^<span class="number">155</span> - <span class="number">28030</span>*x^<span class="number">154</span> - <span class="number">16511</span>*x^<span class="number">153</span> + <span class="number">23761</span>*x^<span class="number">152</span> + <span class="number">28329</span>*x^<span class="number">151</span> - <span class="number">16406</span>*x^<span class="number">150</span> + <span class="number">30931</span>*x^<span class="number">149</span> + <span class="number">5326</span>*x^<span class="number">148</span> + <span class="number">19877</span>*x^<span class="number">147</span> - <span class="number">23165</span>*x^<span class="number">146</span> - <span class="number">31540</span>*x^<span class="number">145</span> - <span class="number">7923</span>*x^<span class="number">144</span> + <span class="number">5880</span>*x^<span class="number">143</span> - <span class="number">27078</span>*x^<span class="number">142</span> - <span class="number">25436</span>*x^<span class="number">141</span> - <span class="number">17162</span>*x^<span class="number">140</span> + <span class="number">1471</span>*x^<span class="number">139</span> + <span class="number">14486</span>*x^<span class="number">138</span> + <span class="number">7702</span>*x^<span class="number">137</span> - <span class="number">29890</span>*x^<span class="number">136</span> + <span class="number">29315</span>*x^<span class="number">135</span> + <span class="number">558</span>*x^<span class="number">134</span> - <span class="number">22429</span>*x^<span class="number">133</span> - <span class="number">361</span>*x^<span class="number">132</span> + <span class="number">19049</span>*x^<span class="number">131</span> - <span class="number">30437</span>*x^<span class="number">130</span> - <span class="number">32610</span>*x^<span class="number">129</span> - <span class="number">3024</span>*x^<span class="number">128</span> - <span class="number">4313</span>*x^<span class="number">127</span> + <span class="number">29174</span>*x^<span class="number">126</span> - <span class="number">2837</span>*x^<span class="number">125</span> - <span class="number">2812</span>*x^<span class="number">124</span> + <span class="number">13450</span>*x^<span class="number">123</span> - <span class="number">15001</span>*x^<span class="number">122</span> - <span class="number">25791</span>*x^<span class="number">121</span> - <span class="number">8702</span>*x^<span class="number">120</span> - <span class="number">4968</span>*x^<span class="number">119</span> - <span class="number">15340</span>*x^<span class="number">118</span> + <span class="number">31744</span>*x^<span class="number">117</span> - <span class="number">32478</span>*x^<span class="number">116</span> + <span class="number">19737</span>*x^<span class="number">115</span> - <span class="number">12629</span>*x^<span class="number">114</span> - <span class="number">27847</span>*x^<span class="number">113</span> + <span class="number">27322</span>*x^<span class="number">112</span> - <span class="number">31375</span>*x^<span class="number">111</span> + <span class="number">14777</span>*x^<span class="number">110</span> + <span class="number">29825</span>*x^<span class="number">109</span> - <span class="number">25883</span>*x^<span class="number">108</span> - <span class="number">13335</span>*x^<span class="number">107</span> + <span class="number">32517</span>*x^<span class="number">106</span> + <span class="number">14871</span>*x^<span class="number">105</span> - <span class="number">7287</span>*x^<span class="number">104</span> + <span class="number">13398</span>*x^<span class="number">103</span> - <span class="number">32710</span>*x^<span class="number">102</span> + <span class="number">20805</span>*x^<span class="number">101</span> + <span class="number">29734</span>*x^<span class="number">100</span> - <span class="number">14579</span>*x^<span class="number">99</span> + <span class="number">17483</span>*x^<span class="number">98</span> - <span class="number">16864</span>*x^<span class="number">97</span> - <span class="number">26745</span>*x^<span class="number">96</span> + <span class="number">3254</span>*x^<span class="number">95</span> + <span class="number">7280</span>*x^<span class="number">94</span> - <span class="number">29046</span>*x^<span class="number">93</span> - <span class="number">7531</span>*x^<span class="number">92</span> - <span class="number">8791</span>*x^<span class="number">91</span> + <span class="number">15033</span>*x^<span class="number">90</span> - <span class="number">1125</span>*x^<span class="number">89</span> - <span class="number">14713</span>*x^<span class="number">88</span> - <span class="number">12273</span>*x^<span class="number">87</span> + <span class="number">8616</span>*x^<span class="number">86</span> + <span class="number">2486</span>*x^<span class="number">85</span> + <span class="number">31810</span>*x^<span class="number">84</span> + <span class="number">27795</span>*x^<span class="number">83</span> - <span class="number">21731</span>*x^<span class="number">82</span> + <span class="number">21743</span>*x^<span class="number">81</span> - <span class="number">27595</span>*x^<span class="number">80</span> - <span class="number">3592</span>*x^<span class="number">79</span> - <span class="number">27206</span>*x^<span class="number">78</span> - <span class="number">32156</span>*x^<span class="number">77</span> + <span class="number">32124</span>*x^<span class="number">76</span> - <span class="number">11212</span>*x^<span class="number">75</span> - <span class="number">6662</span>*x^<span class="number">74</span> - <span class="number">23103</span>*x^<span class="number">73</span> - <span class="number">3660</span>*x^<span class="number">72</span> - <span class="number">31043</span>*x^<span class="number">71</span> - <span class="number">17131</span>*x^<span class="number">70</span> + <span class="number">24544</span>*x^<span class="number">69</span> - <span class="number">32326</span>*x^<span class="number">68</span> - <span class="number">31047</span>*x^<span class="number">67</span> + <span class="number">19814</span>*x^<span class="number">66</span> + <span class="number">10874</span>*x^<span class="number">65</span> - <span class="number">8449</span>*x^<span class="number">64</span> + <span class="number">11744</span>*x^<span class="number">63</span> + <span class="number">2245</span>*x^<span class="number">62</span> - <span class="number">967</span>*x^<span class="number">61</span> + <span class="number">9120</span>*x^<span class="number">60</span> + <span class="number">8983</span>*x^<span class="number">59</span> - <span class="number">24573</span>*x^<span class="number">58</span> + <span class="number">24885</span>*x^<span class="number">57</span> + <span class="number">15649</span>*x^<span class="number">56</span> - <span class="number">18970</span>*x^<span class="number">55</span> + <span class="number">7354</span>*x^<span class="number">54</span> - <span class="number">12282</span>*x^<span class="number">53</span> - <span class="number">22474</span>*x^<span class="number">52</span> + <span class="number">4395</span>*x^<span class="number">51</span> + <span class="number">8428</span>*x^<span class="number">50</span> - <span class="number">32592</span>*x^<span class="number">49</span> + <span class="number">25980</span>*x^<span class="number">48</span> - <span class="number">4599</span>*x^<span class="number">47</span> + <span class="number">16310</span>*x^<span class="number">46</span> + <span class="number">18559</span>*x^<span class="number">45</span> + <span class="number">22897</span>*x^<span class="number">44</span> + <span class="number">19080</span>*x^<span class="number">43</span> - <span class="number">26065</span>*x^<span class="number">42</span> - <span class="number">9</span>*x^<span class="number">41</span> + <span class="number">29202</span>*x^<span class="number">40</span> + <span class="number">2121</span>*x^<span class="number">39</span> - <span class="number">5004</span>*x^<span class="number">38</span> + <span class="number">5299</span>*x^<span class="number">37</span> - <span class="number">28301</span>*x^<span class="number">36</span> - <span class="number">13519</span>*x^<span class="number">35</span> + <span class="number">24241</span>*x^<span class="number">34</span> + <span class="number">529</span>*x^<span class="number">33</span> - <span class="number">20574</span>*x^<span class="number">32</span> - <span class="number">27391</span>*x^<span class="number">31</span> + <span class="number">31976</span>*x^<span class="number">30</span> + <span class="number">22824</span>*x^<span class="number">29</span> - <span class="number">31410</span>*x^<span class="number">28</span> - <span class="number">20976</span>*x^<span class="number">27</span> + <span class="number">21661</span>*x^<span class="number">26</span> - <span class="number">15132</span>*x^<span class="number">25</span> + <span class="number">1905</span>*x^<span class="number">24</span> - <span class="number">30870</span>*x^<span class="number">23</span> + <span class="number">18109</span>*x^<span class="number">22</span> - <span class="number">17373</span>*x^<span class="number">21</span> + <span class="number">5342</span>*x^<span class="number">20</span> - <span class="number">22447</span>*x^<span class="number">19</span> + <span class="number">1893</span>*x^<span class="number">18</span> - <span class="number">17545</span>*x^<span class="number">17</span> + <span class="number">30097</span>*x^<span class="number">16</span> - <span class="number">21731</span>*x^<span class="number">15</span> + <span class="number">17390</span>*x^<span class="number">14</span> + <span class="number">10991</span>*x^<span class="number">13</span> - <span class="number">5384</span>*x^<span class="number">12</span> + <span class="number">15960</span>*x^<span class="number">11</span> + <span class="number">24268</span>*x^<span class="number">10</span> - <span class="number">29867</span>*x^<span class="number">9</span> + <span class="number">22532</span>*x^<span class="number">8</span> + <span class="number">10133</span>*x^<span class="number">7</span> - <span class="number">26576</span>*x^<span class="number">6</span> - <span class="number">5742</span>*x^<span class="number">5</span> - <span class="number">16252</span>*x^<span class="number">4</span> + <span class="number">13019</span>*x^<span class="number">3</span> - <span class="number">25984</span>*x^<span class="number">2</span> + <span class="number">14004</span>*x + <span class="number">22500</span></span><br><span class="line">c = R(c)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">balance_mod</span>(<span class="params">f, q</span>):</span><br><span class="line">    g = <span class="built_in">list</span>(((f[i] + q // <span class="number">2</span>) % q) - q // <span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n))</span><br><span class="line">    <span class="keyword">return</span> R(g)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_mod_prime</span>(<span class="params">f, p</span>):</span><br><span class="line">    T = R.base().change_ring(Integers(p)).quotient(x ^ n - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> R(<span class="number">1</span> / T(f))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dec</span>(<span class="params">c, prikey</span>):</span><br><span class="line">    f, fp = prikey</span><br><span class="line">    a = balance_mod(c * f, q)</span><br><span class="line">    <span class="keyword">return</span> balance_mod(a * fp, p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack</span>(<span class="params">pubkey, c</span>):</span><br><span class="line">    A = Matrix(ZZ, <span class="number">2</span> * n, <span class="number">2</span> * n)</span><br><span class="line">    hp = inverse(p, q) * pubkey</span><br><span class="line">    hp_list = <span class="built_in">list</span>(hp)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        A[i, i] = q</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n, <span class="number">2</span> * n):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            A[i, j] = hp_list[(j - i) % n]</span><br><span class="line">        A[i, i] = <span class="number">1</span></span><br><span class="line">    AL = A.BKZ()</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> AL:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            f = R(row[n:].<span class="built_in">list</span>())</span><br><span class="line">            fp = invert_mod_prime(f, p)</span><br><span class="line">            <span class="keyword">return</span> dec(c, (f, fp))</span><br><span class="line">            <span class="keyword">break</span> <span class="comment"># may failed with shortest vector(return more if failed)</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line">m = crack(pubkey, c)</span><br><span class="line"></span><br><span class="line">m = m.<span class="built_in">list</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">    m[i] += <span class="number">1</span></span><br><span class="line">    m[i] = <span class="built_in">str</span>(m[i])</span><br><span class="line">str1 = <span class="string">&quot;&quot;</span>.join(m[::-<span class="number">1</span>])</span><br><span class="line">temp = <span class="built_in">int</span>(str1,<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(temp))</span><br></pre></td></tr></table></figure>
<p>(å¯èƒ½éœ€è¦è·‘å‡ åˆ†é’Ÿ)</p>
<p>flag:</p>
<font size="4" color="red">cnss{NTRU_w1th_un5afe_par4}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="MidLattice"><a href="#MidLattice" class="headerlink" title="MidLattice"></a>MidLattice</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">çœ‹ä¸Šå»åƒgcdï¼Œä½†æ˜¯æœ‰åŒºåˆ«</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">pbit = <span class="number">500</span></span><br><span class="line">qbit = <span class="number">550</span></span><br><span class="line">rbit = <span class="number">200</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_sample</span>():</span><br><span class="line">    x_list  = []</span><br><span class="line">    p = getPrime(pbit)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">120</span>):</span><br><span class="line">        q = getPrime(qbit)</span><br><span class="line">        r = getPrime(rbit)</span><br><span class="line">        x_list.append(q*p + <span class="number">2</span>*r)</span><br><span class="line">    <span class="keyword">return</span> x_list,p</span><br><span class="line">sample,p = get_sample()</span><br><span class="line">flag = <span class="string">&#x27;cnss&#123;&#x27;</span>+hashlib.sha256(long_to_bytes(p)).hexdigest()+<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(<span class="built_in">str</span>(sample))</span><br></pre></td></tr></table></figure>
<p>ä»¥åŠä¸€ä¸ªoutput.txt</p>
<p>é¢˜ç›®æè¿°çš„å¾ˆæ˜ç¡®äº†ï¼Œagcdé—®é¢˜(è¿‘ä¼¼å…¬çº¦æ•°é—®é¢˜)ï¼Œä¹Ÿä¸æ ¼ç›¸å…³ï¼Œä¸è¿›è¡Œå±•å¼€ã€‚</p>
<p><br></p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> permutations</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">P_bits = <span class="number">500</span></span><br><span class="line">Q_bits = <span class="number">550</span></span><br><span class="line">R_bits = <span class="number">200</span></span><br><span class="line">e = <span class="number">0x1337</span></span><br><span class="line">N = <span class="comment">#è‡ªè¡Œä»£å…¥</span></span><br><span class="line">X = <span class="number">2</span>**R_bits</span><br><span class="line">m = <span class="built_in">len</span>(N)</span><br><span class="line"></span><br><span class="line">PR = PolynomialRing(ZZ, names=[<span class="built_in">str</span>(<span class="string">&#x27;x%d&#x27;</span> % i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1</span> + m)])</span><br><span class="line"></span><br><span class="line">h = <span class="number">3</span></span><br><span class="line">u = <span class="number">1</span></span><br><span class="line">variables = PR.gens()</span><br><span class="line"></span><br><span class="line">gg = []</span><br><span class="line">monomials = [variables[<span class="number">0</span>]**<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    gg.append(N[i] - variables[i])</span><br><span class="line">    monomials.append(variables[i])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(monomials), <span class="built_in">len</span>(gg))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;monomials:&#x27;</span>, monomials)</span><br><span class="line"></span><br><span class="line">B = Matrix(ZZ, <span class="built_in">len</span>(gg), <span class="built_in">len</span>(monomials))</span><br><span class="line"><span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(gg)):</span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(monomials)):</span><br><span class="line">        <span class="keyword">if</span> monomials[jj] <span class="keyword">in</span> gg[ii].monomials():</span><br><span class="line">            B[ii, jj] = gg[ii].monomial_coefficient(monomials[jj]) * monomials[jj]([X] * m)</span><br><span class="line"></span><br><span class="line">B = B.LLL()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-&#x27;</span> * <span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">new_pol = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(gg)):</span><br><span class="line">    tmp_pol = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(monomials)):</span><br><span class="line">        tmp_pol += monomials[j](variables) * B[i, j] / monomials[j]([X] * m)</span><br><span class="line">    new_pol.append(tmp_pol)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(new_pol) &gt; <span class="number">0</span>:</span><br><span class="line">    Ideal = ideal(new_pol[:m-<span class="number">1</span>])</span><br><span class="line">    GB = Ideal.groebner_basis()</span><br><span class="line">    function_variables = var([<span class="built_in">str</span>(<span class="string">&#x27;y%d&#x27;</span> % i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1</span> + m)])</span><br><span class="line">    res = solve([pol(function_variables) <span class="keyword">for</span> pol <span class="keyword">in</span> GB], function_variables)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;got %d basis&#x27;</span> % <span class="built_in">len</span>(GB))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;solved result:&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br><span class="line">    PRRR.&lt; x, y&gt; = PolynomialRing(QQ)</span><br><span class="line">    q = <span class="built_in">abs</span>(PRRR(res[<span class="number">0</span>][<span class="number">0</span>](x, y)).coefficients()[<span class="number">0</span>].denominator())</span><br><span class="line">    p = N[-<span class="number">1</span>] // q</span><br><span class="line"></span><br><span class="line">    flag = <span class="string">&#x27;cnss&#123;&#x27;</span>+hashlib.sha256(long_to_bytes(p)).hexdigest()+<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿéœ€è¦è·‘å‡ åˆ†é’Ÿæ‰å‡ºç»“æœï¼Œèƒ½æ›´ç²¾ç¡®åœ°è°ƒæ•´å‚æ•°çš„è¯å¯èƒ½å¯ä»¥å‡å°‘è€—æ—¶ã€‚</p>
<p>flag:</p>
<font size="4" color="red">cnss{dde0cc3ac3539c66a74ed445a81c3f5b12938c286fa569a3b143b72369c708c9}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="é“œåŒ çš„ä¸–ç•Œ"><a href="#é“œåŒ çš„ä¸–ç•Œ" class="headerlink" title="é“œåŒ çš„ä¸–ç•Œ"></a>é“œåŒ çš„ä¸–ç•Œ</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ€æ ·åœ¨2^512ä¸ªå¯èƒ½ä¸­æ‰¾åˆ°å”¯ä¸€çš„ç­”æ¡ˆå‘¢ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> isqrt</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p, q = getPrime(<span class="number">512</span>), getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">hint = isqrt(p) ^ isqrt(q)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;hint = &#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 85404423344841677974087657659736161235661371072424467828040714876602706438511794670195915251038316685200550396898521246532238184171610202260808362573973358649489859739377219665083353960986881177279315590581777896976153899765953910931555330824054172366095461986394627542626117519624886018101305667394230690241</span></span><br><span class="line"><span class="string">c = 19771222413844352631385715488753476758377273736688852768996964594019231638669697870409256892886494956719082541038530128231778575768552216334354854019126139003782852207071549956953446472517410158388833668611141062328959917017080292879996106665465487753670322759387144032463518586362415629216383494479440197516</span></span><br><span class="line"><span class="string">hint = 34903932064178830653499046348212332783401351910283782992020948402621276719605</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœç»™çš„æ˜¯p^qï¼Œé¢˜ç›®æ˜¯å®¹æ˜“çš„ï¼Œåªéœ€è¦æŒ‰ç…§RSA â…¡ç±»ä¼¼çš„æ€è·¯è¿›è¡Œæ·±æœå³å¯ã€‚è€Œç»™çš„æ˜¯isqrt(p) ^ isqrt(q)ï¼Œå¾ˆå®¹æ˜“ä¼šæœ‰æ€è·¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>å¯¹nå¼€æ ¹ï¼Œå¾—åˆ°isqrt(p*q) </li>
<li>å°†isqrt(p*q) çœ‹ä½œnï¼Œå°†isqrt(p) ^ isqrt(q)çœ‹ä½œp^qï¼Œè½¬åŒ–æˆä¸Šé¢ç»™å®šp^qçš„é—®é¢˜æ±‚è§£</li>
</ul>
<p>çœ‹ä¸Šå»æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œå¯æ˜¯å®é™…æ“ä½œå°±ä¼šå‘ç°å­˜åœ¨ä¸¤ç‚¹é—®é¢˜ï¼š</p>
<ul>
<li>ç”±äºä¸€äº›ä½ä½è¯¯å·®ï¼Œæœ‰ä¸€äº›å¯èƒ½æ­£ç¡®çš„æ ¹å·pã€qé«˜ä½è¢«èˆå¼ƒã€‚</li>
<li>å³ä½¿å¾—åˆ°äº†æ­£ç¡®çš„isqrt(p)ä¸isqrt(q)ï¼Œå„è‡ªå¹³æ–¹åä¸çœŸæ­£çš„pã€qè¿˜æœ‰è‡³å°‘256æ¯”ç‰¹çš„å·®è·ï¼Œå³ä½¿æ˜¯ç”¨coppersmithä¹Ÿå®Œå…¨æ»¡è¶³ä¸äº†ä½¿ç”¨æ¡ä»¶ã€‚</li>
</ul>
<p>å› æ­¤ä¸èƒ½å†ä½¿ç”¨RSA â…¡ä¸­çš„è¿”å›æ¡ä»¶è¿›è¡ŒæŒ‰ä½æŸ¥æ‰¾äº†ã€‚æ­¤æ—¶æœç´¢é¢˜ç›®ï¼Œå‘ç°äº†ä½¬çš„ç±»ä¼¼çš„é¢˜ç›®æ€è·¯ï¼š</p>
<p><a href="https://blog.maple3142.net/2023/06/12/seetf-2023-writeups/#shard">https://blog.maple3142.net/2023/06/12/seetf-2023-writeups/#shard</a></p>
<p>è¿™æ ·å­æŸ¥æ‰¾æˆåŠŸåï¼Œè¿˜éœ€è¦å¯¹ä½ä½è¿›è¡Œä¸€å®šç¨‹åº¦çš„çˆ†ç ´åæ‰èƒ½ä½¿ç”¨coppersmithï¼Œå¹¶ä¸”å‚æ•°è¦å¡çš„æ¯”è¾ƒæ­»ï¼Œæ¯”å¦‚epsilonå–0.03è™½ç„¶å¿«ä¸€äº›ï¼Œä½†æ˜¯è·‘ä¸å‡ºç»“æœï¼Œå› æ­¤åªèƒ½å–0.01ç”šè‡³æ›´å°ï¼Œä½†è¿™ä¸ªå°±ä¼šè€—è´¹å¾ˆé•¿æ—¶é—´ã€‚é—æ†¾çš„æ˜¯æˆ‘ä¹Ÿæ²¡æœ‰æƒ³å‡ºæ›´å¥½çš„åŠæ³•ã€‚</p>
<p><br></p>
<p>exp_step1.ipynbï¼š(æ±‚å‡ºå¯èƒ½çš„pé«˜ä½)ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> randbelow</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> re <span class="keyword">import</span> findall</span><br><span class="line"><span class="keyword">from</span> subprocess <span class="keyword">import</span> check_output</span><br><span class="line"><span class="keyword">from</span> binteger <span class="keyword">import</span> Bin</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">self, X=<span class="literal">None</span>, beta=<span class="number">1.0</span>, epsilon=<span class="literal">None</span>, **kwds</span>):</span><br><span class="line">    <span class="keyword">from</span> sage.misc.verbose <span class="keyword">import</span> verbose</span><br><span class="line">    <span class="keyword">from</span> sage.matrix.constructor <span class="keyword">import</span> Matrix</span><br><span class="line">    <span class="keyword">from</span> sage.rings.real_mpfr <span class="keyword">import</span> RR</span><br><span class="line"></span><br><span class="line">    N = self.parent().characteristic()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> self.is_monic():</span><br><span class="line">        <span class="keyword">raise</span> ArithmeticError(<span class="string">&quot;Polynomial must be monic.&quot;</span>)</span><br><span class="line"></span><br><span class="line">    beta = RR(beta)</span><br><span class="line">    <span class="keyword">if</span> beta &lt;= <span class="number">0.0</span> <span class="keyword">or</span> beta &gt; <span class="number">1.0</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;0.0 &lt; beta &lt;= 1.0 not satisfied.&quot;</span>)</span><br><span class="line"></span><br><span class="line">    f = self.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    P, (x,) = f.parent().objgens()</span><br><span class="line"></span><br><span class="line">    delta = f.degree()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> epsilon <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        epsilon = beta / <span class="number">8</span></span><br><span class="line">    verbose(<span class="string">&quot;epsilon = %f&quot;</span> % epsilon, level=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    m = <span class="built_in">max</span>(beta**<span class="number">2</span> / (delta * epsilon), <span class="number">7</span> * beta / delta).ceil()</span><br><span class="line">    verbose(<span class="string">&quot;m = %d&quot;</span> % m, level=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    t = <span class="built_in">int</span>((delta * m * (<span class="number">1</span> / beta - <span class="number">1</span>)).floor())</span><br><span class="line">    verbose(<span class="string">&quot;t = %d&quot;</span> % t, level=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> X <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        X = (<span class="number">0.5</span> * N ** (beta**<span class="number">2</span> / delta - epsilon)).ceil()</span><br><span class="line">    verbose(<span class="string">&quot;X = %s&quot;</span> % X, level=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># we could do this much faster, but this is a cheap step</span></span><br><span class="line">    <span class="comment"># compared to LLL</span></span><br><span class="line">    g = [x**j * N ** (m - i) * f**i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(delta)]</span><br><span class="line">    g.extend([x**i * f**m <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t)])  <span class="comment"># h</span></span><br><span class="line"></span><br><span class="line">    B = Matrix(ZZ, <span class="built_in">len</span>(g), delta * m + <span class="built_in">max</span>(delta, t))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(B.nrows()):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(g[i].degree() + <span class="number">1</span>):</span><br><span class="line">            B[i, j] = g[i][j] * X**j</span><br><span class="line"></span><br><span class="line">    f = <span class="built_in">sum</span>([ZZ(B[<span class="number">0</span>, i] // X**i) * x**i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(B.ncols())])</span><br><span class="line">    R = f.roots()</span><br><span class="line"></span><br><span class="line">    ZmodN = self.base_ring()</span><br><span class="line">    roots = <span class="built_in">set</span>([ZmodN(r) <span class="keyword">for</span> r, m <span class="keyword">in</span> R <span class="keyword">if</span> <span class="built_in">abs</span>(r) &lt;= X])</span><br><span class="line">    Nbeta = N**beta</span><br><span class="line">    <span class="keyword">return</span> [root <span class="keyword">for</span> root <span class="keyword">in</span> roots <span class="keyword">if</span> N.gcd(ZZ(self(root))) &gt;= Nbeta]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pq = <span class="number">85404423344841677974087657659736161235661371072424467828040714876602706438511794670195915251038316685200550396898521246532238184171610202260808362573973358649489859739377219665083353960986881177279315590581777896976153899765953910931555330824054172366095461986394627542626117519624886018101305667394230690241</span></span><br><span class="line">c = <span class="number">19771222413844352631385715488753476758377273736688852768996964594019231638669697870409256892886494956719082541038530128231778575768552216334354854019126139003782852207071549956953446472517410158388833668611141062328959917017080292879996106665465487753670322759387144032463518586362415629216383494479440197516</span></span><br><span class="line">hint = <span class="number">34903932064178830653499046348212332783401351910283782992020948402621276719605</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dfs</span>(<span class="params">spv, i</span>):</span><br><span class="line">    <span class="keyword">if</span> i &gt;= <span class="number">256</span>:</span><br><span class="line">        <span class="keyword">yield</span> Bin(spv, <span class="number">256</span>), Bin(Bin(spv).<span class="built_in">int</span> ^^ hint, <span class="number">256</span>)</span><br><span class="line">    <span class="keyword">if</span> i &gt;= <span class="number">256</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> (<span class="number">1</span>, <span class="number">0</span>):</span><br><span class="line">        spv[i] = b</span><br><span class="line">        tsp = Bin(spv).<span class="built_in">int</span></span><br><span class="line">        tsq = tsp ^^ hint</span><br><span class="line">        p = tsp**<span class="number">2</span></span><br><span class="line">        q = tsq**<span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> &lt;= (pq - p * q) &lt;= <span class="number">2</span> ** (<span class="number">1024</span> - i + <span class="number">1</span>) <span class="keyword">and</span> <span class="number">0</span> &lt;= (</span><br><span class="line">            iroot(pq,<span class="number">2</span>)[<span class="number">0</span>] - tsp * tsq</span><br><span class="line">        ) &lt;= <span class="number">2</span> ** (<span class="number">512</span> - i + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">yield</span> <span class="keyword">from</span> dfs(spv[:], i + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">spv = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line">results = []</span><br><span class="line"><span class="keyword">for</span> spc, sqc <span class="keyword">in</span> dfs(spv, <span class="number">0</span>):</span><br><span class="line">    d = pq - spc.<span class="built_in">int</span>**<span class="number">2</span> * sqc.<span class="built_in">int</span>**<span class="number">2</span></span><br><span class="line">    results.append((d, spc.<span class="built_in">int</span>, sqc.<span class="built_in">int</span>))</span><br><span class="line"><span class="keyword">for</span> i, (_, spci, sqci) <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">sorted</span>(results)):</span><br><span class="line">    <span class="number">1</span></span><br><span class="line">    <span class="comment">#print((spci - (iroot(pq,2)[0] // sqci)).bit_length())</span></span><br><span class="line"><span class="built_in">print</span>(results)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">copp_factor</span>(<span class="params">sp, leak=<span class="number">5</span></span>):</span><br><span class="line">    <span class="keyword">for</span> tb <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span> &lt;&lt; leak):</span><br><span class="line">        <span class="comment">#print(&quot;copp&quot;, tb, int(time.time()))</span></span><br><span class="line">        shift = <span class="number">256</span> - leak + <span class="number">1</span></span><br><span class="line">        P = Zmod(pq)[<span class="string">&quot;x&quot;</span>]</span><br><span class="line">        x = P.gen()</span><br><span class="line">        f = sp.<span class="built_in">int</span>**<span class="number">2</span> + (x &lt;&lt; shift) + <span class="number">2</span>*tb + <span class="number">1</span></span><br><span class="line">        f = f.monic()</span><br><span class="line">        X = <span class="number">2</span> ** (<span class="number">256</span> - leak - <span class="number">1</span>)</span><br><span class="line">        beta = <span class="number">0.499</span></span><br><span class="line">        eps = <span class="number">0.01</span></span><br><span class="line">        rs = f.small_roots(X=X, beta=beta, epsilon=eps)</span><br><span class="line">        <span class="comment">#rs = small_roots(f, X=X, beta=beta, epsilon=eps)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(rs):</span><br><span class="line">            <span class="built_in">print</span>(sp.<span class="built_in">int</span>**<span class="number">2</span> + (tb &lt;&lt; shift) + <span class="built_in">int</span>(rs[<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, (_, spci, _) <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">sorted</span>(results)):</span><br><span class="line">    copp_factor(Bin(spci, <span class="number">256</span>))</span><br></pre></td></tr></table></figure>
<p>å°†è¿è¡Œç»“æœå¡«å……è‡³ä¸‹é¢è„šæœ¬ä¸­çš„sqrtplistä¸­</p>
<p><br></p>
<p>exp_step2.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="comment">#coppersmith</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line">N = <span class="number">85404423344841677974087657659736161235661371072424467828040714876602706438511794670195915251038316685200550396898521246532238184171610202260808362573973358649489859739377219665083353960986881177279315590581777896976153899765953910931555330824054172366095461986394627542626117519624886018101305667394230690241</span></span><br><span class="line">c = <span class="number">19771222413844352631385715488753476758377273736688852768996964594019231638669697870409256892886494956719082541038530128231778575768552216334354854019126139003782852207071549956953446472517410158388833668611141062328959917017080292879996106665465487753670322759387144032463518586362415629216383494479440197516</span></span><br><span class="line"></span><br><span class="line">sqrtplist = <span class="comment">#è‡ªè¡Œä»£å…¥</span></span><br><span class="line"></span><br><span class="line">leak = <span class="number">6</span></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(sqrtplist)):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    sp = sqrtplist[i][<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> tb <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span> &lt;&lt; leak):</span><br><span class="line">        <span class="comment">#print(&quot;copp&quot;, tb, int(time.time()))</span></span><br><span class="line">        shift = <span class="number">256</span> - leak</span><br><span class="line">        PR.&lt;x&gt; = PolynomialRing(Zmod(N))</span><br><span class="line">        f = sp**<span class="number">2</span> + (tb &lt;&lt; shift) + x</span><br><span class="line">        f = f.monic()</span><br><span class="line">        X = <span class="number">2</span> ** (<span class="number">256</span> - leak)</span><br><span class="line">        beta = <span class="number">0.499</span></span><br><span class="line">        eps = <span class="number">0.01</span></span><br><span class="line">        res = f.small_roots(X=X, beta=beta, epsilon=eps)</span><br><span class="line">        <span class="keyword">if</span>(res!=[]):</span><br><span class="line">            <span class="built_in">print</span>(res)</span><br><span class="line">            <span class="built_in">print</span>(sp**<span class="number">2</span> + (tb &lt;&lt; shift) + res[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">p = <span class="number">6756521617869105417915102754795944450583448652752246233837766079298009351893501307888859133738834804209006551446537605217981998432259279870915861077557549</span></span><br><span class="line">q = N//p</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,N)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>è·‘å‡ºç»“æœå¯èƒ½éœ€è¦6ä¸ªå°æ—¶åˆ°10ä¸ªå°æ—¶ä¸ç­‰ã€‚å¦‚æœä½ æœ‰æ›´å¥½çš„æ–¹å¼æ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ï¼</p>
<p>flag:</p>
<font size="4" color="red">cnss{We hav3 n0 0ther ch0ice but c0ppersm1th.}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é¢˜ç›®è´¨é‡ç¡®å®å¾ˆä¸é”™ï¼Œæ¯é“é¢˜ç›®è€ƒå¯Ÿçš„çŸ¥è¯†ç‚¹å¾ˆæœ‰é’ˆå¯¹æ€§ï¼Œå‡†å¤‡å¥½å¥½å€Ÿé‰´å‚è€ƒ(<del>å¼€å·</del>)ã€‚</p>
]]></content>
      <categories>
        <category>wp-crypto</category>
      </categories>
  </entry>
  <entry>
    <title>NSSCTF-2nd-wp-crypto</title>
    <url>/post/39588.html</url>
    <content><![CDATA[<span id="more"></span>
<p>è¿™æ¬¡cryptoé¢˜ç›®æ€»ä½“éš¾åº¦ä¸å¤§ï¼Œé‡ç‚¹æ˜¯å¯¹ä¸€äº›åŸºç¡€çŸ¥è¯†çš„ç†è§£è¿ç”¨ã€‚</p>
<h2 id="EzRSA"><a href="#EzRSA" class="headerlink" title="EzRSA"></a>EzRSA</h2><p>é¢˜ç›®:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">assert</span> m.bit_length()&lt;<span class="number">200</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">kbits = <span class="number">103</span></span><br><span class="line">m = (m &gt;&gt; kbits) &lt;&lt; kbits</span><br><span class="line">Mod = getPrime(<span class="number">1024</span>)</span><br><span class="line">hint1 = (<span class="number">2021</span>-<span class="number">2023</span>*m) % Mod</span><br><span class="line">hint2 = <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">2023</span>, Mod)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;hint1 =&#x27;</span>,hint1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;hint2 =&#x27;</span>,hint2)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = ...</span></span><br><span class="line"><span class="string">c = ...</span></span><br><span class="line"><span class="string">hint1 = ...</span></span><br><span class="line"><span class="string">hint2 = ...</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>æœ‰ä»¥ä¸‹ä¿¡æ¯:</p>
<ul>
<li>m.bit_length()&lt;200 , è¯´æ˜æ˜æ–‡è¾ƒå°</li>
<li>kbits = 103 , m = (m &gt;&gt; kbits) &lt;&lt; kbits , éšè—äº†æ˜æ–‡ä½ä½</li>
<li>hint1 = (2021-2023*m) % Mod</li>
<li>hint2 = pow(2, 2023, Mod)</li>
</ul>
<p>ç§ç§éƒ½æŒ‡å‘coppersmith , é¦–å…ˆçœ‹hint2ï¼Œ</p>
<script type="math/tex; mode=display">
hint2  \equiv  2^{2023}  mod(Mod)</script><p>åˆ©ç”¨åŒä½™å…³ç³»,</p>
<script type="math/tex; mode=display">
2^{2023} - hint2 = k*Mod</script><p>å¾—åˆ°Modçš„kå€,å› æ­¤å¯ä»¥åˆ©ç”¨k*Modå»ºç«‹ç¯ï¼Œè§£å‡ºhint1ä¸­çš„å°æ ¹mï¼Œè§£å¾—mé«˜ä½åå·²çŸ¥é«˜ä½æ”»å‡»å³å¯ã€‚</p>
<p><br></p>
<p>exp.ipynb:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = ...</span><br><span class="line">c = ...</span><br><span class="line">hint1 = ...</span><br><span class="line">hint2 = ...</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">kM = <span class="number">2</span>**<span class="number">2023</span>-hint2</span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(kM))</span><br><span class="line">f = <span class="number">2023</span>*x + hint1 - <span class="number">2021</span></span><br><span class="line">f = f.monic()</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^<span class="number">200</span>,beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="keyword">if</span> roots:</span><br><span class="line">    mhigh = roots[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">mhigh = <span class="number">1746716778150027565782467891299010283212636160</span></span><br><span class="line">PR.&lt;y&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = (mhigh + y)^<span class="number">3</span> - c</span><br><span class="line">f = f.monic()</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^<span class="number">104</span>,beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="keyword">if</span> roots:</span><br><span class="line">    m = mhigh + roots[<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">print</span>(m)</span><br><span class="line">m = <span class="number">1746716778150037336346788439252154990602710653</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flag:</p>
<font size="4" color="red">NSSCTF{Rea1_Si9n3n}</font>

<p><br></p>
<p>(èµ›ä¸­çš„æ—¶å€™ï¼Œè¿™é¢˜è§£æ•°æ¯”funnyencryptè¿˜å¤šï¼Œå½“æ—¶å°±æ„Ÿè§‰æœ‰ç‚¹è¯¡å¼‚ã€‚èµ›åæ‰å‘ç°å› ä¸ºæ˜å¯†æ–‡éƒ½å¾ˆå°ï¼Œæ‰€ä»¥ç›´æ¥å¼€ä¸‰æ¬¡æ ¹å°±å¯ä»¥äº†ã€‚ã€‚)</p>
<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="FunnyEncrypt"><a href="#FunnyEncrypt" class="headerlink" title="FunnyEncrypt"></a>FunnyEncrypt</h2><p>é¢˜ç›®:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">âœ§âœ¡âœ­</span><br><span class="line">âœ¡âœ® âœ£âœ´âœ¯ âœ¤âœ¶âœ¬âœ¬âœ± âœ¬âœ¤ âœ±âœ¦âœ¢âœ¥âœ®âœ¯âœ§âœ§, âœ´âœ¬âœ·âœ¯ âœ¡âœ§ âœ£âœ´âœ¯ âœ¶âœ¡âœ°âœ´âœ£. âœ¡âœ£ â‚âœ¢âœ¡âœ®âœ°âœ§ âœ©âœ¬âœ¸âœ¤âœ¬âœ¢âœ£, âœ¤âœ¦âœ¡âœ£âœ´, âœ¦âœ®âœ± âœ©âœ¬âœ®âœ¤âœ¡âœ±âœ¯âœ®âœ©âœ¯. âœ¡âœ£ âœ°âœ¡âœ²âœ¯âœ§ âœ³âœ§ âœ°âœ³âœ¡âœ±âœ¦âœ®âœ©âœ¯ â˜…âœ´âœ¯âœ® â˜…âœ¯ âœ¦âœ¢âœ¯ âœ¶âœ¬âœ§âœ£, âœ¦âœ®âœ± âœ°âœ¡âœ²âœ¯âœ§ âœ§âœ³âœ·âœ·âœ¬âœ¢âœ£ â˜…âœ´âœ¯âœ® â˜…âœ¯ âœ¦âœ¢âœ¯ âœ¦âœ¤âœ¢âœ¦âœ¡âœ±. âœ¦âœ®âœ± âœ£âœ´âœ¯ âœ¸âœ¬âœ¸âœ¯âœ®âœ£ â˜…âœ¯ âœ°âœ¡âœ²âœ¯ âœ³âœ· âœ´âœ¬âœ·âœ¯, â˜…âœ¯ âœ°âœ¡âœ²âœ¯ âœ³âœ· âœ¬âœ³âœ¢ âœ¶âœ¡âœ²âœ¯âœ§. âœ£âœ´âœ¯ â˜…âœ¬âœ¢âœ¶âœ± â˜…âœ¯ âœ¶âœ¡âœ²âœ¯ âœ¡âœ® âœ¡âœ§ âœ±âœ¡âœ§âœ¡âœ®âœ£âœ¯âœ°âœ¢âœ¦âœ£âœ¡âœ®âœ° âœ¡âœ®âœ£âœ¬ âœ¦ âœ·âœ¶âœ¦âœ©âœ¯ âœ¬âœ¤ âœ¸âœ¦âœ¶âœ¡âœ©âœ¯ âœ¦âœ®âœ± âœ´âœ¦âœ£âœ¢âœ¯âœ±, â˜…âœ´âœ¯âœ¢âœ¯ â˜…âœ¯ âœ®âœ¯âœ¯âœ± âœ´âœ¬âœ·âœ¯ âœ¦âœ®âœ± âœ¤âœ¡âœ®âœ± âœ¡âœ£ âœ´âœ¦âœ¢âœ±âœ¯âœ¢. âœ¡âœ® âœ£âœ´âœ¡âœ§ â˜…âœ¬âœ¢âœ¶âœ± âœ¬âœ¤ âœ¤âœ¯âœ¦âœ¢, âœ´âœ¬âœ·âœ¯ âœ£âœ¬ âœ¤âœ¡âœ®âœ± â‚âœ¯âœ£âœ£âœ¯âœ¢, â‚âœ³âœ£ âœ¯âœ¦âœ§âœ¡âœ¯âœ¢ âœ§âœ¦âœ¡âœ± âœ£âœ´âœ¦âœ® âœ±âœ¬âœ®âœ¯, âœ£âœ´âœ¯ âœ¸âœ¬âœ¢âœ¯ âœ¸âœ¯âœ¦âœ®âœ¡âœ®âœ°âœ¤âœ³âœ¶ âœ¶âœ¡âœ¤âœ¯ âœ¬âœ¤ âœ¤âœ¦âœ¡âœ£âœ´ â˜…âœ¡âœ¶âœ¶ âœ¸âœ¦âœ¥âœ¯ âœ¶âœ¡âœ¤âœ¯ âœ¸âœ¯âœ¦âœ®âœ¡âœ®âœ°âœ¤âœ³âœ¶.</span><br><span class="line">âœ§âœ¬âœ¸âœ¯âœ£âœ¡âœ¸âœ¯âœ§ â˜…âœ¯ âœ£âœ´âœ¡âœ®âœ¥ âœ¬âœ¤ âœ±âœ¢âœ¯âœ¦âœ¸âœ§ âœ¦âœ§ âœ¤âœ¦âœ®âœ£âœ¦âœ§âœ¡âœ¯âœ§ - âœ¡âœ£&#x27;âœ§ âœ¯âœ¦âœ§âœµ âœ£âœ¬ âœ±âœ¬ â˜…âœ´âœ¯âœ® âœµâœ¬âœ³ âœ´âœ¦âœ²âœ¯ âœ¸âœ¬âœ®âœ¯âœµ, âœ¢âœ¯âœ®âœ£, âœ¦âœ®âœ± â˜…âœ¬âœ¢âœ¥. â‚âœ³âœ£ âœµâœ¬âœ³ âœ©âœ¦âœ®&#x27;âœ£ âœ·âœ¢âœ¯âœ·âœ¦âœ¢âœ¯ âœµâœ¬âœ³âœ¢âœ§âœ¯âœ¶âœ¤ âœ¦âœ®âœ± âœ«âœ³âœ¸âœ· âœ¬âœ¤âœ¤ âœ£âœ´âœ¯ âœ©âœ¶âœ¡âœ¤âœ¤: âœµâœ¬âœ³ âœ§âœ´âœ¬âœ³âœ¶âœ± âœ°âœ¢âœ¬â˜… âœµâœ¬âœ³âœ¢ â˜…âœ¡âœ®âœ°âœ§ âœ¤âœ¡âœ¢âœ§âœ£. âœ¦ âœ¶âœ¡âœ£âœ£âœ¶âœ¯ â‚âœ¡âœ£ âœ£âœ¬â˜…âœ¦âœ¢âœ± âœ£âœ´âœ¯ âœ±âœ¢âœ¯âœ¦âœ¸. âœ§âœ£âœ¯âœ· â‚âœµ âœ§âœ£âœ¯âœ·. âœ£âœ¦âœ¥âœ¯ âœ¦ âœ§âœ£âœ¯âœ· âœ¤âœ¬âœ¢â˜…âœ¦âœ¢âœ±. âœ¦âœ¤âœ£âœ¯âœ¢ âœ¦âœ¶âœ¶, âœ¡âœ£&#x27;âœ§ âœµâœ¬âœ³âœ¢ âœ¸âœ¡âœ§âœ§âœ¡âœ¬âœ®.</span><br><span class="line">âœ¥âœ¯âœ¯âœ· âœ¤âœ¦âœ¡âœ£âœ´ âœ¦âœ®âœ± âœ´âœ¬âœ·âœ¯ âœ¤âœ¬âœ¢ âœ£âœ´âœ¯ âœ¤âœ³âœ£âœ³âœ¢âœ¯. âœ¸âœ¦âœ¥âœ¯ âœµâœ¬âœ³âœ¢ âœ¸âœ¬âœ§âœ£ âœ§âœ¡âœ®âœ©âœ¯âœ¢âœ¯ âœ±âœ¢âœ¯âœ¦âœ¸âœ§, âœ¦âœ®âœ± â˜…âœ´âœ¯âœ® âœ£âœ´âœ¯ âœ¬âœ·âœ·âœ¬âœ¢âœ£âœ³âœ®âœ¡âœ£âœ¡âœ¯âœ§ âœ©âœ¬âœ¸âœ¯, âœ£âœ´âœ¯âœµ â˜…âœ¡âœ¶âœ¶ âœ¤âœ¡âœ°âœ´âœ£ âœ¤âœ¬âœ¢ âœ£âœ´âœ¯âœ¸. âœ¡âœ£ âœ¸âœ¦âœµ âœ£âœ¦âœ¥âœ¯ âœ¦ âœ§âœ¯âœ¦âœ§âœ¬âœ® âœ¬âœ¢ âœ¸âœ¬âœ¢âœ¯, â‚âœ³âœ£ âœ£âœ´âœ¯ âœ¯âœ®âœ±âœ¡âœ®âœ° â˜…âœ¡âœ¶âœ¶ âœ®âœ¬âœ£ âœ©âœ´âœ¦âœ®âœ°âœ¯. âœ¦âœ¸â‚âœ¡âœ£âœ¡âœ¬âœ®, â‚âœ¯âœ§âœ£, â‚âœ¯âœ©âœ¬âœ¸âœ¯ âœ¦ âœ¢âœ¯âœ¦âœ¶âœ¡âœ£âœµ. âœ¦âœ® âœ³âœ®âœ©âœ¯âœ¢âœ£âœ¦âœ¡âœ® âœ¤âœ³âœ£âœ³âœ¢âœ¯, âœ¬âœ®âœ¶âœµ âœ¬âœ®âœ¯ âœ§âœ£âœ¯âœ· âœ¦âœ£ âœ¦ âœ£âœ¡âœ¸âœ¯, âœ£âœ´âœ¯ âœ´âœ¬âœ·âœ¯ âœ©âœ¦âœ® âœ¢âœ¯âœ¦âœ¶âœ¡âœªâœ¯ âœ£âœ´âœ¯ âœ±âœ¢âœ¯âœ¦âœ¸ âœ¬âœ¤ âœ£âœ´âœ¯ âœ´âœ¡âœ°âœ´âœ¯âœ§âœ£. â˜…âœ¯ âœ¸âœ³âœ§âœ£ âœ£âœ¢âœ¯âœ¦âœ§âœ³âœ¢âœ¯ âœ£âœ´âœ¯ âœ±âœ¢âœ¯âœ¦âœ¸, âœ£âœ¬ âœ·âœ¢âœ¬âœ£âœ¯âœ©âœ£ âœ¡âœ£ âœ¦ âœ§âœ¯âœ¦âœ§âœ¬âœ®, âœ¶âœ¯âœ£ âœ¡âœ£ âœ¡âœ® âœ£âœ´âœ¯ âœ´âœ¯âœ¦âœ¢âœ£ â‹âœ³âœ¡âœ¯âœ£âœ¶âœµ âœ°âœ¯âœ¢âœ¸âœ¡âœ®âœ¦âœ¶.</span><br><span class="line">âœ¬âœ®âœ¶âœµ â˜…âœ´âœ¯âœ® âœµâœ¬âœ³ âœ³âœ®âœ±âœ¯âœ¢âœ§âœ£âœ¦âœ®âœ± âœ£âœ´âœ¯ âœ£âœ¢âœ³âœ¯ âœ¸âœ¯âœ¦âœ®âœ¡âœ®âœ° âœ¬âœ¤ âœ¶âœ¡âœ¤âœ¯ âœ©âœ¦âœ® âœµâœ¬âœ³ âœ¶âœ¡âœ²âœ¯ âœ£âœ¢âœ³âœ¶âœµ. â‚âœ¡âœ£âœ£âœ¯âœ¢âœ§â˜…âœ¯âœ¯âœ£ âœ¦âœ§ âœ¶âœ¡âœ¤âœ¯ âœ¡âœ§, âœ¡âœ£&#x27;âœ§ âœ§âœ£âœ¡âœ¶âœ¶ â˜…âœ¬âœ®âœ±âœ¯âœ¢âœ¤âœ³âœ¶, âœ¦âœ®âœ± âœ¡âœ£&#x27;âœ§ âœ¤âœ¦âœ§âœ©âœ¡âœ®âœ¦âœ£âœ¡âœ®âœ° âœ¯âœ²âœ¯âœ® âœ¡âœ® âœ£âœ¢âœ¦âœ°âœ¯âœ±âœµ. âœ¡âœ¤ âœµâœ¬âœ³&#x27;âœ¢âœ¯ âœ«âœ³âœ§âœ£ âœ¦âœ¶âœ¡âœ²âœ¯, âœ£âœ¢âœµ âœ´âœ¦âœ¢âœ±âœ¯âœ¢ âœ¦âœ®âœ± âœ£âœ¢âœµ âœ£âœ¬ âœ¶âœ¡âœ²âœ¯ â˜…âœ¬âœ®âœ±âœ¯âœ¢âœ¤âœ³âœ¶âœ¶âœµ.</span><br><span class="line">âœ¡ â‚âœ¯âœ¶âœ¡âœ¯âœ²âœ¯ âœ£âœ´âœ¯âœ¢âœ¯ âœ¡âœ§ âœ¦ âœ·âœ¯âœ¢âœ§âœ¬âœ® â˜…âœ´âœ¬ â‚âœ¢âœ¡âœ®âœ°âœ§ âœ§âœ³âœ®âœ§âœ´âœ¡âœ®âœ¯ âœ¡âœ®âœ£âœ¬ âœµâœ¬âœ³âœ¢ âœ¶âœ¡âœ¤âœ¯. âœ£âœ´âœ¦âœ£ âœ·âœ¯âœ¢âœ§âœ¬âœ® âœ¸âœ¦âœµ âœ´âœ¦âœ²âœ¯ âœ¯âœ®âœ¬âœ³âœ°âœ´ âœ£âœ¬ âœ§âœ·âœ¢âœ¯âœ¦âœ± âœ¦âœ¢âœ¬âœ³âœ®âœ±. â‚âœ³âœ£ âœ¡âœ¤ âœµâœ¬âœ³ âœ¢âœ¯âœ¦âœ¶âœ¶âœµ âœ´âœ¦âœ²âœ¯ âœ£âœ¬ â˜…âœ¦âœ¡âœ£ âœ¤âœ¬âœ¢ âœ§âœ¬âœ¸âœ¯âœ¬âœ®âœ¯ âœ£âœ¬ â‚âœ¢âœ¡âœ®âœ° âœµâœ¬âœ³ âœ£âœ´âœ¯ âœ§âœ³âœ® âœ¦âœ®âœ± âœ°âœ¡âœ²âœ¯ âœµâœ¬âœ³ âœ¦ âœ°âœ¬âœ¬âœ± âœ¤âœ¯âœ¯âœ¶âœ¡âœ®âœ°, âœ£âœ´âœ¯âœ® âœµâœ¬âœ³ âœ¸âœ¦âœµ âœ´âœ¦âœ²âœ¯ âœ£âœ¬ â˜…âœ¦âœ¡âœ£ âœ¦ âœ¶âœ¬âœ®âœ° âœ£âœ¡âœ¸âœ¯.</span><br><span class="line">âœ¡âœ® âœ¦ â˜…âœ¬âœ¢âœ±,âœ¡ âœ´âœ¬âœ·âœ¯ âœµâœ¬âœ³ â˜…âœ¡âœ¶âœ¶ âœ¶âœ¡âœ¥âœ¯ âœ©âœ¢âœµâœ·âœ£âœ¬âœ°âœ¢âœ¦âœ·âœ´âœµ.âœ£âœ´âœ¡âœ§ âœ¡âœ§ âœµâœ¬âœ³âœ¢ âœ¤âœ¶âœ¦âœ°:âœ®âœ§âœ§âœ©âœ£âœ¤&#123;âœ©âœ¢âœµâœ·âœ£âœ¬_âœ¡âœ§_âœ§âœ¬_âœ¡âœ®âœ£âœ¯âœ¢âœ¯âœ§âœ£âœ¡âœ®âœ°_â˜…âœ´âœµ_âœ±âœ¬âœ®&#x27;âœ£_âœµâœ¬âœ³_âœ«âœ¬âœ¡âœ®_âœ³âœ§&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>è§è¿‡çš„å›¾å½¢åŠ å¯†ä¸­å¹¶æ²¡æœ‰ç±»ä¼¼è¿™ä¸ªçš„ï¼Œä¸è¿‡ç¿»çœ‹ä¸€ä¸‹é©¬ä¸Šå°±èƒ½å‘ç°æ–‡ä»¶å°¾éƒ¨çš„è¿™ä¸€ä¸²ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">âœ®âœ§âœ§âœ©âœ£âœ¤&#123;âœ©âœ¢âœµâœ·âœ£âœ¬_âœ¡âœ§_âœ§âœ¬_âœ¡âœ®âœ£âœ¯âœ¢âœ¯âœ§âœ£âœ¡âœ®âœ°_â˜…âœ´âœµ_âœ±âœ¬âœ®&#x27;âœ£_âœµâœ¬âœ³_âœ«âœ¬âœ¡âœ®_âœ³âœ§&#125;</span><br></pre></td></tr></table></figure>
<p>å‰ç¼€è‚¯å®šæ˜¯nssctfï¼Œæ˜¯å¯¹çš„ä¸Šçš„ï¼ŒçŒœæµ‹æ˜¯ç®€å•çš„æ›¿æ¢å¯†ç ï¼Œå†™ä¸ªè„šæœ¬åäº¤ç»™quipqiupå³å¯</p>
<p>exp.py:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">âœ§âœ¡âœ­</span></span><br><span class="line"><span class="string">âœ¡âœ® âœ£âœ´âœ¯ âœ¤âœ¶âœ¬âœ¬âœ± âœ¬âœ¤ âœ±âœ¦âœ¢âœ¥âœ®âœ¯âœ§âœ§, âœ´âœ¬âœ·âœ¯ âœ¡âœ§ âœ£âœ´âœ¯ âœ¶âœ¡âœ°âœ´âœ£. âœ¡âœ£ â‚âœ¢âœ¡âœ®âœ°âœ§ âœ©âœ¬âœ¸âœ¤âœ¬âœ¢âœ£, âœ¤âœ¦âœ¡âœ£âœ´, âœ¦âœ®âœ± âœ©âœ¬âœ®âœ¤âœ¡âœ±âœ¯âœ®âœ©âœ¯. âœ¡âœ£ âœ°âœ¡âœ²âœ¯âœ§ âœ³âœ§ âœ°âœ³âœ¡âœ±âœ¦âœ®âœ©âœ¯ â˜…âœ´âœ¯âœ® â˜…âœ¯ âœ¦âœ¢âœ¯ âœ¶âœ¬âœ§âœ£, âœ¦âœ®âœ± âœ°âœ¡âœ²âœ¯âœ§ âœ§âœ³âœ·âœ·âœ¬âœ¢âœ£ â˜…âœ´âœ¯âœ® â˜…âœ¯ âœ¦âœ¢âœ¯ âœ¦âœ¤âœ¢âœ¦âœ¡âœ±. âœ¦âœ®âœ± âœ£âœ´âœ¯ âœ¸âœ¬âœ¸âœ¯âœ®âœ£ â˜…âœ¯ âœ°âœ¡âœ²âœ¯ âœ³âœ· âœ´âœ¬âœ·âœ¯, â˜…âœ¯ âœ°âœ¡âœ²âœ¯ âœ³âœ· âœ¬âœ³âœ¢ âœ¶âœ¡âœ²âœ¯âœ§. âœ£âœ´âœ¯ â˜…âœ¬âœ¢âœ¶âœ± â˜…âœ¯ âœ¶âœ¡âœ²âœ¯ âœ¡âœ® âœ¡âœ§ âœ±âœ¡âœ§âœ¡âœ®âœ£âœ¯âœ°âœ¢âœ¦âœ£âœ¡âœ®âœ° âœ¡âœ®âœ£âœ¬ âœ¦ âœ·âœ¶âœ¦âœ©âœ¯ âœ¬âœ¤ âœ¸âœ¦âœ¶âœ¡âœ©âœ¯ âœ¦âœ®âœ± âœ´âœ¦âœ£âœ¢âœ¯âœ±, â˜…âœ´âœ¯âœ¢âœ¯ â˜…âœ¯ âœ®âœ¯âœ¯âœ± âœ´âœ¬âœ·âœ¯ âœ¦âœ®âœ± âœ¤âœ¡âœ®âœ± âœ¡âœ£ âœ´âœ¦âœ¢âœ±âœ¯âœ¢. âœ¡âœ® âœ£âœ´âœ¡âœ§ â˜…âœ¬âœ¢âœ¶âœ± âœ¬âœ¤ âœ¤âœ¯âœ¦âœ¢, âœ´âœ¬âœ·âœ¯ âœ£âœ¬ âœ¤âœ¡âœ®âœ± â‚âœ¯âœ£âœ£âœ¯âœ¢, â‚âœ³âœ£ âœ¯âœ¦âœ§âœ¡âœ¯âœ¢ âœ§âœ¦âœ¡âœ± âœ£âœ´âœ¦âœ® âœ±âœ¬âœ®âœ¯, âœ£âœ´âœ¯ âœ¸âœ¬âœ¢âœ¯ âœ¸âœ¯âœ¦âœ®âœ¡âœ®âœ°âœ¤âœ³âœ¶ âœ¶âœ¡âœ¤âœ¯ âœ¬âœ¤ âœ¤âœ¦âœ¡âœ£âœ´ â˜…âœ¡âœ¶âœ¶ âœ¸âœ¦âœ¥âœ¯ âœ¶âœ¡âœ¤âœ¯ âœ¸âœ¯âœ¦âœ®âœ¡âœ®âœ°âœ¤âœ³âœ¶.</span></span><br><span class="line"><span class="string">âœ§âœ¬âœ¸âœ¯âœ£âœ¡âœ¸âœ¯âœ§ â˜…âœ¯ âœ£âœ´âœ¡âœ®âœ¥ âœ¬âœ¤ âœ±âœ¢âœ¯âœ¦âœ¸âœ§ âœ¦âœ§ âœ¤âœ¦âœ®âœ£âœ¦âœ§âœ¡âœ¯âœ§ - âœ¡âœ£&#x27;âœ§ âœ¯âœ¦âœ§âœµ âœ£âœ¬ âœ±âœ¬ â˜…âœ´âœ¯âœ® âœµâœ¬âœ³ âœ´âœ¦âœ²âœ¯ âœ¸âœ¬âœ®âœ¯âœµ, âœ¢âœ¯âœ®âœ£, âœ¦âœ®âœ± â˜…âœ¬âœ¢âœ¥. â‚âœ³âœ£ âœµâœ¬âœ³ âœ©âœ¦âœ®&#x27;âœ£ âœ·âœ¢âœ¯âœ·âœ¦âœ¢âœ¯ âœµâœ¬âœ³âœ¢âœ§âœ¯âœ¶âœ¤ âœ¦âœ®âœ± âœ«âœ³âœ¸âœ· âœ¬âœ¤âœ¤ âœ£âœ´âœ¯ âœ©âœ¶âœ¡âœ¤âœ¤: âœµâœ¬âœ³ âœ§âœ´âœ¬âœ³âœ¶âœ± âœ°âœ¢âœ¬â˜… âœµâœ¬âœ³âœ¢ â˜…âœ¡âœ®âœ°âœ§ âœ¤âœ¡âœ¢âœ§âœ£. âœ¦ âœ¶âœ¡âœ£âœ£âœ¶âœ¯ â‚âœ¡âœ£ âœ£âœ¬â˜…âœ¦âœ¢âœ± âœ£âœ´âœ¯ âœ±âœ¢âœ¯âœ¦âœ¸. âœ§âœ£âœ¯âœ· â‚âœµ âœ§âœ£âœ¯âœ·. âœ£âœ¦âœ¥âœ¯ âœ¦ âœ§âœ£âœ¯âœ· âœ¤âœ¬âœ¢â˜…âœ¦âœ¢âœ±. âœ¦âœ¤âœ£âœ¯âœ¢ âœ¦âœ¶âœ¶, âœ¡âœ£&#x27;âœ§ âœµâœ¬âœ³âœ¢ âœ¸âœ¡âœ§âœ§âœ¡âœ¬âœ®.</span></span><br><span class="line"><span class="string">âœ¥âœ¯âœ¯âœ· âœ¤âœ¦âœ¡âœ£âœ´ âœ¦âœ®âœ± âœ´âœ¬âœ·âœ¯ âœ¤âœ¬âœ¢ âœ£âœ´âœ¯ âœ¤âœ³âœ£âœ³âœ¢âœ¯. âœ¸âœ¦âœ¥âœ¯ âœµâœ¬âœ³âœ¢ âœ¸âœ¬âœ§âœ£ âœ§âœ¡âœ®âœ©âœ¯âœ¢âœ¯ âœ±âœ¢âœ¯âœ¦âœ¸âœ§, âœ¦âœ®âœ± â˜…âœ´âœ¯âœ® âœ£âœ´âœ¯ âœ¬âœ·âœ·âœ¬âœ¢âœ£âœ³âœ®âœ¡âœ£âœ¡âœ¯âœ§ âœ©âœ¬âœ¸âœ¯, âœ£âœ´âœ¯âœµ â˜…âœ¡âœ¶âœ¶ âœ¤âœ¡âœ°âœ´âœ£ âœ¤âœ¬âœ¢ âœ£âœ´âœ¯âœ¸. âœ¡âœ£ âœ¸âœ¦âœµ âœ£âœ¦âœ¥âœ¯ âœ¦ âœ§âœ¯âœ¦âœ§âœ¬âœ® âœ¬âœ¢ âœ¸âœ¬âœ¢âœ¯, â‚âœ³âœ£ âœ£âœ´âœ¯ âœ¯âœ®âœ±âœ¡âœ®âœ° â˜…âœ¡âœ¶âœ¶ âœ®âœ¬âœ£ âœ©âœ´âœ¦âœ®âœ°âœ¯. âœ¦âœ¸â‚âœ¡âœ£âœ¡âœ¬âœ®, â‚âœ¯âœ§âœ£, â‚âœ¯âœ©âœ¬âœ¸âœ¯ âœ¦ âœ¢âœ¯âœ¦âœ¶âœ¡âœ£âœµ. âœ¦âœ® âœ³âœ®âœ©âœ¯âœ¢âœ£âœ¦âœ¡âœ® âœ¤âœ³âœ£âœ³âœ¢âœ¯, âœ¬âœ®âœ¶âœµ âœ¬âœ®âœ¯ âœ§âœ£âœ¯âœ· âœ¦âœ£ âœ¦ âœ£âœ¡âœ¸âœ¯, âœ£âœ´âœ¯ âœ´âœ¬âœ·âœ¯ âœ©âœ¦âœ® âœ¢âœ¯âœ¦âœ¶âœ¡âœªâœ¯ âœ£âœ´âœ¯ âœ±âœ¢âœ¯âœ¦âœ¸ âœ¬âœ¤ âœ£âœ´âœ¯ âœ´âœ¡âœ°âœ´âœ¯âœ§âœ£. â˜…âœ¯ âœ¸âœ³âœ§âœ£ âœ£âœ¢âœ¯âœ¦âœ§âœ³âœ¢âœ¯ âœ£âœ´âœ¯ âœ±âœ¢âœ¯âœ¦âœ¸, âœ£âœ¬ âœ·âœ¢âœ¬âœ£âœ¯âœ©âœ£ âœ¡âœ£ âœ¦ âœ§âœ¯âœ¦âœ§âœ¬âœ®, âœ¶âœ¯âœ£ âœ¡âœ£ âœ¡âœ® âœ£âœ´âœ¯ âœ´âœ¯âœ¦âœ¢âœ£ â‹âœ³âœ¡âœ¯âœ£âœ¶âœµ âœ°âœ¯âœ¢âœ¸âœ¡âœ®âœ¦âœ¶.</span></span><br><span class="line"><span class="string">âœ¬âœ®âœ¶âœµ â˜…âœ´âœ¯âœ® âœµâœ¬âœ³ âœ³âœ®âœ±âœ¯âœ¢âœ§âœ£âœ¦âœ®âœ± âœ£âœ´âœ¯ âœ£âœ¢âœ³âœ¯ âœ¸âœ¯âœ¦âœ®âœ¡âœ®âœ° âœ¬âœ¤ âœ¶âœ¡âœ¤âœ¯ âœ©âœ¦âœ® âœµâœ¬âœ³ âœ¶âœ¡âœ²âœ¯ âœ£âœ¢âœ³âœ¶âœµ. â‚âœ¡âœ£âœ£âœ¯âœ¢âœ§â˜…âœ¯âœ¯âœ£ âœ¦âœ§ âœ¶âœ¡âœ¤âœ¯ âœ¡âœ§, âœ¡âœ£&#x27;âœ§ âœ§âœ£âœ¡âœ¶âœ¶ â˜…âœ¬âœ®âœ±âœ¯âœ¢âœ¤âœ³âœ¶, âœ¦âœ®âœ± âœ¡âœ£&#x27;âœ§ âœ¤âœ¦âœ§âœ©âœ¡âœ®âœ¦âœ£âœ¡âœ®âœ° âœ¯âœ²âœ¯âœ® âœ¡âœ® âœ£âœ¢âœ¦âœ°âœ¯âœ±âœµ. âœ¡âœ¤ âœµâœ¬âœ³&#x27;âœ¢âœ¯ âœ«âœ³âœ§âœ£ âœ¦âœ¶âœ¡âœ²âœ¯, âœ£âœ¢âœµ âœ´âœ¦âœ¢âœ±âœ¯âœ¢ âœ¦âœ®âœ± âœ£âœ¢âœµ âœ£âœ¬ âœ¶âœ¡âœ²âœ¯ â˜…âœ¬âœ®âœ±âœ¯âœ¢âœ¤âœ³âœ¶âœ¶âœµ.</span></span><br><span class="line"><span class="string">âœ¡ â‚âœ¯âœ¶âœ¡âœ¯âœ²âœ¯ âœ£âœ´âœ¯âœ¢âœ¯ âœ¡âœ§ âœ¦ âœ·âœ¯âœ¢âœ§âœ¬âœ® â˜…âœ´âœ¬ â‚âœ¢âœ¡âœ®âœ°âœ§ âœ§âœ³âœ®âœ§âœ´âœ¡âœ®âœ¯ âœ¡âœ®âœ£âœ¬ âœµâœ¬âœ³âœ¢ âœ¶âœ¡âœ¤âœ¯. âœ£âœ´âœ¦âœ£ âœ·âœ¯âœ¢âœ§âœ¬âœ® âœ¸âœ¦âœµ âœ´âœ¦âœ²âœ¯ âœ¯âœ®âœ¬âœ³âœ°âœ´ âœ£âœ¬ âœ§âœ·âœ¢âœ¯âœ¦âœ± âœ¦âœ¢âœ¬âœ³âœ®âœ±. â‚âœ³âœ£ âœ¡âœ¤ âœµâœ¬âœ³ âœ¢âœ¯âœ¦âœ¶âœ¶âœµ âœ´âœ¦âœ²âœ¯ âœ£âœ¬ â˜…âœ¦âœ¡âœ£ âœ¤âœ¬âœ¢ âœ§âœ¬âœ¸âœ¯âœ¬âœ®âœ¯ âœ£âœ¬ â‚âœ¢âœ¡âœ®âœ° âœµâœ¬âœ³ âœ£âœ´âœ¯ âœ§âœ³âœ® âœ¦âœ®âœ± âœ°âœ¡âœ²âœ¯ âœµâœ¬âœ³ âœ¦ âœ°âœ¬âœ¬âœ± âœ¤âœ¯âœ¯âœ¶âœ¡âœ®âœ°, âœ£âœ´âœ¯âœ® âœµâœ¬âœ³ âœ¸âœ¦âœµ âœ´âœ¦âœ²âœ¯ âœ£âœ¬ â˜…âœ¦âœ¡âœ£ âœ¦ âœ¶âœ¬âœ®âœ° âœ£âœ¡âœ¸âœ¯.</span></span><br><span class="line"><span class="string">âœ¡âœ® âœ¦ â˜…âœ¬âœ¢âœ±,âœ¡ âœ´âœ¬âœ·âœ¯ âœµâœ¬âœ³ â˜…âœ¡âœ¶âœ¶ âœ¶âœ¡âœ¥âœ¯ âœ©âœ¢âœµâœ·âœ£âœ¬âœ°âœ¢âœ¦âœ·âœ´âœµ.âœ£âœ´âœ¡âœ§ âœ¡âœ§ âœµâœ¬âœ³âœ¢ âœ¤âœ¶âœ¦âœ°:âœ®âœ§âœ§âœ©âœ£âœ¤&#123;âœ©âœ¢âœµâœ·âœ£âœ¬_âœ¡âœ§_âœ§âœ¬_âœ¡âœ®âœ£âœ¯âœ¢âœ¯âœ§âœ£âœ¡âœ®âœ°_â˜…âœ´âœµ_âœ±âœ¬âœ®&#x27;âœ£_âœµâœ¬âœ³_âœ«âœ¬âœ¡âœ®_âœ³âœ§&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">table = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz&#123;&#125; _-,.&#x27;:&quot;</span></span><br><span class="line">list1 = [<span class="string">&#x27;âœ§&#x27;</span>, <span class="string">&#x27;âœ¡&#x27;</span>, <span class="string">&#x27;âœ­&#x27;</span>, <span class="string">&#x27;âœ®&#x27;</span>, <span class="string">&#x27;âœ£&#x27;</span>, <span class="string">&#x27;âœ´&#x27;</span>, <span class="string">&#x27;âœ¯&#x27;</span>, <span class="string">&#x27;âœ¤&#x27;</span>, <span class="string">&#x27;âœ¶&#x27;</span>, <span class="string">&#x27;âœ¬&#x27;</span>, <span class="string">&#x27;âœ±&#x27;</span>, <span class="string">&#x27;âœ¦&#x27;</span>, <span class="string">&#x27;âœ¢&#x27;</span>, <span class="string">&#x27;âœ¥&#x27;</span>, <span class="string">&#x27;âœ·&#x27;</span>, <span class="string">&#x27;âœ°&#x27;</span>, <span class="string">&#x27;â‚&#x27;</span>, <span class="string">&#x27;âœ©&#x27;</span>, <span class="string">&#x27;âœ¸&#x27;</span>, <span class="string">&#x27;âœ²&#x27;</span>, <span class="string">&#x27;âœ³&#x27;</span>, <span class="string">&#x27;â˜…&#x27;</span>, <span class="string">&#x27;âœµ&#x27;</span>, <span class="string">&#x27;âœ«&#x27;</span>, <span class="string">&#x27;âœª&#x27;</span>, <span class="string">&#x27;â‹&#x27;</span>] </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(list1))</span><br><span class="line"></span><br><span class="line">cfinal = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">    <span class="keyword">if</span>(c[i] <span class="keyword">not</span> <span class="keyword">in</span> table):</span><br><span class="line">        <span class="keyword">if</span>(c[i] == <span class="string">&quot;\n&quot;</span>):</span><br><span class="line">            cfinal.append(c[i])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ind = list1.index(c[i])</span><br><span class="line">            cfinal.append(table[ind])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        cfinal.append(c[i])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(cfinal))</span><br><span class="line"></span><br><span class="line"><span class="comment">#quipqiup</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">six</span></span><br><span class="line"><span class="string">in the flood of darkness, hope is the light. it brings comfort, faith, and confidence. it gives us guidance when we are lost, and gives support when we are afraid. and the moment we give up hope, we give up our lives. the world we live in is disintegrating into a place of malice and hatred, where we need hope and find it harder. in this world of fear, hope to find better, but easier said than done, the more meaningful life of faith will make life meaningful.</span></span><br><span class="line"><span class="string">sometimes we think of dreams as fantasies - it&#x27;s easy to do when you have money, rent, and work. but you can&#x27;t prepare yourself </span></span><br><span class="line"><span class="string">and jump off the cliff: you should grow your wings first. a little bit toward the dream. step by step. take a step forward. after all, it&#x27;s your mission.</span></span><br><span class="line"><span class="string">keep faith and hope for the future. make your most sincere dreams, and when the opportunities come, they will fight for them. it may take a season or more, but the ending will not change. ambition, best, become a reality. an uncertain future, only one step at a time, the hope can realize the dream of the highest. we must treasure the dream, to protect it a season, let it in the heart quietly germinal.</span></span><br><span class="line"><span class="string">only when you understand the true meaning of life can you live truly. bittersweet as life is, it&#x27;s still wonderful, and it&#x27;s fascinating even in tragedy. if you&#x27;re just alive, try harder and try to live wonderfully.</span></span><br><span class="line"><span class="string">i believe there is a person who brings sunshine into your life. that person may have enough to spread around. but if you really </span></span><br><span class="line"><span class="string">have to wait for someone to bring you the sun and give you a good feeling, then you may have to wait a long time.</span></span><br><span class="line"><span class="string">in a word,i hope you will like cryptography.this is your flag:nssctf&#123;crypto_is_so_interesting_why_don&#x27;t_you_join_us&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flag:</p>
<font size="4" color="red">NSSCTF{crypto_is_so_interesting_why_don't_you_join_us}</font>

<p>(å‰ç¼€å±…ç„¶è¦å¤§å†™ï¼Œè¿™å°±æœ‰ç‚¹å‘äº†ã€‚ã€‚)</p>
<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="Math"><a href="#Math" class="headerlink" title="Math"></a>Math</h2><p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">length = <span class="built_in">len</span>(flag)</span><br><span class="line">flag1 = flag[:length//<span class="number">2</span>]</span><br><span class="line">flag2 = flag[length//<span class="number">2</span>:]</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">m1 = bytes_to_long(flag1)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line"></span><br><span class="line">p1 = gmpy2.invert(p,q)</span><br><span class="line">q1 = gmpy2.invert(q,p)</span><br><span class="line">c = <span class="built_in">pow</span>(m1,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p1=&quot;</span>,p1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;q1=&quot;</span>,q1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;phi=&quot;</span>,phi)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">p1= ...</span></span><br><span class="line"><span class="string">q1= ...</span></span><br><span class="line"><span class="string">c= ...</span></span><br><span class="line"><span class="string">phi= ...</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">m2 = bytes_to_long(flag2)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">c = <span class="built_in">pow</span>(m2, e, n)</span><br><span class="line">hint = <span class="built_in">pow</span>(<span class="number">2023</span> * p + <span class="number">114514</span>, q, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;hint=&quot;</span>,hint)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n= ...</span></span><br><span class="line"><span class="string">c= ...</span></span><br><span class="line"><span class="string">hint= ...</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®å°†flagåˆ†ä¸ºä¸¤éƒ¨åˆ†åˆ†åˆ«è¿›è¡ŒåŠ å¯†ï¼Œåˆ†å¼€æ¥è¯´ï¼š</p>
<ul>
<li>ç¬¬ä¸€éƒ¨åˆ†</li>
</ul>
<p>ç»™äº†på…³äºqçš„é€†å…ƒåŠqå…³äºpçš„é€†å…ƒï¼Œhitconctf 2019 qualså‡ºè¿‡è¿™ä¸ªé¢˜ç›®ï¼Œå…·ä½“æ¨å¯¼è¿‡ç¨‹å‚è€ƒ<a href="[AiDai|HITCON CTF 2019 Quals-Writeup (aidaip.github.io">è¿™ä¸€ç¯‡</a>](<a href="https://aidaip.github.io/ctf/2019/10/16/HITCON-CTF-2019-Quals-Writeup.html">https://aidaip.github.io/ctf/2019/10/16/HITCON-CTF-2019-Quals-Writeup.html</a>))</p>
<ul>
<li>ç¬¬äºŒéƒ¨åˆ†</li>
</ul>
<p>å·²çŸ¥ï¼š</p>
<script type="math/tex; mode=display">
hint \equiv (2023*p + 114514)^q  (mod n)</script><p>è¿™ç§é¢˜ç›®æ˜¾ç„¶æ˜¯æ„é€ å‡ºpæˆ–qçš„å€æ•°ï¼Œä»è€Œä¸næ±‚gcdå¾—åˆ°åˆ†è§£çš„ã€‚å¯¹äºè¿™ä¸ªç­‰å¼ï¼Œå¾ˆå®¹æ˜“å°±èƒ½æƒ³åˆ°åˆ©ç”¨åŒä½™æ€§è´¨å…ˆåŒ–ä¸ºä¸€ä¸‹ä¸¤ä¸ªç­‰å¼ï¼š</p>
<script type="math/tex; mode=display">
hint \equiv (2023*p + 114514)^q  (mod p)</script><script type="math/tex; mode=display">
hint \equiv (2023*p + 114514)^q  (mod q)</script><p>ä¹ä¸€çœ‹åº”è¯¥æ˜¯ç¬¬äºŒä¸ªç­‰å¼æ›´åŠ å¥½ç”¨ï¼Œå› ä¸ºå¯ä»¥åˆ©ç”¨è´¹é©¬å°å®šç†æ¶ˆå»æŒ‡æ•°ï¼Œå˜å½¢ä¸º:</p>
<script type="math/tex; mode=display">
hint \equiv 2023*p + 114514  (mod q)</script><p>ä½†æ˜¯è¿™é‡Œå°±å¡å£³äº†ï¼Œå› ä¸ºå³ä½¿åˆ©ç”¨åŒä½™æ€§è´¨æŠŠæ¨¡ç­‰å¼è½¬åŒ–ä¸ºç­‰å¼ï¼Œå¾—åˆ°çš„ä¾ç„¶å«æœ‰pï¼Œqä¸¤ä¸ªå› å­ï¼Œæ²¡æœ‰åŠæ³•ä¸næ±‚gcdã€‚</p>
<p>æ‰€ä»¥è€ƒè™‘åˆ©ç”¨å¦ä¸€ä¸ªç­‰å¼ï¼Œç”±äºæŒ‡æ•°qæ²¡æœ‰åŠæ³•æ¶ˆæ‰äº†ï¼Œæ‰€ä»¥åªèƒ½åˆ©ç”¨äºŒé¡¹å¼å®šç†å±•å¼€ã€‚åˆç”±äºmod pçš„å…³ç³»ï¼Œæ¨¡ç­‰å¼æ­£å¥½åªå‰©ä¸‹äº†æœ€åä¸€é¡¹ï¼Œå³ï¼š</p>
<script type="math/tex; mode=display">
hint \equiv 114514^q  (mod p)</script><p>æ€ä¹ˆåˆ©ç”¨è¿™ä¸ªç­‰å¼å‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™éœ€è¦æ•é”ä¸€ç‚¹å¯Ÿè§‰åˆ°è´¹é©¬å°å®šç†(ä¹Ÿè®¸åˆšåˆšæ‹†åˆ†å‡ºæ¥çš„å¦ä¸€ä¸ªå¼å­çš„å˜å½¢å°±æ˜¯ç»™æˆ‘ä»¬çš„æç¤º)ï¼Œç”±è´¹é©¬å°å®šç†æˆ‘ä»¬çŸ¥é“ï¼š</p>
<script type="math/tex; mode=display">
a \equiv a^p  (mod p)</script><p>æŠŠ $114514^q$ çœ‹ä½œaï¼Œå°±å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
(114514^q) \equiv (114514^q)^p \equiv 114514^n (mod p)</script><p>æ‰€ä»¥æœ‰ï¼š</p>
<script type="math/tex; mode=display">
hint \equiv 114514^n  (mod p)</script><script type="math/tex; mode=display">
hint = 114514^n + k*p</script><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå°†$(hint - 114514^n)$ä¸næ±‚gcdï¼Œå³å¯å¾—åˆ°pï¼Œè¿›è€Œæ±‚è§£RSA</p>
<p><br></p>
<p>exp.py:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">a, b</span>):</span><br><span class="line">  <span class="keyword">while</span>(b): </span><br><span class="line">    a,b = b, a % b </span><br><span class="line">  <span class="keyword">return</span> a </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mysqrt</span>(<span class="params">d</span>):</span><br><span class="line">  st = <span class="number">1</span></span><br><span class="line">  en = <span class="number">10</span>**<span class="number">1300</span></span><br><span class="line">  <span class="keyword">while</span> st&lt;=en:</span><br><span class="line">    mid = (st+en)//<span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> mid*mid == d: <span class="keyword">return</span> mid</span><br><span class="line">    <span class="keyword">if</span> mid*mid &lt; d: st=mid+<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>: en=mid-<span class="number">1</span></span><br><span class="line">  <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a1, a2</span>):</span><br><span class="line">    x1, x2 = <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    y1, y2 = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> a2:</span><br><span class="line">        q = a1 // a2</span><br><span class="line">        a1, a2 = a2, a1 - q * a2</span><br><span class="line">        x1, x2 = x2, x1 - q * x2</span><br><span class="line">        y1, y2 = y2, y1 - q * y2</span><br><span class="line">    <span class="keyword">return</span> (x1, y1, a1)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line">ipmq= ...</span><br><span class="line">iqmp= ...</span><br><span class="line">phi= ...</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">enc = ...</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">gg = gcd(iqmp-<span class="number">1</span>,ipmq-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">c = phi // gg</span><br><span class="line">a = (ipmq-<span class="number">1</span>)//gg</span><br><span class="line">b = (iqmp-<span class="number">1</span>)//gg</span><br><span class="line"><span class="comment"># p*a + q*b = c</span></span><br><span class="line">pmod = inverse(a, b)*c%b</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>):</span><br><span class="line">    p = pmod + j*b</span><br><span class="line">    <span class="keyword">if</span> p &gt; (<span class="number">1</span>&lt;&lt;<span class="number">1024</span>): <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> isPrime(p): <span class="keyword">continue</span></span><br><span class="line">    q = (c-p*a)//b</span><br><span class="line">    <span class="keyword">assert</span>(p*a+q*b==c)</span><br><span class="line">    <span class="keyword">if</span> (iqmp*q-<span class="number">1</span>)%p == <span class="number">0</span> <span class="keyword">and</span> (ipmq*p-<span class="number">1</span>)%q == <span class="number">0</span>:</span><br><span class="line">        M = <span class="built_in">pow</span>(enc,d,p*q)</span><br><span class="line">        flag += <span class="built_in">str</span>(long_to_bytes(M))[<span class="number">2</span>:-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2</span></span><br><span class="line">n= ...</span><br><span class="line">c= ...</span><br><span class="line">hint= ...</span><br><span class="line">h2 = <span class="built_in">pow</span>(<span class="number">114514</span>,n,n)</span><br><span class="line">p = GCD(n,hint-h2)</span><br><span class="line">q = n//p</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">flag += <span class="built_in">str</span>(long_to_bytes(m))[<span class="number">2</span>:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flag:</p>
<font size="4" color="red">NSSCTF{e713afa4-fcd8-419f-a1a6-959449b4df5a}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="LatticeLCG"><a href="#LatticeLCG" class="headerlink" title="LatticeLCG"></a>LatticeLCG</h2><p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;NSSCTF&#123;******************************&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">a = getPrime(<span class="number">512</span>)</span><br><span class="line">seed = getPrime(<span class="number">512</span>)</span><br><span class="line">b = bytes_to_long(flag)</span><br><span class="line">n = getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">e1 = <span class="number">2333</span></span><br><span class="line">e2 = <span class="number">23333</span></span><br><span class="line">c1 = <span class="built_in">pow</span>(a,e1,n)</span><br><span class="line">c2 = <span class="built_in">pow</span>(a,e2,n)</span><br><span class="line"></span><br><span class="line">output = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    seed = (a*seed+b)%n</span><br><span class="line">    output.append(seed)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c1 = &quot;</span>,c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c2 = &quot;</span>,c2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;output1 = &quot;</span>,output[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;output2 = &quot;</span>,output[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = [getPrime(<span class="number">128</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)]</span><br><span class="line">out = []</span><br><span class="line">m = getPrime(<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> e:</span><br><span class="line">    out.append(<span class="built_in">pow</span>(m,i,n))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e=&quot;</span>,e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;out=&quot;</span>,out)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">c1 = ...</span></span><br><span class="line"><span class="string">c2 = ...</span></span><br><span class="line"><span class="string">output1 = ...</span></span><br><span class="line"><span class="string">output2 = ...</span></span><br><span class="line"><span class="string">e= []</span></span><br><span class="line"><span class="string">out= []</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>å¡äº†å¾ˆä¹…ï¼Œæœäº†å¾ˆå¤šæ ¼ç›¸å…³é—®é¢˜ä¹Ÿæ²¡æœ‰æœåˆ°ç±»ä¼¼çš„ï¼Œæ‰“ç®—æ”¾å¼ƒè¿™ä¸ªé¢˜å»ç¡è§‰çš„æ—¶å€™ï¼Œçªç„¶æç„¶å¤§æ‚Ÿã€‚è¿™é‡Œå¥½å¥½é˜è¿°ä¸€ä¸‹æˆ‘çš„æ€è·¯ï¼Œå¸Œæœ›èƒ½å¸®åŠ©åˆ°ä¸€äº›å’Œæˆ‘ä¸€æ ·åˆšåˆšæ¥è§¦æ ¼çš„ctferã€‚</p>
<p>é¦–å…ˆï¼Œé¢˜ç›®å¾ˆæ˜æ˜¾çš„åˆ†æˆäº†ä¸‰ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li>å…±æ¨¡æ”»å‡»</li>
<li>LCGæ±‚å‚æ•°</li>
<li>Lattice</li>
</ul>
<p>é¦–å…ˆè¦æ˜ç¡®æ±‚è§£é¡ºåºã€‚flagä»¥LCGä¸­å‚æ•°bçš„å½¢å¼å­˜åœ¨ï¼Œå› æ­¤LCGåº”è¯¥æ˜¯é¢˜ç›®çš„æœ€åä¸€æ­¥ã€‚å¹¶ä¸”è¦æƒ³æ±‚è§£å‡ºè¿™ä¸ªLCGçš„bï¼Œæ˜¯éœ€è¦çŸ¥é“aä¸nçš„å€¼çš„ï¼Œåœ¨ç¬¬ä¸€éƒ¨å…±æ¨¡æ”»å‡»ä¸­æ˜¾ç„¶æ˜¯å·²çŸ¥næ±‚è§£aã€‚æ‰€ä»¥å°±æ˜ç¡®äº†å¦‚ä¸‹çš„è§£é¢˜é¡ºåºï¼š</p>
<ol>
<li>Latticeæ±‚è§£æ¨¡æ•°n</li>
<li>å…±æ¨¡æ”»å‡»æ±‚è§£a</li>
<li>LCGæ¢å¤å‚æ•°bï¼Œå¾—åˆ°flag</li>
</ol>
<p>åé¢ä¸¤ä¸ªæ­¥éª¤éå¸¸å®¹æ˜“ï¼Œä¸»è¦é—®é¢˜å°±åœ¨ç¬¬ä¸€æ­¥ï¼š<strong>ä¸ºä»€ä¹ˆè¦åˆ©ç”¨æ ¼æ±‚è§£nï¼Ÿ</strong> <strong>æ€ä¹ˆç”¨æ ¼æ±‚è§£nï¼Ÿ</strong>ä¸‹é¢æ˜¯æˆ‘å¯¹è¿™ä¸ªé—®é¢˜çš„åˆ†æï¼š</p>
<p>å…ˆæ¥çœ‹çœ‹ç»™äº†äº›ä»€ä¹ˆæ¡ä»¶ï¼šä¸€ä¸ª64bitçš„å°é‡mï¼Œä¾æ¬¡äº§ç”Ÿ20ä¸ª128bitçš„ç´ æ•°å¯¹å…¶è¿›è¡Œç±»ä¼¼RSAçš„åŠ å¯†ï¼Œå¹¶ä¸”ç»™äº†æˆ‘ä»¬åŠ å¯†æŒ‡æ•°çš„åˆ—è¡¨ä»¥åŠå¯†æ–‡çš„åˆ—è¡¨ã€‚é¢˜ç›®æ»¡è¶³ä¸¤ä¸ªç»å…¸æ¡ä»¶ï¼š<strong>å­˜åœ¨å°é‡</strong> ï¼Œ<strong>æä¾›å¤šä¸ªæ–¹ç¨‹ç»„å‚æ•°</strong>ï¼Œè¿™æ ·çš„é—®é¢˜åœ¨å¾ˆå¤šcryptoé¢˜ç›®ä¸­éƒ½æ˜¯ç”¨æ ¼æ–¹æ³•æ±‚è§£çš„ï¼Œæ‰€ä»¥è¦æƒ³åˆ°åˆ©ç”¨æ ¼æ–¹æ³•(é¢˜ç›®çš„åå­—è™½ç„¶è¯´å¾—å¾ˆæ˜ç™½ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰ï¼Œçœ‹åˆ°è¿™ç§å½¢å¼ä¹Ÿåº”è¯¥è”æƒ³åˆ°è¿™ä¸ªæ–¹æ³•)</p>
<p>æ³¨æ„åˆ°mä¸å˜ï¼Œæ¨¡æ•°nä¹Ÿä¸å˜ï¼ŒåŒæ—¶åŠ å¯†æŒ‡æ•°äº’ç´ ï¼Œè¿™å…¶å®å¾ˆåƒå…±æ¨¡æ”»å‡»çš„æƒ…æ™¯ï¼Œåªæ˜¯næœªçŸ¥ã€‚å›æƒ³ä¸€ä¸‹åœ¨å·²çŸ¥æ¨¡æ•°nçš„æƒ…å†µä¸‹å…±æ¨¡æ”»å‡»çš„å®æ–½æ–¹æ³•ï¼Œä¸éš¾äº§ç”Ÿä¸‹é¢è¿™ä¸ªè§£é¢˜æ€è·¯ï¼š</p>
<p>å–20ä¸ªæ–¹ç¨‹çš„å‰ä¸‰ä¸ªå¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
out1 \equiv m^{e1} \; (mod\;  n)</script><script type="math/tex; mode=display">
out2 \equiv m^{e2} \; (mod\;  n)</script><script type="math/tex; mode=display">
out3 \equiv m^{e3} \; (mod\;  n)</script><p>å› ä¸ºe1ï¼Œe2äº’ç´ ï¼Œæ‰€ä»¥å­˜åœ¨aï¼Œbï¼Œä½¿å¾—ï¼š</p>
<script type="math/tex; mode=display">
a*e1+b*e2 = 1</script><p>æ‰€ä»¥å¯ä»¥å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
out1^{a}*out2^{b}\equiv m^{a*e1+b*e2} \equiv m \quad (mod \;n)</script><p>è¿™æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿæˆ‘ä»¬åŒæ ·ä¹Ÿå¯¹2ã€3ä¸¤å¼ï¼Œ1ã€3ä¸¤å¼è¿›è¡Œè¿™æ ·çš„æ“ä½œï¼Œç»“åˆä¸Šé¢è¿™ä¸ªå¼å­èƒ½å¾—åˆ°ä¸‰ç»„æ¨¡ç­‰å¼ï¼š</p>
<script type="math/tex; mode=display">
out1^{a}*out2^{b} \equiv m \quad (mod \;n)\qquad--1</script><script type="math/tex; mode=display">
out2^{c}*out3^{d} \equiv m \quad (mod \;n)\qquad--2</script><script type="math/tex; mode=display">
out1^{f}*out3^{g} \equiv m \quad (mod \;n)\qquad--3</script><p>1ã€2å¼ä½œå·®ï¼Œ2ã€3å¼ä½œå·®ï¼Œå°±å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
out1^{a}*out2^{b} -out2^{c}*out3^{d}\equiv 0 \quad (mod \;n)</script><script type="math/tex; mode=display">
out1^{f}*out3^{g} -out2^{c}*out3^{d}\equiv 0 \quad (mod \;n)</script><p>è€Œç°åœ¨ç­‰å¼å·¦ä¾§å·²ç»æ²¡æœ‰æœªçŸ¥é‡äº†(a,b,c,d,f,gå‡èƒ½å¤Ÿé€šè¿‡æ‰©å±•æ¬§å‡ é‡Œå¾—æ±‚å‡º)ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ±‚è§£ä»–ä»¬çš„gcdå¾—åˆ°nã€‚</p>
<p>å¯ä»¥è¯´ï¼Œæƒ³åˆ°è¿™ä¸ªæ€è·¯çš„æ—¶å€™æˆ‘ä¸ºä¹‹ä¸€æŒ¯ï¼Œå¯æƒœå®é™…æ“ä½œçš„æ—¶å€™è¿™ä¸ªæ–¹æ³•å¹¶ä¸èƒ½å®æ–½ï¼ŒåŸå› ä¹Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬è¿›è¡Œçš„å¹¶éæ¨¡å¹‚è¿ç®—ï¼Œè€Œæ˜¯æ™®é€šå¹‚è¿ç®—ï¼Œ<strong>å¹¶ä¸”aï¼Œbè¿™äº›æŒ‡æ•°æ•°é‡çº§å¾ˆå¤§(æ³¨æ„è¿™ä¸€ç‚¹)</strong>ï¼Œæ‰€ä»¥æ˜¯å®Œå…¨æ²¡æœ‰åŠæ³•ç…§è¿™ä¸ªæ€è·¯è§£ä¸‹å»çš„ã€‚è¿™æ—¶å€™æˆ‘ä¹Ÿæ²¡æœ‰æƒ³åˆ°æ€ä¹ˆåˆ©ç”¨æ ¼ï¼Œæ‰€ä»¥è¿›åº¦ä¹Ÿåœæ»äº†ï¼Œä¸€å¡å¡åˆ°äº†æ™šä¸Šã€‚</p>
<p>æ™šä¸Šæˆ‘åå¤æ€è€ƒçš„æ—¶å€™ï¼Œåˆæƒ³åˆ°äº†æˆ‘åˆšåˆšè¯´çš„é‚£ä¸€ç‚¹ï¼Œä¹Ÿå°±æ˜¯å®æ–½ä¸äº†å…±æ¨¡æ”»å‡»çš„åŸå› ï¼Œåœ¨äº<strong>æŒ‡æ•°çš„æ•°é‡çº§å¾ˆå¤§ï¼Œæ²¡æœ‰åŠæ³•å¹‚è¿ç®—</strong>ã€‚æˆ‘ä¹Ÿçªç„¶è”æƒ³åˆ°äº†Latticeä¸­LLLç®—æ³•çš„é‡è¦åº”ç”¨â€”â€”æ±‚è§£æœ€çŸ­å‘é‡ã€‚é‚£ä¹ˆä¸€åˆ‡ä¹Ÿå°±è¯´å¾—é€šäº†ï¼Œä¹‹æ‰€ä»¥ç»™20ä¸ªç´ æ•°ä½œä¸ºåŠ å¯†æŒ‡æ•°ï¼Œå°±æ˜¯å¯ä»¥åº”ç”¨äºæ ¼å¯†ç ä¸­ï¼Œå…‹æœåˆšæ‰å…±æ¨¡æ”»å‡»ä¸­ä¸¤ä¸¤ç»„åˆæ—¶è®¡ç®—å‡ºçš„aï¼Œbè¿‡å¤§çš„é—®é¢˜ã€‚æ‰€ä»¥æ„é€ æ ¼çš„æ€è·¯å°±æ¥äº†ï¼š</p>
<p>å› ä¸º20ä¸ªæŒ‡æ•°eå‡äº’ç´ ï¼Œæ‰€ä»¥ä¸€å®šå­˜åœ¨a1ï¼Œa2ï¼Œa3â€¦a20ï¼Œä½¿å¾—</p>
<script type="math/tex; mode=display">
a1*e1+a2*e2+a3*e3+...a20*e20 = 1</script><p>æ‰€ä»¥å¯ä»¥åˆ—å‡ºç­‰å¼ï¼š</p>
<script type="math/tex; mode=display">
\left[\begin{matrix}
a1 & a2 & a3 ... & a20
\end{matrix}\right] 

*
\left[\begin{matrix}
e1 & 1 & 0 & 0 ... & 0\\
e2 & 0 & 1 & 0 ... & 0\\
e3 & 0 & 0 & 1 ... & 0\\
...\\
e20 & 0 & 0 & 0 ... & 1\\
\end{matrix}\right]

=

\left[\begin{matrix}
1 & a1 & a2 ... & a20
\end{matrix}\right]</script><p>å¾ˆæ˜æ˜¾ï¼Œè¿™ä¸ªæ ¼ç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚ï¼Œæˆ‘ä»¬åªéœ€è¦ä»è§„çº¦å‡ºæ¥çš„çŸ­å‘é‡ä¸­æŒ‘å‡ºä¸¤ç»„ï¼ŒæŒ‰ç†æ¥è¯´ï¼Œæˆ‘ä»¬åªéœ€è¦ç±»ä¼¼çš„è¿›è¡Œåˆšæ‰çš„å…±æ¨¡æ”»å‡»å³å¯ã€‚</p>
<p>å¯æ˜¯å®é™…æ“ä½œåˆé‡åˆ°äº†é—®é¢˜ï¼Œè¿™æ ·è§„çº¦å‡ºæ¥çš„å‘é‡ç»„æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">[ <span class="number">45</span> -<span class="number">58</span>   <span class="number">5</span> -<span class="number">16</span>  <span class="number">12</span>  -<span class="number">7</span> -<span class="number">27</span>  <span class="number">19</span>   <span class="number">6</span>  <span class="number">14</span>  <span class="number">29</span> -<span class="number">23</span> -<span class="number">36</span>  <span class="number">44</span> -<span class="number">15</span>   <span class="number">1</span>   <span class="number">8</span>  <span class="number">14</span>  -<span class="number">7</span>  <span class="number">11</span>  -<span class="number">9</span>]</span><br><span class="line">[-<span class="number">14</span> -<span class="number">27</span>  <span class="number">20</span>   <span class="number">6</span> -<span class="number">40</span>  <span class="number">20</span> -<span class="number">34</span>  -<span class="number">2</span> -<span class="number">16</span>  <span class="number">51</span>  <span class="number">35</span> -<span class="number">23</span> -<span class="number">51</span>  <span class="number">13</span>   <span class="number">3</span> -<span class="number">21</span>   <span class="number">0</span>  <span class="number">17</span>  <span class="number">11</span>  -<span class="number">7</span>   <span class="number">1</span>]</span><br><span class="line">[ <span class="number">15</span> -<span class="number">36</span> -<span class="number">21</span> -<span class="number">13</span>   <span class="number">6</span>  -<span class="number">7</span>  -<span class="number">1</span> -<span class="number">59</span> -<span class="number">23</span>  <span class="number">42</span> -<span class="number">33</span>  <span class="number">15</span> -<span class="number">30</span>  -<span class="number">4</span>  <span class="number">39</span>  <span class="number">26</span>  <span class="number">41</span>   <span class="number">1</span>  <span class="number">19</span>  <span class="number">10</span>   <span class="number">9</span>]</span><br><span class="line">[-<span class="number">23</span>   <span class="number">4</span>  <span class="number">49</span> -<span class="number">19</span>  <span class="number">22</span>  -<span class="number">9</span>  <span class="number">24</span> -<span class="number">20</span> -<span class="number">20</span>   <span class="number">3</span> -<span class="number">24</span>   <span class="number">4</span> -<span class="number">43</span> -<span class="number">86</span>  <span class="number">40</span>  <span class="number">44</span>  -<span class="number">1</span>  -<span class="number">1</span>  <span class="number">26</span>  <span class="number">25</span>   <span class="number">1</span>]</span><br><span class="line">[ <span class="number">72</span>  <span class="number">15</span> -<span class="number">11</span> -<span class="number">19</span>  <span class="number">26</span> -<span class="number">31</span> -<span class="number">56</span> -<span class="number">25</span>   <span class="number">5</span>  <span class="number">33</span> -<span class="number">27</span> -<span class="number">23</span>  <span class="number">12</span>  <span class="number">22</span>  <span class="number">11</span>  -<span class="number">1</span>  <span class="number">21</span> -<span class="number">17</span>  <span class="number">51</span> -<span class="number">31</span>   <span class="number">9</span>]</span><br><span class="line">[-<span class="number">35</span> -<span class="number">73</span>  -<span class="number">8</span>  <span class="number">19</span> -<span class="number">29</span>  <span class="number">23</span>  -<span class="number">3</span>  <span class="number">20</span> -<span class="number">10</span>  <span class="number">18</span>  <span class="number">46</span>  <span class="number">29</span>  -<span class="number">9</span>  <span class="number">69</span> -<span class="number">30</span>   <span class="number">9</span> -<span class="number">64</span>  <span class="number">13</span>  <span class="number">10</span> -<span class="number">26</span>   <span class="number">3</span>]</span><br><span class="line">[ <span class="number">20</span>  <span class="number">46</span>  <span class="number">12</span>  -<span class="number">3</span>  <span class="number">28</span>  -<span class="number">1</span> -<span class="number">68</span>  <span class="number">15</span>   <span class="number">3</span> -<span class="number">21</span> -<span class="number">48</span> -<span class="number">20</span>  <span class="number">43</span>  <span class="number">54</span>   <span class="number">9</span>  <span class="number">14</span>  -<span class="number">5</span>   <span class="number">0</span> -<span class="number">44</span> -<span class="number">24</span>   <span class="number">8</span>]</span><br><span class="line">[ <span class="number">49</span>   <span class="number">0</span> -<span class="number">10</span>   <span class="number">0</span> -<span class="number">46</span> -<span class="number">47</span>  <span class="number">24</span>  -<span class="number">2</span>  <span class="number">13</span>  <span class="number">10</span>  -<span class="number">3</span>  <span class="number">48</span>  <span class="number">43</span> -<span class="number">28</span>  -<span class="number">3</span>  <span class="number">53</span> -<span class="number">15</span>  -<span class="number">6</span>  <span class="number">31</span> -<span class="number">23</span>  <span class="number">12</span>]</span><br><span class="line">[ -<span class="number">6</span>   <span class="number">0</span>   <span class="number">9</span>  <span class="number">42</span> -<span class="number">49</span> -<span class="number">38</span>   <span class="number">8</span>  <span class="number">12</span>   <span class="number">7</span>  <span class="number">39</span>  <span class="number">30</span> -<span class="number">26</span>  <span class="number">18</span>  <span class="number">37</span>  <span class="number">28</span> -<span class="number">28</span>   <span class="number">8</span>   <span class="number">2</span> -<span class="number">67</span> -<span class="number">21</span> -<span class="number">15</span>]</span><br><span class="line">[-<span class="number">56</span>  <span class="number">23</span>  <span class="number">22</span>  <span class="number">29</span>  -<span class="number">7</span> -<span class="number">19</span>  <span class="number">19</span>  -<span class="number">8</span>   <span class="number">6</span>  <span class="number">35</span>   <span class="number">4</span>  -<span class="number">8</span>  <span class="number">22</span>  -<span class="number">2</span> -<span class="number">44</span> -<span class="number">69</span>  <span class="number">16</span>  -<span class="number">8</span>  -<span class="number">7</span> -<span class="number">45</span>  <span class="number">21</span>]</span><br><span class="line">[-<span class="number">21</span>  <span class="number">16</span>  <span class="number">34</span> -<span class="number">39</span>  <span class="number">36</span>   <span class="number">1</span>  <span class="number">57</span> -<span class="number">30</span>  -<span class="number">2</span>  -<span class="number">2</span> -<span class="number">36</span>  -<span class="number">9</span>   <span class="number">9</span> -<span class="number">27</span>   <span class="number">8</span> -<span class="number">31</span> -<span class="number">31</span>  <span class="number">32</span>  <span class="number">12</span>  -<span class="number">2</span>  <span class="number">15</span>]</span><br><span class="line">[ -<span class="number">9</span>  -<span class="number">7</span>   <span class="number">6</span>  <span class="number">40</span>  <span class="number">32</span> -<span class="number">49</span> -<span class="number">26</span> -<span class="number">60</span>  <span class="number">17</span>   <span class="number">0</span> -<span class="number">13</span>   <span class="number">7</span>  <span class="number">25</span>  <span class="number">57</span> -<span class="number">19</span>  <span class="number">28</span>  -<span class="number">3</span> -<span class="number">34</span>  <span class="number">11</span> -<span class="number">12</span> -<span class="number">17</span>]</span><br><span class="line">[-<span class="number">30</span> -<span class="number">13</span>  <span class="number">28</span> -<span class="number">42</span>   <span class="number">8</span> -<span class="number">46</span>  <span class="number">56</span>  <span class="number">33</span> -<span class="number">56</span> -<span class="number">40</span> -<span class="number">24</span>   <span class="number">4</span>  <span class="number">10</span>  <span class="number">15</span>  <span class="number">46</span>  <span class="number">50</span> -<span class="number">13</span>  <span class="number">18</span> -<span class="number">21</span>  <span class="number">17</span>  <span class="number">16</span>]</span><br><span class="line">[-<span class="number">17</span> -<span class="number">11</span>  -<span class="number">5</span>  <span class="number">29</span>  <span class="number">14</span>   <span class="number">6</span> -<span class="number">13</span>   <span class="number">4</span>  <span class="number">42</span> -<span class="number">69</span>  <span class="number">30</span>   <span class="number">9</span>   <span class="number">3</span> -<span class="number">37</span>   <span class="number">5</span>   <span class="number">7</span> -<span class="number">17</span>  <span class="number">50</span>   <span class="number">6</span>  <span class="number">14</span> -<span class="number">38</span>]</span><br><span class="line">[ <span class="number">53</span> -<span class="number">12</span>  <span class="number">16</span>  <span class="number">36</span>   <span class="number">1</span>  <span class="number">38</span> -<span class="number">52</span>  <span class="number">25</span> -<span class="number">10</span> -<span class="number">41</span>  -<span class="number">3</span> -<span class="number">37</span>   <span class="number">6</span> -<span class="number">12</span>   <span class="number">1</span>  -<span class="number">4</span> -<span class="number">25</span>  <span class="number">41</span>   <span class="number">5</span>   <span class="number">1</span>  <span class="number">29</span>]</span><br><span class="line">[ -<span class="number">3</span>   <span class="number">1</span>  <span class="number">36</span>  <span class="number">22</span>   <span class="number">7</span>  -<span class="number">5</span> -<span class="number">10</span>  <span class="number">15</span> -<span class="number">10</span> -<span class="number">27</span>  <span class="number">35</span> -<span class="number">60</span> -<span class="number">36</span>   <span class="number">9</span> -<span class="number">57</span>  <span class="number">33</span> -<span class="number">21</span>  <span class="number">43</span>  <span class="number">28</span> -<span class="number">44</span>   <span class="number">8</span>]</span><br><span class="line">[ <span class="number">32</span> -<span class="number">26</span>  <span class="number">18</span>  -<span class="number">9</span>  -<span class="number">5</span>  <span class="number">37</span>  -<span class="number">8</span>   <span class="number">2</span> -<span class="number">36</span> -<span class="number">28</span>  <span class="number">43</span>  <span class="number">10</span> -<span class="number">32</span>  <span class="number">37</span> -<span class="number">24</span> -<span class="number">70</span>  <span class="number">22</span> -<span class="number">35</span>  <span class="number">49</span>  -<span class="number">2</span>  <span class="number">31</span>]</span><br><span class="line">[-<span class="number">33</span>  <span class="number">15</span> -<span class="number">25</span>   <span class="number">1</span> -<span class="number">40</span>   <span class="number">3</span>  -<span class="number">2</span> -<span class="number">32</span>  <span class="number">15</span>   <span class="number">9</span> -<span class="number">20</span> -<span class="number">27</span> -<span class="number">27</span>  <span class="number">35</span>  <span class="number">26</span>  -<span class="number">1</span> -<span class="number">45</span> -<span class="number">12</span>  <span class="number">45</span>  <span class="number">23</span>  <span class="number">36</span>]</span><br><span class="line">[-<span class="number">17</span>   <span class="number">0</span>  <span class="number">18</span> -<span class="number">20</span> -<span class="number">75</span>  -<span class="number">5</span>  <span class="number">55</span>  <span class="number">42</span>  <span class="number">16</span>   <span class="number">8</span> -<span class="number">45</span>   <span class="number">5</span> -<span class="number">24</span> -<span class="number">20</span> -<span class="number">50</span> -<span class="number">11</span>   <span class="number">0</span>  <span class="number">27</span>  <span class="number">40</span>  <span class="number">18</span>   <span class="number">8</span>]</span><br><span class="line">[ <span class="number">11</span>   <span class="number">5</span>  <span class="number">16</span>  <span class="number">37</span>  -<span class="number">2</span>  -<span class="number">6</span>  <span class="number">28</span>  <span class="number">19</span> -<span class="number">21</span>   <span class="number">5</span>  -<span class="number">8</span>  <span class="number">63</span>  -<span class="number">8</span> -<span class="number">21</span>  <span class="number">22</span> -<span class="number">23</span> -<span class="number">57</span>  <span class="number">13</span>  -<span class="number">5</span>  <span class="number">15</span> -<span class="number">39</span>]</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€åˆ—å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„1ï¼Œè¯´æ˜ç¬¬ä¸€åˆ—æ˜¯1çš„å‘é‡å¯¹æ¯”èµ·æ¥é•¿åº¦å¹¶ä¸å°ã€‚å†æƒ³ä¸€ä¸‹è§„çº¦çš„ç›®çš„ï¼Œå…¶å®å¾ˆå®¹æ˜“å°±èƒ½ç›¸åŒç¬¬ä¸€åˆ—æ˜¯å¤šå°‘å¹¶ä¸é‡è¦ï¼Œé‡è¦çš„æ˜¯<strong>çŸ­å‘é‡çš„ç¬¬ä¸€åˆ—ç›¸åŒ</strong>(è¿™ä¸€ç‚¹éå¸¸å®¹æ˜“æƒ³é€šï¼Œæ²¡ç†è§£çš„è¯ä»”ç»†æƒ³æƒ³)ã€‚è€Œè¦è®©ä»–ä»¬ç›¸åŒï¼Œæœ€æœ‰æ•ˆçš„åŠæ³•å°±æ˜¯è®©ä»–ä»¬å‡ä¸º0ï¼Œæƒ³åˆ°è¿™ä¸€ç‚¹åï¼Œå°±å¯ä»¥åœ¨æ ¼çš„ç¬¬ä¸€åˆ—ä¹˜ä¸Šä¸€ä¸ªå¤§æ•°Kï¼Œä»è€Œæœ‰æ•ˆçš„è°ƒæ•´ä¸€ä¸‹æ ¼ï¼Œå¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
\left[\begin{matrix}
K*e1 & 1 & 0 & 0 ... & 0\\
K*e2 & 0 & 1 & 0 ... & 0\\
K*e3 & 0 & 0 & 1 ... & 0\\
...\\
K*e20 & 0 & 0 & 0 ... & 1\\
\end{matrix}\right]</script><p>è¿™æ ·ä¸€æ¥ï¼Œæœ€çŸ­å‘é‡çš„ç¬¬ä¸€åˆ—å°±ä¸å¤ªå¯èƒ½ä¸æ˜¯0äº†(å› ä¸ºä¼šå¯¹åº”çš„æ‰©å¤§Kå€ï¼Œæ˜¾è‘—åœ°ä½¿è§„çº¦å‘é‡å˜é•¿)ï¼Œæˆ‘æµ‹è¯•å‡ºå–100å·¦å³å³å¯ï¼Œç„¶åå°±å¯ä»¥æ±‚è§£æœ€å¤§å…¬çº¦æ•°(æ­¤æ—¶è¿˜éœ€æ³¨æ„ä¸¤ç‚¹å°é—®é¢˜ï¼šä¸€æ˜¯è§„çº¦å‡ºçš„çŸ­å‘é‡æœ‰è´Ÿæ•°ï¼Œæ™®é€šå¹‚è¿ç®—ä¸­ä¼šå˜æˆåˆ†æ•°å½¢å¼ï¼Œé€šåˆ†è‡³ç­‰å¼å³ä¾§å³å¯ï¼›äºŒæ˜¯æ±‚å¾—çš„å…¬çº¦æ•°ä»æœ‰å¯èƒ½æ˜¯kå€çš„nï¼Œéœ€è¦å»é™¤ä¸€äº›å°å› å­)ï¼Œæœ€ç»ˆå¾—åˆ°nã€‚</p>
<p><br></p>
<p>recovern.ipynb:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">e= []</span><br><span class="line">c= []</span><br><span class="line"></span><br><span class="line"><span class="comment">#step1</span></span><br><span class="line">L = Matrix(ZZ, <span class="number">20</span>, <span class="number">21</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    L[i,<span class="number">0</span>] = e[i]*<span class="number">1000</span></span><br><span class="line">    L[i,i+<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">L = L.LLL()</span><br><span class="line"></span><br><span class="line">alist1 = L[<span class="number">0</span>][<span class="number">1</span>:]</span><br><span class="line">k1nl = <span class="number">1</span></span><br><span class="line">k1nr = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    <span class="keyword">if</span>(alist1[i]&lt;<span class="number">0</span>):</span><br><span class="line">        k1nr *= c[i]**(-alist1[i])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        k1nl *= c[i]**alist1[i]</span><br><span class="line">k1n = k1nl-k1nr</span><br><span class="line"></span><br><span class="line">alist2 = L[<span class="number">1</span>][<span class="number">1</span>:]</span><br><span class="line">k2nl = <span class="number">1</span></span><br><span class="line">k2nr = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    <span class="keyword">if</span>(alist2[i]&lt;<span class="number">0</span>):</span><br><span class="line">        k2nr *= c[i]**(-alist2[i])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        k2nl *= c[i]**alist2[i]</span><br><span class="line">k2n = k2nl-k2nr</span><br><span class="line"></span><br><span class="line">n = gcd(k1n,k2n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">10000</span>):</span><br><span class="line">    <span class="keyword">while</span>(n % i == <span class="number">0</span>):</span><br><span class="line">        n //= i</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ£€æŸ¥ä¸€ä¸‹nçš„é•¿åº¦æ˜¯å¦ä¸º1024bit</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(<span class="built_in">bin</span>(n)[<span class="number">2</span>:]))</span><br><span class="line"><span class="built_in">print</span>(n)</span><br></pre></td></tr></table></figure>
<p>åä¸¤ä¸ªé—®é¢˜ä¹Ÿå°±è¿åˆƒè€Œè§£ï¼Œæœ€ç»ˆå¾—åˆ°flagï¼š</p>
<font size="4" color="red">NSSCTF{407f8832-6ffd-43bf-91a0-6900758cdff7}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ€»çš„è¯´æ¥ï¼Œå¯¹æ ¼çš„åº”ç”¨è¿˜ä¸å¤Ÿçµæ´»ï¼Œè¿˜éœ€è¦åŠ æ·±å­¦ä¹ ã€‚</p>
<p>å¦‚æœå„ä½æœ‰ä¸æ‡‚çš„åœ°æ–¹æˆ–è€…å‘ç°äº†æ–‡ä¸­çš„é—®é¢˜ï¼Œæ¬¢è¿è”ç³»æˆ‘ï¼Œä¸€èµ·å­¦ä¹ è¿›æ­¥ã€‚</p>
]]></content>
      <categories>
        <category>wp-crypto</category>
      </categories>
  </entry>
  <entry>
    <title>2023-ç¾ŠåŸæ¯-wp-crypto</title>
    <url>/post/47440.html</url>
    <content><![CDATA[<span id="more"></span>
<p>éšæ‰‹è®°å½•ä¸€ä¸‹~</p>
<h2 id="Danger-RSA"><a href="#Danger-RSA" class="headerlink" title="Danger_RSA"></a>Danger_RSA</h2><p>é¢˜ç›®æè¿°:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">çœ‹ä¼¼ç®€å•çš„rsa</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_key</span>(<span class="params">a, nbit</span>):</span><br><span class="line">    <span class="keyword">assert</span> a &gt;= <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        X = getRandomInteger(nbit // a)</span><br><span class="line">        s = getRandomRange(<span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">4</span>), <span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">5</span>))</span><br><span class="line">        p = X ** a + s</span><br><span class="line">        <span class="keyword">if</span> isPrime(p):</span><br><span class="line">            <span class="keyword">return</span> (p, s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p, s = get_key(a, <span class="number">1024</span>)</span><br><span class="line">q, t = get_key(a, <span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">N = p * q</span><br><span class="line">e = s * t</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;N =&quot;</span>, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e =&quot;</span>, e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"><span class="comment"># N = 20289788565671012003324307131062103060859990244423187333725116068731043744218295859587498278382150779775620675092152011336913225797849717782573829179765649320271927359983554162082141908877255319715400550981462988869084618816967398571437725114356308935833701495015311197958172878812521403732038749414005661189594761246154666465178024563227666440066723650451362032162000998737626370987794816660694178305939474922064726534186386488052827919792122844587807300048430756990391177266977583227470089929347969731703368720788359127837289988944365786283419724178187242169399457608505627145016468888402441344333481249304670223</span></span><br><span class="line"><span class="comment"># e = 11079917583</span></span><br><span class="line"><span class="comment"># c = 13354219204055754230025847310134936965811370208880054443449019813095522768684299807719787421318648141224402269593016895821181312342830493800652737679627324687428327297369122017160142465940412477792023917546122283870042482432790385644640286392037986185997262289003477817675380787176650410819568815448960281666117602590863047680652856789877783422272330706693947399620261349458556870056095723068536573904350085124198592111773470010262148170379730937529246069218004969402885134027857991552224816835834207152308645148250837667184968030600819179396545349582556181916861808402629154688779221034610013350165801919342549766</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®åˆçœ‹æ²¡æœ‰ä»€ä¹ˆä¸‹æ‰‹ç‚¹ï¼Œä½†å…¶å®get_keyå‡½æ•°çš„è¿™ä¸¤è¡Œæš´éœ²äº†å¾ˆå¤šä¿¡æ¯:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">X = getRandomInteger(nbit // a)</span><br><span class="line">s = getRandomRange(<span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">4</span>), <span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">5</span>))</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œaå¯èƒ½çš„èŒƒå›´å…¶å®å¾ˆå°ï¼Œç²—ç•¥çš„èŒƒå›´éƒ½ä»…æœ‰[2,1024],è¿™ä¸ªæ—¶å€™å†çœ‹ç”Ÿæˆçš„eï¼Œå¯ä»¥å‘ç°ï¼Œeç›¸å¯¹æ¥è¯´å¤ªå°äº†ï¼Œç”šè‡³å¯ä»¥å¾—åˆ°ä»–çš„å…¨éƒ¨ç´ å› å­åˆ†è§£ï¼Œå³ï¼š</p>
<script type="math/tex; mode=display">
e = 3*7*7*19*691*5741</script><p>å› æ­¤æˆ‘ä»¬å®Œå…¨å¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªæ–¹å¼æ¥è¿›ä¸€æ­¥ç¡®å®šaçš„å–å€¼èŒƒå›´:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">1024</span>):</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">4</span>)*<span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">4</span>) &lt;= e <span class="keyword">and</span> <span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">5</span>)*<span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">5</span>) &gt;= e):</span><br><span class="line">        <span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å‘ç°ï¼Œaå…¶å®ä»…èƒ½å–4ï¼›ä¸æ­¤åŒæ—¶å¯ä»¥æ˜ç™½ï¼Œå¯¹äºåˆšæ‰çš„eçš„å› å­åˆ†è§£ï¼Œä»…æœ‰ä¸¤ç§å¯èƒ½çš„ç»„åˆè®©ä¸¤æ¬¡ç”Ÿæˆçš„så‡è½åœ¨aè§„å®šçš„èŒƒå›´é‡Œï¼š</p>
<script type="math/tex; mode=display">
s=5741*19\;,\;t=691*3*7*7</script><script type="math/tex; mode=display">
s=5741*3*7\;,\;t=691*7*19</script><p>æ­¤æ—¶å†çœ‹nçš„ç”Ÿæˆè¿‡ç¨‹ï¼š</p>
<script type="math/tex; mode=display">
n = (X1^4 + s)*(X2^4 + t)</script><p>så’Œtç›¸è¾ƒäºX1ã€X2æ¥è¯´éå¸¸å°ï¼Œå› æ­¤å¯¹nå¼€4æ¬¡æ–¹æ ¹å°±å¯ä»¥å¾—åˆ°X1*X2ï¼Œæ­¤æ—¶ï¼Œå°±å¯ä»¥ä»¥ä»¥ä¸‹æ–¹å¼åˆ†è§£nï¼š</p>
<script type="math/tex; mode=display">
n = (X1*X2)^4 + t*X1^4 + s*X2^4  + s*t</script><p>å°†æ‰€æœ‰é‡ç§»åŠ¨åˆ°åŒä¸€ä¾§ï¼š</p>
<script type="math/tex; mode=display">
(X1*X2)^4 + t*X1^4 + s*X2^4  + s*t - n = 0</script><p>å·¦å³åŒæ—¶ä¹˜$\; X1^4$ï¼Œå¾—:</p>
<script type="math/tex; mode=display">
((X1*X2)^4  + s*t - n)* X1^4 + t*(X1^4)^2 + s*X2^4*X1^4= 0</script><p>æ­¤æ—¶ï¼Œä»¤$\;x = X1^4$ï¼Œå°±å¾—åˆ°ä¸‹é¢çš„ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹ï¼š</p>
<script type="math/tex; mode=display">
t*x^2 + ((X1*X2)^4  + s*t - n)* x + s*(X2*X1)^4= 0</script><p>å°†å¯èƒ½çš„ä¸¤ç»„sã€tï¼Œé€ä¸ªä»£å…¥è§£ä¸Šè¿°æ–¹ç¨‹ï¼Œå°±å¯ä»¥å¾—åˆ°nçš„åˆ†è§£ã€‚</p>
<p>å¾—åˆ°nçš„åˆ†è§£åï¼Œæƒ³è¦ç›´æ¥æ±‚è§£RSAè§£å¯†å´å‘ç°$\;gcd(e,phi_n)\;!=\;1$ï¼Œå‘ç°æ˜¯å› ä¸º$\;3|(p-1)$ä¸”$\;7|(q-1)$ï¼Œæ­¤æ—¶ç”±äºé¢˜ç›®ä¸­å¹¶æœªè¯´æ˜å¯¹flagåšè¿‡é¢å¤–å¡«å……å¤„ç†ï¼Œè€Œpã€qä¸¤ä¸ªå› å­å‡æœ‰æ¥è¿‘1024æ¯”ç‰¹ï¼Œæ­£å¸¸æ¥è¯´è¿œå¤§äºæ˜æ–‡æ¯”ç‰¹ä½ï¼Œå› æ­¤å¯ä»¥è½¬åŒ–åˆ°æ¨¡pä¸‹æ±‚è§£ï¼Œè¿™æ˜¯å› ä¸ºï¼š</p>
<script type="math/tex; mode=display">
m^{e} = (m^3)^{7*7*19*691*5741} \equiv c\quad(mod\;p)</script><p>è€Œ</p>
<script type="math/tex; mode=display">
\quad gcd(7*7*19*691*5741,(p-1)) = 1</script><p>æ‰€ä»¥å¯ä»¥å°†$m^3$å½“ä½œä¸€ä¸ªæ•´ä½“ï¼Œè¿›è¡ŒRSAè§£å¯†ååœ¨æ¨¡pä¸‹å¼€ä¸‰æ¬¡æ–¹æ ¹å³å¯ã€‚</p>
<p><br></p>
<p>exp.ipynb:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"></span><br><span class="line">N = <span class="number">20289788565671012003324307131062103060859990244423187333725116068731043744218295859587498278382150779775620675092152011336913225797849717782573829179765649320271927359983554162082141908877255319715400550981462988869084618816967398571437725114356308935833701495015311197958172878812521403732038749414005661189594761246154666465178024563227666440066723650451362032162000998737626370987794816660694178305939474922064726534186386488052827919792122844587807300048430756990391177266977583227470089929347969731703368720788359127837289988944365786283419724178187242169399457608505627145016468888402441344333481249304670223</span></span><br><span class="line">e = <span class="number">11079917583</span></span><br><span class="line">c = <span class="number">13354219204055754230025847310134936965811370208880054443449019813095522768684299807719787421318648141224402269593016895821181312342830493800652737679627324687428327297369122017160142465940412477792023917546122283870042482432790385644640286392037986185997262289003477817675380787176650410819568815448960281666117602590863047680652856789877783422272330706693947399620261349458556870056095723068536573904350085124198592111773470010262148170379730937529246069218004969402885134027857991552224816835834207152308645148250837667184968030600819179396545349582556181916861808402629154688779221034610013350165801919342549766</span></span><br><span class="line">elist = [<span class="number">3</span>,<span class="number">7</span>,<span class="number">7</span>,<span class="number">19</span>,<span class="number">691</span>,<span class="number">5741</span>]</span><br><span class="line"></span><br><span class="line">a = <span class="number">2</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">pow</span>(<span class="number">2</span>, i ** <span class="number">2</span> - i + <span class="number">4</span>)*<span class="built_in">pow</span>(<span class="number">2</span>, i ** <span class="number">2</span> - i + <span class="number">4</span>) &lt;= e <span class="keyword">and</span> <span class="built_in">pow</span>(<span class="number">2</span>, i ** <span class="number">2</span> - i + <span class="number">5</span>)*<span class="built_in">pow</span>(<span class="number">2</span>, i ** <span class="number">2</span> - i + <span class="number">5</span>) &gt;= e):</span><br><span class="line">        a = i</span><br><span class="line"></span><br><span class="line">s1 = <span class="number">120561</span> </span><br><span class="line">s2 = <span class="number">91903</span></span><br><span class="line"></span><br><span class="line">ab = iroot(N,<span class="number">4</span>)[<span class="number">0</span>] ** <span class="number">4</span></span><br><span class="line">b = -(N-ab-s1*s2)</span><br><span class="line">a = s2</span><br><span class="line">c1 = s1*ab</span><br><span class="line">x = <span class="built_in">int</span>((-b + iroot(b**<span class="number">2</span>-<span class="number">4</span>*a*c1,<span class="number">2</span>)[<span class="number">0</span>]) // (<span class="number">2</span>*a))</span><br><span class="line">p = x + s1</span><br><span class="line">q = N//p</span><br><span class="line"></span><br><span class="line">d = inverse(e//<span class="number">3</span>,p-<span class="number">1</span>)</span><br><span class="line">m3 = <span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,p))</span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; = Zmod(p)[]</span><br><span class="line">f = x^<span class="number">3</span> - m3</span><br><span class="line">res = f.roots()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">    temp = long_to_bytes(<span class="built_in">int</span>(i[<span class="number">0</span>]))</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">b&quot;DASCTF&quot;</span> <span class="keyword">in</span> temp):</span><br><span class="line">        <span class="built_in">print</span>(temp)</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flagï¼š</p>
<font color="red">DASCTF{C0nsTruct!n9_Techn1qUe2_f0r_RSA_Pr1me_EnC2ypt10N}</font>

<p><br></p>
<p>å½“ç„¶ï¼Œè¿™é¢˜è¿˜æœ‰ä¸€äº›å€¼å¾—æ€è€ƒçš„åœ°æ–¹ï¼Œå¦‚è‹¥æ˜æ–‡çš„æ¯”ç‰¹ä½è¶…è¿‡äº†pï¼Œåˆè¯¥æ€ä¹ˆåŠï¼Ÿ</p>
<p>é¦–å…ˆå¯ä»¥å…ˆå°†ä¸p-1ã€q-1å‡ä¸äº’ç´ çš„ç´ å› å­ç”¨æ™®é€šRSAè§£å¯†å‰”å»ï¼Œå¾—åˆ°</p>
<script type="math/tex; mode=display">
\quad c\equiv m^{3*7*7}\quad (mod\;n)</script><p>ç„¶åå°±å¯ä»¥ä½¿ç”¨AMMç®—æ³•ï¼Œä½†æ˜¯è¿™æ—¶ä½¿ç”¨AMMç®—æ³•åˆæœ‰ä¸€ç‚¹ç‰¹æ®Šï¼Œè¿™æ˜¯å› ä¸ºè™½ç„¶$7|q-1$ï¼Œä½†æ˜¯49å´ä¸æ•´é™¤äºq-1ï¼Œå› æ­¤æ— æ³•ä¸€æ¬¡æ€§åœ¨æ¨¡qä¸‹å¼€49æ¬¡æ–¹æ ¹ï¼Œè€Œéœ€è¦å…ˆå¼€ä¸ƒæ¬¡æ–¹æ ¹ï¼Œå†å¯¹7ä¸ªå¼€å‡ºçš„æ ¹å†å„å¼€7æ¬¡æ–¹æ ¹ï¼Œæœ€åå†ä¸æ¨¡pä¸‹å¼€å‡ºçš„3æ¬¡æ–¹æ ¹ä½œä¸­å›½å‰©ä½™å®šç†æ±‚è§£ï¼š</p>
<p>exp.ipynb:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long,long_to_bytes,inverse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = <span class="number">3232774922192317186963877855543094060264001327534643963164572334193887491269409927593188017108306298404437170754762182875998691872041391981365074638343520234882604136837212457817534624895485767634112947143897465253262932526424371614372553023510973107043735041993637367122527503031768408492566328264574062328255875477737300307769891808134846813311720049466136337129654155946431766445576339564816809841942907193731423184669912783673012406488607834333191988772032942474663985054409518153017182678863504596312351140412943307416458908324209967299195302214349899874812717459558411734343869783905720910923365168671056618</span></span><br><span class="line">p = <span class="number">5213351003420231819415242686664610206224730148063270274863722096379841592931572096469136339538500817713355302889731144789372844731378975059329731297860686270736540109105854515590165681366189003405833252270606896051264517339339578167231093908235856718285980689179840159807651185918046198419707669304960745217</span></span><br><span class="line">q = <span class="number">3891889986375336330559716098591764128742918441309724777337583126578227827768865619689858547513951476952436981068109005313431255086775128227872912287517417948310766208005723508039484956447166240210962374423348694952997002274647622939970550008327647559433222317977926773242269276334110863262269534189811138319</span></span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">3</span>*<span class="number">7</span>*<span class="number">7</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">onemod</span>(<span class="params">e, q</span>):</span><br><span class="line">    p = random.randint(<span class="number">1</span>, q-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">pow</span>(p, (q-<span class="number">1</span>)//e, q) == <span class="number">1</span>):  <span class="comment"># (r,s)=1</span></span><br><span class="line">        p = random.randint(<span class="number">1</span>, q)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AMM_rth</span>(<span class="params">o, r, q</span>):  <span class="comment"># r|(q-1</span></span><br><span class="line">    <span class="keyword">assert</span>((q-<span class="number">1</span>) % r == <span class="number">0</span>)</span><br><span class="line">    p = onemod(r, q)</span><br><span class="line"></span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    s = q-<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>(s % r == <span class="number">0</span>):</span><br><span class="line">        s = s//r</span><br><span class="line">        t += <span class="number">1</span></span><br><span class="line">    k = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>((s*k+<span class="number">1</span>) % r != <span class="number">0</span>):</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">    alp = (s*k+<span class="number">1</span>)//r</span><br><span class="line"></span><br><span class="line">    a = <span class="built_in">pow</span>(p, r**(t-<span class="number">1</span>)*s, q)</span><br><span class="line">    b = <span class="built_in">pow</span>(o, r*a-<span class="number">1</span>, q)</span><br><span class="line">    c = <span class="built_in">pow</span>(p, s, q)</span><br><span class="line">    h = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, t-<span class="number">1</span>):</span><br><span class="line">        d = <span class="built_in">pow</span>(<span class="built_in">int</span>(b), r**(t-<span class="number">1</span>-i), q)</span><br><span class="line">        <span class="keyword">if</span> d == <span class="number">1</span>:</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            j = (-math.log(d, a)) % r</span><br><span class="line">        b = (b*(c**(r*j))) % q</span><br><span class="line">        h = (h*c**j) % q</span><br><span class="line">        c = (c*r) % q</span><br><span class="line">    result = (<span class="built_in">pow</span>(o, alp, q)*h)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ALL_Solution</span>(<span class="params">m, q, rt, cq, e</span>):</span><br><span class="line">    mp = []</span><br><span class="line">    <span class="keyword">for</span> pr <span class="keyword">in</span> rt:</span><br><span class="line">        r = (pr*m) % q</span><br><span class="line">        <span class="comment"># assert(pow(r, e, q) == cq)</span></span><br><span class="line">        mp.append(r)</span><br><span class="line">    <span class="keyword">return</span> mp</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calc</span>(<span class="params">mp, mq, e, p, q</span>):</span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    j = <span class="number">1</span></span><br><span class="line">    t1 = inverse(q, p)</span><br><span class="line">    t2 = inverse(p, q)</span><br><span class="line">    <span class="keyword">for</span> mp1 <span class="keyword">in</span> mp:</span><br><span class="line">        <span class="keyword">for</span> mq1 <span class="keyword">in</span> mq:</span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> j % <span class="number">100000</span> == <span class="number">0</span>:</span><br><span class="line">                <span class="built_in">print</span>(j)</span><br><span class="line">            ans = (mp1*t1*q+mq1*t2*p) % (p*q)</span><br><span class="line">            <span class="keyword">if</span> check(ans):</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        a = long_to_bytes(m)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;DASCTF&#x27;</span> <span class="keyword">in</span> a <span class="keyword">or</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> a:</span><br><span class="line">            <span class="built_in">print</span>(a)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ALL_ROOT2</span>(<span class="params">r, q</span>):  <span class="comment"># use function set() and .add() ensure that the generated elements are not repeated</span></span><br><span class="line">    li = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">len</span>(li) &lt; r):</span><br><span class="line">        p = <span class="built_in">pow</span>(random.randint(<span class="number">1</span>, q-<span class="number">1</span>), (q-<span class="number">1</span>)//r, q)</span><br><span class="line">        li.add(p)</span><br><span class="line">    <span class="keyword">return</span> li</span><br><span class="line"></span><br><span class="line">cp = c % p</span><br><span class="line">cq = c % q</span><br><span class="line"></span><br><span class="line">mp = AMM_rth(cp, <span class="number">3</span>, p)</span><br><span class="line">mq = AMM_rth(cq, <span class="number">7</span>, q)</span><br><span class="line"></span><br><span class="line">rt1 = ALL_ROOT2(<span class="number">3</span>, p)</span><br><span class="line">rt2 = ALL_ROOT2(<span class="number">7</span>, q)</span><br><span class="line"></span><br><span class="line">amp = ALL_Solution(mp, p, rt1, cp, <span class="number">3</span>)</span><br><span class="line">amq = ALL_Solution(mq, q, rt2, cq, <span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¾—åˆ°æ¨¡qä¸‹æ‰€æœ‰æ ¹</span></span><br><span class="line">mqs = []</span><br><span class="line"><span class="keyword">for</span> mq <span class="keyword">in</span> amq:</span><br><span class="line">    mqs.append(mq)</span><br><span class="line">amq = mqs</span><br><span class="line">dq = inverse(<span class="number">3</span>, (q-<span class="number">1</span>))</span><br><span class="line">mmqs = []</span><br><span class="line"><span class="keyword">for</span> mq <span class="keyword">in</span> amq:</span><br><span class="line">    mmq = AMM_rth(mq, <span class="number">7</span>, q)</span><br><span class="line"></span><br><span class="line">    rt3 = ALL_ROOT2(<span class="number">7</span>, q)</span><br><span class="line"></span><br><span class="line">    mamq = ALL_Solution(mmq, q, rt3, mq, <span class="number">7</span>)</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> mamq:</span><br><span class="line">        mmqs.append(<span class="built_in">int</span>(<span class="built_in">pow</span>(t,dq,q)))</span><br><span class="line">amq = mmqs</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¾—åˆ°æ¨¡pä¸‹æ‰€æœ‰æ ¹</span></span><br><span class="line">dp = inverse(<span class="number">49</span>, (p-<span class="number">1</span>))</span><br><span class="line">mps = []</span><br><span class="line"><span class="keyword">for</span> mp <span class="keyword">in</span> amp:</span><br><span class="line">    mps.append(<span class="built_in">int</span>(<span class="built_in">pow</span>(mp, dp, p)))</span><br><span class="line">amp = mps</span><br><span class="line"></span><br><span class="line">calc(amp, amq, e, p, q)</span><br></pre></td></tr></table></figure>
<p>è€Œç®€ä¾¿ä¸€ç‚¹ï¼Œç›´æ¥è§£æœ‰é™åŸŸä¸‹çš„æ–¹ç¨‹ä¹Ÿæ˜¯å¯è¡Œçš„ï¼š</p>
<p>exp.ipynb:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long,long_to_bytes,inverse</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"><span class="comment">#ä½¿ç”¨å¦‚ï¼šM = crt(n,c)[0]</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">3232774922192317186963877855543094060264001327534643963164572334193887491269409927593188017108306298404437170754762182875998691872041391981365074638343520234882604136837212457817534624895485767634112947143897465253262932526424371614372553023510973107043735041993637367122527503031768408492566328264574062328255875477737300307769891808134846813311720049466136337129654155946431766445576339564816809841942907193731423184669912783673012406488607834333191988772032942474663985054409518153017182678863504596312351140412943307416458908324209967299195302214349899874812717459558411734343869783905720910923365168671056618</span></span><br><span class="line">p = <span class="number">5213351003420231819415242686664610206224730148063270274863722096379841592931572096469136339538500817713355302889731144789372844731378975059329731297860686270736540109105854515590165681366189003405833252270606896051264517339339578167231093908235856718285980689179840159807651185918046198419707669304960745217</span></span><br><span class="line">q = <span class="number">3891889986375336330559716098591764128742918441309724777337583126578227827768865619689858547513951476952436981068109005313431255086775128227872912287517417948310766208005723508039484956447166240210962374423348694952997002274647622939970550008327647559433222317977926773242269276334110863262269534189811138319</span></span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">3</span>*<span class="number">7</span>*<span class="number">7</span></span><br><span class="line"></span><br><span class="line">dp = inverse(<span class="number">49</span>,p-<span class="number">1</span>)</span><br><span class="line">cp = <span class="built_in">pow</span>(c,dp,p)</span><br><span class="line">PR.&lt;x&gt; = Zmod(p)[]</span><br><span class="line">f = x^<span class="number">3</span> - cp</span><br><span class="line">resp = f.roots()</span><br><span class="line"></span><br><span class="line">dq = inverse(<span class="number">3</span>,q-<span class="number">1</span>)</span><br><span class="line">cq = <span class="built_in">pow</span>(c,dq,q)</span><br><span class="line">PR.&lt;x&gt; = Zmod(q)[]</span><br><span class="line">f = x^<span class="number">49</span> - cq</span><br><span class="line">resq = f.roots()</span><br><span class="line"></span><br><span class="line">modlist = [p,q]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> resp:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> resq:</span><br><span class="line">        c = [<span class="built_in">int</span>(i[<span class="number">0</span>]),<span class="built_in">int</span>(j[<span class="number">0</span>])]</span><br><span class="line">        m = crt(modlist,c)[<span class="number">0</span>]</span><br><span class="line">        temp = long_to_bytes(m)</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">b&quot;DASCTF&quot;</span> <span class="keyword">in</span> temp):</span><br><span class="line">            <span class="built_in">print</span>(temp)</span><br></pre></td></tr></table></figure>
<p>å¤šç§æ–¹æ³•æ±‚è§£ï¼Œä¹Ÿæ˜¯ä¸ºäº†èƒ½æ›´çµæ´»çš„æ€è€ƒé—®é¢˜ï¼ŒæŒæ¡æ›´å¤šæ±‚è§£æ–¹å¼ï¼Œè®©è‡ªå·±ä¸€ç§æ–¹æ³•å¡ä½æ—¶ï¼Œå¯ä»¥æœ‰è·¯å¯èµ°ã€‚</p>
<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="Easy-3L"><a href="#Easy-3L" class="headerlink" title="Easy_3L"></a>Easy_3L</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ— </span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_key</span>():</span><br><span class="line">    p = getPrime(<span class="number">1400</span>)</span><br><span class="line">    f = getRandomNBitInteger(<span class="number">1024</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        q = getPrime(<span class="number">512</span>)</span><br><span class="line">        <span class="keyword">if</span> gcd(f, q) != <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    h = (invert(f, p) * q) % p</span><br><span class="line">    <span class="keyword">return</span> p, h</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt1</span>(<span class="params">m</span>):</span><br><span class="line">    a = getPrime(<span class="number">250</span>)</span><br><span class="line">    b = getRandomNBitInteger(<span class="number">240</span>)</span><br><span class="line">    n = getPrime(<span class="number">512</span>)</span><br><span class="line">    seed = m</span><br><span class="line">    s = [<span class="number">0</span>] * <span class="number">6</span></span><br><span class="line">    s[<span class="number">0</span>] = seed</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">6</span>):</span><br><span class="line">        s[i] = (s[i - <span class="number">1</span>] * a + b) % n</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt2</span>(<span class="params">msg, p, h</span>):</span><br><span class="line">    s = getRandomNBitInteger(<span class="number">512</span>)</span><br><span class="line">    c = (s * h + msg) % p</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s = encrypt1(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;S1 =&quot;</span>, s[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;S2 =&quot;</span>, s[<span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;S4 =&quot;</span>, s[<span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;S5 =&quot;</span>, s[<span class="number">5</span>])</span><br><span class="line"></span><br><span class="line">p, h = get_key()</span><br><span class="line">c = encrypt2(s[<span class="number">3</span>], p, h)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p =&quot;</span>, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;h =&quot;</span>, h)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># S1 = 28572152986082018877402362001567466234043851789360735202177142484311397443337910028526704343260845684960897697228636991096551426116049875141</span></span><br><span class="line"><span class="comment"># S2 = 1267231041216362976881495706209012999926322160351147349200659893781191687605978675590209327810284956626443266982499935032073788984220619657447889609681888</span></span><br><span class="line"><span class="comment"># S4 = 9739918644806242673966205531575183334306589742344399829232076845951304871478438938119813187502023845332528267974698273405630514228632721928260463654612997</span></span><br><span class="line"><span class="comment"># S5 = 9755668823764800147393276745829186812540710004256163127825800861195296361046987938775181398489372822667854079119037446327498475937494635853074634666112736</span></span><br><span class="line"><span class="comment"># p = 25886434964719448194352673440525701654705794467884891063997131230558866479588298264578120588832128279435501897537203249743883076992668855905005985050222145380285378634993563571078034923112985724204131887907198503097115380966366598622251191576354831935118147880783949022370177789175320661630501595157946150891275992785113199863734714343650596491139321990230671901990010723398037081693145723605154355325074739107535905777351</span></span><br><span class="line"><span class="comment"># h = 2332673914418001018316159191702497430320194762477685969994411366563846498561222483921873160125818295447435796015251682805613716554577537183122368080760105458908517619529332931042168173262127728892648742025494771751133664547888267249802368767396121189473647263861691578834674578112521646941677994097088669110583465311980605508259404858000937372665500663077299603396786862387710064061811000146453852819607311367850587534711</span></span><br><span class="line"><span class="comment"># c = 20329058681057003355767546524327270876901063126285410163862577312957425318547938475645814390088863577141554443432653658287774537679738768993301095388221262144278253212238975358868925761055407920504398004143126310247822585095611305912801250788531962681592054588938446210412897150782558115114462054815460318533279921722893020563472010279486838372516063331845966834180751724227249589463408168677246991839581459878242111459287</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®çš„3Læ˜¾ç„¶æŒ‡çš„æ˜¯LLLç®—æ³•ï¼ŒåŠ å¯†è¿‡ç¨‹åˆ†ä¸ºä¸¤å±‚ï¼š</p>
<ul>
<li>LCGåŠ å¯†ç§å­flag</li>
<li>NTRUåŠ å¯†LCGçš„S3</li>
</ul>
<p>é‚£ä¹ˆè§£é¢˜æ€è·¯ä¹Ÿå¾ˆæ¸…æ™°ï¼Œå…ˆè§£å†³NTRUè§£å‡ºS3ï¼Œè¿›è€Œæ¢å¤LCGçš„ç§å­å³å¯ã€‚</p>
<p>æœ¬é¢˜ä½ ä¼šå‘ç°è¦è§„çº¦å‡ºçš„å‘é‡(f,g)æ•°é‡çº§å¥½åƒå·®çš„æœ‰ç‚¹å¤šï¼Œå¾ˆéš¾è§„çº¦å‡º1024æ¯”ç‰¹çš„fï¼Œä½†æ˜¯ä¸é‡è¦ï¼Œfæ˜¯å¦ä¸ºåŸå§‹å€¼å¯¹äºè§£å¯†å½±å“å¹¶ä¸å¤§ï¼Œåªéœ€è¦æ£€æŸ¥S3çš„æ•°é‡çº§æ­£å¸¸å³å¯ã€‚(æ­£å¸¸æ¥è¯´ï¼Œä¸ºä½¿è§„çº¦åçš„å‘é‡æ¯”ç‰¹ç›¸è¿‘ï¼Œåº”åœ¨ç¬¬äºŒåˆ—ä¹˜ä¸Š2^512ï¼Œä½¿ f ä¸ (2^512)*gå…·æœ‰ç›¸åŒæ•°é‡çº§ï¼Œä½†æœ¬é¢˜ä¸­è¿™æ˜¯è§£ä¸å‡ºæ¥çš„ï¼Œå› æ­¤å¯ä»¥é‡‡ç”¨çˆ†ç ´æ‰‹æ®µï¼Œä¼šå‘ç°æœ‰å¾ˆå¤šçŸ­å‘é‡fã€gå‡å¯ä»¥ç”¨äºè§£å¯†ï¼Œè¿™ä¹Ÿç¬¦åˆNTRUçš„å¯†é’¥ç‰¹æ€§)</p>
<p>è§£å‡ºS3åæ˜¯ä¸ªç®€å•çš„LCGé—®é¢˜ï¼Œä¸å†èµ˜è¿°ã€‚</p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">25886434964719448194352673440525701654705794467884891063997131230558866479588298264578120588832128279435501897537203249743883076992668855905005985050222145380285378634993563571078034923112985724204131887907198503097115380966366598622251191576354831935118147880783949022370177789175320661630501595157946150891275992785113199863734714343650596491139321990230671901990010723398037081693145723605154355325074739107535905777351</span></span><br><span class="line">h = <span class="number">2332673914418001018316159191702497430320194762477685969994411366563846498561222483921873160125818295447435796015251682805613716554577537183122368080760105458908517619529332931042168173262127728892648742025494771751133664547888267249802368767396121189473647263861691578834674578112521646941677994097088669110583465311980605508259404858000937372665500663077299603396786862387710064061811000146453852819607311367850587534711</span></span><br><span class="line">c = <span class="number">20329058681057003355767546524327270876901063126285410163862577312957425318547938475645814390088863577141554443432653658287774537679738768993301095388221262144278253212238975358868925761055407920504398004143126310247822585095611305912801250788531962681592054588938446210412897150782558115114462054815460318533279921722893020563472010279486838372516063331845966834180751724227249589463408168677246991839581459878242111459287</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dec</span>(<span class="params">S3</span>):</span><br><span class="line">    S1 = <span class="number">28572152986082018877402362001567466234043851789360735202177142484311397443337910028526704343260845684960897697228636991096551426116049875141</span></span><br><span class="line">    S2 = <span class="number">1267231041216362976881495706209012999926322160351147349200659893781191687605978675590209327810284956626443266982499935032073788984220619657447889609681888</span></span><br><span class="line">    S4 = <span class="number">9739918644806242673966205531575183334306589742344399829232076845951304871478438938119813187502023845332528267974698273405630514228632721928260463654612997</span></span><br><span class="line">    S5 = <span class="number">9755668823764800147393276745829186812540710004256163127825800861195296361046987938775181398489372822667854079119037446327498475937494635853074634666112736</span></span><br><span class="line"></span><br><span class="line">    x = [S1, S2, S3, S4, S5]</span><br><span class="line">    t = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(x)):</span><br><span class="line">        t.append(x[i] - x[i-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    m = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(t)-<span class="number">1</span>):</span><br><span class="line">        m = GCD(t[i+<span class="number">1</span>]*t[i-<span class="number">1</span>] - t[i]*t[i], m)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> sieve_base:</span><br><span class="line">        <span class="keyword">while</span> m % p == <span class="number">0</span>: m //= p</span><br><span class="line">    <span class="keyword">assert</span> isPrime(m)</span><br><span class="line"></span><br><span class="line">    a = (S3 - S2) * inverse(S2 - S1, m)</span><br><span class="line">    b = (S2 - a*S1) % m</span><br><span class="line"></span><br><span class="line">    S1 = (S1-b)*inverse(a, m) % m</span><br><span class="line">    flag = long_to_bytes(S1)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;DASCTF&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">1000</span>):</span><br><span class="line">    L = Matrix(ZZ, [[<span class="number">1</span>, (<span class="number">2</span>**e)*h],</span><br><span class="line">                    [<span class="number">0</span>, (<span class="number">2</span>**e)*p]])</span><br><span class="line">    f, g = L.LLL()[<span class="number">0</span>]</span><br><span class="line">    g = g  // (<span class="number">2</span>**e)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        S3 = (f*c) % p % g * inverse(f, g) % g</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">len</span>(<span class="built_in">bin</span>(S3)) == <span class="number">514</span>):</span><br><span class="line">            dec(S3)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flagï¼š</p>
<font color="red">DASCTF{NTRU_L0G_a6e_S1mpLe}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="SigninCrypto"><a href="#SigninCrypto" class="headerlink" title="SigninCrypto"></a>SigninCrypto</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">éšæœºæ•°çœŸéšæœºå—ï¼Ÿå¦‚éšï¼</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> key <span class="keyword">import</span> key</span><br><span class="line"><span class="keyword">from</span> iv <span class="keyword">import</span> iv</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"></span><br><span class="line">K1= key</span><br><span class="line">hint1 = os.urandom(<span class="number">2</span>) * <span class="number">8</span></span><br><span class="line">xor =bytes_to_long(hint1)^bytes_to_long(K1)</span><br><span class="line"><span class="built_in">print</span>(xor)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Rand</span>():</span><br><span class="line">    rseed = secrets.randbits(<span class="number">1024</span>)</span><br><span class="line">    List1 = []</span><br><span class="line">    List2 = []</span><br><span class="line">    seed(rseed)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        rand16 = getrandbits(<span class="number">16</span>)</span><br><span class="line">        List1.append(rand16)</span><br><span class="line">    seed(rseed)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">312</span>):</span><br><span class="line">        rand64 = getrandbits(<span class="number">64</span>)</span><br><span class="line">        List2.append(rand64)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;task.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">for</span> rand16 <span class="keyword">in</span> List1:</span><br><span class="line">            file.write(<span class="built_in">hex</span>(rand16)+ <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> rand64 <span class="keyword">in</span> List2:</span><br><span class="line">            file.write(<span class="built_in">hex</span>((rand64 &amp; <span class="number">0xffff</span>) | ((rand64 &gt;&gt; <span class="number">32</span>) &amp; <span class="number">0xffff</span>) &lt;&lt; <span class="number">16</span>) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">Rand()</span><br><span class="line"></span><br><span class="line">K2 = long_to_bytes(getrandbits(<span class="number">64</span>))</span><br><span class="line">K3 = flag[:<span class="number">8</span>]</span><br><span class="line"></span><br><span class="line">KEY = K1 + K2 + K3</span><br><span class="line"></span><br><span class="line">IV=iv</span><br><span class="line"></span><br><span class="line">IV1=IV[:<span class="built_in">len</span>(IV)//<span class="number">2</span>]</span><br><span class="line">IV2=IV[<span class="built_in">len</span>(IV)//<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">digest1 = hashlib.sha512(IV1).digest().<span class="built_in">hex</span>()</span><br><span class="line">digest2 = hashlib.sha512(IV2).digest().<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line">digest=digest1+digest2</span><br><span class="line">hint2=(bytes_to_long(IV)&lt;&lt;<span class="number">32</span>)^bytes_to_long(os.urandom(<span class="number">8</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(bytes_to_long((digest.encode()))))</span><br><span class="line"><span class="built_in">print</span>(hint2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mode = DES3.MODE_CBC</span><br><span class="line">des3 = DES3.new(KEY, mode, IV)</span><br><span class="line"></span><br><span class="line">pad_len = <span class="number">8</span> - <span class="built_in">len</span>(flag) % <span class="number">8</span></span><br><span class="line">padding = <span class="built_in">bytes</span>([pad_len]) * pad_len</span><br><span class="line">flag += padding</span><br><span class="line"></span><br><span class="line">cipher = des3.encrypt(flag)</span><br><span class="line"></span><br><span class="line">ciphertext=cipher.<span class="built_in">hex</span>()</span><br><span class="line"><span class="built_in">print</span>(ciphertext)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 334648638865560142973669981316964458403</span></span><br><span class="line"><span class="comment"># 0x62343937373634656339396239663236643437363738396663393438316230353665353733303939613830616662663633326463626431643139323130616333363363326631363235313661656632636265396134336361623833636165373964343533666537663934646239396462323666316236396232303539336438336234393737363465633939623966323664343736373839666339343831623035366535373330393961383061666266363332646362643164313932313061633336336332663136323531366165663263626539613433636162383363616537396434353366653766393464623939646232366631623639623230353933643833</span></span><br><span class="line"><span class="comment"># 22078953819177294945130027344</span></span><br><span class="line"><span class="comment"># a6546bd93bced0a8533a5039545a54d1fee647007df106612ba643ffae850e201e711f6e193f15d2124ab23b250bd6e1</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å‘ç°ï¼Œé¢˜ç›®æœ€ç»ˆç”¨3DESå¯¹flagè¿›è¡Œäº†åŠ å¯†ï¼Œå› æ­¤ç›®æ ‡å°±æ˜¯è¿˜åŸ3DESçš„keyä¸ivå³å¯ã€‚</p>
<p>å…¶ä¸­ï¼Œä¸¤ä¸ªé‡åˆ†åˆ«åˆ†ä¸ºäº†ä»¥ä¸‹å‡ éƒ¨åˆ†ï¼š</p>
<ul>
<li>KEY = K1 + K2 + K3 ,æ¯ä¸ªéƒ¨åˆ†å¤§å°8å­—èŠ‚</li>
<li>IV=ivï¼Œæ¯ä¸ªéƒ¨åˆ†å¤§å°4å­—èŠ‚</li>
</ul>
<p>æŒ‰ç…§å¦‚ä¸‹æ–¹å¼é€æ­¥è¿˜åŸæ¯ä¸ªéƒ¨åˆ†ï¼š</p>
<p><strong>K1</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">K1= key</span><br><span class="line">hint1 = os.urandom(2) * 8</span><br><span class="line">xor =bytes_to_long(hint1)^bytes_to_long(K1)</span><br><span class="line">print(xor)</span><br></pre></td></tr></table></figure>
<p>hint1ä¸º16å­—èŠ‚é‡ï¼Œè€ŒK1ä¸º8å­—èŠ‚é‡ï¼Œå› æ­¤xorçš„é«˜ä½å³ä¸ºhint1çš„é«˜ä½ï¼Œåˆå› ä¸ºhint1ç”±é‡å¤å­—èŠ‚æ„æˆï¼Œhint1é«˜ä½ä¸ä½ä½ç›¸ç­‰ã€‚å¾—åˆ°å®Œæ•´hint1åä¸xorå¼‚æˆ–å³å¾—K1</p>
<p><strong>K2</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">Rand</span>():</span><br><span class="line">    rseed = secrets.randbits(<span class="number">1024</span>)</span><br><span class="line">    List1 = []</span><br><span class="line">    List2 = []</span><br><span class="line">    seed(rseed)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        rand16 = getrandbits(<span class="number">16</span>)</span><br><span class="line">        List1.append(rand16)</span><br><span class="line">    seed(rseed)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">312</span>):</span><br><span class="line">        rand64 = getrandbits(<span class="number">64</span>)</span><br><span class="line">        List2.append(rand64)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;task.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">for</span> rand16 <span class="keyword">in</span> List1:</span><br><span class="line">            file.write(<span class="built_in">hex</span>(rand16)+ <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> rand64 <span class="keyword">in</span> List2:</span><br><span class="line">            file.write(<span class="built_in">hex</span>((rand64 &amp; <span class="number">0xffff</span>) | ((rand64 &gt;&gt; <span class="number">32</span>) &amp; <span class="number">0xffff</span>) &lt;&lt; <span class="number">16</span>) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">Rand()</span><br><span class="line"></span><br><span class="line">K2 = long_to_bytes(getrandbits(<span class="number">64</span>))</span><br></pre></td></tr></table></figure>
<p>è€ƒå¯Ÿçš„æ˜¯MT19937ä¼ªéšæœºæ•°ç”Ÿæˆï¼Œåˆ©ç”¨randcrackæ¨¡å—ï¼Œæäº¤624ä¸ª32bitæ•°ï¼Œå³å¯å¯¹ä¹‹åçš„éšæœºæ•°è¿›è¡Œç²¾å‡†é¢„æµ‹ã€‚è€Œæ³¨æ„åˆ°ç”ŸæˆList1ã€List2ä¹‹é—´é‡æ–°è°ƒæ•´äº†ä¸€æ¬¡éšæœºæ•°ç§å­ï¼Œå› æ­¤List1ã€List2æ˜¯ä½¿ç”¨åŒä¸€éšæœºæ•°ç§å­ç”Ÿæˆçš„ã€‚</p>
<p>è€Œæ³¨æ„åˆ°ï¼ŒList1ä»…æœ‰$624<em>16$bitï¼ŒList2å´æœ‰$324</em>64 = 624*32$bitï¼Œå› æ­¤List2ç”Ÿæˆçš„ä½æ•°æ˜¯è¶³å¤Ÿçš„ï¼Œè€Œæœ€ç»ˆtask.txtæ–‡æœ¬ä¸­å´åªç»™äº†List2çš„éƒ¨åˆ†å­—èŠ‚ï¼Œä¸éœ€è¦æ·±ç©¶åŸç†ä¹Ÿèƒ½æ˜ç™½ï¼šList1ç”Ÿæˆçš„å­—èŠ‚æ°å¥½å°±æ˜¯List2ç”Ÿæˆçš„éšæœºæ•°ä¸­ç¼ºå¤±çš„å­—èŠ‚ã€‚å› æ­¤åªéœ€è¦æ¯ç§è¡¥å……æ–¹å¼å‡å°è¯•ä¸€ä¸‹å³å¯å¾—åˆ°K2ã€‚</p>
<p><strong>K3</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">K3 = flag[:<span class="number">8</span>]</span><br></pre></td></tr></table></figure>
<p>å¾ˆæ˜¾ç„¶ï¼Œå› ä¸ºflagä¸€èˆ¬ä»¥DASCTF{å¼€å¤´ï¼Œå› æ­¤åªéœ€è¦çˆ†ç ´ä¸€ä¸ªå¯è§å­—ç¬¦å³å¯å¾—åˆ°æ­£ç¡®K3ã€‚</p>
<p><strong>IV1åŠIV2</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">IV1=IV[:<span class="built_in">len</span>(IV)//<span class="number">2</span>]</span><br><span class="line">IV2=IV[<span class="built_in">len</span>(IV)//<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">digest1 = hashlib.sha512(IV1).digest().<span class="built_in">hex</span>()</span><br><span class="line">digest2 = hashlib.sha512(IV2).digest().<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line">digest=digest1+digest2</span><br><span class="line">hint2=(bytes_to_long(IV)&lt;&lt;<span class="number">32</span>)^bytes_to_long(os.urandom(<span class="number">8</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(bytes_to_long((digest.encode()))))</span><br><span class="line"><span class="built_in">print</span>(hint2)</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆæ˜ç¡®IVä¸€å…±8ä¸ªå­—èŠ‚ï¼Œå› æ­¤hint2çš„é«˜ä½å³ä¸ºIV1ï¼Œæ­¤æ—¶é¢˜ç›®çš„å‡ ä¸ªå“ˆå¸Œå€¼è²Œä¼¼ç»™äº†ä¸€ä¸ªæš—ç¤ºï¼šçˆ†ç ´æ±‚è§£IV2.å¯æ˜¯éœ€è¦çˆ†ç ´çš„é‡æœ‰4ä¸ªå­—èŠ‚ï¼Œè™½ç„¶ä¸èƒ½è¯´å¾ˆå¤§ï¼Œå´ä¹Ÿéœ€è¦å¾ˆé•¿æ—¶é—´ã€‚æ­¤æ—¶å°±éœ€è¦æ³¨æ„åˆ°ï¼Œdigest=digest1+digest2è¿™ä¸€è¡Œï¼Œå¹¶ä¸æ˜¯æ•°å€¼çš„ç›¸åŠ ï¼Œè€Œæ˜¯å­—ç¬¦ä¸²çš„è¿æ¥ï¼Œè€Œå½“ä½ å°†digestè§£ç åï¼Œä½ ä¼šå‘ç°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">digest1 = digest2</span><br></pre></td></tr></table></figure>
<p>æ²¡é”™ï¼Œå¤ªå¹½é»˜äº†ï¼Œæ‰€ä»¥IV2ä¸IV1ç›¸åŒ(åŸºæœ¬æ— éœ€è€ƒè™‘å“ˆå¸Œç¢°æ’)</p>
<p>æ­¤æ—¶æ‰€æœ‰é‡éƒ½å¾—åˆ°äº†è¿˜åŸï¼Œè§£å¯†3DESå³å¯ï¼š</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3</span><br><span class="line"><span class="keyword">from</span> randcrack <span class="keyword">import</span> RandCrack</span><br><span class="line"></span><br><span class="line">rc = RandCrack()</span><br><span class="line"></span><br><span class="line">cipher = <span class="built_in">int</span>(<span class="string">&quot;a6546bd93bced0a8533a5039545a54d1fee647007df106612ba643ffae850e201e711f6e193f15d2124ab23b250bd6e1&quot;</span>,<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#è·å–iv</span></span><br><span class="line">hint2 = <span class="number">22078953819177294945130027344</span></span><br><span class="line">IV1 = long_to_bytes(hint2 &gt;&gt; <span class="number">64</span>)</span><br><span class="line">IV2 = IV1</span><br><span class="line"></span><br><span class="line"><span class="comment">#è·å–K2</span></span><br><span class="line">list1 = []</span><br><span class="line">list2 = []</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;task.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        list1.append(<span class="built_in">int</span>(f.readline(),<span class="number">16</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">312</span>):</span><br><span class="line">        list2.append(<span class="built_in">int</span>(f.readline(),<span class="number">16</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">312</span>):</span><br><span class="line">    t1 = (list2[i] &amp; <span class="number">0xffff</span>)</span><br><span class="line">    t2 = ((list2[i] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xffff</span>)</span><br><span class="line">    rc.submit( (list1[<span class="number">2</span>*i]&lt;&lt;<span class="number">16</span>) | (list2[i] &amp; <span class="number">0xffff</span>))</span><br><span class="line">    rc.submit( (list1[<span class="number">2</span>*i+<span class="number">1</span>]&lt;&lt;<span class="number">16</span>) | ((list2[i] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xffff</span>))</span><br><span class="line">K2 = long_to_bytes(rc.predict_getrandbits(<span class="number">64</span>),<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#çˆ†ç ´k3</span></span><br><span class="line">xor = <span class="number">334648638865560142973669981316964458403</span></span><br><span class="line">K1 = (xor ^ (xor&gt;&gt;<span class="number">64</span>)) &amp; <span class="number">0xffffffffffffffff</span></span><br><span class="line">K1 = long_to_bytes(K1)</span><br><span class="line"></span><br><span class="line">temp = bytes_to_long(<span class="string">b&quot;DASCTF&#123;&quot;</span>) &lt;&lt; <span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">8</span>):</span><br><span class="line">    K3 = long_to_bytes(temp + j)</span><br><span class="line">    KEY = K1 + K2 + K3</span><br><span class="line">    IV = IV1 + IV2</span><br><span class="line"></span><br><span class="line">    mode = DES3.MODE_CBC</span><br><span class="line">    des3 = DES3.new(KEY, mode, IV)</span><br><span class="line">    flag = <span class="built_in">str</span>(des3.decrypt(long_to_bytes(cipher)))</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">&quot;DASCTF&quot;</span> <span class="keyword">in</span> flag):</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flagï¼š</p>
<font color="red">DASCTF{8e5ee461-f4e1-4af2-8632-c9d62f4dc073}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="esyRSA"><a href="#esyRSA" class="headerlink" title="esyRSA"></a>esyRSA</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¥½åƒè¿™ä¸ªRSAæœ‰ç‚¹æ€ªå•Šï¼ç§é’¥ç»™ä½ äº†ï¼æˆ‘çš„eå‘¢ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> md5 <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> p, q</span><br><span class="line"></span><br><span class="line">e = ?????</span><br><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = invert(e, phi)</span><br><span class="line">ans = gcd(e,phi)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> n, e, d</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;Flag: DASCTF&#123;%s&#125;&quot;</span> %md5(<span class="built_in">str</span>(p + q)).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 8064259277274639864655809758868795854117113170423331934498023294296505063511386001711751916634810056911517464467899780578338013011453082479880809823762824723657495915284790349150975180933698827382368698861967973964030509129133021116919437755292590841218316278732797712538885232908975173746394816520256585937380642592772746398646558097588687958541171131704233319344980232942965050635113860017117519166348100569115174644678997805783380130114530824798808098237628247236574959152847903491509751809336988273823686988619679739640305091291330211169194377552925908412183162787327977125388852329089751737463948165202565859373</span></span><br><span class="line"><span class="string">d = 14218766449983537783699024084862960813708451888387858392014856544340557703876299258990323621963898510226357248200187173211121827541826897886277531706124228848229095880229718049075745233893843373402201077890407507625110061976931591596708901741146750809962128820611844426759462132623616118530705745098783140913</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>æ— åŠ›åæ§½ã€‚ã€‚ã€‚è¿™é¢˜é™„ä»¶é”…äº†ï¼Œnæ˜¯ä¸¤ä¸ªé‡å¤çš„å¤§æ•´æ•°æ‹¼èµ·æ¥çš„ï¼Œå› æ­¤è¦å…ˆå–ä¸€åŠå½“ä½œæ­£ç¡®çš„nã€‚ä¹‹åçš„åšæ³•å°±å¤šäº†ï¼Œdè¿‡å¤§å¯ä»¥è€ƒè™‘wieneræˆ–æ„é€ æ ¼ï¼Œä½†æ˜¯é¢˜ç›®ç»™äº†eä¸ºäº”ä½æ•°çš„æš—ç¤ºï¼Œå› æ­¤ä¹Ÿåªéœ€è¦çˆ†ç ´ä¸€ä¸‹eï¼Œå½“ä½œå·²çŸ¥eã€dåˆ†è§£nå³å¯ã€‚</p>
<p>exp.py:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">n = <span class="string">&quot;8064259277274639864655809758868795854117113170423331934498023294296505063511386001711751916634810056911517464467899780578338013011453082479880809823762824723657495915284790349150975180933698827382368698861967973964030509129133021116919437755292590841218316278732797712538885232908975173746394816520256585937380642592772746398646558097588687958541171131704233319344980232942965050635113860017117519166348100569115174644678997805783380130114530824798808098237628247236574959152847903491509751809336988273823686988619679739640305091291330211169194377552925908412183162787327977125388852329089751737463948165202565859373&quot;</span></span><br><span class="line">n = <span class="number">80642592772746398646558097588687958541171131704233319344980232942965050635113860017117519166348100569115174644678997805783380130114530824798808098237628247236574959152847903491509751809336988273823686988619679739640305091291330211169194377552925908412183162787327977125388852329089751737463948165202565859373</span></span><br><span class="line">d = <span class="number">14218766449983537783699024084862960813708451888387858392014856544340557703876299258990323621963898510226357248200187173211121827541826897886277531706124228848229095880229718049075745233893843373402201077890407507625110061976931591596708901741146750809962128820611844426759462132623616118530705745098783140913</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>,<span class="number">100000</span>):</span><br><span class="line">    t = e*d - <span class="number">1</span></span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> t % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        s += <span class="number">1</span></span><br><span class="line">        t //= <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    found = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, s):</span><br><span class="line">        c1 = <span class="built_in">pow</span>(<span class="number">2</span>, <span class="built_in">pow</span>(<span class="number">2</span>, i-<span class="number">1</span>, n)*t, n)</span><br><span class="line">        c2 = <span class="built_in">pow</span>(<span class="number">2</span>, <span class="built_in">pow</span>(<span class="number">2</span>, i, n)*t, n)</span><br><span class="line">        <span class="keyword">if</span> c1 != <span class="number">1</span> <span class="keyword">and</span> c1 != (-<span class="number">1</span> % n) <span class="keyword">and</span> c2 == <span class="number">1</span>:</span><br><span class="line">            p = GCD(c1 - <span class="number">1</span>, n)</span><br><span class="line">            q = n // p</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;Flag: DASCTF&#123;%s&#125;&quot;</span> %hashlib.md5(<span class="built_in">str</span>(p + q).encode()).hexdigest())</span><br><span class="line">            exit()   </span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flagï¼š</p>
<font color="red">DASCTF{4ae33bea90f030bfddb7ac4d9222ef8f}</font>

<p>(<del>ä¸ºä»€ä¹ˆä¸»åŠæ–¹æ²¡æœ‰å‘ç°é™„ä»¶éœ€è¦æ›´æ–°</del>ï¼Ÿ/(ã„’oã„’)/~~)</p>
<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="MCeorpkpleer"><a href="#MCeorpkpleer" class="headerlink" title="MCeorpkpleer"></a>MCeorpkpleer</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¿™æ•°æ®éƒ½ä¸å…¨è¦æ€ä¹ˆè®¡ç®—å‘¢</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pubkey</span>(<span class="params"><span class="built_in">list</span>, m, w</span>):</span><br><span class="line">    pubkey_list = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e_bin)):</span><br><span class="line">        pubkey_list.append(w * <span class="built_in">list</span>[i] % m)</span><br><span class="line">    <span class="keyword">return</span> pubkey_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">e_cry</span>(<span class="params">e, pubkey</span>):</span><br><span class="line">    pubkey_list = pubkey</span><br><span class="line">    encode = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e)):</span><br><span class="line">        encode += pubkey_list[i] * <span class="built_in">int</span>(e[i]) % m</span><br><span class="line">    <span class="keyword">return</span> encode</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = getPrime(<span class="number">64</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line">e_bin = (<span class="built_in">bin</span>(e))[<span class="number">2</span>:]</span><br><span class="line"><span class="built_in">list</span> = [<span class="built_in">pow</span>(<span class="number">3</span>, i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e_bin))]</span><br><span class="line">m = getPrime(<span class="built_in">len</span>(<span class="built_in">bin</span>(<span class="built_in">sum</span>(<span class="built_in">list</span>))) - <span class="number">1</span>)</span><br><span class="line">w = getPrime(<span class="number">64</span>)</span><br><span class="line">pubkey = pubkey(<span class="built_in">list</span>, m, w)</span><br><span class="line">en_e = e_cry(e_bin, pubkey)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p = &#123;&#125;\n&#x27;</span></span><br><span class="line">      <span class="string">&#x27;n = &#123;&#125;\n&#x27;</span></span><br><span class="line">      <span class="string">&#x27;c = &#123;&#125;\n&#x27;</span></span><br><span class="line">      <span class="string">&#x27;pubkey = &#123;&#125;\n&#x27;</span></span><br><span class="line">      <span class="string">&#x27;en_e = &#123;&#125;&#x27;</span>.<span class="built_in">format</span>((p &gt;&gt; <span class="number">435</span>) &lt;&lt; <span class="number">435</span>, n, c, pubkey, en_e))</span><br></pre></td></tr></table></figure>
<p>è§‚å¯Ÿé¢˜ç›®ï¼Œe_cryç”¨äºèƒŒåŒ…åŠ å¯†çš„å°±æ˜¯eçš„äºŒè¿›åˆ¶ä¸²æœ¬èº«ï¼Œå› æ­¤ç›´æ¥æ ¼åŸºè§„çº¦å‡ºeï¼Œå†ç”¨coppersmithè§£å·²çŸ¥pé«˜ä½é—®é¢˜å³å¯ã€‚</p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#step1 å·²çŸ¥pé«˜ä½ï¼Œæ¢å¤pã€q</span></span><br><span class="line">p4 = <span class="number">139540788452365306201344680691061363403552933527922544113532931871057569249632300961012384092481349965600565669315386312075890938848151802133991344036696488204791984307057923179655351110456639347861739783538289295071556484465877192913103980697449775104351723521120185802327587352171892429135110880845830815744</span></span><br><span class="line">n = <span class="number">22687275367292715121023165106670108853938361902298846206862771935407158965874027802803638281495587478289987884478175402963651345721058971675312390474130344896656045501040131613951749912121302307319667377206302623735461295814304029815569792081676250351680394603150988291840152045153821466137945680377288968814340125983972875343193067740301088120701811835603840224481300390881804176310419837493233326574694092344562954466888826931087463507145512465506577802975542167456635224555763956520133324723112741833090389521889638959417580386320644108693480886579608925996338215190459826993010122431767343984393826487197759618771</span></span><br><span class="line">pbits = <span class="number">1024</span></span><br><span class="line">kbits= <span class="number">435</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x + p4</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^kbits,beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="keyword">if</span> roots:</span><br><span class="line">    p= p4 + <span class="built_in">int</span>(roots[<span class="number">0</span>])</span><br><span class="line">    q = n//p</span><br><span class="line"></span><br><span class="line"><span class="comment">#step2 æ ¼åŸºè§„çº¦æ¢å¤e</span></span><br><span class="line">b = [<span class="number">18143710780782459577</span>, <span class="number">54431132342347378731</span>, <span class="number">163293397027042136193</span>, <span class="number">489880191081126408579</span>, <span class="number">1469640573243379225737</span>, <span class="number">4408921719730137677211</span>, <span class="number">13226765159190413031633</span>, <span class="number">39680295477571239094899</span>, <span class="number">119040886432713717284697</span>, <span class="number">357122659298141151854091</span>, <span class="number">1071367977894423455562273</span>, <span class="number">3214103933683270366686819</span>, <span class="number">9642311801049811100060457</span>, <span class="number">28926935403149433300181371</span>, <span class="number">86780806209448299900544113</span>, <span class="number">260342418628344899701632339</span>, <span class="number">781027255885034699104897017</span>, <span class="number">2343081767655104097314691051</span>, <span class="number">7029245302965312291944073153</span>, <span class="number">21087735908895936875832219459</span>, <span class="number">63263207726687810627496658377</span>, <span class="number">189789623180063431882489975131</span>, <span class="number">569368869540190295647469925393</span>, <span class="number">1708106608620570886942409776179</span>, <span class="number">601827224419797931380408071500</span>, <span class="number">1805481673259393794141224214500</span>, <span class="number">893952418336266652976851386463</span>, <span class="number">2681857255008799958930554159389</span>, <span class="number">3523079163584485147344841221130</span>, <span class="number">1524252287869625983140881149316</span>, <span class="number">50264262166963219975822190911</span>, <span class="number">150792786500889659927466572733</span>, <span class="number">452378359502668979782399718199</span>, <span class="number">1357135078508006939347199154597</span>, <span class="number">4071405235524020818041597463791</span>, <span class="number">3169230503688232995231149877299</span>, <span class="number">462706308180869526799807117823</span>, <span class="number">1388118924542608580399421353469</span>, <span class="number">4164356773627825741198264060407</span>, <span class="number">3448085117999647764701149667147</span>, <span class="number">1299270151115113835209806487367</span>, <span class="number">3897810453345341505629419462101</span>, <span class="number">2648446157152195057994615872229</span>, <span class="number">3422845870014670444537026359650</span>, <span class="number">1223552407160181874717436564876</span>, <span class="number">3670657221480545624152309694628</span>, <span class="number">1966986461557807413563286569810</span>, <span class="number">1378466783231507511243038452393</span>, <span class="number">4135400349694522533729115357179</span>, <span class="number">3361215846199738142293703557463</span>, <span class="number">1038662335715384967987468158315</span>, <span class="number">3115987007146154903962404474945</span>, <span class="number">302975818554635252993570910761</span>, <span class="number">908927455663905758980712732283</span>, <span class="number">2726782366991717276942138196849</span>, <span class="number">3657854499533237101379593333510</span>, <span class="number">1928578295715881845245137486456</span>, <span class="number">1263242285705730806288591202331</span>, <span class="number">3789726857117192418865773606993</span>, <span class="number">2324195368467747797703678306905</span>, <span class="number">2450093503961328663664213663678</span>, <span class="number">2827787910442071261545819733997</span>, <span class="number">3960871129884299055190637944954</span>, <span class="number">2837628186769067706678271320788</span>]</span><br><span class="line">c = <span class="number">31087054322877663244023458448558</span></span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(b)</span><br><span class="line">L = Matrix(ZZ, n+<span class="number">1</span>, n+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    L[i,i] = <span class="number">1</span></span><br><span class="line">    L[i,-<span class="number">1</span>] = b[i]</span><br><span class="line">L[-<span class="number">1</span>,-<span class="number">1</span>] = -c</span><br><span class="line"></span><br><span class="line">res = L.LLL()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n + <span class="number">1</span>):</span><br><span class="line">    M = res.row(i).<span class="built_in">list</span>()</span><br><span class="line">    flag = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> M:</span><br><span class="line">        <span class="keyword">if</span> m != <span class="number">0</span> <span class="keyword">and</span> m != <span class="number">1</span>:</span><br><span class="line">            flag = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> flag:</span><br><span class="line">        e = M</span><br><span class="line"></span><br><span class="line"><span class="comment">#step3 RSA</span></span><br><span class="line">c = <span class="number">156879727064293983713540449709354153986555741467040286464656817265584766312996642691830194777204718013294370729900795379967954637233360644687807499775502507899321601376211142933572536311131955278039722631021587570212889988642265055045777870448827343999745781892044969377246509539272350727171791700388478710290244365826497917791913803035343900620641430005143841479362493138179077146820182826098057144121231954895739989984846588790277051812053349488382941698352320246217038444944941841831556417341663611407424355426767987304941762716818718024107781873815837487744195004393262412593608463400216124753724777502286239464</span></span><br><span class="line">n = p*q</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e)):</span><br><span class="line">    e[i] = <span class="built_in">str</span>(e[i])</span><br><span class="line">e = <span class="string">&quot;&quot;</span>.join(e)[:-<span class="number">1</span>]</span><br><span class="line">e = <span class="built_in">int</span>(e,<span class="number">2</span>)</span><br><span class="line">d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n))))</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flagï¼š</p>
<font color="red">DASCTF{T81I_tPPS_6r7g_xlPi_OO3M_6vyV_Rkba}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="XORè´¯ç©¿å§‹ç»ˆ"><a href="#XORè´¯ç©¿å§‹ç»ˆ" class="headerlink" title="XORè´¯ç©¿å§‹ç»ˆ"></a>XORè´¯ç©¿å§‹ç»ˆ</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä¸€åˆ‡éƒ½æ˜¯æœ‰æ„ä¹‰çš„ï¼Œæ‹¿ä¸‹å®ƒå§ã€‚</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<p>message.txtï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è‡ªç”±å’Œè°å’Œè°å¯Œå¼ºå…¬æ­£å‹å–„çˆ±å›½å…¬æ­£æ³•æ²»æ³•æ²»æ–‡æ˜å’Œè°è‡ªç”±æ³•æ²»è‡ªç”±æ³•æ²»å¹³ç­‰å…¬æ­£å‹å–„å…¬æ­£å…¬æ­£æ°‘ä¸»æ³•æ²»è‡ªç”±å…¬æ­£æ•¬ä¸šå’Œè°å¯Œå¼ºå…¬æ­£å‹å–„çˆ±å›½å’Œè°å¹³ç­‰å¹³ç­‰å‹å–„æ•¬ä¸šæ³•æ²»æ•¬ä¸šå’Œè°å¯Œå¼ºæ³•æ²»å¹³ç­‰å¹³ç­‰å‹å–„æ•¬ä¸šå…¬æ­£å…¬æ­£å…¬æ­£å‹å–„æ•¬ä¸šæ³•æ²»å¹³ç­‰å¹³ç­‰è¯šä¿¡è‡ªç”±å…¬æ­£è‡ªç”±å¹³ç­‰å‹å–„æ•¬ä¸šå…¬æ­£å‹å–„æ³•æ²»å’Œè°å’Œè°</span><br></pre></td></tr></table></figure>
<p>task.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> enflag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = q * p</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">e = getPrime(<span class="number">17</span>)</span><br><span class="line"><span class="keyword">assert</span> gcd(e, phi) == <span class="number">1</span></span><br><span class="line"><span class="comment"># ä»¥ä¸Šä¿¡æ¯ç”Ÿæˆäº†ç§é’¥æ–‡ä»¶,ä½†æ–‡ä»¶è¢«æŸåäº†ä½ èƒ½æå–æœ‰ç”¨ä¿¡æ¯å—</span></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(enflag, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c = &#x27;</span> + <span class="built_in">str</span>(c))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 91817924748361493215143897386603397612753451291462468066632608541316135642691873237492166541761504834463859351830616117238028454453831120079998631107520871612398404926417683282285787231775479511469825932022611941912754602165499500350038397852503264709127650106856760043956604644700201911063515109074933378818</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>pri.pemï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-----BEGIN PRIVATE KEY-----</span><br><span class="line">MIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBALmtMy+2uH1ZtbIL</span><br><span class="line">SuiAukFthyQRH5mp7UmLyzZQkdg9zEP9/5tgffikQ7ytx5kHySHnazgAO1sOzmYE</span><br><span class="line">N4Axlev6uafiP8B1Eij97v5VkYJ1I9e3mtBNheTbXKoT8op+ASQ1fQaF4A8UzLuW</span><br><span class="line">eZeZI8JTH/SH+bolAK3kiZXDFdkTAgMBAAECgYEAl067LaC7Cvs2A5cMPhfYsESv</span><br><span class="line">IgcKN1CwW4Sd3u8dSphhgu7TgyzIuvwxbuo2g1BC6WwKhaI6vGN+csfw6nh98GEn</span><br><span class="line">/p3D0huNroAYvf/DRRB9UnHdttX7wB+Mv3P0RBDWHgBiCDVvHFuFUV78cIs0tnbn</span><br><span class="line">jxjU07aPV2XRC3AfA2ECQQDqWUNPVg3i6vTyHCL7EGkbeUheYpAAfcKCQrxjc5+5</span><br><span class="line">X6A+XtgHAA1JHwykPlCpHUOmlA85DJF1ejuoImzlgRLJAkEAytTCnQF+MN2r1gaA</span><br><span class="line">UETZyj5qMYT7Th8zKEVVVJjDawLnuX4usJ2FyRnjCkk86U75QSJhw5mMc0QnG25u</span><br><span class="line">Gz3++w==</span><br><span class="line">-----END PRIVATE KEY-----</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€å±‚ï¼Œè§£å¼€ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚ç¼–ç å¾—åˆ°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">C0ngr4tulati0n5_y0u_fou^d_m3</span><br></pre></td></tr></table></figure>
<p>ç¬¬äºŒå±‚ï¼Œæ¢å¤ç ´æŸRSAç§é’¥æ–‡ä»¶ï¼Œbase64è§£ç åå¾—åˆ°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">b&#x27;30820277020100300d06092a864886f70d0101010500048202613082025d02010002818100b9ad332fb6b87d59b5b20b4ae880ba416d8724111f99a9ed498bcb365091d83dcc43fdff9b607df8a443bcadc79907c921e76b38003b5b0ece660437803195ebfab9a7e23fc0751228fdeefe5591827523d7b79ad04d85e4db5caa13f28a7e0124357d0685e00f14ccbb9679979923c2531ff487f9ba2500ade48995c315d913020301000102818100974ebb2da0bb0afb3603970c3e17d8b044af22070a3750b05b849ddeef1d4a986182eed3832cc8bafc316eea36835042e96c0a85a23abc637e72c7f0ea787df06127fe9dc3d21b8dae8018bdffc345107d5271ddb6d5fbc01f8cbf73f44410d61e006208356f1c5b85515efc708b34b676e78f18d4d3b68f5765d10b701f0361024100ea59434f560de2eaf4f21c22fb10691b79485e6290007dc28242bc63739fb95fa03e5ed807000d491f0ca43e50a91d43a6940f390c91757a3ba8226ce58112c9024100cad4c29d017e30ddabd606805044d9ca3e6a3184fb4e1f332845555498c36b02e7b97e2eb09d85c919e30a493ce94ef9412261c3998c7344271b6e6e1b3dfefb&#x27;</span><br></pre></td></tr></table></figure>
<p>æŒ‰ç…§RSAç§é’¥æ ¼å¼è¿˜åŸï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">n 028181 00b9ad332fb6b87d59b5b20b4ae880ba416d8724111f99a9ed498bcb365091d83dcc43fdff9b607df8a443bcadc79907c921e76b38003b5b0ece660437803195ebfab9a7e23fc0751228fdeefe5591827523d7b79ad04d85e4db5caa13f28a7e0124357d0685e00f14ccbb9679979923c2531ff487f9ba2500ade48995c315d913</span><br><span class="line">e 0203 010001</span><br><span class="line">d 028181 00974ebb2da0bb0afb3603970c3e17d8b044af22070a3750b05b849ddeef1d4a986182eed3832cc8bafc316eea36835042e96c0a85a23abc637e72c7f0ea787df06127fe9dc3d21b8dae8018bdffc345107d5271ddb6d5fbc01f8cbf73f44410d61e006208356f1c5b85515efc708b34b676e78f18d4d3b68f5765d10b701f0361</span><br><span class="line">p 0241 00ea59434f560de2eaf4f21c22fb10691b79485e6290007dc28242bc63739fb95fa03e5ed807000d491f0ca43e50a91d43a6940f390c91757a3ba8226ce58112c9</span><br><span class="line">q 0241 00cad4c29d017e30ddabd606805044d9ca3e6a3184fb4e1f332845555498c36b02e7b97e2eb09d85c919e30a493ce94ef9412261c3998c7344271b6e6e1b3dfefb&quot;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œç§é’¥ä¸­çš„dpã€dqä»¥åŠinv(q,p)æŸåäº†ï¼Œä½†æ˜¯å‰©ä¸‹çš„å€¼å·²ç»è¶³å¤Ÿç”¨äºRSAè§£å¯†ï¼Œå› æ­¤æ­£å¸¸è§£å¯†å³å¯å¾—åˆ°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DASCTF&#123;0e287wQ\x08R\x17\x00FGXYFZ\x07V\x03kIUCn\x02VDg\x01f\x0cN</span><br></pre></td></tr></table></figure>
<p>å‘ç°é¢˜ç›®æè¿°XORè¿˜æ²¡ç”¨ä¸Šï¼Œå°†ç¬¬ä¸€æ­¥ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚è§£å¯†å¾—åˆ°çš„ä¸²ç”¨äºå¼‚æˆ–å³å¯ã€‚</p>
<p>å¾—åˆ°flagï¼š</p>
<font color="red">DASCTF{0e2874af5e422482378640e61d919e9a}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ€»ä½“éš¾åº¦ç¡®å®ä¸å¤§ï¼Œä½†æ˜¯æ€ä¹ˆè¯´å‘¢ï¼Œé¢˜ç›®æœ‰ç‚¹å‘ï¼Œè‡ªå·±èƒ½åŠ›ä¹Ÿè¿˜å­˜åœ¨ä¸è¶³ï¼Œä¸‹æ¬¡åŠ æ²¹å§ã€‚</p>
]]></content>
      <categories>
        <category>wp-crypto</category>
      </categories>
  </entry>
  <entry>
    <title>2023-SICTF-#Round2-wp-crypto</title>
    <url>/post/445800a5.html</url>
    <content><![CDATA[<span id="more"></span>
<p>è¿™æ¬¡æ¯”èµ›Cryptoéš¾åº¦æ¯”è¾ƒåŸºç¡€ï¼Œæ‰‹é€Ÿå¿«æ‰æ˜¯ç¡¬é“ç†ã€‚</p>
<p>Rankï¼š2</p>
<p><img src="/post/445800a5/image-20230911152911874.png" alt="image-20230911152911874"></p>
<p><br></p>
<p><br></p>
<h3 id="ç­¾åˆ°-å¤å…¸å¤§æ‚çƒ©"><a href="#ç­¾åˆ°-å¤å…¸å¤§æ‚çƒ©" class="headerlink" title="[ç­¾åˆ°]å¤å…¸å¤§æ‚çƒ©"></a>[ç­¾åˆ°]å¤å…¸å¤§æ‚çƒ©</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¯·å°è¯•è§£å¯†å®ƒã€‚</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ğŸ©ğŸ‘ƒğŸªğŸ¼ğŸ‘…ğŸ¯ğŸ©ğŸ‘ˆğŸ‘‡ğŸ‘­ğŸ‘ŸğŸ‘ğŸºğŸ­ğŸ‘‰ğŸ‘™ğŸ‘¤ğŸ‘‹ğŸ‘šğŸªğŸ«ğŸ‘ğŸ‘¢ğŸ‘®ğŸ‘±ğŸ¼ğŸ‘¢ğŸ‘¨ğŸ‘ ğŸ‘­ğŸ½ğŸ°ğŸ»ğŸ‘šğŸ‘‚ğŸ‘§ğŸ‘ ğŸ‘¥ğŸ‘›ğŸ‘®ğŸ‘¯ğŸ‘®ğŸ‘¬ğŸ¾ğŸ‘ğŸ‘›ğŸ‘ŒğŸ‘šğŸ‘ğŸ¨ğŸ‘ğŸ‘‰ğŸ‘†ğŸ¿ğŸ‘†ğŸ‘˜ğŸ‘‡ğŸºğŸ‘¦ğŸ¸ğŸ‘ƒğŸ­ğŸ‘ŸğŸ‘‘ğŸ‘ªğŸ‘ƒğŸ‘ğŸ»ğŸ»ğŸ‘œğŸ§ğŸ‘‡ğŸ‘ŠğŸ§ğŸ¾ğŸ¼ğŸ‘‡ğŸ«ğŸºğŸ‘ğŸ‘†ğŸ‘ªğŸ¼ğŸ‘‹ğŸ‘ŒğŸ‘§ğŸ»ğŸ‘ğŸ©ğŸºğŸ‘¥ğŸ½ğŸ‘‹ğŸ‘‰ğŸ°ğŸ‘ğŸ‘ ğŸ‘ ğŸ‘£ğŸ§ğŸ«ğŸ‘§ğŸ­ğŸ‘¢ğŸ¯ğŸ‘‘ğŸ‘‘ğŸ®ğŸ‘‚ğŸ‘ğŸ»ğŸ‘¥ğŸ‘šğŸ®ğŸ‘‹ğŸ‘¬ğŸ‘ŒğŸ‘¥ğŸ‘ğŸ‘£ğŸ‘…ğŸ‘§ğŸ‘¯ğŸ‘¦ğŸ‘ŒğŸ‘ŒğŸ‘ğŸ‘ ğŸ‘ŒğŸ½ğŸ‘‰ğŸ‘ƒğŸ‘ŠğŸ«ğŸ‘‰ğŸ¨ğŸ®ğŸ‘©ğŸ‘†ğŸªğŸ¯ğŸ‘˜ğŸ‘ğŸ‘ğŸ¼ğŸ‘©ğŸ‘ğŸ‘ŠğŸ‘ğŸ‘¡ğŸ‘€ğŸ‘°ğŸ‘‹ğŸ‘£ğŸ‘¨ğŸ‘§ğŸ‘ğŸ‘œğŸ‘ğŸ‘›ğŸ®ğŸ‘˜ğŸ‘…ğŸ‘ ğŸ¿ğŸ‘‚ğŸ‘°ğŸ‘„ğŸ‘ˆğŸ‘ğŸ‘ ğŸ‘¤ğŸ‘ƒğŸ‘›ğŸ‘˜ğŸ­ğŸ‘…ğŸ‘±ğŸ‘†ğŸ‘¬ğŸ‘«ğŸ‘¥ğŸ‘†ğŸ½ğŸ‘ğŸ‘ğŸ‘¥ğŸ‘ŠğŸ‘‡ğŸ‘‰ğŸ‘ŠğŸ‘©ğŸ‘ŒğŸ‘­ğŸ«ğŸ«ğŸ‘¬ğŸ‘±ğŸ¯ğŸ‘‡ğŸºğŸ‘ğŸ‘ğŸ‘‘ğŸ‘™ğŸ®ğŸ‘œğŸ‘‹ğŸ‘˜ğŸ‘ªğŸ‘©ğŸ‘šğŸ‘¦ğŸ‘¨ğŸ‘€ğŸ‘©ğŸ‘ğŸ‘‰ğŸ‘ƒğŸ¾ğŸ‘¥ğŸ‘€ğŸ«ğŸ‘ğŸ‘ğŸ©ğŸ§ğŸ‘°ğŸ‘†ğŸ‘‡ğŸ‘¨ğŸªğŸ‘ƒğŸ­ğŸ‘¦ğŸ«ğŸ‘±</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€å±‚å¾ˆæ˜æ˜¾æ˜¯base100ï¼Œä¹‹åçš„æ¯ä¸€å±‚åƒå“ªä¸ªbaseç”¨å“ªä¸ªè§£å¯†å³å¯ï¼š</p>
<p>1ã€ base100ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2L3EN82QPvhfC6RbmTc34VkwzEkqivF9DcKpindwxwuGYdUcg1XROHOaPCoAL6hZsLJDDe0PS0GEP4CYOsETUpDY2CnFTR9Wiil04p6k8ZZ7KXDnc7TuUnJlNpxoUUViUFRLS4R17rO38aXXErVSVjIyTlqpVeYd7aNiHKyMQfimLda6NzOutnOFJYnSPRSrUv44uz8PCJgZb7eTasrcoqIrYRLGnI4fV20yOPq3L6o4z</span><br></pre></td></tr></table></figure>
<p>2ã€ base62ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">UlhoYUdxZTdaY1FCbXFyaWl5S0ZKaW4yN2ZiWkpTZHhOd2hBVk1wNzRvUWE0VWs2RXVqTlpkTHNvYVpxNHRMUDd3dXk4OGJiSlhlTGJnN2dxR2RkTm15dGs1S1RGdlk3TmpRR0wzenFrQ3BCM3lmUTFTUkY0OU13Z0JjZkFxWjFhNng=</span><br></pre></td></tr></table></figure>
<p>3ã€base64ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">RXhaGqe7ZcQBmqriiyKFJin27fbZJSdxNwhAVMp74oQa4Uk6EujNZdLsoaZq4tLP7wuy88bbJXeLbg7gqGddNmytk5KTFvY7NjQGL3zqkCpB3yfQ1SRF49MwgBcfAqZ1a6x</span><br></pre></td></tr></table></figure>
<p>4ã€ base58ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">G53XC4LIK5DWQ53UIFSGCUTCJFCGM4DSM5UXOYTILBUXU6TXJ5SUUT2DONHTQZ3GJNCFSUDINRXE6MTEINUXOQLVLI4VU===</span><br></pre></td></tr></table></figure>
<p>5ã€ base32ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">7wqqhWGhwtAdaRbIDfprgiwbhXizzwOeJOCsO8gfKDYPhlnO2dCiwAuZ9Z</span><br></pre></td></tr></table></figure>
<p>6ã€base62ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SICTF&#123;fe853b49-8730-462e-86f5-fc8e9789f077&#125;</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>SICTF{fe853b49-8730-462e-86f5-fc8e9789f077}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="Radio"><a href="#Radio" class="headerlink" title="Radio"></a>Radio</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ ‘æœ¨æ–°å¼€å‘äº†ä¸€ä¸ªåŠ å¯†ç³»ç»Ÿï¼Œè¿™ä¸ªç³»ç»Ÿä¼šæŠŠä»–çš„ç§˜å¯†åŠ å¯†å¾ˆå¤šæ¬¡ç„¶åå‘é€ç»™ä¸åŒçš„ç”¨æˆ·ï¼Œä½ èƒ½æ‰¾åˆ°å…¶ä¸­çš„æ¼æ´å—ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n1 = p * q</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n2 = p * q</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n3 = p * q</span><br><span class="line">e = <span class="number">17</span></span><br><span class="line">c1 = <span class="built_in">pow</span>(m,e,n1)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m,e,n2)</span><br><span class="line">c3 = <span class="built_in">pow</span>(m,e,n3)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n1 =&quot;</span>,n1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n2 =&quot;</span>,n2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n3 =&quot;</span>,n3)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c1 =&quot;</span>,c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c2 =&quot;</span>,c2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c3 =&quot;</span>,c3)</span><br></pre></td></tr></table></figure>
<p>ç»å…¸çš„å¹¿æ’­æ”»å‡»ï¼Œæ€è·¯å°±æ˜¯ä½¿ç”¨ä¸­å›½å‰©ä½™å®šç†å¾—åˆ°$\quad mod \; (n1n2n3)\quad$ä¸‹çš„$\quad m^{17}\quad$ï¼Œå†å¼€17æ¬¡æ–¹æ ¹å³å¯ã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt </span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n1 = </span><br><span class="line">n2 = </span><br><span class="line">n3 = </span><br><span class="line">c1 = </span><br><span class="line">c2 = </span><br><span class="line">c3 = </span><br><span class="line">e = <span class="number">17</span></span><br><span class="line"></span><br><span class="line">n = [n1,n2,n3]</span><br><span class="line">c = [c1,c2,c3]</span><br><span class="line">M = crt(n,c)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(iroot(M,<span class="number">17</span>)[<span class="number">0</span>]))</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>SICTF{fdc0afb5-1c81-46b9-a28a-241f5f64419d}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="MingTianPao"><a href="#MingTianPao" class="headerlink" title="MingTianPao"></a>MingTianPao</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">è¿™ä¸ªé¢˜ç›®åå……åˆ†è¡¨ç°äº†ä½œè€…ç”±äºå­¦CTFå¯¼è‡´åƒä¸ä¸Šé¥­ï¼Œæ˜å¤©å°±æ‰“ç®—è·‘è·¯çš„å¿ƒé‡Œæƒ³æ³•ã€‚</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, message</span><br><span class="line"><span class="comment"># message is a Classic English Story</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    tmp = (message[i*<span class="number">30</span>:(i+<span class="number">1</span>)*<span class="number">30</span>].encode())</span><br><span class="line">    <span class="built_in">print</span>(binascii.hexlify(strxor(tmp,flag)).decode())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1f2037202a1e6d06353b61263d050a0538493b3018544e14171d2b1c4218</span></span><br><span class="line"><span class="comment"># 3769373b66142f31297f291126410e042b01162d59103a0c005221075013</span></span><br><span class="line"><span class="comment"># 37242c202e1e3f743c36371130410c1e2b491a31574406014505291a550e</span></span><br><span class="line"><span class="comment"># 7f6922742e1a213270372e01264105193004532b1f554e120c1e2a145618</span></span><br><span class="line"><span class="comment"># 7d69143c23156d18392b35183141310e3b49213613590003453a291a555d</span></span><br><span class="line"><span class="comment"># 36273731341e297424372454230e0c0f2c49127f005f020245112718545d</span></span><br><span class="line"><span class="comment"># 26396320295b2531227161273c04430f360d533118444e0f0b1d31554615</span></span><br><span class="line"><span class="comment"># 323d6335660c24373b3a2554350f0a063e05533712101905165e66145f19</span></span><br><span class="line"><span class="comment"># 733e222766152220703e27063508074b300f53371e5d40444735291a555d</span></span><br><span class="line"><span class="comment"># 37283a7432146d2d3f2a6d541808171f330c530d12544e360c162f1b565d</span></span><br></pre></td></tr></table></figure>
<p>å¾ˆæ˜ç¡®çš„ä¸€ä¸ªMany-Time-Padï¼Œä¹Ÿå¯¹åº”äº†é¢˜ç›®åå­—MTPï¼Œé¢„æœŸæ¥è¯´åº”è¯¥æ˜¯ä¸Šä¸€ä¸ªçŸ¥åMTPè„šæœ¬æ±‚è§£ã€‚</p>
<p>ä½†æ˜¯å…¶å®å®Œå…¨ä¸éœ€è¦ï¼Œå› ä¸ºé¢˜ç›®ç»™äº†è¿™æ ·ä¸€ä¸ªæç¤ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># message is a Classic English Story</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬åˆæœ‰flagçš„å‰å…­ä¸ªå­—ç¬¦ï¼š<strong>SICTF{</strong></p>
<p>é‚£ä¹ˆæ‹¿å»å¼‚æˆ–ä¸€ä¸‹å°±æœ‰ï¼š</p>
<p><img src="/post/445800a5/image-20230908224043439.png" alt="image-20230908224043439"></p>
<p>åˆç†çŒœæµ‹è¿™æ˜¯ä¸€ä¸ªLittleå¼€å¤´çš„è‹±è¯­æ•…äº‹ï¼Œé‚£ä¹ˆç”±äºå¼‚æˆ–çš„å¯é€†æ€§ï¼Œç›´æ¥æŠŠå¯†æ–‡æ¬ä¸Šæ˜æ–‡çš„ä½ç½®ï¼Œæ¥è¯•å‡ ä¸ªï¼š</p>
<p>Little Princeï¼ˆå°ç‹å­ï¼‰ï¼š</p>
<p><img src="/post/445800a5/image-20230908224223829.png" alt="image-20230908224223829"></p>
<p>ä¸å¤ªå¯¹ï¼Œæ¢ä¸€ä¸ªï¼ŒLittle Red Riding Hoodï¼š</p>
<p><img src="/post/445800a5/image-20230908224336581.png" alt="image-20230908224336581"></p>
<p>è¿™å°±æˆäº†ï¼Œåˆå¯ä»¥çœ‹å‡ºflagä¸²åé¢åº”è¯¥æ˜¯wonderfulçš„å˜å½¢ï¼Œé‚£ä¹ˆå†æŠŠflagä¸²æ¬ä¸Šæ¥é€ä¸ªå°è¯•å³å¯ï¼šï¼ˆå› ä¸ºå¯ä»¥å˜çš„å…¶å®å°±å¤§å°å†™ã€ä»¥åŠå½¢è¿‘æ•°å­—ï¼Œä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªå­—ç¬¦å¢åŠ ï¼Œè¯•å‡ æ¬¡å°±å‡ºæ¥äº†ï¼‰ï¼š</p>
<p><img src="/post/445800a5/image-20230908224509359.png" alt="image-20230908224509359"></p>
<p>flagï¼š</p>
<p><strong>SICTF{MTP_AtTack_is_w0nderFu1}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="Easy-CopperSmith"><a href="#Easy-CopperSmith" class="headerlink" title="Easy_CopperSmith"></a>Easy_CopperSmith</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä½ çŸ¥é“CopperSmithå—ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">leak = p &gt;&gt; <span class="number">230</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(leak)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">114007680041157617250208809154392208683967639953423906669116998085115503737001019559692895227927818755160444076128820965038044269092587109196557720941716578025622244634385547194563001079609897387390680250570961313174656874665690193604984942452581886657386063927035039087208310041149977622001887997061312418381</span></span><br><span class="line"><span class="string">6833525680083767201563383553257365403889275861180069149272377788671845720921410137177</span></span><br><span class="line"><span class="string">87627846271126693177889082381507430884663777705438987267317070845965070209704910716182088690758208915234427170455157948022843849997441546596567189456637997191173043345521331111329110083529853409188141263211030032553825858341099759209550785745319223409181813931086979471131074015406202979668575990074985441810</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>ç›´ç™½çš„pé«˜ä½æ³„æ¼ï¼Œç›´æ¥è§£å¯†å³å¯ã€‚</p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">114007680041157617250208809154392208683967639953423906669116998085115503737001019559692895227927818755160444076128820965038044269092587109196557720941716578025622244634385547194563001079609897387390680250570961313174656874665690193604984942452581886657386063927035039087208310041149977622001887997061312418381</span></span><br><span class="line">p4 = <span class="number">6833525680083767201563383553257365403889275861180069149272377788671845720921410137177</span></span><br><span class="line">c = <span class="number">87627846271126693177889082381507430884663777705438987267317070845965070209704910716182088690758208915234427170455157948022843849997441546596567189456637997191173043345521331111329110083529853409188141263211030032553825858341099759209550785745319223409181813931086979471131074015406202979668575990074985441810</span></span><br><span class="line">e =  <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">pbits = <span class="number">512</span></span><br><span class="line">kbits=pbits - p4.nbits()</span><br><span class="line">p4 = p4 &lt;&lt; kbits</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x + p4</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^kbits,beta=<span class="number">0.4</span>,epsilon = <span class="number">0.01</span>)</span><br><span class="line"><span class="comment"># ç»è¿‡ä»¥ä¸Šä¸€äº›å‡½æ•°å¤„ç†åï¼Œnå’Œpå·²ç»è¢«è½¬åŒ–ä¸º10è¿›åˆ¶</span></span><br><span class="line"><span class="keyword">if</span> roots:</span><br><span class="line">    p= p4 + <span class="built_in">int</span>(roots[<span class="number">0</span>])</span><br><span class="line">    q = n//p</span><br><span class="line">d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>SICTF{3f9366ed-b8e4-412f-bbd0-62616a24115c}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="ç­¾åˆ°é¢˜æ¥å’¯ï¼"><a href="#ç­¾åˆ°é¢˜æ¥å’¯ï¼" class="headerlink" title="ç­¾åˆ°é¢˜æ¥å’¯ï¼"></a>ç­¾åˆ°é¢˜æ¥å’¯ï¼</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç­¾åˆ°é¢˜æ¥å’¯ï¼</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span>  Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">e = getPrime(<span class="number">10</span>)</span><br><span class="line">n = p*q</span><br><span class="line">c1 = <span class="built_in">pow</span>(<span class="number">114</span>*m+<span class="number">2333</span>,e,n)</span><br><span class="line">c2 = <span class="built_in">pow</span>(<span class="number">514</span>*m+<span class="number">4555</span>,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c1 = <span class="subst">&#123;c1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c2 = <span class="subst">&#123;c2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 18993579800590288733556762316465854395650778003397512624355925069287661487515652428099677335464809283955351330659278915073219733930542167360381688856732762552737791137784222098296804826261681852699742456526979985201331982720936091963830799430264680941164508709453794113576607749669278887105809727027129736803614327631979056934906547015919204770702496676692691248702461766117271815398943842909579917102217310779431999448597899109808086655029624478062317317442297276087073653945439820988375066353157221370129064423613949039895822016206336117081475698987326594199181180346821431242733826487765566154350269651592993856883</span></span><br><span class="line"><span class="string">c1 = 3089900890429368903963127778258893993015616003863275300568951378177309984878857933740319974151823410060583527905656182419531008417050246901514691111335764182779077027419410717272164998075313101695833565450587029584857433998627248705518025411896438130004108810308599666206694770859843696952378804678690327442746359836105117371144846629293505396610982407985241783168161504309420302314102538231774470927864959064261347913286659384383565379900391857812482728653358741387072374314243068833590379370244368317200796927931678203916569721211768082289529948017340699194622234734381555103898784827642197721866114583358940604520</span></span><br><span class="line"><span class="string">c2 = 6062491672599671503583327431533992487890060173533816222838721749216161789662841049274959778509684968479022417053571624473283543736981267659104310293237792925201009775193492423025040929132360886500863823523629213703533794348606076463773478200331006341206053010168741302440409050344170767489936681627020501853981450212305108039373119567034948781143698613084550376070802084805644270376620484786155554275798939105737707005991882264123315436368611647275530607811665999620394422672764116158492214128572456571553281799359243174598812137554860109807481900330449364878168308833006964726761878461761560543284533578701661413931</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>ç»å…¸çš„æ˜æ–‡ç›¸å…³æ¶ˆæ¯æ”»å‡»ï¼Œç•¥åšäº†ä¸€ç‚¹å˜ç§ã€‚æ€è·¯å¦‚ä¸‹ï¼Œåˆ—å‡ºä¸¤ä¸ªå¤šé¡¹å¼ï¼š</p>
<script type="math/tex; mode=display">
(114*x+2333)^{e}\equiv c1\quad (mod\;n)</script><script type="math/tex; mode=display">
(514*x+4555)^{e}\equiv c2\quad (mod\;n)</script><p>åˆå› ä¸ºæ˜æ–‡mæ˜¾ç„¶æ˜¯ä¸¤ä¸ªæ¨¡å¤šé¡¹å¼çš„æ ¹ï¼Œå› æ­¤ä¸¤ä¸ªæ¨¡å¤šé¡¹å¼æœ‰å…¬å› å­ï¼š</p>
<script type="math/tex; mode=display">
(x-m)</script><p>å› æ­¤æ„é€ å‡ºæ¨¡nç¯ä¸‹çš„ä¸¤ä¸ªå¤šé¡¹å¼ï¼Œå¹¶æ±‚å…¬å› å¼å³å¯ã€‚è‡³äºeæ˜¯å¤šå°‘ï¼Œä»…éœ€è¦åœ¨æŒ‡å®šèŒƒå›´å†…çˆ†ç ´ä¸€ä¸‹å°±å¯ä»¥ã€‚</p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">18993579800590288733556762316465854395650778003397512624355925069287661487515652428099677335464809283955351330659278915073219733930542167360381688856732762552737791137784222098296804826261681852699742456526979985201331982720936091963830799430264680941164508709453794113576607749669278887105809727027129736803614327631979056934906547015919204770702496676692691248702461766117271815398943842909579917102217310779431999448597899109808086655029624478062317317442297276087073653945439820988375066353157221370129064423613949039895822016206336117081475698987326594199181180346821431242733826487765566154350269651592993856883</span></span><br><span class="line">c1 = <span class="number">3089900890429368903963127778258893993015616003863275300568951378177309984878857933740319974151823410060583527905656182419531008417050246901514691111335764182779077027419410717272164998075313101695833565450587029584857433998627248705518025411896438130004108810308599666206694770859843696952378804678690327442746359836105117371144846629293505396610982407985241783168161504309420302314102538231774470927864959064261347913286659384383565379900391857812482728653358741387072374314243068833590379370244368317200796927931678203916569721211768082289529948017340699194622234734381555103898784827642197721866114583358940604520</span></span><br><span class="line">c2 = <span class="number">6062491672599671503583327431533992487890060173533816222838721749216161789662841049274959778509684968479022417053571624473283543736981267659104310293237792925201009775193492423025040929132360886500863823523629213703533794348606076463773478200331006341206053010168741302440409050344170767489936681627020501853981450212305108039373119567034948781143698613084550376070802084805644270376620484786155554275798939105737707005991882264123315436368611647275530607811665999620394422672764116158492214128572456571553281799359243174598812137554860109807481900330449364878168308833006964726761878461761560543284533578701661413931</span></span><br><span class="line">a1 = <span class="number">114</span></span><br><span class="line">b1 = <span class="number">2333</span></span><br><span class="line">a2 = <span class="number">514</span></span><br><span class="line">b2 = <span class="number">4555</span></span><br><span class="line">elist = [<span class="number">521</span>,<span class="number">523</span>,<span class="number">541</span>,<span class="number">547</span>,<span class="number">557</span>,<span class="number">563</span>,<span class="number">569</span>,<span class="number">571</span>,<span class="number">577</span>,<span class="number">587</span>,<span class="number">593</span>,<span class="number">599</span>,<span class="number">601</span>,<span class="number">607</span>,<span class="number">613</span>,<span class="number">617</span>,<span class="number">619</span>,<span class="number">631</span>,<span class="number">641</span>,<span class="number">643</span>,<span class="number">647</span>,<span class="number">653</span>,<span class="number">659</span>,<span class="number">661</span>,<span class="number">673</span>,<span class="number">677</span>,<span class="number">683</span>,<span class="number">691</span>,<span class="number">701</span>,<span class="number">709</span>,<span class="number">719</span>,<span class="number">727</span>,<span class="number">733</span>,<span class="number">739</span>,<span class="number">743</span>,<span class="number">751</span>,<span class="number">757</span>,<span class="number">761</span>,<span class="number">769</span>,<span class="number">773</span>,<span class="number">787</span>,<span class="number">797</span>,<span class="number">809</span>,<span class="number">811</span>,<span class="number">821</span>,<span class="number">823</span>,<span class="number">827</span>,<span class="number">829</span>,<span class="number">839</span>,<span class="number">853</span>,<span class="number">857</span>,<span class="number">859</span>,<span class="number">863</span>,<span class="number">877</span>,<span class="number">881</span>,<span class="number">883</span>,<span class="number">887</span>,<span class="number">907</span>,<span class="number">911</span>,<span class="number">919</span>,<span class="number">929</span>,<span class="number">937</span>,<span class="number">941</span>,<span class="number">947</span>,<span class="number">953</span>,<span class="number">967</span>,<span class="number">971</span>,<span class="number">977</span>,<span class="number">983</span>,<span class="number">991</span>,<span class="number">997</span>,<span class="number">1009</span>,<span class="number">1013</span>,<span class="number">1019</span>,<span class="number">1021</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>(<span class="params">c1, c2, e, n</span>):</span><br><span class="line">    PR.&lt;x&gt;=PolynomialRing(Zmod(n))</span><br><span class="line">    g1 = (a1*x + b1)^e - c1</span><br><span class="line">    g2 = (a2*x + b2)^e - c2</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">g1, g2</span>):</span><br><span class="line">        <span class="keyword">while</span> g2:</span><br><span class="line">            g1, g2 = g2, g1 % g2</span><br><span class="line">        <span class="keyword">return</span> g1.monic()</span><br><span class="line">    <span class="keyword">return</span> -gcd(g1, g2)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> elist:</span><br><span class="line">    m1 = attack(c1, c2, e, n)</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">b&quot;SICTF&quot;</span> <span class="keyword">in</span> long_to_bytes(<span class="built_in">int</span>(m1))):</span><br><span class="line">        flag = long_to_bytes(<span class="built_in">int</span>(m1))</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>SICTF{hhh!!franklin_reiter_is_easy}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="small-e"><a href="#small-e" class="headerlink" title="small_e"></a>small_e</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¿™ä¸ªä½åŠ å¯†æŒ‡æ•°æ”»å‡»ä¸ºä»€ä¹ˆæ‰“ä¸å‡ºæ¥å“‡ï¼Ÿæ˜¯ä¸æ˜¯é¢˜æœ‰é—®é¢˜æï¼Ÿå·®è¯„ï¼</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line">flag=<span class="string">&quot;SICTF&#123;&quot;</span>+<span class="built_in">str</span>(uuid.uuid4())+<span class="string">&quot;&#125;&quot;</span></span><br><span class="line">m=libnum.s2n(flag)</span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line">n=p*q</span><br><span class="line">e=<span class="number">3</span></span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line">m1=((m&gt;&gt;<span class="number">60</span>)&lt;&lt;<span class="number">60</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e=&quot;</span>,e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;((m&gt;&gt;60)&lt;&lt;60)=&quot;</span>,m1)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n= 23407088262641313744603678186127228163189328033499381357614318160776774708961658114505773173784501557046914457908828086210961235530240151825359345210845219656000760996670856300710703016947799649686427460688236465568188205550456293373157997725204643414082796492333552579250010906010553831060540937802882205118399938918764313169385349293602085310111289583058965780887097301702677087443291977479125263301000328313103296364864396361278863921717374909215078711198899810620522933994481419395021233240234478331179727351050575360886334237633420906629984625441302945112631166021776379103081857393866576659121443879590011160797</span></span><br><span class="line"><span class="string">e= 3</span></span><br><span class="line"><span class="string">c= 1584727211980974717747362694412040878682966138197627512650829607105625096823456063149392973232737929737200028676411430124019573130595696272668927725536797627059576270068695792221537212669276826952363636924278717182163166234322320044764324434683614360641636360301452618063418349310497430566465329766916213742181</span></span><br><span class="line"><span class="string">((m&gt;&gt;60)&lt;&lt;60)= 11658736990073967239197168945911788935424691658202162501032766529463315401599017877851823976178979438592</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>å·²çŸ¥æ˜æ–‡é«˜ä½æ”»å‡»ï¼Œç›´æ¥ä¸Šè„šæœ¬ã€‚</p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n= <span class="number">23407088262641313744603678186127228163189328033499381357614318160776774708961658114505773173784501557046914457908828086210961235530240151825359345210845219656000760996670856300710703016947799649686427460688236465568188205550456293373157997725204643414082796492333552579250010906010553831060540937802882205118399938918764313169385349293602085310111289583058965780887097301702677087443291977479125263301000328313103296364864396361278863921717374909215078711198899810620522933994481419395021233240234478331179727351050575360886334237633420906629984625441302945112631166021776379103081857393866576659121443879590011160797</span></span><br><span class="line">e= <span class="number">3</span></span><br><span class="line">c= <span class="number">1584727211980974717747362694412040878682966138197627512650829607105625096823456063149392973232737929737200028676411430124019573130595696272668927725536797627059576270068695792221537212669276826952363636924278717182163166234322320044764324434683614360641636360301452618063418349310497430566465329766916213742181</span></span><br><span class="line">m= <span class="number">11658736990073967239197168945911788935424691658202162501032766529463315401599017877851823976178979438592</span></span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = (m + x)^e - c</span><br><span class="line">f = f.monic()</span><br><span class="line">roots = f.small_roots()</span><br><span class="line"></span><br><span class="line">m = m + <span class="built_in">int</span>(roots[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>SICTF{2ca8e589-4a31-4909-80f0-9ecfc8f8cb37}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="easy-math"><a href="#easy-math" class="headerlink" title="easy_math"></a>easy_math</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å…¶å®æ•°å­¦å¾ˆç®€å•è¾£ï¼</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span>  Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">hint1 = getPrime(<span class="number">13</span>)*p+getPrime(<span class="number">256</span>)*q</span><br><span class="line">hint2 = getPrime(<span class="number">13</span>)*p+getPrime(<span class="number">256</span>)*q</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;hint1 = <span class="subst">&#123;hint1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;hint2 = <span class="subst">&#123;hint2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 68123067052840097285002963401518347625939222208495512245264898037784706226045178539672509359795737570458454279990340789711761542570505016930986418403583534761200927746744298082254959321108829717070206277856970403191060311901559017372393931121345743640657503994132925993800497309703877076541759570410784984067</span></span><br><span class="line"><span class="string">hint1 = 564294243979930441832363430202216879765636227726919016842676871868826273613344463155168512928428069316237289920953421495330355385445649203238665802121198919543532254290185502622234014832349396422316629991217252686524462096711723580</span></span><br><span class="line"><span class="string">hint2 = 484307144682854466149980416084532076579378210225500554261260145338511061452958092407101769145891750844383042274498826787696953308289632616886162073232218214504005935332891893378072083589751354946391146889055039887781077066257013110</span></span><br><span class="line"><span class="string">c = 57751903193610662622957432730720223801836323458721550133101805763463060486486266309568004721657732742899781400754207249733137375171400440423755473421971160000575072519031824740691618617905549725344323721903857290320737224300672847773455169809689188843070599176261204013341324705808617411345132933937680951713</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>æ³¨æ„åˆ°hint1ã€hint2çš„ç”Ÿæˆè¿‡ç¨‹ï¼š</p>
<script type="math/tex; mode=display">
hint1 = a1*p+b1*q</script><script type="math/tex; mode=display">
hint2 = a2*p+b2*q</script><p>è€Œpå‰çš„ç³»æ•°a1ã€a2å¾ˆå°ï¼Œå› æ­¤å¯ä»¥å…ˆæ‰“å°å‡ºæ‰€æœ‰13æ¯”ç‰¹çš„ç´ æ•°å­˜åœ¨ä¸€å¼ è¡¨å†…ï¼Œä½œä¸ºa1ã€a2çš„æ‰€æœ‰å¯èƒ½å–å€¼ï¼Œç„¶åå¦‚ä¸‹æ“ä½œï¼š</p>
<script type="math/tex; mode=display">
a2*hint1-a1*hint2=a2*(a1*p+b1*q) - a1*(a2*p+b2*q)=(a2*b1-a1*b2)*q</script><p>ä¸næ±‚gcdå³å¯å¾—åˆ°qï¼Œä¹‹åè¿›è¡ŒRSAè§£å¯†å³å¯ã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span>  Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">68123067052840097285002963401518347625939222208495512245264898037784706226045178539672509359795737570458454279990340789711761542570505016930986418403583534761200927746744298082254959321108829717070206277856970403191060311901559017372393931121345743640657503994132925993800497309703877076541759570410784984067</span></span><br><span class="line">hint1 = <span class="number">564294243979930441832363430202216879765636227726919016842676871868826273613344463155168512928428069316237289920953421495330355385445649203238665802121198919543532254290185502622234014832349396422316629991217252686524462096711723580</span></span><br><span class="line">hint2 = <span class="number">484307144682854466149980416084532076579378210225500554261260145338511061452958092407101769145891750844383042274498826787696953308289632616886162073232218214504005935332891893378072083589751354946391146889055039887781077066257013110</span></span><br><span class="line">c = <span class="number">57751903193610662622957432730720223801836323458721550133101805763463060486486266309568004721657732742899781400754207249733137375171400440423755473421971160000575072519031824740691618617905549725344323721903857290320737224300672847773455169809689188843070599176261204013341324705808617411345132933937680951713</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">primelist = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">12</span>,<span class="number">2</span>**<span class="number">13</span>) <span class="keyword">if</span> isPrime(i)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> primelist:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> primelist:</span><br><span class="line">        <span class="keyword">if</span>(GCD(hint1*i - hint2*j,n) != <span class="number">1</span>):</span><br><span class="line">            q = GCD(hint1*i - hint2*j,n)</span><br><span class="line">p = n//q</span><br><span class="line">d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>SICTF{452aebb6-9c16-441a-ac42-fc608bf6063f}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>è¶Šç†Ÿç»ƒæ‰‹é€Ÿå°±ä¼šè¶Šå¿«ï¼Œç»§ç»­åŠªåŠ›ï¼</p>
]]></content>
      <categories>
        <category>wp-crypto</category>
      </categories>
  </entry>
  <entry>
    <title>2023-SICTF-#Round2-wp-misc</title>
    <url>/post/ccf22797.html</url>
    <content><![CDATA[<span id="more"></span>
<p>Cryptoå…¼èŒmiscæ‰‹ï¼Œæµ…åšç‚¹miscå¨±ä¹å¨±ä¹</p>
<p><strong>Rankï¼š2</strong></p>
<p><img src="/post/ccf22797/image-20230911152802298.png" alt="image-20230911152802298"></p>
<p><br></p>
<p><br></p>
<h3 id="ç­¾åˆ°-Welcome"><a href="#ç­¾åˆ°-Welcome" class="headerlink" title="[ç­¾åˆ°]Welcome"></a>[ç­¾åˆ°]Welcome</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å…³æ³¨å¾®ä¿¡å…¬ä¼—å·å¹¶å‘é€&quot;SICTF2023&quot;å°±å¯ä»¥è·å¾—flagè¾£ï¼</span><br></pre></td></tr></table></figure>
<p>ç­¾åˆ°é¢˜ï¼Œç…§ç€åšå³å¯ã€‚</p>
<p><img src="/post/ccf22797/image-20230908162949748.png" alt></p>
<p>flagï¼š</p>
<p><strong>SICTF{Welcome_to_SICTF2023_#Round2}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="Pixel-art"><a href="#Pixel-art" class="headerlink" title="Pixel_art"></a>Pixel_art</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¿™å¼ é¢œè‰²å¾ˆå¥‡æ€ªçš„å›¾ç‰‡åˆ°åº•æ˜¯å¹²ä»€ä¹ˆçš„å‘¢ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>ä¸‹è½½é¢˜ç›®é™„ä»¶ï¼Œæ˜¯ä¸€ä¸ªzipå‹ç¼©åŒ…ï¼Œè§£å¯†æç¤ºéœ€è¦å¯†ç ï¼Œä½†æ˜¯ä¹Ÿå¹¶æ²¡æœ‰åˆ«çš„å¯†ç æç¤ºï¼Œæ‰€ä»¥ç¬¬ä¸€ååº”å°±æ˜¯ä¼ªåŠ å¯†ã€‚åå…­è¿›åˆ¶æ‰“å¼€æ–‡ä»¶ï¼š</p>
<p><img src="/post/ccf22797/image-20230908171507928.png" alt="image-20230908171507928"></p>
<p>å°†è¿™é‡Œçš„1æ”¹ä¸º0å³å¯è§£å¯†å‹ç¼©åŒ…ï¼Œå¾—åˆ°å›¾ç‰‡ï¼š</p>
<p><img src="/post/ccf22797/Pixel_art.png" alt="Pixel_art"></p>
<p>å¹¶æ²¡æœ‰å‘ç°å¦‚é¢˜ç›®æè¿°ä¸­æ‰€è¯´çš„å¥‡æ€ªçš„åƒç´ ç‚¹ï¼Œåœ¨stegsolveä¸­æ‰“å¼€ï¼Œåˆ‡æ¢å„ç§æŸ¥çœ‹æ–¹å¼ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå‘ç°ã€‚äºæ˜¯æƒ³åˆ°LSBéšå†™ï¼Œå¯ä»¥å‘ç°ï¼š</p>
<p><img src="/post/ccf22797/image-20230908171812016.png" alt="image-20230908171812016"></p>
<p>æœç„¶è—äº†ä¸œè¥¿ï¼Œä¿å­˜ä¸ºpngæ–‡ä»¶åæŸ¥çœ‹ï¼š</p>
<p><img src="/post/ccf22797/pixel.png" alt="pixel"></p>
<p>è¿™å›¾ä¹Ÿå¤ªå°äº†ï¼ŒæŸ¥çœ‹å…¶è¯¦ç»†ä¿¡æ¯ï¼Œæœç„¶å‘ç°ï¼š</p>
<p><img src="/post/ccf22797/image-20230908171941968.png" alt="image-20230908171941968"></p>
<p>å¤§å°ä»…æœ‰20*20ï¼Œä¸éš¾æƒ³åˆ°flagè¢«åŠ å¯†è¿›äº†åƒç´ ç‚¹é‡Œã€‚å†™ä¸€ä¸ªè„šæœ¬æå–åƒç´ ç‚¹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">image = Image.<span class="built_in">open</span>(<span class="string">&#x27;temp.png&#x27;</span>)  <span class="comment"># æ›¿æ¢ä¸ºä½ çš„å›¾ç‰‡æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">width, height = image.size</span><br><span class="line">pixel_data = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">        pixel = image.getpixel((x, y))</span><br><span class="line">        pixel_data.append(pixel)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(pixel_data)</span><br></pre></td></tr></table></figure>
<p>æ‰“å°å‡ºæ¥çš„åƒç´ ç‚¹åˆ—è¡¨æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">[(<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">33</span>, <span class="number">63</span>, <span class="number">33</span>), (<span class="number">33</span>, <span class="number">46</span>, <span class="number">63</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">63</span>, <span class="number">46</span>, <span class="number">63</span>), (<span class="number">33</span>, <span class="number">46</span>, <span class="number">63</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">33</span>, <span class="number">46</span>), (<span class="number">63</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">33</span>), (<span class="number">63</span>, <span class="number">33</span>, <span class="number">33</span>), (<span class="number">46</span>, <span class="number">63</span>, <span class="number">33</span>), (<span class="number">33</span>, <span class="number">33</span>, <span class="number">33</span>), (<span class="number">33</span>, <span class="number">33</span>, <span class="number">63</span>), (<span class="number">46</span>, <span class="number">63</span>, <span class="number">33</span>), (<span class="number">46</span>, <span class="number">63</span>, <span class="number">33</span>), ......, (<span class="number">46</span>, <span class="number">46</span>, <span class="number">33</span>), (<span class="number">46</span>, <span class="number">63</span>, <span class="number">46</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)]</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆè¿™ä¸‰ä¸ªæ•°å­—æ˜¾ç„¶æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œå½“ä½œASCIIç æ‰“å°å‡ºå¯¹åº”å­—ç¬¦å‘ç°ï¼šåˆ†åˆ«æ˜¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">46-. </span><br><span class="line">33-!</span><br><span class="line">63-?</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸‰ä¸ªå­—ç¬¦ä¸éš¾å¯¹åº”åˆ°OokåŠ å¯†ä¸Šï¼Œå†™ä¸ªå®Œæ•´è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">image = Image.<span class="built_in">open</span>(<span class="string">&#x27;temp.png&#x27;</span>)  <span class="comment"># æ›¿æ¢ä¸ºä½ çš„å›¾ç‰‡æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">width, height = image.size</span><br><span class="line">pixel_data = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">        pixel = image.getpixel((x, y))</span><br><span class="line">        pixel_data.append(pixel)</span><br><span class="line"></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(pixel_data)):</span><br><span class="line">    <span class="keyword">if</span>(pixel_data[i] == (<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>)):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> pixel_data[i]:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Ook&quot;</span>+<span class="built_in">chr</span>(j),end = <span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>æ‹¿ç”Ÿæˆçš„å­—ç¬¦ä¸²å»åœ¨çº¿ç½‘å€è§£å¯†ï¼š</p>
<p><img src="/post/ccf22797/image-20230908172734509.png" alt="image-20230908172734509"></p>
<p>flagï¼š</p>
<p><strong>SICTF{0141ac35-ec19-4cee-a906-22805fdbed77}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="baby-zip"><a href="#baby-zip" class="headerlink" title="baby_zip"></a>baby_zip</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ”»ç ´è¿™ä¸ªå‹ç¼©åŒ…ï¼</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ç»™äº†ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œé¦–å…ˆæ£€æŸ¥å‡ºæ˜¯çœŸåŠ å¯†ï¼Œç„¶åå°è¯•ziprelloçˆ†ç ´æ— æœï¼Œbinwalkä¹Ÿæ²¡æœ‰å‘ç°é¢å¤–æ–‡ä»¶ï¼Œé‚£ä¹ˆå°±åªèƒ½æ˜¯æ·±å…¥æ˜æ–‡æ”»å‡»äº†ã€‚</p>
<p>æ·±å…¥æ˜æ–‡æ”»å‡»å‚è€ƒï¼š</p>
<p><a href="https://hasegawaazusa.github.io/zip-crack-note.html#zip-ç ´è§£">zipå‹ç¼©åŒ…å–è¯ç¬”è®° | ç‹¬å¥ã®å°å±‹ (hasegawaazusa.github.io)</a></p>
<p>ç”±å‚è€ƒåšå®¢çŸ¥ï¼Œè¿›è¡Œæ·±å…¥æ˜æ–‡æ”»å‡»éœ€è¦è‡³å°‘12ä¸ªå·²çŸ¥å­—èŠ‚ã€‚è€Œç”±äºå·²çŸ¥å‹ç¼©åŒ…å†…ä¸ºpngæ–‡ä»¶ï¼Œä¹Ÿå°±çŸ¥é“æ–‡ä»¶å¤´ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 52</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬è‡³å°‘çŸ¥é“äº†16ä¸ªå‡†ç¡®çš„å­—èŠ‚ï¼Œè¶…è¿‡äº†12ä¸ªå­—èŠ‚ï¼Œå·²ç»æ»¡è¶³æ·±å…¥æ˜æ–‡æ”»å‡»çš„æ¡ä»¶äº†ï¼Œ(å¤šçš„å·²çŸ¥å­—èŠ‚å¯ä»¥åŠ å¿«é€Ÿåº¦)ï¼Œæ¥ä¸‹æ¥å°±ä½¿ç”¨å·¥å…·å³å¯ã€‚</p>
<p><img src="/post/ccf22797/image-20230909112256733.png" alt="image-20230909112256733"></p>
<p>ä¸¤æ­¥æ“ä½œåˆ†åˆ«æ˜¯ï¼šæŠŠå·²çŸ¥åå…­è¿›åˆ¶çš„å­—èŠ‚å†™å…¥æ–‡ä»¶key.txtï¼Œå†è¿›è¡Œæ·±å…¥æ˜æ–‡æ”»å‡»å³å¯ã€‚è·‘äº†æ¥è¿‘äºŒååˆ†é’Ÿåï¼Œå‡ºäº†zipçš„ä¸‰æ®µå†…éƒ¨å¯†ç (ä¸Šå›¾ä¸­æœ€åä¸€è¡Œ)ï¼Œç›´æ¥è¿›è¡Œè§£å¯†å³å¯ï¼š</p>
<p><img src="/post/ccf22797/image-20230909112437253.png" alt="image-20230909112437253"></p>
<p>å¾—åˆ°å›¾ç‰‡ï¼š</p>
<p><img src="/post/ccf22797/flag1.png" alt="flag1"></p>
<p>åå…­è¿›åˆ¶æ‰“å¼€æœ«å°¾å³å¾—flagï¼š</p>
<p><img src="/post/ccf22797/image-20230909112540496.png" alt="image-20230909112540496"></p>
<p>flagï¼š</p>
<p><strong>SICTF{3a4998b8-345e-4943-a689-d01e8b08defb}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="ä¸€èµ·ä¸Šå·ä¸"><a href="#ä¸€èµ·ä¸Šå·ä¸" class="headerlink" title="ä¸€èµ·ä¸Šå·ä¸"></a>ä¸€èµ·ä¸Šå·ä¸</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä½ ä¸ºä»€ä¹ˆè¿˜ä¸ä¸Šå·å•Šï¼Ÿå®ï¼</span><br><span class="line">Hintï¼šä½ çŸ¥é“CobaltStrikeå—ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ç»™äº†ä¸€ä¸ªæµé‡åŒ…ï¼Œå¯¼å‡ºhttpæµå¯¹è±¡ï¼Œå¯ä»¥å‘ç°ä¸€ä¸ªkey.zipï¼š</p>
<p><img src="/post/ccf22797/image-20230909142543063.png" alt="image-20230909142543063"></p>
<p>å¯¼å‡ºè¯¥å‹ç¼©åŒ…å¹¶è§£å‹ï¼Œå¾—åˆ°ä¸€ä¸ªkeyæ–‡ä»¶ï¼Œé‚£ç°åœ¨è¦åšçš„å°±æ˜¯æå–å‡ºkeyä¸­çš„ä¿¡æ¯ï¼Œå»è§£å¯†æµé‡ä¸­çš„æ•°æ®ã€‚ä½†æ˜¯æ€ä¹ˆæ‰¾éƒ½æ²¡æ‰¾åˆ°è¿™ç§keyæ–‡ä»¶æ€ä¹ˆä½¿ç”¨ï¼Œæ€è·¯ä¹Ÿå°±æš‚æ—¶åœæ»äº†ã€‚</p>
<p>ç›´åˆ°hintå‡ºç°ï¼Œé‚£å°±ç›´æ¥æœç´¢CobaltStrikeï¼Œå‘ç°ä¸€é“ç±»ä¼¼æµé‡åˆ†æé¢˜ï¼Œç…§ç€ä¸€æ­¥æ­¥åšå°±æœ‰äº†(å…¶ä¸­CS_Decryptä¸­æœ‰ä¸€ä¸ªè„šæœ¬ç”¨åˆ°M2Cryptoåº“ï¼Œä½†æ˜¯pipä¸ä¸‹æ¥ï¼Œæœç´¢èµ„æ–™å‘ç°è¿™ä¸ªåº“åœæ­¢æ›´æ–°å¾ˆä¹…äº†ï¼Œå¯èƒ½pythonç‰ˆæœ¬å¯¹ä¸ä¸Šï¼Œå¹³æ›¿ä¸ºpycryptodomeå³å¯)ï¼š</p>
<p><a href="https://blog.csdn.net/qq_43264813/article/details/120560209">2021å¹´â€œç»¿åŸæ¯â€ç½‘ç»œå®‰å…¨å¤§èµ›-Misc-æµé‡åˆ†æ_å¤œç™½å›çš„åšå®¢-CSDNåšå®¢</a></p>
<p>å¾—åˆ°flagï¼š</p>
<p><img src="/post/ccf22797/image-20230909142844158.png" alt="image-20230909142844158"></p>
<p>flagï¼š</p>
<p><strong>SICTF{88a39373-e204-43b6-b321-33ac8972fde9}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="QR-QR-QR"><a href="#QR-QR-QR" class="headerlink" title="QR_QR_QR"></a>QR_QR_QR</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æˆ‘å°±æ‰«ç è€Œå·²å•¦ï¼ä¸ºä»€ä¹ˆè¦ç”¨pwntoolsï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ç»™äº†ä¸€ä¸ªç«¯å£ï¼Œå…ˆç”¨xshellæ‰‹åŠ¨äº¤äº’ä¸€ä¸‹ï¼š</p>
<p><img src="/post/ccf22797/image-20230910150031807.png" alt="image-20230910150031807"></p>
<p>å¯ä»¥ä¾ç¨€çœ‹å‡ºæ˜¯äºŒç»´ç çš„å®šä½ç¬¦ï¼Œé‚£ä¹ˆæ€è·¯å°±æ˜¯æŠŠè¿™äº›0ã€1è½¬åŒ–ä¸ºäºŒç»´ç å¹¶æ‰«ç å¾—åˆ°æ•°æ®ï¼Œä½†æ˜¯ç²˜å‡ºæ¥æ•°æ®æƒ³å†™è„šæœ¬çš„æ—¶å€™å‘ç°ï¼š</p>
<p><img src="/post/ccf22797/image-20230910150225007.png" alt="image-20230910150225007"></p>
<p>ç¬‘æ­»ï¼Œvscodeå³ä¾§çš„é¢„è§ˆç›´æ¥æ˜¾ç¤ºå‡ºäº†äºŒç»´ç çš„æ•ˆæœï¼Œé‚£ç›´æ¥æ‰«ç å¾—åˆ°æ•°æ®ï¼š</p>
<p><img src="/post/ccf22797/image-20230910150358330.png" alt="image-20230910150358330"></p>
<p>ä½†æ˜¯ä¸Šä¼ è¿™ä¸²æ•°æ®çš„æ—¶å€™å‘ç°ï¼š</p>
<p><img src="/post/ccf22797/image-20230910150429700.png" alt="image-20230910150429700"></p>
<p>è¶…æ—¶äº†ï¼Œå½³äºï¼Œé‚£ç¡®å®å¾—å†™è„šæœ¬è‡ªåŠ¨äº¤äº’ï¼Œäº¤äº’ä¸€æ¬¡åå‘ç°é¶æœºç«¯è¿˜ä¼šå‘é€äºŒç»´ç æ•°æ®ï¼Œé‚£åº”è¯¥æ˜¯è¦å¾ªç¯ä¸€å®šæ¬¡æ•°åæ‰ä¼šç»™flagäº†ã€‚</p>
<p>ä¹‹åå°±æ˜¯æ¯ç‡¥çš„debugæ—¶é—´ã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> pyzbar.pyzbar <span class="keyword">import</span> decode</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&quot;210.44.151.51&quot;</span>,<span class="number">10468</span>)</span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    count += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(count)</span><br><span class="line">    data = <span class="built_in">list</span>(r.recvuntil(<span class="string">b&quot;P&quot;</span>)[:-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å®šä¹‰å›¾åƒçš„å®½åº¦å’Œé«˜åº¦ï¼ˆæ ¹æ®æ•°æ®é•¿åº¦è°ƒæ•´ï¼‰</span></span><br><span class="line">    width = <span class="number">116</span></span><br><span class="line">    height = <span class="number">116</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># åˆ›å»ºä¸€ä¸ªç©ºç™½å›¾åƒ</span></span><br><span class="line">    image = Image.new(<span class="string">&quot;1&quot;</span>, (width, height), color=<span class="number">1</span>)  <span class="comment"># 1è¡¨ç¤ºå•è‰²ï¼ˆé»‘ç™½ï¼‰</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># è·å–å›¾åƒçš„åƒç´ è®¿é—®å¯¹è±¡</span></span><br><span class="line">    pixels = image.load()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°†01æ•°æ®å¡«å……åˆ°å›¾åƒä¸­</span></span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">            index = y * width + x</span><br><span class="line">            <span class="keyword">if</span> index &lt; <span class="built_in">len</span>(data) <span class="keyword">and</span> data[index] == <span class="number">48</span>:</span><br><span class="line">                pixels[x, y] = <span class="number">0</span>  <span class="comment"># å°†0å†™ä¸ºé»‘è‰²åƒç´ ç‚¹</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                pixels[x, y] = <span class="number">1</span>  <span class="comment"># å°†0å†™ä¸ºé»‘è‰²åƒç´ ç‚¹</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¿å­˜å›¾åƒä¸ºæ–‡ä»¶</span></span><br><span class="line">    image.save(<span class="string">&quot;1.png&quot;</span>)</span><br><span class="line">    decocdeQR = decode(Image.<span class="built_in">open</span>(<span class="string">&quot;1.png&quot;</span>))[<span class="number">0</span>].data</span><br><span class="line">    r.sendline(decocdeQR)</span><br><span class="line">    temp = r.recvline()</span><br><span class="line">    <span class="built_in">print</span>(temp)</span><br><span class="line">    temp = r.recvline()</span><br><span class="line">    <span class="built_in">print</span>(temp)</span><br></pre></td></tr></table></figure>
<p>å¾ªç¯1000æ¬¡åï¼Œé¶æœºç«¯å‘é€flagï¼š</p>
<p><strong>SICTF{d7d23552-d917-4ad4-962c-e415dd5b5b6e}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="fast-morse"><a href="#fast-morse" class="headerlink" title="fast_morse"></a>fast_morse</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ä½ å¥½å¿«å•Šï¼ï¼ˆflagéœ€è¦åŒ…å«SICTF&#123;&#125;ï¼‰</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ç»™äº†ä¸€ä¸ªéŸ³é¢‘ï¼ŒAudacityæ‰“å¼€ï¼š</p>
<p><img src="/post/ccf22797/image-20230910150829891.png" alt="image-20230910150829891"></p>
<p>ç»å…¸çš„éŸ³é¢‘éšå†™æ‘©æ–¯ç”µç ï¼Œä½†æ˜¯æ•²å®Œæ‘©æ–¯å¯†ç ï¼Œæœ€åå¾—åˆ°çš„uuidå°‘äº†ä¸€ä½ï¼Œ<del>ç§èŠå‡ºé¢˜äººæ‹¿flagå³å¯</del>ã€‚</p>
<p><br></p>
<p><br></p>
<h3 id="Easy-Shark"><a href="#Easy-Shark" class="headerlink" title="Easy_Shark"></a>Easy_Shark</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">é²¨é±¼ï¼å—·å‘œï¼</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ç»™äº†ä¸€ä¸ªæµé‡æ–‡ä»¶ï¼Œè¿½è¸ªtcpæµèƒ½å‘ç°ä¸€æ®µphpä»£ç ï¼š</p>
<p><img src="/post/ccf22797/image-20230910151203093.png" alt="image-20230910151203093"></p>
<p>å¯ä»¥çœ‹å‡ºï¼Œåœ¨opensslæ‰©å±•æœ‰æ•ˆæ—¶ï¼Œè¿™æ®µä»£ç å¯¹æ•°æ®çš„è§£å¯†æ–¹å¼ä¸ºAES_128åbase64ï¼Œå¹¶ä¸”ç»™äº†keyçš„å€¼(ä¹‹åäº†è§£åˆ°è¿™æ˜¯å¾ˆæ˜æ˜¾çš„å†°èçš„ç‰¹å¾)ã€‚é‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨cyberchefï¼Œå¯¹ä¹‹åçš„æ¯ä¸ªtcpæµé‡Œçš„base64æ•°æ®è¿›è¡Œæ¢å¤ï¼š</p>
<p><img src="/post/ccf22797/image-20230910151658797.png" alt="image-20230910151658797"></p>
<p>å†æŠŠè§£å¯†å‡ºæ¥çš„å¯†æ–‡å†…éƒ¨çš„base64æ®µæå–å‡ºæ¥ï¼Œå†è¿›è¡Œè§£å¯†ï¼Œå°±å¯ä»¥åœ¨æœ€åº•ä¸‹å‘ç°ï¼š</p>
<p><img src="/post/ccf22797/image-20230910151851063.png" alt="image-20230910151851063"></p>
<p>å¯ä»¥çœ‹å‡ºï¼Œå®é™…ä¸Šè¿™æ®µç¨‹åºå°±æ˜¯åœ¨æ‰§è¡Œæœ€ä¸‹æ–¹çš„cmdå‘½ä»¤ï¼Œç„¶åå¯¹å›å¤çš„æ•°æ®ä¹Ÿè¿›è¡Œå¦‚ä¸Šè§£å¯†ï¼Œå°±å¯ä»¥å¾—åˆ°å‘½ä»¤æ‰§è¡Œåçš„å¯¹åº”å†…å®¹ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œå¯ä»¥å¾—åˆ°ä¸¤ä¸ªæœ‰ç”¨çš„ä¿¡æ¯ï¼š</p>
<p>GronKey.txtï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1,50,61,8,9,20,63,41</span><br></pre></td></tr></table></figure>
<p>flag.txtï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">TGLBOMSJNSRAJAZDEZXGHSJNZWHG</span><br></pre></td></tr></table></figure>
<p>flagçš„å†…å®¹ç›´æ¥æäº¤ä¸Šå»æ˜¯ä¸å¯¹çš„ï¼Œå› æ­¤è‚¯å®šè¿˜éœ€è¦è¿›è¡Œè§£å¯†ï¼Œè€Œå¦‚ä½•è§£å¯†å°±éœ€è¦ç”¨åˆ°GronKey.txtï¼Œå¹¶ä¸”æŒ‰æ­£å¸¸æ€è·¯ï¼ŒGronKeyè¿™ä¸ªåå­—è‚¯å®šæ˜¯ä¸ªæç¤ºã€‚æœ€ç»ˆæœç´¢åˆ°äº†Gronsfeldå¯†ç ï¼Œè§£å¯†å³å¯ï¼š</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span>  Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pycipher <span class="keyword">import</span> Gronsfeld</span><br><span class="line"></span><br><span class="line">t = [<span class="number">1</span>,<span class="number">50</span>,<span class="number">61</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">20</span>,<span class="number">63</span>,<span class="number">41</span>]</span><br><span class="line">temp = <span class="string">&quot;TGLBOMSJNSRAJAZDEZXGHSJNZWHG&quot;</span></span><br><span class="line"><span class="built_in">print</span> (Gronsfeld(t).decipher(temp))</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæœ‰ä¸ªæ¯”è¾ƒå‘çš„ç‚¹ï¼šå› ä¸ºæˆ‘æ˜¯çŸ¥é“Gronsfeldè¿™ä¸ªå¯†ç çš„ï¼Œä½†æ˜¯æˆ‘è®°å¾—ä»–çš„å¯†é’¥åªèƒ½æ˜¯0-9çš„æ•°å­—ï¼ŒåŠ å¯†åŸç†å°±æ˜¯å­—æ¯åŠ ä¸Šå¯†é’¥å¯¹åº”æ•°å­—(ç±»ä¼¼äºç»´å‰å°¼äºšå¯†ç )ï¼Œæ‰€ä»¥å¼€å§‹å°±æ’é™¤äº†è¿™ä¸ªåŠ å¯†æ–¹å¼ã€‚ä¹‹åä¸€ç›´æ²¡æœ‰æœåˆ°å…¶ä»–çš„Gronå¼€å¤´çš„åŠ å¯†ï¼Œå¡äº†å¾ˆä¹…ã€‚åæ¥æˆ‘æœåˆ°äº†ä¸€ä¸ªGronsfeldåœ¨çº¿åŠ å¯†ï¼š</p>
<p><a href="https://www.wishingstarmoye.com/ctf/vigenere">Vigenere / Gronsfeld - è®¸æ„¿æ˜Ÿ (wishingstarmoye.com)</a></p>
<p>å¯ä»¥å‘ç°ï¼Œä»–ç¡®å®ç”¨äº†è¶…è¿‡10çš„æ•°å­—å½“ä½œå¯†é’¥ï¼Œé‚£è¿™åˆ°åº•æ˜¯æ€ä¹ˆåŠ å¯†çš„å‘¢ï¼Ÿæˆ‘æ€è€ƒäº†ä¸€ä¸‹ï¼Œå‘ç°ä»–çš„åŠ å¯†æ–¹å¼åº”è¯¥æ˜¯ï¼šåŠ å¯†æ—¶ï¼Œæ¯ä¸ªå­—æ¯å³ç§»å¯†é’¥åˆ—è¡¨ä¸­å¯¹åº”æ•°å­—çš„ä½æ•°ï¼›è€Œè§£å¯†æ—¶ï¼Œæ¯ä¸ªå­—æ¯å·¦ç§»å¯†é’¥åˆ—è¡¨ä¸­å¯¹åº”æ•°å­—çš„ä½æ•°ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼ŒTå·¦ç§»1ä½å¾—åˆ°Sï¼Œè¿™å¾ˆå¥½ç†è§£ï¼›è€ŒGå·¦ç§»50ä½ï¼Œå…¶å®å°±æ˜¯å³ç§»2ä½(å› ä¸ºæ¨¡26çš„ç¼˜æ•…)ï¼Œå› æ­¤å¾—åˆ°Iã€‚</p>
<p>è¿™æ ·å°±å¯ä»¥é¡ºåˆ©è§£å¯†äº†ã€‚</p>
<p>flagï¼š</p>
<p><strong>SICTF{SHUMUISAGOODBOYYYYYYYYY}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="è¿˜ä¸ä¸Šå·"><a href="#è¿˜ä¸ä¸Šå·" class="headerlink" title="è¿˜ä¸ä¸Šå·"></a>è¿˜ä¸ä¸Šå·</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ä¸€èµ·ä¸Šå·ä¸ï¼Ÿæ¥ï¼æˆ‘æ•™ä½ æ€ä¹ˆå†™payloadï¼</span><br><span class="line">Hint1ï¼šå››ä½çˆ†ç ´,å¤šæ³¨æ„ä¸€ä¸‹ç»†èŠ‚ï¼Œé™¤äº†CSè¿˜æœ‰ä¸€éƒ¨åˆ†</span><br><span class="line">Hint2ï¼šå‹ç¼©åŒ…å¯†ç ä¸ºwe1l</span><br></pre></td></tr></table></figure>
<p>å…¶å®è¿™é“é¢˜å°±æ˜¯Easy_sharkå’Œä¸€èµ·ä¸Šå·ä¸çš„ç»“åˆï¼Œè¿™ä¸¤ä¸ªéƒ½åšå‡ºæ¥çš„è¯ï¼Œè¿™é¢˜å…¶å®éš¾åº¦ä¸å¤§äº†ã€‚</p>
<p>é¢˜ç›®ç»™äº†ä¸¤ä¸ªæµé‡åŒ…ï¼Œç”±åå­—å¯ä»¥çŸ¥é“ä¸€ä¸ªåŒ…å¯¹åº”ä¸€åŠflagã€‚å…¶ä¸­ï¼ŒåŒ…1å½¢å¼å¯¹åº”Ez_sharkï¼ŒåŒ…2å½¢å¼å¯¹åº”ä¸€èµ·ä¸Šå·ä¸ã€‚</p>
<p>ä»åŒ…1å…¥æ‰‹ï¼Œå¯ä»¥å‘ç°å¯¹æ¯”èµ·Ez_sharkï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯ä»–æ²¡æœ‰ç»™å‡ºAESçš„keyå€¼ï¼Œå› æ­¤å¿…é¡»è¦æƒ³åŠæ³•æ‰¾å‡ºkeyã€‚è€ŒåŒ…2æ­£å¥½æœ‰ä¸ªkey.zipï¼Œè¿›è¡Œå¯¼å‡ºï¼š</p>
<p><img src="/post/ccf22797/image-20230910153507463.png" alt="image-20230910153507463"></p>
<p>å¾—åˆ°çš„key.zipä¸èƒ½ç›´æ¥è§£å‹ï¼Œå¹¶ä¸”æ˜¯çœŸåŠ å¯†ï¼ŒåŒæ—¶ä¹Ÿæ²¡æ³•è¿›è¡Œæ˜æ–‡æ”»å‡»ï¼Œé‚£ä¹ˆå°±ziprelloçˆ†ç ´å§ï¼Œæœ€åå¾—åˆ°å¯†ç æ˜¯we1l(å¹¶ä¸”åæ¥Hintç»™äº†)ã€‚</p>
<p>æ‰“å¼€keyæ–‡ä»¶ï¼š</p>
<p><img src="/post/ccf22797/image-20230910153756977.png" alt="image-20230910153756977"></p>
<p>æ˜¾ç„¶æœ‰é›¶å®½å­—ç¬¦ï¼Œåˆ©ç”¨åœ¨çº¿ç½‘ç«™<a href="http://330k.github.io/misc_tools/unicode_steganography.html">Unicode Steganography with Zero-Width Characters (330k.github.io)</a>è¿›è¡Œé›¶å®½å­—ç¬¦è§£å¯†ï¼š</p>
<p><img src="/post/ccf22797/image-20230910154112768.png" alt="image-20230910154112768"></p>
<p>è¿™é‡Œè¦æ³¨æ„åœ¨ç½‘é¡µä¸‹æ–¹å‹¾é€‰è¯¥æ–‡æœ¬ä¸­æ‰€æœ‰å­˜åœ¨çš„é›¶å®½å­—ç¬¦ï¼Œä¸ç„¶è§£å¯†ä¼šå¤±è´¥ï¼š</p>
<p><img src="/post/ccf22797/image-20230910154140388.png" alt="image-20230910154140388"></p>
<p>å› æ­¤å°±å¾—åˆ°äº†AESçš„keyï¼Œå¯ä»¥æŒ‰ç…§Ez_Sharkçš„æ–¹å¼å¯¹åŒ…1çš„æµé‡ä¾æ¬¡è¿›è¡Œè§£å¯†ï¼Œèƒ½å¾—åˆ°ä¸¤ä¸ªæœ‰ç”¨ä¿¡æ¯ï¼š</p>
<p>flag.txtï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SICTF&#123;79e1755e-08a8-4d</span><br></pre></td></tr></table></figure>
<p>keyï¼š</p>
<p><img src="/post/ccf22797/image-20230910154525684.png" alt="image-20230910154525684"></p>
<p>å¦‚æœåšå‡ºæ¥ä¸€èµ·ä¸Šå·ä¸é‚£é“é¢˜ï¼Œé‚£ä¹ˆå¯¹è¿™ä¸²æ•°æ®åº”è¯¥å¾ˆç†Ÿæ‚‰ï¼Œè¿™å°±æ˜¯<code>.cobaltstrike.beacon_keys</code>å½¢å¼çš„å¯†é’¥æ–‡ä»¶ï¼Œå°†è¿™æ®µå†…å®¹ä¿å­˜æˆæ–‡ä»¶key1.txtï¼Œåç»­çš„æ­¥éª¤å°±å’Œå‰é¢é‚£é“é¢˜å°±ä¸€æ¨¡ä¸€æ ·äº†ã€‚</p>
<p>ä¸‹é¢è¯¦ç»†è®°å½•ä¸€ä¸‹æ­¥éª¤(æ€•æˆ‘è‡ªå·±å¿˜)ï¼š</p>
<p>1ã€è§£ækey1.txtæ–‡ä»¶å¾—åˆ°private_key</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javaobj.v2 <span class="keyword">as</span> javaobj</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;key1.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> fd:</span><br><span class="line">    pobj = javaobj.load(fd)</span><br><span class="line">privateKey = pobj.array.value.privateKey.encoded.data</span><br><span class="line">publicKey = pobj.array.value.publicKey.encoded.data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">privateKey = (</span><br><span class="line">    <span class="string">b&quot;-----BEGIN PRIVATE KEY-----\n&quot;</span></span><br><span class="line">    + base64.encodebytes(<span class="built_in">bytes</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x: x &amp; <span class="number">0xFF</span>, privateKey)))</span><br><span class="line">    + <span class="string">b&quot;-----END PRIVATE KEY-----&quot;</span></span><br><span class="line">)</span><br><span class="line">publicKey = (</span><br><span class="line">    <span class="string">b&quot;-----BEGIN PUBLIC KEY-----\n&quot;</span></span><br><span class="line">    + base64.encodebytes(<span class="built_in">bytes</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x: x &amp; <span class="number">0xFF</span>, publicKey)))</span><br><span class="line">    + <span class="string">b&quot;-----END PUBLIC KEY-----&quot;</span></span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(privateKey.decode())</span><br><span class="line"><span class="built_in">print</span>(publicKey.decode())</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(</span></span><br><span class="line"><span class="comment">#     list(</span></span><br><span class="line"><span class="comment">#         map(</span></span><br><span class="line"><span class="comment">#             lambda x: list(map(lambda y: (y[0].name, y[1]), x.items())),</span></span><br><span class="line"><span class="comment">#             a.field_data.values(),</span></span><br><span class="line"><span class="comment">#         )</span></span><br><span class="line"><span class="comment">#     )</span></span><br><span class="line"><span class="comment"># )</span></span><br></pre></td></tr></table></figure>
<p>2ã€æ ¹æ®private_keyä»¥åŠæµé‡åŒ…ä¸­cookieè§£æå‡ºAES keyå’ŒHMAC keyï¼šï¼ˆå…¶ä»–ä¿¡æ¯æœ‰éœ€è¦ï¼Œè§£é™¤æ‰æ³¨é‡Šå³å¯ï¼Œè¿™é‡Œåªéœ€è¦AESä¸HMACçš„keyï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_v1_5</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hexdump</span><br><span class="line"> </span><br><span class="line">PRIVATE_KEY = <span class="string">&quot;&quot;&quot;-----BEGIN PRIVATE KEY-----</span></span><br><span class="line"><span class="string">MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBAL0M6FR0Cb9dW52Nd5NTA1JUNAs1</span></span><br><span class="line"><span class="string">thS8iXx6QB+UkN/vRJdfsKS8dnOfNuPuPDCtx26B2j8I1FuTJ1VrrfDkzN585sskmXYronFM98Dx</span></span><br><span class="line"><span class="string">50vHaadOcDcDdBBqi8gC5/D3iKflX6T9pSL/5PVLfN1EIaFsyAS9jpWX2wGNi3C/QPSrAgMBAAEC</span></span><br><span class="line"><span class="string">gYAdNhXeGtH4wkWqOhY8aurL+VvTUZjRanJ6C+/FkXCzUWbRVwVV5xMMeZEDNigRw4BZ2HGvJL+f</span></span><br><span class="line"><span class="string">aMT+o3VMkCYBhGbi2/3RPRgigMG7Aa3LWWtYWsdbw8Mw6aqqbTjDUHrQ1kulMf1JvXJL5LBd+pBA</span></span><br><span class="line"><span class="string">Q8kHaYJRMcmnLsT4NeXOFQJBAMNa2r+phrThTlagMB6bj6vl0IVbDy+TJT2VybCSJ76rPgVUQwtP</span></span><br><span class="line"><span class="string">yX3z7UAjt27mE8KK+k7Jidi0drCEPv5Wo60CQQD3vQbO64fko1dlatkNn095GO9KoCuanrsLs+vY   </span></span><br><span class="line"><span class="string">Ohc0ltk4EhHHmP5hEE6dSMZNASKaN0wSYJ14xjnA+dJWOES3AkEApzyYF4vhLefTUIVBrHIvxFCw   </span></span><br><span class="line"><span class="string">+fjCP1AQiXA5gVcdfzTJm3ZPDtf2/kRbzpTE68M7F0gykFAoGcQj92i/JKy24QJAdyVbA+M07Ro9   </span></span><br><span class="line"><span class="string">qxHzJ+EJmMUMOMjFj8xtStiSQeDWTj2KZLQUBvmmxcnQ9UYN0PUNzjtwA5qhwXccSZoctcjECwJA   </span></span><br><span class="line"><span class="string">Zc0TZgGq/OwgnIyj/1+Q9D0A2eg3aw1k+6Vzkf/DdkuF6+XTkYTlBGiETIK/vm1rCH4NcOCL7eK5   </span></span><br><span class="line"><span class="string">qpA1grg+gg==</span></span><br><span class="line"><span class="string">-----END PRIVATE KEY-----&quot;&quot;&quot;</span></span><br><span class="line"> </span><br><span class="line">encode_data = <span class="string">&quot;j+ojKDVPlCr7lT9yzNinkj1DgdkcRaLMT2kL4U+9TvdFBZqGKk7/4WF/W7JhEieC3DoRfngRppMAVHa3yfhp4HZm/ZeNY4bc8rlYL11Q0dXDzpR5JjhqN+hGe9RBqPznoukShgQLhxT/DO7djxE5ROzi6NC52yZAaGPCSeLDyjg=&quot;</span></span><br><span class="line">base64_key = <span class="string">&quot;&quot;&quot;&quot;&quot;&quot;</span></span><br><span class="line"> </span><br><span class="line">private_key = RSA.import_key(PRIVATE_KEY.<span class="built_in">format</span>(base64_key).encode())</span><br><span class="line">cipher = PKCS1_v1_5.new(private_key)</span><br><span class="line">ciphertext = cipher.decrypt(base64.b64decode(encode_data), <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isFlag</span>(<span class="params">var, flag</span>):</span><br><span class="line">	<span class="keyword">return</span> (var &amp; flag) == flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">toIP</span>(<span class="params">var</span>):</span><br><span class="line">	var2 = (var &amp; -<span class="number">16777216</span>) &gt;&gt; <span class="number">24</span></span><br><span class="line">	var4 = (var &amp; <span class="number">16711680</span>) &gt;&gt; <span class="number">16</span></span><br><span class="line">	var6 = (var &amp; <span class="number">65280</span>) &gt;&gt; <span class="number">8</span></span><br><span class="line">	var8 = var &amp; <span class="number">255</span></span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">str</span>(var2) + <span class="string">&quot;.&quot;</span> + <span class="built_in">str</span>(var4) + <span class="string">&quot;.&quot;</span> + <span class="built_in">str</span>(var6) + <span class="string">&quot;.&quot;</span> + <span class="built_in">str</span>(var8)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getName</span>(<span class="params">var0</span>):</span><br><span class="line">	<span class="keyword">if</span> var0 == <span class="number">37</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM037&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">437</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM437&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">500</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM500&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">708</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-6&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">709</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">710</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">720</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM437&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">737</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-IBM737&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">775</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM775&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">850</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM850&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">852</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM852&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">855</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM855&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">857</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM857&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">858</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM00858&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">860</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM860&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">861</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM861&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">862</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM862&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">863</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM863&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">864</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM864&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">865</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM865&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">866</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM866&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">869</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM869&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">870</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM870&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">874</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-windows-874&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">875</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM875&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">932</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Shift_JIS&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">936</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-mswin-936&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">949</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-windows-949&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">950</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Big5&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1026</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM1026&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1047</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM1047&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1140</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01140&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1141</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01141&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1142</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01142&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1143</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01143&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1144</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01144&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1145</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01145&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1146</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01146&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1147</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01147&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1148</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01148&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1149</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01149&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1200</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;UTF-16LE&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1201</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;UTF-16BE&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1250</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1250&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1251</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1251&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1252</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1252&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1253</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1253&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1254</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1254&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1255</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1255&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1256</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1256&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1257</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1257&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1258</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1258&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1361</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-Johab&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10000</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacRoman&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10001</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10002</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10003</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10004</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacArabic&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10005</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacHebrew&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10006</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacGreek&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10007</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacCyrillic&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10008</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10010</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacRomania&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10017</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacUkraine&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10021</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacThai&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10029</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacCentralEurope&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10079</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacIceland&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10081</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacTurkish&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10082</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacCroatian&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">12000</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;UTF-32LE&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">12001</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;UTF-32BE&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20000</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISO-2022-CN-CNS&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20001</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20002</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20003</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20004</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20005</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20105</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20106</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20107</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20108</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20127</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;US-ASCII&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20261</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20269</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20273</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM273&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20277</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM277&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20278</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM278&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20280</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM280&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20284</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM284&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20285</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM285&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20290</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM290&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20297</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM297&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20420</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM420&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20423</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20424</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM424&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20833</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20838</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM-Thai&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20866</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;KOI8-R&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20871</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM871&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20880</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20905</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20924</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20932</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;EUC-JP&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20936</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;GB2312&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20949</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">21025</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-IBM1025&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">21027</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">21866</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;KOI8-U&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28591</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-1&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28592</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-2&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28593</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-3&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28594</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-4&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28595</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-5&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28596</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-6&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28597</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-7&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28598</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-8&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28599</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-9&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28603</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-13&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28605</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-15&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">29001</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">38598</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-8&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50220</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-2022-JP&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50221</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-2022-JP-2&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50222</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-2022-JP&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50225</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-2022-KR&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50227</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-2022-CN&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50229</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-2022-CN&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50930</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-IBM930&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50931</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50933</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-IBM933&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50935</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-IBM935&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50936</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50937</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-IBM937&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50939</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-IBM939&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">51932</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;EUC-JP&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">51936</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;GB2312&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">51949</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;EUC-KR&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">51950</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">52936</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;GB2312&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">54936</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;GB18030&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57002</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57003</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57004</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57005</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57006</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57007</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57008</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57009</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57010</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57011</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">65000</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">65001</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;UTF-8&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ciphertext[<span class="number">0</span>:<span class="number">4</span>] == <span class="string">b&#x27;\x00\x00\xBE\xEF&#x27;</span>:</span><br><span class="line"></span><br><span class="line">	<span class="comment"># 16</span></span><br><span class="line">	raw_aes_keys = ciphertext[<span class="number">8</span>:<span class="number">24</span>]</span><br><span class="line"></span><br><span class="line">	<span class="comment"># 2</span></span><br><span class="line">	var9 = ciphertext[<span class="number">24</span>:<span class="number">26</span>]</span><br><span class="line">	var9 = <span class="built_in">int</span>.from_bytes(var9, byteorder=<span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	var9 = getName(var9)</span><br><span class="line">	<span class="comment"># 2</span></span><br><span class="line">	var10 = ciphertext[<span class="number">26</span>:<span class="number">28</span>]</span><br><span class="line">	var10 = <span class="built_in">int</span>.from_bytes(var10, byteorder=<span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	var10 = getName(var10)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># 4</span></span><br><span class="line">	<span class="built_in">id</span> = ciphertext[<span class="number">28</span>:<span class="number">32</span>]</span><br><span class="line">	<span class="built_in">id</span> = <span class="built_in">int</span>.from_bytes(<span class="built_in">id</span>, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	<span class="comment">#print(&quot;Beacon id:&#123;&#125;&quot;.format(id))</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 4</span></span><br><span class="line">	pid = ciphertext[<span class="number">32</span>:<span class="number">36</span>]</span><br><span class="line">	pid = <span class="built_in">int</span>.from_bytes(pid, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	<span class="comment">#print(&quot;pid:&#123;&#125;&quot;.format(pid))</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 2</span></span><br><span class="line">	port = ciphertext[<span class="number">36</span>:<span class="number">38</span>]</span><br><span class="line">	port = <span class="built_in">int</span>.from_bytes(port, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	<span class="comment">#print(&quot;port:&#123;&#125;&quot;.format(port))</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 1</span></span><br><span class="line">	flag = ciphertext[<span class="number">38</span>:<span class="number">39</span>]</span><br><span class="line">	flag = <span class="built_in">int</span>.from_bytes(flag, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	<span class="comment"># print(flag)</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> isFlag(flag, <span class="number">1</span>):</span><br><span class="line">		barch = <span class="string">&quot;&quot;</span></span><br><span class="line">		pid = <span class="string">&quot;&quot;</span></span><br><span class="line">		is64 = <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> isFlag(flag, <span class="number">2</span>):</span><br><span class="line">		barch = <span class="string">&quot;x64&quot;</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		barch = <span class="string">&quot;x86&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> isFlag(flag, <span class="number">4</span>):</span><br><span class="line">		is64 = <span class="string">&quot;1&quot;</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		is64 = <span class="string">&quot;0&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> isFlag(flag, <span class="number">8</span>):</span><br><span class="line">		bypassuac = <span class="string">&quot;True&quot;</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		bypassuac = <span class="string">&quot;False&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">#print(&quot;barch:&quot; + barch)</span></span><br><span class="line">	<span class="comment">#print(&quot;is64:&quot; + is64)</span></span><br><span class="line">	<span class="comment">#print(&quot;bypass:&quot; + bypassuac)</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 2</span></span><br><span class="line">	var_1 = ciphertext[<span class="number">39</span>:<span class="number">40</span>]</span><br><span class="line">	var_2 = ciphertext[<span class="number">40</span>:<span class="number">41</span>]</span><br><span class="line">	var_1 = <span class="built_in">int</span>.from_bytes(var_1, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	var_2 = <span class="built_in">int</span>.from_bytes(var_2, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	windows_var = <span class="built_in">str</span>(var_1) + <span class="string">&quot;.&quot;</span> + <span class="built_in">str</span>(var_2)</span><br><span class="line">	<span class="comment">#print(&quot;windows var:&quot; + windows_var)</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 2</span></span><br><span class="line">	windows_build = ciphertext[<span class="number">41</span>:<span class="number">43</span>]</span><br><span class="line">	windows_build = <span class="built_in">int</span>.from_bytes(windows_build, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	<span class="comment">#print(&quot;windows build:&#123;&#125;&quot;.format(windows_build))</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 4</span></span><br><span class="line">	x64_P = ciphertext[<span class="number">43</span>:<span class="number">47</span>]</span><br><span class="line"></span><br><span class="line">	<span class="comment"># 4</span></span><br><span class="line">	ptr_gmh = ciphertext[<span class="number">47</span>:<span class="number">51</span>]</span><br><span class="line">	<span class="comment"># 4</span></span><br><span class="line">	ptr_gpa = ciphertext[<span class="number">51</span>:<span class="number">55</span>]</span><br><span class="line"></span><br><span class="line">	<span class="comment"># if (&quot;x64&quot;.equals(this.barch)) &#123;</span></span><br><span class="line">	<span class="comment"># this.ptr_gmh = CommonUtils.join(var10, this.ptr_gmh)</span></span><br><span class="line">	<span class="comment"># this.ptr_gpa = CommonUtils.join(var10, this.ptr_gpa)</span></span><br><span class="line">	<span class="comment"># &#125;</span></span><br><span class="line">	<span class="comment">#</span></span><br><span class="line">	<span class="comment"># this.ptr_gmh = CommonUtils.bswap(this.ptr_gmh)</span></span><br><span class="line">	<span class="comment"># this.ptr_gpa = CommonUtils.bswap(this.ptr_gpa)</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 4</span></span><br><span class="line">	intz = ciphertext[<span class="number">55</span>:<span class="number">59</span>]</span><br><span class="line">	intz = <span class="built_in">int</span>.from_bytes(intz, byteorder=<span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	intz = toIP(intz)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> intz == <span class="string">&quot;0.0.0.0&quot;</span>:</span><br><span class="line">		intz = <span class="string">&quot;unknown&quot;</span></span><br><span class="line">	<span class="comment">#print(&quot;host:&quot; + intz)</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> var9 == <span class="literal">None</span>:</span><br><span class="line">		ddata = ciphertext[<span class="number">59</span>:<span class="built_in">len</span>(ciphertext)].decode(<span class="string">&quot;ISO8859-1&quot;</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="comment"># ??x-mswin-936</span></span><br><span class="line">		<span class="comment"># ddata = ciphertext[59:len(ciphertext)].decode(var9)</span></span><br><span class="line">		ddata = ciphertext[<span class="number">59</span>:<span class="built_in">len</span>(ciphertext)].decode(<span class="string">&quot;ISO8859-1&quot;</span>)</span><br><span class="line"></span><br><span class="line">	ddata = ddata.split(<span class="string">&quot;\t&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(ddata) &gt; <span class="number">0</span>:</span><br><span class="line">		computer = ddata[<span class="number">0</span>]</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(ddata) &gt; <span class="number">1</span>:</span><br><span class="line">		username = ddata[<span class="number">1</span>]</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(ddata) &gt; <span class="number">2</span>:</span><br><span class="line">		process = ddata[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">	<span class="comment">#print(&quot;PC name:&quot; + computer)</span></span><br><span class="line">	<span class="comment">#print(&quot;username:&quot; + username)</span></span><br><span class="line">	<span class="comment">#print(&quot;process name:&quot; + process)</span></span><br><span class="line"></span><br><span class="line">	raw_aes_hash256 = hashlib.sha256(raw_aes_keys)</span><br><span class="line">	digest = raw_aes_hash256.digest()</span><br><span class="line">	aes_key = digest[<span class="number">0</span>:<span class="number">16</span>]</span><br><span class="line">	hmac_key = digest[<span class="number">16</span>:]</span><br><span class="line"></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;AES key:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(aes_key.<span class="built_in">hex</span>()))</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;HMAC key:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(hmac_key.<span class="built_in">hex</span>()))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">#print(hexdump.hexdump(ciphertext))</span></span><br></pre></td></tr></table></figure>
<p>3ã€å°†æµé‡åŒ…ä¸­æ•°æ®å†™æˆbase64å½¢å¼ï¼šï¼ˆæ•°æ®æŒ‡çš„æ˜¯å›¾ä¸­è“è‰²éƒ¨åˆ†ï¼Œæ¯ä¸ªtcpæµä¸­çš„æµé‡å‡è¯•ä¸€ä¸‹å³å¯ï¼‰</p>
<p><img src="/post/ccf22797/image-20230910155301194.png" alt="image-20230910155301194"></p>
<p>è½¬æ¢ä¸ºåŸå§‹æ•°æ®ï¼š</p>
<p><img src="/post/ccf22797/image-20230910155542125.png" alt="image-20230910155542125"></p>
<p>å†™æˆbase64å½¢å¼ï¼š</p>
<p><img src="/post/ccf22797/image-20230910155529969.png" alt="image-20230910155529969"></p>
<p>4ã€æœ€ç»ˆè§£å¯†ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Beaconä»»åŠ¡æ‰§è¡Œç»“æœè§£å¯†</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> hexdump</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compare_mac</span>(<span class="params">mac, mac_verif</span>):</span><br><span class="line">	<span class="keyword">if</span> mac == mac_verif:</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(mac) != <span class="built_in">len</span>(mac_verif):</span><br><span class="line">		<span class="built_in">print</span></span><br><span class="line">		<span class="string">&quot;invalid MAC size&quot;</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">	result = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(mac, mac_verif):</span><br><span class="line">		result |= x ^ y</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> result == <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">encrypted_data, iv_bytes, signature, shared_key, hmac_key</span>):</span><br><span class="line">	<span class="keyword">if</span> <span class="keyword">not</span> compare_mac(hmac.new(hmac_key, encrypted_data, digestmod=<span class="string">&quot;sha256&quot;</span>).digest()[<span class="number">0</span>:<span class="number">16</span>], signature):</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&quot;message authentication failed&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">	cypher = AES.new(shared_key, AES.MODE_CBC, iv_bytes)</span><br><span class="line">	data = cypher.decrypt(encrypted_data)</span><br><span class="line">	<span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="comment">#keyæºè‡ªBeacon_metadata_RSA_Decrypt.py</span></span><br><span class="line">SHARED_KEY = binascii.unhexlify(<span class="string">&quot;2f793b0251bb6c09bda982cb159cd611&quot;</span>)</span><br><span class="line">HMAC_KEY = binascii.unhexlify(<span class="string">&quot;e5695e8bf533009cd4a3c950d447b032&quot;</span>)</span><br><span class="line"></span><br><span class="line">encrypt_data=<span class="string">&quot;AAAAwNR1s4ymDHA08b2cCeYKryK3UKJK0G2nKl/svxd3sD2WvktAWL1hS0gvdfXP7XmLpCd3CgYHRMvh9bWGrKW/2ANbWBQEYp1Lv+iIsuBpLdxanTNqAEOnre/71JK8hUKuJ32lY88IsDwgFFjvH0l3lwDOwgtXtOe6mhxvhuxUK8ourv/sii2KGiMOacqaRI2bOtOBcEal00/bBj85FcE+W6PmmGbF0Q9BvUvQmDT9C+J2H12SZqwwAbFGVJwntkDq7Q==&quot;</span></span><br><span class="line"></span><br><span class="line">encrypt_data=base64.b64decode(encrypt_data)</span><br><span class="line"></span><br><span class="line">encrypt_data_length=encrypt_data[<span class="number">0</span>:<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">encrypt_data_length=<span class="built_in">int</span>.from_bytes(encrypt_data_length, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">encrypt_data_l = encrypt_data[<span class="number">4</span>:<span class="built_in">len</span>(encrypt_data)]</span><br><span class="line"></span><br><span class="line">data1=encrypt_data_l[<span class="number">0</span>:encrypt_data_length-<span class="number">16</span>]</span><br><span class="line">signature=encrypt_data_l[encrypt_data_length-<span class="number">16</span>:encrypt_data_length]</span><br><span class="line">iv_bytes = <span class="built_in">bytes</span>(<span class="string">&quot;abcdefghijklmnop&quot;</span>,<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">dec=decrypt(data1,iv_bytes,signature,SHARED_KEY,HMAC_KEY)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">counter = dec[<span class="number">0</span>:<span class="number">4</span>]</span><br><span class="line">counter=<span class="built_in">int</span>.from_bytes(counter, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;counter:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(counter))</span><br><span class="line"></span><br><span class="line">dec_length = dec[<span class="number">4</span>:<span class="number">8</span>]</span><br><span class="line">dec_length=<span class="built_in">int</span>.from_bytes(dec_length, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ä»»åŠ¡è¿”å›é•¿åº¦:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(dec_length))</span><br><span class="line"></span><br><span class="line">de_data= dec[<span class="number">8</span>:<span class="built_in">len</span>(dec)]</span><br><span class="line">Task_type=de_data[<span class="number">0</span>:<span class="number">4</span>]</span><br><span class="line">Task_type=<span class="built_in">int</span>.from_bytes(Task_type, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ä»»åŠ¡è¾“å‡ºç±»å‹:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(Task_type))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(de_data)</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(hexdump.hexdump(dec))</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ä¸€ä¸²base32æ•°æ®ï¼š</p>
<p><img src="/post/ccf22797/image-20230910155718568.png" alt="image-20230910155718568"></p>
<p>è§£å¯†å³å¾—flagååŠæ®µï¼š</p>
<p><img src="/post/ccf22797/image-20230910155756436.png" alt="image-20230910155756436"></p>
<p>flagï¼š</p>
<p><strong>SICTF{79e1755e-08a8-4d3d-9385-4c0541549995}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æœ‰äº›é¢˜çš„å…·ä½“åŸç†æˆ‘ç¡®å®ä¹Ÿæ‡‚çš„ä¸æ˜¯å¾ˆé€å½»ï¼Œæ¬¢è¿ä¸€èµ·äº¤æµè®¨è®ºï¼</p>
]]></content>
      <categories>
        <category>wp-misc</category>
      </categories>
  </entry>
  <entry>
    <title>miscè¶£é¢˜(ä¸€)</title>
    <url>/post/77e39860.html</url>
    <content><![CDATA[<span id="more"></span>
<p>åœ¨CNSS 2023çš„å¤ä»¤è¥çº¿ä¸Šé¢˜ä¸­æ‰¾åˆ°çš„ä¸€é“miscé¢˜ï¼Œçœ‹åˆ°æ ‡é¢˜æœ‰Cryptoï¼Œæ„Ÿå…´è¶£å°±å»è¯•äº†ä¸€è¯•ï¼Œå‘ç°ç¡®å®æ˜¯é“æ¯”è¾ƒæœ‰æ„æ€çš„é¢˜ç›®ï¼Œå°±åœ¨æ­¤è®°å½•ä¸€ä¸‹ï¼ŒåŒæ—¶ä¹Ÿå¼€å¯ <strong>miscè¶£é¢˜</strong> è¿™ä¸€åˆ†ç±»ã€‚</p>
<h2 id="ğŸ”‘-Shino-çš„-Crypto-æ¢¦æƒ³"><a href="#ğŸ”‘-Shino-çš„-Crypto-æ¢¦æƒ³" class="headerlink" title="ğŸ”‘ Shino çš„ Crypto æ¢¦æƒ³"></a>ğŸ”‘ Shino çš„ Crypto æ¢¦æƒ³</h2><p>é¢˜ç›®æ¥æºï¼š2023-CNSS-Summer</p>
<p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">åˆšåˆšæ¥è§¦ç½‘ç»œå®‰å…¨ä¸ä¹…çš„ Shino æœ‰ä¸€ä¸ªæˆä¸º Crypto æ–¹å‘ä¸“å®¶çš„æ¢¦æƒ³ï¼Œæ‰€ä»¥ä»–å†™äº†ä¸€ä¸ªå¾ˆå®‰å…¨çš„åŠ å¯†ç®—æ³•ï¼Œä½ å¯ä»¥å¸®ä»–çœ‹çœ‹å—ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>ç«¯å£ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc 47.108.140.140 11037</span><br></pre></td></tr></table></figure>
<p>Hintï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1ã€ä½ å¯èƒ½éœ€è¦pwntools</span><br><span class="line">2ã€cnss&#123;a-zA-Z0-9_&#125;</span><br><span class="line">   ä¿è¯&#125;åªåœ¨ flag ç»“å°¾å‡ºç°ä¸€æ¬¡</span><br><span class="line">   flag é•¿åº¦ä¸å¤§äº 50</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> cipher, key</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Encoder</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.stream = self.randomBox(self._init_box(key))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">do_encrypt</span>(<span class="params">self, c</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">ord</span>(c) ^ <span class="built_in">next</span>(self.stream)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_init_box</span>(<span class="params">self, crypt_key</span>):</span><br><span class="line">        Box = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">        key_length = <span class="built_in">len</span>(crypt_key)</span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            index = <span class="built_in">ord</span>(crypt_key[(i % key_length)])</span><br><span class="line">            j = (j + Box[i] + index) % <span class="number">256</span></span><br><span class="line">            Box[i], Box[j] = Box[j], Box[i]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Box</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">randomBox</span>(<span class="params">self, S</span>):</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            i = i + <span class="number">1</span> &amp; <span class="number">255</span></span><br><span class="line">            j = j + S[i] &amp; <span class="number">255</span></span><br><span class="line">            S[i], S[j] = S[j], S[i]</span><br><span class="line">            <span class="keyword">yield</span> S[(S[i] + S[j] &amp; <span class="number">255</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">encoder = Encoder()</span><br><span class="line">flag = <span class="built_in">input</span>(<span class="string">&quot;input flag&gt;&gt; &quot;</span>)</span><br><span class="line">table = string.digits + string.ascii_letters + <span class="string">&quot;&#123;&#125;_&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">correct = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="built_in">len</span>(flag):</span><br><span class="line">    <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(flag) <span class="keyword">and</span> flag[i] <span class="keyword">not</span> <span class="keyword">in</span> table:</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> i &gt;= <span class="built_in">len</span>(flag):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> cipher[i] != encoder.do_encrypt(flag[i]):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong flag!&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        correct += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> correct == <span class="built_in">len</span>(cipher):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Correct flag!&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Wrong flag!&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆï¼Œé¢˜ç›®çš„åŠ å¯†ç®—æ³•æ˜¯RC4ï¼Œå¯ä»¥å…ˆæ£€æŸ¥ä¸€ä¸‹æœ‰æ— å˜ç§ï¼Œæ–¹æ³•æ˜¯è‡ªå·±éšä¾¿ä½¿ç”¨ä¸€ç»„æ˜æ–‡å’Œå¯†é’¥ï¼Œåˆ†åˆ«ç”¨è¯¥ç¨‹åºä¸åœ¨çº¿ç½‘ç«™åŠ å¯†ï¼Œæ£€æŸ¥ç»“æœæ˜¯å¦ç›¸åŒã€‚è¿™æ ·æ“ä½œä¹‹åå¯ä»¥å‘ç°ï¼Œç»“æœæ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œè¿™è¯´æ˜æœ¬é¢˜å¹¶æ²¡æœ‰å¯¹RC4è¿›è¡Œé­”æ”¹ï¼Œä¹Ÿå› æ­¤è§£é¢˜çš„æ€è·¯ä¹Ÿå°±å¾ˆè‡ªç„¶çš„ä»å¼€å§‹çš„è§£å¯†ç è½¬å˜æˆäº†æ‰¾æ¼æ´ã€‚</p>
<p>è€Œè¦æ‰¾æ¼æ´çš„ç¨‹åºæ®µå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">encoder = Encoder()</span><br><span class="line">flag = <span class="built_in">input</span>(<span class="string">&quot;input flag&gt;&gt; &quot;</span>)</span><br><span class="line">table = string.digits + string.ascii_letters + <span class="string">&quot;&#123;&#125;_&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">correct = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="built_in">len</span>(flag):</span><br><span class="line">    <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(flag) <span class="keyword">and</span> flag[i] <span class="keyword">not</span> <span class="keyword">in</span> table:</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> i &gt;= <span class="built_in">len</span>(flag):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> cipher[i] != encoder.do_encrypt(flag[i]):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong flag!&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        correct += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> correct == <span class="built_in">len</span>(cipher):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Correct flag!&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Wrong flag!&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>å…ˆå¤§è‡´ç†è§£ç¨‹åºå†…å®¹ï¼šç¨‹åºéœ€è¦ä½ è¾“å…¥ä¸€ä¸²flagå€¼ï¼Œå¹¶å°†flagå€¼é€ä¸ªè¿›è¡ŒRC4åŠ å¯†å¹¶æ£€æŸ¥æ˜¯å¦ä¸å¯†æ–‡ç›¸ç­‰ï¼Œå½“è¾“å…¥çš„flagä¸²åŠ å¯†å€¼ä¸å¯†æ–‡å®Œå…¨ç›¸ç­‰æ—¶ï¼Œä¾¿é€šè¿‡äº†æ£€æŸ¥ï¼Œç¨‹åºè¾“å‡ºâ€Correct flag!â€ã€‚</p>
<p>æ‰€ä»¥ï¼Œè¿™ä¹ˆä¸€å¤§æ®µå…¶å®å°±åªå®ç°äº†ä¸€ä¸ªå†…å®¹ï¼šæ£€æŸ¥ä½ è¾“å…¥çš„flagå’Œä½ å®é™…è¦æäº¤çš„flagæ˜¯å¦ç›¸ç­‰ï¼å¯ä»¥è¯´ï¼Œæ•´ä¸ªç¨‹åºéƒ½æ˜¯ä¸€ä¸ªéšœçœ¼æ³•ï¼Œå…¶å®ä¸è¦è¿™ä¸ªRC4ï¼Œç›´æ¥ç”¨ä»¥ä¸‹çš„ä»£ç æ£€æŸ¥ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼š(å‡è®¾å®é™…flagä¸²åä¸ºsecret)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag = <span class="built_in">input</span>(<span class="string">&quot;input flag&gt;&gt; &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(flag == secret):</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;Correct flag!&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;Wrong flag!&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å°±è¡Œäº†ï¼æ‰€ä»¥ç”¨è¿™ä¹ˆä¸€å¤§æ®µæ¥æ ¸æŸ¥flagä¸€å®šæœ‰é—®é¢˜ã€‚</p>
<p>ä»”ç»†æ ¸æŸ¥ï¼Œæœç„¶ï¼Œä¸‹é¢è¿™æ®µä»£ç å¤§æœ‰ç„æœºï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> i &lt; <span class="built_in">len</span>(flag):</span><br><span class="line">    <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(flag) <span class="keyword">and</span> flag[i] <span class="keyword">not</span> <span class="keyword">in</span> table:</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> i &gt;= <span class="built_in">len</span>(flag):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> cipher[i] != encoder.do_encrypt(flag[i]):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong flag!&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç å­˜åœ¨ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li>è¾“å…¥çš„flagä¸²ä¸­å«æœ‰ä¸åœ¨tableä¸­çš„é¡¹æ—¶ï¼Œä¼šä¸€ç›´è·³è¿‡ç›´è‡³è¯»åˆ°tableä¸­çš„å­—ç¬¦ä¸ºæ­¢ï¼Œä½†æ˜¯æŒ‡æ•° i ä¼šä¸€ç›´å¢åŠ ã€‚</li>
<li>åˆ¤æ–­æŒ‡æ•° i è¿‡å¤§ï¼Œä¾é çš„æ˜¯è¾“å…¥çš„å­—ç¬¦ä¸²é•¿åº¦ï¼Œè€Œä¸æ˜¯å®é™…çš„flagä¸²ã€‚</li>
<li>å°†cipher[i]ä¸encrypt(flag[i])è¿›è¡Œæ¯”å¯¹æ—¶ï¼Œå¹¶æ²¡æœ‰å¯¹cipherçš„æŒ‡æ•°è¿›è¡Œæ£€æŸ¥ã€‚</li>
</ul>
<p>è¿™ä½“ç°äº†ä¸€ä¸ªå¾ˆé‡è¦çš„ä¿¡æ¯ï¼š</p>
<ul>
<li>å¦‚æœä½ çš„è¾“å…¥æ˜¯æ­£å¸¸çš„é”™è¯¯flagä¸²ï¼Œä»–ä¼šæ‰“å°çš„å†…å®¹æ˜¯â€Wrong flag!â€</li>
<li>å¦‚æœä½ çš„è¾“å…¥æ˜¯ä¸æ­£å¸¸çš„æ„é€ çš„å­—ç¬¦ä¸²å¯¼è‡´cipher[i]è¶Šç•Œäº†ï¼Œç¨‹åºä¸ä¼šæ­£å¸¸æ‰“å°å†…å®¹ï¼Œè€Œä¼šæŠ¥é”™ï¼</li>
</ul>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œæ„é€ å¦‚ä¸‹ä¸¤ä¸ªä¸²ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag = &quot;cnss&#123;1234567890abcdefgh&#125;&quot;</span><br><span class="line">flag = chr(0) * 50 + &quot;c&quot;</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆï¼Œç¨‹åºå¯¹ç¬¬ä¸¤ä¸ªå­—ç¬¦ä¸²çš„å¤„ç†åˆ†åˆ«æ˜¯ï¼š</p>
<p>ç”±äºç¬¬ä¸€ä¸ªä¸²å­—ç¬¦å‡åœ¨tableä¸­ï¼Œå› æ­¤ç¨‹åºä»…ä»…ä¼šå°†æ¯ä¸ªå­—ç¬¦ä¸æ­£ç¡®flagè¿›è¡Œæ¯”å¯¹ï¼Œç›´åˆ°æŸä¸ªå­—ç¬¦æ¯”å¯¹å¤±è´¥æ—¶ï¼Œæ‰“å°å‡ºâ€Wrong flag!â€</p>
<p>è€Œç¬¬äºŒä¸ªä¸²å‰äº”åä¸ªå­—ç¬¦å‡æ˜¯ASCIIç ä¸º0çš„å­—ç¬¦ï¼Œæ˜¯ä¸åœ¨tableä¸­çš„ï¼Œå› æ­¤ç¨‹åºä¼šå…ˆåå¤æ‰§è¡Œä»¥ä¸‹è¯­å¥ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> i &lt; <span class="built_in">len</span>(flag) <span class="keyword">and</span> flag[i] <span class="keyword">not</span> <span class="keyword">in</span> table:</span><br><span class="line">    i += <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>ç›´è‡³ç¬¬51ä¸ªå­—ç¬¦â€câ€ï¼Œç”±äºâ€câ€åœ¨tableä¸­ï¼Œå› æ­¤ä¼šè¿›è¡Œæ¯”å¯¹ã€‚æ­¤æ—¶i=51ï¼Œè€Œç”±é¢˜ç›®çŸ¥é“ï¼Œflagé•¿åº¦ä¸å¤§äº50ï¼Œå› æ­¤è¿™æ—¶æ‰§è¡Œè¿™æ¡è¯­å¥è¿›è¡Œæ¯”å¯¹æ—¶ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> cipher[i] != encoder.do_encrypt(flag[i]):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Wrong flag!&quot;</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>cipher[i]æ˜¯å¿…å®šè¶Šç•Œçš„ï¼é‚£ä¹ˆç¨‹åºå°±ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œè€Œä¸å†æ˜¯æ‰“å°â€Wrong flag!â€äº†ã€‚</p>
<p>è¿™æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿç”¨å¤„å¾ˆå¤§ã€‚é¦–å…ˆæˆ‘ä»¬å°±å¯ä»¥åå¤æ„é€ å¦‚ä¸‹å­—ç¬¦ä¸²ï¼Œå‘é€ç»™é¶æœºç«¯æ¥ç¡®å®šçœŸå®flagçš„æ­£ç¡®é•¿åº¦ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag = <span class="built_in">chr</span>(<span class="number">0</span>) * <span class="number">49</span> + <span class="string">&quot;c&quot;</span></span><br><span class="line">flag = <span class="built_in">chr</span>(<span class="number">0</span>) * <span class="number">48</span> + <span class="string">&quot;c&quot;</span></span><br><span class="line">flag = <span class="built_in">chr</span>(<span class="number">0</span>) * <span class="number">47</span> + <span class="string">&quot;c&quot;</span></span><br><span class="line">......</span><br></pre></td></tr></table></figure>
<p>ä¸ºä»€ä¹ˆè¿™æ ·å°±å¯ä»¥ç¡®å®šé•¿åº¦å‘¢ï¼Ÿæˆ‘ä»¬å‡è®¾flagçš„æ­£ç¡®é•¿åº¦æ˜¯30ï¼Œé‚£ä¹ˆå‘é€ä¸‹é¢å­—ç¬¦ä¸²ç»™é¶æœºï¼Œé¶æœºçš„å›åº”éƒ½æ˜¯â€œå¼‚å¸¸â€è€Œéé”™è¯¯ï¼Œè¿™æ˜¯å› ä¸ºcipheræ•°ç»„çš„ä¸‹æ ‡æœ€å¤šåªèƒ½å–åˆ°29ï¼Œä¸€æ—¦æ¶‰åŠåˆ°cipher[30]ç”šè‡³æ›´å¤šå°±ä¼šäº§ç”Ÿè¶Šç•Œå¼‚å¸¸ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag = <span class="built_in">chr</span>(<span class="number">0</span>) * <span class="number">49</span> + <span class="string">&quot;c&quot;</span></span><br><span class="line">flag = <span class="built_in">chr</span>(<span class="number">0</span>) * <span class="number">48</span> + <span class="string">&quot;c&quot;</span></span><br><span class="line">flag = <span class="built_in">chr</span>(<span class="number">0</span>) * <span class="number">47</span> + <span class="string">&quot;c&quot;</span></span><br><span class="line">......</span><br><span class="line">flag = <span class="built_in">chr</span>(<span class="number">0</span>) * <span class="number">30</span> + <span class="string">&quot;c&quot;</span></span><br></pre></td></tr></table></figure>
<p>ç„¶è€Œå‘é€ä¸‹ä¸€ä¸ªflagä¸²ï¼Œä¹Ÿå°±æ˜¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag = <span class="built_in">chr</span>(<span class="number">0</span>) * <span class="number">29</span> + <span class="string">&quot;c&quot;</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ—¶ï¼Œç”±äºæ²¡æœ‰è¶Šç•Œï¼Œç¨‹åºä¼šå›åº”â€Wrong flag!â€ï¼Œè€Œä¸å†æŠ›å‡ºå¼‚å¸¸äº†ã€‚</p>
<p>æ‰€ä»¥ï¼Œç”±ä¸Šè¿°æ–¹å¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥æœ€ç»ˆç¡®å®šflagçš„çœŸå®é•¿åº¦æ˜¯24ï¼Œä¹‹ååˆ™å¯ä»¥åå¤æ„é€ ä¸‹åˆ—å­—ç¬¦ä¸²ï¼Œå¹¶å‘é€ç»™é¶æœºç«¯æ¥é€ä¸ªæ ¸æŸ¥å­—ç¬¦æ˜¯å¦æ­£ç¡®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> table:</span><br><span class="line">	flag = <span class="string">&quot;cnss&#123;&quot;</span> + i + <span class="built_in">chr</span>(<span class="number">0</span>)*<span class="number">100</span> + <span class="string">&quot;a&quot;</span></span><br></pre></td></tr></table></figure>
<p>é“ç†ä¹Ÿæ˜¯ç›¸åŒçš„ï¼Œå¦‚æœiæ˜¯é”™è¯¯å­—ç¬¦ï¼Œé‚£ä¹ˆæ ¸æŸ¥ä¸é€šè¿‡ï¼Œç¨‹åºç›´æ¥å›åº”â€Wrong flag!â€ï¼Œè€Œå¦‚æœæ˜¯æ­£ç¡®å­—ç¬¦ï¼Œç¨‹åºåˆ™ä¼šç»§ç»­å‘åè¯»ï¼Œä¸€ç›´åˆ°è¯»åˆ°è¶Šç•Œçš„â€aâ€åï¼ŒæŠ›å‡ºè¶Šç•Œå¼‚å¸¸ã€‚</p>
<p>å¾—åˆ°è¿™ä¸ªå­—ç¬¦ä¸º â€œ1â€ åï¼Œå°†ä»–åŠ å…¥â€cnss{â€œä¸²åï¼Œç»§ç»­æ„é€ ä¸‹é¢å­—ç¬¦ä¸²ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> table:</span><br><span class="line">	flag = <span class="string">&quot;cnss&#123;1&quot;</span> + i + <span class="built_in">chr</span>(<span class="number">0</span>)*<span class="number">100</span> + <span class="string">&quot;a&quot;</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æ­¤åå¤å‘é€ç›´è‡³flagä¸²å·²çŸ¥çš„éƒ¨åˆ†é•¿åº¦ä¸º24å³å¯ã€‚</p>
<p>æ„é€ å­—ç¬¦ä¸²å¹¶å‘é€ç»™é¶æœºç«¯éœ€è¦ç”¨åˆ°pwntoolsï¼ŒåŒæ—¶è¿˜æœ‰ä¸€äº›å°ç»†èŠ‚éœ€è¦æ³¨æ„ï¼Œæ¯”å¦‚éœ€è¦å‘é€çš„æ˜¯å­—èŠ‚æµè€Œéå­—ç¬¦ä¸²æµã€‚ä½†æ˜¯è¿™äº›æ…¢æ…¢è°ƒè¯•ç¨‹åºå°±å¥½äº†ã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">table = string.digits + string.ascii_letters + <span class="string">&quot;&#123;&#125;_&quot;</span></span><br><span class="line"></span><br><span class="line">init = <span class="string">b&#x27;cnss&#123;&#x27;</span></span><br><span class="line">has_find = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span>(has_find == <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(table)):</span><br><span class="line">        r=remote(<span class="string">&quot;47.108.140.140&quot;</span>,<span class="number">11037</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r.sendline(init + long_to_bytes(<span class="built_in">ord</span>(table[i])) + <span class="string">b&#x27;\x00&#x27;</span>*<span class="number">100</span> + <span class="string">b&quot;a&quot;</span>)</span><br><span class="line">            temp = r.recvline()</span><br><span class="line">            <span class="keyword">if</span>(<span class="string">b&quot;Correct&quot;</span> <span class="keyword">in</span> temp):</span><br><span class="line">                exit(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">len</span>(init) == <span class="number">23</span>):</span><br><span class="line">                has_find = <span class="number">1</span></span><br><span class="line">                r.close()</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            init += long_to_bytes(<span class="built_in">ord</span>(table[i]))</span><br><span class="line">            <span class="built_in">print</span>(init)</span><br><span class="line">            r.close()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        r.close()</span><br><span class="line"><span class="built_in">print</span>(init + <span class="string">b&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flagï¼š</p>
<p><strong>cnss{1nd3X_0Ut_oF_r4nge}</strong></p>
<p><br></p>
<p>ç¡®å®å¾ˆæœ‰æ„æ€ï¼</p>
]]></content>
      <categories>
        <category>miscè¶£é¢˜</category>
      </categories>
  </entry>
</search>
