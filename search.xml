<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>2023-CNSS-Summer-wp-misc</title>
    <url>/post/22e56931.html</url>
    <content><![CDATA[<p>åšé¢˜è®°å½•</p>
<span id="more"></span>
<p>Rankï¼š3</p>
<p><img src="/post/22e56931/image-20230916080821685.png" alt="image-20230916080821685"></p>
<h3 id="â¤ï¸-Signin"><a href="#â¤ï¸-Signin" class="headerlink" title="â¤ï¸ Signin"></a>â¤ï¸ Signin</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¬è¯´æœ‰äººåœ¨CNSSæ‹›æ–°ç¾¤çš„æŸä¸ªåœ°æ–¹è—äº†ä¸€ä¸ªéšç§˜çš„flagï¼Œåˆ°åº•åœ¨å“ªå‘¢ï¼Ÿ</span><br><span class="line">å¿«æ¥åŠ å…¥æ‹›æ–°ç¾¤431060996</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼šæŒ‰ç…§è¦æ±‚æœç´¢ç¾¤èŠï¼Œç¾¤èŠä»‹ç»ä¸­æœ‰ä¸€æ®µbase64ï¼Œè§£å¯†å¾—flagï¼š</p>
<p><img src="/post/22e56931/image-20230911100902419.png" alt="image-20230911100902419"></p>
<p>flagï¼š</p>
<p><strong>cnss{W3Lc0m3_7o_Cn55_5umm3rï¼}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="ğŸ”-ä¾¦æ¢-CNSS-å¨˜çš„ç§˜å¯†"><a href="#ğŸ”-ä¾¦æ¢-CNSS-å¨˜çš„ç§˜å¯†" class="headerlink" title="ğŸ” ä¾¦æ¢ CNSS å¨˜çš„ç§˜å¯†"></a>ğŸ” ä¾¦æ¢ CNSS å¨˜çš„ç§˜å¯†</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">æ‡’å¾—å†™æ–‡æ¡ˆäº†ï¼Œè¯•ç€æ‰¾å‡º CNSS å¨˜çš„ç§˜å¯†å§</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®é™„ä»¶ä¸ºä¸€å¼ å›¾ç‰‡ï¼š</p>
<p><img src="/post/22e56931/CNSSDoll.png" alt="CNSSDoll"></p>
<p>åå…­è¿›åˆ¶æ‰“å¼€ï¼Œåœ¨æ–‡ä»¶æœ«å°¾çœ‹åˆ°flagï¼š</p>
<p><img src="/post/22e56931/image-20230911101309673.png" alt="image-20230911101309673"></p>
<p>flagï¼š</p>
<p><strong>cnss{W0w!!!Y0u_s4ww_m3!}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="ğŸ†-é‡ç”Ÿä¹‹æˆ‘åœ¨-CNSS-å½“-OIer"><a href="#ğŸ†-é‡ç”Ÿä¹‹æˆ‘åœ¨-CNSS-å½“-OIer" class="headerlink" title="ğŸ† é‡ç”Ÿä¹‹æˆ‘åœ¨ CNSS å½“ OIer"></a>ğŸ† é‡ç”Ÿä¹‹æˆ‘åœ¨ CNSS å½“ OIer</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">é¢˜ç›®æè¿°å’Œè¾“å…¥è¾“å‡ºæ ¼å¼éƒ½æ‰¾ä¸åˆ°äº†...ä½†æ˜¯èº«ä¸ºè¶…çº§ OIER çš„ä½ ä¸€å®šå¯ä»¥ AC æœ¬é¢˜å§</span><br><span class="line"></span><br><span class="line">nc 47.108.140.140 1107</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">SRC = <span class="string">&#x27;/home/ctf/temp/code.c&#x27;</span></span><br><span class="line">BIN = <span class="string">&#x27;/home/ctf/temp/temp_bin&#x27;</span></span><br><span class="line">DATA = <span class="string">&#x27;/home/ctf/data&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">res_map = &#123;</span><br><span class="line">    <span class="string">&#x27;CE&#x27;</span>: <span class="string">&#x27;Compile Error&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;TLE&#x27;</span>: <span class="string">&#x27;Time Limit Exceeded&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;RE&#x27;</span>: <span class="string">&#x27;Runtime Error&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;WA&#x27;</span>: <span class="string">&#x27;Wrong Answer&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;AC&#x27;</span>: <span class="string">&#x27;Accepted&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_excutable</span>(<span class="params">path, <span class="built_in">input</span>, ans, timeout</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.isfile(path):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;CE&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        p = subprocess.run(</span><br><span class="line">            [<span class="string">f&quot;./<span class="subst">&#123;path&#125;</span>&quot;</span>],</span><br><span class="line">            <span class="built_in">input</span>=<span class="built_in">input</span>,</span><br><span class="line">            stdout=subprocess.PIPE,</span><br><span class="line">            stderr=subprocess.STDOUT,</span><br><span class="line">            timeout=timeout</span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">except</span> subprocess.TimeoutExpired:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;TLE&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> p.returncode != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;RE&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        output = p.stdout.decode()</span><br><span class="line">    <span class="keyword">except</span> UnicodeDecodeError:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;WA&#x27;</span></span><br><span class="line"></span><br><span class="line">    lines = output.strip().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;AC&#x27;</span> <span class="keyword">if</span> lines == ans <span class="keyword">else</span> <span class="string">&#x27;WA&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Enter your code (ending with two blank lines):&quot;</span>)</span><br><span class="line"></span><br><span class="line">    code1 = []</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            line = <span class="built_in">input</span>()</span><br><span class="line">        <span class="keyword">except</span> EOFError:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        code1.append(line)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(code1) &gt;= <span class="number">2</span> <span class="keyword">and</span> code1[-<span class="number">1</span>] == <span class="string">&#x27;&#x27;</span> <span class="keyword">and</span> code1[-<span class="number">2</span>] == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(SRC, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> fd1:</span><br><span class="line">        fd1.write(<span class="string">&#x27;\n&#x27;</span>.join(code1))</span><br><span class="line"></span><br><span class="line">    p = subprocess.run(</span><br><span class="line">        [<span class="string">&quot;gcc&quot;</span>, <span class="string">&quot;-w&quot;</span>, <span class="string">&quot;-O2&quot;</span>, SRC, <span class="string">&quot;-o&quot;</span>, BIN],</span><br><span class="line">        stdout=sys.stdout,</span><br><span class="line">        stdin=subprocess.DEVNULL,</span><br><span class="line">        stderr=subprocess.STDOUT</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(os.path.join(DATA, <span class="string">f&#x27;input.in&#x27;</span>), <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        instr = f.read()</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(os.path.join(DATA, <span class="string">f&#x27;output.out&#x27;</span>), <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        ans = f.read().strip().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    res = check_excutable(BIN, instr, ans, <span class="number">0.5</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Result: &#x27;</span>, res_map[res])</span><br><span class="line">    <span class="keyword">if</span> res == <span class="string">&#x27;AC&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>ç®€å•ç¿»è¯‘ä¸€ä¸‹ç¨‹åºåŠŸèƒ½ï¼šè¾“å…¥ä¸€æ®µcè¯­è¨€ä»£ç ï¼Œé€è‡³code.cä¸­ï¼Œè¿›è¡Œç¼–è¯‘åï¼Œå°†input.inä¸­çš„å†…å®¹ä½œä¸ºè¾“å…¥æ‰§è¡Œè¿™æ®µç¨‹åºï¼Œå¹¶å°†ç¨‹åºè¾“å‡ºç»“æœä¸output.outä¸­çš„å†…å®¹åšå¯¹æ¯”ï¼Œå¦‚æœç»“æœä¸€è‡´ï¼Œåˆ™ä¼šè¾“å‡ºflagã€‚</p>
<p>é—®é¢˜åœ¨äºï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“input.inä¸output.outçš„å†…å®¹æ˜¯ä»€ä¹ˆï¼Œä¹Ÿå°±æ— æ³•æ ¹æ®éœ€è¦å†™å‡ºå¯¹åº”ç¨‹åºã€‚å¯æ˜¯å…¶å®å†ä»”ç»†æƒ³æƒ³ï¼Œé¢˜ç›®è¦æ±‚å…¶å®ä»…ä»…æ˜¯è¦æ±‚ç¨‹åºå†…å®¹è¾“å‡ºä¸output.outå†…å®¹ä¸€è‡´è€Œå·²ï¼Œè€Œæ ¹æ®é¢˜ç›®é™„ä»¶ï¼Œoutput.outæ–‡ä»¶å°±åœ¨DATAç›®å½•ä¸‹ï¼Œæ‰€ä»¥å…¶å®åªéœ€è¦å†™ä¸€ä¸ªèƒ½æ‰“å°å‡ºoutput.outå†…å®¹çš„cè¯­è¨€ç¨‹åºå³å¯ã€‚</p>
<p>exp.cï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    FILE *file;</span><br><span class="line">    <span class="type">char</span> filename[] = <span class="string">&quot;/home/ctf/data/output.out&quot;</span>;</span><br><span class="line">    <span class="type">char</span> ch;</span><br><span class="line"></span><br><span class="line">    file = fopen(filename, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">while</span> ((ch = fgetc(file)) != EOF) &#123;</span><br><span class="line">        <span class="built_in">putchar</span>(ch);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fclose(file);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flagï¼š</p>
<p><img src="/post/22e56931/image-20230911102740014.png" alt="image-20230911102740014"></p>
<p>flagï¼š</p>
<p><strong>cnss{y0u_4re_U1tim34ate_01er!}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="â“-æ³»è¯ï¼Œäººåœ¨CNSSï¼Œåˆšæ‰“å®Œæ‹›æ–°"><a href="#â“-æ³»è¯ï¼Œäººåœ¨CNSSï¼Œåˆšæ‰“å®Œæ‹›æ–°" class="headerlink" title="â“ æ³»è¯ï¼Œäººåœ¨CNSSï¼Œåˆšæ‰“å®Œæ‹›æ–°"></a>â“ æ³»è¯ï¼Œäººåœ¨CNSSï¼Œåˆšæ‰“å®Œæ‹›æ–°</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å‚åŠ CNSSæ‹›æ–°èµ›æ˜¯ä¸€ç§æ€æ ·çš„ä½“éªŒå‘¢ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®çš„å…¨éƒ¨ä¿¡æ¯åªæœ‰é¢˜ç›®æ ‡é¢˜å’Œé¢˜ç›®æè¿°ï¼Œæ²¡æœ‰é™„ä»¶ã€æ²¡æœ‰é¶æœºï¼Œå› æ­¤åŸºæœ¬å¯ä»¥ç¡®å®šä¸ºç¤¾å·¥é¢˜ã€‚</p>
<p>ç›´æ¥æœç´¢é¢˜ç›®æè¿°ï¼Œå°±èƒ½åœ¨çŸ¥ä¹ä¸Šæœåˆ°ä¸€ä¸ªå›ç­”ï¼Œæœ€åå°±æœ‰flagï¼š</p>
<p><img src="/post/22e56931/image-20230911103024312.png" alt="image-20230911103024312"></p>
<p>flagï¼š</p>
<p><strong>cnss{L3T_U$_$T4RT!}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="ğŸ”®-æ±æ–¹å¸Œç¼‡ç¬¦"><a href="#ğŸ”®-æ±æ–¹å¸Œç¼‡ç¬¦" class="headerlink" title="ğŸ”® æ±æ–¹å¸Œç¼‡ç¬¦"></a>ğŸ”® æ±æ–¹å¸Œç¼‡ç¬¦</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¯•ç€æ‰¾å‡ºæœ€æ–°æœ€çƒ­ï¼ˆç¡®ä¿¡ï¼‰ä¸œæ–¹æ–°ä½œä¸­çš„ flag å§ï¼</span><br><span class="line">Hintï¼šflag åœ¨æ¸¸æˆèµ„æºåŒ…å†…</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ç»™äº†th08çš„æ¸¸æˆåŒ…ï¼Œç»“åˆhintçŸ¥é“åº”è¯¥æ˜¯è¦å¯¹èµ„æºåŒ…è§£åŒ…å¾—flagã€‚</p>
<p>thxxè§£åŒ…å‚è€ƒï¼š</p>
<p><a href="https://www.bilibili.com/read/cv13353380/">å…³äºä¸œæ–¹projectç³»åˆ—æ­£ä½œçš„é­”æ”¹æ•™ç¨‹ä»¥åŠæ³¨æ„äº‹é¡¹ - å“”å“©å“”å“© (bilibili.com)</a></p>
<p>è·Ÿç€ä¸€æ­¥ä¸€æ­¥åšï¼š</p>
<p>1ã€ä¸‹è½½å·¥å…·</p>
<p>2ã€é€‰æ‹©å¥½æ–‡ä»¶ä¸å¯¹åº”æ¸¸æˆ(th08)ï¼Œè¿›è¡Œè§£åŒ…</p>
<p><img src="/post/22e56931/image-20230911103506296.png" alt="image-20230911103506296"></p>
<p>3ã€åœ¨è§£åŒ…å¾—åˆ°çš„èµ„æºä¸­å‘ç°flag.txt</p>
<p><img src="/post/22e56931/image-20230911103618535.png" alt="image-20230911103618535"></p>
<p>flagï¼š</p>
<p><strong>cnss{Y0u_4re_T0uhou_M4st3er_n0w!}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="ğŸ”‘-Shino-çš„-Crypto-æ¢¦æƒ³"><a href="#ğŸ”‘-Shino-çš„-Crypto-æ¢¦æƒ³" class="headerlink" title="ğŸ”‘ Shino çš„ Crypto æ¢¦æƒ³"></a>ğŸ”‘ Shino çš„ Crypto æ¢¦æƒ³</h3><p>å‚è€ƒæˆ‘å¦ä¸€ç¯‡æ–‡ç« ï¼š</p>
<p><a href="https://tangcuxiaojikuai.xyz/post/77e39860.html#more">miscè¶£é¢˜(ä¸€) | ç³–é†‹å°é¸¡å—çš„blog (tangcuxiaojikuai.xyz)</a></p>
<p><br></p>
<p><br></p>
<h3 id="â˜ï¸-Hurrison-çš„ç½‘ç«™"><a href="#â˜ï¸-Hurrison-çš„ç½‘ç«™" class="headerlink" title="â˜ï¸ Hurrison çš„ç½‘ç«™"></a>â˜ï¸ Hurrison çš„ç½‘ç«™</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Hurrison åˆšåˆšå­¦ä¼šæ­å»ºç½‘ç«™ï¼Œå¬è¯´å¥—äº† Cloudflare ä¹‹åå¤§é»‘å®¢ Casio å°±æ‰¾ä¸åˆ°æœåŠ¡å™¨ IP äº†</span><br><span class="line">Hintï¼šflagæ ¼å¼å¦‚ä¸‹ï¼š</span><br><span class="line">cnss&#123;IPv4&#125;</span><br><span class="line">IPv4 æ ¼å¼ä¸º xxx.xxx.xxx.xxx</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://cnss2023catchme.hurrison.com/</span><br></pre></td></tr></table></figure>
<p>æ ¹æ®é¢˜ç›®æè¿°ï¼Œè¿™é¢˜æ˜¯è¦å¯»æ‰¾éšè—åœ¨Cloudflareä¸‹çš„æœåŠ¡å™¨ipåœ°å€ï¼Œç›´æ¥å¯¹è¿™ä¸ªè¦æ±‚è¿›è¡Œæœç´¢ï¼š</p>
<p><img src="/post/22e56931/image-20230911104238020.png" alt="image-20230911104238020"></p>
<p>é€ä¸ªå°è¯•æ–‡ç« ä¸­çš„æ–¹æ³•ï¼Œæœ€åå‘ç°è¿™ä¸ªæ–¹æ³•å¾ˆæœ‰æ•ˆæœï¼š</p>
<p><img src="/post/22e56931/image-20230911104618404.png" alt="image-20230911104618404"></p>
<p>åˆ°<a href="https://securitytrails.com/">SecurityTrails: Data Security, Threat Hunting, and Attack Surface Management Solutions for Security Teams</a>æœç´¢å¯¹åº”URLï¼Œå¹¶ä¸èƒ½ç›´æ¥åœ¨å†å²æ•°æ®é‡Œçœ‹åˆ°ç»“æœã€‚å¼€ä¸€å¼€è„‘æ´ï¼Œæœç´¢hurrison.comï¼Œå°±æœ‰å¾ˆå¤šå­åŸŸåï¼š</p>
<p><img src="/post/22e56931/image-20230911111836344.png" alt="image-20230911111836344"></p>
<p>é€ä¸ªæŸ¥çœ‹ï¼Œå¹¶ç»“åˆCensysé€ä¸ªæœç´¢åŸŸåï¼Œå¦‚ä¸‹ï¼š</p>
<p><img src="/post/22e56931/image-20230911112020297.png" alt="image-20230911112020297"></p>
<p>æ‰¾åˆ°ä¸€ä¸ªåœ¨ç»™å®šèŒƒå›´å†…çš„ipåœ°å€å°±å¯ä»¥äº†ã€‚</p>
<p>flagï¼š</p>
<p><strong>cnss{103.239.247.22}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="ğŸ’»-cn55Terminal"><a href="#ğŸ’»-cn55Terminal" class="headerlink" title="ğŸ’» cn55Terminal"></a>ğŸ’» cn55Terminal</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">é¢˜ç›®æè¿°åˆå¿˜äº†ï¼Œå‡‘åˆç”¨å§ğŸ‘‡</span><br><span class="line">curl -sL https://transfer.sh/VKyC2P8CPw/id.txt | nc 124.221.34.13 50024</span><br><span class="line">Update: ä¸ºé¿å…è¿™è¡Œå‘½ä»¤å¯èƒ½é€ æˆä¸å¿…è¦çš„è¯¯è§£ï¼Œè¿˜æ˜¯è¯•è¯•æ‰‹åŠ¨ä½“éªŒ cn55Terminal å§~</span><br><span class="line">å¦‚æœä½ è®¿é—®ä¸äº†ï¼Œæˆ–è€…æƒ³æ‰‹åŠ¨ï¼Œè¿™é‡Œä¹Ÿè´´å‡º id.txt</span><br></pre></td></tr></table></figure>
<p>id.txtï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">......................................</span><br><span class="line">......................................</span><br><span class="line">......................................</span><br><span class="line">.@@...........@@......................</span><br><span class="line">.@@...........@@......................</span><br><span class="line">..............@@......................</span><br><span class="line">..............@@......................</span><br><span class="line">..............@@......................</span><br><span class="line">.@@.....@@@@@@@@......................</span><br><span class="line">.@@....@@@@@@@@@......................</span><br><span class="line">.@@...@@@@@@@@@@......................</span><br><span class="line">.@@...@@@....@@@......................</span><br><span class="line">.@@...@@@....@@@......................</span><br><span class="line">.@@...@@@.....@@......................</span><br><span class="line">.@@...@@@....@@@......................</span><br><span class="line">.@@...@@@....@@@......................</span><br><span class="line">.@@...@@@@@@@@@@......................</span><br><span class="line">.@@...@@@@@@@@@@......................</span><br><span class="line">.@@....@@@@@@@@@......................</span><br><span class="line">......................................</span><br><span class="line">......................................</span><br><span class="line">......................................</span><br></pre></td></tr></table></figure>
<p>xshellæ‰“å¼€ï¼Œç¼©å°ç•Œé¢çœ‹åˆ°çš„å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<p><img src="/post/22e56931/image-20230911144054892.png" alt="image-20230911144054892"></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå‘½ä»¤è¡Œå‰çš„å†…å®¹ä»¥å­—ç¬¦ç”»çš„å½¢å¼å±•ç¤ºå‡ºæ¥äº†ï¼Œåˆç†çŒœæµ‹ï¼Œè¿™é“é¢˜çš„æ„æ€æ˜¯è¯†åˆ«å­—ç¬¦ç”»å½¢å¼çš„æŒ‡ä»¤å¹¶æ‰§è¡Œã€‚è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å°±éœ€è¦è¾“å…¥å­—ç¬¦ç”»å½¢å¼çš„linuxæŒ‡ä»¤ã€‚å…ˆè¯•ä¸€è¯•å°†é¢˜ç›®ç»™å‡ºçš„idä¸Šä¼ ï¼Œçœ‹çœ‹è¿”å›å†…å®¹ï¼š</p>
<p><img src="/post/22e56931/image-20230911144414307.png" alt="image-20230911144414307"></p>
<p>å¯ä»¥çœ‹å‡ºç¡®å®å’Œæƒ³è±¡çš„ä¸€æ¨¡ä¸€æ ·ï¼Œç»ˆç«¯æ‰§è¡Œäº†idæŒ‡ä»¤ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯æ‰¾è„šæœ¬ï¼Œå°†â€cat flagâ€ç”Ÿæˆä¸ºå­—ç¬¦ç”»ã€‚æœ€åæ‰¾åˆ°äº†ä¸€ä¸ªè„šæœ¬ï¼Œä½†æ˜¯ä»–åªèƒ½å°†å›¾ç‰‡è½¬åŒ–ä¸ºå­—ç¬¦ç”»ï¼Œæ²¡äº‹ï¼Œå…ˆç”Ÿæˆä¸€å¼ å›¾ç‰‡ï¼š</p>
<p><img src="/post/22e56931/image-20230911144603284.png" alt="image-20230911144603284"></p>
<p>ç„¶åç”¨å¦‚ä¸‹è„šæœ¬è½¬åŒ–ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&#x27;1.png&#x27;</span>)</span><br><span class="line">out_img = img.convert(<span class="string">&#x27;L&#x27;</span>)  <span class="comment"># å›¾ç‰‡è½¬æ¢ä¸ºç°åº¦æ¨¡å¼</span></span><br><span class="line">w, h = out_img.size  <span class="comment"># è¿”å›å›¾ç‰‡å¤§å°</span></span><br><span class="line">n=<span class="number">600</span>/<span class="built_in">max</span>(w,h) <span class="comment">#å›¾åƒç¼©å°å€æ•°ï¼Œä¸ç„¶å›¾ç‰‡è½¬æ¢åä¼šå¾ˆå¤§</span></span><br><span class="line"><span class="keyword">if</span> n&lt;<span class="number">1</span>:</span><br><span class="line">   out_img = out_img.resize((<span class="built_in">int</span>(w * n), <span class="built_in">int</span>(h * n*<span class="number">0.5</span>)))  <span class="comment"># å› å­—ç¬¦çš„å®½åº¦ä¸€èˆ¬å¤§äº2å€çš„é«˜åº¦</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">   out_img = out_img.resize((<span class="built_in">int</span>(w), <span class="built_in">int</span>(h )))</span><br><span class="line">w, h = out_img.size</span><br><span class="line"><span class="comment">#asciis=&#x27;$@B%8&amp;WM#*oahkbdpqwmZO0QLCJUYXzcvunxrjft/\\|()1&#123;&#125;[]?-_+~&lt;&gt;i!lI;:,&quot;^\ &#x27;</span></span><br><span class="line">asciis = <span class="string">&quot;@.&quot;</span>  <span class="comment"># ç°åº¦è¡¨</span></span><br><span class="line">texts = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(h):</span><br><span class="line"> <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(w):</span><br><span class="line">       gray = out_img.getpixel((col, row))</span><br><span class="line">       texts += asciis[<span class="built_in">int</span>(gray / <span class="number">255</span> * (<span class="built_in">len</span>(asciis) - <span class="number">1</span>))]  <span class="comment"># æ ¹æ®ç°åº¦å€¼é€‰æ‹©ä¸åŒå¤æ‚åº¦çš„ ASCII å­—ç¬¦</span></span><br><span class="line"> texts += <span class="string">&#x27;\n&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(texts)</span><br><span class="line">    file.close()</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°1.txtæ–‡ä»¶ï¼Œæ‰“å¼€å³æ˜¯å­—ç¬¦ç”»ï¼š</p>
<p><img src="/post/22e56931/image-20230911144716398.png" alt="image-20230911144716398"></p>
<p>ä¸Šä¼ ç»™Terminalï¼Œå³å¾—åˆ°flagï¼š</p>
<p><img src="/post/22e56931/image-20230911144745871.png" alt="image-20230911144745871"></p>
<p>flagï¼š</p>
<p><strong>cnss{funny_ascii_ocr_duibudui}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>miscçš„çŸ¥è¯†é¢æ¶‰åŠå¾ˆå¹¿ï¼Œå¾ˆå¤šçŸ¥è¯†éƒ½æ˜¯è¾¹åšé¢˜è¾¹å­¦ï¼Œå¾ˆå¤šå·¥å…·ä¹Ÿæ˜¯è¾¹åšé¢˜è¾¹ä¸‹çš„ï¼Œä¸€ç‚¹ä¸€ç‚¹ç§¯ç´¯å§ã€‚</p>
]]></content>
      <categories>
        <category>wp-misc</category>
      </categories>
  </entry>
  <entry>
    <title>2023-0xGame-week1-wp-crypto</title>
    <url>/post/6a80d23a.html</url>
    <content><![CDATA[<p>æ¯”èµ›è®°å½•</p>
<span id="more"></span>
<h3 id="Week-1-Whatâ€™s-CBC"><a href="#Week-1-Whatâ€™s-CBC" class="headerlink" title="[Week 1] Whatâ€™s CBC?"></a>[Week 1] Whatâ€™s CBC?</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç»å…¸çš„åŠ å¯†é¢„å¤„ç†ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag,key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bytes_xor</span>(<span class="params">a,b</span>):</span><br><span class="line">	a,b=bytes_to_long(a),bytes_to_long(b)</span><br><span class="line">	<span class="keyword">return</span> long_to_bytes(a^b)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">text</span>):</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(text)%<span class="number">8</span>:</span><br><span class="line">		<span class="keyword">return</span> text</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		pad = <span class="number">8</span>-(<span class="built_in">len</span>(text)%<span class="number">8</span>)</span><br><span class="line">		text += pad.to_bytes(<span class="number">1</span>,<span class="string">&#x27;big&#x27;</span>)*pad</span><br><span class="line">		<span class="keyword">return</span> text</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Encrypt_CBC</span>(<span class="params">text,iv,key</span>):</span><br><span class="line">	result = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">	text = pad(text)</span><br><span class="line">	block=[text[_*<span class="number">8</span>:(_+<span class="number">1</span>)*<span class="number">8</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(text)//<span class="number">8</span>)]</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> block:</span><br><span class="line">		tmp = bytes_xor(iv,i)</span><br><span class="line">		iv = encrypt(tmp,key)</span><br><span class="line">		result += iv</span><br><span class="line">	<span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">text,key</span>):</span><br><span class="line">	result = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> text:</span><br><span class="line">		result += ((i^key)).to_bytes(<span class="number">1</span>,<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">	<span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">iv = <span class="string">b&#x27;11111111&#x27;</span></span><br><span class="line">enc = (Encrypt_CBC(flag,iv,key))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;enc = <span class="subst">&#123;enc&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#enc = b&quot;\x8e\xc6\xf9\xdf\xd3\xdb\xc5\x8e8q\x10f&gt;7.5\x81\xcc\xae\x8d\x82\x8f\x92\xd9o&#x27;D6h8.d\xd6\x9a\xfc\xdb\xd3\xd1\x97\x96Q\x1d&#123;\\TV\x10\x11&quot;</span></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®æ¯”è¾ƒç®€å•ï¼Œå°±ä¸æ¢³ç†æµç¨‹äº†ï¼Œä¸»è¦æ¼æ´åœ¨äºencryptå‡½æ•°ä¸­ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">result += ((i^key)).to_bytes(<span class="number">1</span>,<span class="string">&#x27;big&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œkeyåªç”¨äº†æœ€ä½çš„ä¸€ä¸ªå­—èŠ‚æ¥è¿›è¡ŒåŠ å¯†ï¼Œå› æ­¤æœ‰ä¸¤ç§æ€è·¯ï¼š</p>
<ul>
<li>çˆ†ç ´256ç§å¯èƒ½çš„keyï¼Œå‡è¿›è¡Œè§£å¯†ï¼Œåœ¨è§£å¯†å‡ºæ¥çš„æ–‡æœ¬ä¸­ï¼Œæœ‰0xGameçš„flagå¤´å³ä¸ºæ­£ç¡®è§£å¯†</li>
<li>ç”¨å·²çŸ¥çš„0xGameè¿™ä¸ªflagå¤´ç›´æ¥ç¡®å®škeyï¼Œå†è¿›è¡Œè§£å¯†</li>
</ul>
<p>ä¸ç®¡ç”¨å“ªä¸ªæ€è·¯ï¼Œæœ€ç»ˆå‘ç°keyçš„æœ€ä½å­—èŠ‚æ˜¯ bâ€™\x8fâ€™</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bytes_xor</span>(<span class="params">a,b</span>):</span><br><span class="line">	a,b=bytes_to_long(a),bytes_to_long(b)</span><br><span class="line">	<span class="keyword">return</span> long_to_bytes(a^b)</span><br><span class="line"></span><br><span class="line">enc = <span class="string">b&quot;\x8e\xc6\xf9\xdf\xd3\xdb\xc5\x8e8q\x10f&gt;7.5\x81\xcc\xae\x8d\x82\x8f\x92\xd9o&#x27;D6h8.d\xd6\x9a\xfc\xdb\xd3\xd1\x97\x96Q\x1d&#123;\\TV\x10\x11&quot;</span></span><br><span class="line">iv = <span class="string">b&#x27;11111111&#x27;</span></span><br><span class="line">key = <span class="number">8</span>*<span class="string">b&#x27;\x8f&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">	<span class="built_in">print</span>(<span class="built_in">str</span>(bytes_xor(bytes_xor(enc[<span class="number">8</span>*i:<span class="number">8</span>*i+<span class="number">8</span>],iv),key))[<span class="number">2</span>:-<span class="number">1</span>],end = <span class="string">&quot;&quot;</span>)</span><br><span class="line">	iv = enc[<span class="number">8</span>*i:<span class="number">8</span>*i+<span class="number">8</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#0xGame&#123;098f6bcd4621d373cade4e832627b4f6&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="Week-1-å¯†ç ï¼Œè§…ç ï¼Œå…ˆæœ‰-å†å¯†"><a href="#Week-1-å¯†ç ï¼Œè§…ç ï¼Œå…ˆæœ‰-å†å¯†" class="headerlink" title="[Week 1] å¯†ç ï¼Œè§…ç ï¼Œå…ˆæœ‰*å†å¯†"></a>[Week 1] å¯†ç ï¼Œè§…ç ï¼Œå…ˆæœ‰*å†å¯†</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">åœ¨å¼€å§‹æŒ‘æˆ˜BOSSå‰ï¼Œå…ˆæ¥é€šå…³æ–°æ‰‹æ‘å§</span><br></pre></td></tr></table></figure>
<p>hintï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Hint 1: Test your python</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag <span class="comment">#ä»ä¸­å¯¼å…¥ç§˜å¯†çš„flagï¼Œè¿™æ˜¯æˆ‘ä»¬è¦ç ´è§£çš„ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long <span class="comment">#ä»å‡½æ•°åº“å¯¼å…¥ä¸€äº›ç¼–ç å‡½æ•°</span></span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"></span><br><span class="line">flag = flag.encode()</span><br><span class="line">lent = <span class="built_in">len</span>(flag)</span><br><span class="line">flag = [flag[i*(lent//<span class="number">4</span>):(i+<span class="number">1</span>)*(lent//<span class="number">4</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line">c1 = bytes_to_long(flag[<span class="number">0</span>])</span><br><span class="line">c2 = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">str</span>(<span class="built_in">bin</span>(i))[<span class="number">2</span>:] <span class="keyword">for</span> i <span class="keyword">in</span> flag[<span class="number">1</span>]])</span><br><span class="line">c3 = b64encode(flag[<span class="number">2</span>])</span><br><span class="line">c4 = flag[<span class="number">3</span>].<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c1?= <span class="subst">&#123;<span class="built_in">pow</span>(c1,<span class="number">5</span>)&#125;</span>\nc2 = <span class="subst">&#123;c2&#125;</span>\nc3 = <span class="subst">&#123;c3&#125;</span>\nc4 = <span class="subst">&#123;c4&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c1?= 2607076237872456265701394408859286660368327415582106508683648834772020887801353062171214554351749058553609022833985773083200356284531601339221590756213276590896143894954053902973407638214851164171968630602313844022016135428560081844499356672695981757804756591891049233334352061975924028218309004551</span></span><br><span class="line"><span class="string">c2 = 10010000100001101110100010100111101000111110010010111010100001101110010010111111101000011110011010000001101011111110011010011000101011111110010110100110100000101110010010111101100101011110011110111100</span></span><br><span class="line"><span class="string">c3 = b&#x27;lueggeeahO+8jOmCo+S5iOW8gOWni+aIkQ==&#x27;</span></span><br><span class="line"><span class="string">c4 = e4bbace79a8443727970746fe68c91e68898e590a72121217d</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment">#å…¨æ˜¯ä¹±ç ï¼Œé‚£å’‹åŠå˜›ï¼Ÿ</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°flagè¢«åˆ†ä¸ºå››ä»½ï¼Œè¿›è¡Œä¸åŒçš„ç¼–ç ï¼Œé‚£ä¹ˆé¦–å…ˆè¦å¯¹åº”è§£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">b&#x27;0xGame&#123; \xe6\x81\xad\xe5\x96\x9c\xe4\xbd\xa0,\xe5\xb7\xb2\xe7\xbb\x8f\xe7&#x27;</span></span><br><span class="line"><span class="string">b&#x27;\x90\x86\xe8\xa7\xa3\xe4\xba\x86\xe4\xbf\xa1\xe6\x81\xaf\xe6\x98\xaf\xe5\xa6\x82\xe4\xbd\x95\xe7\xbc&#x27;</span></span><br><span class="line"><span class="string">b&#x27;\x96\xe7\xa0\x81\xe7\x9a\x84\xef\xbc\x8c\xe9\x82\xa3\xe4\xb9\x88\xe5\xbc\x80\xe5\xa7\x8b\xe6\x88\x91&#x27;</span></span><br><span class="line"><span class="string">b&#x27;\xe4\xbb\xac\xe7\x9a\x84Crypto\xe6\x8c\x91\xe6\x88\x98\xe5\x90\xa7!!!&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>è§£å‡ºæ¥åï¼Œå‘ç°è§£å¯†å†…å®¹é™¤äº†flagå¤´å°¾ï¼Œå‰©ä¸‹çš„ä»ç„¶æ˜¯å­—èŠ‚æµï¼ŒçŒœæµ‹å¯èƒ½æ˜¯æ±‰å­—ç¼–ç ï¼Œè§£ç å³å¯</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"></span><br><span class="line">c1 = <span class="number">2607076237872456265701394408859286660368327415582106508683648834772020887801353062171214554351749058553609022833985773083200356284531601339221590756213276590896143894954053902973407638214851164171968630602313844022016135428560081844499356672695981757804756591891049233334352061975924028218309004551</span></span><br><span class="line">c1 = iroot(c1,<span class="number">5</span>)[<span class="number">0</span>]</span><br><span class="line">c2 = <span class="string">&quot;10010000100001101110100010100111101000111110010010111010100001101110010010111111101000011110011010000001101011111110011010011000101011111110010110100110100000101110010010111101100101011110011110111100&quot;</span></span><br><span class="line">c3 = <span class="string">b&#x27;lueggeeahO+8jOmCo+S5iOW8gOWni+aIkQ==&#x27;</span></span><br><span class="line">c4 = <span class="string">&quot;e4bbace79a8443727970746fe68c91e68898e590a72121217d&quot;</span></span><br><span class="line"></span><br><span class="line">t1 = long_to_bytes(c1)</span><br><span class="line">t2 = long_to_bytes(<span class="built_in">int</span>(c2,<span class="number">2</span>))</span><br><span class="line">t3 = b64decode(c3)</span><br><span class="line">t4 = long_to_bytes(<span class="built_in">int</span>(c4,<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line">t = t1+t2+t3+t4</span><br><span class="line"><span class="built_in">print</span>(t.decode())</span><br><span class="line"></span><br><span class="line"><span class="comment">#0xGame&#123; æ­å–œä½ ,å·²ç»ç†è§£äº†ä¿¡æ¯æ˜¯å¦‚ä½•ç¼–ç çš„ï¼Œé‚£ä¹ˆå¼€å§‹æˆ‘ä»¬çš„CryptoæŒ‘æˆ˜å§!!!&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="Week-1-Take-my-bag"><a href="#Week-1-Take-my-bag" class="headerlink" title="[Week 1] Take my bag!"></a>[Week 1] Take my bag!</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æˆ‘åŒ…å‘¢ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m</span>):</span><br><span class="line">	m = <span class="built_in">str</span>(<span class="built_in">bin</span>(m))[<span class="number">2</span>:][::-<span class="number">1</span>]</span><br><span class="line">	enc = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">		enc += init[i] * <span class="built_in">int</span>(m[i]) % n</span><br><span class="line">	<span class="keyword">return</span> enc</span><br><span class="line"></span><br><span class="line">w = getPrime(<span class="number">64</span>)</span><br><span class="line">n = getPrime(<span class="number">512</span>)</span><br><span class="line">init = [w*<span class="built_in">pow</span>(<span class="number">3</span>, i) % n <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">512</span>)]</span><br><span class="line"></span><br><span class="line">c = encrypt(bytes_to_long(flag))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;w=<span class="subst">&#123;w&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n=<span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c=<span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">w=16221818045491479713</span></span><br><span class="line"><span class="string">n=9702074289348763131102174377899883904548584105641045150269763589431293826913348632496775173099776917930517270317586740686008539085898910110442820776001061</span></span><br><span class="line"><span class="string">c=4795969289572314590787467990865205548430190921556722879891721107719262822789483863742356553249935437004378475661668768893462652103739250038700528111</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>ä¸€ä¸ªèƒŒåŒ…åŠ å¯†ï¼Œéœ€è¦æ³¨æ„åˆ°çš„æ˜¯è¿™é‡Œçš„ pow(3, i) æ˜¯ä¸€ä¸ªè¶…é€’å¢åºåˆ—ï¼Œå› æ­¤æœ‰ä¸¤ç§æ–¹æ³•ï¼š</p>
<ul>
<li>ç›´æ¥å½“ä½œæ™®é€šèƒŒåŒ…åŠ å¯†ï¼Œç”¨æ ¼åŸºè§„çº¦åš</li>
<li>å¦‚æœflagé•¿åº¦è¾ƒçŸ­ï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½å‰é¢çš„èƒŒåŒ…åŠ å¯†æ ¹æœ¬æ²¡æœ‰å–æ¨¡ï¼Œå¯ä»¥ç›´æ¥å½“ä½œè¶…é€’å¢åºåˆ—è§£å¯†</li>
</ul>
<p>æ— è®ºå“ªä¸ªæ–¹æ³•éƒ½ä¸éº»çƒ¦ï¼Œå½“ç„¶å› ä¸ºæ˜¯æ–°ç”Ÿèµ›æ‰€ä»¥æ¨èå…ˆå­¦ä¼šç¬¬äºŒç§æ–¹æ³•</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">w=<span class="number">16221818045491479713</span></span><br><span class="line">n=<span class="number">9702074289348763131102174377899883904548584105641045150269763589431293826913348632496775173099776917930517270317586740686008539085898910110442820776001061</span></span><br><span class="line">c=<span class="number">4795969289572314590787467990865205548430190921556722879891721107719262822789483863742356553249935437004378475661668768893462652103739250038700528111</span></span><br><span class="line"></span><br><span class="line">init = [w*<span class="built_in">pow</span>(<span class="number">3</span>, i) % n <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">512</span>)]</span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(init)</span><br><span class="line">L = Matrix(ZZ, n+<span class="number">1</span>, n+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    L[i,i] = <span class="number">1</span></span><br><span class="line">    L[i,-<span class="number">1</span>] = init[i]</span><br><span class="line">L[-<span class="number">1</span>,-<span class="number">1</span>] = -c</span><br><span class="line"></span><br><span class="line">res = L.LLL()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n + <span class="number">1</span>):</span><br><span class="line">    M = res.row(i).<span class="built_in">list</span>()</span><br><span class="line">    flag = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> M:</span><br><span class="line">        <span class="keyword">if</span> m != <span class="number">0</span> <span class="keyword">and</span> m != <span class="number">1</span>:</span><br><span class="line">            flag = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(i, M)</span><br><span class="line"></span><br><span class="line">m = [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">    m[i] = <span class="built_in">str</span>(m[i])</span><br><span class="line">m = <span class="string">&quot;&quot;</span>.join(m)[::-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m,<span class="number">2</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#0xGame&#123;Welc0me_2_Crypt0_G@me!#$&amp;%&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="Week-1-BabyRSA"><a href="#Week-1-BabyRSA" class="headerlink" title="[Week 1] BabyRSA"></a>[Week 1] BabyRSA</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç»å…¸çš„æ•°å­¦ï¼Œç»å…¸çš„ç®—æ³•</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getN</span>():</span><br><span class="line">	N = <span class="number">1</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">		tmp = getPrime(<span class="number">32</span>)</span><br><span class="line">		N *= tmp</span><br><span class="line">	<span class="keyword">return</span> N</span><br><span class="line"></span><br><span class="line">mask = getrandbits(<span class="number">256</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = getN()</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m*mask,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e = <span class="subst">&#123;e&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;mask = <span class="subst">&#123;mask&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 93099494899964317992000886585964221136368777219322402558083737546844067074234332564205970300159140111778084916162471993849233358306940868232157447540597</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">c = 54352122428332145724828674757308827564883974087400720449151348825082737474080849774814293027988784740602148317713402758353653028988960687525211635107801</span></span><br><span class="line"><span class="string">mask = 54257528450885974256117108479579183871895740052660152544049844968621224899247</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>å¤šç´ æ•°çš„RSAï¼Œfactordbåˆ†è§£åç›´æ¥è§£å¯†å³å¯ï¼Œæœ€åè¿˜éœ€ä¹˜ä¸Šmaskçš„é€†å…ƒ</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">93099494899964317992000886585964221136368777219322402558083737546844067074234332564205970300159140111778084916162471993849233358306940868232157447540597</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">54352122428332145724828674757308827564883974087400720449151348825082737474080849774814293027988784740602148317713402758353653028988960687525211635107801</span></span><br><span class="line">mask = <span class="number">54257528450885974256117108479579183871895740052660152544049844968621224899247</span></span><br><span class="line"></span><br><span class="line">plist = [<span class="number">2329990801</span>, <span class="number">2436711469</span>, <span class="number">2732757047</span>, <span class="number">2770441151</span>, <span class="number">2821163021</span>, <span class="number">2864469667</span>, <span class="number">2995527113</span>, <span class="number">3111632101</span>, <span class="number">3162958289</span>, <span class="number">3267547559</span>, <span class="number">3281340371</span>, <span class="number">3479527847</span>, <span class="number">3561068417</span>, <span class="number">3978177241</span>, <span class="number">4134768233</span>, <span class="number">4160088337</span>]</span><br><span class="line">phi = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> plist:</span><br><span class="line">    phi *= (i-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">mmask = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">m = mmask // mask</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment">#0xGame&#123;Magic_M@th_Make_Crypt0&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="Week-1-çŒœè°œ"><a href="#Week-1-çŒœè°œ" class="headerlink" title="[Week 1] çŒœè°œ"></a>[Week 1] çŒœè°œ</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä»€ä¹ˆæƒ…å†µï¼Œå¯†é’¥ä¸è§äº†ï¼Ÿ(flagæ ¼å¼: 0xGame&#123;&#125;)</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag,key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">text</span>):</span><br><span class="line">	code = <span class="string">&#x27;AP3IXYxn4DmwqOlT0Q/JbKFecN8isvE6gWrto+yf7M5d2pjBuk1Hh9aCRZGUVzLS&#x27;</span></span><br><span class="line">	text = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">str</span>(<span class="built_in">bin</span>(i))[<span class="number">2</span>:].zfill(<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> text])</span><br><span class="line">	length = <span class="built_in">len</span>(text)</span><br><span class="line">	pad = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">	<span class="keyword">if</span> length%<span class="number">3</span> == <span class="number">1</span>:</span><br><span class="line">		text += <span class="string">&#x27;00&#x27;</span></span><br><span class="line">		pad = <span class="string">b&#x27;==&#x27;</span></span><br><span class="line">	<span class="keyword">elif</span> length%<span class="number">3</span> == <span class="number">2</span>:</span><br><span class="line">		text += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">		pad = <span class="string">b&#x27;=&#x27;</span></span><br><span class="line">	result = [code[<span class="built_in">int</span>(text[<span class="number">3</span>*i:<span class="number">3</span>*(i+<span class="number">1</span>)],<span class="number">2</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(text)//<span class="number">3</span>)]</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result).encode()+pad</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">flag</span>):</span><br><span class="line">	result = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">		result += (key[i%<span class="number">7</span>]^(flag[i]+i)).to_bytes(<span class="number">1</span>,<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">	<span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = enc(encrypt(flag))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = b&#x27;IPxYIYPYXPAn3nXX3IXA3YIAPn3xAYnYnPIIPAYYIA3nxxInXAYnIPAIxnXYYYIXIIPAXn3XYXIYAA3AXnx=&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>åŠ å¯†æµç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>flag æ˜¯ä¸€ä¸ªå­—èŠ‚æµï¼Œè®°å…¶é•¿åº¦ä¸º l</li>
<li>å°† flag[i] + i ä¸ key[i%7] å¼‚æˆ–ï¼Œå¹¶è½¬ä¸ºä¸€ä¸ªå­—èŠ‚åï¼Œå¾—åˆ° encrypt(flag)</li>
<li>å°† encrypt(flag) è¿›è¡Œ enc åŠ å¯†</li>
</ul>
<p>å…¶ä¸­ï¼ŒencåŠ å¯†è¿‡ç¨‹ä¸ºï¼š</p>
<ul>
<li>å°† encrypt(flag) çš„æ¯ä¸ªå­—èŠ‚è½¬åŒ–ä¸ºäºŒè¿›åˆ¶ï¼Œå¹¶è¡¥é½ 8 ä½</li>
<li>æŠŠæ¯ä¸ªå­—èŠ‚çš„äºŒè¿›åˆ¶å†æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œå¾—åˆ°ä¸€ä¸ª01ä¸²</li>
<li>å°†01ä¸²æ¯ä¸‰ä½è½¬åŒ–ä¸ºåè¿›åˆ¶æ•°ï¼Œä½œä¸ºå½“å‰éœ€æ·»åŠ çš„å¯†æ–‡å­—ç¬¦åœ¨ code ä¸­çš„ä¸‹æ ‡</li>
<li>æ·»åŠ å®Œæ‰€æœ‰å¯†æ–‡åï¼Œå¡«å……ä¸Šå¯¹åº”è¡¥å……å­—èŠ‚ï¼Œä½œä¸ºå¯†æ–‡ç»™å‡º</li>
</ul>
<p>é‚£ä¹ˆè§£å¯†æµç¨‹å°±æ˜¯ï¼šå…ˆæ¢å¤ encï¼Œå†æ¢å¤ encrypt</p>
<p>encçš„æ¢å¤æ˜¯å®¹æ˜“çš„ï¼Œç®€å•é€†å‘å›å»å°±è¡Œï¼Œå½“ç„¶éœ€è¦æ³¨æ„ä¸€ä¸‹è§£å¡«å……ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">code = <span class="string">&#x27;AP3IXYxn4DmwqOlT0Q/JbKFecN8isvE6gWrto+yf7M5d2pjBuk1Hh9aCRZGUVzLS&#x27;</span></span><br><span class="line">c = <span class="string">&#x27;IPxYIYPYXPAn3nXX3IXA3YIAPn3xAYnYnPIIPAYYIA3nxxInXAYnIPAIxnXYYYIXIIPAXn3XYXIYAA3AXnx&#x27;</span></span><br><span class="line"></span><br><span class="line">temp = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    t = code.index(i)</span><br><span class="line">    temp += <span class="built_in">str</span>(<span class="built_in">bin</span>(t)[<span class="number">2</span>:].zfill(<span class="number">3</span>))</span><br><span class="line">temp = temp[:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">enc = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(temp)//<span class="number">8</span>):</span><br><span class="line">    enc.append(<span class="built_in">int</span>(temp[<span class="number">8</span>*i:<span class="number">8</span>*i+<span class="number">8</span>],<span class="number">2</span>))</span><br></pre></td></tr></table></figure>
<p>ç„¶åå°±æ˜¯æ¢å¤encryptï¼Œæ³¨æ„åˆ°æˆ‘ä»¬æ‹¥æœ‰flagå¤´0xGame{ï¼Œåˆšå¥½ä¸ƒä¸ªï¼Œå› æ­¤å¯ä»¥ç›´æ¥æ¢å¤å¯†é’¥ï¼Œç„¶åå¯¹åº”è§£å¯†</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">code = <span class="string">&#x27;AP3IXYxn4DmwqOlT0Q/JbKFecN8isvE6gWrto+yf7M5d2pjBuk1Hh9aCRZGUVzLS&#x27;</span></span><br><span class="line">c = <span class="string">&#x27;IPxYIYPYXPAn3nXX3IXA3YIAPn3xAYnYnPIIPAYYIA3nxxInXAYnIPAIxnXYYYIXIIPAXn3XYXIYAA3AXnx&#x27;</span></span><br><span class="line"></span><br><span class="line">temp = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    t = code.index(i)</span><br><span class="line">    temp += <span class="built_in">str</span>(<span class="built_in">bin</span>(t)[<span class="number">2</span>:].zfill(<span class="number">3</span>))</span><br><span class="line">temp = temp[:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">enc = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(temp)//<span class="number">8</span>):</span><br><span class="line">    enc.append(<span class="built_in">int</span>(temp[<span class="number">8</span>*i:<span class="number">8</span>*i+<span class="number">8</span>],<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">prefix = <span class="string">&quot;0xGame&#123;&quot;</span></span><br><span class="line">key = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    key.append((enc[i])^(<span class="built_in">ord</span>(prefix[i])+i))</span><br><span class="line"></span><br><span class="line">result = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    result += ((key[i%<span class="number">7</span>]^((enc[i])))-i).to_bytes(<span class="number">1</span>,<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="comment">#0xGame&#123;Kn0wn_pl@intext_Att@ck!&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="Week-1-Vigenere"><a href="#Week-1-Vigenere" class="headerlink" title="[Week 1] Vigenere"></a>[Week 1] Vigenere</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¯†æ–‡ï¼š0dGmqk&#123;79ap4i0522g0a67m6i196he52357q60f&#125; å¤è€è€Œç¥ç§˜çš„åŠ å¯†æ–¹å¼ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>æ²¡æœ‰é™„ä»¶ï¼Œé‚£ä¹ˆç»“åˆé¢˜ç›®å†…å®¹å°±çŸ¥é“ç”¨çš„æ˜¯VigenereåŠ å¯†ï¼Œä¸Šcyberchefï¼Œç›´æ¥ç”¨flagå¤´å°±èƒ½çœ‹å‡ºå¯†é’¥æ˜¯gameï¼š</p>
<p><img src="/post/6a80d23a/image-20231001192856742.png" alt="image-20231001192856742"></p>
<p>é‚£ä¹ˆç”¨gameè§£å¯†å°±å¥½ï¼š</p>
<p><img src="/post/6a80d23a/image-20231001192949166.png" alt="image-20231001192949166"></p>
<p>flag:</p>
<p><strong>0xGame{79ad4e0522a0a67a6e196be52357e60b}</strong></p>
<p><br></p>
<p><br></p>
]]></content>
      <categories>
        <category>wp-crypto</category>
      </categories>
  </entry>
  <entry>
    <title>2023-0xGame-week2-wp-crypto</title>
    <url>/post/aba42241.html</url>
    <content><![CDATA[<p>æ¯”èµ›è®°å½•</p>
<span id="more"></span>
<h3 id="Week-2-Fault-Fault"><a href="#Week-2-Fault-Fault" class="headerlink" title="[Week 2] Fault!Fault!"></a>[Week 2] Fault!Fault!</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æœºç¼˜å·§åˆä¹‹ä¸‹ï¼Œå°Zæ„å¤–è·å¾—äº†ä¸€å¼ ç”¨äºèº«ä»½è®¤è¯çš„åŠ å¯†èŠ¯ç‰‡ï¼Œè¿™å—èŠ¯ç‰‡å¯ä»¥è¾“å…¥ä¸€å®šçš„ä¿¡æ¯ï¼Œå¹¶è¾“å‡ºç­¾ååçš„ç»“æœã€‚ç»è¿‡ä¸€æ®µæ—¶é—´çš„é€†å‘å·¥ä½œä¹‹åï¼Œå°Zå¾—åˆ°äº†å…¶ä¸­çš„ç­¾åé€»è¾‘ã€‚</span><br><span class="line"></span><br><span class="line">å°Zè½¬å¿µä¸€æƒ³ï¼Œå¦‚æœç§é’¥æ˜¯å­˜å‚¨åœ¨èŠ¯ç‰‡ä¸­çš„ï¼Œé‚£ä¹ˆæˆ‘æ˜¯å¦èƒ½å¤Ÿé€šè¿‡æŸç§åŠæ³•è¯»å–åˆ°å…¶ä¸­çš„ç§é’¥ï¼Ÿæ˜¯å¦æ„å‘³ç€æˆ‘å¯ä»¥ä»»æ„ä¼ªé€ ç­¾åï¼Ÿ</span><br><span class="line"></span><br><span class="line">äºæ˜¯å°Zé‡é‡‘ä¹°ä¸‹å·¥å…·ï¼Œï¼Œï¼Œé‚£ä¹ˆåœ¨æ‹¥æœ‰å¹²æ¶‰åŠ è§£å¯†çš„èƒ½åŠ›å‰æä¸‹ï¼Œè¿™ä¸ªæ”»å‡»è¦å¦‚ä½•å®æ–½å‘¢â€¦â€¦</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_uppercase</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> shuffle,choice,randint</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">c,d,n,index</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;something go wrong&quot;&quot;&quot;</span></span><br><span class="line">    d_ = d^(<span class="number">1</span>&lt;&lt;(index))</span><br><span class="line">    m_ = <span class="built_in">pow</span>(c,d_,n)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(m_)</span><br><span class="line"></span><br><span class="line">MEMU = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Welc0me_2_0xGame2023!</span></span><br><span class="line"><span class="string">/----------------------------\\</span></span><br><span class="line"><span class="string">|          options           |</span></span><br><span class="line"><span class="string">| [S]ign                     |</span></span><br><span class="line"><span class="string">| [F]ault injection          |</span></span><br><span class="line"><span class="string">| [C]heck answer             |</span></span><br><span class="line"><span class="string">\\---------------------------/</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Task</span>(socketserver.BaseRequestHandler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">proof_of_work</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;éªŒè¯å‡½æ•°&#x27;&#x27;&#x27;</span></span><br><span class="line">        random.seed(os.urandom(<span class="number">8</span>))</span><br><span class="line">        proof = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters+string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">        _hexdigest = sha256(proof.encode()).hexdigest()</span><br><span class="line">        self.send(<span class="string">f&quot;[+] sha256(XXXX+<span class="subst">&#123;proof[<span class="number">4</span>:]&#125;</span>) == <span class="subst">&#123;_hexdigest&#125;</span>&quot;</span>.encode())</span><br><span class="line">        x = self.recv(prompt=<span class="string">b&#x27;[+] Plz tell me XXXX: &#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(x) != <span class="number">4</span> <span class="keyword">or</span> sha256(x+proof[<span class="number">4</span>:].encode()).hexdigest() != _hexdigest:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_recvall</span>(<span class="params">self</span>):</span><br><span class="line">        BUFF_SIZE = <span class="number">2048</span></span><br><span class="line">        data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            part = self.request.recv(BUFF_SIZE)</span><br><span class="line">            data += part</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(part) &lt; BUFF_SIZE:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> data.strip()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">send</span>(<span class="params">self, msg, newline=<span class="literal">True</span></span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> newline:</span><br><span class="line">                msg += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line">            self.request.sendall(msg)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">recv</span>(<span class="params">self, prompt=<span class="string">b&#x27;&gt; &#x27;</span></span>):</span><br><span class="line">        self.send(prompt, newline=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> self._recvall()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">timeout_handler</span>(<span class="params">self, signum, frame</span>):</span><br><span class="line">        <span class="keyword">raise</span> TimeoutError</span><br><span class="line"></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;ä»¥ä¸Šæ˜¯äº¤äº’éƒ¨åˆ†&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;é¢˜å¹²&#x27;&#x27;&#x27;</span></span><br><span class="line">        signal.signal(signal.SIGALRM, self.timeout_handler)</span><br><span class="line">        signal.alarm(<span class="number">300</span>)</span><br><span class="line">        self.send(MEMU)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.proof_of_work():</span><br><span class="line">            self.send(<span class="string">b&#x27;[!] Wrong!&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        q = getPrime(<span class="number">512</span>)</span><br><span class="line">        p = getPrime(<span class="number">512</span>)</span><br><span class="line">        e = <span class="number">65537</span></span><br><span class="line">        n = q*p</span><br><span class="line">        phi = (q-<span class="number">1</span>)*(p-<span class="number">1</span>)</span><br><span class="line">        d = inverse(e,phi)</span><br><span class="line"></span><br><span class="line">        self.send(MEMU.encode())</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            code = self.recv()</span><br><span class="line">            <span class="keyword">if</span> code == <span class="string">b&#x27;S&#x27;</span>:</span><br><span class="line">                self.send(<span class="string">b&#x27;What you want to sign?:&#x27;</span>)</span><br><span class="line">                m = bytes_to_long(self.recv())</span><br><span class="line">                c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">                self.send(<span class="string">f&#x27;<span class="subst">&#123;n&#125;</span>\n<span class="subst">&#123;e&#125;</span>\n<span class="subst">&#123;c&#125;</span>&#x27;</span>.encode())</span><br><span class="line">                </span><br><span class="line">            <span class="keyword">elif</span> code == <span class="string">b&#x27;F&#x27;</span>:</span><br><span class="line">                self.send(<span class="string">b&#x27;Give me the Signatrue:&#x27;</span>)</span><br><span class="line">                Signatrue = <span class="built_in">int</span>(self.recv())</span><br><span class="line">                self.send(<span class="string">b&#x27;Where you want to interfere?&#x27;</span>)</span><br><span class="line">                index = <span class="built_in">int</span>(self.recv())</span><br><span class="line">                self.send(<span class="string">b&#x27;The decrypt text:&#x27;</span>)</span><br><span class="line">                self.send(decrypt(Signatrue,d,n,index).encode())</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> code == <span class="string">b&#x27;C&#x27;</span>:</span><br><span class="line">                self.send(<span class="string">b&#x27;Give me the private key:&#x27;</span>)</span><br><span class="line">                ans = <span class="built_in">int</span>(self.recv())</span><br><span class="line">                <span class="keyword">if</span> ans == d:</span><br><span class="line">                    self.send(<span class="string">b&#x27;Here is your flag:&#x27;</span>)</span><br><span class="line">                    self.send(flag)</span><br><span class="line">                    </span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.send(<span class="string">b&#x27;invaild input&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST, PORT = <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">10005</span></span><br><span class="line">    server = ForkedServer((HOST, PORT), Task)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    <span class="built_in">print</span>(HOST, PORT)</span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure>
<p>æ¢³ç†ä¸€ä¸‹é¢˜ç›®åŠ å¯†æµç¨‹ï¼š</p>
<ul>
<li>è¿æ¥ä¸Šé¶æœºåï¼Œè®¡æ—¶å¼€å§‹ï¼Œé™æ—¶300s(è¿™ä¹ˆé•¿çš„é™æ—¶å°±æš—ç¤ºå¯èƒ½éœ€è¦ä¸æ–­äº¤äº’)</li>
<li>å…ˆé€šè¿‡ä¸€ä¸ªproof_of_workï¼Œå…·ä½“ä¸ºé€šè¿‡å“ˆå¸Œå€¼ï¼Œçˆ†ç ´å››ä½åå…­è¿›åˆ¶ä¸²</li>
<li>é€šè¿‡proofåï¼Œç”ŸæˆRSAåŠ å¯†æ‰€éœ€çš„pï¼Œqï¼Œeï¼Œnï¼Œphiï¼Œdç­‰å‚æ•°ï¼Œç„¶åå¯ä»¥æœ‰å¦‚ä¸‹é€‰é¡¹ï¼š</li>
<li><ul>
<li>è¾“å…¥â€Sâ€ï¼Œå¯ä»¥å¯¹ä»»æ„æ˜æ–‡mè¿›è¡ŒåŠ å¯†ï¼Œå¹¶è¿”å›å¯†æ–‡cåŠå…¬é’¥å¯¹(nï¼Œe)</li>
<li>è¾“å…¥â€Fâ€ï¼Œå¯ä»¥å¯¹ä»»æ„å¯†æ–‡è¿›è¡Œæ•…éšœè§£å¯†ï¼Œæ•…éšœè§£å¯†å…·ä½“æ˜¯ä»€ä¹ˆæ„æ€ä¸€ä¼šå„¿è®²</li>
<li>è¾“å…¥â€Câ€ï¼Œå¯ä»¥è¾“å…¥ä¸€ä¸ªå€¼ï¼Œå¦‚æœè¯¥å€¼ä¸dç›¸ç­‰ï¼Œåˆ™è·å¾—flag</li>
</ul>
</li>
</ul>
<p>å…¶ä¸­ï¼Œæ•…éšœè§£å¯†çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">c,d,n,index</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;something go wrong&quot;&quot;&quot;</span></span><br><span class="line">    d_ = d^(<span class="number">1</span>&lt;&lt;(index))</span><br><span class="line">    m_ = <span class="built_in">pow</span>(c,d_,n)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(m_)</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œç›¸æ¯”äºå¸¸è§„çš„RSAè§£å¯†æŒ‡æ•°ï¼Œç”¨åœ¨æ•…éšœè§£å¯†ä¸­çš„æŒ‡æ•°dçš„indexè¿™ä¸€æ¯”ç‰¹ä½å‘ç”Ÿäº†ç¿»è½¬ï¼Œä¹Ÿå°±æ˜¯ç¬¬indexæ¯”ç‰¹ä½çš„0å˜æˆ1ï¼Œæˆ–1å˜æˆ0ã€‚è€Œè¿™ç§ç¿»è½¬å…¶å®å¯ä»¥å†™æˆå¦‚ä¸‹ç®€å•å½¢å¼ï¼š</p>
<p>0å˜æˆ1ï¼š</p>
<script type="math/tex; mode=display">
d' = d + 2^{index}</script><p>1å˜æˆ0ï¼š</p>
<script type="math/tex; mode=display">
d' = d - 2^{index}</script><p>æˆ‘ä»¬ç”¨è¿™ä¸ªæŒ‡æ•°å¯¹RSAè§£å¯†ï¼Œå°±å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
c^{d'} \equiv c^{d \pm 2^{index}} \equiv c^d *c^{\pm 2^{index}} \quad (mod\;n)</script><p>è€Œå…·ä½“æ˜¯åŠ å·è¿˜æ˜¯å‡å·ï¼Œå°±å–å†³äºdçš„é‚£ä¸€bitåŸæœ¬æ˜¯0è¿˜æ˜¯1ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å°±æœ‰äº†åˆ¤åˆ«dçš„æŸä¸€æ¯”ç‰¹ä½çš„æ–¹æ³•ï¼š</p>
<p>å¦‚æœdçš„ç¬¬indexæ¯”ç‰¹ä½æ˜¯0ï¼Œåˆ™ï¼š</p>
<script type="math/tex; mode=display">
d' = d + 2^{index}</script><script type="math/tex; mode=display">
c^{d'} \equiv c^{d + 2^{index}} \equiv c^d *c^{ 2^{index}}\equiv m*c^{2^{index}} \quad (mod\;n)</script><p>ä¹Ÿå°±æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
c^{d'} \equiv m*c^{2^{index}} \quad (mod\;n)</script><p>è€Œå¦‚æœdçš„ç¬¬indexæ¯”ç‰¹ä½ä¸º1ï¼Œåˆ™æ­£å¥½ç›¸åï¼Œä»¥ä¸‹å¼å­æˆç«‹ï¼š</p>
<script type="math/tex; mode=display">
c^{d'} \equiv m*c^{-2^{index}} \quad (mod\;n)</script><p>å› æ­¤ï¼Œé€šè¿‡åå¤æ›´æ”¹indexå¹¶ä»¤å…¶è§£å¯†ï¼Œæˆ‘ä»¬å°±èƒ½å¾—åˆ°dçš„æ‰€æœ‰æ¯”ç‰¹ä½ï¼Œç„¶åå°±å¯ä»¥è¿˜åŸå‡ºdå¹¶ä¸Šäº¤å¾—åˆ°flagã€‚ä½†æ˜¯å¯¹äºæˆ‘çš„ç”µè„‘æ¥è¯´ï¼Œ300sé™åˆ¶æœ‰ç‚¹ç´§å¼ ï¼Œæ‰€ä»¥è¦ä¸æ–­ææ‰proofè¿‡çš„æ…¢çš„äº¤äº’ï¼Œä¸ç„¶å¾ˆéš¾å®Œæ•´å¤åŸdçš„æ‰€æœ‰æ¯”ç‰¹ä½ã€‚ä¸è¿‡ä¹‹åå‘ç°ï¼Œå…¶å®è¯¥å®¹å™¨çš„pï¼Œqï¼Œnï¼Œeéƒ½ä¸ä¼šå˜ï¼Œå› æ­¤dä¹Ÿä¸ä¼šå˜ï¼Œæ‰€ä»¥å®Œå…¨å¯ä»¥åˆ†ä¸¤æ¬¡æ”»å‡»å¾—åˆ°ä¸åŒæ¯”ç‰¹ä½ï¼Œç„¶åç»„åˆä¸€ä¸‹å°±å¥½ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> powmod</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>():</span><br><span class="line">	table = string.digits + string.ascii_letters</span><br><span class="line">	temp = r.recvuntil(<span class="string">b&quot;sha256(XXXX+&quot;</span>)</span><br><span class="line">	temp = r.recvline()</span><br><span class="line">	suffix = temp[:<span class="number">16</span>].decode()</span><br><span class="line">	hex1 = temp[<span class="number">20</span>:].strip().decode()</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> tqdm(table):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> table:</span><br><span class="line">			<span class="keyword">for</span> k <span class="keyword">in</span> table:</span><br><span class="line">				<span class="keyword">for</span> m <span class="keyword">in</span> table:</span><br><span class="line">					temp1 = i+j+k+m</span><br><span class="line">					<span class="keyword">if</span>(sha256((temp1+suffix).encode()).hexdigest() == hex1):</span><br><span class="line">						r.sendline(temp1.encode())</span><br><span class="line">						<span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;43.139.107.237&quot;</span>,<span class="number">10005</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#part1</span></span><br><span class="line">proof_of_work()</span><br><span class="line">temp = r.recvuntil(<span class="string">b&quot;-----/&quot;</span>)</span><br><span class="line"></span><br><span class="line">m = <span class="number">2</span></span><br><span class="line">r.sendline(<span class="string">b&quot;S&quot;</span>)</span><br><span class="line">temp = r.recvuntil(<span class="string">b&quot;What you want to sign?:&quot;</span>)</span><br><span class="line">r.sendline(long_to_bytes(m))</span><br><span class="line">r.recvline()</span><br><span class="line">n = <span class="built_in">int</span>(r.recvline().strip().decode()[<span class="number">2</span>:])</span><br><span class="line">e = <span class="built_in">int</span>(r.recvline().strip().decode())</span><br><span class="line">c = <span class="built_in">int</span>(r.recvline().strip().decode())</span><br><span class="line"></span><br><span class="line">d = <span class="string">&quot;&quot;</span>	</span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">1024</span>)):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r.sendline(<span class="string">b&quot;F&quot;</span>)	</span><br><span class="line">        r.recvuntil(<span class="string">b&quot;Give me the Signatrue:&quot;</span>)</span><br><span class="line">        r.sendline(<span class="built_in">str</span>(c).encode())</span><br><span class="line">        r.recvuntil(<span class="string">b&quot;Where you want to interfere?&quot;</span>)</span><br><span class="line">        r.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">        r.recvuntil(<span class="string">b&quot;The decrypt text:&quot;</span>)</span><br><span class="line">        temp = r.recvline()</span><br><span class="line">        m_ = <span class="built_in">int</span>(r.recvline().strip().decode())</span><br><span class="line">        t1 = (powmod(c,<span class="number">2</span>**index,n) * m) % n</span><br><span class="line">        t2 = (powmod(c,-<span class="number">2</span>**index,n) * m) % n</span><br><span class="line">        <span class="keyword">if</span>(t1 == m_):</span><br><span class="line">            d += <span class="string">&quot;0&quot;</span></span><br><span class="line">        <span class="keyword">elif</span>(t2 == m_):</span><br><span class="line">            d += <span class="string">&quot;1&quot;</span>	</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">d = <span class="built_in">int</span>(d[::-<span class="number">1</span>],<span class="number">2</span>)</span><br><span class="line">r.sendline(<span class="string">b&quot;C&quot;</span>)</span><br><span class="line">temp = r.recvuntil(<span class="string">b&quot;Give me the private key:&quot;</span>)</span><br><span class="line">r.sendline(<span class="built_in">str</span>(d).encode())</span><br><span class="line">temp = r.recvall()</span><br><span class="line"><span class="built_in">print</span>(temp)</span><br><span class="line"></span><br><span class="line"><span class="comment">#0xGame&#123;F@ult_Milest0ne!!&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="Week-2-EzLFSR"><a href="#Week-2-EzLFSR" class="headerlink" title="[Week 2] EzLFSR"></a>[Week 2] EzLFSR</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æš‚æ— </span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag,secret</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag == <span class="string">b&#x27;0xGame&#123;&#x27;</span>+secret+<span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">make_mask</span>(<span class="params">m</span>):</span><br><span class="line">    tmp = <span class="built_in">str</span>(<span class="built_in">bin</span>(bytes_to_long(m)))[<span class="number">2</span>:].zfill(<span class="number">128</span>)</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">string2bits</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> s]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bits2string</span>(<span class="params">bs</span>):</span><br><span class="line">    s = [<span class="built_in">str</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> bs]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr</span>(<span class="params">state, mask</span>):</span><br><span class="line">    <span class="keyword">assert</span>(<span class="built_in">len</span>(state) == <span class="number">128</span>)</span><br><span class="line">    <span class="keyword">assert</span>(<span class="built_in">len</span>(mask)  == <span class="number">128</span>)</span><br><span class="line"></span><br><span class="line">    output = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        output = output ^ (state[i] &amp; mask[i])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    initState = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">    secret = make_mask(secret)</span><br><span class="line">    mask = string2bits(secret)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> secret: <span class="keyword">assert</span>(b == <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> b == <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    <span class="keyword">assert</span>(<span class="built_in">len</span>(secret) == <span class="number">128</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        state = initState[i:]</span><br><span class="line">        output = lfsr(state, mask)</span><br><span class="line">        initState += [output]</span><br><span class="line"></span><br><span class="line">    outputState = bits2string(initState[<span class="number">128</span>:])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;outputState =&#x27;</span>, outputState)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">outputState = 1101111111011101100001000011111101001000111000110100010011110111010011100110100100111001101010110110101110000011110101000110010010000011111111001111000110111001100111101110010100100001101001111110001010000100111101011011100010000000100000100000100111010110</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>è€æ ·å­ï¼Œå…ˆæ¢³ç†é¢˜ç›®åŠ å¯†æµç¨‹ï¼š</p>
<ul>
<li>é¢˜ç›®æŠŠsecretå˜ä¸ºäºŒè¿›åˆ¶åˆ—è¡¨åï¼Œä½œä¸ºæ©ç maskï¼Œflagç”±å›ºå®šflagå¤´å°¾åŠsecretç»„æˆ</li>
<li>ç»™å®šLFSRçš„åˆå§‹åºåˆ—initStateï¼Œä¸maskä¸€æ ·æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º128çš„äºŒè¿›åˆ¶åˆ—è¡¨</li>
<li>ç”¨LFSRç”Ÿæˆ256æ¯”ç‰¹çš„æµå¯†ç ï¼Œå¹¶ç»™å‡ºã€‚è¦æ±‚æˆ‘ä»¬åæ¨å‡ºmaskåˆ—è¡¨ï¼Œä»è€Œæ±‚å‡ºsecret</li>
</ul>
<p>å…¶ä¸­ï¼ŒLFSRçš„ç”Ÿæˆé€»è¾‘å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr</span>(<span class="params">state, mask</span>):</span><br><span class="line">    <span class="keyword">assert</span>(<span class="built_in">len</span>(state) == <span class="number">128</span>)</span><br><span class="line">    <span class="keyword">assert</span>(<span class="built_in">len</span>(mask)  == <span class="number">128</span>)</span><br><span class="line"></span><br><span class="line">    output = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        output = output ^ (state[i] &amp; mask[i])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> output</span><br></pre></td></tr></table></figure>
<p>ä¹ä¸€çœ‹å¯èƒ½è§‰å¾—ä¸å¤ªå¥½æƒ³ï¼Œä½†æ˜¯å†ä¸€çœ‹ï¼Œè¿™ä¸å°±æ˜¯ä¸ªGF(2)ä¸‹çš„çº¿æ€§æ–¹ç¨‹å—ï¼è¿™æ˜¯å› ä¸ºï¼š</p>
<ul>
<li>state[i] &amp; mask[i]ï¼Œå¯ä»¥å†™æˆ state[i] * mask[i]</li>
<li>output = output ^ (state[i] &amp; mask[i]) ï¼Œå…¶å®å°±æ˜¯æŠŠ128ä¸ªä¹˜ç§¯åœ¨GF(2)ä¸‹æ±‚å’Œ</li>
</ul>
<p>é‚£ä¹ˆè¿™æ ·ä¸€æ¥å°±å¥½åšäº†ï¼ŒæŠŠmaskå½“ä½œ128ä¸ªå˜é‡ç»„æˆçš„åˆ—å‘é‡ï¼Œå–128ä¸ªoutputï¼Œå°±èƒ½æ±‚è§£ä¸€ä¸ªæ»¡ç§©çš„çŸ©é˜µæ–¹ç¨‹å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
\left(
 \begin{matrix}
   m_{1,1} & m_{1,2} &... &m_{1,128}\\
   m_{2,1} & m_{2,2} &... &m_{2,128} \\
   & &...\\
   m_{127,1} & m_{127,2} &... &m_{127,128} \\
   m_{128,1} & m_{128,2} &... &m_{128,128}  \\
  \end{matrix}
  \right)*
  \left(
 \begin{matrix}
   mask_1\\
   mask_2 \\
   ...\\
   mask_{127} \\
   mask_{128}  \\
  \end{matrix}
  \right)
  =
  \left(
 \begin{matrix}
   output_1\\
   output_2 \\
   ...\\
   output_{127} \\
   output_{128}  \\
  \end{matrix}
  \right)
  \quad(mod\;2)</script><p>æ±‚å®Œåè½¬å›å­—ç¬¦ä¸²ï¼Œå†å¥—ä¸Šflagå¤´å°¾å³å¯ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bits2string</span>(<span class="params">bs</span>):</span><br><span class="line">    s = [<span class="built_in">str</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> bs]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">string2bits</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> s]</span><br><span class="line"></span><br><span class="line">outputState = <span class="string">&quot;1101111111011101100001000011111101001000111000110100010011110111010011100110100100111001101010110110101110000011110101000110010010000011111111001111000110111001100111101110010100100001101001111110001010000100111101011011100010000000100000100000100111010110&quot;</span></span><br><span class="line">initState = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">c = string2bits(outputState[:<span class="number">128</span>])</span><br><span class="line">M = [initState[i:] + c[:i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>)]</span><br><span class="line">c = vector(GF(<span class="number">2</span>),c)</span><br><span class="line">m = matrix(GF(<span class="number">2</span>),<span class="number">128</span>,<span class="number">128</span>,M)</span><br><span class="line">secret = m.solve_left(c)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(bits2string(secret),<span class="number">2</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#0xGame&#123;Rec0ver_the_M@sk&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="Week-2-Whatâ€™s-CRT"><a href="#Week-2-Whatâ€™s-CRT" class="headerlink" title="[Week 2] Whatâ€™s CRT?"></a>[Week 2] Whatâ€™s CRT?</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å…ˆç©¿è¢œå­åç©¿é‹ï¼Œå…ˆå½“**åå½“çˆ·</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secert <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = <span class="number">260792700</span></span><br><span class="line">q,p,q_,p_ = [getPrime(<span class="number">512</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">gift = [q+p,q_+p_]</span><br><span class="line">n,n_ = q*p,q_*p_</span><br><span class="line">mq_ = <span class="built_in">pow</span>(m,<span class="number">4</span>,q_)</span><br><span class="line">mp_ = <span class="built_in">pow</span>(m,<span class="number">4</span>,p_)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;mygift=<span class="subst">&#123;gift&#125;</span>\nmq_=<span class="subst">&#123;mq_&#125;</span>\nmp_=<span class="subst">&#123;mp_&#125;</span>\nn=<span class="subst">&#123;n&#125;</span>\nn_=<span class="subst">&#123;n_&#125;</span>\nc=<span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">mygift=[15925416640901708561793293991573474917595642805739825596593339102414328214313430010166125066639132916608736569443045051644173933089503934675628814467277922, 18342424676996843423829480445042578097182127446865571536445030052846412665700132683433441858073625594933132038175200824257774638419166516796318527302903098]</span></span><br><span class="line"><span class="string">mq_=6229615098788722664392369146712291169948485951371133086154028832805750551655072946170332335458186479565263371985534601035559229403357396564568667218817197</span></span><br><span class="line"><span class="string">mp_=7514598449361191486799480225087938913945061715845128006069296876457814528347371315493644046029376830166983645570092100320566196227210502897068206073043718</span></span><br><span class="line"><span class="string">n=63329068473206068067147844002844348796575899624395867391964805451897110448983910133293450006821779608031734813916287079551030950968978400757306879502402868643716591624454744334316879241573399993026873598478532467624301968439714860262264449471888606538913071413634346381428901358109273203087030763779091664797</span></span><br><span class="line"><span class="string">n_=84078907800136966150486965612788894868587998005459927216462899940718213455112139441858657865215211843183780436155474431592540465189966648565764225210091190218976417210291521208716206733270743675534820816685370480170120230334766919110311980614082807421812749491464201740954627794429460268010183163151688591417</span></span><br><span class="line"><span class="string">c=12623780002384219022772693100787925315981488689172490837413686188416255911213044332780064192900824150269364486747430892667624289724721692959334462348218416297309304391635919115701692314532111050955120844126517392040880404049818026059951326039894605004852370344012563287210613795011783419126458214779488303552</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>ä¸ç®¡æ˜¯é¢˜ç›®æ ‡é¢˜CRTï¼Œè¿˜æ˜¯é¢˜ç›®æè¿°æš—ç¤ºå­™å­å®šç†ï¼Œéƒ½æ˜¯å‘Šè¯‰æˆ‘ä»¬è¿™é¢˜è¦ç”¨ä¸­å›½å‰©ä½™å®šç†ã€‚</p>
<p>é¦–å…ˆï¼Œæ ¹æ®é¢˜ç›®ç»™çš„æ¡ä»¶ï¼Œèƒ½å¤Ÿå¾ˆè½»æ¾çš„æ±‚å‡ºpã€qã€pâ€˜ã€qâ€™å‡ ä¸ªå‚æ•°ã€‚é‚£ä¹ˆç”±äºï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">mq_ = <span class="built_in">pow</span>(m,<span class="number">4</span>,q_)</span><br><span class="line">mp_ = <span class="built_in">pow</span>(m,<span class="number">4</span>,p_)</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å…ˆç”¨ä¸­å›½å‰©ä½™å®šç†è¯•ä¸€è¯•ã€‚ä½†æ˜¯ä¸è¡Œï¼Œé‚£åº”è¯¥flagè¶…é•¿äº†ï¼Œæ‰€ä»¥å¿…é¡»æŠŠpã€qä¹Ÿç”¨ä¸Šã€‚</p>
<p>è€Œè¿™ä¸ªeæ˜¯ä¸ªå¶æ•°ï¼Œæ˜¯è‚¯å®šå’Œp-1,q-1éƒ½ä¸äº’ç´ çš„ï¼Œåˆå› ä¸ºeæ¯”è¾ƒå°ï¼Œæ‰€ä»¥æ‰”ä¸Šfacrotdbä¸Šåˆ†è§£ä¸€ä¸‹ï¼š</p>
<p><img src="/post/aba42241/image-20231008171144165.png" alt="image-20231008171144165"></p>
<p>æ­£å¥½ï¼Œä»–ä¸phiçš„å…¬å› æ•°ä¹Ÿæ˜¯4ï¼Œå› æ­¤æŠŠeæ‹†å¼€ï¼š</p>
<script type="math/tex; mode=display">
(m^4)^{\frac{e}{4}} \equiv c \quad(mod\;n)</script><p>ç„¶åæ±‚e/4å¯¹phiçš„é€†å…ƒdï¼Œæ­£å¸¸RSAè§£å¯†å°±èƒ½å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
m^4 \equiv c^d \quad (mod\;n)</script><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å°±æ‹¥æœ‰äº†å…³äºm^4çš„ä¸‰ä¸ªç­‰å¼ï¼š</p>
<script type="math/tex; mode=display">
m^4 \equiv c^d \quad (mod\;n)</script><script type="math/tex; mode=display">
m^4 \equiv mp' \quad (mod\;p')</script><script type="math/tex; mode=display">
m^4 \equiv mq' \quad (mod\;q')</script><p>ä¸­å›½å‰©ä½™å®šç†ç»„åˆï¼Œå¼€å››æ¬¡æ ¹å°±èƒ½å¾—åˆ°flagã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"></span><br><span class="line">e = <span class="number">260792700</span></span><br><span class="line">gift=[<span class="number">15925416640901708561793293991573474917595642805739825596593339102414328214313430010166125066639132916608736569443045051644173933089503934675628814467277922</span>, <span class="number">18342424676996843423829480445042578097182127446865571536445030052846412665700132683433441858073625594933132038175200824257774638419166516796318527302903098</span>]</span><br><span class="line">mq_=<span class="number">6229615098788722664392369146712291169948485951371133086154028832805750551655072946170332335458186479565263371985534601035559229403357396564568667218817197</span></span><br><span class="line">mp_=<span class="number">7514598449361191486799480225087938913945061715845128006069296876457814528347371315493644046029376830166983645570092100320566196227210502897068206073043718</span></span><br><span class="line">n=<span class="number">63329068473206068067147844002844348796575899624395867391964805451897110448983910133293450006821779608031734813916287079551030950968978400757306879502402868643716591624454744334316879241573399993026873598478532467624301968439714860262264449471888606538913071413634346381428901358109273203087030763779091664797</span></span><br><span class="line">n_=<span class="number">84078907800136966150486965612788894868587998005459927216462899940718213455112139441858657865215211843183780436155474431592540465189966648565764225210091190218976417210291521208716206733270743675534820816685370480170120230334766919110311980614082807421812749491464201740954627794429460268010183163151688591417</span></span><br><span class="line">c=<span class="number">12623780002384219022772693100787925315981488689172490837413686188416255911213044332780064192900824150269364486747430892667624289724721692959334462348218416297309304391635919115701692314532111050955120844126517392040880404049818026059951326039894605004852370344012563287210613795011783419126458214779488303552</span></span><br><span class="line"></span><br><span class="line">p = (iroot((gift[<span class="number">0</span>]**<span class="number">2</span> - <span class="number">4</span>*n),<span class="number">2</span>)[<span class="number">0</span>] + gift[<span class="number">0</span>])//<span class="number">2</span></span><br><span class="line">q = n // p</span><br><span class="line"></span><br><span class="line">q_ = (iroot((gift[<span class="number">1</span>]**<span class="number">2</span> - <span class="number">4</span>*n_),<span class="number">2</span>)[<span class="number">0</span>] + gift[<span class="number">1</span>])//<span class="number">2</span></span><br><span class="line">p_ = n_ // q_</span><br><span class="line"></span><br><span class="line">d = inverse(e//<span class="number">4</span>,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"></span><br><span class="line">N = [n,p_,q_]</span><br><span class="line">C = [m,mp_,mq_]</span><br><span class="line">M = crt(N,C)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(iroot(M,<span class="number">4</span>)[<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment">#0xGame&#123;7881ed67088e9f72b860f8c376599785&#125;</span></span><br></pre></td></tr></table></figure>
<p>æœ‰ä¸€ä¸ªå°ç»†èŠ‚éœ€è¦æ³¨æ„ï¼Œå¦‚æœä½ æŒ‰è¿™ä¸ªæ–¹å¼ä¸€ç›´å‡ºä¸æ¥ï¼Œé‚£ä¹ˆå¯ä»¥æ£€æŸ¥ä¸€ä¸‹pâ€™ã€qâ€™æ˜¯å¦æ±‚åäº†ï¼Œæ˜¯æœ‰è¿™ä¸ªå¯èƒ½æ€§çš„ã€‚</p>
<p><br></p>
<p><br></p>
<h3 id="Week-2-ä¸­é—´çš„é‚£ä¸ªäºº"><a href="#Week-2-ä¸­é—´çš„é‚£ä¸ªäºº" class="headerlink" title="[Week 2] ä¸­é—´çš„é‚£ä¸ªäºº"></a>[Week 2] ä¸­é—´çš„é‚£ä¸ªäºº</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å°çˆ±(Alice)å’Œå°çˆ†(Bob)ç°åœ¨åœ¨ç¥ç§˜çš„å¹»æƒ³ä¹¡ä¸­éœ€è¦è¿›è¡Œè¿œç¨‹é€šè¯ï¼Œä½†æ˜¯ä»–ä»¬åˆä¸å¸Œæœ›ä¸­é—´ä¼ é€’çš„ä¿¡æ¯è¢«å¿ƒæ€€ä¸è½¨çš„äººçªƒå–â€”â€”å¾ˆæ˜¾ç„¶ï¼Œä»–ä»¬çš„é€šè¯éœ€è¦åŠ å¯†ã€‚ä½†æ˜¯åœ¨åŒæ–¹å¹¶æœªäº‹å…ˆæ²Ÿé€šå¥½çš„æƒ…å†µä¸‹ï¼Œä»–ä»¬è¦å¦‚ä½•åå•†å¥½å¯†é’¥å‘¢ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">128</span>)</span><br><span class="line">g = <span class="number">2</span></span><br><span class="line">A = getrandbits(<span class="number">32</span>)</span><br><span class="line">B = getrandbits(<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">Alice = <span class="built_in">pow</span>(g,A,p)</span><br><span class="line">Bob = <span class="built_in">pow</span>(g,B,p)</span><br><span class="line">key = <span class="built_in">pow</span>(Alice,B,p)</span><br><span class="line">key = sha256(long_to_bytes(key)).digest()</span><br><span class="line"></span><br><span class="line">iv = <span class="string">b&quot;0xGame0xGameGAME&quot;</span></span><br><span class="line">aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">enc = aes.encrypt(flag)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;g=<span class="subst">&#123;g&#125;</span>\np=<span class="subst">&#123;p&#125;</span>&#x27;</span>)  <span class="comment">#we tell</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Bob=<span class="subst">&#123;Bob&#125;</span>&#x27;</span>)     <span class="comment">#Bob tell</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Alice=<span class="subst">&#123;Alice&#125;</span>&#x27;</span>) <span class="comment">#Alice tell</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;enc=<span class="subst">&#123;enc&#125;</span>&#x27;</span>)<span class="comment">#Here is they secret</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">g=2</span></span><br><span class="line"><span class="string">p=250858685680234165065801734515633434653</span></span><br><span class="line"><span class="string">Bob=33067794433420687511728239091450927373</span></span><br><span class="line"><span class="string">Alice=235866450680721760403251513646370485539</span></span><br><span class="line"><span class="string">enc=b&#x27;s\x04\xbc\x8bT6\x846\xd9\xd6\x83 y\xaah\xde@\xc9\x17\xdc\x04v\x18\xef\xcf\xef\xc5\xfd|\x0e\xca\n\xbd#\x94&#123;\x8e[.\xe8\xe1GU\xfa?\xda\x11w&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>ä¸€ä¸ªå…¸å‹çš„Diffie-Hellmanå¯†é’¥äº¤æ¢åè®®ï¼Œå…¶å›°éš¾æ€§ä¾èµ–äºç¦»æ•£å¯¹æ•°åœ¨æŸäº›æœ‰é™åŸŸä¸‹éš¾ä»¥æ±‚è§£ã€‚ä½†æ˜¯è§‚å¯Ÿé¢˜ç›®ç”Ÿæˆæœ‰é™åŸŸç”¨çš„pè¾ƒå°è€Œä¸”è¾ƒå…‰æ»‘ï¼Œå› æ­¤å¯ä»¥ç›´æ¥æ±‚è§£å‡ºç¦»æ•£å¯¹æ•°ï¼Œè¿›è€Œå¾—åˆ°å…¬ç”¨å¯†é’¥keyï¼Œç„¶åAESè§£å¯†å³å¯ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">g=<span class="number">2</span></span><br><span class="line">p=<span class="number">250858685680234165065801734515633434653</span></span><br><span class="line">Bob=<span class="number">33067794433420687511728239091450927373</span></span><br><span class="line">Alice=<span class="number">235866450680721760403251513646370485539</span></span><br><span class="line">enc=<span class="string">b&#x27;s\x04\xbc\x8bT6\x846\xd9\xd6\x83 y\xaah\xde@\xc9\x17\xdc\x04v\x18\xef\xcf\xef\xc5\xfd|\x0e\xca\n\xbd#\x94&#123;\x8e[.\xe8\xe1GU\xfa?\xda\x11w&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">A=discrete_log(mod(Alice,p),mod(g,p))</span></span><br><span class="line"><span class="string">print(A)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">A = <span class="number">3992780394</span></span><br><span class="line"></span><br><span class="line">iv = <span class="string">b&quot;0xGame0xGameGAME&quot;</span></span><br><span class="line">key = <span class="built_in">int</span>(<span class="built_in">pow</span>(Bob,A,p))</span><br><span class="line">key = sha256(long_to_bytes(key)).digest()</span><br><span class="line">aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">m = aes.decrypt(enc)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="comment">#0xGame&#123;51393fe1fd5fc2df1bf018d06f0fa11d&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="Week-2-EzRSA"><a href="#Week-2-EzRSA" class="headerlink" title="[Week 2] EzRSA"></a>[Week 2] EzRSA</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä¸‰ä¸ªå°é—®é¢˜ã€‚ä¸€ä¸ªå®šç†ã€ä¸€ä¸ªå¸¸è§çš„åˆ†è§£æ–¹å¼ã€ä¸€ä¸ªä¸å¤ªå¸¸è§çš„è¿åˆ†æ•°åˆ†è§£ï¼ˆå•¥äº‹è¿åˆ†æ•°ï¼Ÿï¼‰</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> challenges.challenge1 <span class="keyword">import</span> RSAServe <span class="keyword">as</span> challenge1</span><br><span class="line"><span class="keyword">from</span> challenges.challenge2 <span class="keyword">import</span> RSAServe <span class="keyword">as</span> challenge2</span><br><span class="line"><span class="keyword">from</span> challenges.challenge3 <span class="keyword">import</span> RSAServe <span class="keyword">as</span> challenge3</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_uppercase</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> shuffle,choice,randint</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SCORE = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">BANNER = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> ____  ____    _    </span></span><br><span class="line"><span class="string">|  _ \/ ___|  / \   </span></span><br><span class="line"><span class="string">| |_) \___ \ / _ \  </span></span><br><span class="line"><span class="string">|  _ &lt; ___) / ___ \ </span></span><br><span class="line"><span class="string">|_| \_\____/_/   \_\</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Here are four challenges(1, 2, 3), solve them all then you can get flag.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">MEMU = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">/----------------------------\\</span></span><br><span class="line"><span class="string">|          options           |</span></span><br><span class="line"><span class="string">| 1. get public key          |</span></span><br><span class="line"><span class="string">| 2. get cipher text         |</span></span><br><span class="line"><span class="string">| 3. check                   |</span></span><br><span class="line"><span class="string">\\---------------------------/</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Task</span>(socketserver.BaseRequestHandler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">proof_of_work</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;éªŒè¯å‡½æ•°&#x27;&#x27;&#x27;</span></span><br><span class="line">        random.seed(os.urandom(<span class="number">8</span>))</span><br><span class="line">        proof = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters+string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">        _hexdigest = sha256(proof.encode()).hexdigest()</span><br><span class="line">        self.send(<span class="string">f&quot;[+] sha256(XXXX+<span class="subst">&#123;proof[<span class="number">4</span>:]&#125;</span>) == <span class="subst">&#123;_hexdigest&#125;</span>&quot;</span>.encode())</span><br><span class="line">        x = self.recv(prompt=<span class="string">b&#x27;[+] Plz tell me XXXX: &#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(x) != <span class="number">4</span> <span class="keyword">or</span> sha256(x+proof[<span class="number">4</span>:].encode()).hexdigest() != _hexdigest:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_recvall</span>(<span class="params">self</span>):</span><br><span class="line">        BUFF_SIZE = <span class="number">2048</span></span><br><span class="line">        data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            part = self.request.recv(BUFF_SIZE)</span><br><span class="line">            data += part</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(part) &lt; BUFF_SIZE:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> data.strip()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">send</span>(<span class="params">self, msg, newline=<span class="literal">True</span></span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> newline:</span><br><span class="line">                msg += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line">            self.request.sendall(msg)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">recv</span>(<span class="params">self, prompt=<span class="string">b&#x27;&gt; &#x27;</span></span>):</span><br><span class="line">        self.send(prompt, newline=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> self._recvall()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">timeout_handler</span>(<span class="params">self, signum, frame</span>):</span><br><span class="line">        <span class="keyword">raise</span> TimeoutError</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Serve</span>(<span class="params">self, S</span>):</span><br><span class="line">        self.send(MEMU.encode())</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            option = self.recv()</span><br><span class="line">            <span class="keyword">if</span> option == <span class="string">b&#x27;1&#x27;</span>:</span><br><span class="line">                pubkey = S.pubkey()</span><br><span class="line">                <span class="keyword">for</span> s <span class="keyword">in</span> pubkey:</span><br><span class="line">                    self.send(<span class="built_in">str</span>(s).encode())</span><br><span class="line">            <span class="keyword">elif</span> option == <span class="string">b&#x27;2&#x27;</span>:</span><br><span class="line">                c = S.encrypt()</span><br><span class="line">                self.send(c.encode())</span><br><span class="line">            <span class="keyword">elif</span> option == <span class="string">b&#x27;3&#x27;</span>:</span><br><span class="line">                usr_answer = self.recv(<span class="string">b&quot;input your answer: &quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> S.check(usr_answer)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.send(<span class="string">b&quot;invaild option&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self</span>):</span><br><span class="line">        signal.signal(signal.SIGALRM, self.timeout_handler)</span><br><span class="line">        signal.alarm(<span class="number">300</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.proof_of_work():</span><br><span class="line">            self.send(<span class="string">b&#x27;[!] Wrong!&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        self.send(BANNER.encode())</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            self.send(<span class="string">f&#x27;your score <span class="subst">&#123;<span class="built_in">sum</span>(SCORE)&#125;</span>&#x27;</span>.encode())</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">sum</span>(SCORE) == <span class="number">3</span>:</span><br><span class="line">                self.send(<span class="string">f&quot;here are flag:<span class="subst">&#123;flag&#125;</span>&quot;</span>.encode())</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            self.send(<span class="string">b&#x27;select challange&#123;1,2,3&#125;&#x27;</span>)<span class="comment">#</span></span><br><span class="line">            code = self.recv()</span><br><span class="line">            <span class="keyword">if</span> code == <span class="string">b&#x27;1&#x27;</span>:</span><br><span class="line">                S = challenge1()</span><br><span class="line">                res = self.Serve(S)</span><br><span class="line">                <span class="keyword">if</span> res == <span class="literal">True</span>:</span><br><span class="line">                    SCORE[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">                    self.send(<span class="string">b&#x27;Conguration!You are right!&#x27;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code == <span class="string">b&#x27;2&#x27;</span>:</span><br><span class="line">                S = challenge2()</span><br><span class="line">                res = self.Serve(S)</span><br><span class="line">                <span class="keyword">if</span> res == <span class="literal">True</span>:</span><br><span class="line">                    SCORE[<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">                    self.send(<span class="string">b&#x27;Conguration!You are right!&#x27;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code == <span class="string">b&#x27;3&#x27;</span>:</span><br><span class="line">                S = challenge3()</span><br><span class="line">                res = self.Serve(S)</span><br><span class="line">                <span class="keyword">if</span> res == <span class="literal">True</span>:</span><br><span class="line">                    SCORE[<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">                    self.send(<span class="string">b&#x27;Conguration!You are right!&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.send(<span class="string">b&#x27;invaild input&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST, PORT = <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">10006</span></span><br><span class="line">    server = ForkedServer((HOST, PORT), Task)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    <span class="built_in">print</span>(HOST, PORT)</span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure>
<p>ä¸€ä¸ªäº¤äº’é¢˜ï¼Œè¦å®ç°çš„ç›®æ ‡å°±æ˜¯åˆ†åˆ«é€šè¿‡ä»–çš„ä¸‰ä¸ªchallengeï¼Œå°±å¯ä»¥æ‹¿åˆ°flagã€‚</p>
<p>é‚£ä¹ˆæ¥ä¸‹æ¥å°±ä¸€ä¸ªä¸€ä¸ªchallengeåˆ†æã€‚</p>
<h4 id="challenge1"><a href="#challenge1" class="headerlink" title="challenge1"></a>challenge1</h4><p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag1</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RSAServe</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.e = <span class="number">65537</span></span><br><span class="line">        self.p = getPrime(<span class="number">1024</span>)</span><br><span class="line">        self.q = getPrime(<span class="number">1024</span>)</span><br><span class="line">        self.n = self.q*self.p</span><br><span class="line">        self.g, self.r1 = [random.randint(<span class="number">1</span>, self.q*self.p) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]</span><br><span class="line">        self.gift = <span class="built_in">pow</span>(self.g, self.r1 * (self.p - <span class="number">1</span>), self.n)</span><br><span class="line">        self.m = flag1</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self</span>):</span><br><span class="line">        m_ = bytes_to_long(self.m)</span><br><span class="line">        c = <span class="built_in">pow</span>(m_, self.e, self.p*self.q)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hex</span>(c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">self, msg</span>):</span><br><span class="line">        <span class="keyword">return</span> msg == self.m</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pubkey</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.p*self.q, self.e</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ä¼šç»™å‡ºä¸€ä¸ªgiftï¼Œå¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
gift \equiv g^{r_1*(p-1)} \quad(mod\;n)</script><p>é‚£ä¹ˆå…ˆåŒä½™æ€§è´¨è½¬åˆ°æ¨¡pä¸‹ï¼Œç„¶åè´¹é©¬å°å®šç†å³å¯ï¼š</p>
<script type="math/tex; mode=display">
gift \equiv g^{r_1*(p-1)} \equiv 1 \quad(mod\;p)</script><p>æ‰€ä»¥æ±‚gcd(gift-1,n)å°±èƒ½å¾—åˆ°pï¼Œåˆ†è§£nåè§£å¯†å³å¯ã€‚</p>
<h4 id="challenge2"><a href="#challenge2" class="headerlink" title="challenge2"></a>challenge2</h4><p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag2</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> choice</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RSAServe</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.e = <span class="number">65537</span></span><br><span class="line">        self.m = flag2</span><br><span class="line">        self.p = self.GetMyPrime(<span class="number">1024</span>)</span><br><span class="line">        self.q = self.GetMyPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">GetMyPrime</span>(<span class="params">self,bits</span>):</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            n = <span class="number">2</span></span><br><span class="line">            <span class="keyword">while</span> n.bit_length() &lt; bits:</span><br><span class="line">                a = choice(sieve_base)</span><br><span class="line">                n *= a</span><br><span class="line">            <span class="keyword">if</span> isPrime(n + <span class="number">1</span>):</span><br><span class="line">                <span class="keyword">return</span> n + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self</span>):</span><br><span class="line">        m_ = bytes_to_long(self.m)</span><br><span class="line">        c = <span class="built_in">pow</span>(m_, self.e, self.p*self.q)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hex</span>(c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">self, msg</span>):</span><br><span class="line">        <span class="keyword">return</span> msg == self.m</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pubkey</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.p*self.q, self.e</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡ºæ˜¯p-1å…‰æ»‘ï¼Œä¸å¤šè¯´äº†ã€‚</p>
<h4 id="challenge3"><a href="#challenge3" class="headerlink" title="challenge3"></a>challenge3</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag3</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> choice</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RSAServe</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.e = <span class="number">65537</span></span><br><span class="line">        self.m = flag3</span><br><span class="line">        self.p = getPrime(<span class="number">896</span>)</span><br><span class="line">        self.n1 = self.getN()</span><br><span class="line">        self.n2 = self.getN()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getN</span>(<span class="params">self</span>):</span><br><span class="line">        q = getPrime(<span class="number">128</span>)</span><br><span class="line">        self.p = nextprime(self.p)</span><br><span class="line">        <span class="keyword">return</span> q*self.p</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self</span>):</span><br><span class="line">        m_ = bytes_to_long(self.m)</span><br><span class="line">        c = <span class="built_in">pow</span>(m_, self.e, self.n2)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hex</span>(c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">self, msg</span>):</span><br><span class="line">        <span class="keyword">return</span> msg == self.m</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pubkey</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.n1, self.n2 , self.e</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å‘ç°ï¼Œé¢˜ç›®çš„ä¸¤ä¸ªå…¬é’¥n1ã€n2æ˜¯æŒ‰å¦‚ä¸‹æ–¹å¼ç”Ÿæˆçš„ï¼š</p>
<script type="math/tex; mode=display">
n1 = q1 * p1</script><script type="math/tex; mode=display">
n2 = q2 * nextprime(p1)</script><p>å¯ä»¥çœ‹åˆ°ï¼Œn1ã€n2æœ‰ä¸€ä¸ªå› æ•°éå¸¸ç›¸è¿‘ï¼Œå‡ ä¹ç›¸ç­‰ã€‚é‚£ä¹ˆæˆ‘ä»¬æŠŠä¸Šé¢ä¸¤å¼å†™æˆåˆ†å¼å½¢å¼ï¼š</p>
<script type="math/tex; mode=display">
\frac{n1}{n2} = \frac{q1}{q2} * \frac{p1}{nextprime(p1)}</script><p>æ‰€ä»¥æœ‰ï¼š</p>
<script type="math/tex; mode=display">
\frac{n1}{n2} \approx \frac{q1}{q2}</script><p>å› æ­¤å°†n1/n2è¿›è¡Œè¿åˆ†æ•°å±•å¼€ï¼Œå°±å¾ˆæœ‰å¯èƒ½æ‰¾åˆ°q1/q2è¿™ä¸ªæ”¶æ•›å­ã€‚</p>
<h4 id="å®Œæ•´äº¤äº’"><a href="#å®Œæ•´äº¤äº’" class="headerlink" title="å®Œæ•´äº¤äº’"></a>å®Œæ•´äº¤äº’</h4><p>æœ€åè¿˜éœ€è¦æŠŠä»¥ä¸Šæ±‚è§£æ­¥éª¤å…¨éƒ¨å†™ä½œäº¤äº’ä¸‹çš„(å½“ç„¶æ‰‹åŠ¨ä¹Ÿè¡Œ)ï¼Œexpï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>():</span><br><span class="line">	table = string.digits + string.ascii_letters</span><br><span class="line">	temp = r.recvuntil(<span class="string">b&quot;sha256(XXXX+&quot;</span>)</span><br><span class="line">	temp = r.recvline()</span><br><span class="line">	suffix = temp[:<span class="number">16</span>].decode()</span><br><span class="line">	hex1 = temp[<span class="number">20</span>:].strip().decode()</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> tqdm(table):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> table:</span><br><span class="line">			<span class="keyword">for</span> k <span class="keyword">in</span> table:</span><br><span class="line">				<span class="keyword">for</span> m <span class="keyword">in</span> table:</span><br><span class="line">					temp1 = i+j+k+m</span><br><span class="line">					<span class="keyword">if</span>(sha256((temp1+suffix).encode()).hexdigest() == hex1):</span><br><span class="line">						r.sendline(temp1.encode())</span><br><span class="line">						<span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;43.139.107.237&quot;</span>,<span class="number">10006</span>)</span><br><span class="line"></span><br><span class="line">proof_of_work()</span><br><span class="line"></span><br><span class="line"><span class="comment">#chall1</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span>):</span><br><span class="line">    temp = r.recvuntil(<span class="string">b&quot;select challange&#123;1,2,3&#125;&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;-----------/&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">    r.recvline()</span><br><span class="line">    r.recvline()</span><br><span class="line">    n = <span class="built_in">int</span>(r.recvline().strip().decode()[<span class="number">2</span>:])</span><br><span class="line">    e = <span class="built_in">int</span>(r.recvline().strip().decode())</span><br><span class="line">    r.sendline(<span class="string">b&quot;2&quot;</span>)</span><br><span class="line">    gift = <span class="built_in">int</span>(r.recvline().strip().decode())</span><br><span class="line">    c = <span class="built_in">int</span>(r.recvline().strip().decode()[<span class="number">2</span>:],<span class="number">16</span>)</span><br><span class="line">    p = GCD((gift - <span class="number">1</span>),n)</span><br><span class="line">    q = n // p</span><br><span class="line">    d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">    r.sendline(<span class="string">b&quot;3&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;input your answer: &quot;</span>)</span><br><span class="line">    r.sendline(long_to_bytes(m))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Chall1 done!&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#chall2</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span>):</span><br><span class="line">    temp = r.recvuntil(<span class="string">b&quot;select challange&#123;1,2,3&#125;&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">b&quot;2&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;-----------/&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">    r.recvline()</span><br><span class="line">    r.recvline()</span><br><span class="line">    n = <span class="built_in">int</span>(r.recvline().strip().decode()[<span class="number">2</span>:])</span><br><span class="line">    e = <span class="built_in">int</span>(r.recvline().strip().decode())</span><br><span class="line">    r.sendline(<span class="string">b&quot;2&quot;</span>)</span><br><span class="line">    c = <span class="built_in">int</span>(r.recvline().strip().decode()[<span class="number">2</span>:],<span class="number">16</span>)</span><br><span class="line">    a = <span class="number">2</span></span><br><span class="line">    m = <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = <span class="built_in">pow</span>(a, m, n)</span><br><span class="line">        p = GCD(a-<span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">if</span> p != <span class="number">1</span> <span class="keyword">and</span> p != n:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        m += <span class="number">1</span></span><br><span class="line">    q = n // p</span><br><span class="line">    phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">    r.sendline(<span class="string">b&quot;3&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;input your answer: &quot;</span>)</span><br><span class="line">    r.sendline(long_to_bytes(m))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Chall2 done!&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#chall3</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span>):</span><br><span class="line">    <span class="comment">#å±•å¼€ä¸ºè¿åˆ†æ•°åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">continuedFra</span>(<span class="params">x, y</span>):</span><br><span class="line">        cF = []</span><br><span class="line">        <span class="keyword">while</span> y:</span><br><span class="line">            cF += [x // y]</span><br><span class="line">            x, y = y, x % y</span><br><span class="line">        <span class="keyword">return</span> cF</span><br><span class="line">    <span class="comment">#å°†å½“å‰è¿åˆ†æ•°åˆ—è¡¨è®¡ç®—æˆæœ‰ç†åˆ†æ•°</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Simplify</span>(<span class="params">ctnf</span>):</span><br><span class="line">        numerator = <span class="number">0</span></span><br><span class="line">        denominator = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> ctnf[::-<span class="number">1</span>]:</span><br><span class="line">            numerator, denominator = denominator, x * denominator + numerator</span><br><span class="line">        <span class="keyword">return</span> (numerator, denominator)</span><br><span class="line">    <span class="comment">#å°†è¿åˆ†æ•°åˆ—è¡¨å˜æˆä¸åŒçš„æœ‰ç†æ•°é€¼è¿‘åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getit</span>(<span class="params">c</span>):</span><br><span class="line">        cf=[]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(c)):</span><br><span class="line">            cf.append(Simplify(c[:i]))</span><br><span class="line">        <span class="keyword">return</span> cf</span><br><span class="line"></span><br><span class="line">    temp = r.recvuntil(<span class="string">b&quot;select challange&#123;1,2,3&#125;&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">b&quot;3&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;-----------/&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">    r.recvline()</span><br><span class="line">    r.recvline()</span><br><span class="line">    n1 = <span class="built_in">int</span>(r.recvline().strip().decode()[<span class="number">2</span>:])</span><br><span class="line">    n2 = <span class="built_in">int</span>(r.recvline().strip().decode())</span><br><span class="line">    e = <span class="built_in">int</span>(r.recvline().strip().decode())</span><br><span class="line">    r.sendline(<span class="string">b&quot;2&quot;</span>)</span><br><span class="line">    c = <span class="built_in">int</span>(r.recvline().strip().decode()[<span class="number">2</span>:],<span class="number">16</span>)</span><br><span class="line">    q1 = continuedFra(n1,n2)</span><br><span class="line">    q1 = getit(q1)</span><br><span class="line">    <span class="keyword">for</span> a,b <span class="keyword">in</span> q1[<span class="number">4</span>:]:</span><br><span class="line">        <span class="keyword">if</span>(n2 % a == <span class="number">0</span> <span class="keyword">and</span> isPrime(a) <span class="keyword">and</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(a)) &gt; <span class="number">126</span>):</span><br><span class="line">            q2 = a</span><br><span class="line">            p__ = n2 // q2</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    d = inverse(e,(p__-<span class="number">1</span>)*(q2-<span class="number">1</span>))</span><br><span class="line">    m = <span class="built_in">pow</span>(c,d,n2)</span><br><span class="line">    r.sendline(<span class="string">b&quot;3&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;input your answer: &quot;</span>)</span><br><span class="line">    r.sendline(long_to_bytes(m))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Chall3 done!&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#getflag</span></span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line"><span class="built_in">print</span>(r.recvline())</span><br><span class="line"></span><br><span class="line"><span class="comment">#0xGame&#123;a1425c9ce44989ffd64968130ee2f9fd&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
]]></content>
      <categories>
        <category>wp-crypto</category>
      </categories>
  </entry>
  <entry>
    <title>2023-CNSS-Summer-wp-crypto</title>
    <url>/post/795314c1.html</url>
    <content><![CDATA[<p>è¦ç»™è‡ªå·±å­¦æ ¡çš„æ‹›æ–°èµ›å‡ºé¢˜äº†ï¼Œäºæ˜¯æ··è¿›CNSSæ‹›æ–°èµ›å‰çš„å¤ä»¤è¥æ‰¾æ‰¾å‡ºé¢˜çµæ„Ÿï¼Œä¸å¾—ä¸è¯´ï¼Œå¾ˆå¤šé¢˜ç›®éƒ½å‡ºçš„å¾ˆä¸é”™ï¼Œéš¾åº¦ä¸çŸ¥è¯†ç‚¹æ§åˆ¶çš„å¾ˆå¥½ï¼Œäºæ˜¯åœ¨æ­¤è®°å½•ä¸€ä¸‹ã€‚</p>
<span id="more"></span>
<p>Rankï¼š3</p>
<p><img src="/post/795314c1/image-20230916080626025.png" alt="image-20230916080626025"></p>
<h2 id="Crypto-Guideline"><a href="#Crypto-Guideline" class="headerlink" title="Crypto Guideline"></a>Crypto Guideline</h2><p>ç­¾åˆ°é¢˜ï¼Œæ ‡å¿—ç€cryptoæ–¹å‘é¢˜ç›®çš„å¼€å§‹ï¼Œç›´æ¥æäº¤flagå³å¯ã€‚</p>
<p>flag:</p>
<font size="4" color="red">cnss{Welcome to the world of cryptography!}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="cyclic-group"><a href="#cyclic-group" class="headerlink" title="cyclic group"></a>cyclic group</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¯ä»¥æ‰¾åˆ°æˆ‘è—åœ¨å¾ªç¯ç¾¤ä¸­çš„flagå—ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®å†…å®¹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag  <span class="comment">## secret is a local file, flag is unknown to you</span></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = getPrime(<span class="number">512</span>)</span><br><span class="line">c = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(e):</span><br><span class="line">    c *= m   </span><br><span class="line">    c %= p</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p =&#x27;</span>, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;e =&#x27;</span>, e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p = 134994058501022133829793113756450648798182080773931273262418798773562440624857106163310596590759607340807163876539520282102901165977612358002331391089851066812663281502398201018663717659213732276911585751665516661301930410244101046617666467321456930120075263141242119953757880295718825254018040413826880843763</span></span><br><span class="line"><span class="string">e = 12927587515508549311645504126259938927362775210786958053823827936884288861306268493761629822045846148118653977616493302703588300283111036739875491883808759</span></span><br><span class="line"><span class="string">c = 46583597391505868783218970830156160405763802889228578452060606957717500160663392513770581781157233604314178955789908254475724009921579917780127649365498088467948777432657442293331639740286781008682662602974865442032279819833194544535317410041738966384493317240586005380761492762248899523164168679218802048162</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå®é™…ä¸Šå°±æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
m^e\equiv c\quad (mod\;p)</script><p>å› æ­¤ç›´æ¥å¹‚ä¹˜eå…³äºp-1çš„é€†å…ƒå³å¯ã€‚è€Œæœ¬é¢˜çš„é¢˜ç›®åå­—cyclic groupæŒ‡ä»£çš„æ˜¯å¾ªç¯ç¾¤ï¼Œåœ¨è¿™é‡Œå³æ˜¯åœ¨è¯´ï¼Œç”±äºæ¨¡æ•°pä¸ºç´ æ•°ï¼Œé‚£ä¹ˆç¾¤Z*(p)çš„é˜¶å°±ä¸ºp-1ï¼Œå› æ­¤å…¶ä¸­ä»»æ„ä¸€ä¸ªå…ƒç´ æ»¡è¶³ï¼š</p>
<script type="math/tex; mode=display">
a^{p-1} \equiv 1 \quad (mod\;p)</script><p>å› æ­¤å¯ä»¥ç›´æ¥æ±‚æŒ‡æ•°å…³äºp-1çš„é€†å…ƒæ±‚è§£é¢˜ç›®ã€‚</p>
<p><br></p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">134994058501022133829793113756450648798182080773931273262418798773562440624857106163310596590759607340807163876539520282102901165977612358002331391089851066812663281502398201018663717659213732276911585751665516661301930410244101046617666467321456930120075263141242119953757880295718825254018040413826880843763</span></span><br><span class="line">e = <span class="number">12927587515508549311645504126259938927362775210786958053823827936884288861306268493761629822045846148118653977616493302703588300283111036739875491883808759</span></span><br><span class="line">c = <span class="number">46583597391505868783218970830156160405763802889228578452060606957717500160663392513770581781157233604314178955789908254475724009921579917780127649365498088467948777432657442293331639740286781008682662602974865442032279819833194544535317410041738966384493317240586005380761492762248899523164168679218802048162</span></span><br><span class="line"></span><br><span class="line">d = inverse(e,p-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,p)))</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{Unbelievable! You know the key of cyclic group!}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="cnsså¨˜çš„ä»£ç â… "><a href="#cnsså¨˜çš„ä»£ç â… " class="headerlink" title="cnsså¨˜çš„ä»£ç â… "></a>cnsså¨˜çš„ä»£ç â… </h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cnsså¨˜å†™äº†ä¸€æ®µæ„Ÿè§‰æ„ä¹‰ä¸æ˜çš„ä»£ç ï¼Œä½ èƒ½å¸®å¥¹æ‰¾åˆ°flagå—ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag  </span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">key = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    key.append(getPrime(<span class="number">128</span>))</span><br><span class="line">    </span><br><span class="line">secret = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    secret.append(m % key[i])</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;key =&#x27;</span>, key)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;secret =&#x27;</span>, secret)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">key = [179283057970236760812385016853348861313, 243730152305882610684268424505624182831, 276375013783217805474364273321195364813, 338363147025326331069698214354955107607]</span></span><br><span class="line"><span class="string">secret = [42312333420922777926503668120694248887, 188911830445106862831548334980052602782, 202272400826094059912187609891368651300, 16939666639933430404336668949000187621]</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>
<p>ç®€æ´æ˜äº†åœ°è€ƒå¯Ÿä¸­å›½å‰©ä½™å®šç†ã€‚</p>
<p><br></p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"><span class="comment">#ä½¿ç”¨å¦‚ï¼šM = crt(n,c)[0]</span></span><br><span class="line">key = [<span class="number">179283057970236760812385016853348861313</span>, <span class="number">243730152305882610684268424505624182831</span>, <span class="number">276375013783217805474364273321195364813</span>, <span class="number">338363147025326331069698214354955107607</span>]</span><br><span class="line">secret = [<span class="number">42312333420922777926503668120694248887</span>, <span class="number">188911830445106862831548334980052602782</span>, <span class="number">202272400826094059912187609891368651300</span>, <span class="number">16939666639933430404336668949000187621</span>]</span><br><span class="line"></span><br><span class="line">M = crt(key,secret)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(M))</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{Wow!Chinese remainder theorem is so interseting!}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="RSA-â… "><a href="#RSA-â… " class="headerlink" title="RSA â… "></a>RSA â… </h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Can you factorize n ?</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">mask = getPrime(<span class="number">512</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;mask = <span class="subst">&#123;mask&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(p|mask)</span><br><span class="line"><span class="built_in">print</span>(p&amp;mask)</span><br><span class="line"></span><br><span class="line"><span class="comment">#c = 64949799997326584007544788513993497249594769744995858720976935000014197232306799968807213667255871030075230919683627404813038995304033226711042639925325815395252041199650244620814678407788637241064396318107929964286966081900052163098825412222835465966640369222321472659135622216530966800717417560715221275591</span></span><br><span class="line"><span class="comment">#n = 106750680418525866311589462967145265327203310954735134383588573660691518247034803380198999333962213971657327515092895034635965957228036264848532931376595751503164297061094511187060069380048933807326213369464059701069965785612620370291933800122445966488267918733547599024267999872488061941892122230382138042783</span></span><br><span class="line"><span class="comment">#mask = 12270330408774238331968219216635392599519489634111741706590917012819298856158311310855782884352875794146685141255943386189197362902992928716839082520848927</span></span><br><span class="line"><span class="comment">#13112112110892990771168306272793201342028151601627796725313855804865001339738164412798270175076178951452110894792943424133718769511979832250960465757056799</span></span><br><span class="line"><span class="comment">#11731832079629748669705816329667815638461774924918417348984676937048335348013101619038697983623814812736529127108466295988845879378764866277739393693264401</span></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ç»™äº†nçš„ä¸€ä¸ªç´ å› å­pä¸maskçš„&amp;åŠ|ä½è¿ç®—ç»“æœï¼Œé‚£ä¹ˆå¯¹äºæ¯ä¸€ä½ï¼Œå¯ä»¥ç®€å•æšä¸¾ä¸€ä¸‹æ‰€æœ‰å¯èƒ½æ€§ï¼š</p>
<ul>
<li>&amp;è¿ç®—ä¸º1ï¼Œåˆ™pè¯¥ä½ä¸º1</li>
<li>&amp;è¿ç®—ä¸º0ï¼Œ|è¿ç®—ä¸º1ï¼Œåˆ™å½“maskè¯¥ä½ä¸º1æ—¶ï¼Œpè¯¥ä½ä¸º0ï¼›å½“maskè¯¥ä½ä¸º0æ—¶ï¼Œpè¯¥ä½ä¸º1</li>
<li>&amp;è¿ç®—ä¸º0ï¼Œ|è¿ç®—ä¸º0ï¼Œåˆ™pè¯¥ä½ä¸º0</li>
</ul>
<p>å› æ­¤å¯ä»¥è¿˜åŸpçš„æ‰€æœ‰æ¯”ç‰¹ä½ï¼Œè¿›è€Œè§£å¯†RSAã€‚</p>
<p><br></p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = <span class="number">64949799997326584007544788513993497249594769744995858720976935000014197232306799968807213667255871030075230919683627404813038995304033226711042639925325815395252041199650244620814678407788637241064396318107929964286966081900052163098825412222835465966640369222321472659135622216530966800717417560715221275591</span></span><br><span class="line">n = <span class="number">106750680418525866311589462967145265327203310954735134383588573660691518247034803380198999333962213971657327515092895034635965957228036264848532931376595751503164297061094511187060069380048933807326213369464059701069965785612620370291933800122445966488267918733547599024267999872488061941892122230382138042783</span></span><br><span class="line">mask = <span class="number">12270330408774238331968219216635392599519489634111741706590917012819298856158311310855782884352875794146685141255943386189197362902992928716839082520848927</span></span><br><span class="line">gift1 = <span class="number">13112112110892990771168306272793201342028151601627796725313855804865001339738164412798270175076178951452110894792943424133718769511979832250960465757056799</span></span><br><span class="line">gift2 = <span class="number">11731832079629748669705816329667815638461774924918417348984676937048335348013101619038697983623814812736529127108466295988845879378764866277739393693264401</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">strmask = <span class="built_in">bin</span>(mask)[<span class="number">2</span>:]</span><br><span class="line">strgift1 = <span class="built_in">bin</span>(gift1)[<span class="number">2</span>:]</span><br><span class="line">strgift2 = <span class="built_in">bin</span>(gift2)[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">strp = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(strmask)):</span><br><span class="line">    <span class="keyword">if</span>(strgift2[i] == <span class="string">&quot;1&quot;</span>):</span><br><span class="line">        strp.append(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span>(strgift1[i] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> strmask[i] == <span class="string">&quot;0&quot;</span>):</span><br><span class="line">            strp.append(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span>(strgift1[i] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> strmask[i] == <span class="string">&quot;1&quot;</span>):</span><br><span class="line">            strp.append(<span class="string">&quot;0&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            strp.append(<span class="string">&quot;0&quot;</span>)</span><br><span class="line"></span><br><span class="line">p = <span class="built_in">int</span>(<span class="string">&quot;&quot;</span>.join(strp),<span class="number">2</span>)</span><br><span class="line">q= n//p       </span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{1t_s33ms_bit_is_useful}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="cnsså¨˜çš„ä»£ç -â…¡"><a href="#cnsså¨˜çš„ä»£ç -â…¡" class="headerlink" title="cnsså¨˜çš„ä»£ç  â…¡"></a>cnsså¨˜çš„ä»£ç  â…¡</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cnsså¨˜æœ€è¿‘åœ¨ç ”ç©¶ä¸€ç±»æ•°è®ºä¸­çš„éš¾é¢˜ï¼Œä½ å¯ä»¥å¸®åŠ©å¥¹å—ï¼Ÿ</span><br><span class="line">Hint: SageMathçš„ä½¿ç”¨å¯ä»¥è®©ä½ äº‹åŠåŠŸå€</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag  </span><br><span class="line"></span><br><span class="line">p = <span class="number">149223181221309438217142971731290162048502071683234438807455153639165894737664410172266260056805353255967638568356843140306590887937</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">g = <span class="number">7</span></span><br><span class="line">h = <span class="built_in">pow</span>(g, m, p)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;h =&#x27;</span>, h)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">106414500627466044750537699496116452216938505790285966641538755230718107434518035561502262320845803494959251547594598724676292650073</span></span><br></pre></td></tr></table></figure>
<p>ç›´æ¥ç”¨sageæ±‚è§£ç¦»æ•£å¯¹æ•°å³å¯ã€‚</p>
<p><br></p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">149223181221309438217142971731290162048502071683234438807455153639165894737664410172266260056805353255967638568356843140306590887937</span></span><br><span class="line">g = <span class="number">7</span></span><br><span class="line">h = <span class="number">106414500627466044750537699496116452216938505790285966641538755230718107434518035561502262320845803494959251547594598724676292650073</span></span><br><span class="line"></span><br><span class="line">m=discrete_log(mod(h,p),mod(g,p))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{Congratulation! You crack the DLP problem!}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="cnsså¨˜çš„ä»£ç -â…¢"><a href="#cnsså¨˜çš„ä»£ç -â…¢" class="headerlink" title="cnsså¨˜çš„ä»£ç  â…¢"></a>cnsså¨˜çš„ä»£ç  â…¢</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cnsså¨˜æœ€è¿‘åœ¨å­¦ä¹ çº¿æ€§ä»£æ•°ï¼Œä½ å¯ä»¥å¸®å¥¹è§£å‡ºè¿™é“é¢˜å—ï¼Ÿ</span><br><span class="line">Hint:Sage ä¸­è‡ªå¸¦æœ‰ Matrix å’Œ Vector ç±»ã€‚</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag  </span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">40</span></span><br><span class="line">p = <span class="number">9536720961414799253</span></span><br><span class="line">u = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">40</span>, <span class="number">5</span>):</span><br><span class="line">    u.append(bytes_to_long(flag[i:i+<span class="number">5</span>]))</span><br><span class="line">u = vector(u)</span><br><span class="line">A = random_matrix(Zmod(p), <span class="number">8</span>)</span><br><span class="line">v = u * A</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;A =&#x27;</span>, A)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;v =&#x27;</span>, v)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">A = [7907672172473958392 4938237561047760432 5072996306459844921  800347085054263333 2241217299487989740 5452520396763079026 7354205761061650589 5632270298193588206]</span></span><br><span class="line"><span class="string">[6856262700627435223 7218982369550725117 3069216736555490147 9043167152368671477 6651431740452419751 2904199636400840775 1984801523985180355 9424612078019686546]</span></span><br><span class="line"><span class="string">[ 190015986177831045  594687507332748466 2546708346651205091 3864956414971412519 2586812319675472372 2541554633306459284 2840981234492698127  400426130440806923]</span></span><br><span class="line"><span class="string">[ 354930743948767363  374079227033274174 7821379197355217415 4073976921774664952 8974661879090783904 8725597754431417139 1723115467249027682  914056616366301410]</span></span><br><span class="line"><span class="string">[9032929938905307703  569436029465728354 3230536280479973685 9499318835507740454  460664783708095350 3815328100857956310 6866516203996475375 9142528333783640721]</span></span><br><span class="line"><span class="string">[6647724854667560614 1564543033588842443  980081446425820918 4482664640152609224 9361385831487208956 5729265277086036438 8521779175294512538 7872078731489374461]</span></span><br><span class="line"><span class="string">[2426759667632064565 2564361116290067541 5109836057988930695 3948680632682199428 8561341181219447072 5099840518920477627 9347277712921710222 4364598388067284951]</span></span><br><span class="line"><span class="string">[2143804620259054744 4318231909289693782 6284698432978577252 5529804751795288609 7903556036971407808 3730126758887833322 8782120630459581951 9050476736532525999]</span></span><br><span class="line"><span class="string">v = (4088048241727106122, 258857328202723850, 7303598013681209756, 3446975206276714926, 176458751236949790, 8151363680348349027, 8771366063042882128, 9003511237633705064)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>ç›´æ¥åœ¨sageä¸­æ±‚è§£é€†çŸ©é˜µå³å¯</p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">9536720961414799253</span></span><br><span class="line">A = [[<span class="number">7907672172473958392</span>,<span class="number">4938237561047760432</span>,<span class="number">5072996306459844921</span>,<span class="number">800347085054263333</span>,<span class="number">2241217299487989740</span>,<span class="number">5452520396763079026</span>,<span class="number">7354205761061650589</span>,<span class="number">5632270298193588206</span>],</span><br><span class="line">[<span class="number">6856262700627435223</span>,<span class="number">7218982369550725117</span>,<span class="number">3069216736555490147</span>,<span class="number">9043167152368671477</span>,<span class="number">6651431740452419751</span>,<span class="number">2904199636400840775</span>,<span class="number">1984801523985180355</span>,<span class="number">9424612078019686546</span>],</span><br><span class="line">[<span class="number">190015986177831045</span>,<span class="number">594687507332748466</span>,<span class="number">2546708346651205091</span>,<span class="number">3864956414971412519</span>,<span class="number">2586812319675472372</span>,<span class="number">2541554633306459284</span>,<span class="number">2840981234492698127</span>,<span class="number">400426130440806923</span>],</span><br><span class="line">[<span class="number">354930743948767363</span>,<span class="number">374079227033274174</span>,<span class="number">7821379197355217415</span>,<span class="number">4073976921774664952</span>,<span class="number">8974661879090783904</span>,<span class="number">8725597754431417139</span>,<span class="number">1723115467249027682</span>,<span class="number">914056616366301410</span>],</span><br><span class="line">[<span class="number">9032929938905307703</span>,<span class="number">569436029465728354</span>,<span class="number">3230536280479973685</span>,<span class="number">9499318835507740454</span>,<span class="number">460664783708095350</span>,<span class="number">3815328100857956310</span>,<span class="number">6866516203996475375</span>,<span class="number">9142528333783640721</span>],</span><br><span class="line">[<span class="number">6647724854667560614</span>,<span class="number">1564543033588842443</span>,<span class="number">980081446425820918</span>,<span class="number">4482664640152609224</span>,<span class="number">9361385831487208956</span>,<span class="number">5729265277086036438</span>,<span class="number">8521779175294512538</span>,<span class="number">7872078731489374461</span>],</span><br><span class="line">[<span class="number">2426759667632064565</span>,<span class="number">2564361116290067541</span>,<span class="number">5109836057988930695</span>,<span class="number">3948680632682199428</span>,<span class="number">8561341181219447072</span>,<span class="number">5099840518920477627</span>,<span class="number">9347277712921710222</span>,<span class="number">4364598388067284951</span>],</span><br><span class="line">[<span class="number">2143804620259054744</span>,<span class="number">4318231909289693782</span>,<span class="number">6284698432978577252</span>,<span class="number">5529804751795288609</span>,<span class="number">7903556036971407808</span>,<span class="number">3730126758887833322</span>,<span class="number">8782120630459581951</span>,<span class="number">9050476736532525999</span>]]</span><br><span class="line"></span><br><span class="line">ans = [<span class="number">4088048241727106122</span>, <span class="number">258857328202723850</span>, <span class="number">7303598013681209756</span>, <span class="number">3446975206276714926</span>, <span class="number">176458751236949790</span>, <span class="number">8151363680348349027</span>, <span class="number">8771366063042882128</span>, <span class="number">9003511237633705064</span>]</span><br><span class="line">A = matrix(A)</span><br><span class="line">ans = matrix(ans)</span><br><span class="line"></span><br><span class="line">flag = ans * A.inverse()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¾—åˆ°flagåè½¬åŒ–ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">flag = [<span class="number">256128467098287645152364579619033136532012336082411188262170716121111141373910417997647279385874168289963422098883372524388175789168151018039664118938</span>/<span class="number">201110710500527103391704345109970877861492963385688540350899980246056954432876844511421798766202341953924005687593642435623584608348351172354206968203</span>,-<span class="number">275157020682273200260243873388370073035487413746791277567209773631463468440360425377838149581773104213153845176881963804588249058534505227929576082442</span>/<span class="number">201110710500527103391704345109970877861492963385688540350899980246056954432876844511421798766202341953924005687593642435623584608348351172354206968203</span>,<span class="number">205418055261423253440834873996888852743735400527184165431288083430874722579052114104669136088527642186595043026543683492544648632576976821633919688987</span>/<span class="number">67036903500175701130568115036656959287164321128562846783633326748685651477625614837140599588734113984641335229197880811874528202782783724118068989401</span>,<span class="number">18887682222057954947813918789359532063827948125435329591909175563625225112660734620218938715145807440112704581336669611824654566923603748916776016972</span>/<span class="number">67036903500175701130568115036656959287164321128562846783633326748685651477625614837140599588734113984641335229197880811874528202782783724118068989401</span>,-<span class="number">25792447761509638420556125881168126603544490324749544374648563355312526747005861915100426458158515036632551136815312658182069136958880193280291853604</span>/<span class="number">201110710500527103391704345109970877861492963385688540350899980246056954432876844511421798766202341953924005687593642435623584608348351172354206968203</span>,<span class="number">263743295233022646271965564265774549530140797857736570979958721892220519418537528753856004044323800915867363751008926223858363297878551362225736657993</span>/<span class="number">201110710500527103391704345109970877861492963385688540350899980246056954432876844511421798766202341953924005687593642435623584608348351172354206968203</span>,-<span class="number">839256526384408301445325525932265486477039492555936647496320730347707472223889935476141937534810747723549651396954028900430020396698162916210131940419</span>/<span class="number">201110710500527103391704345109970877861492963385688540350899980246056954432876844511421798766202341953924005687593642435623584608348351172354206968203</span>,<span class="number">165200370960939593750718733159922760922513289005013438437371715048231002848101266223391623531454692435044072426966916629687643829467166749676754679429</span>/<span class="number">67036903500175701130568115036656959287164321128562846783633326748685651477625614837140599588734113984641335229197880811874528202782783724118068989401</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(long_to_bytes(<span class="built_in">int</span>(i % p)))[<span class="number">2</span>:-<span class="number">1</span>],end = <span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{Line8ar alg3ebra 1s 50 i0mportant!}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="HomoBlock"><a href="#HomoBlock" class="headerlink" title="HomoBlock"></a>HomoBlock</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä½ æ˜¯ä¸€ä¸ªï¼Œä¸€ä¸ªä¸€ä¸ªä¸€ä¸ªHomoå•Šå•Šå•Šå•Šå•Šå•Šå•Š</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getRandomNBitInteger</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">b&#x27;cnss&#123;I_a&#x27;</span>) <span class="keyword">and</span> flag.endswith(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag)%<span class="number">8</span>==<span class="number">0</span></span><br><span class="line">MASK1 = getRandomNBitInteger(<span class="number">32</span>)|(<span class="number">0xffffffff00000000</span>)</span><br><span class="line">MASK2 = getRandomNBitInteger(<span class="number">32</span>)&lt;&lt;<span class="number">32</span></span><br><span class="line">ROUND = <span class="number">5</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genKey</span>():</span><br><span class="line">    tmp = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ROUND):</span><br><span class="line">        tmp.append(getRandomNBitInteger(<span class="number">64</span>))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">NotHomoFunction</span>(<span class="params">x,iv,key</span>):</span><br><span class="line">    <span class="keyword">return</span> ((x&lt;&lt;iv)&amp;MASK1)^((x&gt;&gt;iv)|MASK2)^key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">message,iv,key</span>):</span><br><span class="line">    cipher = bytes_to_long(message)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ROUND):</span><br><span class="line">        cipher = NotHomoFunction(cipher,iv,key)</span><br><span class="line">    <span class="keyword">return</span> cipher</span><br><span class="line"></span><br><span class="line">cipher = []</span><br><span class="line">iv = <span class="number">32</span></span><br><span class="line">key = getRandomNBitInteger(<span class="number">64</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(flag),<span class="number">8</span>):</span><br><span class="line">    cipher.append(encrypt(flag[i:i+<span class="number">8</span>],iv,key))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(cipher)</span><br><span class="line"><span class="built_in">print</span>(iv)</span><br><span class="line"><span class="built_in">print</span>(MASK2)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot; </span></span><br><span class="line"><span class="string">[4840951631397558164, 5492303526413306583, 6271460196030786735, 6127905759336302986, 601209385465514967]</span></span><br><span class="line"><span class="string">32</span></span><br><span class="line"><span class="string">16500653344889503744</span></span><br></pre></td></tr></table></figure>
<p>è§‚å¯ŸåŠ å¯†æ–¹å¼ï¼Œå‘ç°å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹:</p>
<ul>
<li>æ˜æ–‡æŒ‰é•¿åº¦ä¸º8åˆ†ç»„ï¼Œåˆ†åˆ«åŠ å¯†</li>
<li>æ¯ä¸€è½®äº¤æ¢ä¸Šä¸€è½®å¾—åˆ°ç»“æœçš„é«˜ä½32ä½ï¼Œç„¶åå¼‚æˆ– MASK2 ï¼Œå¼‚æˆ–keyã€‚</li>
</ul>
<p>å¯ä»¥å‘ç°ï¼Œè¿™æ ·äº¤æ¢4æ¬¡åå°±ä¼šæ¢å¤åˆå€¼ï¼Œæ‰€ä»¥å®é™…äº¤æ¢5æ¬¡åï¼Œå°±èƒ½å¾—åˆ°åˆå§‹å€¼å¼‚æˆ– MASK2 å¹¶å¼‚æˆ–keyçš„ç»“æœã€‚åˆå› ä¸ºæ˜æ–‡çš„ç¬¬ä¸€éƒ¨åˆ†å·²ç»ç»™å‡ºï¼Œæ‰€ä»¥å¯ä»¥æ ¹æ®è¿™ä¸ªæ˜æ–‡æ¢å¤keyï¼Œåç»­é€æ­¥æ¢å¤å³å¯ã€‚</p>
<p><br></p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;cnss&#123;I_a&#x27;</span></span><br><span class="line">f0 = bytes_to_long(flag)</span><br><span class="line">p = [<span class="number">4840951631397558164</span>, <span class="number">5492303526413306583</span>, <span class="number">6271460196030786735</span>, <span class="number">6127905759336302986</span>, <span class="number">601209385465514967</span>]</span><br><span class="line">MASK2 = <span class="number">16500653344889503744</span></span><br><span class="line">f1 = p[<span class="number">0</span>]</span><br><span class="line">hf0, lf0 = (f0 &gt;&gt; <span class="number">32</span>, f0 % (<span class="number">2</span> ** <span class="number">32</span>))</span><br><span class="line">hf1, lf1 = (f1 &gt;&gt; <span class="number">32</span>, f1 % (<span class="number">2</span> ** <span class="number">32</span>))</span><br><span class="line">hk = hf1 ^ lf0 ^ (MASK2 &gt;&gt; <span class="number">32</span>)</span><br><span class="line">lk = lf1 ^ hf0</span><br><span class="line">key = (hk &lt;&lt; <span class="number">32</span>) + lk</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> p:</span><br><span class="line">	l, h = ((i ^ MASK2 ^ key) &gt;&gt; <span class="number">32</span>, (i ^ MASK2 ^ key) % (<span class="number">2</span> ** <span class="number">32</span>))</span><br><span class="line">	flag += long_to_bytes((h &lt;&lt; <span class="number">32</span>) | l).decode()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{I_am_n0t_HHHHHHoooommmmmmmoooo0000}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="ezLFSR"><a href="#ezLFSR" class="headerlink" title="ezLFSR"></a>ezLFSR</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">do you know LFSR?</span><br><span class="line">Hint1:è€ƒç‚¹ï¼š LFSRæµå¯†ç </span><br><span class="line">Hint2:å¯ä»¥ä½¿ç”¨ z3solver ã€‚</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<p>task.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> mask,seed</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LFSR</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed, mask, length</span>):</span><br><span class="line">        self.length_mask = <span class="number">2</span> ** length - <span class="number">1</span></span><br><span class="line">        self.mask = mask &amp; self.length_mask</span><br><span class="line">        self.state = seed &amp; self.length_mask</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        next_state = (self.state &lt;&lt; <span class="number">1</span>) &amp; self.length_mask</span><br><span class="line">        i = self.state &amp; self.mask &amp; self.length_mask</span><br><span class="line">        output = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i != <span class="number">0</span>:</span><br><span class="line">            output ^= (i &amp; <span class="number">1</span>)</span><br><span class="line">            i = i &gt;&gt; <span class="number">1</span></span><br><span class="line">        next_state ^= output</span><br><span class="line">        self.state = next_state</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getrandbit</span>(<span class="params">self, nbit</span>):</span><br><span class="line">        output = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(nbit):</span><br><span class="line">            output = (output &lt;&lt; <span class="number">1</span>) ^ self.<span class="built_in">next</span>()</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">cipher, ipath, opath</span>):</span><br><span class="line">    ifile=<span class="built_in">open</span>(ipath,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">    ofile=<span class="built_in">open</span>(opath,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">    plaintext=ifile.read()</span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> plaintext:</span><br><span class="line">        c=ch^cipher.getrandbit(<span class="number">8</span>)</span><br><span class="line">        ofile.write(long_to_bytes(c))</span><br><span class="line">    ifile.close()</span><br><span class="line">    ofile.close()</span><br><span class="line"></span><br><span class="line">lfsr = LFSR(seed, mask, <span class="number">16</span>)</span><br><span class="line">encrypt(lfsr,<span class="string">&#x27;flag.txt&#x27;</span>,<span class="string">&#x27;cipher.enc&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;seed = <span class="subst">&#123;seed&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># seed = 37285</span></span><br></pre></td></tr></table></figure>
<p>cipher.encï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">E3306EA1B67E13D02B59A0DEA270AD8C3AF0110FBF60C07740A699A5918E7DC5</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„åˆ°maskä¹Ÿä»…å–äº†ä½16ä½ï¼Œé‚£ä¹ˆçˆ†ç ´çš„èŒƒå›´ä¹Ÿä»…æœ‰65536ï¼Œå› æ­¤ç›´æ¥çˆ†ç ´å‡ºç¬¦åˆè¦æ±‚çš„æ˜æ–‡ä¸²å³å¯ã€‚</p>
<p><br></p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LFSR</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed, mask, length</span>):</span><br><span class="line">        self.length_mask = <span class="number">2</span> ** length - <span class="number">1</span></span><br><span class="line">        self.mask = mask &amp; self.length_mask</span><br><span class="line">        self.state = seed &amp; self.length_mask</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        next_state = (self.state &lt;&lt; <span class="number">1</span>) &amp; self.length_mask</span><br><span class="line">        i = self.state &amp; self.mask &amp; self.length_mask</span><br><span class="line">        output = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i != <span class="number">0</span>:</span><br><span class="line">            output ^= (i &amp; <span class="number">1</span>)</span><br><span class="line">            i = i &gt;&gt; <span class="number">1</span></span><br><span class="line">        next_state ^= output</span><br><span class="line">        self.state = next_state</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getrandbit</span>(<span class="params">self, nbit</span>):</span><br><span class="line">        output = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(nbit):</span><br><span class="line">            output = (output &lt;&lt; <span class="number">1</span>) ^ self.<span class="built_in">next</span>()</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line">seed = <span class="number">37285</span></span><br><span class="line">hex_string = <span class="string">&quot;E3306EA1B67E13D02B59A0DEA270AD8C3AF0110FBF60C07740A699A5918E7DC5&quot;</span></span><br><span class="line"><span class="comment"># æ¯ä¸¤ä¸ªå­—ç¬¦ä¸€ç»„æ‹†åˆ†</span></span><br><span class="line">split_hex = [hex_string[i:i+<span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(hex_string), <span class="number">2</span>)]</span><br><span class="line"></span><br><span class="line">c = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> split_hex:</span><br><span class="line">    c.append(<span class="built_in">int</span>(i,<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">16</span>):</span><br><span class="line">    mask = i</span><br><span class="line">    lfsr = LFSR(seed, mask, <span class="number">16</span>)</span><br><span class="line">    clist = []</span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> c:</span><br><span class="line">        temp=ch^lfsr.getrandbit(<span class="number">8</span>)</span><br><span class="line">        clist.append(<span class="built_in">chr</span>(temp))</span><br><span class="line">    str1 = <span class="string">&quot;&quot;</span>.join(clist)</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">&quot;cnss&quot;</span> <span class="keyword">in</span> str1):</span><br><span class="line">        <span class="built_in">print</span>(str1)</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œæ—¶é—´å¤§æ¦‚éœ€è¦ä¸åˆ°1åˆ†é’Ÿã€‚</p>
<p>flag:</p>
<font size="4" color="red">cnss{Y0u_can_brust_0r_F1nd_seed}</font>

<p>ä»flagä¸²ä»¥åŠhintå¯ä»¥çœ‹å‡ºï¼Œæœ¬é¢˜åº”è¯¥æ˜¯å¯ä»¥é€šè¿‡LFSRçš„æ–¹å¼æ¢å¤æ˜æ–‡çš„ï¼Œä½†æ˜¯æ•°é‡çº§å¤ªå°ï¼Œæ²¡å¿…è¦ã€‚</p>
<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="RSA-â…¡"><a href="#RSA-â…¡" class="headerlink" title="RSA â…¡"></a>RSA â…¡</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">It&#x27;s more difficult than RSA â… ,right? Can you factorize n ?</span><br><span class="line">Hint:æŸ¥æ‰¾æœ‰å…³RSAæ”»å‡»çš„èµ„æ–™æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„æŠ€èƒ½ã€‚</span><br></pre></td></tr></table></figure>
<p>å¹¶æä¾›äº†ä¸€ç¯‡è®ºæ–‡é“¾æ¥ï¼š<a href="https://eprint.iacr.org/2020/1506.pdf">1506.pdf (iacr.org)</a></p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line">mask1 = <span class="number">8802124635072632944677646490123224379036416333544329119490072003355821545476873187055484863111312282268555945525261726909784693138184611507738758202965723</span></span><br><span class="line">mask2 = <span class="number">10267484648659998697412163107809730542736732193409802323765378917769614002176050843098384409535095473863894691160595931186139418791709781214996751031082601</span></span><br><span class="line"></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">mask1 = getPrime(<span class="number">512</span>)</span><br><span class="line">mask2 = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;mask1 = <span class="subst">&#123;mask1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;mask2 = <span class="subst">&#123;mask2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;h1 = <span class="subst">&#123;p&amp;mask1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;h2 = <span class="subst">&#123;q&amp;mask2&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 21645208345867622053024283678631971385301103104312441336174301067402923208233033116071987870811290403578077414872467955871236843078200772311176723821275372545792521252126496488134168455430882670865862282658077115199048181151105823370547063726203692258934054391552916645628374539820099986794258298843501009240</span></span><br><span class="line"><span class="string">n = 87282921750815275717132715603847471604654006135344540742956637574882193904171665195367477260090328888053170090015909620539666069545618781812315864580009968838414539707616636379202667918204792277927294032362873240288573251987386601263377458038218959813925307265939433229169884527274177006792047369788293125409</span></span><br><span class="line"><span class="string">mask1 = 8802124635072632944677646490123224379036416333544329119490072003355821545476873187055484863111312282268555945525261726909784693138184611507738758202965723</span></span><br><span class="line"><span class="string">mask2 = 10267484648659998697412163107809730542736732193409802323765378917769614002176050843098384409535095473863894691160595931186139418791709781214996751031082601</span></span><br><span class="line"><span class="string">h1 = 6706231204421711988537353586716977912583550778985616494052350868539347641557164021930575245010900470979740623857738159245103694128834121517146255441177729</span></span><br><span class="line"><span class="string">h2 = 6704397956705493482354535847135592349486638396996488745737387153856868045426992197309829534096366784379171117205125136777653995357887539312554042026362473</span></span><br></pre></td></tr></table></figure>
<p>ç›¸è¾ƒäºRSA1ï¼Œè¿™ä¸€æ¬¡ä¸èƒ½æ ¹æ®ä½è¿ç®—ç»“æœå®Œå…¨ç¡®å®šå‡ºpã€qçš„æ¯”ç‰¹ä½äº†ï¼Œä¸è¿‡ä»ç„¶å¯ä»¥åˆ©ç”¨ä»¥ä¸‹çº¿ç´¢è¿˜åŸï¼š</p>
<ul>
<li>&amp;è¿ç®—ä¸º1ï¼Œåˆ™pè¯¥ä½å¿…ä¸º1</li>
<li>&amp;è¿ç®—ä¸º0ï¼Œmaskè¯¥ä½ä¸º1ï¼Œåˆ™pè¯¥ä½å¿…ä¸º0</li>
</ul>
<p>è€Œå½“&amp;è¿ç®—ä¸º0ï¼Œmaskä¹Ÿä¸º0æ—¶ï¼Œpçš„è¯¥æ¯”ç‰¹ä½å°±å­˜åœ¨ä¸¤ç§ç»“æœï¼Œæ— æ³•å®Œå…¨ç¡®å®šã€‚å¯æ˜¯è¿™é¢˜ä¸ä»…ç»™äº†pï¼Œè¿˜ç»™äº†qçš„ä½è¿ç®—ç»“æœï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸‹é¢è¿™ä¸€ç‚¹ä¿¡æ¯ï¼Œä»é«˜ä½å‘ä½ä½è¿›è¡Œæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œæ˜¾è‘—é™ä½å¤æ‚åº¦ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1ã€å°†pã€qå½“å‰ç¡®å®šçš„äºŒè¿›åˆ¶ä½åæ–¹å…¨éƒ¨å¡«å……0ï¼Œç›´è‡³å¡«æ»¡512ä½ï¼Œæ­¤æ—¶pã€qä¹˜ç§¯åº”å°äºnã€‚</span><br><span class="line">2ã€å°†pã€qå½“å‰ç¡®å®šçš„äºŒè¿›åˆ¶ä½åæ–¹å…¨éƒ¨å¡«å……1ï¼Œç›´è‡³å¡«æ»¡512ä½ï¼Œæ­¤æ—¶pã€qä¹˜ç§¯åº”å¤§äºnã€‚</span><br></pre></td></tr></table></figure>
<p>å¦‚æ­¤å°±èƒ½åœ¨æçŸ­æ—¶é—´å†…è¿˜åŸå‡ºpã€qã€‚</p>
<p><br></p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">21645208345867622053024283678631971385301103104312441336174301067402923208233033116071987870811290403578077414872467955871236843078200772311176723821275372545792521252126496488134168455430882670865862282658077115199048181151105823370547063726203692258934054391552916645628374539820099986794258298843501009240</span></span><br><span class="line">n = <span class="number">87282921750815275717132715603847471604654006135344540742956637574882193904171665195367477260090328888053170090015909620539666069545618781812315864580009968838414539707616636379202667918204792277927294032362873240288573251987386601263377458038218959813925307265939433229169884527274177006792047369788293125409</span></span><br><span class="line">mask1 = <span class="number">8802124635072632944677646490123224379036416333544329119490072003355821545476873187055484863111312282268555945525261726909784693138184611507738758202965723</span></span><br><span class="line">mask2 = <span class="number">10267484648659998697412163107809730542736732193409802323765378917769614002176050843098384409535095473863894691160595931186139418791709781214996751031082601</span></span><br><span class="line">h1 = <span class="number">6706231204421711988537353586716977912583550778985616494052350868539347641557164021930575245010900470979740623857738159245103694128834121517146255441177729</span></span><br><span class="line">h2 = <span class="number">6704397956705493482354535847135592349486638396996488745737387153856868045426992197309829534096366784379171117205125136777653995357887539312554042026362473</span></span><br><span class="line">mask1 = <span class="built_in">str</span>(<span class="built_in">bin</span>(mask1)[<span class="number">2</span>:])</span><br><span class="line">mask2 = <span class="built_in">str</span>(<span class="built_in">bin</span>(mask2)[<span class="number">2</span>:])</span><br><span class="line">h1 = <span class="built_in">str</span>(<span class="built_in">bin</span>(h1)[<span class="number">2</span>:])</span><br><span class="line">h2 = <span class="built_in">str</span>(<span class="built_in">bin</span>(h2)[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find</span>(<span class="params">p,q</span>):</span><br><span class="line">    l = <span class="built_in">len</span>(p)</span><br><span class="line">    tmp0 = p + (<span class="number">512</span>-l)*<span class="string">&quot;0&quot;</span></span><br><span class="line">    tmp1 = p + (<span class="number">512</span>-l)*<span class="string">&quot;1&quot;</span></span><br><span class="line">    tmq0 = q + (<span class="number">512</span>-l)*<span class="string">&quot;0&quot;</span></span><br><span class="line">    tmq1 = q + (<span class="number">512</span>-l)*<span class="string">&quot;1&quot;</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">int</span>(tmp0,<span class="number">2</span>)*<span class="built_in">int</span>(tmq0,<span class="number">2</span>) &gt; n):</span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    <span class="keyword">elif</span>(<span class="built_in">int</span>(tmp1,<span class="number">2</span>)*<span class="built_in">int</span>(tmq1,<span class="number">2</span>) &lt; n):</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(l == <span class="number">512</span>):</span><br><span class="line">        <span class="comment">#print(tmp0)</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">int</span>(tmp0,<span class="number">2</span>))</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">int</span>(tmq0,<span class="number">2</span>))</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span>((mask1[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;1&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;1&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span>((mask1[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;1&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;0&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span>((mask1[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;1&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;0&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;0&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span>((mask1[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;0&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;1&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span>((mask1[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;0&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;0&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span>((mask1[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;0&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;0&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;0&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">elif</span>((mask1[l] == <span class="string">&quot;0&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;0&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;1&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span>((mask1[l] == <span class="string">&quot;0&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;0&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;0&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span>((mask1[l] == <span class="string">&quot;0&quot;</span> <span class="keyword">and</span> h1[l] == <span class="string">&quot;0&quot;</span>) <span class="keyword">and</span> (mask2[l] == <span class="string">&quot;0&quot;</span> <span class="keyword">and</span> h2[l] == <span class="string">&quot;0&quot;</span>)):</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line"></span><br><span class="line">tempp = <span class="string">&quot;&quot;</span></span><br><span class="line">tempq = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#find(tempp,tempq)</span></span><br><span class="line">P = <span class="number">10172774442863868719013872884099170294615753094066736187886125116462340120031133533430755779832487215255546434139069419394249074006281284289077492708469893</span></span><br><span class="line">Q = <span class="number">8580050824978592226795441601299432164577158891190171233964440597982925469924083252289609500726234367555160732119333211934059529993446003001925910065317613</span></span><br><span class="line">phi = (P-<span class="number">1</span>)*(Q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{A1g0r1thm_1s_5o_hard_for_Me!}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="BabyLattice"><a href="#BabyLattice" class="headerlink" title="BabyLattice"></a>BabyLattice</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Do you know SVP and LLL?</span><br><span class="line">Hint:åœ¨è§£å†³æœ¬é¢˜çš„è¿‡ç¨‹ä¸­ä½ ä¼šæ¥è§¦åˆ°æ ¼(Lattice)çš„ä¸€äº›åŸºæœ¬æ¦‚å¿µ,ä»¥åŠLLLç®—æ³•ã€‚</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">32</span></span><br><span class="line">flagArg = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">32</span>,<span class="number">8</span>):</span><br><span class="line">    flag_tmp = bytes_to_long(flag[i:i+<span class="number">8</span>])</span><br><span class="line">    <span class="keyword">assert</span> flag_tmp &lt; <span class="number">2</span>**<span class="number">64</span></span><br><span class="line">    flagArg.append(flag_tmp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Equation</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,arg</span>):</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(arg)==<span class="number">4</span></span><br><span class="line">        self.arg = arg</span><br><span class="line">        self.modulus = getRandomInteger(<span class="number">512</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">output</span>(<span class="params">self</span>):</span><br><span class="line">        ans = <span class="number">0</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;the modulus is <span class="subst">&#123;self.modulus&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            tmp = getRandomInteger(<span class="number">512</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;The number of the <span class="subst">&#123;i&#125;</span> round is <span class="subst">&#123;tmp&#125;</span>&#x27;</span>)</span><br><span class="line">            ans+=self.arg[i]*tmp</span><br><span class="line">        ans = ans%self.modulus</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;The result is <span class="subst">&#123;ans&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">EzLineModulus = Equation(flagArg)</span><br><span class="line">EzLineModulus.output()</span><br><span class="line"></span><br><span class="line"><span class="comment">#the modulus is 4653980939589101565044285021945025573290906789132633751963110127801187748089540230208429714310516635848025358481189017398970169440484136391436220837417791</span></span><br><span class="line"><span class="comment">#The number of the 0 round is 7163515288721018524391838724005494502072524058809935946689587023614778895762400663698973734684519790842142248155478226513293289043832391054661263177469005</span></span><br><span class="line"><span class="comment">#The number of the 1 round is 13155134533945105613277690072743652931283618211062662861216511364398097684219572559463369279253337759860439150691008846033587645344197431244106331100681641</span></span><br><span class="line"><span class="comment">#The number of the 2 round is 8450640520436960190933104494093081291057363628588171820766164606066614201483259024304043681871965360847257453187101669512010469318096007617859083021766564</span></span><br><span class="line"><span class="comment">#The number of the 3 round is 798383352075970107818638521362593273862636131165588181505120596765884650403289567593307005746576184176902675297124272602141002375036927828390204063589274</span></span><br><span class="line"><span class="comment">#The result is 58831711102590059067743519228568722360433408071362335858674496753241059990433991177195518029785828762522018556332340356592798263267784406825183284767956</span></span><br></pre></td></tr></table></figure>
<p>æ‹›æ–°èµ›å‰çš„å¤ä»¤è¥å°±å‡ºLatticeçš„é¢˜ç›®äº†ã€‚ã€‚ç¡®å®ç‹ </p>
<p>ä¸è¿‡ç¡®å®æ˜¯æœ€åŸºç¡€çš„Latticeé¢˜ç›®äº†ï¼Œå¤§è‡´æ€è·¯å°±æ˜¯åˆ—å‡ºçº¿æ€§å…³ç³»å¼ï¼Œè½¬åŒ–ä¸ºçŸ©é˜µå½¢å¼ï¼Œå¹¶ä¿è¯è¾ƒçŸ­å‘é‡éƒ½åœ¨ç­‰å¼å³ä¾§ï¼Œå³å¯å¯¹æ„é€ å‡ºæ¥çš„æ ¼è¿›è¡Œè§„çº¦å¾—åˆ°çŸ­å‘é‡ã€‚</p>
<p><br></p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">4653980939589101565044285021945025573290906789132633751963110127801187748089540230208429714310516635848025358481189017398970169440484136391436220837417791</span></span><br><span class="line">a1 = <span class="number">7163515288721018524391838724005494502072524058809935946689587023614778895762400663698973734684519790842142248155478226513293289043832391054661263177469005</span></span><br><span class="line">a2 = <span class="number">13155134533945105613277690072743652931283618211062662861216511364398097684219572559463369279253337759860439150691008846033587645344197431244106331100681641</span></span><br><span class="line">a3 = <span class="number">8450640520436960190933104494093081291057363628588171820766164606066614201483259024304043681871965360847257453187101669512010469318096007617859083021766564</span></span><br><span class="line">a4 = <span class="number">798383352075970107818638521362593273862636131165588181505120596765884650403289567593307005746576184176902675297124272602141002375036927828390204063589274</span></span><br><span class="line">ans = <span class="number">58831711102590059067743519228568722360433408071362335858674496753241059990433991177195518029785828762522018556332340356592798263267784406825183284767956</span></span><br><span class="line">inv = inverse(a1,n)</span><br><span class="line">L = Matrix(ZZ, [[<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,-ans*inv],</span><br><span class="line">                [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>,a2*inv],</span><br><span class="line">                [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>,a3*inv],</span><br><span class="line">                [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>,a4*inv],</span><br><span class="line">                [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,n]])</span><br><span class="line"></span><br><span class="line">v = L.LLL()[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(long_to_bytes(<span class="built_in">abs</span>(v[<span class="number">4</span>])))[<span class="number">2</span>:-<span class="number">1</span>],end = <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(v)-<span class="number">1</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(long_to_bytes(<span class="built_in">abs</span>(v[i])))[<span class="number">2</span>:-<span class="number">1</span>],end = <span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{W0w!Y0u_know_WhatisL4ttice}</font>

<p>ï¼ˆæœ‰å…³æ ¼çš„é—®é¢˜æœ¬ç¯‡ä¸ä¼šå±•å¼€è®²ï¼Œå› ä¸ºå®ƒéœ€è¦å¯¹ä¸€äº›åŸºæœ¬åŸç†çš„äº†è§£ï¼Œæƒ³è¦æ˜ç™½æ­¤ç±»é—®é¢˜éœ€è¦å…ˆè‡ªè¡ŒæŸ¥é˜…ä¸€äº›æ ¼ç›¸å…³çš„åŸºæœ¬æ¦‚å¿µï¼‰</p>
<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="ezSignature"><a href="#ezSignature" class="headerlink" title="ezSignature"></a>ezSignature</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¿™æ ·ä½¿ç”¨æ•°å­—ç­¾åæ˜¯å¦å®‰å…¨å‘¢ï¼Ÿ</span><br><span class="line">nc 43.156.14.141 6943</span><br><span class="line"></span><br><span class="line">Hint1:æ¨èä½¿ç”¨pwntoolsè¿›è¡Œäº¤äº’ã€‚</span><br><span class="line">Hint2:å»ºè®®å…ˆäº†è§£ DSA æ•°å­—ç­¾åæµç¨‹ã€‚</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> DSA</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters + string.digits</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DigitalSignatureAlgorithm</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, key</span>):</span><br><span class="line">        self.p = key.p</span><br><span class="line">        self.q = key.q</span><br><span class="line">        self.g = key.g</span><br><span class="line">        self.y = key.y</span><br><span class="line">        self.x = key.x</span><br><span class="line">        self.k = randint(<span class="number">1</span>, self.q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">self, m</span>):</span><br><span class="line">        k = self.k</span><br><span class="line">        h = bytes_to_long(sha256(m).digest())</span><br><span class="line">        r = <span class="built_in">pow</span>(self.g, k, self.p) % self.q</span><br><span class="line">        s = inverse(k, self.q) * (h + self.x * r) % self.q</span><br><span class="line">        <span class="keyword">return</span> r, s</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">self, m, signature</span>):</span><br><span class="line">        r, s = signature</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">not</span> (<span class="number">1</span> &lt;= r &lt;= self.q - <span class="number">1</span>)) <span class="keyword">or</span> (<span class="keyword">not</span> (<span class="number">1</span> &lt;= s &lt;= self.q - <span class="number">1</span>)):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        z = bytes_to_long(sha256(m).digest())</span><br><span class="line">        w = inverse(s, self.q)</span><br><span class="line">        u1 = (z * w) % self.q</span><br><span class="line">        u2 = (r * w) % self.q</span><br><span class="line">        v = (<span class="built_in">pow</span>(self.g, u1, self.p) * <span class="built_in">pow</span>(self.y, u2, self.p)) % self.p % self.q</span><br><span class="line">        <span class="keyword">return</span> r == v</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">myDSA = DigitalSignatureAlgorithm(DSA.generate(<span class="number">1024</span>))</span><br><span class="line">MENU = <span class="string">br&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[1] Sign.</span></span><br><span class="line"><span class="string">[2] Verify.</span></span><br><span class="line"><span class="string">[3] Get_public_key.</span></span><br><span class="line"><span class="string">[4] Exit.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Task</span>(socketserver.BaseRequestHandler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_recvall</span>(<span class="params">self</span>):</span><br><span class="line">        BUFF_SIZE = <span class="number">2048</span></span><br><span class="line">        data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            part = self.request.recv(BUFF_SIZE)</span><br><span class="line">            data += part</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(part) &lt; BUFF_SIZE:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> data.strip()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">send</span>(<span class="params">self, msg, newline=<span class="literal">True</span></span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> newline:</span><br><span class="line">                msg += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line">            self.request.sendall(msg)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">recv</span>(<span class="params">self, prompt=<span class="string">b&#x27;[-] &#x27;</span></span>):</span><br><span class="line">        self.send(prompt, newline=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> self._recvall()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">proof_of_work</span>(<span class="params">self</span>):</span><br><span class="line">        proof = (<span class="string">&#x27;&#x27;</span>.join([choice(table) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>)])).encode()</span><br><span class="line">        sha = sha256(proof).hexdigest().encode()</span><br><span class="line">        self.send(<span class="string">b&quot;[+] sha256(XXXX+&quot;</span> + proof[<span class="number">4</span>:] + <span class="string">b&quot;) == &quot;</span> + sha)</span><br><span class="line">        XXXX = self.recv(prompt=<span class="string">b&#x27;[+] Plz Tell Me XXXX :&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(XXXX) != <span class="number">4</span> <span class="keyword">or</span> sha256(XXXX + proof[<span class="number">4</span>:]).hexdigest().encode() != sha:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">self</span>):</span><br><span class="line">        m1 = <span class="string">b&#x27;I want to tell you a secret&#x27;</span></span><br><span class="line">        m2 = <span class="string">b&#x27;Can you find it?&#x27;</span></span><br><span class="line">        signature1 = myDSA.sign(m1)</span><br><span class="line">        signature2 = myDSA.sign(m2)</span><br><span class="line">        self.send(<span class="string">b&#x27;Your signature1 is:&#x27;</span> + <span class="built_in">str</span>(signature1).encode())</span><br><span class="line">        self.send(<span class="string">b&#x27;Your signature2 is:&#x27;</span> + <span class="built_in">str</span>(signature2).encode())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">self</span>):</span><br><span class="line">        m = self.recv(<span class="string">b&#x27;message:&#x27;</span>)</span><br><span class="line">        r = <span class="built_in">int</span>(self.recv(<span class="string">b&#x27;r:&#x27;</span>))</span><br><span class="line">        s = <span class="built_in">int</span>(self.recv(<span class="string">b&#x27;s:&#x27;</span>))</span><br><span class="line">        signature = (r, s)</span><br><span class="line">        <span class="keyword">if</span> m == <span class="string">b&quot;I&#x27;m Admin.I want flag.&quot;</span>:</span><br><span class="line">            <span class="keyword">if</span> myDSA.verify(m, signature):</span><br><span class="line">                self.send(<span class="string">b&#x27;Hello there.This is what you want.&#x27;</span>)</span><br><span class="line">                self.send(flag)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.send(<span class="string">b&#x27;Who are U?Get out!&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.send(<span class="string">b&#x27;Who are U?Get out!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_public_key</span>(<span class="params">self</span>):</span><br><span class="line">        self.send(<span class="string">b&#x27;p = &#x27;</span> + <span class="built_in">str</span>(myDSA.p).encode())</span><br><span class="line">        self.send(<span class="string">b&#x27;q = &#x27;</span> + <span class="built_in">str</span>(myDSA.q).encode())</span><br><span class="line">        self.send(<span class="string">b&#x27;g = &#x27;</span> + <span class="built_in">str</span>(myDSA.g).encode())</span><br><span class="line">        self.send(<span class="string">b&#x27;y = &#x27;</span> + <span class="built_in">str</span>(myDSA.y).encode())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self</span>):</span><br><span class="line">        signal.alarm(<span class="number">30</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.proof_of_work():</span><br><span class="line">            self.send(<span class="string">b&#x27;You must pass the P0W!!!&#x27;</span>)</span><br><span class="line">            self.request.close()</span><br><span class="line">        <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">            self.send(MENU)</span><br><span class="line">            option = <span class="built_in">int</span>(self.recv(prompt=<span class="string">b&#x27;Give me your option:&#x27;</span>))</span><br><span class="line">            <span class="keyword">if</span> option == <span class="number">1</span>:</span><br><span class="line">                self.sign()</span><br><span class="line">            <span class="keyword">elif</span> option == <span class="number">2</span>:</span><br><span class="line">                self.verify()</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">elif</span> option == <span class="number">3</span>:</span><br><span class="line">                self.get_public_key()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        self.request.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST, PORT = <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">10001</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;HOST:POST &quot;</span> + HOST + <span class="string">&quot;:&quot;</span> + <span class="built_in">str</span>(PORT))</span><br><span class="line">    server = ThreadedServer((HOST, PORT), Task)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure>
<p>ä¸€é“é¶æœºäº¤äº’é¢˜ï¼Œä»£ç è¾ƒé•¿ï¼Œä½†æ˜¯å…¶å®å¤§éƒ¨åˆ†æ˜¯äº¤äº’ç›¸å…³çš„å‡½æ•°ï¼Œç»†è¯»å‘ç°æ˜¯å¾ˆæ­£å¸¸çš„DSAï¼Œéœ€è¦ç”¨ç»™å®šæ˜æ–‡é€šè¿‡ä»–çš„éªŒç­¾æ“ä½œã€‚ï¼ˆå¦‚æœä¸ç†Ÿæ‚‰DSAç­¾åæµç¨‹ï¼Œä¸€å®šè¦è‡ªè¡ŒæŸ¥é˜…äº†è§£ä¸€ä¸‹ï¼‰</p>
<p>æ£€æŸ¥ä»£ç å‘ç°æ¼æ´å‡ºåœ¨signï¼Œç”±äºäº¤äº’å¼€å§‹æ—¶ï¼Œéšæœºå¯†é’¥kå°±ä¸ä¼šå†å˜åŠ¨ï¼Œå› æ­¤ä¸¤ä¸ªæ˜æ–‡å…±ç”¨äº†kç”¨ä½œç­¾åï¼Œå› æ­¤ç›´æ¥ä½¿ç”¨å…±äº«kæ”»å‡»å³å¯ï¼Œå…·ä½“åŸç†ä¹Ÿå¾ˆç®€å•ï¼Œè‡ªè¡Œæœç´¢å…±äº«kæ”»å‡»å³å¯ã€‚è¿›é˜¶çš„è¿˜æœ‰å¯¹çº¿æ€§kã€æŒ‡æ•°kç­‰ç›¸å…³æ”»å‡»æ–¹å¼ã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line">p = <span class="number">172961942888113119438093761564402163853274437530074061334853565231663662473345365517029153614577994838261528197758562341350007269014020447862968046418219322983982857376325091297503076457294884011022491521807290579653731078712552375942815577480924479760060089879761373677236785972440188569442167867715538948131</span></span><br><span class="line">q = <span class="number">1238294525750070611176801188652181858159488474961</span></span><br><span class="line">g = <span class="number">75657702601417227921344829575623735976532473731371029415534443940309702116075857552168402559956825576158353466597825895213717785384352099702983338787137184850387592826820271959589796127014544636714131043162304391677607332131259874984936943058742638800688694139378157588974460944304847089533750902878536046649</span></span><br><span class="line">y = <span class="number">7749296960818920297640684628219596188301310658741359444363507697372166821952159177715756651776536866582220227892407461198512231438360662343916445812054004711764127526569139925464723782772657462476688091598602960531766048824996984183046388253897618420503521674510979988799110962834514762035965219607971731464</span></span><br><span class="line"></span><br><span class="line">r1,s1 = (<span class="number">952312130113235199710494038379463278196320139331</span>, <span class="number">246708316787437486170638565016913560785356026546</span>)</span><br><span class="line">r2,s2 = (<span class="number">952312130113235199710494038379463278196320139331</span>, <span class="number">604408984593559575502554675534691666132540008638</span>)</span><br><span class="line"></span><br><span class="line">m1 = <span class="string">b&#x27;I want to tell you a secret&#x27;</span></span><br><span class="line">m2 = <span class="string">b&#x27;Can you find it?&#x27;</span></span><br><span class="line">h1 = bytes_to_long(sha256(m1).digest())</span><br><span class="line">h2 = bytes_to_long(sha256(m2).digest())</span><br><span class="line"></span><br><span class="line">k = (h1-h2)*inverse(s1-s2,q)</span><br><span class="line">x = (k*s1 - h1)*inverse(r1,q) % q</span><br><span class="line"></span><br><span class="line">m = <span class="string">b&quot;I&#x27;m Admin.I want flag.&quot;</span></span><br><span class="line">h = bytes_to_long(sha256(m).digest())</span><br><span class="line">r = <span class="built_in">pow</span>(g, k, p) % q</span><br><span class="line">s = inverse(k, q) * (h + x * r) % q</span><br><span class="line"><span class="built_in">print</span>(r)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br></pre></td></tr></table></figure>
<p>(è¿™é¢˜æ²¡æœ‰å®Œæ•´è„šæœ¬ï¼Œæ‹¿ç€è¿™ä¸ªrï¼Œså»äº¤äº’å°±å¯ä»¥äº†ï¼›å› ä¸ºæ¯”è¾ƒæ‡’ï¼Œå½“æ—¶ç›´æ¥ç”¨xshellè¿æ¥ä¸Šåæ‰‹åŠ¨è¿‡çš„sha256çˆ†ç ´ï¼Œæ‰‹åŠ¨æäº¤çš„rï¼Œsã€‚ã€‚æ‰€ä»¥å°±æ²¡æœ‰å®Œæ•´pwntoolsäº¤äº’è„šæœ¬)</p>
<p>flag:</p>
<font size="4" color="red">cnss{1ts_Dr4nger0us_t0_u5eThe_Same_K}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="StrangeCurve"><a href="#StrangeCurve" class="headerlink" title="StrangeCurve"></a>StrangeCurve</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">The Cruve is SOO0000 Strange!</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">rom Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">5</span>]==<span class="string">&#x27;cnss&#123;&#x27;</span> <span class="keyword">and</span> flag[-<span class="number">1</span>] == <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">flag_k = bytes_to_long(flag[<span class="number">5</span>:-<span class="number">1</span>].encode())</span><br><span class="line"></span><br><span class="line">p = <span class="number">1096126227998177188652856107362412783873814431647</span></span><br><span class="line">a = <span class="number">0</span></span><br><span class="line">b = <span class="number">5</span></span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> E.order() == p </span><br><span class="line">base_point = E(<span class="number">626099523290649705896889901241128842906228328604</span>,<span class="number">886038875771695334071307095455656761758842526929</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> base_point <span class="keyword">in</span> E</span><br><span class="line"><span class="keyword">assert</span> flag_k &lt; p </span><br><span class="line"></span><br><span class="line">Q = flag_k*base_point</span><br><span class="line"><span class="built_in">print</span>(Q)</span><br><span class="line"></span><br><span class="line"><span class="comment"># (240653647745552223089451307742208085297121769374 : 1041806436100548540817642210994295951394712587396 : 1)</span></span><br></pre></td></tr></table></figure>
<p>æ¤­åœ†æ›²çº¿åŠ å¯†ï¼Œä¸‹é¢è¿™è¡Œæ˜¯é‡è¦ä¿¡æ¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">assert</span> E.order() == p </span><br></pre></td></tr></table></figure>
<p>å› æ­¤å¯ä»¥ç¡®å®šæ˜¯Smartâ€™s attackã€‚</p>
<p><br></p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SmartAttack</span>(<span class="params">P,Q,p</span>):</span><br><span class="line">    E = P.curve()</span><br><span class="line">    Eqp = EllipticCurve(Qp(p, <span class="number">2</span>), [ ZZ(t) + randint(<span class="number">0</span>,p)*p <span class="keyword">for</span> t <span class="keyword">in</span> E.a_invariants() ])</span><br><span class="line"></span><br><span class="line">    P_Qps = Eqp.lift_x(ZZ(P.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> P_Qp <span class="keyword">in</span> P_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(P_Qp.xy()[<span class="number">1</span>]) == P.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    Q_Qps = Eqp.lift_x(ZZ(Q.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> Q_Qp <span class="keyword">in</span> Q_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(Q_Qp.xy()[<span class="number">1</span>]) == Q.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    p_times_P = p*P_Qp</span><br><span class="line">    p_times_Q = p*Q_Qp</span><br><span class="line"></span><br><span class="line">    x_P,y_P = p_times_P.xy()</span><br><span class="line">    x_Q,y_Q = p_times_Q.xy()</span><br><span class="line"></span><br><span class="line">    phi_P = -(x_P/y_P)</span><br><span class="line">    phi_Q = -(x_Q/y_Q)</span><br><span class="line">    k = phi_Q/phi_P</span><br><span class="line">    <span class="keyword">return</span> ZZ(k)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = <span class="number">1096126227998177188652856107362412783873814431647</span></span><br><span class="line">a = <span class="number">0</span></span><br><span class="line">b = <span class="number">5</span></span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line"></span><br><span class="line">P = E(<span class="number">626099523290649705896889901241128842906228328604</span>,<span class="number">886038875771695334071307095455656761758842526929</span>)</span><br><span class="line">Q = E(<span class="number">240653647745552223089451307742208085297121769374</span>,<span class="number">1041806436100548540817642210994295951394712587396</span>)</span><br><span class="line"></span><br><span class="line">n = SmartAttack(P, Q, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;cnss&#123;&quot;</span> + <span class="built_in">str</span>(long_to_bytes(n))[<span class="number">2</span>:-<span class="number">1</span>] + <span class="string">&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<font size="4" color="red">cnss{DLPise45y_if5pecia1}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="ä¸€ğŸ”ªä¸€ä¸ªç‰›å¤´äºº"><a href="#ä¸€ğŸ”ªä¸€ä¸ªç‰›å¤´äºº" class="headerlink" title="ä¸€ğŸ”ªä¸€ä¸ªç‰›å¤´äºº"></a>ä¸€ğŸ”ªä¸€ä¸ªç‰›å¤´äºº</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å­¦äº†NTRU,å°±è¦NTR u(âŒ)</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> shuffle, getrandbits</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">Zx = PolynomialRing(ZZ, <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">x = Zx.gen()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convolution</span>(<span class="params">f, g, R</span>):</span><br><span class="line">    <span class="keyword">return</span> (f * g) % R</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">balancedmod</span>(<span class="params">f, q, R</span>):</span><br><span class="line">    g = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x: ((x + q//<span class="number">2</span>) % q) - q//<span class="number">2</span>, f.<span class="built_in">list</span>()))</span><br><span class="line">    <span class="keyword">return</span> Zx(g) % R</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">random_poly</span>(<span class="params">n, d1, d2</span>):</span><br><span class="line">    <span class="keyword">assert</span> d1 + d2 &lt;= n</span><br><span class="line">    result = d1 * [<span class="number">1</span>] + d2 * [-<span class="number">1</span>] + (n - d1 - d2) * [<span class="number">0</span>]</span><br><span class="line">    shuffle(result)</span><br><span class="line">    <span class="keyword">return</span> Zx(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_poly_mod_prime</span>(<span class="params">f, R, p</span>):</span><br><span class="line">    T = Zx.change_ring(Integers(p)).quotient(R)</span><br><span class="line">    <span class="keyword">return</span> Zx(lift(<span class="number">1</span> / T(f)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_poly_mod_powerof2</span>(<span class="params">f, R, q</span>):  <span class="comment"># Hensel Lemma </span></span><br><span class="line">    g = invert_poly_mod_prime(f, R, <span class="number">2</span>)</span><br><span class="line">    e = log(q, <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e):</span><br><span class="line">        g = ((<span class="number">2</span> * g - f * g ** <span class="number">2</span>) % R) % q</span><br><span class="line">    <span class="keyword">return</span> g</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NTRUCipher</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, N, p, q, d</span>):</span><br><span class="line">        self.N = N</span><br><span class="line">        self.p = p</span><br><span class="line">        self.q = q</span><br><span class="line">        self.d = d</span><br><span class="line">        self.R = x ** N - <span class="number">1</span></span><br><span class="line">        <span class="comment"># key generation</span></span><br><span class="line">        self.g = random_poly(self.N, d, d)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                self.f = random_poly(self.N, d + <span class="number">1</span>, d)</span><br><span class="line">                self.fp = invert_poly_mod_prime(self.f, self.R, self.p)</span><br><span class="line">                self.fq = invert_poly_mod_powerof2(self.f, self.R, self.q)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        self.h = balancedmod(self.p * convolution(self.fq, self.g, self.R), self.q, self.R)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getPubKey</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.h</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, m</span>):</span><br><span class="line">        r = random_poly(self.N, self.d, self.d)</span><br><span class="line">        <span class="keyword">return</span> balancedmod(convolution(self.h, r, self.R) + m, self.q, self.R)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, c</span>):</span><br><span class="line">        a = balancedmod(convolution(c, self.f, self.R), self.q, self.R)</span><br><span class="line">        <span class="keyword">return</span> balancedmod(convolution(a, self.fp, self.R), self.p, self.R)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">self, val</span>):</span><br><span class="line">        poly = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.N):</span><br><span class="line">            poly += ((val % self.p) - self.p // <span class="number">2</span>) * (x ** i)</span><br><span class="line">            val //= self.p</span><br><span class="line">        <span class="keyword">return</span> poly</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">self, poly</span>):</span><br><span class="line">        result = <span class="number">0</span></span><br><span class="line">        ll = poly.<span class="built_in">list</span>()</span><br><span class="line">        <span class="keyword">for</span> idx, val <span class="keyword">in</span> <span class="built_in">enumerate</span>(ll):</span><br><span class="line">            result += (val + self.p // <span class="number">2</span>) * (self.p ** idx)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">poly_from_list</span>(<span class="params">self, l: <span class="built_in">list</span></span>):</span><br><span class="line">        <span class="keyword">return</span> Zx(l)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    N = <span class="number">160</span></span><br><span class="line">    d = <span class="number">30</span></span><br><span class="line">    p = <span class="number">3</span></span><br><span class="line">    q = <span class="number">65536</span></span><br><span class="line"></span><br><span class="line">    cipher = NTRUCipher(N, p, q, d) </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[PubKey]---------&quot;</span>)</span><br><span class="line">    h = cipher.getPubKey()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;h = <span class="subst">&#123;h&#125;</span>&#x27;</span>)</span><br><span class="line">    msg = bytes_to_long(flag)</span><br><span class="line">    encode_msg = cipher.encode(msg)</span><br><span class="line">    c = cipher.encrypt(encode_msg)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[Cipher]---------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line">    mm = cipher.decrypt(c)</span><br><span class="line">    decode_msg = cipher.decode(mm)</span><br><span class="line">    <span class="keyword">assert</span> decode_msg == msg</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[PubKey]---------</span></span><br><span class="line"><span class="string">h = -11891*x^159 + 16347*x^158 - 32137*x^157 + 14988*x^156 + 16657*x^155 - 25785*x^154 - 21976*x^153 - 31745*x^152 - 4232*x^151 + 29569*x^150 + 27140*x^149 + 19617*x^148 - 16656*x^147 + 8925*x^146 + 8728*x^145 - 8802*x^144 - 10794*x^143 - 28159*x^142 - 6454*x^141 - 10259*x^140 - 19169*x^139 - 14357*x^138 + 3501*x^137 + 9885*x^136 - 7441*x^135 + 18268*x^134 - 27183*x^133 + 26085*x^132 + 19147*x^131 + 17153*x^130 - 22887*x^129 + 32476*x^128 - 21698*x^127 + 19138*x^126 + 11585*x^125 + 22755*x^124 - 5920*x^123 + 7581*x^122 + 25973*x^121 + 13787*x^120 - 22762*x^119 + 29207*x^118 - 17916*x^117 - 11502*x^116 + 18275*x^115 + 318*x^114 - 6890*x^113 - 22751*x^112 - 27677*x^111 - 11114*x^110 + 8623*x^109 - 15725*x^108 - 6835*x^107 - 8288*x^106 - 5235*x^105 - 28697*x^104 + 10696*x^103 + 17117*x^102 + 24696*x^101 - 7801*x^100 - 31874*x^99 - 17668*x^98 - 11204*x^97 + 19147*x^96 + 24644*x^95 - 29380*x^94 - 26237*x^93 - 27390*x^92 + 19982*x^91 + 4074*x^90 - 17248*x^89 - 11027*x^88 - 32690*x^87 + 5124*x^86 - 20823*x^85 - 11779*x^84 + 13781*x^83 + 29356*x^82 - 9740*x^81 - 31484*x^80 - 540*x^79 + 32360*x^78 + 24795*x^77 - 8864*x^76 + 17363*x^75 + 9670*x^74 + 32268*x^73 + 17961*x^72 + 6388*x^71 + 580*x^70 + 128*x^69 + 339*x^68 + 3412*x^67 - 4519*x^66 - 25056*x^65 + 6096*x^64 + 18720*x^63 - 5338*x^62 + 16910*x^61 + 3353*x^60 + 15433*x^59 - 28053*x^58 - 18883*x^57 + 7688*x^56 - 31198*x^55 + 9950*x^54 - 9388*x^53 + 21235*x^52 + 2847*x^51 + 24383*x^50 + 19431*x^49 + 21244*x^48 - 8498*x^47 - 28998*x^46 + 962*x^45 + 20579*x^44 + 28002*x^43 - 6040*x^42 + 4241*x^41 + 11655*x^40 - 32419*x^39 + 21531*x^38 + 7348*x^37 - 5503*x^36 + 29820*x^35 + 28896*x^34 + 8754*x^33 + 17978*x^32 + 7552*x^31 + 27240*x^30 - 29515*x^29 - 20322*x^28 + 2201*x^27 + 8857*x^26 - 50*x^25 - 3780*x^24 - 12138*x^23 + 10893*x^22 + 23133*x^21 + 6142*x^20 - 23798*x^19 - 15236*x^18 + 32564*x^17 + 25683*x^16 - 24010*x^15 - 4355*x^14 + 22552*x^13 - 27155*x^12 + 27649*x^11 + 17781*x^10 + 7115*x^9 + 27465*x^8 - 4369*x^7 + 24882*x^6 - 11675*x^5 - 612*x^4 + 12361*x^3 + 20120*x^2 + 6190*x - 10843</span></span><br><span class="line"><span class="string">[Cipher]---------</span></span><br><span class="line"><span class="string">c = -26801*x^159 - 25103*x^158 + 29811*x^157 - 12251*x^156 - 13386*x^155 - 28030*x^154 - 16511*x^153 + 23761*x^152 + 28329*x^151 - 16406*x^150 + 30931*x^149 + 5326*x^148 + 19877*x^147 - 23165*x^146 - 31540*x^145 - 7923*x^144 + 5880*x^143 - 27078*x^142 - 25436*x^141 - 17162*x^140 + 1471*x^139 + 14486*x^138 + 7702*x^137 - 29890*x^136 + 29315*x^135 + 558*x^134 - 22429*x^133 - 361*x^132 + 19049*x^131 - 30437*x^130 - 32610*x^129 - 3024*x^128 - 4313*x^127 + 29174*x^126 - 2837*x^125 - 2812*x^124 + 13450*x^123 - 15001*x^122 - 25791*x^121 - 8702*x^120 - 4968*x^119 - 15340*x^118 + 31744*x^117 - 32478*x^116 + 19737*x^115 - 12629*x^114 - 27847*x^113 + 27322*x^112 - 31375*x^111 + 14777*x^110 + 29825*x^109 - 25883*x^108 - 13335*x^107 + 32517*x^106 + 14871*x^105 - 7287*x^104 + 13398*x^103 - 32710*x^102 + 20805*x^101 + 29734*x^100 - 14579*x^99 + 17483*x^98 - 16864*x^97 - 26745*x^96 + 3254*x^95 + 7280*x^94 - 29046*x^93 - 7531*x^92 - 8791*x^91 + 15033*x^90 - 1125*x^89 - 14713*x^88 - 12273*x^87 + 8616*x^86 + 2486*x^85 + 31810*x^84 + 27795*x^83 - 21731*x^82 + 21743*x^81 - 27595*x^80 - 3592*x^79 - 27206*x^78 - 32156*x^77 + 32124*x^76 - 11212*x^75 - 6662*x^74 - 23103*x^73 - 3660*x^72 - 31043*x^71 - 17131*x^70 + 24544*x^69 - 32326*x^68 - 31047*x^67 + 19814*x^66 + 10874*x^65 - 8449*x^64 + 11744*x^63 + 2245*x^62 - 967*x^61 + 9120*x^60 + 8983*x^59 - 24573*x^58 + 24885*x^57 + 15649*x^56 - 18970*x^55 + 7354*x^54 - 12282*x^53 - 22474*x^52 + 4395*x^51 + 8428*x^50 - 32592*x^49 + 25980*x^48 - 4599*x^47 + 16310*x^46 + 18559*x^45 + 22897*x^44 + 19080*x^43 - 26065*x^42 - 9*x^41 + 29202*x^40 + 2121*x^39 - 5004*x^38 + 5299*x^37 - 28301*x^36 - 13519*x^35 + 24241*x^34 + 529*x^33 - 20574*x^32 - 27391*x^31 + 31976*x^30 + 22824*x^29 - 31410*x^28 - 20976*x^27 + 21661*x^26 - 15132*x^25 + 1905*x^24 - 30870*x^23 + 18109*x^22 - 17373*x^21 + 5342*x^20 - 22447*x^19 + 1893*x^18 - 17545*x^17 + 30097*x^16 - 21731*x^15 + 17390*x^14 + 10991*x^13 - 5384*x^12 + 15960*x^11 + 24268*x^10 - 29867*x^9 + 22532*x^8 + 10133*x^7 - 26576*x^6 - 5742*x^5 - 16252*x^4 + 13019*x^3 - 25984*x^2 + 14004*x + 22500</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>ä¸€ä¸ªæ™®é€šçš„NTRUå¤šé¡¹å¼å¯†ç ï¼Œä¹Ÿæ˜¯ä¸æ ¼æœ‰å…³çš„ï¼Œå…¶å…·ä½“åŸç†å¯ä»¥å‚è€ƒï¼š(ç”šè‡³è¯¦ç»†é˜è¿°äº†æ¯ä¸ªå‡½æ•°çš„ä½œç”¨)</p>
<p><a href="http://blog.k1rit0.eu.org/2021/03/28/Translation-of-LatticeHacks/">Translation of LatticeHacks Â· K1rit0â€™s Blog</a> </p>
<p><br></p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">160</span></span><br><span class="line">d = <span class="number">30</span></span><br><span class="line">p = <span class="number">3</span></span><br><span class="line">q = <span class="number">65536</span></span><br><span class="line">PR = PolynomialRing(ZZ, name = <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">x = PR.gen()</span><br><span class="line">R = PR.quotient_ring(x ^ n - <span class="number">1</span>, names = <span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">y = R.gen()</span><br><span class="line"></span><br><span class="line">pubkey = -<span class="number">11891</span>*x^<span class="number">159</span> + <span class="number">16347</span>*x^<span class="number">158</span> - <span class="number">32137</span>*x^<span class="number">157</span> + <span class="number">14988</span>*x^<span class="number">156</span> + <span class="number">16657</span>*x^<span class="number">155</span> - <span class="number">25785</span>*x^<span class="number">154</span> - <span class="number">21976</span>*x^<span class="number">153</span> - <span class="number">31745</span>*x^<span class="number">152</span> - <span class="number">4232</span>*x^<span class="number">151</span> + <span class="number">29569</span>*x^<span class="number">150</span> + <span class="number">27140</span>*x^<span class="number">149</span> + <span class="number">19617</span>*x^<span class="number">148</span> - <span class="number">16656</span>*x^<span class="number">147</span> + <span class="number">8925</span>*x^<span class="number">146</span> + <span class="number">8728</span>*x^<span class="number">145</span> - <span class="number">8802</span>*x^<span class="number">144</span> - <span class="number">10794</span>*x^<span class="number">143</span> - <span class="number">28159</span>*x^<span class="number">142</span> - <span class="number">6454</span>*x^<span class="number">141</span> - <span class="number">10259</span>*x^<span class="number">140</span> - <span class="number">19169</span>*x^<span class="number">139</span> - <span class="number">14357</span>*x^<span class="number">138</span> + <span class="number">3501</span>*x^<span class="number">137</span> + <span class="number">9885</span>*x^<span class="number">136</span> - <span class="number">7441</span>*x^<span class="number">135</span> + <span class="number">18268</span>*x^<span class="number">134</span> - <span class="number">27183</span>*x^<span class="number">133</span> + <span class="number">26085</span>*x^<span class="number">132</span> + <span class="number">19147</span>*x^<span class="number">131</span> + <span class="number">17153</span>*x^<span class="number">130</span> - <span class="number">22887</span>*x^<span class="number">129</span> + <span class="number">32476</span>*x^<span class="number">128</span> - <span class="number">21698</span>*x^<span class="number">127</span> + <span class="number">19138</span>*x^<span class="number">126</span> + <span class="number">11585</span>*x^<span class="number">125</span> + <span class="number">22755</span>*x^<span class="number">124</span> - <span class="number">5920</span>*x^<span class="number">123</span> + <span class="number">7581</span>*x^<span class="number">122</span> + <span class="number">25973</span>*x^<span class="number">121</span> + <span class="number">13787</span>*x^<span class="number">120</span> - <span class="number">22762</span>*x^<span class="number">119</span> + <span class="number">29207</span>*x^<span class="number">118</span> - <span class="number">17916</span>*x^<span class="number">117</span> - <span class="number">11502</span>*x^<span class="number">116</span> + <span class="number">18275</span>*x^<span class="number">115</span> + <span class="number">318</span>*x^<span class="number">114</span> - <span class="number">6890</span>*x^<span class="number">113</span> - <span class="number">22751</span>*x^<span class="number">112</span> - <span class="number">27677</span>*x^<span class="number">111</span> - <span class="number">11114</span>*x^<span class="number">110</span> + <span class="number">8623</span>*x^<span class="number">109</span> - <span class="number">15725</span>*x^<span class="number">108</span> - <span class="number">6835</span>*x^<span class="number">107</span> - <span class="number">8288</span>*x^<span class="number">106</span> - <span class="number">5235</span>*x^<span class="number">105</span> - <span class="number">28697</span>*x^<span class="number">104</span> + <span class="number">10696</span>*x^<span class="number">103</span> + <span class="number">17117</span>*x^<span class="number">102</span> + <span class="number">24696</span>*x^<span class="number">101</span> - <span class="number">7801</span>*x^<span class="number">100</span> - <span class="number">31874</span>*x^<span class="number">99</span> - <span class="number">17668</span>*x^<span class="number">98</span> - <span class="number">11204</span>*x^<span class="number">97</span> + <span class="number">19147</span>*x^<span class="number">96</span> + <span class="number">24644</span>*x^<span class="number">95</span> - <span class="number">29380</span>*x^<span class="number">94</span> - <span class="number">26237</span>*x^<span class="number">93</span> - <span class="number">27390</span>*x^<span class="number">92</span> + <span class="number">19982</span>*x^<span class="number">91</span> + <span class="number">4074</span>*x^<span class="number">90</span> - <span class="number">17248</span>*x^<span class="number">89</span> - <span class="number">11027</span>*x^<span class="number">88</span> - <span class="number">32690</span>*x^<span class="number">87</span> + <span class="number">5124</span>*x^<span class="number">86</span> - <span class="number">20823</span>*x^<span class="number">85</span> - <span class="number">11779</span>*x^<span class="number">84</span> + <span class="number">13781</span>*x^<span class="number">83</span> + <span class="number">29356</span>*x^<span class="number">82</span> - <span class="number">9740</span>*x^<span class="number">81</span> - <span class="number">31484</span>*x^<span class="number">80</span> - <span class="number">540</span>*x^<span class="number">79</span> + <span class="number">32360</span>*x^<span class="number">78</span> + <span class="number">24795</span>*x^<span class="number">77</span> - <span class="number">8864</span>*x^<span class="number">76</span> + <span class="number">17363</span>*x^<span class="number">75</span> + <span class="number">9670</span>*x^<span class="number">74</span> + <span class="number">32268</span>*x^<span class="number">73</span> + <span class="number">17961</span>*x^<span class="number">72</span> + <span class="number">6388</span>*x^<span class="number">71</span> + <span class="number">580</span>*x^<span class="number">70</span> + <span class="number">128</span>*x^<span class="number">69</span> + <span class="number">339</span>*x^<span class="number">68</span> + <span class="number">3412</span>*x^<span class="number">67</span> - <span class="number">4519</span>*x^<span class="number">66</span> - <span class="number">25056</span>*x^<span class="number">65</span> + <span class="number">6096</span>*x^<span class="number">64</span> + <span class="number">18720</span>*x^<span class="number">63</span> - <span class="number">5338</span>*x^<span class="number">62</span> + <span class="number">16910</span>*x^<span class="number">61</span> + <span class="number">3353</span>*x^<span class="number">60</span> + <span class="number">15433</span>*x^<span class="number">59</span> - <span class="number">28053</span>*x^<span class="number">58</span> - <span class="number">18883</span>*x^<span class="number">57</span> + <span class="number">7688</span>*x^<span class="number">56</span> - <span class="number">31198</span>*x^<span class="number">55</span> + <span class="number">9950</span>*x^<span class="number">54</span> - <span class="number">9388</span>*x^<span class="number">53</span> + <span class="number">21235</span>*x^<span class="number">52</span> + <span class="number">2847</span>*x^<span class="number">51</span> + <span class="number">24383</span>*x^<span class="number">50</span> + <span class="number">19431</span>*x^<span class="number">49</span> + <span class="number">21244</span>*x^<span class="number">48</span> - <span class="number">8498</span>*x^<span class="number">47</span> - <span class="number">28998</span>*x^<span class="number">46</span> + <span class="number">962</span>*x^<span class="number">45</span> + <span class="number">20579</span>*x^<span class="number">44</span> + <span class="number">28002</span>*x^<span class="number">43</span> - <span class="number">6040</span>*x^<span class="number">42</span> + <span class="number">4241</span>*x^<span class="number">41</span> + <span class="number">11655</span>*x^<span class="number">40</span> - <span class="number">32419</span>*x^<span class="number">39</span> + <span class="number">21531</span>*x^<span class="number">38</span> + <span class="number">7348</span>*x^<span class="number">37</span> - <span class="number">5503</span>*x^<span class="number">36</span> + <span class="number">29820</span>*x^<span class="number">35</span> + <span class="number">28896</span>*x^<span class="number">34</span> + <span class="number">8754</span>*x^<span class="number">33</span> + <span class="number">17978</span>*x^<span class="number">32</span> + <span class="number">7552</span>*x^<span class="number">31</span> + <span class="number">27240</span>*x^<span class="number">30</span> - <span class="number">29515</span>*x^<span class="number">29</span> - <span class="number">20322</span>*x^<span class="number">28</span> + <span class="number">2201</span>*x^<span class="number">27</span> + <span class="number">8857</span>*x^<span class="number">26</span> - <span class="number">50</span>*x^<span class="number">25</span> - <span class="number">3780</span>*x^<span class="number">24</span> - <span class="number">12138</span>*x^<span class="number">23</span> + <span class="number">10893</span>*x^<span class="number">22</span> + <span class="number">23133</span>*x^<span class="number">21</span> + <span class="number">6142</span>*x^<span class="number">20</span> - <span class="number">23798</span>*x^<span class="number">19</span> - <span class="number">15236</span>*x^<span class="number">18</span> + <span class="number">32564</span>*x^<span class="number">17</span> + <span class="number">25683</span>*x^<span class="number">16</span> - <span class="number">24010</span>*x^<span class="number">15</span> - <span class="number">4355</span>*x^<span class="number">14</span> + <span class="number">22552</span>*x^<span class="number">13</span> - <span class="number">27155</span>*x^<span class="number">12</span> + <span class="number">27649</span>*x^<span class="number">11</span> + <span class="number">17781</span>*x^<span class="number">10</span> + <span class="number">7115</span>*x^<span class="number">9</span> + <span class="number">27465</span>*x^<span class="number">8</span> - <span class="number">4369</span>*x^<span class="number">7</span> + <span class="number">24882</span>*x^<span class="number">6</span> - <span class="number">11675</span>*x^<span class="number">5</span> - <span class="number">612</span>*x^<span class="number">4</span> + <span class="number">12361</span>*x^<span class="number">3</span> + <span class="number">20120</span>*x^<span class="number">2</span> + <span class="number">6190</span>*x - <span class="number">10843</span></span><br><span class="line">pubkey = R(pubkey)</span><br><span class="line">c = -<span class="number">26801</span>*x^<span class="number">159</span> - <span class="number">25103</span>*x^<span class="number">158</span> + <span class="number">29811</span>*x^<span class="number">157</span> - <span class="number">12251</span>*x^<span class="number">156</span> - <span class="number">13386</span>*x^<span class="number">155</span> - <span class="number">28030</span>*x^<span class="number">154</span> - <span class="number">16511</span>*x^<span class="number">153</span> + <span class="number">23761</span>*x^<span class="number">152</span> + <span class="number">28329</span>*x^<span class="number">151</span> - <span class="number">16406</span>*x^<span class="number">150</span> + <span class="number">30931</span>*x^<span class="number">149</span> + <span class="number">5326</span>*x^<span class="number">148</span> + <span class="number">19877</span>*x^<span class="number">147</span> - <span class="number">23165</span>*x^<span class="number">146</span> - <span class="number">31540</span>*x^<span class="number">145</span> - <span class="number">7923</span>*x^<span class="number">144</span> + <span class="number">5880</span>*x^<span class="number">143</span> - <span class="number">27078</span>*x^<span class="number">142</span> - <span class="number">25436</span>*x^<span class="number">141</span> - <span class="number">17162</span>*x^<span class="number">140</span> + <span class="number">1471</span>*x^<span class="number">139</span> + <span class="number">14486</span>*x^<span class="number">138</span> + <span class="number">7702</span>*x^<span class="number">137</span> - <span class="number">29890</span>*x^<span class="number">136</span> + <span class="number">29315</span>*x^<span class="number">135</span> + <span class="number">558</span>*x^<span class="number">134</span> - <span class="number">22429</span>*x^<span class="number">133</span> - <span class="number">361</span>*x^<span class="number">132</span> + <span class="number">19049</span>*x^<span class="number">131</span> - <span class="number">30437</span>*x^<span class="number">130</span> - <span class="number">32610</span>*x^<span class="number">129</span> - <span class="number">3024</span>*x^<span class="number">128</span> - <span class="number">4313</span>*x^<span class="number">127</span> + <span class="number">29174</span>*x^<span class="number">126</span> - <span class="number">2837</span>*x^<span class="number">125</span> - <span class="number">2812</span>*x^<span class="number">124</span> + <span class="number">13450</span>*x^<span class="number">123</span> - <span class="number">15001</span>*x^<span class="number">122</span> - <span class="number">25791</span>*x^<span class="number">121</span> - <span class="number">8702</span>*x^<span class="number">120</span> - <span class="number">4968</span>*x^<span class="number">119</span> - <span class="number">15340</span>*x^<span class="number">118</span> + <span class="number">31744</span>*x^<span class="number">117</span> - <span class="number">32478</span>*x^<span class="number">116</span> + <span class="number">19737</span>*x^<span class="number">115</span> - <span class="number">12629</span>*x^<span class="number">114</span> - <span class="number">27847</span>*x^<span class="number">113</span> + <span class="number">27322</span>*x^<span class="number">112</span> - <span class="number">31375</span>*x^<span class="number">111</span> + <span class="number">14777</span>*x^<span class="number">110</span> + <span class="number">29825</span>*x^<span class="number">109</span> - <span class="number">25883</span>*x^<span class="number">108</span> - <span class="number">13335</span>*x^<span class="number">107</span> + <span class="number">32517</span>*x^<span class="number">106</span> + <span class="number">14871</span>*x^<span class="number">105</span> - <span class="number">7287</span>*x^<span class="number">104</span> + <span class="number">13398</span>*x^<span class="number">103</span> - <span class="number">32710</span>*x^<span class="number">102</span> + <span class="number">20805</span>*x^<span class="number">101</span> + <span class="number">29734</span>*x^<span class="number">100</span> - <span class="number">14579</span>*x^<span class="number">99</span> + <span class="number">17483</span>*x^<span class="number">98</span> - <span class="number">16864</span>*x^<span class="number">97</span> - <span class="number">26745</span>*x^<span class="number">96</span> + <span class="number">3254</span>*x^<span class="number">95</span> + <span class="number">7280</span>*x^<span class="number">94</span> - <span class="number">29046</span>*x^<span class="number">93</span> - <span class="number">7531</span>*x^<span class="number">92</span> - <span class="number">8791</span>*x^<span class="number">91</span> + <span class="number">15033</span>*x^<span class="number">90</span> - <span class="number">1125</span>*x^<span class="number">89</span> - <span class="number">14713</span>*x^<span class="number">88</span> - <span class="number">12273</span>*x^<span class="number">87</span> + <span class="number">8616</span>*x^<span class="number">86</span> + <span class="number">2486</span>*x^<span class="number">85</span> + <span class="number">31810</span>*x^<span class="number">84</span> + <span class="number">27795</span>*x^<span class="number">83</span> - <span class="number">21731</span>*x^<span class="number">82</span> + <span class="number">21743</span>*x^<span class="number">81</span> - <span class="number">27595</span>*x^<span class="number">80</span> - <span class="number">3592</span>*x^<span class="number">79</span> - <span class="number">27206</span>*x^<span class="number">78</span> - <span class="number">32156</span>*x^<span class="number">77</span> + <span class="number">32124</span>*x^<span class="number">76</span> - <span class="number">11212</span>*x^<span class="number">75</span> - <span class="number">6662</span>*x^<span class="number">74</span> - <span class="number">23103</span>*x^<span class="number">73</span> - <span class="number">3660</span>*x^<span class="number">72</span> - <span class="number">31043</span>*x^<span class="number">71</span> - <span class="number">17131</span>*x^<span class="number">70</span> + <span class="number">24544</span>*x^<span class="number">69</span> - <span class="number">32326</span>*x^<span class="number">68</span> - <span class="number">31047</span>*x^<span class="number">67</span> + <span class="number">19814</span>*x^<span class="number">66</span> + <span class="number">10874</span>*x^<span class="number">65</span> - <span class="number">8449</span>*x^<span class="number">64</span> + <span class="number">11744</span>*x^<span class="number">63</span> + <span class="number">2245</span>*x^<span class="number">62</span> - <span class="number">967</span>*x^<span class="number">61</span> + <span class="number">9120</span>*x^<span class="number">60</span> + <span class="number">8983</span>*x^<span class="number">59</span> - <span class="number">24573</span>*x^<span class="number">58</span> + <span class="number">24885</span>*x^<span class="number">57</span> + <span class="number">15649</span>*x^<span class="number">56</span> - <span class="number">18970</span>*x^<span class="number">55</span> + <span class="number">7354</span>*x^<span class="number">54</span> - <span class="number">12282</span>*x^<span class="number">53</span> - <span class="number">22474</span>*x^<span class="number">52</span> + <span class="number">4395</span>*x^<span class="number">51</span> + <span class="number">8428</span>*x^<span class="number">50</span> - <span class="number">32592</span>*x^<span class="number">49</span> + <span class="number">25980</span>*x^<span class="number">48</span> - <span class="number">4599</span>*x^<span class="number">47</span> + <span class="number">16310</span>*x^<span class="number">46</span> + <span class="number">18559</span>*x^<span class="number">45</span> + <span class="number">22897</span>*x^<span class="number">44</span> + <span class="number">19080</span>*x^<span class="number">43</span> - <span class="number">26065</span>*x^<span class="number">42</span> - <span class="number">9</span>*x^<span class="number">41</span> + <span class="number">29202</span>*x^<span class="number">40</span> + <span class="number">2121</span>*x^<span class="number">39</span> - <span class="number">5004</span>*x^<span class="number">38</span> + <span class="number">5299</span>*x^<span class="number">37</span> - <span class="number">28301</span>*x^<span class="number">36</span> - <span class="number">13519</span>*x^<span class="number">35</span> + <span class="number">24241</span>*x^<span class="number">34</span> + <span class="number">529</span>*x^<span class="number">33</span> - <span class="number">20574</span>*x^<span class="number">32</span> - <span class="number">27391</span>*x^<span class="number">31</span> + <span class="number">31976</span>*x^<span class="number">30</span> + <span class="number">22824</span>*x^<span class="number">29</span> - <span class="number">31410</span>*x^<span class="number">28</span> - <span class="number">20976</span>*x^<span class="number">27</span> + <span class="number">21661</span>*x^<span class="number">26</span> - <span class="number">15132</span>*x^<span class="number">25</span> + <span class="number">1905</span>*x^<span class="number">24</span> - <span class="number">30870</span>*x^<span class="number">23</span> + <span class="number">18109</span>*x^<span class="number">22</span> - <span class="number">17373</span>*x^<span class="number">21</span> + <span class="number">5342</span>*x^<span class="number">20</span> - <span class="number">22447</span>*x^<span class="number">19</span> + <span class="number">1893</span>*x^<span class="number">18</span> - <span class="number">17545</span>*x^<span class="number">17</span> + <span class="number">30097</span>*x^<span class="number">16</span> - <span class="number">21731</span>*x^<span class="number">15</span> + <span class="number">17390</span>*x^<span class="number">14</span> + <span class="number">10991</span>*x^<span class="number">13</span> - <span class="number">5384</span>*x^<span class="number">12</span> + <span class="number">15960</span>*x^<span class="number">11</span> + <span class="number">24268</span>*x^<span class="number">10</span> - <span class="number">29867</span>*x^<span class="number">9</span> + <span class="number">22532</span>*x^<span class="number">8</span> + <span class="number">10133</span>*x^<span class="number">7</span> - <span class="number">26576</span>*x^<span class="number">6</span> - <span class="number">5742</span>*x^<span class="number">5</span> - <span class="number">16252</span>*x^<span class="number">4</span> + <span class="number">13019</span>*x^<span class="number">3</span> - <span class="number">25984</span>*x^<span class="number">2</span> + <span class="number">14004</span>*x + <span class="number">22500</span></span><br><span class="line">c = R(c)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">balance_mod</span>(<span class="params">f, q</span>):</span><br><span class="line">    g = <span class="built_in">list</span>(((f[i] + q // <span class="number">2</span>) % q) - q // <span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n))</span><br><span class="line">    <span class="keyword">return</span> R(g)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_mod_prime</span>(<span class="params">f, p</span>):</span><br><span class="line">    T = R.base().change_ring(Integers(p)).quotient(x ^ n - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> R(<span class="number">1</span> / T(f))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dec</span>(<span class="params">c, prikey</span>):</span><br><span class="line">    f, fp = prikey</span><br><span class="line">    a = balance_mod(c * f, q)</span><br><span class="line">    <span class="keyword">return</span> balance_mod(a * fp, p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack</span>(<span class="params">pubkey, c</span>):</span><br><span class="line">    A = Matrix(ZZ, <span class="number">2</span> * n, <span class="number">2</span> * n)</span><br><span class="line">    hp = inverse(p, q) * pubkey</span><br><span class="line">    hp_list = <span class="built_in">list</span>(hp)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        A[i, i] = q</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n, <span class="number">2</span> * n):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            A[i, j] = hp_list[(j - i) % n]</span><br><span class="line">        A[i, i] = <span class="number">1</span></span><br><span class="line">    AL = A.BKZ()</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> AL:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            f = R(row[n:].<span class="built_in">list</span>())</span><br><span class="line">            fp = invert_mod_prime(f, p)</span><br><span class="line">            <span class="keyword">return</span> dec(c, (f, fp))</span><br><span class="line">            <span class="keyword">break</span> <span class="comment"># may failed with shortest vector(return more if failed)</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line">m = crack(pubkey, c)</span><br><span class="line"></span><br><span class="line">m = m.<span class="built_in">list</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">    m[i] += <span class="number">1</span></span><br><span class="line">    m[i] = <span class="built_in">str</span>(m[i])</span><br><span class="line">str1 = <span class="string">&quot;&quot;</span>.join(m[::-<span class="number">1</span>])</span><br><span class="line">temp = <span class="built_in">int</span>(str1,<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(temp))</span><br></pre></td></tr></table></figure>
<p>(å¯èƒ½éœ€è¦è·‘å‡ åˆ†é’Ÿ)</p>
<p>flag:</p>
<font size="4" color="red">cnss{NTRU_w1th_un5afe_par4}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="MidLattice"><a href="#MidLattice" class="headerlink" title="MidLattice"></a>MidLattice</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">çœ‹ä¸Šå»åƒgcdï¼Œä½†æ˜¯æœ‰åŒºåˆ«</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">pbit = <span class="number">500</span></span><br><span class="line">qbit = <span class="number">550</span></span><br><span class="line">rbit = <span class="number">200</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_sample</span>():</span><br><span class="line">    x_list  = []</span><br><span class="line">    p = getPrime(pbit)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">120</span>):</span><br><span class="line">        q = getPrime(qbit)</span><br><span class="line">        r = getPrime(rbit)</span><br><span class="line">        x_list.append(q*p + <span class="number">2</span>*r)</span><br><span class="line">    <span class="keyword">return</span> x_list,p</span><br><span class="line">sample,p = get_sample()</span><br><span class="line">flag = <span class="string">&#x27;cnss&#123;&#x27;</span>+hashlib.sha256(long_to_bytes(p)).hexdigest()+<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(<span class="built_in">str</span>(sample))</span><br></pre></td></tr></table></figure>
<p>ä»¥åŠä¸€ä¸ªoutput.txt</p>
<p>é¢˜ç›®æè¿°çš„å¾ˆæ˜ç¡®äº†ï¼Œagcdé—®é¢˜(è¿‘ä¼¼å…¬çº¦æ•°é—®é¢˜)ï¼Œä¹Ÿä¸æ ¼ç›¸å…³ï¼Œä¸è¿›è¡Œå±•å¼€ã€‚</p>
<p><br></p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> permutations</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">P_bits = <span class="number">500</span></span><br><span class="line">Q_bits = <span class="number">550</span></span><br><span class="line">R_bits = <span class="number">200</span></span><br><span class="line">e = <span class="number">0x1337</span></span><br><span class="line">N = <span class="comment">#è‡ªè¡Œä»£å…¥</span></span><br><span class="line">X = <span class="number">2</span>**R_bits</span><br><span class="line">m = <span class="built_in">len</span>(N)</span><br><span class="line"></span><br><span class="line">PR = PolynomialRing(ZZ, names=[<span class="built_in">str</span>(<span class="string">&#x27;x%d&#x27;</span> % i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1</span> + m)])</span><br><span class="line"></span><br><span class="line">h = <span class="number">3</span></span><br><span class="line">u = <span class="number">1</span></span><br><span class="line">variables = PR.gens()</span><br><span class="line"></span><br><span class="line">gg = []</span><br><span class="line">monomials = [variables[<span class="number">0</span>]**<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    gg.append(N[i] - variables[i])</span><br><span class="line">    monomials.append(variables[i])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(monomials), <span class="built_in">len</span>(gg))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;monomials:&#x27;</span>, monomials)</span><br><span class="line"></span><br><span class="line">B = Matrix(ZZ, <span class="built_in">len</span>(gg), <span class="built_in">len</span>(monomials))</span><br><span class="line"><span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(gg)):</span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(monomials)):</span><br><span class="line">        <span class="keyword">if</span> monomials[jj] <span class="keyword">in</span> gg[ii].monomials():</span><br><span class="line">            B[ii, jj] = gg[ii].monomial_coefficient(monomials[jj]) * monomials[jj]([X] * m)</span><br><span class="line"></span><br><span class="line">B = B.LLL()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-&#x27;</span> * <span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">new_pol = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(gg)):</span><br><span class="line">    tmp_pol = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(monomials)):</span><br><span class="line">        tmp_pol += monomials[j](variables) * B[i, j] / monomials[j]([X] * m)</span><br><span class="line">    new_pol.append(tmp_pol)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(new_pol) &gt; <span class="number">0</span>:</span><br><span class="line">    Ideal = ideal(new_pol[:m-<span class="number">1</span>])</span><br><span class="line">    GB = Ideal.groebner_basis()</span><br><span class="line">    function_variables = var([<span class="built_in">str</span>(<span class="string">&#x27;y%d&#x27;</span> % i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1</span> + m)])</span><br><span class="line">    res = solve([pol(function_variables) <span class="keyword">for</span> pol <span class="keyword">in</span> GB], function_variables)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;got %d basis&#x27;</span> % <span class="built_in">len</span>(GB))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;solved result:&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br><span class="line">    PRRR.&lt; x, y&gt; = PolynomialRing(QQ)</span><br><span class="line">    q = <span class="built_in">abs</span>(PRRR(res[<span class="number">0</span>][<span class="number">0</span>](x, y)).coefficients()[<span class="number">0</span>].denominator())</span><br><span class="line">    p = N[-<span class="number">1</span>] // q</span><br><span class="line"></span><br><span class="line">    flag = <span class="string">&#x27;cnss&#123;&#x27;</span>+hashlib.sha256(long_to_bytes(p)).hexdigest()+<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿéœ€è¦è·‘å‡ åˆ†é’Ÿæ‰å‡ºç»“æœï¼Œèƒ½æ›´ç²¾ç¡®åœ°è°ƒæ•´å‚æ•°çš„è¯å¯èƒ½å¯ä»¥å‡å°‘è€—æ—¶ã€‚</p>
<p>flag:</p>
<font size="4" color="red">cnss{dde0cc3ac3539c66a74ed445a81c3f5b12938c286fa569a3b143b72369c708c9}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="é“œåŒ çš„ä¸–ç•Œ"><a href="#é“œåŒ çš„ä¸–ç•Œ" class="headerlink" title="é“œåŒ çš„ä¸–ç•Œ"></a>é“œåŒ çš„ä¸–ç•Œ</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ€æ ·åœ¨2^512ä¸ªå¯èƒ½ä¸­æ‰¾åˆ°å”¯ä¸€çš„ç­”æ¡ˆå‘¢ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> isqrt</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p, q = getPrime(<span class="number">512</span>), getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">hint = isqrt(p) ^ isqrt(q)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;hint = &#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 85404423344841677974087657659736161235661371072424467828040714876602706438511794670195915251038316685200550396898521246532238184171610202260808362573973358649489859739377219665083353960986881177279315590581777896976153899765953910931555330824054172366095461986394627542626117519624886018101305667394230690241</span></span><br><span class="line"><span class="string">c = 19771222413844352631385715488753476758377273736688852768996964594019231638669697870409256892886494956719082541038530128231778575768552216334354854019126139003782852207071549956953446472517410158388833668611141062328959917017080292879996106665465487753670322759387144032463518586362415629216383494479440197516</span></span><br><span class="line"><span class="string">hint = 34903932064178830653499046348212332783401351910283782992020948402621276719605</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœç»™çš„æ˜¯p^qï¼Œé¢˜ç›®æ˜¯å®¹æ˜“çš„ï¼Œåªéœ€è¦æŒ‰ç…§RSA â…¡ç±»ä¼¼çš„æ€è·¯è¿›è¡Œæ·±æœå³å¯ã€‚è€Œç»™çš„æ˜¯isqrt(p) ^ isqrt(q)ï¼Œå¾ˆå®¹æ˜“ä¼šæœ‰æ€è·¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>å¯¹nå¼€æ ¹ï¼Œå¾—åˆ°isqrt(p*q) </li>
<li>å°†isqrt(p*q) çœ‹ä½œnï¼Œå°†isqrt(p) ^ isqrt(q)çœ‹ä½œp^qï¼Œè½¬åŒ–æˆä¸Šé¢ç»™å®šp^qçš„é—®é¢˜æ±‚è§£</li>
</ul>
<p>çœ‹ä¸Šå»æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œå¯æ˜¯å®é™…æ“ä½œå°±ä¼šå‘ç°å­˜åœ¨ä¸¤ç‚¹é—®é¢˜ï¼š</p>
<ul>
<li>ç”±äºä¸€äº›ä½ä½è¯¯å·®ï¼Œæœ‰ä¸€äº›å¯èƒ½æ­£ç¡®çš„æ ¹å·pã€qé«˜ä½è¢«èˆå¼ƒã€‚</li>
<li>å³ä½¿å¾—åˆ°äº†æ­£ç¡®çš„isqrt(p)ä¸isqrt(q)ï¼Œå„è‡ªå¹³æ–¹åä¸çœŸæ­£çš„pã€qè¿˜æœ‰è‡³å°‘256æ¯”ç‰¹çš„å·®è·ï¼Œå³ä½¿æ˜¯ç”¨coppersmithä¹Ÿå®Œå…¨æ»¡è¶³ä¸äº†ä½¿ç”¨æ¡ä»¶ã€‚</li>
</ul>
<p>å› æ­¤ä¸èƒ½å†ä½¿ç”¨RSA â…¡ä¸­çš„è¿”å›æ¡ä»¶è¿›è¡ŒæŒ‰ä½æŸ¥æ‰¾äº†ã€‚æ­¤æ—¶æœç´¢é¢˜ç›®ï¼Œå‘ç°äº†ä½¬çš„ç±»ä¼¼çš„é¢˜ç›®æ€è·¯ï¼š</p>
<p><a href="https://blog.maple3142.net/2023/06/12/seetf-2023-writeups/#shard">https://blog.maple3142.net/2023/06/12/seetf-2023-writeups/#shard</a></p>
<p>è¿™æ ·å­æŸ¥æ‰¾æˆåŠŸåï¼Œè¿˜éœ€è¦å¯¹ä½ä½è¿›è¡Œä¸€å®šç¨‹åº¦çš„çˆ†ç ´åæ‰èƒ½ä½¿ç”¨coppersmithï¼Œå¹¶ä¸”å‚æ•°è¦å¡çš„æ¯”è¾ƒæ­»ï¼Œæ¯”å¦‚epsilonå–0.03è™½ç„¶å¿«ä¸€äº›ï¼Œä½†æ˜¯è·‘ä¸å‡ºç»“æœï¼Œå› æ­¤åªèƒ½å–0.01ç”šè‡³æ›´å°ï¼Œä½†è¿™ä¸ªå°±ä¼šè€—è´¹å¾ˆé•¿æ—¶é—´ã€‚é—æ†¾çš„æ˜¯æˆ‘ä¹Ÿæ²¡æœ‰æƒ³å‡ºæ›´å¥½çš„åŠæ³•ã€‚</p>
<p><br></p>
<p>exp_step1.ipynbï¼š(æ±‚å‡ºå¯èƒ½çš„pé«˜ä½)ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> randbelow</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> re <span class="keyword">import</span> findall</span><br><span class="line"><span class="keyword">from</span> subprocess <span class="keyword">import</span> check_output</span><br><span class="line"><span class="keyword">from</span> binteger <span class="keyword">import</span> Bin</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">self, X=<span class="literal">None</span>, beta=<span class="number">1.0</span>, epsilon=<span class="literal">None</span>, **kwds</span>):</span><br><span class="line">    <span class="keyword">from</span> sage.misc.verbose <span class="keyword">import</span> verbose</span><br><span class="line">    <span class="keyword">from</span> sage.matrix.constructor <span class="keyword">import</span> Matrix</span><br><span class="line">    <span class="keyword">from</span> sage.rings.real_mpfr <span class="keyword">import</span> RR</span><br><span class="line"></span><br><span class="line">    N = self.parent().characteristic()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> self.is_monic():</span><br><span class="line">        <span class="keyword">raise</span> ArithmeticError(<span class="string">&quot;Polynomial must be monic.&quot;</span>)</span><br><span class="line"></span><br><span class="line">    beta = RR(beta)</span><br><span class="line">    <span class="keyword">if</span> beta &lt;= <span class="number">0.0</span> <span class="keyword">or</span> beta &gt; <span class="number">1.0</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;0.0 &lt; beta &lt;= 1.0 not satisfied.&quot;</span>)</span><br><span class="line"></span><br><span class="line">    f = self.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    P, (x,) = f.parent().objgens()</span><br><span class="line"></span><br><span class="line">    delta = f.degree()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> epsilon <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        epsilon = beta / <span class="number">8</span></span><br><span class="line">    verbose(<span class="string">&quot;epsilon = %f&quot;</span> % epsilon, level=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    m = <span class="built_in">max</span>(beta**<span class="number">2</span> / (delta * epsilon), <span class="number">7</span> * beta / delta).ceil()</span><br><span class="line">    verbose(<span class="string">&quot;m = %d&quot;</span> % m, level=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    t = <span class="built_in">int</span>((delta * m * (<span class="number">1</span> / beta - <span class="number">1</span>)).floor())</span><br><span class="line">    verbose(<span class="string">&quot;t = %d&quot;</span> % t, level=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> X <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        X = (<span class="number">0.5</span> * N ** (beta**<span class="number">2</span> / delta - epsilon)).ceil()</span><br><span class="line">    verbose(<span class="string">&quot;X = %s&quot;</span> % X, level=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># we could do this much faster, but this is a cheap step</span></span><br><span class="line">    <span class="comment"># compared to LLL</span></span><br><span class="line">    g = [x**j * N ** (m - i) * f**i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(delta)]</span><br><span class="line">    g.extend([x**i * f**m <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t)])  <span class="comment"># h</span></span><br><span class="line"></span><br><span class="line">    B = Matrix(ZZ, <span class="built_in">len</span>(g), delta * m + <span class="built_in">max</span>(delta, t))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(B.nrows()):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(g[i].degree() + <span class="number">1</span>):</span><br><span class="line">            B[i, j] = g[i][j] * X**j</span><br><span class="line"></span><br><span class="line">    f = <span class="built_in">sum</span>([ZZ(B[<span class="number">0</span>, i] // X**i) * x**i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(B.ncols())])</span><br><span class="line">    R = f.roots()</span><br><span class="line"></span><br><span class="line">    ZmodN = self.base_ring()</span><br><span class="line">    roots = <span class="built_in">set</span>([ZmodN(r) <span class="keyword">for</span> r, m <span class="keyword">in</span> R <span class="keyword">if</span> <span class="built_in">abs</span>(r) &lt;= X])</span><br><span class="line">    Nbeta = N**beta</span><br><span class="line">    <span class="keyword">return</span> [root <span class="keyword">for</span> root <span class="keyword">in</span> roots <span class="keyword">if</span> N.gcd(ZZ(self(root))) &gt;= Nbeta]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pq = <span class="number">85404423344841677974087657659736161235661371072424467828040714876602706438511794670195915251038316685200550396898521246532238184171610202260808362573973358649489859739377219665083353960986881177279315590581777896976153899765953910931555330824054172366095461986394627542626117519624886018101305667394230690241</span></span><br><span class="line">c = <span class="number">19771222413844352631385715488753476758377273736688852768996964594019231638669697870409256892886494956719082541038530128231778575768552216334354854019126139003782852207071549956953446472517410158388833668611141062328959917017080292879996106665465487753670322759387144032463518586362415629216383494479440197516</span></span><br><span class="line">hint = <span class="number">34903932064178830653499046348212332783401351910283782992020948402621276719605</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dfs</span>(<span class="params">spv, i</span>):</span><br><span class="line">    <span class="keyword">if</span> i &gt;= <span class="number">256</span>:</span><br><span class="line">        <span class="keyword">yield</span> Bin(spv, <span class="number">256</span>), Bin(Bin(spv).<span class="built_in">int</span> ^^ hint, <span class="number">256</span>)</span><br><span class="line">    <span class="keyword">if</span> i &gt;= <span class="number">256</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> (<span class="number">1</span>, <span class="number">0</span>):</span><br><span class="line">        spv[i] = b</span><br><span class="line">        tsp = Bin(spv).<span class="built_in">int</span></span><br><span class="line">        tsq = tsp ^^ hint</span><br><span class="line">        p = tsp**<span class="number">2</span></span><br><span class="line">        q = tsq**<span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> &lt;= (pq - p * q) &lt;= <span class="number">2</span> ** (<span class="number">1024</span> - i + <span class="number">1</span>) <span class="keyword">and</span> <span class="number">0</span> &lt;= (</span><br><span class="line">            iroot(pq,<span class="number">2</span>)[<span class="number">0</span>] - tsp * tsq</span><br><span class="line">        ) &lt;= <span class="number">2</span> ** (<span class="number">512</span> - i + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">yield</span> <span class="keyword">from</span> dfs(spv[:], i + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">spv = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line">results = []</span><br><span class="line"><span class="keyword">for</span> spc, sqc <span class="keyword">in</span> dfs(spv, <span class="number">0</span>):</span><br><span class="line">    d = pq - spc.<span class="built_in">int</span>**<span class="number">2</span> * sqc.<span class="built_in">int</span>**<span class="number">2</span></span><br><span class="line">    results.append((d, spc.<span class="built_in">int</span>, sqc.<span class="built_in">int</span>))</span><br><span class="line"><span class="keyword">for</span> i, (_, spci, sqci) <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">sorted</span>(results)):</span><br><span class="line">    <span class="number">1</span></span><br><span class="line">    <span class="comment">#print((spci - (iroot(pq,2)[0] // sqci)).bit_length())</span></span><br><span class="line"><span class="built_in">print</span>(results)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">copp_factor</span>(<span class="params">sp, leak=<span class="number">5</span></span>):</span><br><span class="line">    <span class="keyword">for</span> tb <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span> &lt;&lt; leak):</span><br><span class="line">        <span class="comment">#print(&quot;copp&quot;, tb, int(time.time()))</span></span><br><span class="line">        shift = <span class="number">256</span> - leak + <span class="number">1</span></span><br><span class="line">        P = Zmod(pq)[<span class="string">&quot;x&quot;</span>]</span><br><span class="line">        x = P.gen()</span><br><span class="line">        f = sp.<span class="built_in">int</span>**<span class="number">2</span> + (x &lt;&lt; shift) + <span class="number">2</span>*tb + <span class="number">1</span></span><br><span class="line">        f = f.monic()</span><br><span class="line">        X = <span class="number">2</span> ** (<span class="number">256</span> - leak - <span class="number">1</span>)</span><br><span class="line">        beta = <span class="number">0.499</span></span><br><span class="line">        eps = <span class="number">0.01</span></span><br><span class="line">        rs = f.small_roots(X=X, beta=beta, epsilon=eps)</span><br><span class="line">        <span class="comment">#rs = small_roots(f, X=X, beta=beta, epsilon=eps)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(rs):</span><br><span class="line">            <span class="built_in">print</span>(sp.<span class="built_in">int</span>**<span class="number">2</span> + (tb &lt;&lt; shift) + <span class="built_in">int</span>(rs[<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, (_, spci, _) <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">sorted</span>(results)):</span><br><span class="line">    copp_factor(Bin(spci, <span class="number">256</span>))</span><br></pre></td></tr></table></figure>
<p>å°†è¿è¡Œç»“æœå¡«å……è‡³ä¸‹é¢è„šæœ¬ä¸­çš„sqrtplistä¸­</p>
<p><br></p>
<p>exp_step2.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="comment">#coppersmith</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line">N = <span class="number">85404423344841677974087657659736161235661371072424467828040714876602706438511794670195915251038316685200550396898521246532238184171610202260808362573973358649489859739377219665083353960986881177279315590581777896976153899765953910931555330824054172366095461986394627542626117519624886018101305667394230690241</span></span><br><span class="line">c = <span class="number">19771222413844352631385715488753476758377273736688852768996964594019231638669697870409256892886494956719082541038530128231778575768552216334354854019126139003782852207071549956953446472517410158388833668611141062328959917017080292879996106665465487753670322759387144032463518586362415629216383494479440197516</span></span><br><span class="line"></span><br><span class="line">sqrtplist = <span class="comment">#è‡ªè¡Œä»£å…¥</span></span><br><span class="line"></span><br><span class="line">leak = <span class="number">6</span></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(sqrtplist)):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    sp = sqrtplist[i][<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> tb <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span> &lt;&lt; leak):</span><br><span class="line">        <span class="comment">#print(&quot;copp&quot;, tb, int(time.time()))</span></span><br><span class="line">        shift = <span class="number">256</span> - leak</span><br><span class="line">        PR.&lt;x&gt; = PolynomialRing(Zmod(N))</span><br><span class="line">        f = sp**<span class="number">2</span> + (tb &lt;&lt; shift) + x</span><br><span class="line">        f = f.monic()</span><br><span class="line">        X = <span class="number">2</span> ** (<span class="number">256</span> - leak)</span><br><span class="line">        beta = <span class="number">0.499</span></span><br><span class="line">        eps = <span class="number">0.01</span></span><br><span class="line">        res = f.small_roots(X=X, beta=beta, epsilon=eps)</span><br><span class="line">        <span class="keyword">if</span>(res!=[]):</span><br><span class="line">            <span class="built_in">print</span>(res)</span><br><span class="line">            <span class="built_in">print</span>(sp**<span class="number">2</span> + (tb &lt;&lt; shift) + res[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">p = <span class="number">6756521617869105417915102754795944450583448652752246233837766079298009351893501307888859133738834804209006551446537605217981998432259279870915861077557549</span></span><br><span class="line">q = N//p</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,N)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>è·‘å‡ºç»“æœå¯èƒ½éœ€è¦6ä¸ªå°æ—¶åˆ°10ä¸ªå°æ—¶ä¸ç­‰ã€‚å¦‚æœä½ æœ‰æ›´å¥½çš„æ–¹å¼æ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ï¼</p>
<p>flag:</p>
<font size="4" color="red">cnss{We hav3 n0 0ther ch0ice but c0ppersm1th.}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é¢˜ç›®è´¨é‡ç¡®å®å¾ˆä¸é”™ï¼Œæ¯é“é¢˜ç›®è€ƒå¯Ÿçš„çŸ¥è¯†ç‚¹å¾ˆæœ‰é’ˆå¯¹æ€§ï¼Œå‡†å¤‡å¥½å¥½å€Ÿé‰´å‚è€ƒ(<del>å¼€å·</del>)ã€‚</p>
]]></content>
      <categories>
        <category>wp-crypto</category>
      </categories>
  </entry>
  <entry>
    <title>2023-ç½‘ä¿¡æŸé¹­æ¯-wp-crypto</title>
    <url>/post/812dabe5.html</url>
    <content><![CDATA[<p>å› ä¸ºé˜Ÿä¼ä¸‰ä¸ªäººå…¨éƒ¨å¿˜è®°æŠ¥åäº†ï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰å‚åŠ è¿™åœºæ¯”èµ›ï¼Œä½†èµ›åæœ‰å¸ˆå‚…é—®å¯†ç é¢˜ï¼Œå°±åšäº†ä¸€ä¸‹ã€‚åŒ…å«å…¨ä¸‰é“é¢˜ç›®çš„wpï¼Œä½†æ˜¯ç¬¬ä¸‰é“å¹¶ä¸èƒ½ç™¾åˆ†ç™¾ç¡®å®šå¾—åˆ°çš„flagæ­£ç¡®ï¼Œå¦‚æœ‰é”™è¯¯æ¬¢è¿å¸ˆå‚…æå‡ºï¼</p>
<span id="more"></span>
<h3 id="fractrsa"><a href="#fractrsa" class="headerlink" title="fractrsa"></a>fractrsa</h3><p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#python3</span></span><br><span class="line"><span class="keyword">import</span> sys </span><br><span class="line">sys.path.append(<span class="string">&quot;..&quot;</span>) </span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span>  secret <span class="keyword">import</span> flag1 <span class="keyword">as</span> flag</span><br><span class="line"></span><br><span class="line">num1 = <span class="number">3</span></span><br><span class="line">num2 = <span class="number">5</span></span><br><span class="line"><span class="keyword">while</span>(num1&lt;num2):</span><br><span class="line">    num1 = getPrime(<span class="number">512</span>)</span><br><span class="line">    num2 = getPrime(<span class="number">512</span>)</span><br><span class="line">pt = bytes_to_long(flag) + num2</span><br><span class="line"></span><br><span class="line">ring = RealField(<span class="number">1100</span>)</span><br><span class="line">num3 = ring(num1) / ring(num2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;num3 = &quot;</span>, num3)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p = randint(<span class="number">2</span>**<span class="number">511</span>, num1)</span><br><span class="line">    q = randint(<span class="number">2</span>**<span class="number">511</span>, num2)</span><br><span class="line">    <span class="keyword">if</span> isPrime(p) <span class="keyword">and</span> isPrime(q) <span class="keyword">and</span> p!=q:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"> </span><br><span class="line">N = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">leak = <span class="built_in">pow</span>(p-q, num1, num1*num2)</span><br><span class="line">ct = <span class="built_in">pow</span>(pt, e, N)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ct = &quot;</span>, ct)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;N = &quot;</span>, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;leak = &quot;</span>, leak)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">num3 = 1.23389923415003373900567515471436168841941584796842188964423737295914869304653496800649965063081353720701415762591488370228399019899893688681309320356016722276295236528757306976510687729729934668311830828756908988350841843676900575414367123810470585198055372776278588638204471298838884740198056387082949710435502826460830711429956</span></span><br><span class="line"><span class="string">ct = 31011170589632318837149853165664224847925206003567781692767655474759523146503572164952138829336342836023903919700264739071138739105931471740973631326608186969523753119546323993892359278563753903149741128282349467136720827132122619177620866305659196267641453819504766216964516467658995724859657544518337771393</span></span><br><span class="line"><span class="string">N = 61860727516406742636690805639158184396057779906729165734489212939937929906456706343476469874085504076991779041906401043694401076841639925611957258119417559980829238154105119701407722069260962772947894516879731956778127512764229384957918619863998939985369399189275568362193066167855420897196095587732512368673</span></span><br><span class="line"><span class="string">leak = 23213363443983005040318061737977092634638640953366787443691593387275645092922646169818923792205696350020369122807136306157118385984272980615310163206933078119776935167207473544453080959202803743994251355133953187110546017667004996272367137522351606700447920805532616096125523674597551449412004735397779511371</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®åæ˜ç¤ºäº†ç”¨è¿åˆ†æ•°è§£é¢˜ï¼Œæ­£å¥½å‰å‡ å¤©ä¹Ÿæœ‰å¸ˆå‚…é—®èµ·è¿‡å®‰æ´µæ¯çš„ä¸€é“é¢˜ç›®ï¼Œå…¶å®å°±æ˜¯ç”¨sageå†…ç½®å‡½æ•°ï¼Œå°†è¯¥é«˜ç²¾åº¦å°æ•°è¿›è¡Œè¿åˆ†æ•°å±•å¼€ï¼ŒåŠ ä¸Šæ¯”ç‰¹æ•°åŠç´ æ•°çš„é™åˆ¶å°±èƒ½æ‰¾åˆ°ç²¾ç¡®çš„num1ã€num2ã€‚</p>
<p>æ‰¾åˆ°num1ã€num2åï¼Œæœ‰ä¸¤ç§åŠæ³•è§£å†³ä¸‹ä¸€ä¸ªé—®é¢˜ï¼Œé—®é¢˜å½¢å¼æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
(p-q)^{num1}\equiv leak \quad(mod\;num1*num2)</script><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼Œå…¶å®å°±æ˜¯å½“ä½œæ™®é€šRSAè§£å¯†å°±å¯ä»¥ï¼Œå› ä¸ºnum1ã€num2å…¶å®å°±æ˜¯pã€qï¼Œåªæ˜¯è¿™é‡Œçš„eå˜æˆnum1è€Œå·²ï¼Œæœ¬è´¨è§£å¯†ä¸€æ ·ã€‚</p>
<p>ç¬¬äºŒç§æ–¹æ³•æ¨å¯¼å¦‚ä¸‹ï¼Œç”±åŒä½™æ€§è´¨å…ˆè½¬åˆ°æ¨¡num1ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
(p-q)^{num1}\equiv leak \quad(mod\;num1)</script><p>ç„¶åè´¹é©¬å°å®šç†ï¼š</p>
<script type="math/tex; mode=display">
p-q\equiv leak \quad(mod\;num1)</script><p>åˆå› ä¸º p-q æ˜¾ç„¶å°äºnum1ï¼Œé‚£ä¹ˆç›´æ¥å°†leakæ¨¡num1å°±èƒ½å¾—åˆ°p-q(å½“ç„¶å¦‚æœp&lt;qï¼Œé‚£ä¹ˆå¾—åˆ°çš„å…¶å®æ˜¯p-q+num1ï¼Œéœ€è¦å¯¹åº”åšä¸€ç‚¹å°å¤„ç†)ã€‚</p>
<p>ç„¶åè§£æ–¹ç¨‹å°±èƒ½å¾—åˆ°nçš„åˆ†è§£ï¼Œè¿›è€Œè§£å¯†å¯†æ–‡ï¼Œæ³¨æ„æœ€åè§£å¯†è¿˜è¦å‡æ‰ä¸€ä¸ªnum2ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">num3 = <span class="number">1.23389923415003373900567515471436168841941584796842188964423737295914869304653496800649965063081353720701415762591488370228399019899893688681309320356016722276295236528757306976510687729729934668311830828756908988350841843676900575414367123810470585198055372776278588638204471298838884740198056387082949710435502826460830711429956</span></span><br><span class="line">ct = <span class="number">31011170589632318837149853165664224847925206003567781692767655474759523146503572164952138829336342836023903919700264739071138739105931471740973631326608186969523753119546323993892359278563753903149741128282349467136720827132122619177620866305659196267641453819504766216964516467658995724859657544518337771393</span></span><br><span class="line">N = <span class="number">61860727516406742636690805639158184396057779906729165734489212939937929906456706343476469874085504076991779041906401043694401076841639925611957258119417559980829238154105119701407722069260962772947894516879731956778127512764229384957918619863998939985369399189275568362193066167855420897196095587732512368673</span></span><br><span class="line">leak = <span class="number">23213363443983005040318061737977092634638640953366787443691593387275645092922646169818923792205696350020369122807136306157118385984272980615310163206933078119776935167207473544453080959202803743994251355133953187110546017667004996272367137522351606700447920805532616096125523674597551449412004735397779511371</span></span><br><span class="line"></span><br><span class="line">c = continued_fraction(num3)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"> </span><br><span class="line">alist = c.convergents()</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> alist:</span><br><span class="line">    a = <span class="built_in">str</span>(i).split(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(a)&gt;<span class="number">1</span> <span class="keyword">and</span> gcd(<span class="built_in">int</span>(a[<span class="number">0</span>]),<span class="built_in">int</span>(a[<span class="number">1</span>])) == <span class="number">1</span> <span class="keyword">and</span> is_prime(<span class="built_in">int</span>(a[<span class="number">0</span>])) <span class="keyword">and</span> is_prime(<span class="built_in">int</span>(a[<span class="number">1</span>])) <span class="keyword">and</span> <span class="built_in">int</span>(a[<span class="number">0</span>]).bit_length()==<span class="number">512</span> <span class="keyword">and</span> <span class="built_in">int</span>(a[<span class="number">1</span>]).bit_length()==<span class="number">512</span>:</span><br><span class="line">        num1 = <span class="built_in">int</span>(a[<span class="number">0</span>])</span><br><span class="line">        num2 = <span class="built_in">int</span>(a[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">p_q = leak % num1</span><br><span class="line">pplusq = iroot(p_q**<span class="number">2</span>+<span class="number">4</span>*N,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">p = (p_q + pplusq) // <span class="number">2</span></span><br><span class="line">q = N // p</span><br><span class="line">d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(ct,d,N) - num2)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;ISEC-WeMu5tKe2pOn_70in5And#N3Ver@G1veUp!&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="Vigenere2S"><a href="#Vigenere2S" class="headerlink" title="Vigenere2S"></a>Vigenere2S</h3><p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># python2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.path.append(<span class="string">&quot;..&quot;</span>) </span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> key,flag2 <span class="keyword">as</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_l</span>(<span class="params">idx, s</span>):</span><br><span class="line">    <span class="keyword">return</span> s[idx:] + s[:idx]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mainProc</span>(<span class="params">p, k1, k2</span>):</span><br><span class="line">    s = <span class="string">b&quot;abcd07efghij89klmnopqr16stuvwxyz-_&#123;&#125;ABCDEFGHIJKL34MNOPQRST25VWXYZ&quot;</span></span><br><span class="line">    t = [[_l((i+j)%<span class="built_in">len</span>(s), s) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s))] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s))]</span><br><span class="line">    i1 = <span class="number">0</span></span><br><span class="line">    i2 = <span class="number">0</span></span><br><span class="line">    c = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> p:</span><br><span class="line">        c += t[s.find(a)][s.find(k1[i1])][s.find(k2[i2])]</span><br><span class="line">        i1 = (i1 + <span class="number">1</span>) % <span class="built_in">len</span>(k1)</span><br><span class="line">        i2 = (i2 + <span class="number">1</span>) % <span class="built_in">len</span>(k2)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line">res = mainProc(flag,key,key[::-<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment">#6JnsNxHKJ8mkvhS&#123;rMO_c9apMfHDHObq80PMu&#123;_ww_r&#123;rq</span></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®åæš—ç¤ºæ˜¯ä¸€ç§å˜ç§ç»´å‰å°¼äºšï¼Œä¸è¿‡å…¶å®ä»”ç»†çœ‹ä¼šå‘ç°å˜äº†ä¸ªå¯‚å¯ã€‚</p>
<p>é¦–å…ˆè¦å‘ç°ï¼Œtè¡¨æ˜¯èƒ½ç¡®å®šçš„ï¼Œé‡è¦çš„åœ¨äºè¿™ä¸ªåŠ å¯†è¿‡ç¨‹æ€ä¹ˆå»ç†è§£ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c += t[s.find(a)][s.find(k1[i1])][s.find(k2[i2])]</span><br></pre></td></tr></table></figure>
<p>ä¸è¦è¢«è¿™ä¸ªä¸‰é‡è¡¨å“åˆ°äº†ï¼Œå…¶å®ä¸‰å±‚ä½œç”¨ä¸€æ¨¡ä¸€æ ·ï¼Œéƒ½æ˜¯å°†ç è¡¨å³ç§»è¯¥å­—ç¬¦åœ¨ç è¡¨ä¸­å¯¹åº”ä½ç½®çš„ä½æ•°ï¼å†æ¥å¤šå°‘å±‚éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p>
<p>ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿæ¯”å¦‚è¯´ï¼Œå½“å‰æ˜æ–‡å­—ç¬¦ä¸ºâ€fâ€ï¼Œåœ¨sä¸­ä¸‹æ ‡ä¸º7ï¼Œå‡è®¾k1[i1]å½“å‰ä¸ºâ€aâ€ï¼Œk2[i2]å½“å‰ä¸ºâ€bâ€ï¼Œä¸‹æ ‡åˆ†åˆ«æ˜¯0ã€1ï¼Œé‚£å…¶å®åŠ å¯†è¿‡ç¨‹åšçš„äº‹æƒ…ï¼Œå°±æ˜¯æ‰¾sä¸­ï¼Œä¸‹æ ‡ä¸º(7+0+1)çš„å­—ç¬¦ä½œä¸ºå¯†æ–‡å­—ç¬¦ã€‚å½“ç„¶ï¼Œè¿™æ˜¯å¾ªç¯å³ç§»çš„ï¼Œå› æ­¤è¦æ¨¡ä¸Šsçš„é•¿åº¦65ã€‚</p>
<p>å…¶å®å¾ˆå¥½ç†è§£ï¼Œå› ä¸ºä¸‰å±‚å¾ªç¯çš„æ¯ä¸€å±‚éƒ½æ˜¯åœ¨å½“å‰ç§»åŠ¨ä½ç½®ä¸Šï¼Œå†ç›¸å¯¹ç§»åŠ¨è¯¥å­—ç¬¦åœ¨sä¸­çš„ç»å¯¹ä¸‹æ ‡ï¼Œæ³¨æ„æ˜¯åœ¨sä¸­çš„ç»å¯¹ä¸‹æ ‡ï¼</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŠ å¯†è¿‡ç¨‹å®Œå…¨ç­‰ä»·äºï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c += long_to_bytes(s[(s.find(a) + s.find(k1[i1]) + s.find(k2[i2])) % <span class="number">65</span>])</span><br></pre></td></tr></table></figure>
<p>çœ‹å‡ºæ¥äº†å—ï¼ŸæŠŠåé¢çš„ä¸¤ä¸ªå¯†é’¥ä¹‹å’Œå½“ä½œä¸€ä¸ªå®Œæ•´çš„å¯†é’¥ï¼Œé‚£ä¹ˆè¿™å…¶å®å°±æ˜¯ä¸€ä¸ªåœ¨sç è¡¨ä¸Šçš„ç»´å‰å°¼äºšåŠ å¯†ã€‚</p>
<p>è€Œæˆ‘ä»¬ç°åœ¨å·²ç»æœ‰äº†flagå¤´â€flag{ISEC-}â€ï¼Œå…±åä¸ªå­—ç¬¦ï¼Œå’Œå¯†æ–‡ç›¸å‡å°±èƒ½å¾—åˆ°åä¸ªå¯†é’¥å’Œï¼Œæ¥ä¸‹æ¥çš„ä¸€ç‚¹ä¹Ÿå¾ˆé‡è¦ï¼šæˆ‘ä»¬åªéœ€è¦å¯†é’¥å’Œï¼Œè€Œä¸éœ€è¦ä¸¤ä¸ªå¯†é’¥åˆ†åˆ«çš„å€¼ã€‚</p>
<p>è€Œå¯†é’¥å’Œæ˜¯é¦–å°¾ç›¸åŠ çš„ï¼Œé‚£ä¹ˆå‡è®¾å¯†é’¥é•¿åº¦ä¸º10ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p>
<p>å¾ˆæ˜¾ç„¶ï¼Œå¯†é’¥å’Œçš„å‰äº”ä¸ªä¼šå’Œåäº”ä¸ªå‘ˆå¯¹ç§°å½¢å¼ã€‚è¿™æ˜¯å› ä¸ºç¬¬ä¸€ä¸ªå¯†é’¥å’Œç”±å¯†é’¥çš„ç¬¬1ã€10ä¸ªå­—ç¬¦ç›¸åŠ å¾—åˆ°ï¼Œç¬¬äºŒä¸ªå¯†é’¥å’Œç”±ç¬¬2ã€9ä¸ªå­—ç¬¦ç›¸åŠ å¾—åˆ°ï¼Œè€Œä½ èƒ½æƒ³åˆ°ï¼Œåˆ°ç¬¬å…­ä¸ªå¯†é’¥å’Œï¼Œä»–å°±ä¼šå’Œç¬¬äº”ä¸ªäº§ç”Ÿé‡å¤ï¼Œè€Œè¿™ç§é‡å¤æ˜¯æˆ‘ä»¬èƒ½çœ‹å‡ºæ¥çš„ã€‚</p>
<p>è€Œå®é™…ä¸Šç›¸å‡ï¼Œå¾—åˆ°çš„å‰åä¸ªå¯†é’¥å’Œåºåˆ—å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[16, 30, 17, 16, 17, 50, 52, 6, 7, 45]</span><br></pre></td></tr></table></figure>
<p>å¹¶æ²¡æœ‰äº§ç”Ÿå¯¹ç§°ï¼Œè¿™è¯´æ˜ä»€ä¹ˆå‘¢ï¼Ÿè¿™è¯´æ˜å¯†é’¥é•¿åº¦è‡³å°‘ä¸º19åŠä»¥ä¸Š(ä¸ºä»€ä¹ˆèƒ½æ˜¯19ä¹Ÿå¾ˆå¥½æƒ³é€š)ï¼Œé‚£å‡è®¾å¯†é’¥é•¿åº¦ä¸º19ï¼Œæˆ‘ä»¬å°±èƒ½å¾—åˆ°å®Œæ•´çš„å¯†é’¥å’Œåºåˆ—ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[16, 30, 17, 16, 17, 50, 52, 6, 7, 45, 7, 6, 52, 50, 17, 16, 17, 30, 16]</span><br></pre></td></tr></table></figure>
<p>ç„¶åæ‹¿å»è§£å¯†(è§£å¯†å°±æ˜¯ç›¸åº”çš„å‡å»å¯¹åº”å¯†é’¥å’Œ)ï¼Œå‘ç°å¹¶ä¸æ­£ç¡®ï¼Œé‚£å°±é‡æ–°è¯•å¯†é’¥é•¿åº¦ä¸º20ï¼Œå°±èƒ½å¾—åˆ°æ­£ç¡®flagã€‚</p>
<p>å½“ç„¶å¦‚æœè¿˜ä¸è¡Œï¼Œå°±å¾—ç»§ç»­å¾€ä¸‹çˆ†ç ´ï¼Œä½†ç”±äºå¯†é’¥å’Œçš„å¯¹ç§°æ€§ï¼Œå¯†é’¥é•¿åº¦å³ä½¿åˆ°30å·¦å³ï¼Œä¹Ÿæ˜¯å¯ä»¥æ¥å—çš„çˆ†ç ´èŒƒå›´(å› ä¸ºåªéœ€è¦çˆ†ç ´å‡ ä¸ªæœªçŸ¥çš„å¯¹ç§°çš„å¯†é’¥å’Œï¼Œè€Œéå¯†é’¥æœ¬èº«)ï¼Œä¹Ÿæ˜¯å¯ä»¥å®ç°çš„ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_l</span>(<span class="params">idx, s</span>):</span><br><span class="line">    <span class="keyword">return</span> s[idx:] + s[:idx]</span><br><span class="line"></span><br><span class="line"><span class="comment">#length = 65</span></span><br><span class="line">s = <span class="string">b&quot;abcd07efghij89klmnopqr16stuvwxyz-_&#123;&#125;ABCDEFGHIJKL34MNOPQRST25VWXYZ&quot;</span></span><br><span class="line">temp = <span class="string">b&quot;&quot;</span></span><br><span class="line">t = [[_l((i+j)%<span class="built_in">len</span>(s), s) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s))] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s))]</span><br><span class="line"></span><br><span class="line">c = <span class="string">b&quot;6JnsNxHKJ8mkvhS&#123;rMO_c9apMfHDHObq80PMu&#123;_ww_r&#123;rq&quot;</span></span><br><span class="line">tt1 = [s.find(i) <span class="keyword">for</span> i <span class="keyword">in</span> c]</span><br><span class="line">m = <span class="string">b&quot;flag&#123;ISEC-&quot;</span></span><br><span class="line">tt2 = [s.find(i) <span class="keyword">for</span> i <span class="keyword">in</span> m]</span><br><span class="line"></span><br><span class="line">k = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tt2)):</span><br><span class="line">    k.append((tt1[i] - tt2[i]) % <span class="number">65</span>)</span><br><span class="line">k = k + k[::-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(s[(s.find(c[i]) - k[i%<span class="built_in">len</span>(k)]) % <span class="number">65</span>]),end = <span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;ISEC-Afr1en7_1nN33d_1S_Afr9end_ind88d0o0&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="Stream"><a href="#Stream" class="headerlink" title="Stream"></a>Stream</h3><p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#python2</span></span><br><span class="line"><span class="keyword">import</span> sys </span><br><span class="line">sys.path.append(<span class="string">&quot;..&quot;</span>) </span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> Encode_Base64,plain,flag3 <span class="keyword">as</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">&quot;flag&#123;ISEC-&quot;</span>)</span><br><span class="line"><span class="keyword">assert</span> flag.endswith(<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag)==<span class="number">32</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr</span>(<span class="params">R,mask</span>):</span><br><span class="line">    output = (R &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xfffffff</span></span><br><span class="line">    i = (R&amp;mask)&amp;<span class="number">0xfffffff</span></span><br><span class="line">    lastbit = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i!=<span class="number">0</span>:</span><br><span class="line">        lastbit ^= (i&amp;<span class="number">1</span>)</span><br><span class="line">        i = i&gt;&gt;<span class="number">1</span></span><br><span class="line">    output ^= lastbit</span><br><span class="line">    <span class="keyword">return</span> (output,lastbit)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">single_round</span>(<span class="params">R1,R1_mask,R2,R2_mask,R3,R3_mask</span>):</span><br><span class="line">    (R1_NEW,x1) = lfsr(R1,R1_mask)</span><br><span class="line">    (R2_NEW,x2) = lfsr(R2,R2_mask)</span><br><span class="line">    (R3_NEW,x3) = lfsr(R3,R3_mask)</span><br><span class="line">    <span class="keyword">return</span> (R1_NEW,R2_NEW,R3_NEW,(x1*x2)^((x2^<span class="number">1</span>)*x3))</span><br><span class="line"></span><br><span class="line">R1=<span class="built_in">int</span>(flag[<span class="number">10</span>:<span class="number">16</span>],<span class="number">16</span>)</span><br><span class="line">R2=<span class="built_in">int</span>(flag[<span class="number">16</span>:<span class="number">25</span>],<span class="number">16</span>)</span><br><span class="line">R3=<span class="built_in">int</span>(flag[<span class="number">25</span>:<span class="number">31</span>],<span class="number">16</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(R1)[<span class="number">2</span>:])==<span class="number">19</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(R2)[<span class="number">2</span>:])==<span class="number">26</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(R3)[<span class="number">2</span>:])==<span class="number">21</span></span><br><span class="line">R1_mask = <span class="number">0x4100c</span></span><br><span class="line">R2_mask = <span class="number">0x2000023</span></span><br><span class="line">R3_mask = <span class="number">0x100002</span></span><br><span class="line"></span><br><span class="line">tmp1kb = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    tmp=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        (R1,R2,R3,out)=single_round(R1,R1_mask,R2,R2_mask,R3,R3_mask)</span><br><span class="line">        tmp = (tmp &lt;&lt; <span class="number">1</span>) ^ out</span><br><span class="line">    tmp1kb += <span class="built_in">chr</span>(tmp)</span><br><span class="line"></span><br><span class="line">encode1 = Encode_Base64(plain)</span><br><span class="line">encode2 = Encode_Base64(tmp1kb)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;result.txt&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">&quot;plain:  &quot;</span> + plain + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">&quot;EnText: &quot;</span> + encode1 + <span class="string">&quot;\n\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">&quot;CipherText:\n&quot;</span> + encode2)</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¾“å‡ºï¼š</span></span><br><span class="line">plain:  I Try <span class="keyword">not</span> to become a man of success but rather <span class="keyword">try</span> to become a man of value.</span><br><span class="line">EnText: rrgtYXkcVD91HCqvHBIFSN9pTrgdHB2dVegvTegzZRKjToKzHBI2ZhgxSoqEToHcZCI7HCqvHBIFSN9pTrgdHB2dVegvTegNSRW2Tr6=</span><br><span class="line"></span><br><span class="line">CipherText:</span><br><span class="line">AqMY/UnTRJnJk1iwDQrJ/ahALlOcA8Qp5AEgmJjNyffSdoN2i7SLpOiAYlC+CEDfEXJCfng5CogfXQ5sJjEg0CtIHvDaeBh/qkaZlGWjJVC50MCJ9o5I3gdlUrS8yinnfaxbwP==</span><br></pre></td></tr></table></figure>
<p>æ¢³ç†ä¸€ä¸‹é¢˜ç›®åŠ å¯†æµç¨‹ï¼š</p>
<ul>
<li>ä»secretä¸­å¯¼å…¥flagä¸²ã€plainä»¥åŠä¸€ä¸ªè‡ªå®šä¹‰çš„base64åŠ å¯†</li>
<li>å°†é¢˜ç›®ä¸­çš„flagä¸²å»é™¤é¦–å°¾ï¼Œå¹¶æ‹†åˆ†ä¸ºä¸‰èŠ‚ï¼Œä½œä¸ºä¸‰ä¸ªä¸åŒLFSRçš„æµå¯†é’¥ç§å­</li>
<li>å°†ä¸‰ä¸ªLFSRç»“åˆï¼Œç”Ÿæˆä¸€æ®µé•¿åº¦ä¸º800æ¯”ç‰¹ä½çš„å¯†æ–‡(å¦‚ä½•ç»“åˆçš„ä¸€ä¼šå„¿ä¼šå±•å¼€è¯´ä¸€ä¸‹)ã€‚ç„¶åå°†è¿™æ®µå¯†æ–‡ç”¨è‡ªå®šä¹‰çš„base64åŠ å¯†ï¼Œå¹¶ç»™å‡ºå¯†æ–‡</li>
<li>åŒæ—¶ï¼Œç»™å‡ºäº†ä¸€æ®µå·²çŸ¥æ˜æ–‡çš„è‡ªå®šä¹‰base64åŠ å¯†ç»“æœ</li>
</ul>
<p>é‚£ä¹ˆè¯¥æ€ä¹ˆè¿˜åŸflagä¸²å‘¢ï¼Ÿé¦–å…ˆçŸ¥é“ï¼Œflagä¸²è¢«æ‹†åˆ†æˆä¸‰æ®µï¼Œä½œä¸ºä¸‰ä¸ªLFSRçš„ç§å­ï¼Œé‚£ä¹ˆè¦æƒ³é€šè¿‡LFSRæ¢å¤è¿™äº›ç§å­ï¼Œå°±è¦å…ˆçŸ¥é“LFSRçš„å¯†æ–‡ï¼Œä¹Ÿå°±æ˜¯å…ˆè§£å†³è‡ªå®šä¹‰çš„base64ï¼ŒæŠŠCiphertextæ®µè¿˜åŸå›åŸæ¯”ç‰¹ä¸²ã€‚</p>
<p>é‚£ä¹ˆæ¥ä¸‹æ¥å¼€å§‹é¢˜ç›®åˆ†æï¼š</p>
<h4 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h4><p>é¢˜ç›®ç»™äº†ä¸€æ®µæ˜æ–‡plainï¼Œå¦‚æœæ­£å¸¸è¿›è¡Œbase64åŠ å¯†ï¼Œç»“æœå¦‚ä¸‹é¢ç¬¬ä¸€è¡Œï¼Œç¬¬äºŒè¡Œæ˜¯é¢˜ç›®è‡ªå®šä¹‰çš„base64åŠ å¯†ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SSBUcnkgbm90IHRvIGJlY29tZSBhIG1hbiBvZiBzdWNjZXNzIGJ1dCByYXRoZXIgdHJ5IHRvIGJlY29tZSBhIG1hbiBvZiB2YWx1ZS4=</span><br><span class="line">rrgtYXkcVD91HCqvHBIFSN9pTrgdHB2dVegvTegzZRKjToKzHBI2ZhgxSoqEToHcZCI7HCqvHBIFSN9pTrgdHB2dVegvTegNSRW2Tr6=</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡ºï¼Œå®é™…ä¸Šæ˜¯è¿›è¡Œäº†ä¸€æ¬¡å•è¡¨ä»£æ¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ‰“å°å‡ºæ­£å¸¸base64è¡¨ä¸è‡ªå®šä¹‰base64è¡¨çš„å¯¹åº”å…³ç³»ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=</span><br><span class="line">*gh***BCHI***K***qr*t*RoST*VYZ**cdejkFDXE****p*v*Wxz12N*67***9**=</span><br></pre></td></tr></table></figure>
<p>æ˜Ÿå·ä»£è¡¨è¯¥å­—ç¬¦æ— æ³•é€šè¿‡å·²çŸ¥çš„æ˜å¯†æ–‡å¯¹è¿›è¡Œå¯¹åº”ï¼Œè¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬ä¸€å…±æ‰¾å‡ºäº†38ç»„å¯¹åº”å…³ç³»ã€‚ç„¶è€Œï¼Œç»™å‡ºçš„Ciphertextæœ‰59ç§ä¸åŒå­—ç¬¦ï¼Œå› æ­¤æˆ‘ä»¬å·²çŸ¥çš„æ˜å¯†æ–‡å¯¹å…³ç³»å®Œå…¨ä¸å¤Ÿæˆ‘ä»¬è¿˜åŸCiphertextï¼Œå¹¶ä¸”çˆ†ç ´çš„å¤æ‚åº¦ä¹Ÿæ˜¯ä¸å¯æ¥å—çš„ã€‚é‚£ä¹ˆè¯¥æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ</p>
<p>base64çš„åˆ†æå°±å…ˆåˆ°è¿™é‡Œï¼Œä¸€ä¼šå„¿ä¼šæ¥ç€è¯´ã€‚</p>
<h4 id="LFSR"><a href="#LFSR" class="headerlink" title="LFSR"></a>LFSR</h4><p>é¢˜ç›®ä¸­ï¼Œç”±ä¸‰ä¸ªä¸åŒçš„æ©ç maskï¼Œå®šä¹‰äº†ä¸‰ä¸ªä¸åŒçš„LFSRï¼Œå…·ä½“æ¥è¯´ï¼Œä¸‰ä¸ªLFSRå¯ä»¥å†™ä½œï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#LFSR</span></span><br><span class="line">R1_mask = <span class="number">0x4100c</span></span><br><span class="line">R2_mask = <span class="number">0x2000023</span></span><br><span class="line">R3_mask = <span class="number">0x100002</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr1</span>(<span class="params">R</span>):</span><br><span class="line">    <span class="keyword">return</span> ((R &gt;&gt; <span class="number">2</span>) &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">3</span>) &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">12</span>) &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">18</span>) &amp; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr2</span>(<span class="params">R</span>):</span><br><span class="line">    <span class="keyword">return</span> (R &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">1</span>) &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">5</span>) &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">25</span>) &amp; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr3</span>(<span class="params">R</span>):</span><br><span class="line">    <span class="keyword">return</span> ((R &gt;&gt; <span class="number">1</span>) &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">20</span>) &amp; <span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>è€Œå¯†æ–‡çš„æ¯”ç‰¹ä¸²æµæ˜¯æ€ä¹ˆäº§ç”Ÿçš„å‘¢ï¼Ÿæ¯ä¸€ä¸ªå¯†æ–‡æ¯”ç‰¹ä½ciï¼Œéƒ½éœ€è¦ä¸‰ä¸ªLFSRåˆ†åˆ«ç”Ÿæˆä¸€ä½æ¯”ç‰¹ä½ï¼Œåˆ†åˆ«è®°ä½œx1,x2,x3ï¼Œç„¶åciå°±ç”±å¦‚ä¸‹æ–¹å¼äº§ç”Ÿï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ci = (x1*x2)^((x2^<span class="number">1</span>)*x3)</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸‰ä¸ªLFSRåœ¨åŒæ—¶è¿›è¡Œé€’æ¨ï¼Œç”Ÿæˆè‡ªå·±çš„æ–°çš„æ¯”ç‰¹ä½ï¼Œä½†æ˜¯å¯†æ–‡æ˜¯ç”±ä¸‰ä¸ªLFSRçš„å„è‡ªçš„æ–°çš„æ¯”ç‰¹ä½ï¼Œç”¨ä¸Šè¿°æ–¹å¼ç”Ÿæˆçš„ã€‚</p>
<p>é‚£ä¹ˆå¦‚æœå·²çŸ¥å¯†æ–‡æµï¼Œå¦‚ä½•è¿˜åŸä¸‰ä¸ªç§å­å‘¢ï¼Ÿz3å¯ä»¥ç›´æ¥æå®šï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr1</span>(<span class="params">R</span>):</span><br><span class="line">    <span class="keyword">return</span> ((R &gt;&gt; <span class="number">2</span>) &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">3</span>) &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">12</span>) &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">18</span>) &amp; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr2</span>(<span class="params">R</span>):</span><br><span class="line">    <span class="keyword">return</span> (R &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">1</span>) &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">5</span>) &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">25</span>) &amp; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr3</span>(<span class="params">R</span>):</span><br><span class="line">    <span class="keyword">return</span> ((R &gt;&gt; <span class="number">1</span>) &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">20</span>) &amp; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">z3_sol</span>():</span><br><span class="line">    R1 = BitVec(<span class="string">&#x27;R1&#x27;</span>,<span class="number">28</span>)</span><br><span class="line">    R2 = BitVec(<span class="string">&#x27;R2&#x27;</span>,<span class="number">28</span>)</span><br><span class="line">    R3 = BitVec(<span class="string">&#x27;R3&#x27;</span>,<span class="number">28</span>)</span><br><span class="line">    sol = Solver()</span><br><span class="line">    sol.add(R1 &gt;&gt; <span class="number">18</span> == <span class="number">1</span>)</span><br><span class="line">    sol.add(R2 &gt;&gt; <span class="number">25</span> == <span class="number">1</span>)</span><br><span class="line">    sol.add(R3 &gt;&gt; <span class="number">20</span> == <span class="number">1</span>)    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200</span>):</span><br><span class="line">        sol.add((lfsr1(R1)*lfsr2(R2))^((lfsr2(R2)^<span class="number">1</span>)*lfsr3(R3)) == cipher[i])</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)</span><br><span class="line">    <span class="keyword">if</span>(sol.check() == sat):</span><br><span class="line">        <span class="built_in">print</span>(sol.model())</span><br><span class="line"></span><br><span class="line">z3_sol()</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥è‡ªå·±ç”Ÿæˆå‡ ç»„æ•°æ®éªŒè¯ä¸€ä¸‹ï¼Œæ¯”å¦‚æˆ‘è¿™é‡Œé€‰å®š R1 = 373763; R2 = 62865560; R3 = 1502599ï¼Œæ»¡è¶³é¢˜ç›®è¦æ±‚ï¼Œç„¶åç”¨é¢˜ç›®ç»™çš„åŠ å¯†å‡½æ•°è¿›è¡ŒåŠ å¯†(ä¸è¿›è¡Œbase64æ¢è¡¨)ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#python2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr</span>(<span class="params">R,mask</span>):</span><br><span class="line">    output = (R &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xfffffff</span></span><br><span class="line">    i = (R&amp;mask)&amp;<span class="number">0xfffffff</span></span><br><span class="line">    lastbit = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i!=<span class="number">0</span>:</span><br><span class="line">        lastbit ^= (i&amp;<span class="number">1</span>)</span><br><span class="line">        i = i&gt;&gt;<span class="number">1</span></span><br><span class="line">    output ^= lastbit</span><br><span class="line">    <span class="keyword">return</span> (output,lastbit)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">single_round</span>(<span class="params">R1,R1_mask,R2,R2_mask,R3,R3_mask</span>):</span><br><span class="line">    (R1_NEW,x1) = lfsr(R1,R1_mask)</span><br><span class="line">    (R2_NEW,x2) = lfsr(R2,R2_mask)</span><br><span class="line">    (R3_NEW,x3) = lfsr(R3,R3_mask)</span><br><span class="line">    <span class="keyword">return</span> (R1_NEW,R2_NEW,R3_NEW,(x1*x2)^((x2^<span class="number">1</span>)*x3))</span><br><span class="line"></span><br><span class="line">R2 = <span class="number">62865560</span>; R1 = <span class="number">373763</span>; R3 = <span class="number">1502599</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(R1)[<span class="number">2</span>:])==<span class="number">19</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(R2)[<span class="number">2</span>:])==<span class="number">26</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(R3)[<span class="number">2</span>:])==<span class="number">21</span></span><br><span class="line">R1_mask = <span class="number">0x4100c</span></span><br><span class="line">R2_mask = <span class="number">0x2000023</span></span><br><span class="line">R3_mask = <span class="number">0x100002</span></span><br><span class="line"></span><br><span class="line">tmp1kb = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    tmp=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        (R1,R2,R3,out)=single_round(R1,R1_mask,R2,R2_mask,R3,R3_mask)</span><br><span class="line">        tmp = (tmp &lt;&lt; <span class="number">1</span>) ^ out</span><br><span class="line">    tmp1kb += <span class="built_in">str</span>(<span class="built_in">bin</span>(tmp)[<span class="number">2</span>:].zfill(<span class="number">8</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(tmp1kb)</span><br></pre></td></tr></table></figure>
<p>ç„¶åè¯•è¯•åˆšæ‰å†™çš„è§£å¯†å‡½æ•°ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç”¨ä»–ç»™çš„LFSRï¼Œå°†R1ã€R2ã€R3åŠ å¯†å¾—åˆ°çš„äºŒè¿›åˆ¶ä¸²</span></span><br><span class="line">cipher = <span class="string">&quot;01101100011100101001001011010010110101011100110010101000100001011100100010010011011001111010000010100011110011110010111110111110001111000110001100010010010001111000010111101001111010011100100100010110110110101100000000101010010100110111101101001000001111001110001011011111001011010011010111010100110011011111000011000111011100010100011110001101111100111100010110000010100010111111101100101011001010010101010011100101110010001000000110010101101010101110011101101001001010110100001111100000101011111010011001110011001100000110100010111001111101100111101111111101110010101000010110100111110010010001110000110000110111110101111000001111001001111111100000010001101011010110000111010110101010001100010001010000101101110101011010010011000100100010111011100101111010111101000110011000001110111011111110100101&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr1</span>(<span class="params">R</span>):</span><br><span class="line">    <span class="keyword">return</span> ((R &gt;&gt; <span class="number">2</span>) &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">3</span>) &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">12</span>) &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">18</span>) &amp; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr2</span>(<span class="params">R</span>):</span><br><span class="line">    <span class="keyword">return</span> (R &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">1</span>) &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">5</span>) &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">25</span>) &amp; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr3</span>(<span class="params">R</span>):</span><br><span class="line">    <span class="keyword">return</span> ((R &gt;&gt; <span class="number">1</span>) &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">20</span>) &amp; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">z3_sol</span>():</span><br><span class="line">    R1 = BitVec(<span class="string">&#x27;R1&#x27;</span>,<span class="number">28</span>)</span><br><span class="line">    R2 = BitVec(<span class="string">&#x27;R2&#x27;</span>,<span class="number">28</span>)</span><br><span class="line">    R3 = BitVec(<span class="string">&#x27;R3&#x27;</span>,<span class="number">28</span>)</span><br><span class="line">    sol = Solver()</span><br><span class="line">    sol.add(R1 &gt;&gt; <span class="number">18</span> == <span class="number">1</span>)</span><br><span class="line">    sol.add(R2 &gt;&gt; <span class="number">25</span> == <span class="number">1</span>)</span><br><span class="line">    sol.add(R3 &gt;&gt; <span class="number">20</span> == <span class="number">1</span>)    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200</span>):</span><br><span class="line">        sol.add((lfsr1(R1)*lfsr2(R2))^((lfsr2(R2)^<span class="number">1</span>)*lfsr3(R3)) == cipher[i])</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)</span><br><span class="line">    <span class="keyword">if</span>(sol.check() == sat):</span><br><span class="line">        <span class="built_in">print</span>(sol.model())</span><br><span class="line"></span><br><span class="line">z3_sol()</span><br></pre></td></tr></table></figure>
<p>ä½ ä¼šå‘ç°ç¡®å®å¯ä»¥æ­£ç¡®è§£å¯†ï¼Œé‚£ä¹ˆLFSRçš„è¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬å°±è§£å†³äº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦æˆ‘ä»¬èƒ½å¾—åˆ°å¯†æ–‡æµï¼Œæˆ‘ä»¬å°±èƒ½ç”¨z3è¿˜åŸå‡ºæ˜æ–‡ã€‚</p>
<p>é‚£ä¹ˆåˆå›åˆ°äº†åˆšæ‰çš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯å¦‚ä½•è§£å†³æ¢è¡¨çš„base64ã€‚</p>
<h4 id="ç»¼åˆåˆ†æ"><a href="#ç»¼åˆåˆ†æ" class="headerlink" title="ç»¼åˆåˆ†æ"></a>ç»¼åˆåˆ†æ</h4><p>å®é™…ä¸Šï¼Œä»”ç»†çœ‹åˆšæ‰çš„LFSRè§£å¯†å‡½æ•°ï¼Œä½ å¯ä»¥å‘ç°ï¼Œå®ƒå®é™…ä¸Šåªä½¿ç”¨äº†å¯†æ–‡çš„ä¸¤ç™¾ä¸ªæ¯”ç‰¹ä½å°±èƒ½å®Œå…¨æ­£ç¡®çš„è§£å¯†ã€‚è€Œä¸ç®¡base64æ¢ä¸æ¢è¡¨ï¼Œå…¶ä¸€ä¸ªå­—ç¬¦éƒ½å¯¹åº”6æ¯”ç‰¹ä½ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç»™å®šçš„Ciphertextè¿œè¿œè¶…è¿‡äº†æˆ‘ä»¬éœ€è¦çš„æ•°é‡ï¼Œæ‰€ä»¥æˆ‘ä»¬å…¶å®å¹¶ä¸éœ€è¦å®Œå…¨è¿˜åŸCiphertextï¼Œåªéœ€è¦å‰ä¸€éƒ¨åˆ†å°±å¥½äº†ã€‚</p>
<p>ä½†å…¶å®ç»è¿‡æˆ‘çš„æµ‹è¯•ï¼Œéƒ½ä¸éœ€è¦200æ¯”ç‰¹ä½ï¼Œå®é™…ä¸Šåªè¦æœ‰78ä¸ªå¯†æ–‡æ¯”ç‰¹ä½ï¼Œå°±èƒ½å¾ˆç²¾ç¡®åœ°è¿˜åŸå‡ºä¸‰ä¸ªç§å­ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åªéœ€è¦è¿˜åŸCiphertextå…¶ä¸­çš„13ä¸ªbase64å­—ç¬¦å°±èƒ½åæ¨å‡ºç§å­ï¼Œè¿™å°±åˆå¾ˆå¤§ç¨‹åº¦å‡å°‘äº†å·¥ä½œé‡ã€‚æˆ‘ä»¬æŠŠCiphertextå‰é¢ä¸€å°æ®µä¸­å·²çŸ¥çš„æ¢è¡¨ç»™ä»£æ¢å›å»ï¼ŒæœªçŸ¥çš„ç”¨æ˜Ÿå·è¡¨ç¤ºï¼Œå¯ä»¥å‘ç°ä»–é•¿è¿™æ ·ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">*R*c***ZW***k0**m*S***C****g***t**oB</span><br></pre></td></tr></table></figure>
<p>å¦‚ä½•å¤„ç†å‘¢ï¼Ÿå…¶å®æˆ‘ä»¬ç›´æ¥æŠŠæœªçŸ¥çš„è·³è¿‡ï¼Œåªæ·»åŠ ç¡®å®šéƒ¨åˆ†ä½œä¸ºçº¦æŸå°±å¥½äº†ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">z3_sol</span>(<span class="params">cipher</span>):</span><br><span class="line">    R1 = BitVec(<span class="string">&#x27;R1&#x27;</span>,<span class="number">28</span>)</span><br><span class="line">    R2 = BitVec(<span class="string">&#x27;R2&#x27;</span>,<span class="number">28</span>)</span><br><span class="line">    R3 = BitVec(<span class="string">&#x27;R3&#x27;</span>,<span class="number">28</span>)</span><br><span class="line">    sol = Solver()</span><br><span class="line">    sol.add(R1 &gt;&gt; <span class="number">18</span> == <span class="number">1</span>)</span><br><span class="line">    sol.add(R2 &gt;&gt; <span class="number">25</span> == <span class="number">1</span>)</span><br><span class="line">    sol.add(R3 &gt;&gt; <span class="number">20</span> == <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)   </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        sol.add((lfsr1(R1)*lfsr2(R2))^((lfsr2(R2)^<span class="number">1</span>)*lfsr3(R3)) == cipher[i+<span class="number">6</span>])</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)   </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        sol.add((lfsr1(R1)*lfsr2(R2))^((lfsr2(R2)^<span class="number">1</span>)*lfsr3(R3)) == cipher[i+<span class="number">18</span>])</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)   </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">        sol.add((lfsr1(R1)*lfsr2(R2))^((lfsr2(R2)^<span class="number">1</span>)*lfsr3(R3)) == cipher[i+<span class="number">42</span>])</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)   </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">        sol.add((lfsr1(R1)*lfsr2(R2))^((lfsr2(R2)^<span class="number">1</span>)*lfsr3(R3)) == cipher[i+<span class="number">72</span>])</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)   </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        sol.add((lfsr1(R1)*lfsr2(R2))^((lfsr2(R2)^<span class="number">1</span>)*lfsr3(R3)) == cipher[i+<span class="number">96</span>])</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)   </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        sol.add((lfsr1(R1)*lfsr2(R2))^((lfsr2(R2)^<span class="number">1</span>)*lfsr3(R3)) == cipher[i+<span class="number">108</span>])</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)   </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        sol.add((lfsr1(R1)*lfsr2(R2))^((lfsr2(R2)^<span class="number">1</span>)*lfsr3(R3)) == cipher[i+<span class="number">132</span>])</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">24</span>):</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)   </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        sol.add((lfsr1(R1)*lfsr2(R2))^((lfsr2(R2)^<span class="number">1</span>)*lfsr3(R3)) == cipher[i+<span class="number">162</span>])</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)   </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        sol.add((lfsr1(R1)*lfsr2(R2))^((lfsr2(R2)^<span class="number">1</span>)*lfsr3(R3)) == cipher[i+<span class="number">186</span>])</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)   </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">        sol.add((lfsr1(R1)*lfsr2(R2))^((lfsr2(R2)^<span class="number">1</span>)*lfsr3(R3)) == cipher[i+<span class="number">204</span>])</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)    </span><br><span class="line">    <span class="keyword">if</span>(sol.check() == sat):</span><br><span class="line">        <span class="built_in">print</span>(sol.model())</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å°±èƒ½æ±‚è§£å‡ºå”¯ä¸€ä¸€ç»„ç¬¦åˆè¦æ±‚çš„è§£ï¼Œä¹Ÿå°±æ˜¯ç§å­ã€‚æœ‰äº†ç§å­åï¼Œåå…­è¿›åˆ¶æ¢å¤å°±è¡Œï¼Œå½“ç„¶è¦æ³¨æ„å¡«å……çš„0ã€‚</p>
<p>ä½†æ˜¯è§£å‡ºçš„flagå¹¶ä¸æ˜¯ä¸€ä¸ªæœ‰æ„ä¹‰çš„å­—ç¬¦ä¸²ï¼Œåªæ˜¯ä¸ªåå…­è¿›åˆ¶ä¸²ï¼Œæ€ä¹ˆéªŒè¯å…¶æ­£ç¡®æ€§å‘¢ï¼Ÿå…¶å®ç®€å•ï¼ŒæŠŠæ±‚å‡ºçš„ä¸‰ä¸ªç§å­ç”¨é¢˜ç›®ç»™å®šçš„åŠ å¯†æ–¹å¼åŠ å¯†ä¸€éï¼Œç„¶åå†å°†å·²çŸ¥éƒ¨åˆ†æ¢è¡¨å³å¯ï¼ŒéªŒè¯å‡½æ•°å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr</span>(<span class="params">R,mask</span>):</span><br><span class="line">    output = (R &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xfffffff</span></span><br><span class="line">    i = (R&amp;mask)&amp;<span class="number">0xfffffff</span></span><br><span class="line">    lastbit = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i!=<span class="number">0</span>:</span><br><span class="line">        lastbit ^= (i&amp;<span class="number">1</span>)</span><br><span class="line">        i = i&gt;&gt;<span class="number">1</span></span><br><span class="line">    output ^= lastbit</span><br><span class="line">    <span class="keyword">return</span> (output,lastbit)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">single_round</span>(<span class="params">R1,R1_mask,R2,R2_mask,R3,R3_mask</span>):</span><br><span class="line">    (R1_NEW,x1) = lfsr(R1,R1_mask)</span><br><span class="line">    (R2_NEW,x2) = lfsr(R2,R2_mask)</span><br><span class="line">    (R3_NEW,x3) = lfsr(R3,R3_mask)</span><br><span class="line">    <span class="keyword">return</span> (R1_NEW,R2_NEW,R3_NEW,(x1*x2)^((x2^<span class="number">1</span>)*x3))</span><br><span class="line"></span><br><span class="line">R2 = <span class="number">49589048</span>;R1 = <span class="number">381342</span>; R3 = <span class="number">1862135</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(R1)[<span class="number">2</span>:])==<span class="number">19</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(R2)[<span class="number">2</span>:])==<span class="number">26</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(R3)[<span class="number">2</span>:])==<span class="number">21</span></span><br><span class="line">R1_mask = <span class="number">0x4100c</span></span><br><span class="line">R2_mask = <span class="number">0x2000023</span></span><br><span class="line">R3_mask = <span class="number">0x100002</span></span><br><span class="line"></span><br><span class="line">tmp1kb = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    tmp=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        (R1,R2,R3,out)=single_round(R1,R1_mask,R2,R2_mask,R3,R3_mask)</span><br><span class="line">        tmp = (tmp &lt;&lt; <span class="number">1</span>) ^ out</span><br><span class="line">    tmp1kb += <span class="built_in">str</span>(<span class="built_in">bin</span>(tmp)[<span class="number">2</span>:].zfill(<span class="number">8</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(tmp1kb)</span><br><span class="line">en_64 = <span class="string">&quot;rrgtYXkcVD91HCqvHBIFSN9pTrgdHB2dVegvTegzZRKjToKzHBI2ZhgxSoqEToHcZCI7HCqvHBIFSN9pTrgdHB2dVegvTegNSRW2Tr6=&quot;</span></span><br><span class="line">pl_64 = <span class="string">&quot;SSBUcnkgbm90IHRvIGJlY29tZSBhIG1hbiBvZiBzdWNjZXNzIGJ1dCByYXRoZXIgdHJ5IHRvIGJlY29tZSBhIG1hbiBvZiB2YWx1ZS4=&quot;</span></span><br><span class="line">dic = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(pl_64)):</span><br><span class="line">    dic[pl_64[i]] = en_64[i]</span><br><span class="line">t4ble = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tmp1kb) // <span class="number">6</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(dic[t4ble[<span class="built_in">int</span>(tmp1kb[<span class="number">6</span>*i:<span class="number">6</span>*i+<span class="number">6</span>],<span class="number">2</span>)]],end = <span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>,end = <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">tt = <span class="string">&quot;AqMY/UnTRJnJk1iwDQrJ/ahALlOcA8Qp5AEgmJjNyffSdoN2i7SLpOiAYlC+CEDfEXJCfng5CogfXQ5sJjEg0CtIHvDaeBh/qkaZlGWjJVC50MCJ9o5I3gdlUrS8yinnfaxbwP==&quot;</span></span><br><span class="line"><span class="built_in">print</span>(tt)</span><br></pre></td></tr></table></figure>
<p>ç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">*q*Y***TR***k1**D*r***h****c***p**Eg**jN***SdoN2*7S*p***Y*C*CED*EX*C**g*Cog*X****jEg*CtIHvD*eBh*qk*Z**Wj*VC***C*9o*I*gd**rS*******x**</span><br><span class="line">AqMY/UnTRJnJk1iwDQrJ/ahALlOcA8Qp5AEgmJjNyffSdoN2i7SLpOiAYlC+CEDfEXJCfng5CogfXQ5sJjEg0CtIHvDaeBh/qkaZlGWjJVC50MCJ9o5I3gdlUrS8yinnfaxbwP==</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå¯¹åº”ä½ç½®çš„æ¢è¡¨æ˜¯å®Œå…¨å¯¹çš„ä¸Šçš„ï¼ŒåŒ…æ‹¬æˆ‘ä»¬æ²¡æœ‰ç”¨åˆ°çš„ååŠéƒ¨åˆ†ï¼Œå› æ­¤flagåº”è¯¥æ˜¯æ­£ç¡®äº†ã€‚</p>
<p>å®Œæ•´expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç”¨ä»–ç»™çš„LFSRï¼Œå°†R1ã€R2ã€R3åŠ å¯†å¾—åˆ°çš„äºŒè¿›åˆ¶ä¸²</span></span><br><span class="line"><span class="comment">#cipher = &quot;01101100011100101001001011010010110101011100110010101000100001011100100010010011011001111010000010100011110011110010111110111110001111000110001100010010010001111000010111101001111010011100100100010110110110101100000000101010010100110111101101001000001111001110001011011111001011010011010111010100110011011111000011000111011100010100011110001101111100111100010110000010100010111111101100101011001010010101010011100101110010001000000110010101101010101110011101101001001010110100001111100000101011111010011001110011001100000110100010111001111101100111101111111101110010101000010110100111110010010001110000110000110111110101111000001111001001111111100000010001101011010110000111010110101010001100010001010000101101110101011010010011000100100010111011100101111010111101000110011000001110111011111110100101&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr1</span>(<span class="params">R</span>):</span><br><span class="line">    <span class="keyword">return</span> ((R &gt;&gt; <span class="number">2</span>) &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">3</span>) &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">12</span>) &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">18</span>) &amp; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr2</span>(<span class="params">R</span>):</span><br><span class="line">    <span class="keyword">return</span> (R &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">1</span>) &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">5</span>) &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">25</span>) &amp; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr3</span>(<span class="params">R</span>):</span><br><span class="line">    <span class="keyword">return</span> ((R &gt;&gt; <span class="number">1</span>) &amp; <span class="number">1</span>) ^ ((R &gt;&gt; <span class="number">20</span>) &amp; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">z3_sol</span>(<span class="params">cipher</span>):</span><br><span class="line">    R1 = BitVec(<span class="string">&#x27;R1&#x27;</span>,<span class="number">28</span>)</span><br><span class="line">    R2 = BitVec(<span class="string">&#x27;R2&#x27;</span>,<span class="number">28</span>)</span><br><span class="line">    R3 = BitVec(<span class="string">&#x27;R3&#x27;</span>,<span class="number">28</span>)</span><br><span class="line">    sol = Solver()</span><br><span class="line">    sol.add(R1 &gt;&gt; <span class="number">18</span> == <span class="number">1</span>)</span><br><span class="line">    sol.add(R2 &gt;&gt; <span class="number">25</span> == <span class="number">1</span>)</span><br><span class="line">    sol.add(R3 &gt;&gt; <span class="number">20</span> == <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)   </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        sol.add((lfsr1(R1)*lfsr2(R2))^((lfsr2(R2)^<span class="number">1</span>)*lfsr3(R3)) == cipher[i+<span class="number">6</span>])</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)   </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        sol.add((lfsr1(R1)*lfsr2(R2))^((lfsr2(R2)^<span class="number">1</span>)*lfsr3(R3)) == cipher[i+<span class="number">18</span>])</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)   </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">        sol.add((lfsr1(R1)*lfsr2(R2))^((lfsr2(R2)^<span class="number">1</span>)*lfsr3(R3)) == cipher[i+<span class="number">42</span>])</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)   </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">        sol.add((lfsr1(R1)*lfsr2(R2))^((lfsr2(R2)^<span class="number">1</span>)*lfsr3(R3)) == cipher[i+<span class="number">72</span>])</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)   </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        sol.add((lfsr1(R1)*lfsr2(R2))^((lfsr2(R2)^<span class="number">1</span>)*lfsr3(R3)) == cipher[i+<span class="number">96</span>])</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)   </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        sol.add((lfsr1(R1)*lfsr2(R2))^((lfsr2(R2)^<span class="number">1</span>)*lfsr3(R3)) == cipher[i+<span class="number">108</span>])</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)   </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        sol.add((lfsr1(R1)*lfsr2(R2))^((lfsr2(R2)^<span class="number">1</span>)*lfsr3(R3)) == cipher[i+<span class="number">132</span>])</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">24</span>):</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)   </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        sol.add((lfsr1(R1)*lfsr2(R2))^((lfsr2(R2)^<span class="number">1</span>)*lfsr3(R3)) == cipher[i+<span class="number">162</span>])</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)   </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        sol.add((lfsr1(R1)*lfsr2(R2))^((lfsr2(R2)^<span class="number">1</span>)*lfsr3(R3)) == cipher[i+<span class="number">186</span>])</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)   </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">        sol.add((lfsr1(R1)*lfsr2(R2))^((lfsr2(R2)^<span class="number">1</span>)*lfsr3(R3)) == cipher[i+<span class="number">204</span>])</span><br><span class="line">        R1 = R1 &lt;&lt; <span class="number">1</span> ^ lfsr1(R1)</span><br><span class="line">        R2 = R2 &lt;&lt; <span class="number">1</span> ^ lfsr2(R2)</span><br><span class="line">        R3 = R3 &lt;&lt; <span class="number">1</span> ^ lfsr3(R3)    </span><br><span class="line">    <span class="keyword">if</span>(sol.check() == sat):</span><br><span class="line">        <span class="built_in">print</span>(sol.model())</span><br><span class="line"></span><br><span class="line">cc = <span class="string">&quot;*R*c***ZW***k0**m*S***C****g***t**oB&quot;</span> </span><br><span class="line">t4ble = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">cipher = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> cc:</span><br><span class="line">    <span class="keyword">if</span>(k <span class="keyword">in</span> t4ble):</span><br><span class="line">        cipher += <span class="built_in">bin</span>(t4ble.index(k))[<span class="number">2</span>:].zfill(<span class="number">6</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        cipher += <span class="string">&quot;000000&quot;</span></span><br><span class="line">z3_sol(cipher)</span><br><span class="line"></span><br><span class="line"><span class="comment">#R2 = 49589048, R1 = 381342, R3 = 1862135</span></span><br><span class="line">R2 = <span class="number">49589048</span>;R1 = <span class="number">381342</span>; R3 = <span class="number">1862135</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag&#123;ISEC-&quot;</span>,end = <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;0&quot;</span> + <span class="built_in">hex</span>(R1)[<span class="number">2</span>:],end = <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;00&quot;</span> + <span class="built_in">hex</span>(R2)[<span class="number">2</span>:],end = <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(R3)[<span class="number">2</span>:],end = <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#ä»¥ä¸‹ä¸ºéªŒè¯éƒ¨åˆ†</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">def lfsr(R,mask):</span></span><br><span class="line"><span class="string">    output = (R &lt;&lt; 1) &amp; 0xfffffff</span></span><br><span class="line"><span class="string">    i = (R&amp;mask)&amp;0xfffffff</span></span><br><span class="line"><span class="string">    lastbit = 0</span></span><br><span class="line"><span class="string">    while i!=0:</span></span><br><span class="line"><span class="string">        lastbit ^= (i&amp;1)</span></span><br><span class="line"><span class="string">        i = i&gt;&gt;1</span></span><br><span class="line"><span class="string">    output ^= lastbit</span></span><br><span class="line"><span class="string">    return (output,lastbit)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">def single_round(R1,R1_mask,R2,R2_mask,R3,R3_mask):</span></span><br><span class="line"><span class="string">    (R1_NEW,x1) = lfsr(R1,R1_mask)</span></span><br><span class="line"><span class="string">    (R2_NEW,x2) = lfsr(R2,R2_mask)</span></span><br><span class="line"><span class="string">    (R3_NEW,x3) = lfsr(R3,R3_mask)</span></span><br><span class="line"><span class="string">    return (R1_NEW,R2_NEW,R3_NEW,(x1*x2)^((x2^1)*x3))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">R2 = 49589048;R1 = 381342; R3 = 1862135</span></span><br><span class="line"><span class="string">assert len(bin(R1)[2:])==19</span></span><br><span class="line"><span class="string">assert len(bin(R2)[2:])==26</span></span><br><span class="line"><span class="string">assert len(bin(R3)[2:])==21</span></span><br><span class="line"><span class="string">R1_mask = 0x4100c</span></span><br><span class="line"><span class="string">R2_mask = 0x2000023</span></span><br><span class="line"><span class="string">R3_mask = 0x100002</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">tmp1kb = &quot;&quot;</span></span><br><span class="line"><span class="string">for j in range(100):</span></span><br><span class="line"><span class="string">    tmp=0</span></span><br><span class="line"><span class="string">    for k in range(8):</span></span><br><span class="line"><span class="string">        (R1,R2,R3,out)=single_round(R1,R1_mask,R2,R2_mask,R3,R3_mask)</span></span><br><span class="line"><span class="string">        tmp = (tmp &lt;&lt; 1) ^ out</span></span><br><span class="line"><span class="string">    tmp1kb += str(bin(tmp)[2:].zfill(8))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">print(tmp1kb)</span></span><br><span class="line"><span class="string">en_64 = &quot;rrgtYXkcVD91HCqvHBIFSN9pTrgdHB2dVegvTegzZRKjToKzHBI2ZhgxSoqEToHcZCI7HCqvHBIFSN9pTrgdHB2dVegvTegNSRW2Tr6=&quot;</span></span><br><span class="line"><span class="string">pl_64 = &quot;SSBUcnkgbm90IHRvIGJlY29tZSBhIG1hbiBvZiBzdWNjZXNzIGJ1dCByYXRoZXIgdHJ5IHRvIGJlY29tZSBhIG1hbiBvZiB2YWx1ZS4=&quot;</span></span><br><span class="line"><span class="string">dic = &#123;&#125;</span></span><br><span class="line"><span class="string">for i in range(len(pl_64)):</span></span><br><span class="line"><span class="string">    dic[pl_64[i]] = en_64[i]</span></span><br><span class="line"><span class="string">t4ble = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line"><span class="string">for i in range(len(tmp1kb) // 6):</span></span><br><span class="line"><span class="string">    try:</span></span><br><span class="line"><span class="string">        print(dic[t4ble[int(tmp1kb[6*i:6*i+6],2)]],end = &quot;&quot;)</span></span><br><span class="line"><span class="string">    except:</span></span><br><span class="line"><span class="string">        print(&quot;*&quot;,end = &quot;&quot;)</span></span><br><span class="line"><span class="string">print()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">tt = &quot;AqMY/UnTRJnJk1iwDQrJ/ahALlOcA8Qp5AEgmJjNyffSdoN2i7SLpOiAYlC+CEDfEXJCfng5CogfXQ5sJjEg0CtIHvDaeBh/qkaZlGWjJVC50MCJ9o5I3gdlUrS8yinnfaxbwP==&quot;</span></span><br><span class="line"><span class="string">print(tt)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;ISEC-05d19e002f4ab381c69f7&#125;</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœå„ä½å¸ˆå‚…å‘ç°è§£æ³•ä¸­çš„é”™è¯¯ï¼Œå¯ä»¥éšæ—¶è”ç³»æˆ‘ï¼ŒåŒæ—¶å„ä½å¸ˆå‚…æœ‰å…¶ä»–ä»»ä½•é—®é¢˜ä¹Ÿæ¬¢è¿ä¸æˆ‘äº¤æµï¼</p>
<p><br></p>
<p><br></p>
]]></content>
      <categories>
        <category>wp-crypto</category>
      </categories>
  </entry>
  <entry>
    <title>2023-MoeCTF-wp-crypto</title>
    <url>/post/aa501114.html</url>
    <content><![CDATA[<p>è®°å½•Cryptoå­¦ä¹ ä¹‹è·¯</p>
<span id="more"></span>
<h2 id="Classical-Crypto"><a href="#Classical-Crypto" class="headerlink" title="Classical Crypto"></a>Classical Crypto</h2><h3 id="ezrot"><a href="#ezrot" class="headerlink" title="ezrot"></a>ezrot</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ezrot</span><br></pre></td></tr></table></figure>
<p>Hint:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">If you have no idea what kind of classical cipher this is, go to Classical Cipher entry of wikipedia for a hint</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@64E7LC@Ecf0:D0;FDE020D:&gt;!=60=6EE6C0DF3DE:EFE:@?04:!96C0tsAJdEA6d;F&#125;%0N</span><br></pre></td></tr></table></figure>
<p>rot47è§£å¯†ã€‚(ä¸çŸ¥é“ä¸ºå•¥ç¼ºäº†ä¸ªmï¼Œè¡¥ä¸Šå°±å¥½)</p>
<p><img src="/post/aa501114/image-20230917145802110.png" alt="image-20230917145802110"></p>
<p>flagï¼š</p>
<p><strong>moectf{rot47_is_just_a_simPle_letter_substitution_ciPher_EDpy5tpe5juNT_}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="å¯å¯çš„æ–°å›´å¢™"><a href="#å¯å¯çš„æ–°å›´å¢™" class="headerlink" title="å¯å¯çš„æ–°å›´å¢™"></a>å¯å¯çš„æ–°å›´å¢™</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¯å¯çš„æ–°å›´å¢™</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mt3_hsTal3yGnM_p3jocfFn3cp3_hFs3c_3TrB__i3_uBro_lcsOp&#125;e&#123;ciri_hT_avn3Fa_j</span><br></pre></td></tr></table></figure>
<p>æ …æ å¯†ç ï¼Œæ‰‹åŠ¨è°ƒæ•´ä¸€ä¸‹æ æ•°ã€‚</p>
<p><img src="/post/aa501114/image-20230917150048133.png" alt="image-20230917150048133"></p>
<p>flagï¼š</p>
<p><strong>moectf{F3nc3_ciph3r_shiFTs_3ach_l3TT3r_By_a_Giv3n_nuMB3r_oF_plac3s_Ojpj}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="çš‡å¸çš„æ–°å¯†ç "><a href="#çš‡å¸çš„æ–°å¯†ç " class="headerlink" title="çš‡å¸çš„æ–°å¯†ç "></a>çš‡å¸çš„æ–°å¯†ç </h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">çš‡å¸çš„æ–°å¯†ç </span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tvljam&#123;JhLzhL_JPwoLy_Pz_h_cLyF_zPtwPL_JPwoLy!_ZmUVUA40q5KbEQZAK5Ehag4Av&#125;</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®åå­—åœ¨æš—æŒ‡å‡¯æ’’çš‡å¸ï¼Œä½†æ˜¯å…¶å®æ˜¯ä¸ªç§»ä½ä¸º7çš„ç§»ä½å¯†ç ã€‚</p>
<p><img src="/post/aa501114/image-20230917150328337.png" alt="image-20230917150328337"></p>
<p>flagï¼š</p>
<p><strong>moectf{CaEsaE_CIphEr_Is_a_vErY_sImpIE_CIphEr!_SfNONT40j5DuXJSTD5Xatz4To}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="ä¸æ˜¯â€œçš‡å¸çš„æ–°å¯†ç â€"><a href="#ä¸æ˜¯â€œçš‡å¸çš„æ–°å¯†ç â€" class="headerlink" title="ä¸æ˜¯â€œçš‡å¸çš„æ–°å¯†ç â€"></a>ä¸æ˜¯â€œçš‡å¸çš„æ–°å¯†ç â€</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä¸æ˜¯â€œçš‡å¸çš„æ–°å¯†ç â€</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">scsfct&#123;wOuSQNfF_IWdkNf_Jy_o_zLchmK_voumSs_zvoQ_loFyof_FRdiKf_4i4x4NLgDn&#125;</span><br><span class="line"></span><br><span class="line">md5 of flag (utf-8) `ea23f80270bdd96b5fcd213cae68eea5`</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®æè¿°çœ‹ä¸Šå»åƒæ˜¯åœ¨æŒ‡å˜å¼‚å‡¯æ’’ï¼Œä¸è¿‡å› ä¸ºæ‡’ï¼Œç›´æ¥å…ˆä¸Šäº†ç»´å‰å°¼äºšå°è¯•ï¼š</p>
<p><img src="/post/aa501114/image-20230917150659188.png" alt="image-20230917150659188"></p>
<p>å¯ä»¥çœ‹å‡ºå·²ç»å‡ºäº†å¯†é’¥çš„å‰ç¼€<code>goodjo</code>ï¼Œå¯ä»¥çŒœæƒ³å¯†é’¥åº”è¯¥æ˜¯<code>goodjob</code>ï¼Œè¿›è¡Œè§£å¯†ï¼š</p>
<p><img src="/post/aa501114/image-20230917150945439.png" alt="image-20230917150945439"></p>
<p>flagï¼š</p>
<p><strong>moectf{vIgENErE_CIphEr_Is_a_lIttlE_hardEr_thaN_caEsar_CIphEr_4u4u4EXfXz}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="çŒ«è¨€å–µè¯­"><a href="#çŒ«è¨€å–µè¯­" class="headerlink" title="çŒ«è¨€å–µè¯­"></a>çŒ«è¨€å–µè¯­</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç‹—æ›°ï¼šâ€å–µå–µå–µå–µå–µï¼Ÿï¼Ÿâ€œ</span><br><span class="line">è¯·è§£å‡ºåè¯·è½¬æ¢ä¸ºå…¨å¤§å†™ï¼Œå•è¯é—´ä»¥ä¸‹åˆ’çº¿åˆ†éš”ï¼Œå¥—ä¸Šmoectf&#123;&#125;åæäº¤</span><br></pre></td></tr></table></figure>
<p>Hintï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Morse Code</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å–µå–µï¼Ÿ å–µå–µå–µå–µå–µå–µå–µå–µå–µå–µå–µå–µ å–µå–µå–µ å–µå–µå–µå–µå–µå–µå–µå–µï¼Ÿå–µå–µï¼Ÿå–µå–µå–µå–µå–µï¼Ÿ å–µå–µï¼Ÿå–µå–µå–µå–µå–µï¼Ÿ å–µå–µå–µå–µå–µï¼Ÿ å–µå–µå–µå–µå–µï¼Ÿå–µå–µï¼Ÿ å–µå–µå–µå–µå–µï¼Ÿ å–µå–µå–µå–µå–µå–µ å–µå–µå–µå–µå–µå–µ å–µå–µå–µå–µå–µå–µå–µå–µï¼Ÿå–µå–µï¼Ÿå–µå–µå–µå–µå–µï¼Ÿ å–µå–µï¼Ÿå–µå–µå–µå–µå–µï¼Ÿå–µå–µå–µ å–µå–µå–µå–µå–µï¼Ÿ å–µå–µï¼Ÿ å–µå–µå–µå–µå–µå–µå–µå–µï¼Ÿå–µå–µï¼Ÿå–µå–µå–µå–µå–µï¼Ÿ å–µå–µï¼Ÿå–µå–µå–µå–µå–µå–µå–µå–µå–µ å–µå–µå–µå–µå–µå–µå–µå–µï¼Ÿ å–µå–µï¼Ÿ å–µå–µå–µå–µå–µå–µå–µå–µï¼Ÿå–µå–µï¼Ÿå–µå–µå–µå–µå–µï¼Ÿ å–µå–µï¼Ÿå–µå–µå–µå–µå–µå–µå–µå–µå–µ å–µå–µå–µ å–µå–µå–µå–µå–µå–µå–µå–µï¼Ÿå–µå–µï¼Ÿå–µå–µå–µå–µå–µï¼Ÿ å–µå–µï¼Ÿå–µå–µå–µå–µå–µï¼Ÿå–µå–µå–µ å–µå–µå–µå–µå–µï¼Ÿ å–µå–µå–µå–µå–µï¼Ÿå–µå–µå–µå–µå–µå–µ å–µå–µå–µå–µå–µï¼Ÿå–µå–µå–µå–µå–µå–µ å–µå–µå–µ å–µå–µï¼Ÿå–µå–µå–µå–µå–µå–µ å–µå–µå–µå–µå–µå–µå–µå–µï¼Ÿå–µå–µï¼Ÿå–µå–µå–µå–µå–µï¼Ÿ å–µå–µï¼Ÿå–µå–µï¼Ÿå–µå–µå–µ å–µå–µï¼Ÿå–µå–µï¼Ÿå–µå–µï¼Ÿ å–µå–µå–µå–µå–µå–µå–µå–µï¼Ÿ å–µå–µï¼Ÿå–µå–µï¼Ÿå–µå–µå–µå–µå–µå–µ å–µå–µå–µå–µå–µå–µ å–µå–µå–µå–µå–µå–µå–µå–µï¼Ÿå–µå–µï¼Ÿå–µå–µå–µå–µå–µï¼Ÿ å–µå–µï¼Ÿå–µå–µå–µå–µå–µå–µå–µå–µå–µ å–µå–µï¼Ÿå–µå–µå–µå–µå–µï¼Ÿå–µå–µï¼Ÿ å–µå–µå–µå–µå–µå–µå–µå–µï¼Ÿå–µå–µï¼Ÿå–µå–µå–µå–µå–µï¼Ÿ å–µå–µå–µå–µå–µï¼Ÿå–µå–µå–µ å–µå–µï¼Ÿå–µå–µå–µå–µå–µå–µå–µå–µï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®æç¤ºæ‘©æ–¯ç”µç ï¼Œå› æ­¤å¤šæ¬¡å°è¯•åï¼Œå¯ä»¥å‘ç°ï¼š</p>
<ul>
<li>â€œå–µå–µå–µâ€ æ¢æˆ â€œ.â€</li>
<li>â€œå–µå–µï¼Ÿâ€ æ¢æˆ â€œ-â€œ</li>
</ul>
<p>å†ç”¨æ‘©æ–¯ç”µç è§£å¯†ï¼Œå°±èƒ½å¾—åˆ°flagã€‚</p>
<p>flagï¼š</p>
<p><strong>moectf{THE_KAWAII_CAT_BUT_BE_CALLED_GOUZI_BY_RX}</strong></p>
<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Crypto-å…¥é—¨æŒ‡åŒ—"><a href="#Crypto-å…¥é—¨æŒ‡åŒ—" class="headerlink" title="Crypto å…¥é—¨æŒ‡åŒ—"></a>Crypto å…¥é—¨æŒ‡åŒ—</h3><p>ç•¥</p>
<h3 id="baby-e"><a href="#baby-e" class="headerlink" title="baby_e"></a>baby_e</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">~~å°å°çš„ä¹Ÿå¾ˆå¯çˆ±~~</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long</span><br><span class="line"></span><br><span class="line">p,q = getPrime(<span class="number">2048</span>),getPrime(<span class="number">2048</span>)</span><br><span class="line">e = <span class="number">7</span></span><br><span class="line">n = p*q</span><br><span class="line">m = bytes_to_long(<span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read().strip())</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c = &quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n = &quot;</span>,n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># c =  147693154873835354725007152781732424355869776162377337823960431913672366269917723916891506269449726723757821517328874729037838600793748824028829185409932536014732765063216715033843955453706710187792772702199448156372644163429786386035008302836467605094954587157232829525150652611067567669525072625329634860065850520051628272535479197120008981979404760445193750864902244921407742155742716289495581989134730376783828846663464819337418977287363028738701414486788851136608957124505485242331701209645216580641917007780811842757125048746184068597664780265422321550909392419865169775282217442331295071069272774722564587602419768461231775480847018941840911357926330143045826277813722919121117172763493242590521245640828462665947672485094793188432098216701511715232654611338293295459889814699850788048985878279440740712956248569068077253790198036918598519191892836075254345518967666166925163908185663991353344555402397055977817370082929420443034626201745027965444069777059760865359310439815816749939498993014457995041394803598825093836045546578310632172636478575946653375857640993393714607308326474003446154152048840071034349831168612740218034679021240949747357214453636633636662650940968576792518622437627529244515229173</span></span><br><span class="line"><span class="comment"># n =  553409369582823237678532685244026647155180191225879439432235077135813123637186465008813830373646133388592395760175777499266561095087891764348044063111935877931069321764391883899483374576303169645488542398590564148654412004383012178107972880058460460806768779452529433458826925606225797078653905380530651390617109384086518728626571028089036812787671647095695947167204428442727185744172445701874820612799168887428075695751162763647868386879374037826876671079326544820609721731078985096813307183878793033824330869698508952853770794414757655681370862323768018291030331209143189638496644361618184164228294031490537429556439588954274708598530042700988138862000054458742762198052079867259365645914383561162796796952346445529346145323567650621600171442575319262718389389870407629339714751583360252884338116164466349449862781112019462555743429653595045695696967783338371470032332852204294900011651434678829104876529439166176589508898757122660322523937330848536715937381297551894198974459004139082562228022412335520195652419375915216074658463954339332593244483927157329404652516225481116614815221154229491846087288087715884363786672244655901308480290011237244562251084095684531716327141154558809471185132979704992609461470501119328696999713829</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡ºpã€qéƒ½å¾ˆå¤§ï¼Œnæ›´æ˜¯è¾¾åˆ°äº†4096bitï¼Œå› æ­¤mçš„æ¯”ç‰¹åªè¦å°äº<code>4096//7</code>ï¼Œå°±èƒ½å°†å¯†æ–‡ç›´æ¥å¼€æ ¹å¾—åˆ°æ˜æ–‡ã€‚äº‹å®ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">7</span></span><br><span class="line">c =  <span class="number">147693154873835354725007152781732424355869776162377337823960431913672366269917723916891506269449726723757821517328874729037838600793748824028829185409932536014732765063216715033843955453706710187792772702199448156372644163429786386035008302836467605094954587157232829525150652611067567669525072625329634860065850520051628272535479197120008981979404760445193750864902244921407742155742716289495581989134730376783828846663464819337418977287363028738701414486788851136608957124505485242331701209645216580641917007780811842757125048746184068597664780265422321550909392419865169775282217442331295071069272774722564587602419768461231775480847018941840911357926330143045826277813722919121117172763493242590521245640828462665947672485094793188432098216701511715232654611338293295459889814699850788048985878279440740712956248569068077253790198036918598519191892836075254345518967666166925163908185663991353344555402397055977817370082929420443034626201745027965444069777059760865359310439815816749939498993014457995041394803598825093836045546578310632172636478575946653375857640993393714607308326474003446154152048840071034349831168612740218034679021240949747357214453636633636662650940968576792518622437627529244515229173</span></span><br><span class="line">n =  <span class="number">553409369582823237678532685244026647155180191225879439432235077135813123637186465008813830373646133388592395760175777499266561095087891764348044063111935877931069321764391883899483374576303169645488542398590564148654412004383012178107972880058460460806768779452529433458826925606225797078653905380530651390617109384086518728626571028089036812787671647095695947167204428442727185744172445701874820612799168887428075695751162763647868386879374037826876671079326544820609721731078985096813307183878793033824330869698508952853770794414757655681370862323768018291030331209143189638496644361618184164228294031490537429556439588954274708598530042700988138862000054458742762198052079867259365645914383561162796796952346445529346145323567650621600171442575319262718389389870407629339714751583360252884338116164466349449862781112019462555743429653595045695696967783338371470032332852204294900011651434678829104876529439166176589508898757122660322523937330848536715937381297551894198974459004139082562228022412335520195652419375915216074658463954339332593244483927157329404652516225481116614815221154229491846087288087715884363786672244655901308480290011237244562251084095684531716327141154558809471185132979704992609461470501119328696999713829</span></span><br><span class="line"></span><br><span class="line">m = iroot(c,e)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>moectf{SMaLL_3xPon3nt_Mak3_rSa_w3ak!_!lP0iYlJf!M3rux9G9Vf!JoxiMl903lllA}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="bad-E"><a href="#bad-E" class="headerlink" title="bad_E"></a>bad_E</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä½ è¿™ä¸ªeæ€ä¹ˆè§£å¯†ä¸äº†å•Šï¼Œæ€ä¹ˆä¼šäº‹å‘¢ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(p) <span class="comment"># 6853495238262155391975011057929314523706159020478084061020122347902601182448091015650787022962180599741651597328364289413042032923330906135304995252477571</span></span><br><span class="line"><span class="built_in">print</span>(q) <span class="comment"># 11727544912613560398705401423145382428897876620077115390278679983274961030035884083100580422155496261311510530671232666801444557695190734596546855494472819</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> fs:</span><br><span class="line">    flag = fs.read().strip()</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag.encode())</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,p*q)</span><br><span class="line"><span class="built_in">print</span>(c) <span class="comment"># 63388263723813143290256836284084914544524440253054612802424934400854921660916379284754467427040180660945667733359330988361620691457570947823206385692232584893511398038141442606303536260023122774682805630913037113541880875125504376791939861734613177272270414287306054553288162010873808058776206524782351475805</span></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ç›´æ¥ç»™äº†pã€qï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥RSAè§£å¯†ï¼Œä½†æ˜¯å°è¯•åæŠ¥é”™ï¼Œå› ä¸ºeæ˜¯p-1çš„å› å­ï¼Œæ‰€ä»¥eåœ¨phi_nä¸‹çš„é€†å…ƒä¸å­˜åœ¨ã€‚</p>
<p>é€šå¸¸è¿™æ—¶å€™ä¼šæœ‰ä¸¤ç§æ€è·¯ï¼šAMMå’Œè½¬åŒ–åˆ°æ¨¡qä¸Šæ±‚è§£ã€‚è€ƒè™‘åˆ°è¿™åªæ˜¯ç¬¬ä¸‰é¢˜ï¼Œå¹¶ä¸”65537ç”¨äºAMMæœ‰ç‚¹è¿‡å¤§äº†ï¼Œå› æ­¤åº”è¯¥æ˜¯æ¨¡qä¸‹æ±‚è§£ã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">q = <span class="number">11727544912613560398705401423145382428897876620077115390278679983274961030035884083100580422155496261311510530671232666801444557695190734596546855494472819</span></span><br><span class="line">c = <span class="number">63388263723813143290256836284084914544524440253054612802424934400854921660916379284754467427040180660945667733359330988361620691457570947823206385692232584893511398038141442606303536260023122774682805630913037113541880875125504376791939861734613177272270414287306054553288162010873808058776206524782351475805</span></span><br><span class="line"></span><br><span class="line">d = inverse(e,q-<span class="number">1</span>)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,q)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>moectf{N0w_Y0U_hAve_kN0w_h0w_rsA_w0rks!_f!lP0iYlJf!M3ru}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="factor-signin"><a href="#factor-signin" class="headerlink" title="factor_signin"></a>factor_signin</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">åäº†ï¼Œp qè¢«ç‹—å­åƒäº†</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> prod</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = f.read().strip()</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">72</span></span><br><span class="line"></span><br><span class="line">m1 = <span class="built_in">int</span>.from_bytes(flag[:<span class="number">36</span>],<span class="string">&quot;big&quot;</span>)</span><br><span class="line">m2 = <span class="built_in">int</span>.from_bytes(flag[<span class="number">36</span>:],<span class="string">&quot;big&quot;</span>)</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">p,q = getPrime(<span class="number">2048</span>),getPrime(<span class="number">2048</span>)</span><br><span class="line">n1 = p*q</span><br><span class="line">c1 = <span class="built_in">pow</span>(m1,e,n1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c1 = &quot;</span>,c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n1 = &quot;</span>,n1)</span><br><span class="line"></span><br><span class="line">primes = [getPrime(<span class="number">64</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line">n2 = prod(primes)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2,e,n2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c2 = &quot;</span>,c2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n2 = &quot;</span>,n2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># c1 =  10004937130983861141937782436252502991050957330184611684406783226971057978666503675149401388381995491152372622456604317681236160071166819028679754762162125904637599991943368450200313304999566592294442696755822585022667008378021280392976010576970877334159755332946926433635584313137140987588847077645814987268595739733550220882135750267567373532603503399428451548677091911410732474324157868011686641243202218731844256789044721309478991918322850448456919991540932206923861653518190974620161055008847475600980152660468279765607319838003177639654115075183493029803981527882155542925959658123816315099271123470754815045214896642428657264709805029840253303446203030294879166242867850331945166255924821406218090304893024711068773287842075208409312312188560675094244318565148284432361706108491327014254387317744284876018328591380705408407853404828189643214087638328376675071962141118973835178054884474523241911240926274907256651801384433652425740230755811160476356172444327762497910600719286629420662696949923799255603628210458906831175806791599965316549386396788014703044837917283461862338269599464440202019922379625071512100821922879623930069349084917919100015782270736808388388006084027673781004085620817521378823838335749279055639005125</span></span><br><span class="line"><span class="comment"># n1 =  343504538870081878757729748260620800783581983635281373321527119223374418103340873199654926888439040391545101913132680017655039577253974802351999985470115474655124168592386965001556620077117966153475518658881140827499124290142523464795351995478153288872749817655925271395693435582010998996210909883510311066017237567799370371513462802547313382594409676803895262837061350017911885033133654781876923251129406855067993830824618637981136966134029212516871210627954762147349788788999116702635535406398258621926040887099782494271000823401788337120154104692934583729065189687995570122890809807661370008740283447636580308161498808092269041815719148127168137018600113465985504975054319601741498799761500526467431533990903047624407330243357514588557352746347337683868781554819821575385685459666842162355673947984514687068626166144076257334426612302554448774082488600083569900006274897032242821388126274957846236552373226099112200392102883351088570736254707966329366625911183721875374731791052229266503696334310835323523568132399330263642353927504971311717117370721838701629885670598853025212521537158141447625623337563164790788106598854822686494249848796441153496412236527242235888308435573209980270776407776277489669763803746640746378181948641</span></span><br><span class="line"><span class="comment"># c2 =  4948422459907576438725352912593232312182623872749480015295307088166392790756090961680588458629287353136729331282506869598853654959933189916541367579979613191505226006688017103736659670745715837820780269669982614187726024837483992949073998289744910800139692315475427811724840888983757813069849711652177078415791290894737059610056340691753379065563574279210755232749774749757141836708161854072798697882671844015773796030086898649043727563289757423417931359190238689436180953442515869613672008678717039516723747808793079592658069533269662834322438864456440701995249381880745586708718334052938634931936240736457181295</span></span><br><span class="line"><span class="comment"># n2 =  8582505375542551134698364096640878629785534004976071646505285128223700755811329156276289439920192196962008222418309136528180402357612976316670896973298407081310073283979903409463559102445223030866575563539261326076167685019121804961393115251287057504682389257841337573435085535013992761172452417731887700665115563173984357419855481847035192853387338980937451843809282267888616833734087813693242841580644645315837196205981207827105545437201799441352173638172133698491126291396194764373021523547130703629001683366722885529834956411976212381935354905525700646776572036418453784898084635925476199878640087165680193737</span></span><br></pre></td></tr></table></figure>
<p>æ²¡æœ‰åˆ«çš„ä¿¡æ¯èƒ½ç”¨äºåˆ†è§£nï¼Œé‚£ä¹ˆä¹Ÿåªæœ‰å¯èƒ½è¿™ä¸¤ä¸ªnçš„åˆ†è§£éƒ½è¢«ä¸Šä¼ åˆ°åœ¨çº¿ç½‘ç«™äº†ï¼Œä¸€ç”¨å‘ç°æœç„¶éƒ½å¯ä»¥ç›´æ¥åˆ†è§£ï¼š</p>
<p>n1ï¼š</p>
<p><img src="/post/aa501114/image-20230917152722626.png" alt="image-20230917152722626"></p>
<p>n2ï¼š</p>
<p><img src="/post/aa501114/image-20230917152642113.png" alt="image-20230917152642113"></p>
<p>é‚£ä¹ˆç›´æ¥RSAè§£å¯†ï¼Œå¹¶å°†flagæ‹¼æ¥èµ·æ¥å³å¯ã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c1 = <span class="number">10004937130983861141937782436252502991050957330184611684406783226971057978666503675149401388381995491152372622456604317681236160071166819028679754762162125904637599991943368450200313304999566592294442696755822585022667008378021280392976010576970877334159755332946926433635584313137140987588847077645814987268595739733550220882135750267567373532603503399428451548677091911410732474324157868011686641243202218731844256789044721309478991918322850448456919991540932206923861653518190974620161055008847475600980152660468279765607319838003177639654115075183493029803981527882155542925959658123816315099271123470754815045214896642428657264709805029840253303446203030294879166242867850331945166255924821406218090304893024711068773287842075208409312312188560675094244318565148284432361706108491327014254387317744284876018328591380705408407853404828189643214087638328376675071962141118973835178054884474523241911240926274907256651801384433652425740230755811160476356172444327762497910600719286629420662696949923799255603628210458906831175806791599965316549386396788014703044837917283461862338269599464440202019922379625071512100821922879623930069349084917919100015782270736808388388006084027673781004085620817521378823838335749279055639005125</span></span><br><span class="line">n1 = <span class="number">343504538870081878757729748260620800783581983635281373321527119223374418103340873199654926888439040391545101913132680017655039577253974802351999985470115474655124168592386965001556620077117966153475518658881140827499124290142523464795351995478153288872749817655925271395693435582010998996210909883510311066017237567799370371513462802547313382594409676803895262837061350017911885033133654781876923251129406855067993830824618637981136966134029212516871210627954762147349788788999116702635535406398258621926040887099782494271000823401788337120154104692934583729065189687995570122890809807661370008740283447636580308161498808092269041815719148127168137018600113465985504975054319601741498799761500526467431533990903047624407330243357514588557352746347337683868781554819821575385685459666842162355673947984514687068626166144076257334426612302554448774082488600083569900006274897032242821388126274957846236552373226099112200392102883351088570736254707966329366625911183721875374731791052229266503696334310835323523568132399330263642353927504971311717117370721838701629885670598853025212521537158141447625623337563164790788106598854822686494249848796441153496412236527242235888308435573209980270776407776277489669763803746640746378181948641</span></span><br><span class="line">c2 = <span class="number">4948422459907576438725352912593232312182623872749480015295307088166392790756090961680588458629287353136729331282506869598853654959933189916541367579979613191505226006688017103736659670745715837820780269669982614187726024837483992949073998289744910800139692315475427811724840888983757813069849711652177078415791290894737059610056340691753379065563574279210755232749774749757141836708161854072798697882671844015773796030086898649043727563289757423417931359190238689436180953442515869613672008678717039516723747808793079592658069533269662834322438864456440701995249381880745586708718334052938634931936240736457181295</span></span><br><span class="line">n2 = <span class="number">8582505375542551134698364096640878629785534004976071646505285128223700755811329156276289439920192196962008222418309136528180402357612976316670896973298407081310073283979903409463559102445223030866575563539261326076167685019121804961393115251287057504682389257841337573435085535013992761172452417731887700665115563173984357419855481847035192853387338980937451843809282267888616833734087813693242841580644645315837196205981207827105545437201799441352173638172133698491126291396194764373021523547130703629001683366722885529834956411976212381935354905525700646776572036418453784898084635925476199878640087165680193737</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#c1</span></span><br><span class="line">p1 = <span class="number">18055722101348711626577381571859114850735298658417345663254295930584841136416234624852520581982069555948490061840244710773146585295336094872892685938420880462305333393436098181186277450475949236132458958671804132443554885896037342335902958516394876382378829317303693655605215373555988755516058130500801822723195474873517960624159417903134580987202400855946137101429970119186394052011747475879598126195607938106163892658285305921071673588966184054026228745012993740035399652049777986535759039077634555909031397541116025395236871778797949216479130412500655359057128438928721459688727543057760739527720641179290282309741</span></span><br><span class="line">q1 = <span class="number">19024691283015651666032297670418553586155390575928421823630922553034857624430114628839720683172187406577114034710093054198921843669645736474448836706112221787749688565566635453151716934583685087745112614898780150391513798368931496744574075511968933800467288441832780919514199410584786925010518564670786685241724643282580795568609339268652910564215887176803735675069372979560024792322029911970574914829712553975379661212645059271137916107885326625543090473004683836665262304916304580076748336858662108554591235698235221618061328251985929904075811056422186525179189846420226944944513865790999242309352900287977666792901</span></span><br><span class="line">phi_n1 = (p1-<span class="number">1</span>)*(q1-<span class="number">1</span>)</span><br><span class="line">d1 = inverse(e,phi_n1)</span><br><span class="line">m1 = <span class="built_in">pow</span>(c1,d1,n1)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(long_to_bytes(m1))[<span class="number">2</span>:-<span class="number">1</span>],end = <span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#c2</span></span><br><span class="line">plist = [<span class="number">9949603102225364603</span>,<span class="number">10049235158029375571</span>,<span class="number">10547615587767500213</span>,<span class="number">10596280721192026229</span>,<span class="number">10864078180916418691</span>,<span class="number">11092420583960163379</span>,<span class="number">11853704782834170959</span>,<span class="number">12034779627328165471</span>,<span class="number">12404642343676224637</span>,<span class="number">12448177342966243757</span>,<span class="number">13062839684118954553</span>,<span class="number">13645878578452317313</span>,<span class="number">14397830993057803133</span>,<span class="number">14619040595108594017</span>,<span class="number">14678737767649343977</span>,<span class="number">14745811312384518031</span>,<span class="number">14813953870710226847</span>,<span class="number">15175734709842430433</span>,<span class="number">15211380502610462057</span>,<span class="number">15332916111580607077</span>,<span class="number">15751974537676958401</span>,<span class="number">16123604149048919099</span>,<span class="number">16408421615173973083</span>,<span class="number">16870346804576162551</span>,<span class="number">17093292308638969889</span>,<span class="number">17265001711647542137</span>,<span class="number">17289161209347211817</span>,<span class="number">17543713628803023199</span>,<span class="number">17673334943789572513</span>,<span class="number">18106525049998616747</span>,<span class="number">18345408081492711641</span>,<span class="number">18390046459144888243</span>]</span><br><span class="line">phi_n2 = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> plist:</span><br><span class="line">    phi_n2 *= (i-<span class="number">1</span>)</span><br><span class="line">d2 = inverse(e,phi_n2)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2,d2,n2)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(long_to_bytes(m2))[<span class="number">2</span>:-<span class="number">1</span>],end = <span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>moectf{fACtord6_And_YAfu_Are_6oth_good_utils_to_fACtorize_num6ers_ff90S}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="feistel"><a href="#feistel" class="headerlink" title="feistel"></a>feistel</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¾ˆå–œæ¬¢shallowçš„ä¸€å¥è¯ï¼šç™½ç»™æ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="built_in">round</span> = <span class="number">2</span></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&quot;./secret&quot;</span>, <span class="string">&quot;rb&quot;</span>).read().strip()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">m, key</span>):</span><br><span class="line">    m = m ^ (m &gt;&gt; <span class="number">4</span>)</span><br><span class="line">    m = m ^ (m &lt;&lt; <span class="number">5</span>)</span><br><span class="line">    m = m ^ (m &gt;&gt; <span class="number">8</span>)</span><br><span class="line">    m ^= key</span><br><span class="line">    m = (m * <span class="number">1145</span> + <span class="number">14</span>) % <span class="number">2</span>**<span class="number">64</span></span><br><span class="line">    m = (m * <span class="number">1919</span> + <span class="number">810</span>) % <span class="number">2</span>**<span class="number">64</span></span><br><span class="line">    m = (m * key) % <span class="number">2</span>**<span class="number">64</span></span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">m, key, <span class="built_in">round</span></span>):</span><br><span class="line">    key = bytes_to_long(key)</span><br><span class="line">    left = bytes_to_long(m[:<span class="number">8</span>])</span><br><span class="line">    right = bytes_to_long(m[<span class="number">8</span>:])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">round</span>):</span><br><span class="line">        left, right = right, f(right, key) ^ left</span><br><span class="line">    left, right = right, left</span><br><span class="line">    <span class="keyword">return</span> long_to_bytes(left).rjust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>) + long_to_bytes(right).rjust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">padding</span>(<span class="params">m</span>):</span><br><span class="line">    mlen = <span class="built_in">len</span>(m)</span><br><span class="line">    pad = <span class="number">16</span> - mlen % <span class="number">16</span></span><br><span class="line">    <span class="keyword">return</span> m + pad * <span class="built_in">bytes</span>([pad])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ecb_enc</span>(<span class="params">m, key</span>):</span><br><span class="line">    m = padding(m)</span><br><span class="line">    mlen = <span class="built_in">len</span>(m)</span><br><span class="line">    c = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(mlen // <span class="number">16</span>):</span><br><span class="line">        c += enc(m[i * <span class="number">16</span> : i * <span class="number">16</span> + <span class="number">16</span>], key, <span class="built_in">round</span>)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(ecb_enc(flag, <span class="string">b&quot;wulidego&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;\x0b\xa7\xc6J\xf6\x80T\xc6\xfbq\xaa\xd8\xcc\x95\xad[\x1e\&#x27;W5\xce\x92Y\xd3\xa0\x1fL\xe8\xe1&quot;^\xad&#x27;</span></span><br></pre></td></tr></table></figure>
<p>åˆ†æä¸€ä¸‹é¢˜ç›®çš„åŠ å¯†æµç¨‹ï¼š</p>
<ul>
<li>å°†flagç»paddingå¡«å……é•¿åº¦è‡³16çš„æ•´æ•°å€</li>
<li>å¡«å……åï¼Œå°†flagæ¯16ä¸ªåˆ†ä¸ºä¸€ç»„ï¼Œå„è‡ªè¿›è¡ŒåŠ å¯†(ç±»ä¼¼ECBæ¨¡å¼ï¼Œç»„ä¸ç»„é—´ä¸è¿›è¡Œå¹²æ‰°)</li>
<li>æ¯ç»„çš„åŠ å¯†æ–¹å¼ä¸ºï¼šåˆ†ä¸ºå·¦å³ä¸¤éƒ¨åˆ†ï¼Œæ¯éƒ¨åˆ†å„8å­—èŠ‚ï¼Œè¿›è¡Œfeistelç½‘ç»œåŠ å¯†ï¼Œå…±ä¸¤è½®ã€‚</li>
</ul>
<p>å†çœ‹çœ‹feistelå‹ç½‘ç»œç»“æ„ï¼š</p>
<p><img src="/post/aa501114/image-20230917153853700.png" alt="image-20230917153853700"></p>
<p>åˆ†æå¯ä»¥çŸ¥é“ï¼Œåªè¦æ‹¥æœ‰å¯†é’¥ï¼Œé‚£ä¹ˆåªéœ€è¦ç®€å•çš„å¼‚æˆ–å°±å¯ä»¥é€å±‚è¿˜åŸæ˜æ–‡ï¼Œè€Œä¸éœ€è¦å…³æ³¨få‡½æ•°çš„å…·ä½“æ‰§è¡Œè¿‡ç¨‹ï¼Œè¿™æ˜¯å› ä¸ºå¯¹æŸä¸€è½®è€Œè¨€ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">L,R = R,f(R)^L</span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶ï¼Œä»¤æ–°çš„å·¦å³ä¸¤éƒ¨åˆ†ä¸ºnewL,newRï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">newL = R</span><br><span class="line">newR = f(R)^L</span><br></pre></td></tr></table></figure>
<p>åªéœ€è¦æŒ‰ä¸‹åˆ—æ–¹å¼å³å¯è¿˜åŸå‡ºLã€Rï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">R = newL</span><br><span class="line">L = f(newL)^newR = f(R)^(f(R)^L) = L</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥å¯¹äºnå±‚çš„feistelï¼Œä»…éœ€è¦å¯¹åº”è¿˜åŸnæ¬¡å³å¯ã€‚åœ¨æœ¬é¢˜ä¸­ä¸ºè¿˜åŸä¸¤æ¬¡ã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> nextprime</span><br><span class="line"></span><br><span class="line">c = <span class="string">b&#x27;\x0b\xa7\xc6J\xf6\x80T\xc6\xfbq\xaa\xd8\xcc\x95\xad[\x1e\&#x27;W5\xce\x92Y\xd3\xa0\x1fL\xe8\xe1&quot;^\xad&#x27;</span></span><br><span class="line">key = <span class="string">b&quot;wulidego&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">m, key</span>):</span><br><span class="line">    m = m ^ (m &gt;&gt; <span class="number">4</span>)</span><br><span class="line">    m = m ^ (m &lt;&lt; <span class="number">5</span>)</span><br><span class="line">    m = m ^ (m &gt;&gt; <span class="number">8</span>)</span><br><span class="line">    m ^= key</span><br><span class="line">    m = (m * <span class="number">1145</span> + <span class="number">14</span>) % <span class="number">2</span>**<span class="number">64</span></span><br><span class="line">    m = (m * <span class="number">1919</span> + <span class="number">810</span>) % <span class="number">2</span>**<span class="number">64</span></span><br><span class="line">    m = (m * key) % <span class="number">2</span>**<span class="number">64</span></span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dec</span>(<span class="params">c,key</span>):</span><br><span class="line">    key = bytes_to_long(key)</span><br><span class="line">    right = bytes_to_long(c[:<span class="number">8</span>])</span><br><span class="line">    left = bytes_to_long(c[<span class="number">8</span>:])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">        left,right = f(left,key)^right,left</span><br><span class="line">    <span class="keyword">return</span> long_to_bytes(left) + long_to_bytes(right)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ecb_dec</span>(<span class="params">c, key</span>):</span><br><span class="line">    m = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c) // <span class="number">16</span>):</span><br><span class="line">        m += dec(c[i * <span class="number">16</span> : i * <span class="number">16</span> + <span class="number">16</span>], key)</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(ecb_dec(c,key))</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>moectf{M@g1cA1_Encr1tion!!!}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="n-amp-n"><a href="#n-amp-n" class="headerlink" title="n&amp;n"></a>n&amp;n</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">modulus and modulus~</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = f.read().strip().encode()</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">n = p * q</span><br><span class="line">e1 = <span class="number">0x114514</span></span><br><span class="line">e2 = <span class="number">19198101</span></span><br><span class="line"></span><br><span class="line">c1 = <span class="built_in">pow</span>(m,e1,n)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m,e2,n)</span><br><span class="line"><span class="built_in">print</span>(c1) </span><br><span class="line"><span class="built_in">print</span>(c2)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5776799746376051463605370130675046329799612910435315968508603116759552095183027263116443417343895252766060748671845650457077393391989018107887540639775168897954484319381180406512474784571389477212123123540984850033695748142755414954158933345476509573211496722528388574841686164433315356667366007165419697987147258498693175698918104120849579763098045116744389310549687579302444264316133642674648294049526615350011916160649448726069001139749604430982881450187865197137222762758538645387391379108182515717949428258503254717940765994927802512049427407583200118969062778415073135339774546277230281966880715506688898978925</span></span><br><span class="line"><span class="comment"># 4664955020023583143415931782261983177552050757537222070347847639906354901601382630034645762990079537901659753823666851165175187728532569040809797389706253282757017586285211791297567893874606446000074515260509831946210526182765808878824360460569061258723122198792244018463880052389205906620425625708718545628429086424549277715280217165880900037900983008637302744555649467104208348070638137050458275362152816916837534704113775562356277110844168173111385779258263874552283927767924979691542028126412133709129601685315027689094437957165812994784648540588277901241854031439324974562449032290219652206466731675967045633360</span></span><br><span class="line"><span class="comment"># 13612969130810965900902742090064423006385890357159609755971027204203418808937093492927060428980020085273603754747223030702684866992231913349067578014240319426522039068836171388168087260774376277346092066880984406890296520951318296354893551565670293486797637522297989653182109744864444697818991039473180752980752117041574628063002176339235126861152739066489620021077091941250365101779354009854706729448088217051728432010328667839532327286559570597994183126402340332924370812383312664419874352306052467284992411543921858024469098268800500500651896608097346389396273293747664441553194179933758992070398387066135330851531</span></span><br></pre></td></tr></table></figure>
<p>ç®€å•çš„å…±æ¨¡æ”»å‡»ã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e1 = <span class="number">0x114514</span></span><br><span class="line">e2 = <span class="number">19198101</span></span><br><span class="line">c1 = <span class="number">5776799746376051463605370130675046329799612910435315968508603116759552095183027263116443417343895252766060748671845650457077393391989018107887540639775168897954484319381180406512474784571389477212123123540984850033695748142755414954158933345476509573211496722528388574841686164433315356667366007165419697987147258498693175698918104120849579763098045116744389310549687579302444264316133642674648294049526615350011916160649448726069001139749604430982881450187865197137222762758538645387391379108182515717949428258503254717940765994927802512049427407583200118969062778415073135339774546277230281966880715506688898978925</span></span><br><span class="line">c2 = <span class="number">4664955020023583143415931782261983177552050757537222070347847639906354901601382630034645762990079537901659753823666851165175187728532569040809797389706253282757017586285211791297567893874606446000074515260509831946210526182765808878824360460569061258723122198792244018463880052389205906620425625708718545628429086424549277715280217165880900037900983008637302744555649467104208348070638137050458275362152816916837534704113775562356277110844168173111385779258263874552283927767924979691542028126412133709129601685315027689094437957165812994784648540588277901241854031439324974562449032290219652206466731675967045633360</span></span><br><span class="line">n = <span class="number">13612969130810965900902742090064423006385890357159609755971027204203418808937093492927060428980020085273603754747223030702684866992231913349067578014240319426522039068836171388168087260774376277346092066880984406890296520951318296354893551565670293486797637522297989653182109744864444697818991039473180752980752117041574628063002176339235126861152739066489620021077091941250365101779354009854706729448088217051728432010328667839532327286559570597994183126402340332924370812383312664419874352306052467284992411543921858024469098268800500500651896608097346389396273293747664441553194179933758992070398387066135330851531</span></span><br><span class="line"></span><br><span class="line">_, s1, s2 = gcdext(e1, e2)</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c1, s1, n)*<span class="built_in">pow</span>(c2, s2, n) % n</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>moectf{dO_nOt_u53_5AM3_MOdulu5_tO_3ncrYPt_dIFF3r3nt_dAtA!_JY63x33iiA0Ji}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="p-q"><a href="#p-q" class="headerlink" title="|p-q|"></a>|p-q|</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">what will `next_prime` cause?</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> fs:</span><br><span class="line">    flag = fs.read().strip()</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">72</span></span><br><span class="line"></span><br><span class="line">m = <span class="built_in">int</span>.from_bytes(flag,<span class="string">&quot;big&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, isPrime</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">next_prime</span>(<span class="params">p</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p += <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> isPrime(p):</span><br><span class="line">            <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">2048</span>)</span><br><span class="line">q = next_prime(p)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n =&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>,c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 329960318345010350458589325571454799968957932130539403944044204698872359769449414256378111233592533561892402020955736786563103586897940757198920737583107357264433730515123570697570757034221232010688796344257587359198400915567115397034901247038275403825404094129637119512164953012131445747740645183682571690806238508035172474685818036517880994658466362305677430221344381425792427288500814551334928982040579744048907401043058567486871621293983772331951723963911377839286050368715384227640638031857101612517441295926821712605955984000617738833973829140899288164786111118033301974794123637285172303688427806450817155786233788027512244397952849209700013205803489334055814513866650854230478124920442832221946442593769555237909177172933634236392800414176981780444770542047378630756636857018730168151824307814244094763132088236333995807013617801783919113541391133267230410179444855465611792191833319172887852945902960736744468250550722314565805440432977225703650102517531531476188269635151281661081058374242768608270563131619806585194608795817118466680430500830137335634289617464844004904410907221482919453859885955054140320857757297655475489972268282336250384384926216818756762307686391740965586168590784252524275489515352125321398406426217</span></span><br><span class="line"><span class="comment"># c = 307746143297103281117512771170735061509547958991947416701685589829711285274762039205145422734327595082350457374530975854337055433998982493020603245187129916580627539476324521854057990929173492940833073106540441902619425074887573232779899379436737429823569006431370954961865581168635086246592539153824456681688944066925973182272443586463636373955966146029489121226571408532284480270826510961605206483011204059402338926815599691009406841471142048842308786000059979977645988396524814553253493672729395573658564825709547262230219183672493306100392069182994445509803952976016630731417479238769736432223194249245020320183199001774879893442186017555682902409661647546547835345461056900610391514595370600575845979413984555709077635397717741521573798309855584473259503981955303774208127361309229536010653615696850725905168242705387575720694946072789441481191449772933265705810128547553027708513478130258801233619669699177901566688737559102165508239876805822898509541232565766265491283807922473440397456701500524925191214292669986798631732639221198138026031561329502985577205314190565609214349344303324429408234237832110076900414483795318189628198913032900272406887003325858236057373096880675754802725017537119549989304878960436575670784578550</span></span><br></pre></td></tr></table></figure>
<p>å…³æ³¨åˆ°qçš„ç”Ÿæˆè¿‡ç¨‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">q = next_prime(p)</span><br></pre></td></tr></table></figure>
<p>å› æ­¤pã€qç›¸å·®è¿‡å°ï¼Œnå¼€æ ¹åç®€å•çˆ†ç ´å³å¯å¾—åˆ°åˆ†è§£ã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">329960318345010350458589325571454799968957932130539403944044204698872359769449414256378111233592533561892402020955736786563103586897940757198920737583107357264433730515123570697570757034221232010688796344257587359198400915567115397034901247038275403825404094129637119512164953012131445747740645183682571690806238508035172474685818036517880994658466362305677430221344381425792427288500814551334928982040579744048907401043058567486871621293983772331951723963911377839286050368715384227640638031857101612517441295926821712605955984000617738833973829140899288164786111118033301974794123637285172303688427806450817155786233788027512244397952849209700013205803489334055814513866650854230478124920442832221946442593769555237909177172933634236392800414176981780444770542047378630756636857018730168151824307814244094763132088236333995807013617801783919113541391133267230410179444855465611792191833319172887852945902960736744468250550722314565805440432977225703650102517531531476188269635151281661081058374242768608270563131619806585194608795817118466680430500830137335634289617464844004904410907221482919453859885955054140320857757297655475489972268282336250384384926216818756762307686391740965586168590784252524275489515352125321398406426217</span></span><br><span class="line">c = <span class="number">307746143297103281117512771170735061509547958991947416701685589829711285274762039205145422734327595082350457374530975854337055433998982493020603245187129916580627539476324521854057990929173492940833073106540441902619425074887573232779899379436737429823569006431370954961865581168635086246592539153824456681688944066925973182272443586463636373955966146029489121226571408532284480270826510961605206483011204059402338926815599691009406841471142048842308786000059979977645988396524814553253493672729395573658564825709547262230219183672493306100392069182994445509803952976016630731417479238769736432223194249245020320183199001774879893442186017555682902409661647546547835345461056900610391514595370600575845979413984555709077635397717741521573798309855584473259503981955303774208127361309229536010653615696850725905168242705387575720694946072789441481191449772933265705810128547553027708513478130258801233619669699177901566688737559102165508239876805822898509541232565766265491283807922473440397456701500524925191214292669986798631732639221198138026031561329502985577205314190565609214349344303324429408234237832110076900414483795318189628198913032900272406887003325858236057373096880675754802725017537119549989304878960436575670784578550</span></span><br><span class="line"></span><br><span class="line">p = iroot(n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span>(n % p == <span class="number">0</span>):</span><br><span class="line">        q = n//p</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    p += <span class="number">1</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>moectf{it_iS_vUlnErablE_iF_p_iS_aboUt_thE_SaME_SiZE_aS_Q_MVoAYArrlG3uco}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="rsa-signin"><a href="#rsa-signin" class="headerlink" title="rsa_signin"></a>rsa_signin</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">çœŸ signin</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = f.read().strip()</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">int</span>.from_bytes(flag, <span class="string">&quot;big&quot;</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    p = getPrime(<span class="number">1024</span>)</span><br><span class="line">    q = getPrime(<span class="number">1024</span>)</span><br><span class="line">    n = p * q</span><br><span class="line">    c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;n =&quot;</span>, n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 17524722204224696445172535263975543817720644608816706978363749891469511686943372362091928951563219068859089058278944528021615923888948698587206920445508493551162845371086030869059282352535451058203615402089133135136481314666971507135484450966505425514285114192275051972496161810571035753943880190780759479521486741046704043699838021850105638224212696697865987677760179564370167062037563913329993433080123575434871852732981112883423565015771421868680113407260917902892944119552200927337996135278491046562185003012971570532979090484837684759828977460570826320870379601193678304983534424368152743368343335213808684523217</span></span><br><span class="line"><span class="string">c = 6870605439714128574950893771863182370595667973241984289208050776870220326525943524507319708560433091378319367164606150977103661770065561661544375425887970907060665421562712515902428061727268441585629591525591001533188276465911918724808701356962871139957343861919730086334623932624184172272488406793955068827527130338853980609365042071290967556159598511667974987218999253443575482949258292953639729393456515185185102248985930422080581185292420347510600574229080211050520146551505605537486989306457793451086767402197128573781597156939709237045132856159368959981648969874765462190363842275826077556314448408825308218451</span></span><br><span class="line"><span class="string">n = 24974121071274650888046048586598797033399902532613815354986756278905133499432183463847175542164798764762683121930786715931063152122056911933710481566265603626437742951648885379847799327315791800670175616973945640322985175516271373004547752061826574576722667907302681961850865961386200909397231865804894418194711076667760169256682834206788730947602211228930301853348503098156592000286467190760378847541148772869356389938999094673945092387627113807899212568399028514283219850734634544982646070106811651490010946670117927664594365986238107951837041859682547029079035013475238052160645871718246031144694712586073789250183</span></span><br><span class="line"><span class="string">c = 10324627733161143472233272675096997859064721978612320424254305978486200326061730105384511258706433940176741256952824288120499229240005823611541292676234913505775165761543820764046537413943393325463602612485849366939102550336256797820440347815027443410399157963547486098366749815425187247171697678576246606105486928212486117878157055321965270364583625270716186820068538749425299073309429589410882809098930213978117176627031795312102177342499674234163614021182116065492884880492891668658240362567156235958605768725892407536211503981819707919444725863397622629226309480836486427388484176463279384813974310500625102568341</span></span><br><span class="line"><span class="string">n = 14215826065753265334521416948225868542990756976323308408298887797364519400310818641526401662106853573185085731682502059761982246604277475488691297554851873224516934619888327644352138127883043558424300092247604877819821625587944308487310522092440517150600171819145803937177931473336108429889165189521078678397694303305705260759351843006130968234071638035667854938070597400634242396852782331461576526836227336952718230741560369621645218729592233657856104560425642219241082727756696967324334634822771842625681505869025740662258929200756109704988223034840699133778958569054445520305361142302393767439478256174414187983763</span></span><br><span class="line"><span class="string">c = 415916446053083522663299405080903121619846594209033663622616979372099135281363175464579440520262612010099820951944229484417996994283898028928384268216113118778734726335389504987546718739928112684600918108591759061734340607527889972020273454098314620790710425294297542021830654957828983606433731988998097351888879368160881316237557097381718444193741788664735559392675419489952796677690968481917700683813252460912749931286739585465657312416977086336732056497161860235343155953578618273940135486362350057858779130960380833359506761436212727289297656191243565734621757889931250689354508999144817518599291078968866323093</span></span><br><span class="line"><span class="string">n = 12221355905532691305226996552124162033756814028292708728711809229588190407700199452617060657420166395065565154239801465361510672853972152857415394695376825120759202857555325904640144375262531345320714166285999668052224661520834318497234299585219832943519644095197479639328120838919035625832361810964127485907587199925564724081163804724975965691571850962714258888527902920462746795712011579424322515292865504642938090200503979483095345893697972170153990274670257331483858538617460680462369680572833191232126527727222302641204529110948993583190295067970240051042000918629138767209918572311469915774910003970381965123241</span></span><br><span class="line"><span class="string">c = 2248834602646305164283014556051672824689884721514190813323189875541899566338153534858709617544459297836048770439230174669883719627734394673012731609952869246171300132019334542245094425654362711870373095782083791160029789553806741967408922001051006100049326921742208757147339981269528740944842177729701945606827918253016001436218891580980192743564642120923356793292885805519110411357830040053435569937296612987581482128241218218550319154933831743819546558930918761162723110000328532730751591375727881221199739397698390594797621758011191224528339478784930214820615602510460640307707682865125229937141010351138099874025</span></span><br><span class="line"><span class="string">n = 18152103454920389919231636321286527841833809319334215885641536161086810144890443857211776387914779781628740172079478910188540146498426564211851629962338413488555121865779016981727229209606498886170396500155102635962395243364899026418106378234307821492609778555173516000309435730752571818439328803899462791834490025768785383592935046996428331508608555503567191807692523852530836008436655164751054189301721070209363416058642811329040202582026786024825518381761299547703962502636888833428457116986351812252188468878701301184044948733274488264320930936362549028124581962244201377136969591119942276742760215403738913067567</span></span><br><span class="line"><span class="string">c = 2797812094994121597295362327809389195134238119144547570610194659000554967367804835006774413888965325870488368112707535584687083342412367127561646136089638402907513075405746055834487062923240856950047936297155455745928810738711368950139327254040579266046642851362228893522740216519732851152162928545416236075387903789535000820423985522550638100049857678600662008021574841083416323980817348573062083159710189689337626277009675683473560325178417766400002763719953723259300977655801234386662217462862844994462505601804422871991694828697337752697234180117437785537788728412520613916334045368736691714704501962513954509705</span></span><br><span class="line"><span class="string">n = 22877887459293720334652698748191453972019668578065068224653972884599636421200068659750242304040301306798039254241668648594556654589309801728248683586229288074709849246660525799452637187132633064172425677552176203292787732404537215347782229753837476655088638984496409603054524994383358547132112778403912563916886533181616856401929346567686400616307916690806467019665390260267596320840786982457521423178851498130935577260638269429250197050326097193841333205073650802709022947551398142692735680419453533128176592587955634333425401930362881423044363132586170013458300714163531162544301477356808388416864173949089028317961</span></span><br><span class="line"><span class="string">c = 12271947322974809255127222556723394446467844330408506340843897575503534175121932185624776713618037572593449207329510171212097269297133492090526270770286000839978630002819714376964416081198925899119135271459404333829811516667576167576916805217016117373027245648473458331936273975110163065432285322832123169216976420362833557809289561705091817949915218278430834098156335989014645979633658818904753942786129126233956314517292746008579152368541316795082120147520597254020266752859205131887527661767589367756335766220841483940854397440079467053684289006956034944336788288196391829411432383541473132962783883758561108297747</span></span><br><span class="line"><span class="string">n = 19844333358004073542783728196775487079202832688982038135532362073659058674903791697765527614270399097276261983744620537925712167578187109058145015032736796457938148615396547198728652435169126585595701228287449135664667959433491335769206692390262797325133960778920452511673878233190120432257482339068405290918739453464061987163074129048150451046315248186376609350095502130018696275764450248681787926130463463923862832714969425813770847493135627599129546112143050369344208092649256659330284904392961574494907186727388685504929586018639846040474616307662546605623294842316524163106100888851228858194942825157286544846177</span></span><br><span class="line"><span class="string">c = 9531264751315473345056673937611382755236533664089452852716992791452558274873158812669513178040971923528201631609089069182049526587423864397527252061341857426422965190913745048414029690931254119437249218321954899956104589066479231204536856131403590472063496956452030342299863907499976917750846369802185896519725837163530049157920978007252920334447236842959033879772444475877613295594785710745889554296655932909212643500877218304116451889820444820534937901427158918411546484157737612926382420354101675658160847653151539420222526999426483473829341628599881460824765758346670633385844187252696874025582747177333702736465</span></span><br><span class="line"><span class="string">n = 16956880944655068255446705024149899655327230949463546092744762226005904114738078692036960935391303255804754787864713189658290361949509917704853428701870609882427423574672772606814823959758208695540116440342488334213300943604780971422918744381486937517952553797134323570131582724393100092308466968491068503301604506186521656059375518680612292667310641047190088814753025794048591445267711939066523165042651430468971452726568222388482323097260496415484997546126185688914792795834046855221759289007609518312601640548469651358391745947588643697900883634533872314566389446271647587564348026861264979727062157272541149018781</span></span><br><span class="line"><span class="string">c = 16110326928338602237561005337578085623028116490564329920738844771341250444164294693848130674347672763073995755532723894042946521372321947507527854966013459795492930736187058535665041545095683801386814190612817128504426590828954205050425979880047802547011117626354405687170961272200066258220699329112978151044633994329352673342582175349200008181837211288847301836681860817044391028992501763375849046751094019224570802498414368189170656992427042010362385494565216988561215657424755648213390551881450141899860811844684546992754530755092358644968088017107313907435586729574798046187046145596726569637758312033849476689378</span></span><br><span class="line"><span class="string">n = 16472195897077185060734002588086375750797253422014472876266294484788862733424113898147596402056889527985731623940969291811284437034420929030659419753779530635563455664549165618528767491631867637613948406196511848103083967995689432928779805192695209899686072900265108597626632371718430059561807147486376536203800038054012500244392964187780217667805308512187849789773573138494622201856638931435423778275004491853486855300574479177472267767506041000072575623287557610576406578525902565241580838652860552046216587141709709405062150243990097835181557208274750462554811004137033087430556692966525170882625891516050207318491</span></span><br><span class="line"><span class="string">c = 11867731823522211833301190385669833752050387304375114576570892885641949969365352586215693183003550684262313893105989683214739695968039039944442567581277252581988489020834299896625977474857889570528169919064941042132119301236852358823696947330423679033138054012027878783478922023431469564210485180679933264749281963405243082505688901662659030897104957499953192201440290084373968716271056483463909282407034181891901928790601973222643210525000717355062752079302291729448234374709852429885984987094307177760741403086538949190424454337896501402430653783597070178968921411867485584517214777073301007918941216316241784521708</span></span><br><span class="line"><span class="string">n = 13890749889361612188368868998653029697326614782260719535555306236512452110708495623964530174188871342332417484996749651846510646453983388637377706674890018646246874688969342600780781646175634455109757266442675502522791531161284420286435654971819525519296719668701529481662071464145515727217108362496784024871976015116522898184301395037566514980846499856316532479656908169681719288258287756566886281183699239684997698487409138330229321935477734921670373632304542254938831218652340699024011371979519574576890581492623709896310465567043899767342676912434857372520308852745792360420376574037705943820090308501053778144141</span></span><br><span class="line"><span class="string">c = 6250115196713939477947942995075509357173312813431601073354390451609559579925704891503987992181988654989477525811826607070378476102616752398280691012244301950194800995432882828020405062344160270290542566163969692748126314259624623341922057435728127596172871894887055305291345372720594481096374310285437492746765510292863238933163142677773310305789984897974266961231555124787205980411992251387207335655129551950825339766848166539671565212408741432649813058363660321480995187545006718837863674527475323414266732366507905974800565463011676462244368010182725161416783875646259625352308599198614681446394427674340328493047</span></span><br><span class="line"><span class="string">n = 21457499145521259498911107987303777576783467581104197687610588208126845121702391694574491025398113729462454256070437978257494064504146718372095872819969887408622112906108590961892923178192792218161103488204912792358327748493857104191029765218471874759376809136402361582721860433355338373725980783308091544879562698835405262108188595630215081260699112737457564998798692048522706388318528370551365364702529068656665853097899157141017378975007689790000067275142731212069030175682911154288533716549782283859340452266837760560153014200605378914071410125895494331253564598702942990036163269043699029806343766286247742865671</span></span><br><span class="line"><span class="string">c = 6269656777204332618433779865483197625538144405832409880710764183039800286008967127279281167109250083159801218370191973055663058165456565194979210256278526713608759141588082614531352489547674696723140599892318118960648862531538435596775798128845789504910467783731144808685373807716609662688064728614003904579841055786083326311313295311152563668422289435606771091246147867715987583149743032723028324394173498623642539175178996531881058274717907066845565199058931743481410454382746158558886667761300257488769795092777021292335562818583719708133179974425584610403335487082478848975656282384575767178925517257692365828720</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>åŒæ ·çš„mã€eï¼Œä¸åŒçš„æ¨¡æ•°nï¼Œä¸€èˆ¬æœ‰ä¸¤ç§è€ƒè™‘æ–¹å¼ï¼šä¸­å›½å‰©ä½™å®šç†æˆ–æ¨¡ä¸äº’ç´ ã€‚</p>
<p>åŒæ ·çš„ï¼Œå¦‚æœç”¨ä¸­å›½å‰©ä½™å®šç†ï¼Œ65537å¯¹äºå¼€æ ¹æ¥è¯´ä»ç„¶è¿‡å¤§äº†ï¼Œå› æ­¤åº”è¯¥æ˜¯æ¨¡ä¸äº’ç´ ã€‚è§‚å¯Ÿæ•°æ®ä¹Ÿå¯ä»¥å‘ç°ï¼Œcã€nå…±æœ‰11ç»„ï¼Œè€Œé¢˜ç›®ä»…ç”Ÿæˆäº†10ç»„ï¼Œå› æ­¤å¯èƒ½ä¹Ÿæ˜¯å¯¹æ¨¡ä¸äº’ç´ çš„ä¸€ç§æš—ç¤ºã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n1 = <span class="number">17524722204224696445172535263975543817720644608816706978363749891469511686943372362091928951563219068859089058278944528021615923888948698587206920445508493551162845371086030869059282352535451058203615402089133135136481314666971507135484450966505425514285114192275051972496161810571035753943880190780759479521486741046704043699838021850105638224212696697865987677760179564370167062037563913329993433080123575434871852732981112883423565015771421868680113407260917902892944119552200927337996135278491046562185003012971570532979090484837684759828977460570826320870379601193678304983534424368152743368343335213808684523217</span></span><br><span class="line">c1 = <span class="number">6870605439714128574950893771863182370595667973241984289208050776870220326525943524507319708560433091378319367164606150977103661770065561661544375425887970907060665421562712515902428061727268441585629591525591001533188276465911918724808701356962871139957343861919730086334623932624184172272488406793955068827527130338853980609365042071290967556159598511667974987218999253443575482949258292953639729393456515185185102248985930422080581185292420347510600574229080211050520146551505605537486989306457793451086767402197128573781597156939709237045132856159368959981648969874765462190363842275826077556314448408825308218451</span></span><br><span class="line">n2 = <span class="number">24974121071274650888046048586598797033399902532613815354986756278905133499432183463847175542164798764762683121930786715931063152122056911933710481566265603626437742951648885379847799327315791800670175616973945640322985175516271373004547752061826574576722667907302681961850865961386200909397231865804894418194711076667760169256682834206788730947602211228930301853348503098156592000286467190760378847541148772869356389938999094673945092387627113807899212568399028514283219850734634544982646070106811651490010946670117927664594365986238107951837041859682547029079035013475238052160645871718246031144694712586073789250183</span></span><br><span class="line">c2 = <span class="number">10324627733161143472233272675096997859064721978612320424254305978486200326061730105384511258706433940176741256952824288120499229240005823611541292676234913505775165761543820764046537413943393325463602612485849366939102550336256797820440347815027443410399157963547486098366749815425187247171697678576246606105486928212486117878157055321965270364583625270716186820068538749425299073309429589410882809098930213978117176627031795312102177342499674234163614021182116065492884880492891668658240362567156235958605768725892407536211503981819707919444725863397622629226309480836486427388484176463279384813974310500625102568341</span></span><br><span class="line">n3 = <span class="number">14215826065753265334521416948225868542990756976323308408298887797364519400310818641526401662106853573185085731682502059761982246604277475488691297554851873224516934619888327644352138127883043558424300092247604877819821625587944308487310522092440517150600171819145803937177931473336108429889165189521078678397694303305705260759351843006130968234071638035667854938070597400634242396852782331461576526836227336952718230741560369621645218729592233657856104560425642219241082727756696967324334634822771842625681505869025740662258929200756109704988223034840699133778958569054445520305361142302393767439478256174414187983763</span></span><br><span class="line">c3 = <span class="number">415916446053083522663299405080903121619846594209033663622616979372099135281363175464579440520262612010099820951944229484417996994283898028928384268216113118778734726335389504987546718739928112684600918108591759061734340607527889972020273454098314620790710425294297542021830654957828983606433731988998097351888879368160881316237557097381718444193741788664735559392675419489952796677690968481917700683813252460912749931286739585465657312416977086336732056497161860235343155953578618273940135486362350057858779130960380833359506761436212727289297656191243565734621757889931250689354508999144817518599291078968866323093</span></span><br><span class="line">n4 = <span class="number">12221355905532691305226996552124162033756814028292708728711809229588190407700199452617060657420166395065565154239801465361510672853972152857415394695376825120759202857555325904640144375262531345320714166285999668052224661520834318497234299585219832943519644095197479639328120838919035625832361810964127485907587199925564724081163804724975965691571850962714258888527902920462746795712011579424322515292865504642938090200503979483095345893697972170153990274670257331483858538617460680462369680572833191232126527727222302641204529110948993583190295067970240051042000918629138767209918572311469915774910003970381965123241</span></span><br><span class="line">c4 = <span class="number">2248834602646305164283014556051672824689884721514190813323189875541899566338153534858709617544459297836048770439230174669883719627734394673012731609952869246171300132019334542245094425654362711870373095782083791160029789553806741967408922001051006100049326921742208757147339981269528740944842177729701945606827918253016001436218891580980192743564642120923356793292885805519110411357830040053435569937296612987581482128241218218550319154933831743819546558930918761162723110000328532730751591375727881221199739397698390594797621758011191224528339478784930214820615602510460640307707682865125229937141010351138099874025</span></span><br><span class="line">n5 = <span class="number">18152103454920389919231636321286527841833809319334215885641536161086810144890443857211776387914779781628740172079478910188540146498426564211851629962338413488555121865779016981727229209606498886170396500155102635962395243364899026418106378234307821492609778555173516000309435730752571818439328803899462791834490025768785383592935046996428331508608555503567191807692523852530836008436655164751054189301721070209363416058642811329040202582026786024825518381761299547703962502636888833428457116986351812252188468878701301184044948733274488264320930936362549028124581962244201377136969591119942276742760215403738913067567</span></span><br><span class="line">c5 = <span class="number">2797812094994121597295362327809389195134238119144547570610194659000554967367804835006774413888965325870488368112707535584687083342412367127561646136089638402907513075405746055834487062923240856950047936297155455745928810738711368950139327254040579266046642851362228893522740216519732851152162928545416236075387903789535000820423985522550638100049857678600662008021574841083416323980817348573062083159710189689337626277009675683473560325178417766400002763719953723259300977655801234386662217462862844994462505601804422871991694828697337752697234180117437785537788728412520613916334045368736691714704501962513954509705</span></span><br><span class="line">n6 = <span class="number">22877887459293720334652698748191453972019668578065068224653972884599636421200068659750242304040301306798039254241668648594556654589309801728248683586229288074709849246660525799452637187132633064172425677552176203292787732404537215347782229753837476655088638984496409603054524994383358547132112778403912563916886533181616856401929346567686400616307916690806467019665390260267596320840786982457521423178851498130935577260638269429250197050326097193841333205073650802709022947551398142692735680419453533128176592587955634333425401930362881423044363132586170013458300714163531162544301477356808388416864173949089028317961</span></span><br><span class="line">c6 = <span class="number">12271947322974809255127222556723394446467844330408506340843897575503534175121932185624776713618037572593449207329510171212097269297133492090526270770286000839978630002819714376964416081198925899119135271459404333829811516667576167576916805217016117373027245648473458331936273975110163065432285322832123169216976420362833557809289561705091817949915218278430834098156335989014645979633658818904753942786129126233956314517292746008579152368541316795082120147520597254020266752859205131887527661767589367756335766220841483940854397440079467053684289006956034944336788288196391829411432383541473132962783883758561108297747</span></span><br><span class="line">n7 = <span class="number">19844333358004073542783728196775487079202832688982038135532362073659058674903791697765527614270399097276261983744620537925712167578187109058145015032736796457938148615396547198728652435169126585595701228287449135664667959433491335769206692390262797325133960778920452511673878233190120432257482339068405290918739453464061987163074129048150451046315248186376609350095502130018696275764450248681787926130463463923862832714969425813770847493135627599129546112143050369344208092649256659330284904392961574494907186727388685504929586018639846040474616307662546605623294842316524163106100888851228858194942825157286544846177</span></span><br><span class="line">c7 = <span class="number">9531264751315473345056673937611382755236533664089452852716992791452558274873158812669513178040971923528201631609089069182049526587423864397527252061341857426422965190913745048414029690931254119437249218321954899956104589066479231204536856131403590472063496956452030342299863907499976917750846369802185896519725837163530049157920978007252920334447236842959033879772444475877613295594785710745889554296655932909212643500877218304116451889820444820534937901427158918411546484157737612926382420354101675658160847653151539420222526999426483473829341628599881460824765758346670633385844187252696874025582747177333702736465</span></span><br><span class="line">n8 = <span class="number">16956880944655068255446705024149899655327230949463546092744762226005904114738078692036960935391303255804754787864713189658290361949509917704853428701870609882427423574672772606814823959758208695540116440342488334213300943604780971422918744381486937517952553797134323570131582724393100092308466968491068503301604506186521656059375518680612292667310641047190088814753025794048591445267711939066523165042651430468971452726568222388482323097260496415484997546126185688914792795834046855221759289007609518312601640548469651358391745947588643697900883634533872314566389446271647587564348026861264979727062157272541149018781</span></span><br><span class="line">c8 = <span class="number">16110326928338602237561005337578085623028116490564329920738844771341250444164294693848130674347672763073995755532723894042946521372321947507527854966013459795492930736187058535665041545095683801386814190612817128504426590828954205050425979880047802547011117626354405687170961272200066258220699329112978151044633994329352673342582175349200008181837211288847301836681860817044391028992501763375849046751094019224570802498414368189170656992427042010362385494565216988561215657424755648213390551881450141899860811844684546992754530755092358644968088017107313907435586729574798046187046145596726569637758312033849476689378</span></span><br><span class="line">n9 = <span class="number">16472195897077185060734002588086375750797253422014472876266294484788862733424113898147596402056889527985731623940969291811284437034420929030659419753779530635563455664549165618528767491631867637613948406196511848103083967995689432928779805192695209899686072900265108597626632371718430059561807147486376536203800038054012500244392964187780217667805308512187849789773573138494622201856638931435423778275004491853486855300574479177472267767506041000072575623287557610576406578525902565241580838652860552046216587141709709405062150243990097835181557208274750462554811004137033087430556692966525170882625891516050207318491</span></span><br><span class="line">c9 = <span class="number">11867731823522211833301190385669833752050387304375114576570892885641949969365352586215693183003550684262313893105989683214739695968039039944442567581277252581988489020834299896625977474857889570528169919064941042132119301236852358823696947330423679033138054012027878783478922023431469564210485180679933264749281963405243082505688901662659030897104957499953192201440290084373968716271056483463909282407034181891901928790601973222643210525000717355062752079302291729448234374709852429885984987094307177760741403086538949190424454337896501402430653783597070178968921411867485584517214777073301007918941216316241784521708</span></span><br><span class="line">n10 = <span class="number">13890749889361612188368868998653029697326614782260719535555306236512452110708495623964530174188871342332417484996749651846510646453983388637377706674890018646246874688969342600780781646175634455109757266442675502522791531161284420286435654971819525519296719668701529481662071464145515727217108362496784024871976015116522898184301395037566514980846499856316532479656908169681719288258287756566886281183699239684997698487409138330229321935477734921670373632304542254938831218652340699024011371979519574576890581492623709896310465567043899767342676912434857372520308852745792360420376574037705943820090308501053778144141</span></span><br><span class="line">c10 = <span class="number">6250115196713939477947942995075509357173312813431601073354390451609559579925704891503987992181988654989477525811826607070378476102616752398280691012244301950194800995432882828020405062344160270290542566163969692748126314259624623341922057435728127596172871894887055305291345372720594481096374310285437492746765510292863238933163142677773310305789984897974266961231555124787205980411992251387207335655129551950825339766848166539671565212408741432649813058363660321480995187545006718837863674527475323414266732366507905974800565463011676462244368010182725161416783875646259625352308599198614681446394427674340328493047</span></span><br><span class="line">n11 = <span class="number">21457499145521259498911107987303777576783467581104197687610588208126845121702391694574491025398113729462454256070437978257494064504146718372095872819969887408622112906108590961892923178192792218161103488204912792358327748493857104191029765218471874759376809136402361582721860433355338373725980783308091544879562698835405262108188595630215081260699112737457564998798692048522706388318528370551365364702529068656665853097899157141017378975007689790000067275142731212069030175682911154288533716549782283859340452266837760560153014200605378914071410125895494331253564598702942990036163269043699029806343766286247742865671</span></span><br><span class="line">c11 = <span class="number">6269656777204332618433779865483197625538144405832409880710764183039800286008967127279281167109250083159801218370191973055663058165456565194979210256278526713608759141588082614531352489547674696723140599892318118960648862531538435596775798128845789504910467783731144808685373807716609662688064728614003904579841055786083326311313295311152563668422289435606771091246147867715987583149743032723028324394173498623642539175178996531881058274717907066845565199058931743481410454382746158558886667761300257488769795092777021292335562818583719708133179974425584610403335487082478848975656282384575767178925517257692365828720</span></span><br><span class="line"></span><br><span class="line">n = [n1,n2,n3,n4,n5,n6,n7,n8,n9,n10,n11]</span><br><span class="line">c = [c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(n)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i):</span><br><span class="line">        <span class="keyword">if</span>(GCD(n[i],n[j]) != <span class="number">1</span>):</span><br><span class="line">            p = GCD(n[i],n[j])</span><br><span class="line">            q = n[i] // p</span><br><span class="line">            phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">            d = inverse(e,phi)</span><br><span class="line">            m = <span class="built_in">pow</span>(c[i],d,n[i])</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">            exit()</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>moectf{it_is_re@lly_@_signin_level_cryPto_ch@ll@nge_ng92WPIBung92WPIBun}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="xorrrrrrrrr"><a href="#xorrrrrrrrr" class="headerlink" title="xorrrrrrrrr"></a>xorrrrrrrrr</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">èŠå£«ä»€ä¹ˆè¿ç®—ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">b&#x27;moectf&#123;&#x27;</span>) <span class="keyword">and</span> flag.endswith(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line">article = <span class="built_in">open</span>(<span class="string">&#x27;article.txt&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">strxor = <span class="keyword">lambda</span> x,y: <span class="built_in">bytes</span>([a^b <span class="keyword">for</span> a,b <span class="keyword">in</span> <span class="built_in">zip</span>(x,y)])</span><br><span class="line"></span><br><span class="line">result = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    range_start = random.randint(<span class="number">0</span>, <span class="built_in">len</span>(article) - <span class="built_in">len</span>(flag))</span><br><span class="line">    mask = article[range_start:range_start + <span class="built_in">len</span>(flag)]</span><br><span class="line">    result.append(strxor(flag,mask))</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;result.log&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> fs:</span><br><span class="line">    fs.writelines([<span class="built_in">str</span>(i)+<span class="string">&quot;\n&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> result])</span><br></pre></td></tr></table></figure>
<p>ç»å…¸çš„MTPï¼Œç”¨ç›¸åŒçš„flagä¸²åå¤ä¸æ–‡æœ¬éšæœºæ®µè½å¼‚æˆ–ï¼Œå¹¶ç»™å‡ºäº†æ¯ä¸€æ¬¡å¼‚æˆ–åçš„å¯†æ–‡ã€‚</p>
<p>ç”±äºç›´åˆ°flagå¼€å¤´ä¸º<code>moectf&#123;</code>ï¼Œå› æ­¤å¯ä»¥å½“ä½œå¯†é’¥ä¾æ¬¡è§£å¯†å„æ®µæ–‡æœ¬ï¼Œå¹¶åˆ†æå¯èƒ½çš„åç»­æ–‡æœ¬çš„å•è¯ã€‚åˆ†æå‡ºæ¥åå»¶é•¿å·²çŸ¥çš„å¯†é’¥ï¼Œå¦‚æ­¤åå¤ã€‚æˆ‘å°±æ˜¯è¿™æ ·æ‰‹åŠ¨åšçš„ï¼Œå¤§æ¦‚èŠ±è´¹äº†ä¸€å°æ—¶ã€‚</p>
<p>flagï¼š</p>
<p><strong>moectf{W0W_y0U_HaVe_mastered_tHe_x0r_0Peart0r!_0iYlJf!M3rux9G9Vf!JoxiMl}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="ez-chain"><a href="#ez-chain" class="headerlink" title="ez_chain"></a>ez_chain</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä½ è¯´çš„å¯¹ï¼Œä½†æ˜¯æˆ‘çš„keyå‘¢ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;key.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> fs:</span><br><span class="line">    key = <span class="built_in">int</span>(fs.read().strip())</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> fs:</span><br><span class="line">    flag = fs.read().strip()</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">72</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">base = bytes_to_long(<span class="string">b&quot;koito&quot;</span>)</span><br><span class="line">iv = <span class="number">3735927943</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">blockize</span>(<span class="params">long</span>):</span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">while</span> long &gt; <span class="number">0</span>:</span><br><span class="line">        out.append(long % base)</span><br><span class="line">        long //= base</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(<span class="built_in">reversed</span>(out))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">blocks = blockize(m)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_block_cbc</span>(<span class="params">blocks, iv, key</span>):</span><br><span class="line">    encrypted = [iv]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(blocks)):</span><br><span class="line">        encrypted.append(blocks[i] ^ encrypted[i] ^ key)</span><br><span class="line">    <span class="keyword">return</span> encrypted[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(encrypt_block_cbc(blocks, iv, key))</span><br><span class="line"><span class="comment"># [8490961288, 122685644196, 349851982069, 319462619019, 74697733110, 43107579733, 465430019828, 178715374673, 425695308534, 164022852989, 435966065649, 222907886694, 420391941825, 173833246025, 329708930734]</span></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®é¦–å…ˆå°†flagä¸²è½¬ä¸ºä¸€ä¸ªå¤§æ•´æ•°ï¼Œå¹¶ä¸”å°†å¤§æ•´æ•°æŒ‰å¦‚ä¸‹æ–¹å¼è½¬åŒ–ä¸ºä¸€ä¸ªåˆ—è¡¨ï¼š</p>
<script type="math/tex; mode=display">
flag = a[n]*base^n+a[n-1]*base^{n-1}+...+a[1]*base^1 + a[0]*base[0]</script><p>å¯ä»¥å‘ç°ï¼Œè¿™ç§æ–¹å¼å…¶å®å°±æ˜¯æŠŠflagè½¬åŒ–æˆäº†ä¸€ä¸ªbaseè¿›åˆ¶æ•°ï¼Œå¹¶å°†ç³»æ•°å­˜å‚¨åœ¨<code>blocks</code>åˆ—è¡¨ä¸­ã€‚</p>
<p>åœ¨è¿™ä¹‹åï¼Œé¢˜ç›®è¿›è¡Œäº†ä¸€ä¸ªç±»ä¼¼äºCBCæ¨¡å¼çš„åŠ å¯†ï¼Œåˆ—ä¸¾ä¸€ä¸‹å‰ä¸‰é¡¹ï¼š</p>
<script type="math/tex; mode=display">
enc[0] = iv\\
enc[1] = blocks[0]\oplus enc[0]\oplus key\\
enc[2] = blocks[1]\oplus enc[1]\oplus key</script><p>æŠŠ<code>enc[i]</code>çš„å†…å®¹ä»£å…¥åˆ°<code>enc[i+1]</code>ä¸­ï¼Œå°±å¯ä»¥å‘ç°ï¼š</p>
<script type="math/tex; mode=display">
enc[1] = blocks[0]\oplus iv\oplus key\\
enc[2] = blocks[1]\oplus (blocks[0]\oplus iv\oplus key)\oplus key</script><p>æ¶ˆæ‰keyï¼Œå¯ä»¥å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
enc[2] = blocks[1]\oplus blocks[0]\oplus iv</script><p>ä¾æ­¤ç±»æ¨ï¼Œå°±å¯ä»¥æ¨å‡ºå‰©ä½™çš„<code>enc[i]</code>ï¼š</p>
<script type="math/tex; mode=display">
enc[2] = blocks[1]\oplus blocks[0]\oplus iv\\
enc[3] =  blocks[2]\oplus blocks[1]\oplus blocks[0]\oplus iv\oplus key\\
enc[4] =  blocks[3]\oplus blocks[2]\oplus blocks[1]\oplus blocks[0]\oplus iv\\
...\\
enc[n] = (\bigoplus\limits_{i=0}^{n-1}blocks[i]) \oplus iv \;(\oplus key)</script><p>ä¸¤ä¸¤ç»„åˆä¸€ä¸‹ï¼Œå°±å¯ä»¥å¾—åˆ°æ‰€æœ‰çš„ï¼š</p>
<script type="math/tex; mode=display">
blocks[i]\oplus key</script><p>å› æ­¤ï¼Œåªè¦æ‹¥æœ‰ä»»ä½•ä¸€æ®µ<code>blocks[i]</code>ï¼Œå°±å¯ä»¥è¿˜åŸå‡ºkeyï¼Œä»è€Œè§£å¯†æ‰€æœ‰æ®µã€‚è€Œå¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬çŸ¥é“flagå¼€å¤´æ€»æ˜¯<code>moectf&#123;</code>ï¼Œå…¶è½¬åŒ–ä¸ºæ•´æ•°æ˜¯å¤§äºbaseçš„ï¼Œå› æ­¤<code>blocks[0]</code>æ˜¯å¯ä»¥è®¡ç®—å‡ºæ¥çš„ï¼Œå› æ­¤å¯ä»¥è¿›è¡Œå®Œæ•´æ˜æ–‡è§£å¯†ã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">base = bytes_to_long(<span class="string">b&quot;koito&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#éªŒè¯å¯ä»¥å‘ç°ï¼Œç”±äºå¼€å¤´æ’ä¸ºmoectf&#123;ï¼Œæ‰€ä»¥æ˜æ–‡ç¬¬ä¸€å—ä¸å˜</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">f = b&quot;moectf&#123;&quot; + 64*b&quot;\x00&quot; + b&quot;&#125;&quot;</span></span><br><span class="line"><span class="string">def blockize(long):</span></span><br><span class="line"><span class="string">    out = []</span></span><br><span class="line"><span class="string">    while long &gt; 0:</span></span><br><span class="line"><span class="string">        out.append(long % base)</span></span><br><span class="line"><span class="string">        long //= base</span></span><br><span class="line"><span class="string">    return list(reversed(out))</span></span><br><span class="line"><span class="string">blocks = blockize(bytes_to_long(f))</span></span><br><span class="line"><span class="string">print(blocks)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">iv = <span class="number">3735927943</span></span><br><span class="line">c = [<span class="number">8490961288</span>, <span class="number">122685644196</span>, <span class="number">349851982069</span>, <span class="number">319462619019</span>, <span class="number">74697733110</span>, <span class="number">43107579733</span>, <span class="number">465430019828</span>, <span class="number">178715374673</span>, <span class="number">425695308534</span>, <span class="number">164022852989</span>, <span class="number">435966065649</span>, <span class="number">222907886694</span>, <span class="number">420391941825</span>, <span class="number">173833246025</span>, <span class="number">329708930734</span>]</span><br><span class="line">m0 = <span class="number">5329712293</span></span><br><span class="line">key = m0^iv^c[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">m = [m0]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(c)):</span><br><span class="line">    m.append(c[i]^c[i-<span class="number">1</span>]^key)</span><br><span class="line"></span><br><span class="line">flag = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">    flag += base**(<span class="built_in">len</span>(m)-i-<span class="number">1</span>) * m[i]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(flag))</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>moectf{thE_c6c_Is_not_so_hard_9ifxi9i!JGofMJ36D9cPMxroif6!M6oSMuliPPcA3}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="flag-exchange"><a href="#flag-exchange" class="headerlink" title="flag_exchange"></a>flag_exchange</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">â€œä½ è¿™flagå¤šå°‘é’±ä¸€æ–¤ï¼Ÿâ€</span><br><span class="line">â€œç™½ç»™ã€‚â€</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> isPrime</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> fs:</span><br><span class="line">    flag = fs.read().strip()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">diffie_hellman</span>(<span class="params">p, flag</span>):</span><br><span class="line">    alice_privKey = getrandbits(<span class="number">1024</span>)</span><br><span class="line">    alice_pubKey = <span class="built_in">pow</span>(<span class="number">7</span>, alice_privKey, p)</span><br><span class="line">    bob_privKey = getrandbits(<span class="number">1024</span>)</span><br><span class="line">    bob_pubKey = <span class="built_in">pow</span>(<span class="number">7</span>, bob_privKey, p)</span><br><span class="line"></span><br><span class="line">    superkey = <span class="built_in">pow</span>(bob_pubKey, alice_privKey, p)</span><br><span class="line">    m = <span class="built_in">int</span>.from_bytes(flag, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> (m * superkey) % p, alice_pubKey, bob_pubKey</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Callable</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chall</span>(<span class="params"><span class="built_in">input</span>:<span class="type">Callable</span>[[<span class="built_in">str</span>],<span class="literal">None</span>], <span class="built_in">print</span>:<span class="type">Callable</span>[[<span class="built_in">str</span>],<span class="literal">None</span>]</span>):</span><br><span class="line">    p = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;P = &quot;</span>))</span><br><span class="line">    <span class="keyword">if</span> isPrime(p) <span class="keyword">and</span> p.bit_length() &gt;= <span class="number">1024</span>:</span><br><span class="line">        c, alice_pubKey, bob_pubKey = diffie_hellman(p, flag)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Alice&#x27;s public key: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(alice_pubKey))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Bob&#x27;s public key: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(bob_pubKey))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Ciphertext: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(c))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Invalid P&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®åŸºäºDiffie-Hellmanå¯†é’¥äº¤æ¢åè®®ï¼Œå…·ä½“æµç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>éšæœºç”ŸæˆAliceã€Bobçš„ç§é’¥ï¼Œè®°ä¸ºaã€b</li>
<li>è®¡ç®—Aliceã€Bobçš„å…¬é’¥ï¼Œåˆ†åˆ«ä¸ºï¼š</li>
</ul>
<script type="math/tex; mode=display">
puba = 7^a\quad (mod\;p)\\
pubb = 7^b\quad (mod\;p)</script><ul>
<li>è®¡ç®—å‡ºå…¬å…±å¯†é’¥ï¼š</li>
</ul>
<script type="math/tex; mode=display">
key = 7^{a*b}\quad(mod\;p)</script><ul>
<li>ç„¶åå°†flagå¯¹åº”çš„æ˜æ–‡ç”¨å…¬å…±å¯†é’¥è¿›è¡Œå¦‚ä¸‹åŠ å¯†ï¼š</li>
</ul>
<script type="math/tex; mode=display">
cipher = m*key\quad(mod\;p)</script><p>è€Œæˆ‘ä»¬èƒ½åšçš„ï¼Œå°±æ˜¯å‘é€ç»™é¶æœºç«¯ä¸€ä¸ªå¤§äº1024bitçš„pï¼Œä¹‹åé¶æœºç«¯ä¼šç”¨è¯¥pç”Ÿæˆå„ä¸ªå¯†é’¥ï¼Œå¹¶è¿”å›ç»™æˆ‘ä»¬å¯†æ–‡ä»¥åŠAliceã€Bobçš„å…¬é’¥ã€‚è€Œå¦‚æœèƒ½æ±‚å‡º<code>key</code>ï¼Œé‚£ä¹ˆè§£å¯†æ˜¯ç®€å•çš„ï¼Œåªéœ€è¦ï¼š</p>
<script type="math/tex; mode=display">
m = cipher * key^{-1}\quad(mod\;p)</script><p>å› æ­¤ï¼Œæˆ‘ä»¬çš„ä»»åŠ¡å°±å˜æˆäº†ï¼šå·²çŸ¥</p>
<script type="math/tex; mode=display">
puba = 7^a\quad (mod\;p)\\
pubb = 7^b\quad (mod\;p)</script><p>æ±‚ï¼š</p>
<script type="math/tex; mode=display">
key = 7^{a*b}\quad(mod\;p)</script><p>è¿™å®è´¨ä¸Šæ˜¯ä¸€ä¸ªCDHé—®é¢˜ã€‚è€Œçªç ´ç‚¹å°±åœ¨äºï¼Œç¾¤Gæ˜¯ç”±æˆ‘ä»¬ç»™å‡ºçš„ç´ æ•°pç”Ÿæˆçš„ï¼Œè€Œå½“p-1å…‰æ»‘æ—¶ï¼Œæ±‚è§£ç¦»æ•£å¯¹æ•°é—®é¢˜ä¼šå˜å¾—å®¹æ˜“ã€‚å› æ­¤æˆ‘ä»¬åªéœ€è¦ä½¿ç”Ÿæˆçš„pæ»¡è¶³p-1å…‰æ»‘å³å¯ã€‚</p>
<p>exp.pyï¼š(ç¾ŠåŸæ¯çš„æ—¶å€™å·²ç»ç”Ÿæˆäº†ä¸€ä¸ªæ»¡è¶³è¦æ±‚çš„pï¼Œä¾ç„¶å¯ä»¥ç”¨)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">è¿™ä¸€éƒ¨åˆ†äº¤äº’æ‹¿æ•°æ®</span></span><br><span class="line"><span class="string">r = remote(&quot;localhost&quot;,59807)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">p = 11008176197295908754556650686251647243706292498034472501168046085732945809887313362518690275918394335207633925834115240024616753739067618316748808578650362774171917441376968722226626556434005996618900469687913893028687318661542559912265616293448246676128025762514511346750336107659243985471781068580223900395847</span></span><br><span class="line"><span class="string">p = str(p).encode()</span></span><br><span class="line"><span class="string">r.sendline(p)</span></span><br><span class="line"><span class="string">r.interactive()</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#sage</span></span><br><span class="line">p = <span class="number">11008176197295908754556650686251647243706292498034472501168046085732945809887313362518690275918394335207633925834115240024616753739067618316748808578650362774171917441376968722226626556434005996618900469687913893028687318661542559912265616293448246676128025762514511346750336107659243985471781068580223900395847</span></span><br><span class="line">a_pub = <span class="number">3041998234690140733154003929351315749694173007295647496020072713756720943209175213390528908881513815372353043112125543782015504010903067412373671589783193113333759484653654593846608999327295977564591176273803313231805537606967793412594198900106990579441541583887521372737380085485236123798080560570278014966702</span></span><br><span class="line">b_pub = <span class="number">5019111378107696236906829966236801209683272037829678336595795065089184558620835243572805945837441564532780156063311684567652666178983348141519659763620244199977854812815568555236825281860924772124922980859797186639597490335115982316718963668010854994814229912399401172971794319506936755236803999795167503841257</span></span><br><span class="line">c = <span class="number">5757579635901147336595005390089603141773004178520561180663592936976073539821329993954175682240078485514741790990274876586653742472291327751694366705347330014705598863958938830082576802663476872305215648921055853375365278016644634303502905192252207112762958399098960852167171887363633849097395446708067829178184</span></span><br><span class="line"></span><br><span class="line">g = <span class="number">7</span></span><br><span class="line">a = discrete_log(mod(a_pub,p),mod(g,p))</span><br><span class="line">b = discrete_log(mod(b_pub,p),mod(g,p))</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">int</span>(c * <span class="built_in">pow</span>(<span class="number">7</span>,-(a*b),p) %p)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>moectf{diffie_he11man_key_exChange_is_not_so_hard_2WPIBung92WPIBung9?WP}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="giant-e"><a href="#giant-e" class="headerlink" title="giant_e"></a>giant_e</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä½ è¿™ä¸ªeï¼Œçº¢è±†æ³¥å‘†èƒ¶å¸ƒå¾—ä¸å™¶ï¼Ÿï¼ˆ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> fs:</span><br><span class="line">    flag = fs.read().strip()</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">0x609778981bfbb26bb93398cb6d96984616a6ab08ade090c1c0d4fedb00f44f0552a1555efec5cc66e7960b61e94e80e7483b9f906a6c8155a91cdc3e4917fa5347c58a2bc85bb160fcf7fe98e3645cfea8458ea209e565e4eb72ee7cbb232331a862d8a84d91a0ff6d74aa3c779b2b129c3d8148b090c4193234764f2e5d9b2170a9b4859501d07c0601cdd18616a0ab2cf713a7c785fd06f27d68dff24446d884644e08f31bd37ecf48750e4324f959a8d37c5bef25e1580851646d57b3d4f525bc04c7ddafdf146539a84703df2161a0da7a368675f473065d2cb661907d990ba4a8451b15e054bfc4dd73e134f3bf7d8fa4716125d8e21f946d16b7b0fc43</span></span><br><span class="line">m = <span class="built_in">int</span>.from_bytes(flag,<span class="string">&quot;big&quot;</span>)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(n) <span class="comment"># 0xbaa70ba4c29eb1e6bb3458827540fce84d40e1c966db73c0a39e4f9f40e975c42e02971dab385be27bd2b0687e2476894845cc46e55d9747a5be5ca9d925931ca82b0489e39724ea814800eb3c0ea40d89ebe7fe377f8d3f431a68d209e7a149851c06a4e67db7c99fcfd9ec19496f29d59bb186feb44a36fe344f11d047b9435a1c47fa2f8ed72f59403ebb0e439738fd550a7684247ab7da64311690f461e6dce03bf2fcd55345948a3b537087f07cd680d7461d326690bf21e39dff30268cb33f86eeceff412cd63a38f7110805d337dcad25e6f7e3728b53ca722b695b0d9db37361b5b63213af50dd69ee8b3cf2085f845d7932c08b27bf638e98497239</span></span><br><span class="line"><span class="built_in">print</span>(c) <span class="comment"># 0x45a9ce4297c8afee693d3cce2525d3399c5251061ddd2462513a57f0fd69bdc74b71b519d3a2c23209d74fcfbcb6b196b5943838c2441cb34496c96e0f9fc9f0f80a2f6d5b49f220cb3e78e36a4a66595aa2dbe3ff6e814d84f07cb5442e2d5d08d08aa9ccde0294b39bfde79a6c6dcd2329e9820744c4deb34a039da7933ddf00b0a0469afb89cba87490a39783a9b2f8f0274f646ca242e78a326dda886c213bc8d03ac1a9150de4ba08c5936c3fe924c8646652ef85aa7ac0103485f472413427a0e9d9a4d416b99e24861ca8499500c693d7a07360158ffffa543480758cafff2a09a9f6628f92767764fa026d48a9dd899838505ae16e38910697f9de14</span></span><br></pre></td></tr></table></figure>
<p>eè¿‡å¤§è¯´æ˜ç§é’¥då¾ˆå¯èƒ½è¾ƒå°ï¼Œå› æ­¤å¯ä»¥é‡‡ç”¨wieneræ”»å‡»ã€‚</p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#1</span></span><br><span class="line">n = <span class="number">0xbaa70ba4c29eb1e6bb3458827540fce84d40e1c966db73c0a39e4f9f40e975c42e02971dab385be27bd2b0687e2476894845cc46e55d9747a5be5ca9d925931ca82b0489e39724ea814800eb3c0ea40d89ebe7fe377f8d3f431a68d209e7a149851c06a4e67db7c99fcfd9ec19496f29d59bb186feb44a36fe344f11d047b9435a1c47fa2f8ed72f59403ebb0e439738fd550a7684247ab7da64311690f461e6dce03bf2fcd55345948a3b537087f07cd680d7461d326690bf21e39dff30268cb33f86eeceff412cd63a38f7110805d337dcad25e6f7e3728b53ca722b695b0d9db37361b5b63213af50dd69ee8b3cf2085f845d7932c08b27bf638e98497239</span></span><br><span class="line">c = <span class="number">0x45a9ce4297c8afee693d3cce2525d3399c5251061ddd2462513a57f0fd69bdc74b71b519d3a2c23209d74fcfbcb6b196b5943838c2441cb34496c96e0f9fc9f0f80a2f6d5b49f220cb3e78e36a4a66595aa2dbe3ff6e814d84f07cb5442e2d5d08d08aa9ccde0294b39bfde79a6c6dcd2329e9820744c4deb34a039da7933ddf00b0a0469afb89cba87490a39783a9b2f8f0274f646ca242e78a326dda886c213bc8d03ac1a9150de4ba08c5936c3fe924c8646652ef85aa7ac0103485f472413427a0e9d9a4d416b99e24861ca8499500c693d7a07360158ffffa543480758cafff2a09a9f6628f92767764fa026d48a9dd899838505ae16e38910697f9de14</span></span><br><span class="line">e = <span class="number">0x609778981bfbb26bb93398cb6d96984616a6ab08ade090c1c0d4fedb00f44f0552a1555efec5cc66e7960b61e94e80e7483b9f906a6c8155a91cdc3e4917fa5347c58a2bc85bb160fcf7fe98e3645cfea8458ea209e565e4eb72ee7cbb232331a862d8a84d91a0ff6d74aa3c779b2b129c3d8148b090c4193234764f2e5d9b2170a9b4859501d07c0601cdd18616a0ab2cf713a7c785fd06f27d68dff24446d884644e08f31bd37ecf48750e4324f959a8d37c5bef25e1580851646d57b3d4f525bc04c7ddafdf146539a84703df2161a0da7a368675f473065d2cb661907d990ba4a8451b15e054bfc4dd73e134f3bf7d8fa4716125d8e21f946d16b7b0fc43</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ContinuedFraction</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, numerator, denumerator</span>):</span><br><span class="line">        self.numberlist = []  <span class="comment"># number in continued fraction</span></span><br><span class="line">        self.fractionlist = []  <span class="comment"># the near fraction list</span></span><br><span class="line">        self.GenerateNumberList(numerator, denumerator)</span><br><span class="line">        self.GenerateFractionList()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">GenerateNumberList</span>(<span class="params">self, numerator, denumerator</span>):</span><br><span class="line">        <span class="keyword">while</span> numerator != <span class="number">1</span>:</span><br><span class="line">            quotient = numerator // denumerator</span><br><span class="line">            remainder = numerator % denumerator</span><br><span class="line">            self.numberlist.append(quotient)</span><br><span class="line">            numerator = denumerator</span><br><span class="line">            denumerator = remainder</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">GenerateFractionList</span>(<span class="params">self</span>):</span><br><span class="line">        self.fractionlist.append([self.numberlist[<span class="number">0</span>], <span class="number">1</span>])</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(self.numberlist)):</span><br><span class="line">            numerator = self.numberlist[i]</span><br><span class="line">            denumerator = <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i):</span><br><span class="line">                temp = numerator</span><br><span class="line">                numerator = denumerator + numerator * self.numberlist[i - j - <span class="number">1</span>]</span><br><span class="line">                denumerator = temp</span><br><span class="line">            self.fractionlist.append([numerator, denumerator])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = ContinuedFraction(e, n)</span><br><span class="line"><span class="keyword">for</span> k, d <span class="keyword">in</span> a.fractionlist:</span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">    flag = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;moectf&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>moectf{too_larGe_exponent_is_not_a_iDea_too!_Bung92WPIBung92WPIBung9?WP}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="minipack"><a href="#minipack" class="headerlink" title="minipack"></a>minipack</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">super backpack!!!</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> fs:</span><br><span class="line">    flag = fs.read().strip()</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">72</span></span><br><span class="line">m = <span class="built_in">int</span>.from_bytes(<span class="string">b&quot;\xff&quot;</span> + flag + <span class="string">b&quot;\xff&quot;</span>, <span class="string">&quot;big&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">long2bits</span>(<span class="params">long</span>):</span><br><span class="line">    bits = []</span><br><span class="line">    <span class="keyword">while</span> long &gt; <span class="number">0</span>:</span><br><span class="line">        bits.append(long &amp; <span class="number">1</span>)</span><br><span class="line">        long &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(<span class="built_in">reversed</span>(bits))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genkey</span>(<span class="params"><span class="built_in">len</span></span>):</span><br><span class="line">    <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>):</span><br><span class="line">        delta = random.randint(<span class="number">1</span>, <span class="number">10000</span>)</span><br><span class="line">        x = <span class="built_in">sum</span> + delta</span><br><span class="line">        out.append(x)</span><br><span class="line">        <span class="built_in">sum</span> += x</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = genkey(<span class="number">74</span> * <span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;key.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> fs:</span><br><span class="line">    fs.write(<span class="built_in">str</span>(key))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m, keys</span>):</span><br><span class="line">    data = long2bits(m)</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(data) == <span class="built_in">len</span>(keys)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span>((k <span class="keyword">if</span> (p == <span class="number">1</span>) <span class="keyword">else</span> <span class="number">1</span>) <span class="keyword">for</span> p, k <span class="keyword">in</span> <span class="built_in">zip</span>(data, keys))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;ciphertext.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> fs:</span><br><span class="line">    fs.write(<span class="built_in">str</span>(encrypt(m, key)))</span><br></pre></td></tr></table></figure>
<p>è§‚å¯Ÿå¯ä»¥å‘ç°ï¼Œè¿™ä¸ªèƒŒåŒ…å¯†ç ç”¨çš„æ˜¯è¶…é€’å¢åºåˆ—ï¼Œå› æ­¤å¯ä»¥ç›´æ¥ä»å°¾éƒ¨é€ä¸ªåˆ¤æ–­æ˜¯å¦åœ¨èƒŒåŒ…ä¸­ã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">key = </span><br><span class="line">c = <span class="number">44096612931024003148407895164090667174657344536623354666642108463093659898867859567157728084018394988840266329206836985537987081415020571845239234014695335928717091578810470705259929</span></span><br><span class="line"></span><br><span class="line">m = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)):</span><br><span class="line">    <span class="keyword">if</span>(c &gt; key[<span class="built_in">len</span>(key)-<span class="number">1</span>-i]):</span><br><span class="line">        m.append(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">        c -= key[<span class="built_in">len</span>(key)-<span class="number">1</span>-i]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m.append(<span class="string">&quot;0&quot;</span>)</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">int</span>(<span class="string">&quot;&quot;</span>.join(m)[::-<span class="number">1</span>],<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>moectf{superiNcreasiNg_sequeNce_is_useful_tO_cONstruct_a_KNapsacK_MAxSM}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="bad-random"><a href="#bad-random" class="headerlink" title="bad_random"></a>bad_random</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä½ èƒ½çŒœå‡ºè¿™ä¸ªéšæœºæ•°ç”Ÿæˆå™¨ç”Ÿæˆçš„ä¸‹ä¸€ä¸ªæ•°å—ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = f.read().strip()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LCG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">set_params</span>(<span class="params">self</span>):</span><br><span class="line">        self.m = random.randint(<span class="number">10000</span>, <span class="number">20000</span>)</span><br><span class="line">        self.a = random.randint(<span class="number">10000</span>, <span class="number">20000</span>)</span><br><span class="line">        self.c = random.randint(<span class="number">1</span>, self.a-<span class="number">1</span>)</span><br><span class="line">        self.x = random.randint(<span class="number">0</span>, self.m-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_all_output</span>(<span class="params">self</span>):</span><br><span class="line">        x0 = self.x</span><br><span class="line">        s = <span class="built_in">set</span>()</span><br><span class="line">        <span class="keyword">while</span> (t := self()) <span class="keyword">not</span> <span class="keyword">in</span> s:</span><br><span class="line">            s.add(t)</span><br><span class="line">        self.x = x0</span><br><span class="line">        <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.set_params()</span><br><span class="line">        <span class="keyword">while</span> <span class="built_in">len</span>(self.get_all_output()) &lt; <span class="number">10</span>:</span><br><span class="line">            self.set_params()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self</span>):</span><br><span class="line">        self.x = (self.a * self.x + self.c) % self.m</span><br><span class="line">        <span class="keyword">return</span> self.x</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Callable</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chall</span>(<span class="params"><span class="built_in">input</span>:<span class="type">Callable</span>[[<span class="built_in">str</span>],<span class="literal">None</span>], <span class="built_in">print</span>:<span class="type">Callable</span>[[<span class="built_in">str</span>],<span class="literal">None</span>]</span>):</span><br><span class="line">    <span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line">    <span class="keyword">from</span> string <span class="keyword">import</span> ascii_letters</span><br><span class="line">    s = <span class="string">&quot;&quot;</span>.join(random.choices(ascii_letters, k=<span class="number">16</span>))</span><br><span class="line">    h = md5(s.encode()).hexdigest()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;&lt;!&gt; md5(XXXXXXXX+<span class="subst">&#123;s[<span class="number">8</span>:]&#125;</span>) == <span class="subst">&#123;h&#125;</span>&quot;</span>)</span><br><span class="line">    i = <span class="built_in">input</span>(<span class="string">&quot;Give me XXXXXXXX: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> md5((i + s[<span class="number">8</span>:]).encode()).hexdigest() != h:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;&lt;!&gt; ACCESS DENIED &lt;!&gt;&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    inst = LCG()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Let&#x27;s play a simple game! If you can guess the right number, I will give your the flag! You have 10 tries&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> tries <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        i = <span class="built_in">input</span>(<span class="string">f&quot;Give me a number, you have failed for <span class="subst">&#123;tries&#125;</span> times: &quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">int</span>(i) == (right := inst()):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Congurations! You win the game! Your flag is here: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Oh, you are wrong! The right number is <span class="subst">&#123;right&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆè¦é€šè¿‡ä¸€ä¸ªmd5çš„çˆ†ç ´ï¼Œè¿™ä¸ªä¸ç”¨å¤šè¯´ï¼Œé€šè¿‡åè¿›å…¥ä¸»è¦ä»»åŠ¡ã€‚(é¢˜ç›®é™„ä»¶åº”è¯¥æ˜¯é”™äº†ï¼Œå®é™…å¹¶ä¸éœ€è¦çˆ†ç ´8ä½ï¼Œä»…éœ€è¦çˆ†ç ´4ä½)</p>
<p>ä¸»è¦ä»»åŠ¡å¦‚ä¸‹ï¼š</p>
<ul>
<li>é¶æœºç«¯éšæœºç”Ÿæˆä¸€ä¸ªLCGï¼Œå¹¶ä¸”å„å‚æ•°å‡æœªçŸ¥ã€‚</li>
<li>éšæœºç”Ÿæˆä¸€ä¸ªç§å­xï¼Œä»¥å…¶ä¸ºåŸºç¡€ç”Ÿæˆåç»­ä¼ªéšæœºæ•°ã€‚</li>
<li>æˆ‘ä»¬æœ‰åæ¬¡æœºä¼šçŒœæµ‹ä¸‹ä¸€ä¸ªä¼ªéšæœºæ•°æ˜¯ä»€ä¹ˆã€‚å¦‚æœçŒœé”™ï¼Œé¶æœºç«¯ä¼šå‘Šè¯‰ä½ æ­£ç¡®çš„å½“å‰æ•°åº”è¯¥æ˜¯å¤šå°‘ï¼›å¦‚æœçŒœå¯¹åˆ™ç»™flagã€‚</li>
</ul>
<p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨10æ¬¡ä»¥å†…æ­£ç¡®æ¢å¤æœ¬æ¬¡LCGçš„å‚æ•°ï¼Œå¹¶æ­£ç¡®é¢„æµ‹ä¸‹ä¸€ä¸ªä¼ªéšæœºæ•°ã€‚è€Œå…¶å®5ç»„æ•°æ®å°±å¯ä»¥ï¼Œæ¨å¯¼å¦‚ä¸‹:</p>
<script type="math/tex; mode=display">
x[1] \equiv a*x[0] + c\quad(mod \;m)\\
x[2] \equiv a*x[1] + c\quad(mod \;m)\\
x[3] \equiv a*x[2] + c\quad(mod \;m)\\
x[4] \equiv a*x[3] + c\quad(mod \;m)\\
x[5] \equiv a*x[4] + c\quad(mod \;m)</script><p>æœ‰ï¼š</p>
<script type="math/tex; mode=display">
x[4]-x[3]\equiv a*(x[3]-x[2])\quad(mod\;m)\\
x[3]-x[2]\equiv a*(x[2]-x[1])\quad(mod\;m)</script><p>æ‰€ä»¥ï¼š</p>
<script type="math/tex; mode=display">
x[4]-x[3]\equiv a^2*(x[2]-x[1])\quad(mod\;m)\\
(x[4]-x[3])*(x[2]-x[1])\equiv a^2*(x[2]-x[1])^2\quad(mod\;m)</script><p>åˆå› ä¸ºï¼š</p>
<script type="math/tex; mode=display">
(x[3]-x[2])^2\equiv a^2*(x[2]-x[1])^2\quad(mod\;m)</script><p>æ‰€ä»¥ï¼š</p>
<script type="math/tex; mode=display">
(x[4]-x[3])*(x[2]-x[1]) -(x[3]-x[2])^2\equiv 0\quad(mod\;m)</script><p>å³ï¼š</p>
<script type="math/tex; mode=display">
(x[4]-x[3])*(x[2]-x[1]) -(x[3]-x[2])^2 = k1*m</script><p>åŒç†æœ‰ï¼š</p>
<script type="math/tex; mode=display">
(x[5]-x[4])*(x[3]-x[2]) -(x[4]-x[3])^2 = k2*m</script><p>å› æ­¤æ±‚è§£ä¸¤è€…gcdä¾¿å¯ä»¥å¾—åˆ°m(è¿™é‡Œå­˜åœ¨ä¸€ç‚¹é—®é¢˜ï¼Œå…ˆå‡è®¾æˆ‘ä»¬å¾—åˆ°çš„å°±æ˜¯mè€Œä¸æ˜¯k*m)ï¼š</p>
<p>å¾—åˆ°måï¼Œæˆ‘ä»¬åªéœ€è¦åˆ©ç”¨ä¸€ä¸ªå¼å­å°±å¯ä»¥æ±‚å‡ºaï¼š</p>
<script type="math/tex; mode=display">
a \equiv (x[5]-x[4])*(x[4]-x[3])^{-1}\quad(mod\;m)</script><p>æ±‚å‡ºaåï¼Œæ¢å¤cæ˜¯ç®€å•çš„ï¼Œè¿™æ ·ä¸€æ¥æˆ‘ä»¬å°±é¡ºåˆ©å¾—åˆ°äº†LCGçš„æ‰€æœ‰å‚æ•°ï¼Œå› æ­¤åªéœ€è¦å†è®¡ç®—ä¸€éï¼š</p>
<script type="math/tex; mode=display">
x[6] \equiv a*x[5] + c\quad(mod \;m)</script><p>å¹¶æäº¤<code>x[6]</code>ï¼Œå°±å¯ä»¥ä»é¶æœºç«¯æ”¶åˆ°flagã€‚</p>
<p>ä½†æ˜¯è¿™æ ·å­˜åœ¨ä¸€å®šå¤±è´¥çš„æ¦‚ç‡ï¼Œè¿™æ˜¯å› ä¸ºæœ¬é¢˜ä¸­ï¼Œmå¹¶ä¸æ˜¯ç´ æ•°ï¼Œè€Œæ˜¯ä¸€ä¸ªéšæœºæ•°ï¼Œè¿™å¯¼è‡´äº†ä¸¤ä¸ªæ½œåœ¨é—®é¢˜ï¼š</p>
<ul>
<li>ç¬¬ä¸€æ­¥å¾—åˆ°çš„kmï¼Œå¯èƒ½å¹¶ä¸å¥½ç¡®å®šåˆ°åº•kæ˜¯å¤šå°‘ï¼Œå› ä¸ºæ— æ³•é€šè¿‡æ¶ˆé™¤kmçš„å°å› å­æ¥å¾—åˆ°m</li>
<li>å¦‚æœmä¸æ˜¯ç´ æ•°ï¼Œgcd((x[i+1]-x[i]),m)å¯èƒ½ä¸ä¸º1ï¼Œè¿™å°±å¯¼è‡´å…¶é€†å…ƒä¸å­˜åœ¨ï¼Œè€Œæ— æ³•æ±‚è§£aã€‚</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥ç®€å•æµ‹è¯•ä¸€ä¸‹10000-20000é—´ï¼Œmæ˜¯ç´ æ•°çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> isprime</span><br><span class="line"></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>,<span class="number">20000</span>):</span><br><span class="line">    <span class="keyword">if</span>(isprime(i)):</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(count / <span class="number">10000</span>)</span><br></pre></td></tr></table></figure>
<p>ç»“æœæ˜¯0.1033ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬éœ€è¦å¹³å‡åæ¬¡æ‰èƒ½è·å¾—ä¸€ä¸ªç´ æ•°mã€‚</p>
<p>ä¸è¿‡å¹¶ä¸ç®—ä¸€ä¸ªå¤§é—®é¢˜ï¼Œå¤šäº¤äº’å‡ æ¬¡å°±è¡Œäº†ã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_letters</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;localhost&quot;</span>,<span class="number">63150</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>():</span><br><span class="line">    temp = <span class="built_in">str</span>(r.recvline().strip())[<span class="number">2</span>:-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> ascii_letters:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> ascii_letters:</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> ascii_letters:</span><br><span class="line">                <span class="keyword">for</span> l <span class="keyword">in</span> ascii_letters:</span><br><span class="line">                    s = i+j+k+l + temp[<span class="number">13</span>:<span class="number">17</span>]</span><br><span class="line">                    h = md5(s.encode()).hexdigest()</span><br><span class="line">                    <span class="keyword">if</span>(h == temp[-<span class="number">32</span>:]):</span><br><span class="line">                        r.sendline((i+j+k+l).encode())</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">proof_of_work()</span><br><span class="line"></span><br><span class="line">x = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    r.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">    t = r.recvuntil(<span class="string">b&quot;number is&quot;</span>)</span><br><span class="line">    num = <span class="built_in">int</span>(r.recvline().decode())</span><br><span class="line">    x.append(num)</span><br><span class="line">    <span class="built_in">print</span>(t)</span><br><span class="line">    <span class="built_in">print</span>(num)</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ±‚m</span></span><br><span class="line">t1 = x[<span class="number">1</span>] - x[<span class="number">0</span>]</span><br><span class="line">t2 = x[<span class="number">2</span>] - x[<span class="number">1</span>]</span><br><span class="line">t3 = x[<span class="number">3</span>] - x[<span class="number">2</span>]</span><br><span class="line">t4 = x[<span class="number">4</span>] - x[<span class="number">3</span>]</span><br><span class="line">T1 = t4*t2 - t3*t3</span><br><span class="line">T2 = t3*t1 - t2*t2</span><br><span class="line">m = GCD(T1,T2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ±‚a,b</span></span><br><span class="line">a = inverse((x[<span class="number">1</span>] - x[<span class="number">0</span>]),m)*(x[<span class="number">2</span>] - x[<span class="number">1</span>]) % m</span><br><span class="line">b = (-a*x[<span class="number">1</span>] + x[<span class="number">2</span>]) % m</span><br><span class="line"></span><br><span class="line">xx = <span class="built_in">str</span>((a*x[-<span class="number">1</span>] + b) % m).encode()</span><br><span class="line">r.sendline(xx)</span><br><span class="line"><span class="built_in">print</span>((r.recvline()))</span><br><span class="line"><span class="built_in">print</span>((r.recvline()))</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>moectf{u5e_5ingle_lcg_a5_a_RanDoM_nuMbeR_geneRaToR_i5_noT_a_gooD_iDea!_}</strong></p>
<p>å…¶å®ä»”ç»†æƒ³ä¸€ä¸‹ï¼Œå› ä¸ºéšæœºæ•°æ€»æ˜¯å°äºmçš„ï¼Œè€Œmçš„èŒƒå›´æœ‰ç‚¹è¿‡å°ï¼Œå› æ­¤å®Œå…¨å¯ä»¥åå¤å‘é€æŸä¸ªæ•°(æ¯”å¦‚10)ï¼Œå¤šæ¬¡å‘é€åæ€»æœ‰å¯èƒ½çŒœå¯¹ï¼Œå¯èƒ½ä»ç„¶å¯ä»¥çŸ­æ—¶é—´å†…å°±å¾—åˆ°flag(æ—¶é—´ä¸»è¦èŠ±è´¹åœ¨md5çˆ†ç ´)</p>
<p><br></p>
<p><br></p>
<h3 id="broken-hash"><a href="#broken-hash" class="headerlink" title="broken_hash"></a>broken_hash</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä½ è¿™hashï¼Œä¿ç†Ÿå—</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">F</span>(<span class="params">x, y, z</span>):</span><br><span class="line">    <span class="keyword">return</span> ((x &amp; ~y) ^ (y &amp; ~z) ^ (z &amp; ~x)) ^ (</span><br><span class="line">        ((x + y) * (y + z) + (x + z)) &amp; <span class="number">0xFFFF_FFFF_FFFF_FFFF_FFFF_FFFF_FFFF_FFFF</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_block_hash</span>(<span class="params">a, b, c, d</span>):</span><br><span class="line">    x, y, z, w = F(a, b, c), F(b, c, d), F(c, d, a), F(d, a, b)</span><br><span class="line">    <span class="keyword">return</span> (a ^ b ^ c ^ d ^ x ^ y ^ z ^ w) ^ <span class="number">0xFFFF_FFFF_FFFF_FFFF_FFFF_FFFF_FFFF_FFFF</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_hash</span>(<span class="params">blocks: <span class="built_in">list</span>[<span class="built_in">int</span>]</span>):</span><br><span class="line">    length = <span class="built_in">len</span>(blocks)</span><br><span class="line">    <span class="keyword">if</span> length % <span class="number">4</span> != <span class="number">0</span>:</span><br><span class="line">        padding = <span class="number">4</span> - length % <span class="number">4</span></span><br><span class="line">        blocks += [<span class="number">0</span>] * padding</span><br><span class="line">        length += padding</span><br><span class="line">    <span class="keyword">if</span> length == <span class="number">4</span>:</span><br><span class="line">        <span class="keyword">return</span> _block_hash(*blocks)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        block_size = length // <span class="number">4</span></span><br><span class="line">        h1 = _<span class="built_in">hash</span>(blocks[:block_size])</span><br><span class="line">        h2 = _<span class="built_in">hash</span>(blocks[block_size : block_size * <span class="number">2</span>])</span><br><span class="line">        h3 = _<span class="built_in">hash</span>(blocks[block_size * <span class="number">2</span> : block_size * <span class="number">3</span>])</span><br><span class="line">        h4 = _<span class="built_in">hash</span>(blocks[block_size * <span class="number">3</span> :])</span><br><span class="line">        <span class="keyword">return</span> _block_hash(h1, h2, h3, h4)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bytes2blocks</span>(<span class="params">data: <span class="built_in">bytes</span>, block_size=<span class="number">16</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(data) % block_size != <span class="number">0</span>:</span><br><span class="line">        data += <span class="string">b&quot;\x00&quot;</span> * (block_size - <span class="built_in">len</span>(data) % block_size)</span><br><span class="line">    <span class="keyword">return</span> [</span><br><span class="line">        <span class="built_in">int</span>.from_bytes(data[i : i + block_size], <span class="string">&quot;little&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(data), block_size)</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hash</span>(<span class="params">*data: <span class="built_in">list</span>[<span class="built_in">bytes</span>]</span>):</span><br><span class="line">    <span class="keyword">return</span> _<span class="built_in">hash</span>(bytes2blocks(<span class="string">b&quot;&quot;</span>.join(data)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Callable</span></span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randbytes</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode,b64encode</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_letters</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> choices</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = f.read().strip()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chall</span>(<span class="params"><span class="built_in">input</span>: <span class="type">Callable</span>[[<span class="built_in">str</span>], <span class="literal">None</span>], <span class="built_in">print</span>: <span class="type">Callable</span>[[<span class="built_in">str</span>], <span class="literal">None</span>]</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">proof_of_work</span>():</span><br><span class="line"></span><br><span class="line">        s = <span class="string">&quot;&quot;</span>.join(choices(ascii_letters, k=<span class="number">16</span>))</span><br><span class="line">        h = md5(s.encode()).hexdigest()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;&lt;!&gt; md5(XXXXXXXX+<span class="subst">&#123;s[<span class="number">8</span>:]&#125;</span>) == <span class="subst">&#123;h&#125;</span>&quot;</span>)</span><br><span class="line">        i = <span class="built_in">input</span>(<span class="string">&quot;Give me XXXXXXXX: &quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> md5((i + s[<span class="number">8</span>:]).encode()).hexdigest() == h</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> proof_of_work():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;&lt;!&gt; ACCESS DENIED &lt;!&gt;&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    b = randbytes(<span class="number">256</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;this is a random bytes: <span class="subst">&#123;b64encode(b).decode()&#125;</span>&quot;</span>)</span><br><span class="line">    i = <span class="built_in">input</span>(<span class="string">&quot;give me another bytes with the same hash: &quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        d = b64decode(i)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;invaild input&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hash</span>(b) == <span class="built_in">hash</span>(d) <span class="keyword">and</span> d!=b:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;congurations! and your flag is <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>ä»»åŠ¡å¾ˆç®€å•ï¼Œæ ¹æ®ç»™å®šçš„å“ˆå¸Œå‡½æ•°ï¼Œå¯»æ‰¾ä¸€ä¸ªå“ˆå¸Œç¢°æ’å³å¯å¾—åˆ°flagã€‚</p>
<p>ç®€å•çœ‹ä¸€ä¸‹å“ˆå¸Œå‡½æ•°ï¼š</p>
<ul>
<li>æŠŠ256å­—èŠ‚çš„æ˜æ–‡æŒ‰æ¯16ä¸ªå­—èŠ‚åˆ†ä¸º16ç»„ã€‚</li>
<li>æ¯ä¸€ç»„çš„16å­—èŠ‚å†æŒ‰æ¯4ä¸ªå­—èŠ‚åˆ†ä¸º4ç»„ï¼Œè®°ä¸º(a,b,c,d)</li>
<li>å¯¹æ¯ä¸€å—è¿›è¡Œå¦‚ä¸‹å“ˆå¸Œåï¼Œå†ç»„åˆèµ·æ¥ï¼š</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">F</span>(<span class="params">x, y, z</span>):</span><br><span class="line">    <span class="keyword">return</span> ((x &amp; ~y) ^ (y &amp; ~z) ^ (z &amp; ~x)) ^ (</span><br><span class="line">        ((x + y) * (y + z) + (x + z)) &amp; <span class="number">0xFFFF_FFFF_FFFF_FFFF_FFFF_FFFF_FFFF_FFFF</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_block_hash</span>(<span class="params">a, b, c, d</span>):</span><br><span class="line">    x, y, z, w = F(a, b, c), F(b, c, d), F(c, d, a), F(d, a, b)</span><br><span class="line">    <span class="keyword">return</span> (a ^ b ^ c ^ d ^ x ^ y ^ z ^ w) ^ <span class="number">0xFFFF_FFFF_FFFF_FFFF_FFFF_FFFF_FFFF_FFFF</span></span><br></pre></td></tr></table></figure>
<p>å®¹æ˜“å‘ç°ï¼Œå¦‚æœ<code>_block_hash</code>å‡½æ•°æŒ‰ç…§(a,b,c,d)çš„é¡ºåºä¼ å‚ï¼Œå¾—åˆ°çš„æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
x1, y1, z1, w1 = F(a, b, c), F(b, c, d), F(c, d, a), F(d, a, b)</script><p>è€Œå¦‚æœæŒ‰ç…§(c,d,a,b)çš„é¡ºåºä¼ å‚ï¼Œå¾—åˆ°çš„æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
x2, y2, z2, w2 = F(c, d, a), F(d, a, b), F(a, b, c), F(b, c, d)</script><p>é‚£ä¹ˆå°±æœ‰ï¼š</p>
<script type="math/tex; mode=display">
x1=z2,y1=w2,z1=x2,w1=y2</script><p>å¯ä»¥è¯´ä»…ä»…æ˜¯è°ƒæ¢äº†ç›¸å¯¹ä½ç½®ï¼Œè€Œè¿™ç§ç›¸å¯¹ä½ç½®çš„è°ƒæ¢å¯¹äºå¼‚æˆ–è¿ç®—æ¥è¯´æ˜¯æ²¡æœ‰å½±å“çš„ï¼Œå› æ­¤æˆ‘ä»¬å°±æ‰¾åˆ°äº†ç¢°æ’ã€‚</p>
<p>exp.pyï¼š(æ³¨æ„éœ€è¦å°†æ»¡è¶³ç¢°æ’çš„å­—èŠ‚ä¸²ç”¨base64ç¼–ç åå†å‘é€)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_letters</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode,b64encode</span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line">r = remote(<span class="string">&quot;localhost&quot;</span>,<span class="number">65309</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>():</span><br><span class="line">    temp = <span class="built_in">str</span>(r.recvline().strip())[<span class="number">2</span>:-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> ascii_letters:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> ascii_letters:</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> ascii_letters:</span><br><span class="line">                <span class="keyword">for</span> l <span class="keyword">in</span> ascii_letters:</span><br><span class="line">                    s = i+j+k+l + temp[<span class="number">13</span>:<span class="number">17</span>]</span><br><span class="line">                    h = md5(s.encode()).hexdigest()</span><br><span class="line">                    <span class="keyword">if</span>(h == temp[-<span class="number">32</span>:]):</span><br><span class="line">                        r.sendline((i+j+k+l).encode())</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">proof_of_work()</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&quot;this is a random bytes:&quot;</span>)</span><br><span class="line">data1 = r.recvline().strip()</span><br><span class="line"><span class="comment">#print(data1)</span></span><br><span class="line">data2 = b64decode(data1)</span><br><span class="line">data3 = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    ta = data2[i*<span class="number">64</span>:i*<span class="number">64</span>+<span class="number">16</span>]</span><br><span class="line">    tb = data2[i*<span class="number">64</span>+<span class="number">16</span>:i*<span class="number">64</span>+<span class="number">32</span>]</span><br><span class="line">    tc = data2[i*<span class="number">64</span>+<span class="number">32</span>:i*<span class="number">64</span>+<span class="number">48</span>]</span><br><span class="line">    td = data2[i*<span class="number">64</span>+<span class="number">48</span>:i*<span class="number">64</span>+<span class="number">64</span>]</span><br><span class="line">    data3 += (tc+td+ta+tb)</span><br><span class="line"><span class="comment">#r.interactive()</span></span><br><span class="line">r.sendline(b64encode(data3))</span><br><span class="line"><span class="comment">#print(len(data3))</span></span><br><span class="line"><span class="built_in">print</span>(r.recvline())</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>moectf{a_hash_FUNCtioN_With_sYMMEtRY_is_vERY_vUlNERa6lE_3iiA0JiuP0DxuuP}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="factorize-me"><a href="#factorize-me" class="headerlink" title="factorize_me!"></a>factorize_me!</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">can you factorize me?</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> prod</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> nextprime</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> choices</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> fs:</span><br><span class="line">    flag = fs.read().strip()</span><br><span class="line"></span><br><span class="line">primes = [getPrime(<span class="number">512</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>)]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;prod(primes) = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;prod(p - <span class="number">1</span> <span class="keyword">for</span> p <span class="keyword">in</span> primes) = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">primes2 = [nextprime(p) <span class="keyword">for</span> p <span class="keyword">in</span> choices(primes, k=<span class="number">3</span>)]</span><br><span class="line">n = prod(primes2)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(<span class="built_in">int</span>.from_bytes(flag, <span class="string">&#x27;big&#x27;</span>), e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e = <span class="subst">&#123;e&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 363364907814244019888662301376841344262476227242899756862391470731421569394957444030214887114615748277199649349781524749919652160244484352285668794188836866602305788131186220057989320357344904731322223310531945208433910803617954798258382169132907508787682006064930747033681966462568715421005454243255297306718356766130469885581576362173340673516476386201173298433892314145854649884922769732583885904512624543994675379894718657682146178638074984373206937523380103438050549181568015985546172618830480078894445808092527561363650503540062128543705172678754195578429520889784813733491180748361345720247750720179608752244490362713103319685024237941527268458213442611663415417005556439749055222361212059968254748751273361732365487788593341859760309778894350385339764442343374673786357175846291309425081492959910254127778240522152676060766139057453197528944251599979227271074508795482632471242983094008619339488744362509349734218480932255216087706001484182136783834973304870508270118505737767002256270427907341952256516206663258530300791364944105025764611810001781971638030661367630116818647252727909489405550104641122269772492252464714694507693447974171377200402508765841829763548525530878309985480248379655169722567051495205792089930014228403456098065971372039443284193603395249634283366194562380309469628114581468645669390610963076340643757972439104287127375438663839421605531570285615180251</span></span><br><span class="line"><span class="comment"># 363364907814244019888662301376841344262476227242899756862391470731421569394957444030214887114615748277199649349781524749919652160244484352285668794188836492373364350673588273863828369502073826782362255108313852264064760467561392054178047091483873483255491431451728274259516789065331176728192953741805933100379191778599394515981288225535175013258094287912195847642598436035132783919453991516358280321085873745330313812205910011387125778714795906023110368957596998222544234082487264006696812862179916726781327290284827659294751262185328816323311831349296593013038823107653943652771448719760448938995150646738377177532550757319539185878535087009904848382493668686831331474113789651777885239747000076063679062106375348803749466079052774597412239427050432901553466002731972993029311850718200685157193170716432600165476733200831046297530470544781309612128231925681374239849452623513538498417735984094919756374577623486416462101457492789215144166273775249387638107644634704270216130852885082174564648445147377239033930079759024399532146184753110240154062693457622208373371290126810856885343328090305620627668495081760346853701632815149478447405718664667978825807101325764916405446176183238866136433205933785973568759281210319422288153910340542098573782006262190181726245838857185687242960093445000287347616796984610291664809895901301187179157382169999966124177588884152267266994164841066291200</span></span><br><span class="line"><span class="comment"># n = 899081756851564072995842371038848265712822308942406479625157544735473115850983700580364485532298999127834142923262920189902691972009898741820291331257478170998867183390650298055916005944577877856728843264502218692432679062445730259562784479410120575777748292393321588239071577384218317338474855507210816917917699500763270490789679076190405915250953860114858086078092945282693720016414837231157788381144668395364877545151382171251673050910143023561541226464220441</span></span><br><span class="line"><span class="comment"># e = 65537</span></span><br><span class="line"><span class="comment"># c = 841335863342518623856757469220437045493934999201203757845757404101093751603513457430254875658199946020695655428637035628085973393246970440054477600379027466651143466332405520374224855994531411584946074861018245519106776529260649700756908093025092104292223745612991818151040610497258923925952531383407297026038305824754456660932812929344928080812670596607694776017112795053283695891798940700646874515366341575417161087304105309794441077774052357656529143940010140</span></span><br></pre></td></tr></table></figure>
<p>å·²çŸ¥nä¸phiåˆ†è§£nï¼Œè¿™æ˜¯ä¸€ä¸ªè€é—®é¢˜äº†ï¼Œç°æˆè„šæœ¬å¾ˆå¤šã€‚</p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> nextprime</span><br><span class="line"></span><br><span class="line">N = <span class="number">363364907814244019888662301376841344262476227242899756862391470731421569394957444030214887114615748277199649349781524749919652160244484352285668794188836866602305788131186220057989320357344904731322223310531945208433910803617954798258382169132907508787682006064930747033681966462568715421005454243255297306718356766130469885581576362173340673516476386201173298433892314145854649884922769732583885904512624543994675379894718657682146178638074984373206937523380103438050549181568015985546172618830480078894445808092527561363650503540062128543705172678754195578429520889784813733491180748361345720247750720179608752244490362713103319685024237941527268458213442611663415417005556439749055222361212059968254748751273361732365487788593341859760309778894350385339764442343374673786357175846291309425081492959910254127778240522152676060766139057453197528944251599979227271074508795482632471242983094008619339488744362509349734218480932255216087706001484182136783834973304870508270118505737767002256270427907341952256516206663258530300791364944105025764611810001781971638030661367630116818647252727909489405550104641122269772492252464714694507693447974171377200402508765841829763548525530878309985480248379655169722567051495205792089930014228403456098065971372039443284193603395249634283366194562380309469628114581468645669390610963076340643757972439104287127375438663839421605531570285615180251</span></span><br><span class="line">phi = <span class="number">363364907814244019888662301376841344262476227242899756862391470731421569394957444030214887114615748277199649349781524749919652160244484352285668794188836492373364350673588273863828369502073826782362255108313852264064760467561392054178047091483873483255491431451728274259516789065331176728192953741805933100379191778599394515981288225535175013258094287912195847642598436035132783919453991516358280321085873745330313812205910011387125778714795906023110368957596998222544234082487264006696812862179916726781327290284827659294751262185328816323311831349296593013038823107653943652771448719760448938995150646738377177532550757319539185878535087009904848382493668686831331474113789651777885239747000076063679062106375348803749466079052774597412239427050432901553466002731972993029311850718200685157193170716432600165476733200831046297530470544781309612128231925681374239849452623513538498417735984094919756374577623486416462101457492789215144166273775249387638107644634704270216130852885082174564648445147377239033930079759024399532146184753110240154062693457622208373371290126810856885343328090305620627668495081760346853701632815149478447405718664667978825807101325764916405446176183238866136433205933785973568759281210319422288153910340542098573782006262190181726245838857185687242960093445000287347616796984610291664809895901301187179157382169999966124177588884152267266994164841066291200</span></span><br><span class="line">n = <span class="number">899081756851564072995842371038848265712822308942406479625157544735473115850983700580364485532298999127834142923262920189902691972009898741820291331257478170998867183390650298055916005944577877856728843264502218692432679062445730259562784479410120575777748292393321588239071577384218317338474855507210816917917699500763270490789679076190405915250953860114858086078092945282693720016414837231157788381144668395364877545151382171251673050910143023561541226464220441</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">841335863342518623856757469220437045493934999201203757845757404101093751603513457430254875658199946020695655428637035628085973393246970440054477600379027466651143466332405520374224855994531411584946074861018245519106776529260649700756908093025092104292223745612991818151040610497258923925952531383407297026038305824754456660932812929344928080812670596607694776017112795053283695891798940700646874515366341575417161087304105309794441077774052357656529143940010140</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factorize</span>(<span class="params">N, phi</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Recovers the prime factors from a modulus if Euler&#x27;s totient is known.</span></span><br><span class="line"><span class="string">    This method only works for a modulus consisting of 2 primes!</span></span><br><span class="line"><span class="string">    :param N: the modulus</span></span><br><span class="line"><span class="string">    :param phi: Euler&#x27;s totient, the order of the multiplicative group modulo N</span></span><br><span class="line"><span class="string">    :return: a tuple containing the prime factors, or None if the factors were not found</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    s = N + <span class="number">1</span> - phi</span><br><span class="line">    d = s ** <span class="number">2</span> - <span class="number">4</span> * N</span><br><span class="line">    p = <span class="built_in">int</span>(s - iroot(d,<span class="number">2</span>)[<span class="number">0</span>]) // <span class="number">2</span></span><br><span class="line">    q = <span class="built_in">int</span>(s + iroot(d,<span class="number">2</span>)[<span class="number">0</span>]) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factorize_multi_prime</span>(<span class="params">N, phi</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Recovers the prime factors from a modulus if Euler&#x27;s totient is known.</span></span><br><span class="line"><span class="string">    This method works for a modulus consisting of any number of primes, but is considerably be slower than factorize.</span></span><br><span class="line"><span class="string">    More information: Hinek M. J., Low M. K., Teske E., &quot;On Some Attacks on Multi-prime RSA&quot; (Section 3)</span></span><br><span class="line"><span class="string">    :param N: the modulus</span></span><br><span class="line"><span class="string">    :param phi: Euler&#x27;s totient, the order of the multiplicative group modulo N</span></span><br><span class="line"><span class="string">    :return: a tuple containing the prime factors</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    prime_factors = <span class="built_in">set</span>()</span><br><span class="line">    factors = [N]</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(factors) &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="comment"># Element to factorize.</span></span><br><span class="line">        N = factors[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        w = randrange(<span class="number">2</span>, N - <span class="number">1</span>)</span><br><span class="line">        i = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> phi % (<span class="number">2</span> ** i) == <span class="number">0</span>:</span><br><span class="line">            sqrt_1 = <span class="built_in">pow</span>(w, phi // (<span class="number">2</span> ** i), N)</span><br><span class="line">            <span class="keyword">if</span> sqrt_1 &gt; <span class="number">1</span> <span class="keyword">and</span> sqrt_1 != N - <span class="number">1</span>:</span><br><span class="line">                <span class="comment"># We can remove the element to factorize now, because we have a factorization.</span></span><br><span class="line">                factors = factors[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">                p = gcd(<span class="built_in">int</span>(N), <span class="built_in">int</span>(sqrt_1 + <span class="number">1</span>))</span><br><span class="line">                q = N // p</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> is_prime(p):</span><br><span class="line">                    prime_factors.add(p)</span><br><span class="line">                <span class="keyword">elif</span> p &gt; <span class="number">1</span>:</span><br><span class="line">                    factors.append(p)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> is_prime(q):</span><br><span class="line">                    prime_factors.add(q)</span><br><span class="line">                <span class="keyword">elif</span> q &gt; <span class="number">1</span>:</span><br><span class="line">                    factors.append(q)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># Continue in the outer loop</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">tuple</span>(prime_factors)</span><br><span class="line"></span><br><span class="line">primelist = factorize_multi_prime(N,phi)</span><br><span class="line">plist = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> primelist:</span><br><span class="line">    <span class="keyword">if</span>(n % nextprime(i) == <span class="number">0</span>):</span><br><span class="line">        plist.append(nextprime(i))</span><br><span class="line"></span><br><span class="line">phi_n = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> plist:</span><br><span class="line">    phi_n *= (i-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,phi_n)</span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>moectf{you_KNow_how_to_faCtorize_N_right?_9?WPIBung6?WPIBung6?WPIBund6?}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="feistel-promax"><a href="#feistel-promax" class="headerlink" title="feistel_promax"></a>feistel_promax</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¾ˆå–œæ¬¢shallowçš„ä¸€å¥è¯ï¼šä¼špythonï¼Œä¸Šè¿‡å°å­¦ï¼Œå°±èƒ½åš</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"></span><br><span class="line"><span class="built_in">round</span> = <span class="number">2</span></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&quot;./secret&quot;</span>, <span class="string">&quot;rb&quot;</span>).read().strip()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">m, key</span>):</span><br><span class="line">    m = m ^ (m &gt;&gt; <span class="number">4</span>)</span><br><span class="line">    m = m ^ (m &lt;&lt; <span class="number">5</span>)</span><br><span class="line">    m = m ^ (m &gt;&gt; <span class="number">8</span>)</span><br><span class="line">    m ^= key</span><br><span class="line">    m = (m * <span class="number">1145</span> + <span class="number">14</span>) % <span class="number">2</span>**<span class="number">64</span></span><br><span class="line">    m = (m * <span class="number">1919</span> + <span class="number">810</span>) % <span class="number">2</span>**<span class="number">64</span></span><br><span class="line">    m = (m * key) % <span class="number">2</span>**<span class="number">64</span></span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">m, key, <span class="built_in">round</span></span>):</span><br><span class="line">    key = bytes_to_long(key)</span><br><span class="line">    left = bytes_to_long(m[:<span class="number">8</span>])</span><br><span class="line">    right = bytes_to_long(m[<span class="number">8</span>:])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">round</span>):</span><br><span class="line">        left, right = right, f(right, key) ^ left</span><br><span class="line">    left, right = right, left</span><br><span class="line">    <span class="keyword">return</span> long_to_bytes(left).rjust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>) + long_to_bytes(right).rjust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">padding</span>(<span class="params">m</span>):</span><br><span class="line">    mlen = <span class="built_in">len</span>(m)</span><br><span class="line">    pad = <span class="number">16</span> - mlen % <span class="number">16</span></span><br><span class="line">    <span class="keyword">return</span> m + pad * <span class="built_in">bytes</span>([pad])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ecb_enc</span>(<span class="params">m, key</span>):</span><br><span class="line">    m = padding(m)</span><br><span class="line">    mlen = <span class="built_in">len</span>(m)</span><br><span class="line">    c = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(mlen // <span class="number">16</span>):</span><br><span class="line">        c += enc(m[i * <span class="number">16</span> : i * <span class="number">16</span> + <span class="number">16</span>], key, <span class="built_in">round</span>)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = urandom(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(ecb_enc(padding(flag), key))</span><br><span class="line"><span class="comment"># b&#x27;B\xf5\xd8gy\x0f\xaf\xc7\xdf\xabn9\xbb\xd0\xe3\x1e0\x9eR\xa9\x1c\xb7\xad\xe5H\x8cC\x07\xd5w9Ms\x03\x06\xec\xb4\x8d\x80\xcb&#125;\xa9\x8a\xcc\xd1W\x82[\xd3\xdc\xb4\x83P\xda5\xac\x9e\xb0)\x98R\x1c\xb3h&#x27;</span></span><br></pre></td></tr></table></figure>
<p>ç›¸è¾ƒäºä¸Šé¢é‚£é“feistelï¼Œçœ‹ä¼¼ä»…ä»…æ˜¯æ›´æ¢äº†keyçš„ç”Ÿæˆæ–¹å¼ï¼Œå˜æˆäº†éšæœºçš„å…«å­—èŠ‚ï¼Œå¹¶ä¸”å¹¶æ²¡æœ‰ç»™å‡ºkeyã€‚ä¹Ÿå› æ­¤æˆ‘ä»¬æ²¡æœ‰åŠæ³•é¡ºåˆ©çš„ä½¿ç”¨få‡½æ•°ï¼Œä¹Ÿå°±æ²¡æœ‰åŠæ³•è¿˜åŸfeistelç½‘ç»œã€‚</p>
<p>ä½†æ˜¯ä»”ç»†å¯¹æ¯”ä¸€ä¸‹å‘ç°è¿˜æœ‰ç»†å¾®åŒºåˆ«ã€‚</p>
<p>æœ¬é¢˜ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">ecb_enc</span>(<span class="params">m, key</span>):</span><br><span class="line">    m = padding(m)</span><br><span class="line">    mlen = <span class="built_in">len</span>(m)</span><br><span class="line">    c = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(mlen // <span class="number">16</span>):</span><br><span class="line">        c += enc(m[i * <span class="number">16</span> : i * <span class="number">16</span> + <span class="number">16</span>], key, <span class="built_in">round</span>)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(ecb_enc(padding(flag), key))</span><br></pre></td></tr></table></figure>
<p>è€Œä¸Šä¸€é“é¢˜æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">ecb_enc</span>(<span class="params">m, key</span>):</span><br><span class="line">    m = padding(m)</span><br><span class="line">    mlen = <span class="built_in">len</span>(m)</span><br><span class="line">    c = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(mlen // <span class="number">16</span>):</span><br><span class="line">        c += enc(m[i * <span class="number">16</span> : i * <span class="number">16</span> + <span class="number">16</span>], key, <span class="built_in">round</span>)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(ecb_enc(flag, <span class="string">b&quot;wulidego&quot;</span>))</span><br></pre></td></tr></table></figure>
<p>æœ‰æ²¡æœ‰å‘ç°åŒºåˆ«ï¼Ÿè¿™é‡Œç•™äº†ä¸€ä¸ªå¾ˆå¾®å¦™çš„å‘ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span> : <span class="built_in">print</span>(ecb_enc(padding(flag), key))</span><br><span class="line"><span class="number">2</span> : <span class="built_in">print</span>(ecb_enc(flag, <span class="string">b&quot;wulidego&quot;</span>))</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å‘ç°ï¼Œæœ¬é¢˜å¯¹flagè¿›è¡Œäº†ä¸¤æ¬¡paddingï¼è€Œpaddingå‡½æ•°å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">padding</span>(<span class="params">m</span>):</span><br><span class="line">    mlen = <span class="built_in">len</span>(m)</span><br><span class="line">    pad = <span class="number">16</span> - mlen % <span class="number">16</span></span><br><span class="line">    <span class="keyword">return</span> m + pad * <span class="built_in">bytes</span>([pad])</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæ¶ˆæ¯é•¿åº¦æ°ä¸º16å­—èŠ‚çš„æ•´æ•°å€é•¿åº¦ï¼Œä»–ä»ç„¶ä¼šè¿›è¡Œå¡«å……ï¼Œå¡«å……çš„æ˜¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">b&quot;\x10&quot;*16</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œç°åœ¨æˆ‘ä»¬æ‹¥æœ‰äº†ä¸€ç»„æ˜æ–‡ä»¥åŠå®ƒå¯¹åº”çš„feistelåŠ å¯†ç»“æœï¼Œè€Œfeistelç½‘ç»œä¸­ï¼Œfå‡½æ•°å‡æ˜¯çº¿æ€§çš„ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">m, key</span>):</span><br><span class="line">    m = m ^ (m &gt;&gt; <span class="number">4</span>)</span><br><span class="line">    m = m ^ (m &lt;&lt; <span class="number">5</span>)</span><br><span class="line">    m = m ^ (m &gt;&gt; <span class="number">8</span>)</span><br><span class="line">    m ^= key</span><br><span class="line">    m = (m * <span class="number">1145</span> + <span class="number">14</span>) % <span class="number">2</span>**<span class="number">64</span></span><br><span class="line">    m = (m * <span class="number">1919</span> + <span class="number">810</span>) % <span class="number">2</span>**<span class="number">64</span></span><br><span class="line">    m = (m * key) % <span class="number">2</span>**<span class="number">64</span></span><br><span class="line">    <span class="keyword">return</span> m</span><br></pre></td></tr></table></figure>
<p>è¿™å°±ç»™è§£æ–¹ç¨‹å¸¦æ¥äº†å¸Œæœ›ã€‚</p>
<p>è€Œæˆ‘ä»¬æ‹¥æœ‰ä»€ä¹ˆæ–¹ç¨‹å‘¢ï¼Ÿæˆ‘ä»¬å°†å¡«å……çš„16å­—èŠ‚æ‹†æˆå·¦å³ä¸¤éƒ¨åˆ†ï¼Œç›¸åº”çš„ä¹Ÿå°±æœ‰å¯¹åº”åŠ å¯†è¿‡ç¨‹çš„å¯†æ–‡ï¼Œæ­¤æ—¶æŠŠkeyå½“ä½œæœªçŸ¥æ•°ï¼Œæˆ‘ä»¬å°±èƒ½åˆ—å‡ºä¸¤ä¸ªæ–¹ç¨‹ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬å¾…è§£çš„æ–¹ç¨‹ç»„ã€‚</p>
<p>äº‹å®ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œz3å¯ä»¥è½»æ¾æ±‚è§£è¿™ä¸ªæ–¹ç¨‹ç»„ï¼Œä»è€Œå¾—åˆ°keyã€‚å¾—åˆ°keyåè§£å¯†æ–¹æ³•ä¸ä¸Šä¸€é“é¢˜ç›®å®Œå…¨ç›¸åŒã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = l = <span class="string">b&quot;\x10\x10\x10\x10\x10\x10\x10\x10&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">m, x</span>):</span><br><span class="line">    m = m ^ (m &gt;&gt; <span class="number">4</span>)</span><br><span class="line">    m = m ^ (m &lt;&lt; <span class="number">5</span>)</span><br><span class="line">    m = m ^ (m &gt;&gt; <span class="number">8</span>)</span><br><span class="line">    <span class="keyword">return</span> (((x^m)*<span class="number">1145</span>+<span class="number">14</span>)*<span class="number">1919</span>+<span class="number">810</span>)*x % (<span class="number">2</span>**<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">magic1</span>(<span class="params">x</span>):</span><br><span class="line">    m = bytes_to_long(<span class="string">b&#x27;\x9e\xb0)\x98R\x1c\xb3h&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> f(m,x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">magic2</span>(<span class="params">x</span>):</span><br><span class="line">    m = bytes_to_long(r)</span><br><span class="line">    <span class="keyword">return</span> f(m,x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">kkp_sol</span>():</span><br><span class="line">    x = BitVec(<span class="string">&#x27;x&#x27;</span>,<span class="number">64</span>)</span><br><span class="line">    sol = Solver()</span><br><span class="line">    sol.add(magic2(x) == bytes_to_long(<span class="string">b&#x27;\x9e\xb0)\x98R\x1c\xb3h&#x27;</span>) ^ bytes_to_long(r))</span><br><span class="line">    sol.add(magic1(x) == bytes_to_long(<span class="string">b&quot;\xd3\xdc\xb4\x83P\xda5\xac&quot;</span>) ^ bytes_to_long(l))</span><br><span class="line">    sol.check()</span><br><span class="line">    <span class="built_in">print</span>(sol.model())</span><br><span class="line"></span><br><span class="line">kkp_sol()</span><br><span class="line"></span><br><span class="line">key = long_to_bytes(<span class="number">3779692691923971252</span>)</span><br><span class="line">c = <span class="string">b&#x27;B\xf5\xd8gy\x0f\xaf\xc7\xdf\xabn9\xbb\xd0\xe3\x1e0\x9eR\xa9\x1c\xb7\xad\xe5H\x8cC\x07\xd5w9Ms\x03\x06\xec\xb4\x8d\x80\xcb&#125;\xa9\x8a\xcc\xd1W\x82[\xd3\xdc\xb4\x83P\xda5\xac\x9e\xb0)\x98R\x1c\xb3h&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">m, key</span>):</span><br><span class="line">    m = m ^ (m &gt;&gt; <span class="number">4</span>)</span><br><span class="line">    m = m ^ (m &lt;&lt; <span class="number">5</span>)</span><br><span class="line">    m = m ^ (m &gt;&gt; <span class="number">8</span>)</span><br><span class="line">    m ^= key</span><br><span class="line">    m = (m * <span class="number">1145</span> + <span class="number">14</span>) % <span class="number">2</span>**<span class="number">64</span></span><br><span class="line">    m = (m * <span class="number">1919</span> + <span class="number">810</span>) % <span class="number">2</span>**<span class="number">64</span></span><br><span class="line">    m = (m * key) % <span class="number">2</span>**<span class="number">64</span></span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dec</span>(<span class="params">c,key</span>):</span><br><span class="line">    key = bytes_to_long(key)</span><br><span class="line">    right = bytes_to_long(c[:<span class="number">8</span>])</span><br><span class="line">    left = bytes_to_long(c[<span class="number">8</span>:])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">        left,right = f(left,key)^right,left</span><br><span class="line">    <span class="keyword">return</span> long_to_bytes(left) + long_to_bytes(right)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ecb_dec</span>(<span class="params">c, key</span>):</span><br><span class="line">    m = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c) // <span class="number">16</span>):</span><br><span class="line">        m += dec(c[i * <span class="number">16</span> : i * <span class="number">16</span> + <span class="number">16</span>], key)</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(ecb_dec(c,key))</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>moectf{F_func_1s_n1t_Ve5y_$EcU%e}</strong></p>
<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å­¦ä¹ äº†ä¸å°‘ï¼Œç»§ç»­åŠ æ²¹ã€‚</p>
]]></content>
      <categories>
        <category>wp-crypto</category>
      </categories>
  </entry>
  <entry>
    <title>2023-é¦™å±±æ¯-wp-crypto</title>
    <url>/post/183fe2bb.html</url>
    <content><![CDATA[<p>*ä»£è¡¨èµ›ä¸­æœªè§£å‡ºçš„é¢˜ç›®</p>
<span id="more"></span>
<h3 id="lift"><a href="#lift" class="headerlink" title="lift"></a>lift</h3><p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">s,l</span>):</span><br><span class="line">    <span class="keyword">return</span> s + os.urandom(l - <span class="built_in">len</span>(s))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>():</span><br><span class="line">    g = getPrime(<span class="number">8</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = g * random.getrandbits(<span class="number">138</span>) + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> isPrime(p):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        q = g * random.getrandbits(<span class="number">138</span>) + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> isPrime(q):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    N = p ** <span class="number">5</span> * q</span><br><span class="line">    phi = p ** <span class="number">4</span> * (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    d = random.getrandbits(<span class="number">256</span>)</span><br><span class="line">    e = inverse(d, phi)</span><br><span class="line">    E = e * g</span><br><span class="line">    hint = gmpy2.gcd(E, phi)</span><br><span class="line">    <span class="keyword">return</span> N, E, hint</span><br><span class="line"></span><br><span class="line">flag = pad(flag,<span class="number">64</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">n,e,hint = gen()</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;hint = <span class="subst">&#123;hint&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e = <span class="subst">&#123;e&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="comment"># hint = 251</span></span><br><span class="line"><span class="comment"># n = 108960799213330048807537253155955524262938083957673388027650083719597357215238547761557943499634403020900601643719960988288543702833581456488410418793239589934165142850195998163833962875355916819854378922306890883033496525502067124670576471251882548376530637034077</span></span><br><span class="line"><span class="comment"># e = 3359917755894163258174451768521610910491402727660720673898848239095553816126131162471035843306464197912997253011899806560624938869918893182751614520610693643690087988363775343761651198776860913310798127832036941524620284804884136983215497742441302140070096928109039</span></span><br><span class="line"><span class="comment"># c = 72201537621260682675988549650349973570539366370497258107694937619698999052787116039080427209958662949131892284799148484018421298241124372816425123784602508705232247879799611203283114123802597553853842227351228626180079209388772101105198454904371772564490263034162</span></span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆè¦å¼„æ¸…æ¥šgen()å‡½æ•°è¿”å›çš„å‡ ä¸ªå‚æ•°ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼š</p>
<script type="math/tex; mode=display">
n = p^5q</script><script type="math/tex; mode=display">
e = e*g</script><script type="math/tex; mode=display">
hint = gcd(e*g,phi)</script><p>å…¶ä¸­ï¼Œpã€qå‚æ•°ç”Ÿæˆæ–¹å¼å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
p = g*a1+1</script><script type="math/tex; mode=display">
q = g*a2+1</script><p>å³è¡¨æ˜phiä¸gä¸äº’ç´ ï¼Œæ¥ä¸‹æ¥è¿›å…¥é¢˜ç›®åˆ†æï¼š</p>
<p>é¦–å…ˆæœ‰ï¼š</p>
<script type="math/tex; mode=display">
phi = p^4(p-1)(q-1) = p^4(g*a1)(g*a2) = g^2p^4a1a2</script><script type="math/tex; mode=display">
e = e*g</script><p>æ‰€ä»¥hintä¸€å®šæ˜¯gçš„æ•´æ•°å€ï¼Œè€Œ251æœ¬èº«å°±æ˜¯ç´ æ•°ï¼Œå› æ­¤å¾—åˆ°g=251ã€‚</p>
<p>è€Œç”±äºé¢˜ç›®æ˜¯å¤šç´ æ•°nä¸”dä¸º256æ¯”ç‰¹ï¼Œå› æ­¤å¯ä»¥è€ƒè™‘é‡‡ç”¨coppersmithæ‰¾åˆ°dï¼ŒåŸç†å¦‚ä¸‹(æ­¤å¤„çš„eä¸ºgenå†…éƒ¨çš„å°å†™eï¼Œè€Œéå¤§å†™E)ï¼Œç”±äºï¼š</p>
<script type="math/tex; mode=display">
e*d \equiv 1 \quad (mod\;p^4(p-1)(q-1))</script><p>æ‰€ä»¥ç”±åŒä½™æ€§è´¨ï¼š</p>
<script type="math/tex; mode=display">
e*d \equiv 1 \quad (mod\;p^4)</script><p>å› æ­¤æŠŠdçœ‹ä½œæœªçŸ¥å°é‡ï¼Œä½¿ç”¨coppersmithå³å¯æ±‚è§£æ¨¡nçš„å‚æ•°p^4ä¸‹çš„å°æ ¹ã€‚æ±‚è§£å‡ºdåï¼Œæ±‚è§£gcd(ed-1,n)å³å¯å¾—åˆ°p^4ï¼Œè¿›è€Œè¿˜åŸå‡ºpã€qã€‚</p>
<p>è¿˜åŸå‡ºpã€qåï¼Œç”±äºå¯†æ–‡cæ˜¯ç”±ä»¥ä¸‹æ–¹å¼å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
c \equiv m^{eg} \quad (mod\;n)</script><p>è€Œç”±äºgä¸phiä¸äº’ç´ ï¼Œå› æ­¤åªèƒ½å…ˆç”¨dæ±‚è§£å‡ºï¼š</p>
<script type="math/tex; mode=display">
c1 \equiv c^d \equiv m^g \quad (mod\;n)</script><p>ç„¶åç»§ç»­ä½¿ç”¨åŒä½™æ€§è´¨ï¼Œå°†é—®é¢˜è½¬åŒ–åˆ°æ¨¡pã€qä¸‹ï¼š</p>
<script type="math/tex; mode=display">
c_p \equiv m^g \quad(mod\;p)</script><script type="math/tex; mode=display">
c_q \equiv m^g \quad(mod\;q)</script><p>ä½¿ç”¨AMMç®—æ³•å¯ä»¥å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
mp \equiv m \quad (mod\;p)</script><script type="math/tex; mode=display">
mq \equiv m \quad (mod\;q)</script><p>ä½†æ˜¯ç”±äºé¢˜ç›®å°†flagå¡«å……åˆ°äº†512æ¯”ç‰¹ï¼Œå› æ­¤ç›´æ¥åšä¸­å›½å‰©ä½™å®šç†ï¼Œåªèƒ½å¾—å‡ºæ¨¡ p*q ä¸‹çš„è§£ï¼Œä½æ•°æ˜¯ä¸å¤Ÿçš„ã€‚</p>
<p>å¯èƒ½è¿™ä¸ªæ—¶å€™ä¼šæƒ³ï¼Œä¸ºä»€ä¹ˆåˆšæ‰AMMç®—æ³•ä¸ç›´æ¥è½¬åˆ°æ¨¡p^5ä¸‹å¼€æ ¹ï¼Œè€Œåªèƒ½è½¬åˆ°æ¨¡pä¸‹å¼€æ ¹ï¼Ÿäº‹å®ä¸Šæ˜¯å› ä¸ºAMMç®—æ³•ä¸€èˆ¬åªé€‚ç”¨äºæ¨¡æ•°ä¸ºç´ æ•°æ—¶çš„æœ‰é™åŸŸå¼€æ ¹ï¼Œå› æ­¤è¿™é‡Œåªèƒ½å¾—åˆ°æ¨¡pä¸‹çš„è§£ï¼Œè€Œæ— æ³•ç›´æ¥å¾—åˆ°æ¨¡p^5ä¸‹çš„è§£ã€‚</p>
<p>é‚£ä¹ˆè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿæœ‰ä¸€ç§ä¸“é—¨ç”¨äºå°†æ¨¡p^kä¸‹çš„è§£æå‡è‡³æ¨¡p^(k+i)ä¸‹çš„è§£çš„æ–¹æ³•ï¼Œç§°ä½œHensel Liftingã€‚è€Œè¿™æ­£å¥½ä¸é¢˜ç›®åå­—ç›¸å¯¹åº”ã€‚è¿™é‡Œæœ‰ä¸€ç¯‡æ¯”è¾ƒå¥½ç†è§£çš„æ–‡ç« ï¼š</p>
<p><a href="https://zhuanlan.zhihu.com/p/367203571">Henselâ€™s lemma (1) - çŸ¥ä¹ (zhihu.com)</a></p>
<p>å¤§æ¦‚äº†è§£åˆ°ï¼ŒHensel Liftingä¸€èˆ¬ç”¨äºè§£é«˜æ¬¡å¤šé¡¹å¼åŒä½™æ–¹ç¨‹ï¼Œè€Œåœ¨æœ¬é¢˜ä¸­ï¼Œæˆ‘ä»¬æ°å¥½æœ‰ä¸€ä¸ªé«˜æ¬¡å¤šé¡¹å¼åŒä½™æ–¹ç¨‹å¦‚ä¸‹(c1å¦‚ä½•å¾—æ¥è§å‰æ–¹æ¨å¯¼)ï¼š</p>
<script type="math/tex; mode=display">
f(x) = x^g - c1 \quad (mod\; n)</script><p>ä»ç„¶ä½¿ç”¨åŒä½™å®šç†æŠŠä»–è½¬åˆ°æ¨¡p^5ä¸‹:</p>
<script type="math/tex; mode=display">
f(x) = x^g - c1 \quad (mod\; p^5)</script><p>æ˜¾ç„¶ï¼Œæ˜æ–‡må°±æ˜¯è¿™ä¸ªé«˜æ¬¡å¤šé¡¹å¼çš„æ ¹ï¼Œè€Œæ¨¡p^5ä¸‹çš„æ ¹må·²ç»æ»¡è¶³äº†512æ¯”ç‰¹çš„è¦æ±‚ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦ä½¿ç”¨Hensel Liftingï¼Œå°†åˆšæ‰AMMæ±‚å¾—çš„æ¨¡pä¸‹çš„æ‰€æœ‰å¯èƒ½æ ¹æå‡åˆ°æ¨¡p^5ä¸‹ï¼Œå¹¶æ ¹æ®flagå¤´è¿›è¡Œåˆ¤åˆ«å³å¯ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">onemod</span>(<span class="params">e, q</span>):</span><br><span class="line">    p = random.randint(<span class="number">1</span>, q-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">pow</span>(p, (q-<span class="number">1</span>)//e, q) == <span class="number">1</span>):  <span class="comment"># (r,s)=1</span></span><br><span class="line">        p = random.randint(<span class="number">1</span>, q)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AMM_rth</span>(<span class="params">o, r, q</span>):  <span class="comment"># r|(q-1</span></span><br><span class="line">    <span class="keyword">assert</span>((q-<span class="number">1</span>) % r == <span class="number">0</span>)</span><br><span class="line">    p = onemod(r, q)</span><br><span class="line"></span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    s = q-<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>(s % r == <span class="number">0</span>):</span><br><span class="line">        s = s//r</span><br><span class="line">        t += <span class="number">1</span></span><br><span class="line">    k = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>((s*k+<span class="number">1</span>) % r != <span class="number">0</span>):</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">    alp = (s*k+<span class="number">1</span>)//r</span><br><span class="line"></span><br><span class="line">    a = <span class="built_in">pow</span>(p, r**(t-<span class="number">1</span>)*s, q)</span><br><span class="line">    b = <span class="built_in">pow</span>(o, r*a-<span class="number">1</span>, q)</span><br><span class="line">    c = <span class="built_in">pow</span>(p, s, q)</span><br><span class="line">    h = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, t-<span class="number">1</span>):</span><br><span class="line">        d = <span class="built_in">pow</span>(<span class="built_in">int</span>(b), r**(t-<span class="number">1</span>-i), q)</span><br><span class="line">        <span class="keyword">if</span> d == <span class="number">1</span>:</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            j = (-math.log(d, a)) % r</span><br><span class="line">        b = (b*(c**(r*j))) % q</span><br><span class="line">        h = (h*c**j) % q</span><br><span class="line">        c = (c*r) % q</span><br><span class="line">    result = (<span class="built_in">pow</span>(o, alp, q)*h)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ALL_Solution</span>(<span class="params">m, q, rt, cq, e</span>):</span><br><span class="line">    mp = []</span><br><span class="line">    <span class="keyword">for</span> pr <span class="keyword">in</span> rt:</span><br><span class="line">        r = (pr*m) % q</span><br><span class="line">        <span class="comment"># assert(pow(r, e, q) == cq)</span></span><br><span class="line">        mp.append(r)</span><br><span class="line">    <span class="keyword">return</span> mp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ALL_ROOT2</span>(<span class="params">r, q</span>):  <span class="comment"># use function set() and .add() ensure that the generated elements are not repeated</span></span><br><span class="line">    li = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">len</span>(li) &lt; r):</span><br><span class="line">        p = <span class="built_in">pow</span>(random.randint(<span class="number">1</span>, q-<span class="number">1</span>), (q-<span class="number">1</span>)//r, q)</span><br><span class="line">        li.add(p)</span><br><span class="line">    <span class="keyword">return</span> li</span><br><span class="line"></span><br><span class="line">hint = <span class="number">251</span></span><br><span class="line">n = <span class="number">108960799213330048807537253155955524262938083957673388027650083719597357215238547761557943499634403020900601643719960988288543702833581456488410418793239589934165142850195998163833962875355916819854378922306890883033496525502067124670576471251882548376530637034077</span></span><br><span class="line">e = <span class="number">3359917755894163258174451768521610910491402727660720673898848239095553816126131162471035843306464197912997253011899806560624938869918893182751614520610693643690087988363775343761651198776860913310798127832036941524620284804884136983215497742441302140070096928109039</span></span><br><span class="line">c = <span class="number">72201537621260682675988549650349973570539366370497258107694937619698999052787116039080427209958662949131892284799148484018421298241124372816425123784602508705232247879799611203283114123802597553853842227351228626180079209388772101105198454904371772564490263034162</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#find d</span></span><br><span class="line">g = hint</span><br><span class="line">P.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = (e//g) * x - <span class="number">1</span></span><br><span class="line">d = <span class="built_in">int</span>(f.monic().small_roots(X=<span class="number">2</span>**<span class="number">256</span>,beta=<span class="number">0.66</span>)[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#find p,q,c1</span></span><br><span class="line">pr = GCD(e//g*d-<span class="number">1</span>,n)</span><br><span class="line">p = <span class="built_in">int</span>(iroot(pr,<span class="number">4</span>)[<span class="number">0</span>])</span><br><span class="line">q = <span class="built_in">int</span>(n // (p**<span class="number">5</span>))</span><br><span class="line">phi = <span class="built_in">int</span>(p ** <span class="number">4</span> * (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">c1 = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"></span><br><span class="line"><span class="comment">#AMM</span></span><br><span class="line">cp = c1 % p</span><br><span class="line">mp = AMM_rth(cp, g, p)</span><br><span class="line">rt1 = ALL_ROOT2(g, p)</span><br><span class="line">amp = ALL_Solution(mp, p, rt1, cp, g)</span><br><span class="line"></span><br><span class="line"><span class="comment"># hensel lifting(sageæ±‚æœ‰ç‚¹é—®é¢˜ï¼Œä¸çŸ¥é“åŸå› )</span></span><br><span class="line">b = <span class="number">5</span></span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> amp:</span><br><span class="line">    m = <span class="built_in">int</span>(m)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, b):</span><br><span class="line">        _dx = -inverse(g*m**(g-<span class="number">1</span>),p) % p**(i+<span class="number">1</span>)</span><br><span class="line">        mod_temp = (m**g-c1)//(p**i) % p**(i+<span class="number">1</span>)</span><br><span class="line">        t = _dx * mod_temp % p</span><br><span class="line">        m = m + p**i*t % (p**(i+<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">b&quot;flag&quot;</span> <span class="keyword">in</span> long_to_bytes(m)):</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯å‘¢ï¼Œsageåœ¨å®ç°è¿™ä¸ªè‡ªå·±å†™çš„Hensel Liftingæ—¶ä¸€ç›´æŠ¥é”™ï¼Œè„‘å­ä¹Ÿä¸å¤ªæ¸…é†’ï¼Œæš‚æ—¶æ²¡æ‰¾å‡ºåŸå› ã€‚æ‰€ä»¥æœ€åè¿˜éœ€è¦æ‰‹åŠ¨æŠŠAMMæ±‚å‡ºçš„æ‰€æœ‰å¯èƒ½æ ¹ç²˜è´´å‡ºæ¥ï¼Œç”¨pythonå®ç°Hensel Liftingã€‚</p>
<p>å› æ­¤æœ€ç»ˆexpå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">g = <span class="number">251</span></span><br><span class="line">n = <span class="number">108960799213330048807537253155955524262938083957673388027650083719597357215238547761557943499634403020900601643719960988288543702833581456488410418793239589934165142850195998163833962875355916819854378922306890883033496525502067124670576471251882548376530637034077</span></span><br><span class="line">e = <span class="number">3359917755894163258174451768521610910491402727660720673898848239095553816126131162471035843306464197912997253011899806560624938869918893182751614520610693643690087988363775343761651198776860913310798127832036941524620284804884136983215497742441302140070096928109039</span></span><br><span class="line">c = <span class="number">72201537621260682675988549650349973570539366370497258107694937619698999052787116039080427209958662949131892284799148484018421298241124372816425123784602508705232247879799611203283114123802597553853842227351228626180079209388772101105198454904371772564490263034162</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Copperè§£æ–¹ç¨‹å¾—åˆ°è¿™äº›æ•°å€¼</span></span><br><span class="line">p = <span class="number">69367143733862710652791985332025152581988181</span></span><br><span class="line">q = <span class="number">67842402383801764742069883032864699996366777</span></span><br><span class="line">phi = p ** <span class="number">4</span> * (p - <span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e//g, phi)</span><br><span class="line">dp = d % (p - <span class="number">1</span>)</span><br><span class="line">c1 = <span class="number">65942580064916339360370107869124805065379278407453423807322070174933076533175126747570263707923877730828981200462382452332851764309132627867196012329998008639862606922074733109347253946308226346992240834103573312752632998287455123587460568157234254421846676210189</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#AMMæ±‚å‡ºçš„æ ¹ï¼Œæ»¡è¶³ amp[i] = m % pï¼Œè¿‡é•¿å°±ä¸ç²˜è´´äº†</span></span><br><span class="line">amp = </span><br><span class="line"></span><br><span class="line"><span class="comment"># hensel lifting</span></span><br><span class="line">b = <span class="number">5</span></span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> amp:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, b):</span><br><span class="line">        _dx = -inverse(g*m**(g-<span class="number">1</span>),p) % p**(i+<span class="number">1</span>)</span><br><span class="line">        mod_temp = (m**g-c1)//(p**i) % p**(i+<span class="number">1</span>)</span><br><span class="line">        t = _dx * mod_temp % p</span><br><span class="line">        m = m + p**i*t % (p**(i+<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">b&quot;flag&quot;</span> <span class="keyword">in</span> long_to_bytes(m)):</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;4b68c7eece6be865f6da2a4323edd491&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="strange-hash"><a href="#strange-hash" class="headerlink" title="*strange_hash"></a>*strange_hash</h3><p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = <span class="number">18446744073709551557</span></span><br><span class="line">M = [[<span class="number">8</span>, <span class="number">56</span>, <span class="number">280</span>], [<span class="number">18446744073709551543</span>, <span class="number">18446744073709551467</span>, <span class="number">18446744073709551123</span>], [<span class="number">7</span>, <span class="number">35</span>, <span class="number">155</span>]]</span><br><span class="line">ConInv = [<span class="number">0x39a3f978106bac2d</span>,<span class="number">0x2940e055f4a33725</span>,<span class="number">0xfda9a7a293fb5bc9</span>]</span><br><span class="line">Con = [[<span class="number">0x9c52c2de7a9373c4</span>,<span class="number">0xf2135cb886d0fa21</span>,<span class="number">0x957df7f3cd4879e9</span>], [<span class="number">0xd54f837d2738d717</span>,<span class="number">0x400ddf1ffaae436d</span>,<span class="number">0xc2abb601d9a26b07</span>], [<span class="number">0x1904359f1deb3495</span>,<span class="number">0xc21aa09ba52b157b</span>,<span class="number">0x3d45525db1b19a0c</span>], [<span class="number">0xed66cf26a65afc73</span>,<span class="number">0x1cee569b29ffa476</span>,<span class="number">0x3da45abf4304849</span>], [<span class="number">0x1c1a642fa0f3d96d</span>,<span class="number">0x59a1c4fbb96aec86</span>,<span class="number">0xa18e9ca93163f63d</span>], [<span class="number">0x9621ec9fbcb402be</span>,<span class="number">0xd69468353c31bee0</span>,<span class="number">0x50655b3f20fee3b8</span>], [<span class="number">0x109cde7a61c2c195</span>,<span class="number">0x5ebbd9e98be60c59</span>,<span class="number">0x334d2d15f6e43190</span>], [<span class="number">0x47af2b0d63901977</span>,<span class="number">0x67ace097bf8c6f34</span>,<span class="number">0xb87da3296b70d64b</span>], [<span class="number">0x52d6344b38f49899</span>,<span class="number">0xad5773add31420e1</span>,<span class="number">0xecd0b7480f8c8095</span>], [<span class="number">0xe2afb6d20f5decda</span>,<span class="number">0xb1767d8be7d1371</span>,<span class="number">0x902fd6806a0ef4db</span>]]</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(Con) == <span class="number">10</span></span><br><span class="line">Inv = inverse(<span class="number">3</span>, p-<span class="number">1</span>)</span><br><span class="line">Round = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x, y</span>):</span><br><span class="line">    <span class="keyword">return</span> [(a + b)%p <span class="keyword">for</span> a, b <span class="keyword">in</span> <span class="built_in">zip</span>(x, y)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">multiply</span>(<span class="params">x, M</span>):</span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(M[<span class="number">0</span>])):</span><br><span class="line">        temp = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):</span><br><span class="line">            temp += x[j] * M[j][i]</span><br><span class="line">        result.append(temp%p)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Rescue_Prime</span>(<span class="params">R, P</span>):</span><br><span class="line">    X = add(P, ConInv)</span><br><span class="line">    Y = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">    Z = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">    U = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(R):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">            Y[i] = <span class="built_in">pow</span>(X[i], <span class="number">3</span>, p)</span><br><span class="line">            </span><br><span class="line">        Z = add(Con[<span class="number">2</span>*r%<span class="number">10</span>], multiply(Y, M))</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">            U[i] = <span class="built_in">pow</span>(Z[i], Inv, p)</span><br><span class="line"></span><br><span class="line">        X = add(Con[(<span class="number">2</span>*r+<span class="number">1</span>)%<span class="number">10</span>], multiply(U, M))</span><br><span class="line">    <span class="keyword">return</span> X</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Task</span>(socketserver.BaseRequestHandler):</span><br><span class="line">    encrypt_history = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, *args, **kargs</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__(*args, **kargs)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">proof_of_work</span>(<span class="params">self</span>):</span><br><span class="line">        random.seed(urandom(<span class="number">8</span>))</span><br><span class="line">        proof = <span class="string">&#x27;&#x27;</span>.join([</span><br><span class="line">            random.choice(string.ascii_letters + string.digits)</span><br><span class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)</span><br><span class="line">        ])</span><br><span class="line">        digest = sha256(proof.encode()).hexdigest()</span><br><span class="line">        self.send_line(</span><br><span class="line">            <span class="built_in">str</span>.encode((<span class="string">&quot;sha256(XXXX + %s) == %s&quot;</span> % (proof[<span class="number">4</span>:], digest))))</span><br><span class="line">        self.send_line(<span class="built_in">str</span>.encode(<span class="string">&#x27;Give me XXXX:&#x27;</span>))</span><br><span class="line">        x = self.request.recv(<span class="number">10</span>)</span><br><span class="line">        x = (x.strip()).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(x) != <span class="number">4</span> <span class="keyword">or</span> sha256(</span><br><span class="line">                (x + proof[<span class="number">4</span>:]).encode()).hexdigest() != digest:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">send_line</span>(<span class="params">self, msg</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            self.request.sendall(msg + <span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">read_line</span>(<span class="params">self</span>):</span><br><span class="line">        body = <span class="string">b&quot;&quot;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            ch = self.request.recv(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">if</span> ch == <span class="string">b&quot;\n&quot;</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            body = body + ch</span><br><span class="line">        <span class="keyword">return</span> body</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">timeout_handler</span>(<span class="params">self, signum, frame</span>):</span><br><span class="line">        <span class="keyword">raise</span> TimeoutError</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> self.proof_of_work():</span><br><span class="line">                self.dosend(<span class="string">b&#x27;You must pass the PoW!&#x27;</span>)</span><br><span class="line">                self.request.close()</span><br><span class="line">            self.send_line(<span class="string">b&#x27;Send your input:&#x27;</span>)</span><br><span class="line">            input_str = self.read_line().decode()</span><br><span class="line">            num_tuple = <span class="built_in">tuple</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, input_str.strip(<span class="string">&#x27;()&#x27;</span>).split(<span class="string">&#x27;,&#x27;</span>)))  </span><br><span class="line">            <span class="keyword">if</span> num_tuple[-<span class="number">1</span>] != <span class="number">0</span>:</span><br><span class="line">                self.send_line(<span class="string">b&#x27;The third number is not zero!&#x27;</span>)</span><br><span class="line">                self.request.close()</span><br><span class="line">            output = Rescue_Prime(Round, num_tuple)</span><br><span class="line">            <span class="keyword">if</span> output[-<span class="number">1</span>] == <span class="number">0</span>:</span><br><span class="line">                self.send_line(<span class="string">b&#x27;congratulate! Here is the flag:&#x27;</span>)</span><br><span class="line">                self.send_line(flag)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.send_line(<span class="string">b&#x27;Oops! Find collision failed.&#x27;</span>)</span><br><span class="line">                self.request.close()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            self.send_line(<span class="string">b&#x27;What\&#x27;s wrong???&#x27;</span>)</span><br><span class="line">            self.request.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HOST, PORT = <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">9999</span></span><br><span class="line">server = ThreadedServer((HOST, PORT), Task)</span><br><span class="line">server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">server.serve_forever()</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®çš„å¤§è‡´è¦æ±‚å¦‚ä¸‹ï¼š</p>
<ul>
<li>é€šè¿‡proof</li>
<li>æä¾›ä¸€ç»„è¾“å…¥(x,y,0)ï¼Œè¦æ±‚è¯¥è¾“å…¥é€šè¿‡è‡ªå®šä¹‰å“ˆå¸Œå‡½æ•°Rescue_Primeåï¼Œç”Ÿæˆçš„è¾“å‡ºæ˜¯(xâ€™,yâ€™,0)ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¦æ±‚å“ˆå¸Œå‡½æ•°çš„è¾“å…¥è¾“å‡ºçš„æœ€åä¸€ä½å‡ä¸º0</li>
</ul>
<p>å…¶ä¸­ï¼Œè‡ªå®šä¹‰çš„å“ˆå¸Œå‡½æ•°Rescue_Primeç”Ÿæˆè¿‡ç¨‹å¦‚ä¸‹(å…¶ä¸­ä¸‰æ¬¡æ–¹æ„ä¹‰æ˜¯ä¸‰å…ƒç»„çš„æ¯ä¸€ä¸ªæ•°å­—è¿›è¡Œä¸‰æ¬¡æ–¹ï¼Œæ˜¯ä¸ºäº†æ–¹ä¾¿è€Œè¿™æ ·è¡¨ç¤º)ï¼š</p>
<script type="math/tex; mode=display">
output = ((((Input+Coninv)^3M+Con[0])^{-3}M+Con[1])^3M+Con[2])^{-3}M+Con[3]</script><p>çœ‹ä¸Šå»ä¼¼ä¹å¾ˆå¤æ‚ï¼Œä¸è¿‡ä»”ç»†ä¸€çœ‹ï¼Œè¿™æ€ä¹ˆä¼šæ˜¯ä¸ªå“ˆå¸Œå‡½æ•°å‘¢ï¼Ÿå› ä¸ºå“ˆå¸Œå‡½æ•°å…·æœ‰å•å‘æ€§ï¼Œè€Œä»–è¿›è¡Œçš„æ¯ä¸€æ­¥éƒ½æ˜¯å¯é€†çš„ã€‚æ¯”å¦‚å¦‚æœåŠ Conå‘é‡ï¼Œé€†æ“ä½œå°±æ˜¯å¯¹åº”å‡å›å»ï¼›å¦‚æœæ˜¯å³ä¹˜Mï¼Œé€†æ“ä½œå°±æ˜¯å¯¹åº”è§£ä¸€ä¸ªçŸ©é˜µæ–¹ç¨‹ï¼›å¦‚æœæ˜¯ä¹˜3æ¬¡æ–¹æˆ–è€…-3æ¬¡æ–¹ï¼Œé€†æ“ä½œå°±æ˜¯å¯¹åº”ä¹˜æŒ‡æ•°é€†å…ƒã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªè¾“å‡ºï¼Œå°±å®šä¸º(1,1,0)ï¼Œç„¶åå°±å¯ä»¥æŒ‰å¦‚ä¸‹æ“ä½œåè§£å‡ºå¯¹åº”çš„å“ˆå¸Œå‡½æ•°çš„è¾“å…¥ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">minus</span>(<span class="params">x, y</span>):</span><br><span class="line">    <span class="keyword">return</span> [(a - b)%p <span class="keyword">for</span> a, b <span class="keyword">in</span> <span class="built_in">zip</span>(x, y)]</span><br><span class="line">   </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reveal</span>(<span class="params">R,P</span>):</span><br><span class="line">    X = minus(P,Con[<span class="number">3</span>])</span><br><span class="line">    <span class="built_in">print</span>(X)</span><br><span class="line">    X = [<span class="number">1515850589463500072</span>, <span class="number">12720000879441077924</span>, <span class="number">13358055339402620049</span>]</span><br><span class="line">    Y = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> X:</span><br><span class="line">        temp = <span class="built_in">pow</span>(i,<span class="number">3</span>,p)</span><br><span class="line">        Y.append(temp)</span><br><span class="line">    Y = minus(Y,Con[<span class="number">2</span>])</span><br><span class="line">    <span class="built_in">print</span>(Y)</span><br><span class="line">    Y = [<span class="number">3174461340829758314</span>, <span class="number">3934956789177085137</span>, <span class="number">11015113952396946596</span>]</span><br><span class="line">    Z = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> Y:</span><br><span class="line">        temp = <span class="built_in">pow</span>(i,Inv,p)</span><br><span class="line">        <span class="comment">#print(pow(temp,3,p) == i)</span></span><br><span class="line">        Z.append(temp)</span><br><span class="line">    Z = minus(Z,Con[<span class="number">1</span>])</span><br><span class="line">    <span class="built_in">print</span>(Z)</span><br><span class="line">    Z = [<span class="number">17548701131591609521</span>, <span class="number">14710429855691795808</span>, <span class="number">236055829718743711</span>]</span><br><span class="line">    X = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> Z:</span><br><span class="line">        temp = <span class="built_in">pow</span>(i,<span class="number">3</span>,p)</span><br><span class="line">        <span class="comment">#print(pow(temp,3,p) == i)</span></span><br><span class="line">        X.append(temp)</span><br><span class="line">    X = minus(X,Con[<span class="number">0</span>])</span><br><span class="line">    <span class="built_in">print</span>(X)</span><br><span class="line">    X = [<span class="number">1356636556594689318</span>, <span class="number">3037182169075815915</span>, <span class="number">14113359553476699425</span>]</span><br><span class="line">    Y = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> X:</span><br><span class="line">        temp = <span class="built_in">pow</span>(i,Inv,p)</span><br><span class="line">        Y.append(temp)</span><br><span class="line">    Y = minus(Y,ConInv)</span><br><span class="line">    <span class="built_in">print</span>(Y)</span><br><span class="line"></span><br><span class="line">R = <span class="number">2</span></span><br><span class="line">In = (<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>)</span><br><span class="line">reveal(<span class="number">2</span>,In)</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œæ¯ä¸ªçŸ©é˜µæ˜¯ç”±sageè§£çŸ©é˜µæ–¹ç¨‹è§£çš„ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">18446744073709551557</span></span><br><span class="line">M = [[<span class="number">8</span>, <span class="number">56</span>, <span class="number">280</span>], [-<span class="number">14</span>, -<span class="number">90</span>, -<span class="number">434</span>], [<span class="number">7</span>, <span class="number">35</span>, <span class="number">155</span>]]</span><br><span class="line">Inv = inverse(<span class="number">3</span>, p-<span class="number">1</span>)</span><br><span class="line">Round = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å½“å‰éœ€è§£çš„å³å‘é‡</span></span><br><span class="line">c = [<span class="number">11785826738904333038</span>, <span class="number">1444931144810824421</span>, <span class="number">13360052317957358486</span>]</span><br><span class="line">c = vector(GF(p),c)</span><br><span class="line">m = matrix(GF(p),<span class="number">3</span>,<span class="number">3</span>,M)</span><br><span class="line">a1 = m.solve_left(c)</span><br><span class="line"><span class="built_in">print</span>(a1)</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹å…³ç³»ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">Input = [<span class="number">5329202944861711021</span>, <span class="number">10075872277090249537</span>, <span class="number">6598944197421011167</span>]</span><br><span class="line">Rescue_Prime(R,Input) = (<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯é¢˜ç›®è¦æ±‚éœ€è¦ä¼ å…¥ä¸€ä¸ªæœ«å°¾ä¸º0çš„è¾“å…¥æ‰è¡Œï¼Œè¿™æ€ä¹ˆåŠå‘¢ï¼Ÿæ¯”èµ›ä¸­ä¹Ÿå°±åœåœ¨è¿™é‡Œäº†ï¼Œä¸çŸ¥é“å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>ç„¶åèµ›åæœ‰å¸ˆå‚…å‘Šè¯‰äº†æˆ‘æ€è·¯ï¼Œé—®é¢˜å‡ºåœ¨è¿™é‡Œ(ä¼°è®¡ä¸æ˜¯é¢„æœŸè§£)ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">self.send_line(<span class="string">b&#x27;Send your input:&#x27;</span>)</span><br><span class="line">input_str = self.read_line().decode()</span><br><span class="line">num_tuple = <span class="built_in">tuple</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, input_str.strip(<span class="string">&#x27;()&#x27;</span>).split(<span class="string">&#x27;,&#x27;</span>)))  </span><br><span class="line"><span class="keyword">if</span> num_tuple[-<span class="number">1</span>] != <span class="number">0</span>:</span><br><span class="line">    self.send_line(<span class="string">b&#x27;The third number is not zero!&#x27;</span>)</span><br><span class="line">    self.request.close()</span><br><span class="line">output = Rescue_Prime(Round, num_tuple)</span><br><span class="line"><span class="keyword">if</span> output[-<span class="number">1</span>] == <span class="number">0</span>:</span><br><span class="line">    self.send_line(<span class="string">b&#x27;congratulate! Here is the flag:&#x27;</span>)</span><br><span class="line">    self.send_line(flag)</span><br></pre></td></tr></table></figure>
<p>è¿™æ˜¯é¢˜ç›®çš„äº¤äº’éƒ¨åˆ†ï¼Œéå¸¸ä»”ç»†çš„çœ‹çš„è¯ï¼Œå¯ä»¥çœ‹å‡ºï¼Œä»–æ²¡æœ‰é™åˆ¶è¾“å…¥é•¿åº¦ï¼Œè€Œåªå¯¹è¾“å…¥è¾“å‡ºçš„-1é¡¹è¿›è¡Œæ˜¯å¦ä¸º0çš„æ£€æŸ¥ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåˆšæ‰åè§£(1,1,0)å¾—åˆ°çš„è¾“å…¥ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[5329202944861711021, 10075872277090249537, 6598944197421011167]</span><br></pre></td></tr></table></figure>
<p>å†™æˆè¿™ç§å½¢å¼ä¼ ç»™æœåŠ¡å™¨ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(5329202944861711021, 10075872277090249537, 6598944197421011167,0)</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å°±èƒ½æ»¡è¶³æœ€åä¸€é¡¹ä¸º0çš„æ£€æŸ¥ï¼Œç®—å‡ºæ¥çš„è¾“å‡ºè‡ªç„¶ä¹Ÿæ˜¯(1,1,0)ï¼Œå°±èƒ½å¾—åˆ°flagäº†ã€‚</p>
<p>exp(æ¯”èµ›ç»“æŸæ²¡ç¯å¢ƒäº†ï¼Œå¯èƒ½ä¼šå‡ºé”™)ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> powmod</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>():</span><br><span class="line">	table = string.digits + string.ascii_letters</span><br><span class="line">	temp = r.recvuntil(<span class="string">b&quot;sha256(XXXX + &quot;</span>)</span><br><span class="line">	temp = r.recvline()</span><br><span class="line">	suffix = temp[:<span class="number">16</span>].decode()</span><br><span class="line">	hex1 = temp[<span class="number">20</span>:].strip().decode()</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> tqdm(table):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> table:</span><br><span class="line">			<span class="keyword">for</span> k <span class="keyword">in</span> table:</span><br><span class="line">				<span class="keyword">for</span> m <span class="keyword">in</span> table:</span><br><span class="line">					temp1 = i+j+k+m</span><br><span class="line">					<span class="keyword">if</span>(sha256((temp1+suffix).encode()).hexdigest() == hex1):</span><br><span class="line">						r.sendline(temp1.encode())</span><br><span class="line">						<span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;59.110.231.185&quot;</span>,<span class="number">38630</span>)</span><br><span class="line">proof_of_work()</span><br><span class="line">r.recvuntil(<span class="string">b&quot; input:&quot;</span>)</span><br><span class="line">r.sendline(<span class="string">&quot;(5329202944861711021, 10075872277090249537, 6598944197421011167,0)&quot;</span>.encode())</span><br><span class="line">temp = r.recvline()</span><br><span class="line">temp = r.recvline()</span><br><span class="line">temp = r.recvline()</span><br><span class="line"><span class="built_in">print</span>(temp)</span><br></pre></td></tr></table></figure>
<p>â€¦â€¦â€¦â€¦â€¦â€¦</p>
<p>ç¡®å®æœ‰ä¸€ç‚¹æ— è¯­ï¼Œä¸è¿‡ç¡®å®ä¹Ÿæ€ªè‡ªå·±ä¸å¤Ÿç»†å¿ƒã€‚è¿™ä¸ªèµ›é¢˜æä¾›çš„å®è´µç»éªŒå°±æ˜¯ï¼š<strong>ä¸€å®šè¦å…ˆæ£€æŸ¥äº¤äº’éƒ¨åˆ†æœ¬èº«æœ‰æ²¡æœ‰æ¼æ´ï¼Œæœ‰å¯èƒ½å°±èƒ½ç›´æ¥è·³è¿‡ä¸€ä¸ªå¾ˆå¤æ‚çš„é—®é¢˜ï¼</strong></p>
<p><br></p>
<p><br></p>
]]></content>
      <categories>
        <category>wp-crypto</category>
      </categories>
  </entry>
  <entry>
    <title>2023-ç¾ŠåŸæ¯-wp-crypto</title>
    <url>/post/47440.html</url>
    <content><![CDATA[<p>éšæ‰‹è®°å½•ä¸€ä¸‹~</p>
<span id="more"></span>
<h2 id="Danger-RSA"><a href="#Danger-RSA" class="headerlink" title="Danger_RSA"></a>Danger_RSA</h2><p>é¢˜ç›®æè¿°:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">çœ‹ä¼¼ç®€å•çš„rsa</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_key</span>(<span class="params">a, nbit</span>):</span><br><span class="line">    <span class="keyword">assert</span> a &gt;= <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        X = getRandomInteger(nbit // a)</span><br><span class="line">        s = getRandomRange(<span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">4</span>), <span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">5</span>))</span><br><span class="line">        p = X ** a + s</span><br><span class="line">        <span class="keyword">if</span> isPrime(p):</span><br><span class="line">            <span class="keyword">return</span> (p, s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p, s = get_key(a, <span class="number">1024</span>)</span><br><span class="line">q, t = get_key(a, <span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">N = p * q</span><br><span class="line">e = s * t</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;N =&quot;</span>, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e =&quot;</span>, e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"><span class="comment"># N = 20289788565671012003324307131062103060859990244423187333725116068731043744218295859587498278382150779775620675092152011336913225797849717782573829179765649320271927359983554162082141908877255319715400550981462988869084618816967398571437725114356308935833701495015311197958172878812521403732038749414005661189594761246154666465178024563227666440066723650451362032162000998737626370987794816660694178305939474922064726534186386488052827919792122844587807300048430756990391177266977583227470089929347969731703368720788359127837289988944365786283419724178187242169399457608505627145016468888402441344333481249304670223</span></span><br><span class="line"><span class="comment"># e = 11079917583</span></span><br><span class="line"><span class="comment"># c = 13354219204055754230025847310134936965811370208880054443449019813095522768684299807719787421318648141224402269593016895821181312342830493800652737679627324687428327297369122017160142465940412477792023917546122283870042482432790385644640286392037986185997262289003477817675380787176650410819568815448960281666117602590863047680652856789877783422272330706693947399620261349458556870056095723068536573904350085124198592111773470010262148170379730937529246069218004969402885134027857991552224816835834207152308645148250837667184968030600819179396545349582556181916861808402629154688779221034610013350165801919342549766</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®åˆçœ‹æ²¡æœ‰ä»€ä¹ˆä¸‹æ‰‹ç‚¹ï¼Œä½†å…¶å®get_keyå‡½æ•°çš„è¿™ä¸¤è¡Œæš´éœ²äº†å¾ˆå¤šä¿¡æ¯:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">X = getRandomInteger(nbit // a)</span><br><span class="line">s = getRandomRange(<span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">4</span>), <span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">5</span>))</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œaå¯èƒ½çš„èŒƒå›´å…¶å®å¾ˆå°ï¼Œç²—ç•¥çš„èŒƒå›´éƒ½ä»…æœ‰[2,1024],è¿™ä¸ªæ—¶å€™å†çœ‹ç”Ÿæˆçš„eï¼Œå¯ä»¥å‘ç°ï¼Œeç›¸å¯¹æ¥è¯´å¤ªå°äº†ï¼Œç”šè‡³å¯ä»¥å¾—åˆ°ä»–çš„å…¨éƒ¨ç´ å› å­åˆ†è§£ï¼Œå³ï¼š</p>
<script type="math/tex; mode=display">
e = 3*7*7*19*691*5741</script><p>å› æ­¤æˆ‘ä»¬å®Œå…¨å¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªæ–¹å¼æ¥è¿›ä¸€æ­¥ç¡®å®šaçš„å–å€¼èŒƒå›´:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">1024</span>):</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">4</span>)*<span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">4</span>) &lt;= e <span class="keyword">and</span> <span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">5</span>)*<span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">5</span>) &gt;= e):</span><br><span class="line">        <span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å‘ç°ï¼Œaå…¶å®ä»…èƒ½å–4ï¼›ä¸æ­¤åŒæ—¶å¯ä»¥æ˜ç™½ï¼Œå¯¹äºåˆšæ‰çš„eçš„å› å­åˆ†è§£ï¼Œä»…æœ‰ä¸¤ç§å¯èƒ½çš„ç»„åˆè®©ä¸¤æ¬¡ç”Ÿæˆçš„så‡è½åœ¨aè§„å®šçš„èŒƒå›´é‡Œï¼š</p>
<script type="math/tex; mode=display">
s=5741*19\;,\;t=691*3*7*7</script><script type="math/tex; mode=display">
s=5741*3*7\;,\;t=691*7*19</script><p>æ­¤æ—¶å†çœ‹nçš„ç”Ÿæˆè¿‡ç¨‹ï¼š</p>
<script type="math/tex; mode=display">
n = (X1^4 + s)*(X2^4 + t)</script><p>så’Œtç›¸è¾ƒäºX1ã€X2æ¥è¯´éå¸¸å°ï¼Œå› æ­¤å¯¹nå¼€4æ¬¡æ–¹æ ¹å°±å¯ä»¥å¾—åˆ°X1*X2ï¼Œæ­¤æ—¶ï¼Œå°±å¯ä»¥ä»¥ä»¥ä¸‹æ–¹å¼åˆ†è§£nï¼š</p>
<script type="math/tex; mode=display">
n = (X1*X2)^4 + t*X1^4 + s*X2^4  + s*t</script><p>å°†æ‰€æœ‰é‡ç§»åŠ¨åˆ°åŒä¸€ä¾§ï¼š</p>
<script type="math/tex; mode=display">
(X1*X2)^4 + t*X1^4 + s*X2^4  + s*t - n = 0</script><p>å·¦å³åŒæ—¶ä¹˜$\; X1^4$ï¼Œå¾—:</p>
<script type="math/tex; mode=display">
((X1*X2)^4  + s*t - n)* X1^4 + t*(X1^4)^2 + s*X2^4*X1^4= 0</script><p>æ­¤æ—¶ï¼Œä»¤$\;x = X1^4$ï¼Œå°±å¾—åˆ°ä¸‹é¢çš„ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹ï¼š</p>
<script type="math/tex; mode=display">
t*x^2 + ((X1*X2)^4  + s*t - n)* x + s*(X2*X1)^4= 0</script><p>å°†å¯èƒ½çš„ä¸¤ç»„sã€tï¼Œé€ä¸ªä»£å…¥è§£ä¸Šè¿°æ–¹ç¨‹ï¼Œå°±å¯ä»¥å¾—åˆ°nçš„åˆ†è§£ã€‚</p>
<p>å¾—åˆ°nçš„åˆ†è§£åï¼Œæƒ³è¦ç›´æ¥æ±‚è§£RSAè§£å¯†å´å‘ç°$\;gcd(e,phi_n)\;!=\;1$ï¼Œå‘ç°æ˜¯å› ä¸º$\;3|(p-1)$ä¸”$\;7|(q-1)$ï¼Œæ­¤æ—¶ç”±äºé¢˜ç›®ä¸­å¹¶æœªè¯´æ˜å¯¹flagåšè¿‡é¢å¤–å¡«å……å¤„ç†ï¼Œè€Œpã€qä¸¤ä¸ªå› å­å‡æœ‰æ¥è¿‘1024æ¯”ç‰¹ï¼Œæ­£å¸¸æ¥è¯´è¿œå¤§äºæ˜æ–‡æ¯”ç‰¹ä½ï¼Œå› æ­¤å¯ä»¥è½¬åŒ–åˆ°æ¨¡pä¸‹æ±‚è§£ï¼Œè¿™æ˜¯å› ä¸ºï¼š</p>
<script type="math/tex; mode=display">
m^{e} = (m^3)^{7*7*19*691*5741} \equiv c\quad(mod\;p)</script><p>è€Œ</p>
<script type="math/tex; mode=display">
\quad gcd(7*7*19*691*5741,(p-1)) = 1</script><p>æ‰€ä»¥å¯ä»¥å°†$m^3$å½“ä½œä¸€ä¸ªæ•´ä½“ï¼Œè¿›è¡ŒRSAè§£å¯†ååœ¨æ¨¡pä¸‹å¼€ä¸‰æ¬¡æ–¹æ ¹å³å¯ã€‚</p>
<p><br></p>
<p>exp.ipynb:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"></span><br><span class="line">N = <span class="number">20289788565671012003324307131062103060859990244423187333725116068731043744218295859587498278382150779775620675092152011336913225797849717782573829179765649320271927359983554162082141908877255319715400550981462988869084618816967398571437725114356308935833701495015311197958172878812521403732038749414005661189594761246154666465178024563227666440066723650451362032162000998737626370987794816660694178305939474922064726534186386488052827919792122844587807300048430756990391177266977583227470089929347969731703368720788359127837289988944365786283419724178187242169399457608505627145016468888402441344333481249304670223</span></span><br><span class="line">e = <span class="number">11079917583</span></span><br><span class="line">c = <span class="number">13354219204055754230025847310134936965811370208880054443449019813095522768684299807719787421318648141224402269593016895821181312342830493800652737679627324687428327297369122017160142465940412477792023917546122283870042482432790385644640286392037986185997262289003477817675380787176650410819568815448960281666117602590863047680652856789877783422272330706693947399620261349458556870056095723068536573904350085124198592111773470010262148170379730937529246069218004969402885134027857991552224816835834207152308645148250837667184968030600819179396545349582556181916861808402629154688779221034610013350165801919342549766</span></span><br><span class="line">elist = [<span class="number">3</span>,<span class="number">7</span>,<span class="number">7</span>,<span class="number">19</span>,<span class="number">691</span>,<span class="number">5741</span>]</span><br><span class="line"></span><br><span class="line">a = <span class="number">2</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">pow</span>(<span class="number">2</span>, i ** <span class="number">2</span> - i + <span class="number">4</span>)*<span class="built_in">pow</span>(<span class="number">2</span>, i ** <span class="number">2</span> - i + <span class="number">4</span>) &lt;= e <span class="keyword">and</span> <span class="built_in">pow</span>(<span class="number">2</span>, i ** <span class="number">2</span> - i + <span class="number">5</span>)*<span class="built_in">pow</span>(<span class="number">2</span>, i ** <span class="number">2</span> - i + <span class="number">5</span>) &gt;= e):</span><br><span class="line">        a = i</span><br><span class="line"></span><br><span class="line">s1 = <span class="number">120561</span> </span><br><span class="line">s2 = <span class="number">91903</span></span><br><span class="line"></span><br><span class="line">ab = iroot(N,<span class="number">4</span>)[<span class="number">0</span>] ** <span class="number">4</span></span><br><span class="line">b = -(N-ab-s1*s2)</span><br><span class="line">a = s2</span><br><span class="line">c1 = s1*ab</span><br><span class="line">x = <span class="built_in">int</span>((-b + iroot(b**<span class="number">2</span>-<span class="number">4</span>*a*c1,<span class="number">2</span>)[<span class="number">0</span>]) // (<span class="number">2</span>*a))</span><br><span class="line">p = x + s1</span><br><span class="line">q = N//p</span><br><span class="line"></span><br><span class="line">d = inverse(e//<span class="number">3</span>,p-<span class="number">1</span>)</span><br><span class="line">m3 = <span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,p))</span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; = Zmod(p)[]</span><br><span class="line">f = x^<span class="number">3</span> - m3</span><br><span class="line">res = f.roots()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">    temp = long_to_bytes(<span class="built_in">int</span>(i[<span class="number">0</span>]))</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">b&quot;DASCTF&quot;</span> <span class="keyword">in</span> temp):</span><br><span class="line">        <span class="built_in">print</span>(temp)</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flagï¼š</p>
<font color="red">DASCTF{C0nsTruct!n9_Techn1qUe2_f0r_RSA_Pr1me_EnC2ypt10N}</font>

<p><br></p>
<p>å½“ç„¶ï¼Œè¿™é¢˜è¿˜æœ‰ä¸€äº›å€¼å¾—æ€è€ƒçš„åœ°æ–¹ï¼Œå¦‚è‹¥æ˜æ–‡çš„æ¯”ç‰¹ä½è¶…è¿‡äº†pï¼Œåˆè¯¥æ€ä¹ˆåŠï¼Ÿ</p>
<p>é¦–å…ˆå¯ä»¥å…ˆå°†ä¸p-1ã€q-1å‡ä¸äº’ç´ çš„ç´ å› å­ç”¨æ™®é€šRSAè§£å¯†å‰”å»ï¼Œå¾—åˆ°</p>
<script type="math/tex; mode=display">
\quad c\equiv m^{3*7*7}\quad (mod\;n)</script><p>ç„¶åå°±å¯ä»¥ä½¿ç”¨AMMç®—æ³•ï¼Œä½†æ˜¯è¿™æ—¶ä½¿ç”¨AMMç®—æ³•åˆæœ‰ä¸€ç‚¹ç‰¹æ®Šï¼Œè¿™æ˜¯å› ä¸ºè™½ç„¶$7|q-1$ï¼Œä½†æ˜¯49å´ä¸æ•´é™¤äºq-1ï¼Œå› æ­¤æ— æ³•ä¸€æ¬¡æ€§åœ¨æ¨¡qä¸‹å¼€49æ¬¡æ–¹æ ¹ï¼Œè€Œéœ€è¦å…ˆå¼€ä¸ƒæ¬¡æ–¹æ ¹ï¼Œå†å¯¹7ä¸ªå¼€å‡ºçš„æ ¹å†å„å¼€7æ¬¡æ–¹æ ¹ï¼Œæœ€åå†ä¸æ¨¡pä¸‹å¼€å‡ºçš„3æ¬¡æ–¹æ ¹ä½œä¸­å›½å‰©ä½™å®šç†æ±‚è§£ï¼š</p>
<p>exp.ipynb:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long,long_to_bytes,inverse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = <span class="number">3232774922192317186963877855543094060264001327534643963164572334193887491269409927593188017108306298404437170754762182875998691872041391981365074638343520234882604136837212457817534624895485767634112947143897465253262932526424371614372553023510973107043735041993637367122527503031768408492566328264574062328255875477737300307769891808134846813311720049466136337129654155946431766445576339564816809841942907193731423184669912783673012406488607834333191988772032942474663985054409518153017182678863504596312351140412943307416458908324209967299195302214349899874812717459558411734343869783905720910923365168671056618</span></span><br><span class="line">p = <span class="number">5213351003420231819415242686664610206224730148063270274863722096379841592931572096469136339538500817713355302889731144789372844731378975059329731297860686270736540109105854515590165681366189003405833252270606896051264517339339578167231093908235856718285980689179840159807651185918046198419707669304960745217</span></span><br><span class="line">q = <span class="number">3891889986375336330559716098591764128742918441309724777337583126578227827768865619689858547513951476952436981068109005313431255086775128227872912287517417948310766208005723508039484956447166240210962374423348694952997002274647622939970550008327647559433222317977926773242269276334110863262269534189811138319</span></span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">3</span>*<span class="number">7</span>*<span class="number">7</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">onemod</span>(<span class="params">e, q</span>):</span><br><span class="line">    p = random.randint(<span class="number">1</span>, q-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">pow</span>(p, (q-<span class="number">1</span>)//e, q) == <span class="number">1</span>):  <span class="comment"># (r,s)=1</span></span><br><span class="line">        p = random.randint(<span class="number">1</span>, q)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AMM_rth</span>(<span class="params">o, r, q</span>):  <span class="comment"># r|(q-1</span></span><br><span class="line">    <span class="keyword">assert</span>((q-<span class="number">1</span>) % r == <span class="number">0</span>)</span><br><span class="line">    p = onemod(r, q)</span><br><span class="line"></span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    s = q-<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>(s % r == <span class="number">0</span>):</span><br><span class="line">        s = s//r</span><br><span class="line">        t += <span class="number">1</span></span><br><span class="line">    k = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>((s*k+<span class="number">1</span>) % r != <span class="number">0</span>):</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">    alp = (s*k+<span class="number">1</span>)//r</span><br><span class="line"></span><br><span class="line">    a = <span class="built_in">pow</span>(p, r**(t-<span class="number">1</span>)*s, q)</span><br><span class="line">    b = <span class="built_in">pow</span>(o, r*a-<span class="number">1</span>, q)</span><br><span class="line">    c = <span class="built_in">pow</span>(p, s, q)</span><br><span class="line">    h = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, t-<span class="number">1</span>):</span><br><span class="line">        d = <span class="built_in">pow</span>(<span class="built_in">int</span>(b), r**(t-<span class="number">1</span>-i), q)</span><br><span class="line">        <span class="keyword">if</span> d == <span class="number">1</span>:</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            j = (-math.log(d, a)) % r</span><br><span class="line">        b = (b*(c**(r*j))) % q</span><br><span class="line">        h = (h*c**j) % q</span><br><span class="line">        c = (c*r) % q</span><br><span class="line">    result = (<span class="built_in">pow</span>(o, alp, q)*h)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ALL_Solution</span>(<span class="params">m, q, rt, cq, e</span>):</span><br><span class="line">    mp = []</span><br><span class="line">    <span class="keyword">for</span> pr <span class="keyword">in</span> rt:</span><br><span class="line">        r = (pr*m) % q</span><br><span class="line">        <span class="comment"># assert(pow(r, e, q) == cq)</span></span><br><span class="line">        mp.append(r)</span><br><span class="line">    <span class="keyword">return</span> mp</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calc</span>(<span class="params">mp, mq, e, p, q</span>):</span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    j = <span class="number">1</span></span><br><span class="line">    t1 = inverse(q, p)</span><br><span class="line">    t2 = inverse(p, q)</span><br><span class="line">    <span class="keyword">for</span> mp1 <span class="keyword">in</span> mp:</span><br><span class="line">        <span class="keyword">for</span> mq1 <span class="keyword">in</span> mq:</span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> j % <span class="number">100000</span> == <span class="number">0</span>:</span><br><span class="line">                <span class="built_in">print</span>(j)</span><br><span class="line">            ans = (mp1*t1*q+mq1*t2*p) % (p*q)</span><br><span class="line">            <span class="keyword">if</span> check(ans):</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        a = long_to_bytes(m)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;DASCTF&#x27;</span> <span class="keyword">in</span> a <span class="keyword">or</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> a:</span><br><span class="line">            <span class="built_in">print</span>(a)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ALL_ROOT2</span>(<span class="params">r, q</span>):  <span class="comment"># use function set() and .add() ensure that the generated elements are not repeated</span></span><br><span class="line">    li = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">len</span>(li) &lt; r):</span><br><span class="line">        p = <span class="built_in">pow</span>(random.randint(<span class="number">1</span>, q-<span class="number">1</span>), (q-<span class="number">1</span>)//r, q)</span><br><span class="line">        li.add(p)</span><br><span class="line">    <span class="keyword">return</span> li</span><br><span class="line"></span><br><span class="line">cp = c % p</span><br><span class="line">cq = c % q</span><br><span class="line"></span><br><span class="line">mp = AMM_rth(cp, <span class="number">3</span>, p)</span><br><span class="line">mq = AMM_rth(cq, <span class="number">7</span>, q)</span><br><span class="line"></span><br><span class="line">rt1 = ALL_ROOT2(<span class="number">3</span>, p)</span><br><span class="line">rt2 = ALL_ROOT2(<span class="number">7</span>, q)</span><br><span class="line"></span><br><span class="line">amp = ALL_Solution(mp, p, rt1, cp, <span class="number">3</span>)</span><br><span class="line">amq = ALL_Solution(mq, q, rt2, cq, <span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¾—åˆ°æ¨¡qä¸‹æ‰€æœ‰æ ¹</span></span><br><span class="line">mqs = []</span><br><span class="line"><span class="keyword">for</span> mq <span class="keyword">in</span> amq:</span><br><span class="line">    mqs.append(mq)</span><br><span class="line">amq = mqs</span><br><span class="line">dq = inverse(<span class="number">3</span>, (q-<span class="number">1</span>))</span><br><span class="line">mmqs = []</span><br><span class="line"><span class="keyword">for</span> mq <span class="keyword">in</span> amq:</span><br><span class="line">    mmq = AMM_rth(mq, <span class="number">7</span>, q)</span><br><span class="line"></span><br><span class="line">    rt3 = ALL_ROOT2(<span class="number">7</span>, q)</span><br><span class="line"></span><br><span class="line">    mamq = ALL_Solution(mmq, q, rt3, mq, <span class="number">7</span>)</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> mamq:</span><br><span class="line">        mmqs.append(<span class="built_in">int</span>(<span class="built_in">pow</span>(t,dq,q)))</span><br><span class="line">amq = mmqs</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¾—åˆ°æ¨¡pä¸‹æ‰€æœ‰æ ¹</span></span><br><span class="line">dp = inverse(<span class="number">49</span>, (p-<span class="number">1</span>))</span><br><span class="line">mps = []</span><br><span class="line"><span class="keyword">for</span> mp <span class="keyword">in</span> amp:</span><br><span class="line">    mps.append(<span class="built_in">int</span>(<span class="built_in">pow</span>(mp, dp, p)))</span><br><span class="line">amp = mps</span><br><span class="line"></span><br><span class="line">calc(amp, amq, e, p, q)</span><br></pre></td></tr></table></figure>
<p>è€Œç®€ä¾¿ä¸€ç‚¹ï¼Œç›´æ¥è§£æœ‰é™åŸŸä¸‹çš„æ–¹ç¨‹ä¹Ÿæ˜¯å¯è¡Œçš„ï¼š</p>
<p>exp.ipynb:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long,long_to_bytes,inverse</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"><span class="comment">#ä½¿ç”¨å¦‚ï¼šM = crt(n,c)[0]</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">3232774922192317186963877855543094060264001327534643963164572334193887491269409927593188017108306298404437170754762182875998691872041391981365074638343520234882604136837212457817534624895485767634112947143897465253262932526424371614372553023510973107043735041993637367122527503031768408492566328264574062328255875477737300307769891808134846813311720049466136337129654155946431766445576339564816809841942907193731423184669912783673012406488607834333191988772032942474663985054409518153017182678863504596312351140412943307416458908324209967299195302214349899874812717459558411734343869783905720910923365168671056618</span></span><br><span class="line">p = <span class="number">5213351003420231819415242686664610206224730148063270274863722096379841592931572096469136339538500817713355302889731144789372844731378975059329731297860686270736540109105854515590165681366189003405833252270606896051264517339339578167231093908235856718285980689179840159807651185918046198419707669304960745217</span></span><br><span class="line">q = <span class="number">3891889986375336330559716098591764128742918441309724777337583126578227827768865619689858547513951476952436981068109005313431255086775128227872912287517417948310766208005723508039484956447166240210962374423348694952997002274647622939970550008327647559433222317977926773242269276334110863262269534189811138319</span></span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">3</span>*<span class="number">7</span>*<span class="number">7</span></span><br><span class="line"></span><br><span class="line">dp = inverse(<span class="number">49</span>,p-<span class="number">1</span>)</span><br><span class="line">cp = <span class="built_in">pow</span>(c,dp,p)</span><br><span class="line">PR.&lt;x&gt; = Zmod(p)[]</span><br><span class="line">f = x^<span class="number">3</span> - cp</span><br><span class="line">resp = f.roots()</span><br><span class="line"></span><br><span class="line">dq = inverse(<span class="number">3</span>,q-<span class="number">1</span>)</span><br><span class="line">cq = <span class="built_in">pow</span>(c,dq,q)</span><br><span class="line">PR.&lt;x&gt; = Zmod(q)[]</span><br><span class="line">f = x^<span class="number">49</span> - cq</span><br><span class="line">resq = f.roots()</span><br><span class="line"></span><br><span class="line">modlist = [p,q]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> resp:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> resq:</span><br><span class="line">        c = [<span class="built_in">int</span>(i[<span class="number">0</span>]),<span class="built_in">int</span>(j[<span class="number">0</span>])]</span><br><span class="line">        m = crt(modlist,c)[<span class="number">0</span>]</span><br><span class="line">        temp = long_to_bytes(m)</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">b&quot;DASCTF&quot;</span> <span class="keyword">in</span> temp):</span><br><span class="line">            <span class="built_in">print</span>(temp)</span><br></pre></td></tr></table></figure>
<p>å¤šç§æ–¹æ³•æ±‚è§£ï¼Œä¹Ÿæ˜¯ä¸ºäº†èƒ½æ›´çµæ´»çš„æ€è€ƒé—®é¢˜ï¼ŒæŒæ¡æ›´å¤šæ±‚è§£æ–¹å¼ï¼Œè®©è‡ªå·±ä¸€ç§æ–¹æ³•å¡ä½æ—¶ï¼Œå¯ä»¥æœ‰è·¯å¯èµ°ã€‚</p>
<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="Easy-3L"><a href="#Easy-3L" class="headerlink" title="Easy_3L"></a>Easy_3L</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ— </span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_key</span>():</span><br><span class="line">    p = getPrime(<span class="number">1400</span>)</span><br><span class="line">    f = getRandomNBitInteger(<span class="number">1024</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        q = getPrime(<span class="number">512</span>)</span><br><span class="line">        <span class="keyword">if</span> gcd(f, q) != <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    h = (invert(f, p) * q) % p</span><br><span class="line">    <span class="keyword">return</span> p, h</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt1</span>(<span class="params">m</span>):</span><br><span class="line">    a = getPrime(<span class="number">250</span>)</span><br><span class="line">    b = getRandomNBitInteger(<span class="number">240</span>)</span><br><span class="line">    n = getPrime(<span class="number">512</span>)</span><br><span class="line">    seed = m</span><br><span class="line">    s = [<span class="number">0</span>] * <span class="number">6</span></span><br><span class="line">    s[<span class="number">0</span>] = seed</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">6</span>):</span><br><span class="line">        s[i] = (s[i - <span class="number">1</span>] * a + b) % n</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt2</span>(<span class="params">msg, p, h</span>):</span><br><span class="line">    s = getRandomNBitInteger(<span class="number">512</span>)</span><br><span class="line">    c = (s * h + msg) % p</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s = encrypt1(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;S1 =&quot;</span>, s[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;S2 =&quot;</span>, s[<span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;S4 =&quot;</span>, s[<span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;S5 =&quot;</span>, s[<span class="number">5</span>])</span><br><span class="line"></span><br><span class="line">p, h = get_key()</span><br><span class="line">c = encrypt2(s[<span class="number">3</span>], p, h)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p =&quot;</span>, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;h =&quot;</span>, h)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># S1 = 28572152986082018877402362001567466234043851789360735202177142484311397443337910028526704343260845684960897697228636991096551426116049875141</span></span><br><span class="line"><span class="comment"># S2 = 1267231041216362976881495706209012999926322160351147349200659893781191687605978675590209327810284956626443266982499935032073788984220619657447889609681888</span></span><br><span class="line"><span class="comment"># S4 = 9739918644806242673966205531575183334306589742344399829232076845951304871478438938119813187502023845332528267974698273405630514228632721928260463654612997</span></span><br><span class="line"><span class="comment"># S5 = 9755668823764800147393276745829186812540710004256163127825800861195296361046987938775181398489372822667854079119037446327498475937494635853074634666112736</span></span><br><span class="line"><span class="comment"># p = 25886434964719448194352673440525701654705794467884891063997131230558866479588298264578120588832128279435501897537203249743883076992668855905005985050222145380285378634993563571078034923112985724204131887907198503097115380966366598622251191576354831935118147880783949022370177789175320661630501595157946150891275992785113199863734714343650596491139321990230671901990010723398037081693145723605154355325074739107535905777351</span></span><br><span class="line"><span class="comment"># h = 2332673914418001018316159191702497430320194762477685969994411366563846498561222483921873160125818295447435796015251682805613716554577537183122368080760105458908517619529332931042168173262127728892648742025494771751133664547888267249802368767396121189473647263861691578834674578112521646941677994097088669110583465311980605508259404858000937372665500663077299603396786862387710064061811000146453852819607311367850587534711</span></span><br><span class="line"><span class="comment"># c = 20329058681057003355767546524327270876901063126285410163862577312957425318547938475645814390088863577141554443432653658287774537679738768993301095388221262144278253212238975358868925761055407920504398004143126310247822585095611305912801250788531962681592054588938446210412897150782558115114462054815460318533279921722893020563472010279486838372516063331845966834180751724227249589463408168677246991839581459878242111459287</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®çš„3Læ˜¾ç„¶æŒ‡çš„æ˜¯LLLç®—æ³•ï¼ŒåŠ å¯†è¿‡ç¨‹åˆ†ä¸ºä¸¤å±‚ï¼š</p>
<ul>
<li>LCGåŠ å¯†ç§å­flag</li>
<li>NTRUåŠ å¯†LCGçš„S3</li>
</ul>
<p>é‚£ä¹ˆè§£é¢˜æ€è·¯ä¹Ÿå¾ˆæ¸…æ™°ï¼Œå…ˆè§£å†³NTRUè§£å‡ºS3ï¼Œè¿›è€Œæ¢å¤LCGçš„ç§å­å³å¯ã€‚</p>
<p>æœ¬é¢˜ä½ ä¼šå‘ç°è¦è§„çº¦å‡ºçš„å‘é‡(f,g)æ•°é‡çº§å¥½åƒå·®çš„æœ‰ç‚¹å¤šï¼Œå¾ˆéš¾è§„çº¦å‡º1024æ¯”ç‰¹çš„fï¼Œä½†æ˜¯ä¸é‡è¦ï¼Œfæ˜¯å¦ä¸ºåŸå§‹å€¼å¯¹äºè§£å¯†å½±å“å¹¶ä¸å¤§ï¼Œåªéœ€è¦æ£€æŸ¥S3çš„æ•°é‡çº§æ­£å¸¸å³å¯ã€‚(æ­£å¸¸æ¥è¯´ï¼Œä¸ºä½¿è§„çº¦åçš„å‘é‡æ¯”ç‰¹ç›¸è¿‘ï¼Œåº”åœ¨ç¬¬äºŒåˆ—ä¹˜ä¸Š2^512ï¼Œä½¿ f ä¸ (2^512)*gå…·æœ‰ç›¸åŒæ•°é‡çº§ï¼Œä½†æœ¬é¢˜ä¸­è¿™æ˜¯è§£ä¸å‡ºæ¥çš„ï¼Œå› æ­¤å¯ä»¥é‡‡ç”¨çˆ†ç ´æ‰‹æ®µï¼Œä¼šå‘ç°æœ‰å¾ˆå¤šçŸ­å‘é‡fã€gå‡å¯ä»¥ç”¨äºè§£å¯†ï¼Œè¿™ä¹Ÿç¬¦åˆNTRUçš„å¯†é’¥ç‰¹æ€§)</p>
<p>è§£å‡ºS3åæ˜¯ä¸ªç®€å•çš„LCGé—®é¢˜ï¼Œä¸å†èµ˜è¿°ã€‚</p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">25886434964719448194352673440525701654705794467884891063997131230558866479588298264578120588832128279435501897537203249743883076992668855905005985050222145380285378634993563571078034923112985724204131887907198503097115380966366598622251191576354831935118147880783949022370177789175320661630501595157946150891275992785113199863734714343650596491139321990230671901990010723398037081693145723605154355325074739107535905777351</span></span><br><span class="line">h = <span class="number">2332673914418001018316159191702497430320194762477685969994411366563846498561222483921873160125818295447435796015251682805613716554577537183122368080760105458908517619529332931042168173262127728892648742025494771751133664547888267249802368767396121189473647263861691578834674578112521646941677994097088669110583465311980605508259404858000937372665500663077299603396786862387710064061811000146453852819607311367850587534711</span></span><br><span class="line">c = <span class="number">20329058681057003355767546524327270876901063126285410163862577312957425318547938475645814390088863577141554443432653658287774537679738768993301095388221262144278253212238975358868925761055407920504398004143126310247822585095611305912801250788531962681592054588938446210412897150782558115114462054815460318533279921722893020563472010279486838372516063331845966834180751724227249589463408168677246991839581459878242111459287</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dec</span>(<span class="params">S3</span>):</span><br><span class="line">    S1 = <span class="number">28572152986082018877402362001567466234043851789360735202177142484311397443337910028526704343260845684960897697228636991096551426116049875141</span></span><br><span class="line">    S2 = <span class="number">1267231041216362976881495706209012999926322160351147349200659893781191687605978675590209327810284956626443266982499935032073788984220619657447889609681888</span></span><br><span class="line">    S4 = <span class="number">9739918644806242673966205531575183334306589742344399829232076845951304871478438938119813187502023845332528267974698273405630514228632721928260463654612997</span></span><br><span class="line">    S5 = <span class="number">9755668823764800147393276745829186812540710004256163127825800861195296361046987938775181398489372822667854079119037446327498475937494635853074634666112736</span></span><br><span class="line"></span><br><span class="line">    x = [S1, S2, S3, S4, S5]</span><br><span class="line">    t = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(x)):</span><br><span class="line">        t.append(x[i] - x[i-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    m = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(t)-<span class="number">1</span>):</span><br><span class="line">        m = GCD(t[i+<span class="number">1</span>]*t[i-<span class="number">1</span>] - t[i]*t[i], m)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> sieve_base:</span><br><span class="line">        <span class="keyword">while</span> m % p == <span class="number">0</span>: m //= p</span><br><span class="line">    <span class="keyword">assert</span> isPrime(m)</span><br><span class="line"></span><br><span class="line">    a = (S3 - S2) * inverse(S2 - S1, m)</span><br><span class="line">    b = (S2 - a*S1) % m</span><br><span class="line"></span><br><span class="line">    S1 = (S1-b)*inverse(a, m) % m</span><br><span class="line">    flag = long_to_bytes(S1)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;DASCTF&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">1000</span>):</span><br><span class="line">    L = Matrix(ZZ, [[<span class="number">1</span>, (<span class="number">2</span>**e)*h],</span><br><span class="line">                    [<span class="number">0</span>, (<span class="number">2</span>**e)*p]])</span><br><span class="line">    f, g = L.LLL()[<span class="number">0</span>]</span><br><span class="line">    g = g  // (<span class="number">2</span>**e)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        S3 = (f*c) % p % g * inverse(f, g) % g</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">len</span>(<span class="built_in">bin</span>(S3)) == <span class="number">514</span>):</span><br><span class="line">            dec(S3)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flagï¼š</p>
<font color="red">DASCTF{NTRU_L0G_a6e_S1mpLe}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="SigninCrypto"><a href="#SigninCrypto" class="headerlink" title="SigninCrypto"></a>SigninCrypto</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">éšæœºæ•°çœŸéšæœºå—ï¼Ÿå¦‚éšï¼</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> key <span class="keyword">import</span> key</span><br><span class="line"><span class="keyword">from</span> iv <span class="keyword">import</span> iv</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"></span><br><span class="line">K1= key</span><br><span class="line">hint1 = os.urandom(<span class="number">2</span>) * <span class="number">8</span></span><br><span class="line">xor =bytes_to_long(hint1)^bytes_to_long(K1)</span><br><span class="line"><span class="built_in">print</span>(xor)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Rand</span>():</span><br><span class="line">    rseed = secrets.randbits(<span class="number">1024</span>)</span><br><span class="line">    List1 = []</span><br><span class="line">    List2 = []</span><br><span class="line">    seed(rseed)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        rand16 = getrandbits(<span class="number">16</span>)</span><br><span class="line">        List1.append(rand16)</span><br><span class="line">    seed(rseed)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">312</span>):</span><br><span class="line">        rand64 = getrandbits(<span class="number">64</span>)</span><br><span class="line">        List2.append(rand64)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;task.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">for</span> rand16 <span class="keyword">in</span> List1:</span><br><span class="line">            file.write(<span class="built_in">hex</span>(rand16)+ <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> rand64 <span class="keyword">in</span> List2:</span><br><span class="line">            file.write(<span class="built_in">hex</span>((rand64 &amp; <span class="number">0xffff</span>) | ((rand64 &gt;&gt; <span class="number">32</span>) &amp; <span class="number">0xffff</span>) &lt;&lt; <span class="number">16</span>) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">Rand()</span><br><span class="line"></span><br><span class="line">K2 = long_to_bytes(getrandbits(<span class="number">64</span>))</span><br><span class="line">K3 = flag[:<span class="number">8</span>]</span><br><span class="line"></span><br><span class="line">KEY = K1 + K2 + K3</span><br><span class="line"></span><br><span class="line">IV=iv</span><br><span class="line"></span><br><span class="line">IV1=IV[:<span class="built_in">len</span>(IV)//<span class="number">2</span>]</span><br><span class="line">IV2=IV[<span class="built_in">len</span>(IV)//<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">digest1 = hashlib.sha512(IV1).digest().<span class="built_in">hex</span>()</span><br><span class="line">digest2 = hashlib.sha512(IV2).digest().<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line">digest=digest1+digest2</span><br><span class="line">hint2=(bytes_to_long(IV)&lt;&lt;<span class="number">32</span>)^bytes_to_long(os.urandom(<span class="number">8</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(bytes_to_long((digest.encode()))))</span><br><span class="line"><span class="built_in">print</span>(hint2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mode = DES3.MODE_CBC</span><br><span class="line">des3 = DES3.new(KEY, mode, IV)</span><br><span class="line"></span><br><span class="line">pad_len = <span class="number">8</span> - <span class="built_in">len</span>(flag) % <span class="number">8</span></span><br><span class="line">padding = <span class="built_in">bytes</span>([pad_len]) * pad_len</span><br><span class="line">flag += padding</span><br><span class="line"></span><br><span class="line">cipher = des3.encrypt(flag)</span><br><span class="line"></span><br><span class="line">ciphertext=cipher.<span class="built_in">hex</span>()</span><br><span class="line"><span class="built_in">print</span>(ciphertext)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 334648638865560142973669981316964458403</span></span><br><span class="line"><span class="comment"># 0x62343937373634656339396239663236643437363738396663393438316230353665353733303939613830616662663633326463626431643139323130616333363363326631363235313661656632636265396134336361623833636165373964343533666537663934646239396462323666316236396232303539336438336234393737363465633939623966323664343736373839666339343831623035366535373330393961383061666266363332646362643164313932313061633336336332663136323531366165663263626539613433636162383363616537396434353366653766393464623939646232366631623639623230353933643833</span></span><br><span class="line"><span class="comment"># 22078953819177294945130027344</span></span><br><span class="line"><span class="comment"># a6546bd93bced0a8533a5039545a54d1fee647007df106612ba643ffae850e201e711f6e193f15d2124ab23b250bd6e1</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å‘ç°ï¼Œé¢˜ç›®æœ€ç»ˆç”¨3DESå¯¹flagè¿›è¡Œäº†åŠ å¯†ï¼Œå› æ­¤ç›®æ ‡å°±æ˜¯è¿˜åŸ3DESçš„keyä¸ivå³å¯ã€‚</p>
<p>å…¶ä¸­ï¼Œä¸¤ä¸ªé‡åˆ†åˆ«åˆ†ä¸ºäº†ä»¥ä¸‹å‡ éƒ¨åˆ†ï¼š</p>
<ul>
<li>KEY = K1 + K2 + K3 ,æ¯ä¸ªéƒ¨åˆ†å¤§å°8å­—èŠ‚</li>
<li>IV=ivï¼Œæ¯ä¸ªéƒ¨åˆ†å¤§å°4å­—èŠ‚</li>
</ul>
<p>æŒ‰ç…§å¦‚ä¸‹æ–¹å¼é€æ­¥è¿˜åŸæ¯ä¸ªéƒ¨åˆ†ï¼š</p>
<p><strong>K1</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">K1= key</span><br><span class="line">hint1 = os.urandom(2) * 8</span><br><span class="line">xor =bytes_to_long(hint1)^bytes_to_long(K1)</span><br><span class="line">print(xor)</span><br></pre></td></tr></table></figure>
<p>hint1ä¸º16å­—èŠ‚é‡ï¼Œè€ŒK1ä¸º8å­—èŠ‚é‡ï¼Œå› æ­¤xorçš„é«˜ä½å³ä¸ºhint1çš„é«˜ä½ï¼Œåˆå› ä¸ºhint1ç”±é‡å¤å­—èŠ‚æ„æˆï¼Œhint1é«˜ä½ä¸ä½ä½ç›¸ç­‰ã€‚å¾—åˆ°å®Œæ•´hint1åä¸xorå¼‚æˆ–å³å¾—K1</p>
<p><strong>K2</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">Rand</span>():</span><br><span class="line">    rseed = secrets.randbits(<span class="number">1024</span>)</span><br><span class="line">    List1 = []</span><br><span class="line">    List2 = []</span><br><span class="line">    seed(rseed)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        rand16 = getrandbits(<span class="number">16</span>)</span><br><span class="line">        List1.append(rand16)</span><br><span class="line">    seed(rseed)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">312</span>):</span><br><span class="line">        rand64 = getrandbits(<span class="number">64</span>)</span><br><span class="line">        List2.append(rand64)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;task.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">for</span> rand16 <span class="keyword">in</span> List1:</span><br><span class="line">            file.write(<span class="built_in">hex</span>(rand16)+ <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> rand64 <span class="keyword">in</span> List2:</span><br><span class="line">            file.write(<span class="built_in">hex</span>((rand64 &amp; <span class="number">0xffff</span>) | ((rand64 &gt;&gt; <span class="number">32</span>) &amp; <span class="number">0xffff</span>) &lt;&lt; <span class="number">16</span>) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">Rand()</span><br><span class="line"></span><br><span class="line">K2 = long_to_bytes(getrandbits(<span class="number">64</span>))</span><br></pre></td></tr></table></figure>
<p>è€ƒå¯Ÿçš„æ˜¯MT19937ä¼ªéšæœºæ•°ç”Ÿæˆï¼Œåˆ©ç”¨randcrackæ¨¡å—ï¼Œæäº¤624ä¸ª32bitæ•°ï¼Œå³å¯å¯¹ä¹‹åçš„éšæœºæ•°è¿›è¡Œç²¾å‡†é¢„æµ‹ã€‚è€Œæ³¨æ„åˆ°ç”ŸæˆList1ã€List2ä¹‹é—´é‡æ–°è°ƒæ•´äº†ä¸€æ¬¡éšæœºæ•°ç§å­ï¼Œå› æ­¤List1ã€List2æ˜¯ä½¿ç”¨åŒä¸€éšæœºæ•°ç§å­ç”Ÿæˆçš„ã€‚</p>
<p>è€Œæ³¨æ„åˆ°ï¼ŒList1ä»…æœ‰$624<em>16$bitï¼ŒList2å´æœ‰$324</em>64 = 624*32$bitï¼Œå› æ­¤List2ç”Ÿæˆçš„ä½æ•°æ˜¯è¶³å¤Ÿçš„ï¼Œè€Œæœ€ç»ˆtask.txtæ–‡æœ¬ä¸­å´åªç»™äº†List2çš„éƒ¨åˆ†å­—èŠ‚ï¼Œä¸éœ€è¦æ·±ç©¶åŸç†ä¹Ÿèƒ½æ˜ç™½ï¼šList1ç”Ÿæˆçš„å­—èŠ‚æ°å¥½å°±æ˜¯List2ç”Ÿæˆçš„éšæœºæ•°ä¸­ç¼ºå¤±çš„å­—èŠ‚ã€‚å› æ­¤åªéœ€è¦æ¯ç§è¡¥å……æ–¹å¼å‡å°è¯•ä¸€ä¸‹å³å¯å¾—åˆ°K2ã€‚</p>
<p><strong>K3</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">K3 = flag[:<span class="number">8</span>]</span><br></pre></td></tr></table></figure>
<p>å¾ˆæ˜¾ç„¶ï¼Œå› ä¸ºflagä¸€èˆ¬ä»¥DASCTF{å¼€å¤´ï¼Œå› æ­¤åªéœ€è¦çˆ†ç ´ä¸€ä¸ªå¯è§å­—ç¬¦å³å¯å¾—åˆ°æ­£ç¡®K3ã€‚</p>
<p><strong>IV1åŠIV2</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">IV1=IV[:<span class="built_in">len</span>(IV)//<span class="number">2</span>]</span><br><span class="line">IV2=IV[<span class="built_in">len</span>(IV)//<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">digest1 = hashlib.sha512(IV1).digest().<span class="built_in">hex</span>()</span><br><span class="line">digest2 = hashlib.sha512(IV2).digest().<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line">digest=digest1+digest2</span><br><span class="line">hint2=(bytes_to_long(IV)&lt;&lt;<span class="number">32</span>)^bytes_to_long(os.urandom(<span class="number">8</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(bytes_to_long((digest.encode()))))</span><br><span class="line"><span class="built_in">print</span>(hint2)</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆæ˜ç¡®IVä¸€å…±8ä¸ªå­—èŠ‚ï¼Œå› æ­¤hint2çš„é«˜ä½å³ä¸ºIV1ï¼Œæ­¤æ—¶é¢˜ç›®çš„å‡ ä¸ªå“ˆå¸Œå€¼è²Œä¼¼ç»™äº†ä¸€ä¸ªæš—ç¤ºï¼šçˆ†ç ´æ±‚è§£IV2.å¯æ˜¯éœ€è¦çˆ†ç ´çš„é‡æœ‰4ä¸ªå­—èŠ‚ï¼Œè™½ç„¶ä¸èƒ½è¯´å¾ˆå¤§ï¼Œå´ä¹Ÿéœ€è¦å¾ˆé•¿æ—¶é—´ã€‚æ­¤æ—¶å°±éœ€è¦æ³¨æ„åˆ°ï¼Œdigest=digest1+digest2è¿™ä¸€è¡Œï¼Œå¹¶ä¸æ˜¯æ•°å€¼çš„ç›¸åŠ ï¼Œè€Œæ˜¯å­—ç¬¦ä¸²çš„è¿æ¥ï¼Œè€Œå½“ä½ å°†digestè§£ç åï¼Œä½ ä¼šå‘ç°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">digest1 = digest2</span><br></pre></td></tr></table></figure>
<p>æ²¡é”™ï¼Œå¤ªå¹½é»˜äº†ï¼Œæ‰€ä»¥IV2ä¸IV1ç›¸åŒ(åŸºæœ¬æ— éœ€è€ƒè™‘å“ˆå¸Œç¢°æ’)</p>
<p>æ­¤æ—¶æ‰€æœ‰é‡éƒ½å¾—åˆ°äº†è¿˜åŸï¼Œè§£å¯†3DESå³å¯ï¼š</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3</span><br><span class="line"><span class="keyword">from</span> randcrack <span class="keyword">import</span> RandCrack</span><br><span class="line"></span><br><span class="line">rc = RandCrack()</span><br><span class="line"></span><br><span class="line">cipher = <span class="built_in">int</span>(<span class="string">&quot;a6546bd93bced0a8533a5039545a54d1fee647007df106612ba643ffae850e201e711f6e193f15d2124ab23b250bd6e1&quot;</span>,<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#è·å–iv</span></span><br><span class="line">hint2 = <span class="number">22078953819177294945130027344</span></span><br><span class="line">IV1 = long_to_bytes(hint2 &gt;&gt; <span class="number">64</span>)</span><br><span class="line">IV2 = IV1</span><br><span class="line"></span><br><span class="line"><span class="comment">#è·å–K2</span></span><br><span class="line">list1 = []</span><br><span class="line">list2 = []</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;task.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        list1.append(<span class="built_in">int</span>(f.readline(),<span class="number">16</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">312</span>):</span><br><span class="line">        list2.append(<span class="built_in">int</span>(f.readline(),<span class="number">16</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">312</span>):</span><br><span class="line">    t1 = (list2[i] &amp; <span class="number">0xffff</span>)</span><br><span class="line">    t2 = ((list2[i] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xffff</span>)</span><br><span class="line">    rc.submit( (list1[<span class="number">2</span>*i]&lt;&lt;<span class="number">16</span>) | (list2[i] &amp; <span class="number">0xffff</span>))</span><br><span class="line">    rc.submit( (list1[<span class="number">2</span>*i+<span class="number">1</span>]&lt;&lt;<span class="number">16</span>) | ((list2[i] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xffff</span>))</span><br><span class="line">K2 = long_to_bytes(rc.predict_getrandbits(<span class="number">64</span>),<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#çˆ†ç ´k3</span></span><br><span class="line">xor = <span class="number">334648638865560142973669981316964458403</span></span><br><span class="line">K1 = (xor ^ (xor&gt;&gt;<span class="number">64</span>)) &amp; <span class="number">0xffffffffffffffff</span></span><br><span class="line">K1 = long_to_bytes(K1)</span><br><span class="line"></span><br><span class="line">temp = bytes_to_long(<span class="string">b&quot;DASCTF&#123;&quot;</span>) &lt;&lt; <span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">8</span>):</span><br><span class="line">    K3 = long_to_bytes(temp + j)</span><br><span class="line">    KEY = K1 + K2 + K3</span><br><span class="line">    IV = IV1 + IV2</span><br><span class="line"></span><br><span class="line">    mode = DES3.MODE_CBC</span><br><span class="line">    des3 = DES3.new(KEY, mode, IV)</span><br><span class="line">    flag = <span class="built_in">str</span>(des3.decrypt(long_to_bytes(cipher)))</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">&quot;DASCTF&quot;</span> <span class="keyword">in</span> flag):</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flagï¼š</p>
<font color="red">DASCTF{8e5ee461-f4e1-4af2-8632-c9d62f4dc073}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="esyRSA"><a href="#esyRSA" class="headerlink" title="esyRSA"></a>esyRSA</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¥½åƒè¿™ä¸ªRSAæœ‰ç‚¹æ€ªå•Šï¼ç§é’¥ç»™ä½ äº†ï¼æˆ‘çš„eå‘¢ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> md5 <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> p, q</span><br><span class="line"></span><br><span class="line">e = ?????</span><br><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = invert(e, phi)</span><br><span class="line">ans = gcd(e,phi)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> n, e, d</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;Flag: DASCTF&#123;%s&#125;&quot;</span> %md5(<span class="built_in">str</span>(p + q)).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 8064259277274639864655809758868795854117113170423331934498023294296505063511386001711751916634810056911517464467899780578338013011453082479880809823762824723657495915284790349150975180933698827382368698861967973964030509129133021116919437755292590841218316278732797712538885232908975173746394816520256585937380642592772746398646558097588687958541171131704233319344980232942965050635113860017117519166348100569115174644678997805783380130114530824798808098237628247236574959152847903491509751809336988273823686988619679739640305091291330211169194377552925908412183162787327977125388852329089751737463948165202565859373</span></span><br><span class="line"><span class="string">d = 14218766449983537783699024084862960813708451888387858392014856544340557703876299258990323621963898510226357248200187173211121827541826897886277531706124228848229095880229718049075745233893843373402201077890407507625110061976931591596708901741146750809962128820611844426759462132623616118530705745098783140913</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>æ— åŠ›åæ§½ã€‚ã€‚ã€‚è¿™é¢˜é™„ä»¶é”…äº†ï¼Œnæ˜¯ä¸¤ä¸ªé‡å¤çš„å¤§æ•´æ•°æ‹¼èµ·æ¥çš„ï¼Œå› æ­¤è¦å…ˆå–ä¸€åŠå½“ä½œæ­£ç¡®çš„nã€‚ä¹‹åçš„åšæ³•å°±å¤šäº†ï¼Œdè¿‡å¤§å¯ä»¥è€ƒè™‘wieneræˆ–æ„é€ æ ¼ï¼Œä½†æ˜¯é¢˜ç›®ç»™äº†eä¸ºäº”ä½æ•°çš„æš—ç¤ºï¼Œå› æ­¤ä¹Ÿåªéœ€è¦çˆ†ç ´ä¸€ä¸‹eï¼Œå½“ä½œå·²çŸ¥eã€dåˆ†è§£nå³å¯ã€‚</p>
<p>exp.py:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">n = <span class="string">&quot;8064259277274639864655809758868795854117113170423331934498023294296505063511386001711751916634810056911517464467899780578338013011453082479880809823762824723657495915284790349150975180933698827382368698861967973964030509129133021116919437755292590841218316278732797712538885232908975173746394816520256585937380642592772746398646558097588687958541171131704233319344980232942965050635113860017117519166348100569115174644678997805783380130114530824798808098237628247236574959152847903491509751809336988273823686988619679739640305091291330211169194377552925908412183162787327977125388852329089751737463948165202565859373&quot;</span></span><br><span class="line">n = <span class="number">80642592772746398646558097588687958541171131704233319344980232942965050635113860017117519166348100569115174644678997805783380130114530824798808098237628247236574959152847903491509751809336988273823686988619679739640305091291330211169194377552925908412183162787327977125388852329089751737463948165202565859373</span></span><br><span class="line">d = <span class="number">14218766449983537783699024084862960813708451888387858392014856544340557703876299258990323621963898510226357248200187173211121827541826897886277531706124228848229095880229718049075745233893843373402201077890407507625110061976931591596708901741146750809962128820611844426759462132623616118530705745098783140913</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>,<span class="number">100000</span>):</span><br><span class="line">    t = e*d - <span class="number">1</span></span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> t % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        s += <span class="number">1</span></span><br><span class="line">        t //= <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    found = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, s):</span><br><span class="line">        c1 = <span class="built_in">pow</span>(<span class="number">2</span>, <span class="built_in">pow</span>(<span class="number">2</span>, i-<span class="number">1</span>, n)*t, n)</span><br><span class="line">        c2 = <span class="built_in">pow</span>(<span class="number">2</span>, <span class="built_in">pow</span>(<span class="number">2</span>, i, n)*t, n)</span><br><span class="line">        <span class="keyword">if</span> c1 != <span class="number">1</span> <span class="keyword">and</span> c1 != (-<span class="number">1</span> % n) <span class="keyword">and</span> c2 == <span class="number">1</span>:</span><br><span class="line">            p = GCD(c1 - <span class="number">1</span>, n)</span><br><span class="line">            q = n // p</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;Flag: DASCTF&#123;%s&#125;&quot;</span> %hashlib.md5(<span class="built_in">str</span>(p + q).encode()).hexdigest())</span><br><span class="line">            exit()   </span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flagï¼š</p>
<font color="red">DASCTF{4ae33bea90f030bfddb7ac4d9222ef8f}</font>

<p>(<del>ä¸ºä»€ä¹ˆä¸»åŠæ–¹æ²¡æœ‰å‘ç°é™„ä»¶éœ€è¦æ›´æ–°</del>ï¼Ÿ/(ã„’oã„’)/~~)</p>
<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="MCeorpkpleer"><a href="#MCeorpkpleer" class="headerlink" title="MCeorpkpleer"></a>MCeorpkpleer</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¿™æ•°æ®éƒ½ä¸å…¨è¦æ€ä¹ˆè®¡ç®—å‘¢</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pubkey</span>(<span class="params"><span class="built_in">list</span>, m, w</span>):</span><br><span class="line">    pubkey_list = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e_bin)):</span><br><span class="line">        pubkey_list.append(w * <span class="built_in">list</span>[i] % m)</span><br><span class="line">    <span class="keyword">return</span> pubkey_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">e_cry</span>(<span class="params">e, pubkey</span>):</span><br><span class="line">    pubkey_list = pubkey</span><br><span class="line">    encode = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e)):</span><br><span class="line">        encode += pubkey_list[i] * <span class="built_in">int</span>(e[i]) % m</span><br><span class="line">    <span class="keyword">return</span> encode</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = getPrime(<span class="number">64</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line">e_bin = (<span class="built_in">bin</span>(e))[<span class="number">2</span>:]</span><br><span class="line"><span class="built_in">list</span> = [<span class="built_in">pow</span>(<span class="number">3</span>, i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e_bin))]</span><br><span class="line">m = getPrime(<span class="built_in">len</span>(<span class="built_in">bin</span>(<span class="built_in">sum</span>(<span class="built_in">list</span>))) - <span class="number">1</span>)</span><br><span class="line">w = getPrime(<span class="number">64</span>)</span><br><span class="line">pubkey = pubkey(<span class="built_in">list</span>, m, w)</span><br><span class="line">en_e = e_cry(e_bin, pubkey)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p = &#123;&#125;\n&#x27;</span></span><br><span class="line">      <span class="string">&#x27;n = &#123;&#125;\n&#x27;</span></span><br><span class="line">      <span class="string">&#x27;c = &#123;&#125;\n&#x27;</span></span><br><span class="line">      <span class="string">&#x27;pubkey = &#123;&#125;\n&#x27;</span></span><br><span class="line">      <span class="string">&#x27;en_e = &#123;&#125;&#x27;</span>.<span class="built_in">format</span>((p &gt;&gt; <span class="number">435</span>) &lt;&lt; <span class="number">435</span>, n, c, pubkey, en_e))</span><br></pre></td></tr></table></figure>
<p>è§‚å¯Ÿé¢˜ç›®ï¼Œe_cryç”¨äºèƒŒåŒ…åŠ å¯†çš„å°±æ˜¯eçš„äºŒè¿›åˆ¶ä¸²æœ¬èº«ï¼Œå› æ­¤ç›´æ¥æ ¼åŸºè§„çº¦å‡ºeï¼Œå†ç”¨coppersmithè§£å·²çŸ¥pé«˜ä½é—®é¢˜å³å¯ã€‚</p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#step1 å·²çŸ¥pé«˜ä½ï¼Œæ¢å¤pã€q</span></span><br><span class="line">p4 = <span class="number">139540788452365306201344680691061363403552933527922544113532931871057569249632300961012384092481349965600565669315386312075890938848151802133991344036696488204791984307057923179655351110456639347861739783538289295071556484465877192913103980697449775104351723521120185802327587352171892429135110880845830815744</span></span><br><span class="line">n = <span class="number">22687275367292715121023165106670108853938361902298846206862771935407158965874027802803638281495587478289987884478175402963651345721058971675312390474130344896656045501040131613951749912121302307319667377206302623735461295814304029815569792081676250351680394603150988291840152045153821466137945680377288968814340125983972875343193067740301088120701811835603840224481300390881804176310419837493233326574694092344562954466888826931087463507145512465506577802975542167456635224555763956520133324723112741833090389521889638959417580386320644108693480886579608925996338215190459826993010122431767343984393826487197759618771</span></span><br><span class="line">pbits = <span class="number">1024</span></span><br><span class="line">kbits= <span class="number">435</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x + p4</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^kbits,beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="keyword">if</span> roots:</span><br><span class="line">    p= p4 + <span class="built_in">int</span>(roots[<span class="number">0</span>])</span><br><span class="line">    q = n//p</span><br><span class="line"></span><br><span class="line"><span class="comment">#step2 æ ¼åŸºè§„çº¦æ¢å¤e</span></span><br><span class="line">b = [<span class="number">18143710780782459577</span>, <span class="number">54431132342347378731</span>, <span class="number">163293397027042136193</span>, <span class="number">489880191081126408579</span>, <span class="number">1469640573243379225737</span>, <span class="number">4408921719730137677211</span>, <span class="number">13226765159190413031633</span>, <span class="number">39680295477571239094899</span>, <span class="number">119040886432713717284697</span>, <span class="number">357122659298141151854091</span>, <span class="number">1071367977894423455562273</span>, <span class="number">3214103933683270366686819</span>, <span class="number">9642311801049811100060457</span>, <span class="number">28926935403149433300181371</span>, <span class="number">86780806209448299900544113</span>, <span class="number">260342418628344899701632339</span>, <span class="number">781027255885034699104897017</span>, <span class="number">2343081767655104097314691051</span>, <span class="number">7029245302965312291944073153</span>, <span class="number">21087735908895936875832219459</span>, <span class="number">63263207726687810627496658377</span>, <span class="number">189789623180063431882489975131</span>, <span class="number">569368869540190295647469925393</span>, <span class="number">1708106608620570886942409776179</span>, <span class="number">601827224419797931380408071500</span>, <span class="number">1805481673259393794141224214500</span>, <span class="number">893952418336266652976851386463</span>, <span class="number">2681857255008799958930554159389</span>, <span class="number">3523079163584485147344841221130</span>, <span class="number">1524252287869625983140881149316</span>, <span class="number">50264262166963219975822190911</span>, <span class="number">150792786500889659927466572733</span>, <span class="number">452378359502668979782399718199</span>, <span class="number">1357135078508006939347199154597</span>, <span class="number">4071405235524020818041597463791</span>, <span class="number">3169230503688232995231149877299</span>, <span class="number">462706308180869526799807117823</span>, <span class="number">1388118924542608580399421353469</span>, <span class="number">4164356773627825741198264060407</span>, <span class="number">3448085117999647764701149667147</span>, <span class="number">1299270151115113835209806487367</span>, <span class="number">3897810453345341505629419462101</span>, <span class="number">2648446157152195057994615872229</span>, <span class="number">3422845870014670444537026359650</span>, <span class="number">1223552407160181874717436564876</span>, <span class="number">3670657221480545624152309694628</span>, <span class="number">1966986461557807413563286569810</span>, <span class="number">1378466783231507511243038452393</span>, <span class="number">4135400349694522533729115357179</span>, <span class="number">3361215846199738142293703557463</span>, <span class="number">1038662335715384967987468158315</span>, <span class="number">3115987007146154903962404474945</span>, <span class="number">302975818554635252993570910761</span>, <span class="number">908927455663905758980712732283</span>, <span class="number">2726782366991717276942138196849</span>, <span class="number">3657854499533237101379593333510</span>, <span class="number">1928578295715881845245137486456</span>, <span class="number">1263242285705730806288591202331</span>, <span class="number">3789726857117192418865773606993</span>, <span class="number">2324195368467747797703678306905</span>, <span class="number">2450093503961328663664213663678</span>, <span class="number">2827787910442071261545819733997</span>, <span class="number">3960871129884299055190637944954</span>, <span class="number">2837628186769067706678271320788</span>]</span><br><span class="line">c = <span class="number">31087054322877663244023458448558</span></span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(b)</span><br><span class="line">L = Matrix(ZZ, n+<span class="number">1</span>, n+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    L[i,i] = <span class="number">1</span></span><br><span class="line">    L[i,-<span class="number">1</span>] = b[i]</span><br><span class="line">L[-<span class="number">1</span>,-<span class="number">1</span>] = -c</span><br><span class="line"></span><br><span class="line">res = L.LLL()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n + <span class="number">1</span>):</span><br><span class="line">    M = res.row(i).<span class="built_in">list</span>()</span><br><span class="line">    flag = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> M:</span><br><span class="line">        <span class="keyword">if</span> m != <span class="number">0</span> <span class="keyword">and</span> m != <span class="number">1</span>:</span><br><span class="line">            flag = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> flag:</span><br><span class="line">        e = M</span><br><span class="line"></span><br><span class="line"><span class="comment">#step3 RSA</span></span><br><span class="line">c = <span class="number">156879727064293983713540449709354153986555741467040286464656817265584766312996642691830194777204718013294370729900795379967954637233360644687807499775502507899321601376211142933572536311131955278039722631021587570212889988642265055045777870448827343999745781892044969377246509539272350727171791700388478710290244365826497917791913803035343900620641430005143841479362493138179077146820182826098057144121231954895739989984846588790277051812053349488382941698352320246217038444944941841831556417341663611407424355426767987304941762716818718024107781873815837487744195004393262412593608463400216124753724777502286239464</span></span><br><span class="line">n = p*q</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e)):</span><br><span class="line">    e[i] = <span class="built_in">str</span>(e[i])</span><br><span class="line">e = <span class="string">&quot;&quot;</span>.join(e)[:-<span class="number">1</span>]</span><br><span class="line">e = <span class="built_in">int</span>(e,<span class="number">2</span>)</span><br><span class="line">d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n))))</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flagï¼š</p>
<font color="red">DASCTF{T81I_tPPS_6r7g_xlPi_OO3M_6vyV_Rkba}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="XORè´¯ç©¿å§‹ç»ˆ"><a href="#XORè´¯ç©¿å§‹ç»ˆ" class="headerlink" title="XORè´¯ç©¿å§‹ç»ˆ"></a>XORè´¯ç©¿å§‹ç»ˆ</h2><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä¸€åˆ‡éƒ½æ˜¯æœ‰æ„ä¹‰çš„ï¼Œæ‹¿ä¸‹å®ƒå§ã€‚</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<p>message.txtï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è‡ªç”±å’Œè°å’Œè°å¯Œå¼ºå…¬æ­£å‹å–„çˆ±å›½å…¬æ­£æ³•æ²»æ³•æ²»æ–‡æ˜å’Œè°è‡ªç”±æ³•æ²»è‡ªç”±æ³•æ²»å¹³ç­‰å…¬æ­£å‹å–„å…¬æ­£å…¬æ­£æ°‘ä¸»æ³•æ²»è‡ªç”±å…¬æ­£æ•¬ä¸šå’Œè°å¯Œå¼ºå…¬æ­£å‹å–„çˆ±å›½å’Œè°å¹³ç­‰å¹³ç­‰å‹å–„æ•¬ä¸šæ³•æ²»æ•¬ä¸šå’Œè°å¯Œå¼ºæ³•æ²»å¹³ç­‰å¹³ç­‰å‹å–„æ•¬ä¸šå…¬æ­£å…¬æ­£å…¬æ­£å‹å–„æ•¬ä¸šæ³•æ²»å¹³ç­‰å¹³ç­‰è¯šä¿¡è‡ªç”±å…¬æ­£è‡ªç”±å¹³ç­‰å‹å–„æ•¬ä¸šå…¬æ­£å‹å–„æ³•æ²»å’Œè°å’Œè°</span><br></pre></td></tr></table></figure>
<p>task.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> enflag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = q * p</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">e = getPrime(<span class="number">17</span>)</span><br><span class="line"><span class="keyword">assert</span> gcd(e, phi) == <span class="number">1</span></span><br><span class="line"><span class="comment"># ä»¥ä¸Šä¿¡æ¯ç”Ÿæˆäº†ç§é’¥æ–‡ä»¶,ä½†æ–‡ä»¶è¢«æŸåäº†ä½ èƒ½æå–æœ‰ç”¨ä¿¡æ¯å—</span></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(enflag, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c = &#x27;</span> + <span class="built_in">str</span>(c))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 91817924748361493215143897386603397612753451291462468066632608541316135642691873237492166541761504834463859351830616117238028454453831120079998631107520871612398404926417683282285787231775479511469825932022611941912754602165499500350038397852503264709127650106856760043956604644700201911063515109074933378818</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>pri.pemï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-----BEGIN PRIVATE KEY-----</span><br><span class="line">MIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBALmtMy+2uH1ZtbIL</span><br><span class="line">SuiAukFthyQRH5mp7UmLyzZQkdg9zEP9/5tgffikQ7ytx5kHySHnazgAO1sOzmYE</span><br><span class="line">N4Axlev6uafiP8B1Eij97v5VkYJ1I9e3mtBNheTbXKoT8op+ASQ1fQaF4A8UzLuW</span><br><span class="line">eZeZI8JTH/SH+bolAK3kiZXDFdkTAgMBAAECgYEAl067LaC7Cvs2A5cMPhfYsESv</span><br><span class="line">IgcKN1CwW4Sd3u8dSphhgu7TgyzIuvwxbuo2g1BC6WwKhaI6vGN+csfw6nh98GEn</span><br><span class="line">/p3D0huNroAYvf/DRRB9UnHdttX7wB+Mv3P0RBDWHgBiCDVvHFuFUV78cIs0tnbn</span><br><span class="line">jxjU07aPV2XRC3AfA2ECQQDqWUNPVg3i6vTyHCL7EGkbeUheYpAAfcKCQrxjc5+5</span><br><span class="line">X6A+XtgHAA1JHwykPlCpHUOmlA85DJF1ejuoImzlgRLJAkEAytTCnQF+MN2r1gaA</span><br><span class="line">UETZyj5qMYT7Th8zKEVVVJjDawLnuX4usJ2FyRnjCkk86U75QSJhw5mMc0QnG25u</span><br><span class="line">Gz3++w==</span><br><span class="line">-----END PRIVATE KEY-----</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€å±‚ï¼Œè§£å¼€ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚ç¼–ç å¾—åˆ°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">C0ngr4tulati0n5_y0u_fou^d_m3</span><br></pre></td></tr></table></figure>
<p>ç¬¬äºŒå±‚ï¼Œæ¢å¤ç ´æŸRSAç§é’¥æ–‡ä»¶ï¼Œbase64è§£ç åå¾—åˆ°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">b&#x27;30820277020100300d06092a864886f70d0101010500048202613082025d02010002818100b9ad332fb6b87d59b5b20b4ae880ba416d8724111f99a9ed498bcb365091d83dcc43fdff9b607df8a443bcadc79907c921e76b38003b5b0ece660437803195ebfab9a7e23fc0751228fdeefe5591827523d7b79ad04d85e4db5caa13f28a7e0124357d0685e00f14ccbb9679979923c2531ff487f9ba2500ade48995c315d913020301000102818100974ebb2da0bb0afb3603970c3e17d8b044af22070a3750b05b849ddeef1d4a986182eed3832cc8bafc316eea36835042e96c0a85a23abc637e72c7f0ea787df06127fe9dc3d21b8dae8018bdffc345107d5271ddb6d5fbc01f8cbf73f44410d61e006208356f1c5b85515efc708b34b676e78f18d4d3b68f5765d10b701f0361024100ea59434f560de2eaf4f21c22fb10691b79485e6290007dc28242bc63739fb95fa03e5ed807000d491f0ca43e50a91d43a6940f390c91757a3ba8226ce58112c9024100cad4c29d017e30ddabd606805044d9ca3e6a3184fb4e1f332845555498c36b02e7b97e2eb09d85c919e30a493ce94ef9412261c3998c7344271b6e6e1b3dfefb&#x27;</span><br></pre></td></tr></table></figure>
<p>æŒ‰ç…§RSAç§é’¥æ ¼å¼è¿˜åŸï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">n 028181 00b9ad332fb6b87d59b5b20b4ae880ba416d8724111f99a9ed498bcb365091d83dcc43fdff9b607df8a443bcadc79907c921e76b38003b5b0ece660437803195ebfab9a7e23fc0751228fdeefe5591827523d7b79ad04d85e4db5caa13f28a7e0124357d0685e00f14ccbb9679979923c2531ff487f9ba2500ade48995c315d913</span><br><span class="line">e 0203 010001</span><br><span class="line">d 028181 00974ebb2da0bb0afb3603970c3e17d8b044af22070a3750b05b849ddeef1d4a986182eed3832cc8bafc316eea36835042e96c0a85a23abc637e72c7f0ea787df06127fe9dc3d21b8dae8018bdffc345107d5271ddb6d5fbc01f8cbf73f44410d61e006208356f1c5b85515efc708b34b676e78f18d4d3b68f5765d10b701f0361</span><br><span class="line">p 0241 00ea59434f560de2eaf4f21c22fb10691b79485e6290007dc28242bc63739fb95fa03e5ed807000d491f0ca43e50a91d43a6940f390c91757a3ba8226ce58112c9</span><br><span class="line">q 0241 00cad4c29d017e30ddabd606805044d9ca3e6a3184fb4e1f332845555498c36b02e7b97e2eb09d85c919e30a493ce94ef9412261c3998c7344271b6e6e1b3dfefb&quot;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œç§é’¥ä¸­çš„dpã€dqä»¥åŠinv(q,p)æŸåäº†ï¼Œä½†æ˜¯å‰©ä¸‹çš„å€¼å·²ç»è¶³å¤Ÿç”¨äºRSAè§£å¯†ï¼Œå› æ­¤æ­£å¸¸è§£å¯†å³å¯å¾—åˆ°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DASCTF&#123;0e287wQ\x08R\x17\x00FGXYFZ\x07V\x03kIUCn\x02VDg\x01f\x0cN</span><br></pre></td></tr></table></figure>
<p>å‘ç°é¢˜ç›®æè¿°XORè¿˜æ²¡ç”¨ä¸Šï¼Œå°†ç¬¬ä¸€æ­¥ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚è§£å¯†å¾—åˆ°çš„ä¸²ç”¨äºå¼‚æˆ–å³å¯ã€‚</p>
<p>å¾—åˆ°flagï¼š</p>
<font color="red">DASCTF{0e2874af5e422482378640e61d919e9a}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ€»ä½“éš¾åº¦ç¡®å®ä¸å¤§ï¼Œä½†æ˜¯æ€ä¹ˆè¯´å‘¢ï¼Œé¢˜ç›®æœ‰ç‚¹å‘ï¼Œè‡ªå·±èƒ½åŠ›ä¹Ÿè¿˜å­˜åœ¨ä¸è¶³ï¼Œä¸‹æ¬¡åŠ æ²¹å§ã€‚</p>
]]></content>
      <categories>
        <category>wp-crypto</category>
      </categories>
  </entry>
  <entry>
    <title>Cryptoè¶£é¢˜-Lattice</title>
    <url>/post/9b40da15.html</url>
    <content><![CDATA[<p>è¯¥æ–‡ç« ä¸»è¦è®°å½•ä¸€äº›æ ¼ç›¸å…³çš„è¶£é¢˜</p>
<span id="more"></span>
<h3 id="è½¬åŒ–AGCD"><a href="#è½¬åŒ–AGCD" class="headerlink" title="è½¬åŒ–AGCD"></a>è½¬åŒ–AGCD</h3><p>é¢˜ç›®æ¥æºï¼šæš‚ä¸æ˜ç¡®</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">nbits = <span class="number">512</span></span><br><span class="line">delta = <span class="number">.93</span></span><br><span class="line">kbits = <span class="built_in">int</span>(nbits*delta) &gt;&gt; <span class="number">1</span></span><br><span class="line">bound = <span class="number">2</span>**kbits</span><br><span class="line"></span><br><span class="line">m = <span class="number">53</span></span><br><span class="line">p = getPrime(nbits)</span><br><span class="line">x = randint(<span class="number">2</span>, p - <span class="number">1</span>)</span><br><span class="line">a = [randint(<span class="number">2</span>, bound) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m)]</span><br><span class="line">b = [inverse(a[i] * x + randint(<span class="number">2</span>, bound), p) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m)]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;a = &#125;</span>\n<span class="subst">&#123;b = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n = p * getPrime(nbits)</span><br><span class="line">c = <span class="built_in">pow</span>(bytes_to_long(flag), e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;e = &#125;</span>\n<span class="subst">&#123;n = &#125;</span>\n<span class="subst">&#123;c = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">a = [226623173423524660762660587272926713775967113908071780918074044654746571, 99264763681859867816401881797921542580399607408617989905539839585323915, 177386736426181055874933306917112626356703658087900095566603898769091471, 5081587307910189127020749833744000992860852972311811125838243285877024, 411574110749659943703486080205654180795533263258790540505729307655142415, 1932137082695732276757073197845160804183868657578020568122170798605640, 103124563846054461729937757543103647655652920105466714505493351091607258, 65504504807895104765113845019342631211794998326986693051403166347389343, 151981136459515488882551190881724794060443302721456924436833810784219984, 3718222682937746804225225548712093487815785751144078132168082568580360, 113510621144631490440930342566441462111997352193075435129065142534001691, 120974784665251812036673794948678799274628176126865320042025545119228958, 193781634902416477262894357163294897773986019836290716577623654684669134, 24723078645443091017196603549741156206848230267873373213787667300835247, 113165730428784680251415263617027036564335843097634063978942541861726366, 407969345567975756778713582637075079783087682011802438819519567067241979, 151997755976755754648644424339697978791639952976423703068460739754839735, 253811682402531882908516509348937060650658679039884817907013090700281326, 404019046883201096048575369492824679211148242588135515488831100750933, 216725815105749574244056185735609680710954976727370948136589694286539150, 131605791470353972911656132280131756304373156215254629027113994962767833, 180190835657942894146705472335255090682179032409197893415067330574923084, 280086867488286721744184104208965143004904898002959657537412170401510680, 141039650035922882497777354937772530276454847300329950111476878397654053, 319858542602843767926919031049756704694256249776295683733693049522108872, 135633729043152514436339515687850041275739968837263316059461122379487161, 5038078437655552457504448170918674775639811066221990939957937239270167, 31918623105281221407484700216805581554894830335850729735403857505547002, 424092292941284354705774693468403308534554297314522980647422106907791591, 300635399575681097924575337707842439619576566621368558814406755486658723, 323686536134235835297820679361020300261642147835330856978902402517820801, 392620731408972775834827063986182511057173023783228673505487358356342114, 108681888409433100038410892044516773350200560613740266422720530715166828, 182338238967593331173372924666322484559869636981878410128856193538847678, 242630103099393630296862580986126439159331512930513337684897019399319621, 439737851682655515589311041364295341910822514202794661846391952824593066, 84115222835816390632388766236883091861894245716624041418721833768917547, 83926810016448863267608537461154878096011055852547156452557576634691363, 354588657997053098464002945990025178880458974438409486331146607111950617, 170413334241108032297843362994773587930354677207616527135896108692092457, 283185550452196010949673962093382632839937948488235076418296451706429923, 390000015988537819093964185756696910433784324036454283227484980367608884, 121370082693927496814267201484843687844578996855559797026014779421645731, 357164702199289826402900456464935203585119719343409406742172822868770420, 124276883926433089715798954125363260298740714164810098876501303684201565, 122912426324401068572433533096099229494021528981601203447594706478943744, 287527827124819650763642012585104162743364640051014410357971387706781531, 135819408760576908301747047938951002691288880199213610653148681326046091, 239644892459756283997004399339163555215985564639569406081575642996080481, 241513055132921096791997556818670497379598444881679976542299970876463098, 144152466563589166040797814966860917437020789050031353309848917297959088, 120162009732086541189519736083838746833770360960800721525565383293404918, 121547756201941339094205049920057111793191461762212554355070565584802804]</span></span><br><span class="line"><span class="string">b = [6914108949558554967947157128371931777410399406424987472871265954007536210016000226325059466226417032321637768264366355381358552354005990800271210820573485, 4243350947524503250221141283676871054961767761533372535893799777316644277502608136805589201625364130457811586620275507258712882614289496389903620348266876, 7207723049065039433195103268720351560639394404931218738588797743896531445162073256971205066381805731964498662913612257697112297701515506572915529630749649, 9478867353430476119494189313998177997736272254097122188128236485373498544996365281925749885278741955783336542038044934310609039388320259421902808190444639, 10092751897940937230080778690510245631681516769761757712615337492357689455504789850857408988921202275660819814611602363226676960504340172006698418415173603, 5925826079655586275072881965974452367893696237983922405515651101142466142890347074549417916208251973477786424292583294611467079137685936757690986611634840, 2705681917429356111941316419951220642197423059675588735077708172236184161647753066851383893342803615318493417826483637576437939588768131347824859258545037, 5793481213766970753853702438948943122939283534830229656699291673833482520096412620329053619097899786691202045974184168665694248732396928571682405270896258, 3212965229314647637209688663583343281038324880827825190075824389072703574155472958687615046177029380089781167897141334668918512246004114927754397070032450, 507858897452123392345795058512546587866098555419275815786154069852495346820264502978622507708545904809967228104858456493411165322256241259977367791849042, 1910673108437857460691507244808588742883010826641687685721219894695257479961884688001651060796296482279750896861871054549713247272267814842634417960819168, 2886899741243848325873884252302617091514751717162909139186588257257958079130295099942906361136727891394692438504521454612873780003451672796809495226053047, 9475112027697464127079619380873273645977046666164164866182205134451664768516062572467782141714310693479352016031210905832129007401065693258638549100340615, 6500556077535313473248384729914564751019267303740919343852356539545383313100771434642240039386190890442297569489225045989569513367190888305128046797790102, 4352575880916080525863863641402979108455803235156616467981920947190189719209876636528864672410548581564537392488508689158499605332674737341258230577454475, 8855806560115120193748486720541724804359134126331550182497194629659837334220708039976726151383523965042432921330088347099157101222325916589506823343303429, 2774687136241363374520941544838376461935832170671324174983217598018541119488143069001573950404074015672792681188308412236177101695870429933915439814455887, 3592625154014227818614640279472091377202566130067513443394635609406915223429475106920133466069573358784994632708606215548054720669924050172507230811524716, 6955167231829680836198358545532458408492109230130585460528670650387346748536700767474985024643177587060440925065292948599577822789464670224006606550191671, 9194240450171813716718107852597217121362901491312541712415368806074976814988492806542250961496723482200369134039024809109124268301878344007510329535899615, 5950577443108124534632225089717156798651285826327691188035165834526053749015025923590404663092184546183617748745220821771671541995250149683517797527521402, 8147536282406177354958293970877926560729452459282692121940762677425779306283487924160782780299072205173184092679363257393333408904258459452274140791704067, 2559838851622656651952688025212080768394118716136473174419624432065878751831257138924556995347285973152404103332115858073203707432778426111325160735797721, 4949359541993387232537947394033362386729434824378846379892748514319807403496542405321037377319385099259508143211518009425440208974571177165892037150309091, 1811673815510905036234500180939767229691774807773077679609856974935852997557959138952513786288094951891092390620085630282790435640054840555430191851155313, 4777885082419038381870076531532991228660498200204585112220314790970263737966241042846160101892845251352987027168075888559622541458466624868511496707956221, 10238413710887745087366241938666680877364662925315040665408262063559110391570620624035047723405526398382375337996702653261521046541231508963525281969167278, 3473340971529025694371400010471019993671985537666177271712164477185774211271764180735799413043127038518985595844132844447764288680922052782557764949946998, 867350328105510555601266520733196439839458877892746826352327206388533426010006967907349245075237097927904721917883721235095421696529792601733014134854086, 2222551217354471458254572360148123193413834831993026644829243162796014361851880328878269533732240093458365703558737637137958860294765246560791514120259973, 11135205396103944017696365595462393888434601100415179875833418713405171505514194213145570969708606144837327906949671055964664374675657263466390592843391795, 8522093767526974938129274822063573020978729589640216089964237075835492415426711219243729120235033613444547687888110911207624759350428715822663409802746531, 618066223420558653541360712487038985426207412776033652080372792996567809564864490136174039188920973110051946250308952735815050129654446357610891600358247, 9409683398358516350960966400164689353665188916574105692687503875332913200043983566205433723664581043184720605266180639045542588369320481456882129188045630, 10444912184036485133367095187175276878779180732948191228469107836744786278456394810069942330852023901190983084405589604802372025661121698806608507168815980, 5576808818750933483753823503921696491223987341840901931564632327098735945058071342467846031030536056935288275893098409520502499556978787294107531192342888, 11386170831130547392066338523237385342399839863674855226178213470159061980868639851406716227763244070078162813390834461297132500087558187715637626334931068, 9266567474732845229716988973436914937598698459994255583719094874193822181675544832905800318876640152861212158602258489908050910803591150200525814954449464, 783592057196685768383414375510915255040313296240508052297125547577301394194342174502254618660494179262947294784116190346971775913769035176336764690986707, 9105502180406569116340185218615179260760299848734930041602247299415927012355894700609320722623370139135122342263713846033304524885782445949914570572453737, 2297513067567074587355421795953863750627166311403426281361312466297059134183355298180726594771668216966732975569375780641995446201527865824229865021970151, 11188600115372846854366137972585164923834717935898376598627276542371780275188751807941476083838808640337088079259756154889298297211898790479562768420072518, 9656534484640562909118084019762167873291009773232637365213178341424207965285682074941363264934464618450896824843786922345950140473512635227211478685645772, 9343461413426168572561103655466265435717795505657355206522619014228487030194629865342342831380623629471381377128476731390629039248389925891691539701146309, 8681682631345831952913045584970984843073645909076987924890403622460027832467542651987623584349089629585531159664847835287269602153108548311564650707486153, 2656022193773767486949157049738671449721427276944394094199310567891807831351152318018854466905531462256724938253289337125816757790150607033652302227218868, 8508384570273623974802293014504152838556567399448174508834295467479347400327605230626491770497722014885725768213847610504091563629074470937893415637338996, 9716708016762837073052660164394053927821481998442639097920157163041635386583167412600530638659299593644342722890385260143682043966383262553995449944733956, 10231440381205182517403356785692369093270060843919065205063057623835967990844569366866607452179015606536153761832574542432676397053147658371344410148994418, 5146017765041682548648007957706007143803297597587388958721578537741505373387718545092695689770641249769257901519197825087801304735466239843061128683798476, 5222787643951107881679620487297380490422971146509273142662864657570322385794688143091615970726544447887548792995773377472568754141261595697499826832283200, 10464709627510729920064247596403868144579001206027850090117534773353171042729174225448975480540265139445689560336303762183734720331072177316589830221880977, 8615548684371129329547908465444932886632829509038689025840147771114904826804441395348568994340729561487767929565347408386252378372026787346043297419998538]</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">n = 97853623351997296064353255135588846396569970130207954701198599507389250544514082114957455795330569730103385876268186267851194017938003005329258612122178955978821786063623918361705120943030241043571056282806763102278839262572943852578441568495106906583558313075633340995336324665255745279078992160547871869557</span></span><br><span class="line"><span class="string">c = 44431449479567561261917922338101462065458737366369232901780150553091038211618354850829522817943842817713545313017593484450672219262670055539455602698182643653128488160901383204333856589371756831501857423631322915113418699087489759910739942878900174507138454184974875778861767989603951090385047953725189919178</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>è§‚å¯Ÿé¢˜ç›®ï¼Œé¢˜ç›®ç»™äº†å¦‚ä¸‹å½¢å¼çš„53ç»„ç­‰å¼ï¼š</p>
<script type="math/tex; mode=display">
b_i = (a_i*x + r_i)^{-1} \quad(mod\;p)</script><p>å…¶ä¸­ï¼Œå„ä¸ªå€¼çš„å·²çŸ¥ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>x ä¸º (2ï¼Œp - 1) ä¹‹é—´çš„éšæœºæ•°ï¼Œå¹¶ä¸”åœ¨53ç»„ç­‰å¼ä¸­ä¿æŒä¸å˜</li>
<li>aã€r ä¸º (2ï¼Œ2**238) ä¹‹é—´çš„éšæœºæ•°</li>
<li>ç»™å‡º a ã€b</li>
</ul>
<p>é¦–å…ˆï¼Œæœ‰ä¸¤ç‚¹ä¿¡æ¯æš—ç¤ºè¦ç”¨æ ¼ï¼š</p>
<p>1ã€aã€r é™åˆ¶äº†æ•°æ®èŒƒå›´ï¼Œå¯ä»¥çœ‹ä½œæ˜¯å°é‡ï¼Œæš—ç¤ºç”¨LLL</p>
<p>2ã€å¤šç»„çº¿æ€§ç­‰å¼ï¼Œæš—ç¤ºç”¨çŸ©é˜µ</p>
<p><br></p>
<p>æ‰€ä»¥å…³é”®å°±æ˜¯è½¬åŒ–åˆ°ä¸€ä¸ªå¯ä»¥è¿ç”¨æ ¼çš„é—®é¢˜å½¢å¼ï¼Œæ¨å¯¼å¦‚ä¸‹ï¼š</p>
<p>é¦–å…ˆè¦æƒ³æ˜ç™½ä¸‹é¢çš„å¼å­ï¼š(æ¨å¯¼æ¯”è¾ƒå®¹æ˜“ï¼Œå°±ä¸è®²äº†)</p>
<script type="math/tex; mode=display">
inverse(b,n) = inverse(b,p)\quad(mod\;p)</script><p>ç„¶åå°±å¯ä»¥å°†é—®é¢˜æŒ‰ä¸‹é¢çš„æ–¹å¼é€æ­¥è½¬åŒ–ï¼š</p>
<p>1ã€<strong>å°†bé€†å…ƒè½¬åŒ–åˆ°æ¨¡n</strong></p>
<script type="math/tex; mode=display">
(a_0*x + r_0) = inverse(b_0,p) \quad(mod\;p)</script><p>â€‹        ä»£å…¥ä¸Šé¢çš„å¼å­ï¼Œå˜æˆï¼š</p>
<script type="math/tex; mode=display">
(a_0*x + r_0) = inverse(b_0,n) \quad(mod\;p)</script><p>â€‹        åŒç†ï¼š</p>
<script type="math/tex; mode=display">
(a_1*x + r_1) = inverse(b_1,n) \quad(mod\;p)</script><p>2ã€<strong>è”ç«‹æ¶ˆå…ƒ</strong></p>
<script type="math/tex; mode=display">
a_1*(a_0*x + r_0) = a_1*inverse(b_0,n) \quad(mod\;p)</script><script type="math/tex; mode=display">
a_0*(a_1*x + r_1) = a_0*inverse(b_1,n) \quad(mod\;p)</script><p>â€‹        ç›¸å‡å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
a_1*r_0 + a_0*r_1 = a_1*inverse(b_0,n) - a_0*inverse(b_1,n)\quad(mod\;p)</script><p>â€‹        æœ‰æ²¡æœ‰å‘ç°ï¼Œå°é‡å·²ç»å…¨éƒ¨ç§»åˆ°äº†ç­‰å¼åŒä¸€è¾¹</p>
<p>3ã€<strong>è½¬åŒ–ä¸ºAGCDé—®é¢˜</strong></p>
<p>å°†æ¨¡ç­‰å¼åˆ©ç”¨åŒä½™å®šç†å±•å¼€ï¼š</p>
<script type="math/tex; mode=display">
a_1*inverse(b_0,n) - a_0*inverse(b_1,n) = k*p + a_1*r_0 + a_0*r_1</script><p>â€‹        æ­¤æ—¶ï¼Œé—®é¢˜å·²ç»å˜æˆäº†AGCDé—®é¢˜ï¼Œè¿™æ˜¯å› ä¸ºï¼š</p>
<p>â€‹        AGCDé—®é¢˜é€šå¸¸å½¢å¼ï¼š</p>
<script type="math/tex; mode=display">
X = q*p + r</script><p>â€‹        åœ¨æœ¬é¢˜ä¸­ï¼Œå„ä¸ªé‡å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
X = a_1*inverse(b_0,n) - a_0*inverse(b_1,n)</script><script type="math/tex; mode=display">
q = k,\quad
p = p,\quad
r = a_1*r_0 + a_0*r_1</script><p>è‡³æ­¤é—®é¢˜æ¨å¯¼å°±ç»“æŸäº†ã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">P_bits = <span class="number">512</span></span><br><span class="line">Q_bits = <span class="number">238</span>+<span class="number">1024</span>-<span class="number">512</span></span><br><span class="line">R_bits = <span class="number">238</span>+<span class="number">238</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">a = [<span class="number">226623173423524660762660587272926713775967113908071780918074044654746571</span>, <span class="number">99264763681859867816401881797921542580399607408617989905539839585323915</span>, <span class="number">177386736426181055874933306917112626356703658087900095566603898769091471</span>, <span class="number">5081587307910189127020749833744000992860852972311811125838243285877024</span>, <span class="number">411574110749659943703486080205654180795533263258790540505729307655142415</span>, <span class="number">1932137082695732276757073197845160804183868657578020568122170798605640</span>, <span class="number">103124563846054461729937757543103647655652920105466714505493351091607258</span>, <span class="number">65504504807895104765113845019342631211794998326986693051403166347389343</span>, <span class="number">151981136459515488882551190881724794060443302721456924436833810784219984</span>, <span class="number">3718222682937746804225225548712093487815785751144078132168082568580360</span>, <span class="number">113510621144631490440930342566441462111997352193075435129065142534001691</span>, <span class="number">120974784665251812036673794948678799274628176126865320042025545119228958</span>, <span class="number">193781634902416477262894357163294897773986019836290716577623654684669134</span>, <span class="number">24723078645443091017196603549741156206848230267873373213787667300835247</span>, <span class="number">113165730428784680251415263617027036564335843097634063978942541861726366</span>, <span class="number">407969345567975756778713582637075079783087682011802438819519567067241979</span>, <span class="number">151997755976755754648644424339697978791639952976423703068460739754839735</span>, <span class="number">253811682402531882908516509348937060650658679039884817907013090700281326</span>, <span class="number">404019046883201096048575369492824679211148242588135515488831100750933</span>, <span class="number">216725815105749574244056185735609680710954976727370948136589694286539150</span>, <span class="number">131605791470353972911656132280131756304373156215254629027113994962767833</span>, <span class="number">180190835657942894146705472335255090682179032409197893415067330574923084</span>, <span class="number">280086867488286721744184104208965143004904898002959657537412170401510680</span>, <span class="number">141039650035922882497777354937772530276454847300329950111476878397654053</span>, <span class="number">319858542602843767926919031049756704694256249776295683733693049522108872</span>, <span class="number">135633729043152514436339515687850041275739968837263316059461122379487161</span>, <span class="number">5038078437655552457504448170918674775639811066221990939957937239270167</span>, <span class="number">31918623105281221407484700216805581554894830335850729735403857505547002</span>, <span class="number">424092292941284354705774693468403308534554297314522980647422106907791591</span>, <span class="number">300635399575681097924575337707842439619576566621368558814406755486658723</span>, <span class="number">323686536134235835297820679361020300261642147835330856978902402517820801</span>, <span class="number">392620731408972775834827063986182511057173023783228673505487358356342114</span>, <span class="number">108681888409433100038410892044516773350200560613740266422720530715166828</span>, <span class="number">182338238967593331173372924666322484559869636981878410128856193538847678</span>, <span class="number">242630103099393630296862580986126439159331512930513337684897019399319621</span>, <span class="number">439737851682655515589311041364295341910822514202794661846391952824593066</span>, <span class="number">84115222835816390632388766236883091861894245716624041418721833768917547</span>, <span class="number">83926810016448863267608537461154878096011055852547156452557576634691363</span>, <span class="number">354588657997053098464002945990025178880458974438409486331146607111950617</span>, <span class="number">170413334241108032297843362994773587930354677207616527135896108692092457</span>, <span class="number">283185550452196010949673962093382632839937948488235076418296451706429923</span>, <span class="number">390000015988537819093964185756696910433784324036454283227484980367608884</span>, <span class="number">121370082693927496814267201484843687844578996855559797026014779421645731</span>, <span class="number">357164702199289826402900456464935203585119719343409406742172822868770420</span>, <span class="number">124276883926433089715798954125363260298740714164810098876501303684201565</span>, <span class="number">122912426324401068572433533096099229494021528981601203447594706478943744</span>, <span class="number">287527827124819650763642012585104162743364640051014410357971387706781531</span>, <span class="number">135819408760576908301747047938951002691288880199213610653148681326046091</span>, <span class="number">239644892459756283997004399339163555215985564639569406081575642996080481</span>, <span class="number">241513055132921096791997556818670497379598444881679976542299970876463098</span>, <span class="number">144152466563589166040797814966860917437020789050031353309848917297959088</span>, <span class="number">120162009732086541189519736083838746833770360960800721525565383293404918</span>, <span class="number">121547756201941339094205049920057111793191461762212554355070565584802804</span>]</span><br><span class="line">b = [<span class="number">6914108949558554967947157128371931777410399406424987472871265954007536210016000226325059466226417032321637768264366355381358552354005990800271210820573485</span>, <span class="number">4243350947524503250221141283676871054961767761533372535893799777316644277502608136805589201625364130457811586620275507258712882614289496389903620348266876</span>, <span class="number">7207723049065039433195103268720351560639394404931218738588797743896531445162073256971205066381805731964498662913612257697112297701515506572915529630749649</span>, <span class="number">9478867353430476119494189313998177997736272254097122188128236485373498544996365281925749885278741955783336542038044934310609039388320259421902808190444639</span>, <span class="number">10092751897940937230080778690510245631681516769761757712615337492357689455504789850857408988921202275660819814611602363226676960504340172006698418415173603</span>, <span class="number">5925826079655586275072881965974452367893696237983922405515651101142466142890347074549417916208251973477786424292583294611467079137685936757690986611634840</span>, <span class="number">2705681917429356111941316419951220642197423059675588735077708172236184161647753066851383893342803615318493417826483637576437939588768131347824859258545037</span>, <span class="number">5793481213766970753853702438948943122939283534830229656699291673833482520096412620329053619097899786691202045974184168665694248732396928571682405270896258</span>, <span class="number">3212965229314647637209688663583343281038324880827825190075824389072703574155472958687615046177029380089781167897141334668918512246004114927754397070032450</span>, <span class="number">507858897452123392345795058512546587866098555419275815786154069852495346820264502978622507708545904809967228104858456493411165322256241259977367791849042</span>, <span class="number">1910673108437857460691507244808588742883010826641687685721219894695257479961884688001651060796296482279750896861871054549713247272267814842634417960819168</span>, <span class="number">2886899741243848325873884252302617091514751717162909139186588257257958079130295099942906361136727891394692438504521454612873780003451672796809495226053047</span>, <span class="number">9475112027697464127079619380873273645977046666164164866182205134451664768516062572467782141714310693479352016031210905832129007401065693258638549100340615</span>, <span class="number">6500556077535313473248384729914564751019267303740919343852356539545383313100771434642240039386190890442297569489225045989569513367190888305128046797790102</span>, <span class="number">4352575880916080525863863641402979108455803235156616467981920947190189719209876636528864672410548581564537392488508689158499605332674737341258230577454475</span>, <span class="number">8855806560115120193748486720541724804359134126331550182497194629659837334220708039976726151383523965042432921330088347099157101222325916589506823343303429</span>, <span class="number">2774687136241363374520941544838376461935832170671324174983217598018541119488143069001573950404074015672792681188308412236177101695870429933915439814455887</span>, <span class="number">3592625154014227818614640279472091377202566130067513443394635609406915223429475106920133466069573358784994632708606215548054720669924050172507230811524716</span>, <span class="number">6955167231829680836198358545532458408492109230130585460528670650387346748536700767474985024643177587060440925065292948599577822789464670224006606550191671</span>, <span class="number">9194240450171813716718107852597217121362901491312541712415368806074976814988492806542250961496723482200369134039024809109124268301878344007510329535899615</span>, <span class="number">5950577443108124534632225089717156798651285826327691188035165834526053749015025923590404663092184546183617748745220821771671541995250149683517797527521402</span>, <span class="number">8147536282406177354958293970877926560729452459282692121940762677425779306283487924160782780299072205173184092679363257393333408904258459452274140791704067</span>, <span class="number">2559838851622656651952688025212080768394118716136473174419624432065878751831257138924556995347285973152404103332115858073203707432778426111325160735797721</span>, <span class="number">4949359541993387232537947394033362386729434824378846379892748514319807403496542405321037377319385099259508143211518009425440208974571177165892037150309091</span>, <span class="number">1811673815510905036234500180939767229691774807773077679609856974935852997557959138952513786288094951891092390620085630282790435640054840555430191851155313</span>, <span class="number">4777885082419038381870076531532991228660498200204585112220314790970263737966241042846160101892845251352987027168075888559622541458466624868511496707956221</span>, <span class="number">10238413710887745087366241938666680877364662925315040665408262063559110391570620624035047723405526398382375337996702653261521046541231508963525281969167278</span>, <span class="number">3473340971529025694371400010471019993671985537666177271712164477185774211271764180735799413043127038518985595844132844447764288680922052782557764949946998</span>, <span class="number">867350328105510555601266520733196439839458877892746826352327206388533426010006967907349245075237097927904721917883721235095421696529792601733014134854086</span>, <span class="number">2222551217354471458254572360148123193413834831993026644829243162796014361851880328878269533732240093458365703558737637137958860294765246560791514120259973</span>, <span class="number">11135205396103944017696365595462393888434601100415179875833418713405171505514194213145570969708606144837327906949671055964664374675657263466390592843391795</span>, <span class="number">8522093767526974938129274822063573020978729589640216089964237075835492415426711219243729120235033613444547687888110911207624759350428715822663409802746531</span>, <span class="number">618066223420558653541360712487038985426207412776033652080372792996567809564864490136174039188920973110051946250308952735815050129654446357610891600358247</span>, <span class="number">9409683398358516350960966400164689353665188916574105692687503875332913200043983566205433723664581043184720605266180639045542588369320481456882129188045630</span>, <span class="number">10444912184036485133367095187175276878779180732948191228469107836744786278456394810069942330852023901190983084405589604802372025661121698806608507168815980</span>, <span class="number">5576808818750933483753823503921696491223987341840901931564632327098735945058071342467846031030536056935288275893098409520502499556978787294107531192342888</span>, <span class="number">11386170831130547392066338523237385342399839863674855226178213470159061980868639851406716227763244070078162813390834461297132500087558187715637626334931068</span>, <span class="number">9266567474732845229716988973436914937598698459994255583719094874193822181675544832905800318876640152861212158602258489908050910803591150200525814954449464</span>, <span class="number">783592057196685768383414375510915255040313296240508052297125547577301394194342174502254618660494179262947294784116190346971775913769035176336764690986707</span>, <span class="number">9105502180406569116340185218615179260760299848734930041602247299415927012355894700609320722623370139135122342263713846033304524885782445949914570572453737</span>, <span class="number">2297513067567074587355421795953863750627166311403426281361312466297059134183355298180726594771668216966732975569375780641995446201527865824229865021970151</span>, <span class="number">11188600115372846854366137972585164923834717935898376598627276542371780275188751807941476083838808640337088079259756154889298297211898790479562768420072518</span>, <span class="number">9656534484640562909118084019762167873291009773232637365213178341424207965285682074941363264934464618450896824843786922345950140473512635227211478685645772</span>, <span class="number">9343461413426168572561103655466265435717795505657355206522619014228487030194629865342342831380623629471381377128476731390629039248389925891691539701146309</span>, <span class="number">8681682631345831952913045584970984843073645909076987924890403622460027832467542651987623584349089629585531159664847835287269602153108548311564650707486153</span>, <span class="number">2656022193773767486949157049738671449721427276944394094199310567891807831351152318018854466905531462256724938253289337125816757790150607033652302227218868</span>, <span class="number">8508384570273623974802293014504152838556567399448174508834295467479347400327605230626491770497722014885725768213847610504091563629074470937893415637338996</span>, <span class="number">9716708016762837073052660164394053927821481998442639097920157163041635386583167412600530638659299593644342722890385260143682043966383262553995449944733956</span>, <span class="number">10231440381205182517403356785692369093270060843919065205063057623835967990844569366866607452179015606536153761832574542432676397053147658371344410148994418</span>, <span class="number">5146017765041682548648007957706007143803297597587388958721578537741505373387718545092695689770641249769257901519197825087801304735466239843061128683798476</span>, <span class="number">5222787643951107881679620487297380490422971146509273142662864657570322385794688143091615970726544447887548792995773377472568754141261595697499826832283200</span>, <span class="number">10464709627510729920064247596403868144579001206027850090117534773353171042729174225448975480540265139445689560336303762183734720331072177316589830221880977</span>, <span class="number">8615548684371129329547908465444932886632829509038689025840147771114904826804441395348568994340729561487767929565347408386252378372026787346043297419998538</span>]</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">97853623351997296064353255135588846396569970130207954701198599507389250544514082114957455795330569730103385876268186267851194017938003005329258612122178955978821786063623918361705120943030241043571056282806763102278839262572943852578441568495106906583558313075633340995336324665255745279078992160547871869557</span></span><br><span class="line">c = <span class="number">44431449479567561261917922338101462065458737366369232901780150553091038211618354850829522817943842817713545313017593484450672219262670055539455602698182643653128488160901383204333856589371756831501857423631322915113418699087489759910739942878900174507138454184974875778861767989603951090385047953725189919178</span></span><br><span class="line"></span><br><span class="line">N = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">51</span>):</span><br><span class="line">    N.append(a[i+<span class="number">1</span>]*inverse(b[i],n) - a[i]*inverse(b[i+<span class="number">1</span>],n))</span><br><span class="line">X = <span class="number">2</span>**R_bits</span><br><span class="line">m = <span class="built_in">len</span>(N)</span><br><span class="line"></span><br><span class="line">PR = PolynomialRing(ZZ, names=[<span class="built_in">str</span>(<span class="string">&#x27;x%d&#x27;</span> % i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1</span> + m)])</span><br><span class="line"></span><br><span class="line">h = <span class="number">3</span></span><br><span class="line">u = <span class="number">1</span></span><br><span class="line">variables = PR.gens()</span><br><span class="line"></span><br><span class="line">gg = []</span><br><span class="line">monomials = [variables[<span class="number">0</span>]**<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    gg.append(N[i] - variables[i])</span><br><span class="line">    monomials.append(variables[i])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(monomials), <span class="built_in">len</span>(gg))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;monomials:&#x27;</span>, monomials)</span><br><span class="line"></span><br><span class="line">B = Matrix(ZZ, <span class="built_in">len</span>(gg), <span class="built_in">len</span>(monomials))</span><br><span class="line"><span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(gg)):</span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(monomials)):</span><br><span class="line">        <span class="keyword">if</span> monomials[jj] <span class="keyword">in</span> gg[ii].monomials():</span><br><span class="line">            B[ii, jj] = gg[ii].monomial_coefficient(monomials[jj]) * monomials[jj]([X] * m)</span><br><span class="line"></span><br><span class="line">B = B.LLL()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-&#x27;</span> * <span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">new_pol = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(gg)):</span><br><span class="line">    tmp_pol = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(monomials)):</span><br><span class="line">        tmp_pol += monomials[j](variables) * B[i, j] / monomials[j]([X] * m)</span><br><span class="line">    new_pol.append(tmp_pol)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(new_pol) &gt; <span class="number">0</span>:</span><br><span class="line">    Ideal = ideal(new_pol[:m-<span class="number">1</span>])</span><br><span class="line">    GB = Ideal.groebner_basis()</span><br><span class="line">    function_variables = var([<span class="built_in">str</span>(<span class="string">&#x27;y%d&#x27;</span> % i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1</span> + m)])</span><br><span class="line">    res = solve([pol(function_variables) <span class="keyword">for</span> pol <span class="keyword">in</span> GB], function_variables)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;got %d basis&#x27;</span> % <span class="built_in">len</span>(GB))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;solved result:&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br><span class="line">    PRRR.&lt; x, y&gt; = PolynomialRing(QQ)</span><br><span class="line">    q = <span class="built_in">abs</span>(PRRR(res[<span class="number">0</span>][<span class="number">0</span>](x, y)).coefficients()[<span class="number">0</span>].denominator())</span><br><span class="line">    p = N[-<span class="number">1</span>] // q</span><br><span class="line"></span><br><span class="line">p = <span class="built_in">abs</span>(<span class="built_in">int</span>(p))</span><br><span class="line">q = n//p</span><br><span class="line">d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;755f85c2723bb39381c7379a604160d8&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="Matrix"><a href="#Matrix" class="headerlink" title="Matrix"></a>Matrix</h3><p>é¢˜ç›®æ¥æºï¼šæš‚ä¸æ˜ç¡®</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"><span class="comment"># Problem by rec, with nothing.</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> secret</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"></span><br><span class="line">LEN = <span class="number">32</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([a[i%<span class="built_in">len</span>(a)] ^^ b[i%<span class="built_in">len</span>(b)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">max</span>(<span class="built_in">len</span>(a), <span class="built_in">len</span>(b)))])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">challenge</span>(<span class="params">m: <span class="built_in">bytes</span>, pbits: <span class="built_in">int</span>, level: <span class="built_in">int</span>=<span class="number">0</span></span>):</span><br><span class="line">    p = getPrime(pbits)</span><br><span class="line">    M = random_matrix(GF(p), LEN).matrix_from_rows_and_columns(<span class="built_in">range</span>(LEN), <span class="built_in">range</span>(LEN-level))</span><br><span class="line">    c = vector(GF(p), m) * M</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;p&quot;</span>: p, <span class="string">&quot;M&quot;</span>: M.<span class="built_in">list</span>(), <span class="string">&quot;c&quot;</span>: c.<span class="built_in">list</span>()&#125;</span><br><span class="line"></span><br><span class="line">args = &#123;</span><br><span class="line">    <span class="string">&quot;chall1&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;m&quot;</span>: os.urandom(LEN),</span><br><span class="line">        <span class="string">&quot;pbits&quot;</span>: <span class="number">512</span>,</span><br><span class="line">        <span class="string">&quot;level&quot;</span>: <span class="number">0x00</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;chall2&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;m&quot;</span>: os.urandom(LEN),</span><br><span class="line">        <span class="string">&quot;pbits&quot;</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="string">&quot;level&quot;</span>: <span class="number">0x01</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;chall3&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;m&quot;</span>: os.urandom(LEN),</span><br><span class="line">        <span class="string">&quot;pbits&quot;</span>: <span class="number">256</span>,</span><br><span class="line">        <span class="string">&quot;level&quot;</span>: <span class="number">0x10</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">out = <span class="built_in">dict</span>()</span><br><span class="line">enc = pad(secret.flag, LEN)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    out[<span class="string">f&quot;chall<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>&quot;</span>] = challenge(**args[<span class="string">f&quot;chall<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>&quot;</span>])</span><br><span class="line">    enc = xor(enc, hashlib.sha512(args[<span class="string">f&quot;chall<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>&quot;</span>][<span class="string">&quot;m&quot;</span>]).digest())</span><br><span class="line">out[<span class="string">&quot;enc&quot;</span>] = enc.<span class="built_in">hex</span>()</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">f&quot;<span class="subst">&#123;out = &#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>æ¢³ç†ä¸€ä¸‹è§£å¯†æµç¨‹ï¼š</p>
<ul>
<li>å…ˆå°†flagä¸²å¡«å……è‡³32çš„æ•´æ•°å€</li>
<li>ç”Ÿæˆä¸‰ç»„challengeéœ€è¦çš„å‚æ•°ï¼šmï¼Œpbitsï¼Œlevel</li>
<li>å°†æ¯ä¸€ç»„çš„mç”¨sha512åŠ å¯†åï¼Œä¾æ¬¡ä¸flagå¼‚æˆ–</li>
<li>ç»™å‡ºæ¯ç»„challengeçš„å¯¹åº”è¾“å‡ºä¸æœ€ç»ˆå¯†æ–‡å€¼</li>
</ul>
<p>å…¶ä¸­ï¼Œchallengeçš„å„ä¸ªå‚æ•°å€¼åœ¨åŠ å¯†è¿‡ç¨‹ä¸­çš„ä½œç”¨ä¾æ¬¡æ˜¯ï¼š</p>
<ul>
<li>ç”Ÿæˆä¸€ä¸ªpbitsçš„ç´ æ•°pï¼Œå¹¶ä»¥è¯¥pç”Ÿæˆä¸€ä¸ªæœ‰é™åŸŸGf(p)</li>
<li>å°†mçš„32ä¸ªéšæœºå­—èŠ‚è½¬æ¢æˆGf(p)ä¸‹çš„é•¿åº¦ä¸º32çš„å‘é‡</li>
<li>ç”Ÿæˆä¸€ä¸ªå¤§å°ä¸º32*(32-level)çš„çŸ©é˜µMï¼ŒMä¸­å…ƒç´ å‡ä¸ºGf(p)ä¸­çš„éšæœºæ•°</li>
<li>è®¡ç®—c=m*Mï¼Œå¹¶ç»™å‡ºpã€Må’Œc</li>
</ul>
<p>å› æ­¤ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯ç”±cã€Måè§£å‡ºmï¼Œå¹¶è®¡ç®—å…¶sha512å€¼åä¸å¯†æ–‡ä¾æ¬¡å¼‚æˆ–ï¼Œå°±èƒ½å¾—åˆ°æ˜æ–‡ï¼Œä½†æ˜¯ä¸‰æ¬¡æ±‚è§£çš„æ–¹æ³•ç”±Mçš„å¤§å°è€Œäº§ç”Ÿä¸åŒã€‚</p>
<h4 id="challenge1"><a href="#challenge1" class="headerlink" title="challenge1"></a>challenge1</h4><p>ç¬¬ä¸€è½®ï¼ŒMçš„å¤§å°ä¸º32*32ï¼Œå› æ­¤æœ‰ï¼š</p>
<script type="math/tex; mode=display">
m_{1\times 32}*M_{32\times 32} = c_{1\times 32}\quad(mod\;p)</script><p>å¯ä»¥çœ‹ä½œæ˜¯mçš„32ä¸ªå˜é‡å¯¹åº”äº†32ç»„æ–¹ç¨‹ï¼Œå› æ­¤æ»¡ç§©ï¼Œå¯ä»¥ç›´æ¥æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„(æ•°æ®æœ‰ç‚¹å¤§ï¼Œæƒ³è¦å¤ç°çš„å¸ˆå‚…å¯ä»¥è”ç³»æˆ‘)ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p = </span><br><span class="line">M = []</span><br><span class="line">c = []</span><br><span class="line"></span><br><span class="line">c = vector(GF(p),c)</span><br><span class="line">m = matrix(GF(p),<span class="number">32</span>,<span class="number">32</span>,M)</span><br><span class="line">flag1 = m.solve_left(c)</span><br><span class="line">flag1 = <span class="built_in">bytes</span>(flag1)</span><br></pre></td></tr></table></figure>
<p><br></p>
<h4 id="challenge2"><a href="#challenge2" class="headerlink" title="challenge2"></a>challenge2</h4><p>ç¬¬äºŒè½®ï¼ŒMçš„å¤§å°ä¸º32*31ï¼Œå› æ­¤æœ‰ï¼š</p>
<script type="math/tex; mode=display">
m_{1\times 32}*M_{32\times 31} = c_{1\times 31}\quad(mod\;p)</script><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œmçš„32ä¸ªå˜é‡åªæœ‰31ç»„æ–¹ç¨‹äº†ï¼Œå› æ­¤å¯ä»¥æ±‚å‡ºæ— ç©·å¤šç»„è§£ã€‚ä¸è¿‡ç”±äºåªå·®ä¸€ç»„æ–¹ç¨‹ï¼Œå› æ­¤ä¹Ÿåªéœ€è¦é€‰å–ä¸€ä¸ªè‡ªç”±å˜é‡ï¼Œå¹¶ä»cä¸­å¯¹åº”å‡å»å…¶å€¼åï¼Œè§£ä¸€ä¸ª31å˜é‡çš„æ»¡ç§©æ–¹ç¨‹ã€‚è€Œåˆ¤æ–­è§£æ­£ç¡®çš„ä¾æ®å°±æ˜¯è§£å‡ºæ¥çš„må‘é‡ä¸­æ‰€æœ‰å€¼å‡åœ¨0-256ä¹‹é—´ã€‚</p>
<p>è¯´èµ·æ¥å¯èƒ½ä¸é‚£ä¹ˆæ˜ç™½ï¼Œè¿˜æ˜¯ä¸Šä¸ªä¾‹å­ï¼Œè¿™é‡Œä»¥ä¸‹é¢è¿™ä¸ªçº¿æ€§æ–¹ç¨‹ç»„ç®€å•è¯´æ˜ä¸€ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
m_{1\times 4}*M_{4\times 3} = c_{1\times 3}</script><p>å†™å‡ºæ¥ï¼š</p>
<script type="math/tex; mode=display">
s = (x_1,x_2,x_3,x_4)*\left(
 \begin{matrix}
   m_{11} & m_{12} & m_{13}\\
   m_{21} & m_{22} & m_{23} \\
   m_{31} & m_{32} & m_{33} \\
   m_{41} & m_{42} & m_{43}  \\
  \end{matrix}
  \right)
  =(c_1,c_2,c_3)</script><p>å˜æˆæ–¹ç¨‹ç»„å½¢å¼å°±æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
\begin{cases}
        m_{11}x_{1} + m_{21}x_{2} + m_{31}x_{3} + m_{41}x_{4} = c_1 \\
        m_{12}x_{1} + m_{22}x_{2} + m_{32}x_{3} + m_{42}x_{4} = c_2 \\ 
        m_{13}x_{1} + m_{23}x_{2} + m_{33}x_{3} + m_{43}x_{4} = c_3 
    \end{cases}</script><p>ç°åœ¨æˆ‘ä»¬å‡è®¾å·²ç»çŸ¥é“äº†x4çš„å€¼(å¯¹åº”äºé¢˜ç›®ä¸­ï¼Œå°±æ˜¯åœ¨0-256ä¸­çˆ†ç ´)ï¼Œé‚£ä¹ˆæŠŠæ–¹ç¨‹ç»„ä¸­å«x4çš„é¡¹éƒ½ç§»åˆ°å³è¾¹ï¼Œå°±å˜æˆï¼š</p>
<script type="math/tex; mode=display">
\begin{cases}
        m_{11}x_{1} + m_{21}x_{2} + m_{31}x_{3}  = c_1 - m_{41}x_{4}\\
        m_{12}x_{1} + m_{22}x_{2} + m_{32}x_{3}  = c_2 - m_{42}x_{4}\\ 
        m_{13}x_{1} + m_{23}x_{2} + m_{33}x_{3}  = c_3 - m_{43}x_{4}
    \end{cases}</script><p>æ¥ä¸‹æ¥è§£çš„å°±æ˜¯è¿™ä¸ªæ»¡ç§©æ–¹ç¨‹ï¼š</p>
<script type="math/tex; mode=display">
s = (x_1,x_2,x_3)*\left(
 \begin{matrix}
   m_{11} & m_{12} & m_{13}\\
   m_{21} & m_{22} & m_{23} \\
   m_{31} & m_{32} & m_{33} 
  \end{matrix}
  \right)
  =(c_1 - m_{41}x_{4},c_2 - m_{42}x_{4},c_3 - m_{43}x_{4})</script><p>å¾ˆå®¹æ˜“æƒ³åˆ°ï¼Œå½“è§£å‡ºçš„å‘é‡ $ (x_1,x_2,x_3)$ å‡åœ¨0-256ä¹‹é—´æ—¶ï¼Œå°±æ­£ç¡®æ±‚è§£äº†ã€‚æ”¾åœ¨æœ¬é¢˜ä¸­ä¹Ÿä¸è¿‡æ˜¯å¯¹è¿™ä¸ªä¾‹å­çš„æ‰©å¤§è€Œå·²ï¼Œå–x32è¿›è¡Œçˆ†ç ´ï¼Œæ–¹æ³•æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p = </span><br><span class="line">M = []</span><br><span class="line">c = []</span><br><span class="line"></span><br><span class="line">c = vector(GF(p),c)</span><br><span class="line">m = matrix(GF(p),<span class="number">32</span>,<span class="number">31</span>,M)</span><br><span class="line">MM = m.delete_rows([<span class="number">31</span>])</span><br><span class="line">M_ = m[-<span class="number">1</span>]</span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">	cc = c - i * M_</span><br><span class="line">	ans = MM.solve_left(cc)</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">all</span>(ans[i] &lt;= <span class="number">256</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>)):</span><br><span class="line">		k = i</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">flag2 = <span class="built_in">bytes</span>(<span class="built_in">list</span>(ans)+[k])</span><br></pre></td></tr></table></figure>
<p><br></p>
<h4 id="challenge3"><a href="#challenge3" class="headerlink" title="challenge3"></a>challenge3</h4><p>ç¬¬ä¸‰è½®ï¼ŒMçš„å¤§å°ä¸º32*16ï¼Œå› æ­¤æœ‰ï¼š</p>
<script type="math/tex; mode=display">
m_{1\times 32}*M_{32\times 16} = c_{1\times 16}\quad(mod\;p)</script><p>å¯ä»¥æƒ³åˆ°ï¼Œå¦‚æœç»§ç»­ç”¨ç¬¬äºŒè½®ä¸­çš„æ–¹æ³•ï¼Œé‚£ä¹ˆéœ€è¦çˆ†ç ´256çš„16æ¬¡æ–¹ç§å¯èƒ½ï¼Œæ•°é‡çº§è¾¾åˆ°äº†2^128ï¼Œæ˜¯æ˜¾ç„¶ä¸å¯èƒ½çš„ï¼Œæ‰€ä»¥éœ€è¦å¦è°‹ä»–æ³•ã€‚è€Œå…¶å®ä½ åº”è¯¥æ—©å°±æƒ³åˆ°äº†ï¼Œmåœ¨æ¯ä¸ªchallengeä¸­ï¼Œéƒ½æ˜¯ä¸€ä¸ªç”±32ä¸ª0-256çš„å€¼ç»„æˆçš„å‘é‡ã€‚0-256æ„å‘³ç€ï¼Œ<strong>åœ¨æ¨¡pä¸‹è¿™äº›å€¼éƒ½å¾ˆå°</strong>ï¼Œå› æ­¤å¾ˆè‡ªç„¶åœ°å°±ä¼šè”æƒ³åˆ°æ ¼ã€‚</p>
<p>æ‰€ä»¥challenge3å…¶å®æ˜¯ä¸€ä¸ªæ ¼åŸºè§„çº¦é—®é¢˜ï¼Œä½†æ˜¯æƒ³æ„é€ å‡ºè¿™æ ·çš„æ ¼è¿˜æ˜¯æœ‰ç‚¹éš¾åº¦çš„ã€‚é¦–å…ˆè¿˜æ˜¯åˆ—å‡ºæ„é€ æ ¼éœ€è¦çš„å¤šä¸ªç­‰å¼ï¼š</p>
<script type="math/tex; mode=display">
s = (x_1,x_2,...,x_{31},x_{32})*\left(
 \begin{matrix}
   m_{1,1} & m_{1,2} &... &m_{1,16}\\
   m_{2,1} & m_{2,2} &... &m_{2,16} \\
   & &...\\
   m_{31,1} & m_{31,2} &... &m_{31,16} \\
   m_{32,1} & m_{32,2} &... &m_{32,16}  \\
  \end{matrix}
  \right)
  =(c_1,c_2,...,c_{15},x_{16})\quad(mod\;p)</script><p>ä»è¿™ä¸ªçŸ©é˜µä¹˜æ³•ä¸­ï¼Œå¯ä»¥æå–å‡ºå…¶ä¸­çš„åå…­ä¸ªç­‰å¼ï¼š(i = 1,2,â€¦,16)</p>
<script type="math/tex; mode=display">
m_{1,i}*x_1+m_{2,i}*x_2...+m_{31,i}*x_{31}+m_{32,i}*x_{32}+ k_i*p=c_i</script><p>ä»¥è¿™äº›ç­‰å¼ä¸ºåŸºç¡€ï¼Œæˆ‘ä»¬æ„é€ å‡ºä¸‹é¢çš„æ ¼ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">MM = matrix(ZZ,<span class="number">32</span>,<span class="number">16</span>,M)</span><br><span class="line">E = diagonal_matrix([<span class="number">1</span>]*<span class="number">32</span>)</span><br><span class="line">P = diagonal_matrix([p]*<span class="number">16</span>)</span><br><span class="line">C = matrix(ZZ,c)</span><br><span class="line">L = block_matrix(ZZ,[[MM,E],[P,<span class="number">0</span>],[C,<span class="number">0</span>]])</span><br></pre></td></tr></table></figure>
<p>å†™æ¸…æ¥šç‚¹å°±æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
\left(
 \begin{matrix}
   m_{1,1} & m_{1,2} &... &m_{1,16}   &1&0&...&0&0\\
   m_{2,1} & m_{2,2} &... &m_{2,16}   &0&1&...&0&0 \\
   & &...\\
   m_{31,1} & m_{31,2} &... &m_{31,16}&0&0&...&1&0\\
   m_{32,1} & m_{32,2} &... &m_{32,16}&0&0&...&0&1  \\
   p&0&...&0&0&0&...&0&0\\
   0&p&...&0&0&0&...&0&0\\
   &&...\\
   0&0&...&p&0&0&...&0&0\\
   c_1&0&...&0&0&0&...&0&0\\
   0&c_2&...&0&0&0&...&0&0\\
   &&...\\
   0&0&...&c_{16}&0&0&...&0&0\\
  \end{matrix}
  \right)</script><p>è¿™æ˜¯ä¸€ä¸ª64*48çš„çŸ©é˜µï¼Œè€Œæˆ‘ä»¬ç”¨è¿™ä¸ªçŸ©é˜µè§„çº¦çš„ä¾æ®ç­‰å¼æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
(x_1,x_2,...,x_{32},k_1,k_2,...,k_{16},-1,-1,...,-1)*\left(
 \begin{matrix}
   m_{1,1} & m_{1,2} &... &m_{1,16}   &1&0&...&0&0\\
   m_{2,1} & m_{2,2} &... &m_{2,16}   &0&1&...&0&0 \\
   & &...\\
   m_{31,1} & m_{31,2} &... &m_{31,16}&0&0&...&1&0\\
   m_{32,1} & m_{32,2} &... &m_{32,16}&0&0&...&0&1  \\
   p&0&...&0&0&0&...&0&0\\
   0&p&...&0&0&0&...&0&0\\
   &&...\\
   0&0&...&p&0&0&...&0&0\\
   c_1&0&...&0&0&0&...&0&0\\
   0&c_2&...&0&0&0&...&0&0\\
   &&...\\
   0&0&...&c_{16}&0&0&...&0&0\\
  \end{matrix}
  \right)
  =
  (0,0,...,0,x_1,x_2,...,x_{32})</script><p>å¯ä»¥çœ‹å‡ºï¼Œè§„çº¦å‡ºçš„å‘é‡ $(0,0,â€¦,0,x_1,x_2,â€¦,x_{32})$ æ˜¯éå¸¸çŸ­çš„ï¼Œå› æ­¤LLLå°±èƒ½å¾—åˆ°è¿™ä¸ªè§£(ä¸è¿‡å®é™…æ“ä½œä¼šå‘ç°æ»¡è¶³è¦æ±‚çš„å‘é‡åœ¨ç¬¬äºŒè¡Œ)ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p = </span><br><span class="line">M = []</span><br><span class="line">c = []</span><br><span class="line"></span><br><span class="line">MM = matrix(ZZ,<span class="number">32</span>,<span class="number">16</span>,M)</span><br><span class="line">E = diagonal_matrix([<span class="number">1</span>]*<span class="number">32</span>)</span><br><span class="line">P = diagonal_matrix([p]*<span class="number">16</span>)</span><br><span class="line">C = matrix(ZZ,c)</span><br><span class="line">L = block_matrix(ZZ,[[MM,E],[P,<span class="number">0</span>],[C,<span class="number">0</span>]])</span><br><span class="line">ML = L.LLL()</span><br><span class="line">ans = <span class="built_in">list</span>(ML[<span class="number">1</span>][<span class="number">16</span>:])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ans)):</span><br><span class="line">      ans[i] = -ans[i]</span><br><span class="line">flag3 = <span class="built_in">bytes</span>(ans)</span><br></pre></td></tr></table></figure>
<p><br></p>
<h4 id="final"><a href="#final" class="headerlink" title="final"></a>final</h4><p>å¾—åˆ°ä¸‰ä¸ªflagä¹‹åï¼Œè¿›è¡Œsha512åä¾æ¬¡ä¸å¯†æ–‡å¼‚æˆ–å°±å¥½ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([a[i%<span class="built_in">len</span>(a)] ^^ b[i%<span class="built_in">len</span>(b)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">max</span>(<span class="built_in">len</span>(a), <span class="built_in">len</span>(b)))])</span><br><span class="line"></span><br><span class="line"><span class="comment">#part1</span></span><br><span class="line">p = </span><br><span class="line">c = vector(GF(p),c)</span><br><span class="line">m = matrix(GF(p),<span class="number">32</span>,<span class="number">32</span>,M)</span><br><span class="line">flag1 = m.solve_left(c)</span><br><span class="line">flag1 = <span class="built_in">bytes</span>(flag1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#part2</span></span><br><span class="line">p = <span class="number">661</span></span><br><span class="line">M = []</span><br><span class="line">c = []</span><br><span class="line"></span><br><span class="line">c = vector(GF(p),c)</span><br><span class="line">m = matrix(GF(p),<span class="number">32</span>,<span class="number">31</span>,M)</span><br><span class="line">MM = m.delete_rows([<span class="number">31</span>])</span><br><span class="line">M_ = m[-<span class="number">1</span>]</span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">	cc = c - i * M_</span><br><span class="line">	ans = MM.solve_left(cc)</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">all</span>(ans[i] &lt;= <span class="number">256</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>)):</span><br><span class="line">		k = i</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">flag2 = <span class="built_in">bytes</span>(<span class="built_in">list</span>(ans)+[k])</span><br><span class="line"></span><br><span class="line"><span class="comment">#part3</span></span><br><span class="line">p = </span><br><span class="line">M = []</span><br><span class="line">c = []</span><br><span class="line"></span><br><span class="line">MM = matrix(ZZ,<span class="number">32</span>,<span class="number">16</span>,M)</span><br><span class="line">E = diagonal_matrix([<span class="number">1</span>]*<span class="number">32</span>)</span><br><span class="line">P = diagonal_matrix([p]*<span class="number">16</span>)</span><br><span class="line">C = matrix(ZZ,c)</span><br><span class="line">L = block_matrix(ZZ,[[MM,E],[P,<span class="number">0</span>],[C,<span class="number">0</span>]])</span><br><span class="line">ML = L.LLL()</span><br><span class="line">ans = <span class="built_in">list</span>(ML[<span class="number">1</span>][<span class="number">16</span>:])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ans)):</span><br><span class="line">      ans[i] = -ans[i]</span><br><span class="line">flag3 = <span class="built_in">bytes</span>(ans)</span><br><span class="line"></span><br><span class="line"><span class="comment">#final</span></span><br><span class="line">c = <span class="number">0x72c0e8ef53c726969a91368ca600a081f38f5cfaa1d0669d9049f278fb2f0fb4f36dced86bf9b7e9ef59af082cc5a5b2458cae490ab23c0c8c5b9361499ae2e2</span></span><br><span class="line">enc = long_to_bytes(c)</span><br><span class="line">flag = [flag1,flag2,flag3]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    enc = xor(enc, hashlib.sha512(flag[i]).digest())</span><br><span class="line"><span class="built_in">print</span>(enc)</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;db1ebd0c-1cac-55d5-763e-b05f3d9af423&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
]]></content>
      <categories>
        <category>cryptoè¶£é¢˜</category>
      </categories>
  </entry>
  <entry>
    <title>Cryptoè¶£é¢˜-Oracle</title>
    <url>/post/601c0957.html</url>
    <content><![CDATA[<p>è¿™ç¯‡æ–‡ç« ä¸»è¦è®°å½•ä¸€ä¸‹æœ‰è¶£çš„äº¤äº’é¢˜</p>
<span id="more"></span>
<h3 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h3><p>é¢˜ç›®æ¥æºï¼šNCTF 2021</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Task</span>(socketserver.BaseRequestHandler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_recvall</span>(<span class="params">self</span>):</span><br><span class="line">        BUFF_SIZE = <span class="number">2048</span></span><br><span class="line">        data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            part = self.request.recv(BUFF_SIZE)</span><br><span class="line">            data += part</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(part) &lt; BUFF_SIZE:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> data.strip()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">send</span>(<span class="params">self, msg, newline=<span class="literal">True</span></span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> newline:</span><br><span class="line">                msg += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line">            self.request.sendall(msg)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">recv</span>(<span class="params">self, prompt=<span class="string">b&#x27;&gt; &#x27;</span></span>):</span><br><span class="line">        self.send(prompt, newline=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> self._recvall()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">proof_of_work</span>(<span class="params">self</span>):</span><br><span class="line">        random.seed(os.urandom(<span class="number">8</span>))</span><br><span class="line">        proof = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters+string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">        _hexdigest = sha256(proof.encode()).hexdigest()</span><br><span class="line">        self.send(<span class="string">f&quot;sha256(XXXX+<span class="subst">&#123;proof[<span class="number">4</span>:]&#125;</span>) == <span class="subst">&#123;_hexdigest&#125;</span>&quot;</span>.encode())</span><br><span class="line">        x = self.recv(prompt=<span class="string">b&#x27;Give me XXXX: &#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(x) != <span class="number">4</span> <span class="keyword">or</span> sha256(x+proof[<span class="number">4</span>:].encode()).hexdigest() != _hexdigest:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self</span>):</span><br><span class="line">        p = getPrime(<span class="number">512</span>)</span><br><span class="line">        q = getPrime(<span class="number">512</span>)</span><br><span class="line">        n = p*q</span><br><span class="line">        e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">        signal.alarm(<span class="number">120</span>)</span><br><span class="line">        self.send(<span class="string">b&#x27;Try to factor n within 120 seconds&#x27;</span>)</span><br><span class="line">        self.send(<span class="string">&quot;n = &#123;&#125;\ne = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(n, e).encode())</span><br><span class="line">        self.send(<span class="string">b&#x27;And solve the proof-of-work below to begin the challenge.&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.proof_of_work():</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        signal.alarm(<span class="number">12</span>)</span><br><span class="line">        secret = os.urandom(<span class="number">16</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            self.send(<span class="string">&quot;c&#123;&#125; = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(i, <span class="built_in">pow</span>(bytes_to_long(secret[<span class="number">4</span>*i:<span class="number">4</span>*i+<span class="number">4</span>]), e, n)).encode())</span><br><span class="line"></span><br><span class="line">        self.send(<span class="string">b&quot;Give me the secret:&quot;</span>)</span><br><span class="line">        s = self.recv()</span><br><span class="line">        <span class="keyword">if</span> secret.<span class="built_in">hex</span>().encode() == s:</span><br><span class="line">            self.send(<span class="string">b&quot;Congratulations! Your flag is: &quot;</span>+flag.encode())</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.send(<span class="string">b&quot;Wrong secret&quot;</span>)</span><br><span class="line">        self.request.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST, PORT = <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">10002</span></span><br><span class="line">    server = ForkedServer((HOST, PORT), Task)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure>
<p>ä»£ç æ¯”è¾ƒé•¿ï¼Œä½†æ˜¯å¤§å¤šæ•°æ˜¯äº¤äº’ç›¸å…³çš„ä»£ç ï¼Œæ‰€ä»¥ä¸ç”¨ç®¡ï¼Œå…ˆæŠŠäº¤äº’å‰¥ç¦»æ‰æ¥åˆ†æè¿™ä¸ªé¢˜ã€‚</p>
<h4 id="è„±ç¦»äº¤äº’ï¼Œå•ç‹¬åˆ†æ"><a href="#è„±ç¦»äº¤äº’ï¼Œå•ç‹¬åˆ†æ" class="headerlink" title="è„±ç¦»äº¤äº’ï¼Œå•ç‹¬åˆ†æ"></a>è„±ç¦»äº¤äº’ï¼Œå•ç‹¬åˆ†æ</h4><p>é‚£ä¹ˆå°±ä¸ç®¡é¶æœºçš„å…¶ä»–äº¤äº’æµç¨‹ï¼Œæˆ‘ä»¬åªçœ‹è¦è§£å†³çš„æ ¸å¿ƒä»»åŠ¡ä»£ç ï¼Œåœ¨è¿™é‡Œæˆ‘æŠŠä¸é¶æœºäº¤äº’çš„éƒ¨åˆ†ç®€åŒ–æˆæ™®é€šinputã€printç­‰å½¢å¼ï¼Œç„¶åå±•ç¤ºå‡ºæ¥ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line"></span><br><span class="line">secret = os.urandom(<span class="number">16</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;c&#123;&#125; = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(i, <span class="built_in">pow</span>(bytes_to_long(secret[<span class="number">4</span>*i:<span class="number">4</span>*i+<span class="number">4</span>]), e, n)).encode())</span><br><span class="line"></span><br><span class="line">s = <span class="built_in">input</span>(<span class="string">&quot;Give me the secret:&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> secret.<span class="built_in">hex</span>().encode() == s:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">b&quot;Congratulations! Your flag is: &quot;</span>+flag.encode())</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">b&quot;Wrong secret&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>ä»£ç çš„æ„æ€å°±æ˜¯ï¼š</p>
<ul>
<li>ç”Ÿæˆä¸€ç»„RSAçš„å¯†é’¥pï¼Œqï¼Œnï¼Œeï¼Œå¹¶ç»™å‡ºå…¬é’¥(nï¼Œe)</li>
<li>éšæœºç”Ÿæˆ 16 ä¸ªå­—èŠ‚ï¼Œå¹¶åˆ‡ä¸º4å—ï¼Œæ¯ç»„4ä¸ªå­—èŠ‚ï¼Œä½œä¸ºå¾…åŠ å¯†çš„æ˜æ–‡</li>
<li>å¯¹æ¯ä¸€ç»„æ˜æ–‡åˆ†åˆ«è¿›è¡ŒRSAåŠ å¯†ï¼Œå¹¶ç»™å‡ºå¯†æ–‡</li>
<li>è¦æ±‚ä»4ç»„å¯†æ–‡è¿˜åŸå‡ºå®Œæ•´æ˜æ–‡</li>
</ul>
<p>é¦–å…ˆå¾ˆå¿«å°±èƒ½æ˜ç™½ï¼Œè¿™é‡Œçš„næ˜¯æ²¡æœ‰åŠæ³•åˆ†è§£çš„ï¼Œå› ä¸ºæ²¡æœ‰ä»»ä½•å…³äºpã€qã€dçš„æ³„æ¼ä¿¡æ¯ã€‚é‚£ä¹ˆæ€ä¹ˆè¿˜åŸå‡ºæ˜æ–‡å‘¢ï¼Œå°±è¦æ³¨æ„åˆ°ä»¥ä¸‹ä¸¤ç‚¹ï¼š</p>
<ul>
<li>æ˜æ–‡åˆ†æˆäº†4ç»„ï¼Œæ¯ç»„4ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯32bitï¼Œæ˜¯ä¸ªå¾ˆå°çš„æ˜æ–‡</li>
<li>è¿™é¢˜æ˜¯ä¸ªäº¤äº’é¢˜</li>
</ul>
<p>è¿™ä¸¤ç‚¹åˆ†åˆ«æœ‰ä»€ä¹ˆä½œç”¨å°±æ˜¯æ¥ä¸‹æ¥è¦è¯¦ç»†è¯´æ˜çš„åœ°æ–¹ã€‚</p>
<p>é¦–å…ˆè¦æ˜ç™½ï¼Œè¿™é‡Œçš„æ˜æ–‡å¦‚æœä¸åˆ†ç»„ï¼Œç›´æ¥è¿›è¡ŒåŠ å¯†ï¼Œé‚£ä¹ˆå…¶æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªçº¯ç²¹çš„RSAåŠ å¯†ï¼Œå°±å½“å‰çš„å¯†ç æŠ€æœ¯æ¥è¯´ï¼Œæˆ‘ä»¬å¦‚æœæ²¡æœ‰ç§é’¥çš„è¯ï¼Œè‡ªç„¶æ²¡æœ‰ä»»ä½•æœºä¼šè¿˜åŸå‡ºæ˜æ–‡ã€‚</p>
<p>è€Œåˆ†ç»„æœ€ç›´è§‚çš„æ•ˆæœï¼Œå°±æ˜¯æ¯ä¸€ç»„è¢«åŠ å¯†çš„æ˜æ–‡å˜å°äº†ï¼Œé‚£ä¹ˆä¹Ÿå°±è¯´æ˜<strong>å¯èƒ½æœ‰æœºä¼šçˆ†ç ´ï¼</strong>æ‰“ä¸ªæ¯”æ–¹ï¼Œå¦‚æœä½ å·²çŸ¥æ˜æ–‡å°±æ˜¯ä¸€ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆä»–å¯èƒ½çš„èŒƒå›´ä¹Ÿå°±åœ¨(0,256)ä¹‹é—´ï¼Œè¦è¿˜åŸæ˜æ–‡ï¼Œä½ åªéœ€è¦å°†(0,256)ä¹‹é—´çš„æ‰€æœ‰æ•°é€ä¸ªè¿›è¡ŒåŠ å¯†ã€‚å¦‚æœåŠ å¯†åçš„å¯†æ–‡ä¸ç»™å®šçš„å¯†æ–‡ç›¸ç­‰ï¼Œé‚£ä¹ˆå¯¹åº”çš„æ˜æ–‡å³ä¸ºæ‰€æ±‚ã€‚</p>
<p>ä½†æ˜¯è¿™ä¸ªé¢˜ç›®ä¸­æ˜æ–‡å³ä½¿åˆ†äº†ç»„ï¼Œæ¯ä¸€ç»„çš„æ˜æ–‡ä»ç„¶æ˜¯ä¸ª32bitçš„éšæœºæ•°ï¼Œç›´æ¥çˆ†ç ´è¿˜æ˜¯ä¸å¤ªç°å®çš„ï¼Œå› æ­¤éœ€è¦é‡‡å–ä¸€å®šæ–¹æ³•ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬éœ€è¦æ³¨æ„åˆ°ï¼Œè¿™ä¸ª32bitçš„éšæœºæ•°æœ‰å¾ˆå¤§æ¦‚ç‡æ˜¯ä¸ªåˆæ•°ï¼Œè¿™æ˜¯å› ä¸ºï¼Œåœ¨nä¸ªæ­£æ•´æ•°ä¸­ï¼Œè´¨æ•°å‡ºç°çš„æ¦‚ç‡å¤§çº¦ä¸ºï¼š</p>
<script type="math/tex; mode=display">
\frac{1}{\ln n}</script><p>å› æ­¤ï¼Œå¯¹äºnå–2^32ï¼Œå…¶æ¦‚ç‡ç»è®¡ç®—å¤§çº¦æ˜¯ 0.045084220027780106ï¼Œæ¦‚ç‡ç›¸å½“å°ã€‚æ‰€ä»¥æ˜æ–‡må¤§æ¦‚ç‡èƒ½å†™æˆä¸¤ä¸ªæ•´æ•°çš„ä¹˜ç§¯å½¢å¼ï¼š</p>
<script type="math/tex; mode=display">
m = i*j</script><p>è€Œç”±äºmæ˜¯(0,2^32)ä¹‹é—´çš„æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ¦‚ç‡æ€§çš„ç•Œå®š iã€j ä¸¤æ•°çš„èŒƒå›´ã€‚</p>
<p>ä»€ä¹ˆå«æ¦‚ç‡æ€§çš„ç•Œå®šèŒƒå›´å‘¢ï¼Ÿæ¯”å¦‚è¯´ï¼Œiã€j éƒ½åœ¨(0,2^16)è¿™ä¸ªèŒƒå›´é‡Œï¼Œæ¦‚ç‡æœ‰å¤šå¤§ï¼Ÿå…¶å®è¿™ä¸ªé—®é¢˜ç­‰ä»·äºmçš„å› å­å…¨éƒ¨å°äº2^16çš„æ¦‚ç‡ï¼Œå› æ­¤å¯ä»¥ç”¨å¦‚ä¸‹çš„ç¨‹åºç®€å•éªŒè¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line">count = <span class="number">0</span>    </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">1000</span>)):        </span><br><span class="line">    m = bytes_to_long(os.urandom(<span class="number">4</span>))</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">2</span>**<span class="number">16</span>):</span><br><span class="line">        <span class="keyword">while</span>(m % j == <span class="number">0</span>):</span><br><span class="line">            m //= j</span><br><span class="line">    <span class="keyword">if</span>(m == <span class="number">1</span>):</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(count/<span class="number">1000</span>)</span><br></pre></td></tr></table></figure>
<p>ç»è®¡ç®—æ¦‚ç‡å¤§æ¦‚åœ¨0.32å·¦å³ï¼Œè¿™è¯´æ˜ä»€ä¹ˆï¼Œè¿™è¯´æ˜mæœ‰0.32çš„æ¦‚ç‡å†™ä¸ºä¸¤ä¸ª(0,2^16)ä¹‹é—´çš„æ•°çš„ä¹˜ç§¯ï¼Œè¿™å¯¹æˆ‘ä»¬çš„çˆ†ç ´æœ‰ä»€ä¹ˆå¸®åŠ©å‘¢ï¼Ÿé¦–å…ˆï¼ŒåŠ å¯†è¿‡ç¨‹å°±å¯ä»¥æ”¹å†™æˆï¼š</p>
<script type="math/tex; mode=display">
m^e\equiv (i*j)^e \equiv i^e*j^e \equiv c\quad(mod\;n)</script><p>é‚£ä¹ˆå°±æœ‰ï¼š</p>
<script type="math/tex; mode=display">
c^{-1}*j^e\equiv i^{-e}\quad (mod\;n)</script><p>æ­¤æ—¶ä½ ä¼šå‘ç°ï¼Œå¦‚æœmèƒ½å¤Ÿå†™ä¸º(0,2^16)å†…çš„ iï¼Œj ä¸¤æ•°çš„ä¹˜ç§¯çš„å½¢å¼ï¼Œé‚£ä¹ˆç±»ä¼¼äºä¸­é—´ç›¸é‡æ”»å‡»ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨å¦‚ä¸‹æ–¹å¼çˆ†ç ´ï¼š</p>
<ul>
<li>æŠŠæ‰€æœ‰(0,2^16)ä¸­çš„ $ i^{-e}\quad (mod\;n)$ æå‰å­˜å‚¨åœ¨ä¸€ä¸ªå­—å…¸å†…</li>
<li>æ¥ä¸‹æ¥ï¼Œåªéœ€è¦çˆ†ç ´(0,2^16)ä¸­çš„ jï¼ŒéªŒè¯ $ c^{-1}*j^e\quad (mod\;n)$ åœ¨åˆšæ‰çš„å­—å…¸ä¸­ï¼Œåˆ™å¯¹åº”çš„ iï¼Œj ä¹˜ç§¯å³ä¸ºéœ€æ±‚çš„æ˜æ–‡</li>
</ul>
<p>å®¹æ˜“æ˜ç™½ï¼Œè¿™ç§æ”»å‡»æ–¹å¼æˆåŠŸçš„æ¦‚ç‡ï¼Œå°±ç­‰åŒäºmèƒ½å†™ä¸ºè¿™æ ·çš„ iï¼Œj ä¹˜ç§¯çš„æ¦‚ç‡ï¼Œä¹Ÿå°±æ˜¯0.32å·¦å³ã€‚é‚£ä¹ˆè¿ç»­4æ¬¡å‡æˆåŠŸï¼Œæ¦‚ç‡å¤§çº¦ä¸º:</p>
<script type="math/tex; mode=display">
(0.32)^4 = 0.01048576</script><p>å› æ­¤ï¼Œä¸è€ƒè™‘é¢˜ç›®å…¶ä»–é™åˆ¶çš„è¯ï¼Œæ¯ä¸€æ¬¡æ”»å‡»å¤§çº¦æœ‰1%çš„æ¦‚ç‡æˆåŠŸï¼Œè€Œå¯ä»¥ç”¨ä»¥ä¸‹ç¨‹åºè®¡ç®—å‡ºï¼Œäº¤äº’66æ¬¡ï¼Œå°±æœ‰å¤§äº50%çš„æ¦‚ç‡è‡³å°‘æˆåŠŸä¸€æ¬¡ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">fre = <span class="number">0.01048576</span></span><br><span class="line">success = <span class="number">1</span></span><br><span class="line">count = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    success *= (<span class="number">1</span>-fre)</span><br><span class="line">    <span class="keyword">if</span>(success &lt; <span class="number">0.5</span>):</span><br><span class="line">        <span class="built_in">print</span>(count)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    count += <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<h4 id="å›åˆ°äº¤äº’"><a href="#å›åˆ°äº¤äº’" class="headerlink" title="å›åˆ°äº¤äº’"></a>å›åˆ°äº¤äº’</h4><p>ä½†æ˜¯å®é™…ä¸Šï¼Œè¿™é¢˜å¯¹äº¤äº’æ—¶é—´æ˜¯æœ‰ä¸€å®šé™åˆ¶çš„ï¼š</p>
<ul>
<li>ä»è¿æ¥ä¸Šé¶æœºå¼€å§‹ï¼Œè®¡æ—¶120sï¼Œè¶…æ—¶ä¼šé€€å‡º</li>
<li>ä»å®Œæˆproof_of_workå¼€å§‹ï¼Œè®¡æ—¶12sï¼Œè¶…æ—¶ä¼šé€€å‡º</li>
</ul>
<p>è€Œæ³¨æ„åˆ°æˆ‘ä»¬è¿æ¥ä¸Šé¶æœºåï¼Œé¶æœºç«¯å°±ä¼šå‘é€ç»™æˆ‘ä»¬å…¬é’¥(nï¼Œe)ï¼Œè€Œè·å¾—äº†(nï¼Œe)ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å»ºç«‹å­—å…¸ã€‚ä¸€ç›´åˆ°proof_of_workå®Œæˆåï¼Œæˆ‘ä»¬æ‰éœ€è¦è¿›è¡Œå­—å…¸çš„æŸ¥è¯¢æ¥æœç´¢å‡º4ç»„æ˜æ–‡ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æœ‰æ›´å……è¶³çš„æ—¶é—´å»ºç«‹å­—å…¸ï¼Œè€ŒæŸ¥è¯¢å­—å…¸çš„æ—¶é—´æ›´æœ‰é™ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è¦é€‚å½“å¢å¤§ i çš„èŒƒå›´ï¼Œä½†æ˜¯å¯¹åº”çš„ï¼Œæœç´¢jçš„èŒƒå›´ä¸èƒ½å˜å°ï¼Œä»ç„¶è¦è€ƒè™‘æœç´¢2^16å†…çš„æ‰€æœ‰æ•°ã€‚æ‰€ä»¥æˆ‘ä»¬æµ‹è¯•ä»¥ä¸‹å‡ ç§æ–°çš„ä¹˜ç§¯åˆ’åˆ†ï¼š</p>
<script type="math/tex; mode=display">
i \in (0,2^{17}),j \in (0,2^{15})</script><script type="math/tex; mode=display">
i \in (0,2^{18}),j \in (0,2^{14})</script><script type="math/tex; mode=display">
i \in (0,2^{19}),j \in (0,2^{13})</script><script type="math/tex; mode=display">
i \in (0,2^{20}),j \in (0,2^{12})</script><script type="math/tex; mode=display">
i \in (0,2^{21}),j \in (0,2^{11})</script><p>ç»è®¡ç®—ï¼Œå‡ ç§åˆ’åˆ†å¯¹åº”çš„æ”»å‡»æˆåŠŸæ¦‚ç‡ä¾æ¬¡æ˜¯ï¼š0.36ã€0.45ã€0.52ã€0.55ã€0.62ï¼Œç†è®ºä¸Šæ¥è¯´å½“ç„¶æ˜¯è¶Šåé¢çš„åˆ’åˆ†è¶Šå¥½ï¼Œä½†æ˜¯åŒæ—¶ï¼Œå»ºç«‹å­—å…¸çš„è€—æ—¶ä¹Ÿéœ€è¦è€ƒè™‘è¿›å»ã€‚ä½ å¯ä»¥ç”¨ä»¥ä¸‹ç¨‹åºç®€å•æµ‹è¯•å‡ºï¼Œå­—å…¸å¤§å°æœ€å¤§ä¹Ÿå°±åªèƒ½å–åˆ°2^20ï¼Œå¦åˆ™å°±ä¼šç›´æ¥è¶…å‡º120sçš„é™åˆ¶ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">S = &#123;<span class="built_in">pow</span>(i,-e,n):i <span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">2</span>**<span class="number">20</span>))&#125;</span><br></pre></td></tr></table></figure>
<p>å› æ­¤ï¼Œæ€è·¯å°±æ˜¯ï¼šæ¥æ”¶åˆ°å…¬é’¥(nï¼Œe)åï¼Œå»ºç«‹ä¸€ä¸ªå¤§å°ä¸º2^20çš„å­—å…¸ï¼Œç„¶åå†è¿›è¡Œproof_of_workï¼Œè¿›è¡Œå®Œæ¯•åå¼€å§‹æŸ¥è¡¨ã€‚å¦‚æ­¤ä¸é¶æœºäº¤äº’å¤šæ¬¡åï¼Œå°±æœ‰å¤§æ¦‚ç‡å¾—åˆ°flagã€‚ç†è®ºä¸Šæ¥è¯´å…«æ¬¡å°±æœ‰å¤§äº50%çš„æ¦‚ç‡å¾—åˆ°flagäº†ï¼Œä¸è¿‡è¿æ°”ä¸å¥½ç¡®å®å¯èƒ½éœ€è¦å¾ˆä¹…å¾ˆä¹…ã€‚</p>
<p>ä½†åŒæ—¶ä½ ä¹Ÿå¯ä»¥æ³¨æ„åˆ°ï¼Œmå¹¶ä¸ä¸€å®šå°±æ˜¯32bitçš„æ•°ï¼Œä»–çš„å‰å‡ ä¸ªbitå®Œå…¨å¯èƒ½æ˜¯0ï¼Œå› æ­¤ç›¸ä¿¡è‡ªå·±è¿æ°”çš„è¯ï¼Œå¯ä»¥é€‚å½“ç¼©å°åˆ’åˆ†èŒƒå›´æ¥èŠ‚çœè€—æ—¶ï¼Œæ¯”å¦‚åˆ’åˆ†ä¸ºï¼š</p>
<script type="math/tex; mode=display">
i \in (0,2^{19}),j \in (0,2^{12})</script><script type="math/tex; mode=display">
i \in (0,2^{18}),j \in (0,2^{12})</script><p>ç­‰ç­‰ç¼©å°åçš„èŒƒå›´ï¼Œéƒ½æ˜¯æœ‰å¯èƒ½æˆåŠŸçš„ã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>():</span><br><span class="line">	table = string.digits + string.ascii_letters</span><br><span class="line">	r.recvuntil(<span class="string">b&quot;sha256(XXXX+&quot;</span>)</span><br><span class="line">	temp = r.recvline()</span><br><span class="line">	suffix = temp[:<span class="number">16</span>].decode()</span><br><span class="line">	hex1 = temp[<span class="number">20</span>:].strip().decode()</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> tqdm(table):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> table:</span><br><span class="line">			<span class="keyword">for</span> k <span class="keyword">in</span> table:</span><br><span class="line">				<span class="keyword">for</span> m <span class="keyword">in</span> table:</span><br><span class="line">					temp1 = i+j+k+m</span><br><span class="line">					<span class="keyword">if</span>(sha256((temp1+suffix).encode()).hexdigest() == hex1):</span><br><span class="line">						r.sendline(temp1.encode())</span><br><span class="line">						<span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">	r = remote(<span class="string">&quot;node5.anna.nssctf.cn&quot;</span>,<span class="number">28803</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#part1</span></span><br><span class="line">	r.recvline()</span><br><span class="line">	n = <span class="built_in">int</span>(r.recvline().strip()[<span class="number">3</span>:])</span><br><span class="line">	e = <span class="number">65537</span></span><br><span class="line">	S = &#123;<span class="built_in">pow</span>(i,-e,n):i <span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">2</span>**<span class="number">19</span>))&#125;</span><br><span class="line">	proof_of_work()</span><br><span class="line"></span><br><span class="line">	<span class="comment">#part2</span></span><br><span class="line">	secret = <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">		c = <span class="built_in">int</span>(r.recvline().split(<span class="string">b&#x27;=&#x27;</span>)[<span class="number">1</span>].strip())</span><br><span class="line">		inv_c = inverse(c,n)</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">2</span>**<span class="number">16</span>):</span><br><span class="line">			s = inv_c*(<span class="built_in">pow</span>(j,e,n))%n</span><br><span class="line">			<span class="keyword">if</span>(s <span class="keyword">in</span> S):</span><br><span class="line">				<span class="built_in">print</span>(i)</span><br><span class="line">				secret += <span class="built_in">hex</span>(S[s]*j)[<span class="number">2</span>:].zfill(<span class="number">8</span>)</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">	temp = r.recvline()</span><br><span class="line">	r.sendline(secret.encode())</span><br><span class="line">	temp = r.recvline()</span><br><span class="line">	<span class="built_in">print</span>(temp)</span><br><span class="line">	r.close()</span><br><span class="line">    </span><br><span class="line"><span class="comment">#flagæš‚æ—¶è¿˜æ²¡æœ‰ï¼Œé¶æœºæœ‰ä¸€ç‚¹å°é—®é¢˜</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="Lost-Modulus"><a href="#Lost-Modulus" class="headerlink" title="Lost Modulus"></a>Lost Modulus</h3><p>é¢˜ç›®æ¥æºï¼šSEETF 2022</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, long_to_bytes, bytes_to_long</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    FLAG = f.read()</span><br><span class="line"></span><br><span class="line">n = bytes_to_long(FLAG)</span><br><span class="line"></span><br><span class="line"><span class="comment">#make sure i have a big modulus</span></span><br><span class="line"><span class="keyword">while</span> n.bit_length() &lt; <span class="number">2048</span>:</span><br><span class="line">    n *= n</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m1, m2</span>):</span><br><span class="line">    e = getPrime(<span class="number">256</span>)</span><br><span class="line">    <span class="keyword">assert</span> m1.bit_length() &gt;= <span class="number">1600</span> <span class="keyword">and</span> long_to_bytes(m1).startswith(<span class="string">b&quot;SEE&#123;&quot;</span>), <span class="string">&#x27;first message must be at least 1600 bits and begin with &quot;SEE&#123;&quot;&#x27;</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="number">500</span> &lt;= m2.bit_length() &lt;= <span class="number">600</span>, <span class="string">&#x27;second message must be within 500 to 600 bits&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(m1, e, n), <span class="built_in">pow</span>(m2, e, n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        m1 = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Message 1 (as integer) : &quot;</span>).strip())</span><br><span class="line">        m2 = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Message 2 (as integer) : &quot;</span>).strip())</span><br><span class="line">        c1, c2 = encrypt(m1, m2)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\nCiphers: \n<span class="subst">&#123;[c1,c2]&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>æ¢³ç†ä¸€ä¸‹åŠ å¯†æµç¨‹ï¼š</p>
<ul>
<li>å°†flagè½¬ä¸ºå¤§æ•´æ•°nï¼Œåå¤ä¹˜æ–¹ç›´è‡³nå¤§äº2048bit</li>
<li>å…è®¸æˆ‘ä»¬è¾“å…¥ä¸¤ä¸ªæ•´æ•°m1ã€m2ï¼Œè¦æ±‚æ»¡è¶³ï¼š</li>
<li><ul>
<li>m1è½¬ä¸ºå­—èŠ‚ä¸²åè¦æ±‚ä»¥â€SEE{â€œå¼€å¤´ï¼Œå¹¶ä¸”å¤§äº1600bit</li>
<li>m2å¤§å°è¦åœ¨500-600bitä¹‹é—´</li>
</ul>
</li>
<li>éšæœºç”Ÿæˆä¸€ä¸ª256bitçš„ç´ æ•°eï¼Œå¹¶ä½¿ç”¨å…¬é’¥(n,e)å¯¹m1ã€m2åˆ†åˆ«è¿›è¡ŒRSAåŠ å¯†ï¼Œå¹¶ç»™å‡ºå¯†æ–‡</li>
</ul>
<p>é¢˜ç›®è¦æ±‚æˆ‘ä»¬æ¢å¤æ¨¡æ•°nï¼Œè€Œæœ‰å…³æ¨¡æ•°çš„æ¢å¤ä¸€èˆ¬éƒ½ä¼šç”¨åˆ°gcdã€‚å› æ­¤æœ¬é¢˜çš„å…³é”®å°±åœ¨äºå¦‚ä½•åˆ©ç”¨è¢«é™åˆ¶äº†çš„æ˜æ–‡m1ã€m2ï¼Œæ„é€ å‡ºæ¨¡æ•°nçš„å€æ•°ã€‚</p>
<p>é¦–å…ˆè§‚å¯Ÿåˆ°ï¼Œm1çš„äºŒè¿›åˆ¶é•¿åº¦å¯ä»¥ä¸ºm2çš„ä¸‰å€ä»¥ä¸Šï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç«‹æ–¹å…³ç³»è¿›è¡Œæ„é€ ã€‚è€Œå¦‚ä½•æ„é€ å‡ºm1æ°ä¸ºä¸€ä¸ªæ•°çš„3æ¬¡æ–¹ï¼Œå¹¶ä¸”å¼€å¤´è¿˜æ˜¯â€SEE{â€œå‘¢ï¼Ÿå¾ˆå®¹æ˜“ï¼Œåªéœ€è¦å…ˆæ„é€ å‡ºä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„m1ï¼Œç„¶åå¼€ç«‹æ–¹æ ¹ï¼Œå–æ•´ä½œä¸ºm2ï¼Œå†å–m2çš„ç«‹æ–¹ä½œä¸ºæ–°çš„m1å³å¯ã€‚è¿™æ˜¯å› ä¸ºï¼Œå¼€ç«‹æ–¹æ ¹ã€å–æ•´åå†ç«‹æ–¹å›æ¥ï¼Œå¯¹m1çš„å½±å“å‡åœ¨ä½ä½ï¼Œä¸ä¼šå½±å“åˆ°å…¶é«˜ä½çš„â€SEE{â€œ</p>
<p>æ‰€ä»¥æ­¤æ—¶æˆ‘ä»¬å°±æœ‰æ˜æ–‡å…³ç³»å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
m_1^e \equiv (m_2^3)^e \equiv c_1\quad (mod\;n)</script><script type="math/tex; mode=display">
m_2^e \equiv  c_2\quad (mod\;n)</script><p>æ‰€ä»¥æœ‰ï¼š</p>
<script type="math/tex; mode=display">
c_2^3-c_1 = kn</script><p>å› æ­¤å¤šè¿æ¥å‡ æ¬¡é¶æœºï¼Œå–å¤šç»„knåæ±‚è§£gcdï¼Œå°±èƒ½å»é™¤å°å› å­å¾—åˆ°nï¼Œå†çˆ†ç ´å…·ä½“æ˜¯mçš„å‡ æ¬¡æ–¹å³å¯ã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>():</span><br><span class="line">    m1 = bytes_to_long(<span class="string">b&quot;SEE&#123;&quot;</span> + os.urandom(<span class="number">200</span>))</span><br><span class="line">    m2 = iroot(m1,<span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line">    m1 = m2**<span class="number">3</span></span><br><span class="line">    <span class="keyword">return</span> (m1,m2)</span><br><span class="line"></span><br><span class="line">kn = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    r = remote(<span class="string">&quot;node4.anna.nssctf.cn&quot;</span>,<span class="number">28625</span>)</span><br><span class="line">    m1,m2 = gen()</span><br><span class="line">    temp = r.recvuntil(<span class="string">b&quot;Message 1 (as integer) : &quot;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(m1).encode())</span><br><span class="line">    temp = r.recvuntil(<span class="string">b&quot;Message 2 (as integer) : &quot;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(m2).encode())</span><br><span class="line">    temp = r.recvuntil(<span class="string">b&quot;Ciphers:&quot;</span>)</span><br><span class="line">    c = <span class="built_in">eval</span>(r.recvuntil(<span class="string">&quot;]&quot;</span>).decode())</span><br><span class="line">    c1 = c[<span class="number">0</span>]</span><br><span class="line">    c2 = c[<span class="number">1</span>]</span><br><span class="line">    kn.append(c2**<span class="number">3</span>-c1)</span><br><span class="line">    r.close()</span><br><span class="line">n = kn[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> kn[<span class="number">1</span>:]:</span><br><span class="line">    n = GCD(n,i)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">if</span>(iroot(n,i)[<span class="number">1</span>] == <span class="literal">True</span>):</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(iroot(n,i)[<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment">#NSSCTF&#123;1affebef-9c23-45f1-b88e-406f9611c614&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="welcomesigner2"><a href="#welcomesigner2" class="headerlink" title="welcomesigner2"></a>welcomesigner2</h3><p>é¢˜ç›®æ¥æºï¼šWMCTF 2023</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;***********************************&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">message</span>):</span><br><span class="line">    <span class="keyword">return</span> message + <span class="string">b&quot;\x00&quot;</span>*((<span class="number">16</span>-<span class="built_in">len</span>(message)%<span class="number">16</span>)%<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">myfastexp</span>(<span class="params">m,d,N,j,N_</span>):</span><br><span class="line">    A = <span class="number">1</span></span><br><span class="line">    B = m</span><br><span class="line">    d = <span class="built_in">bin</span>(d)[<span class="number">2</span>:][::-<span class="number">1</span>]</span><br><span class="line">    n = <span class="built_in">len</span>(d)</span><br><span class="line">    N = N</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        <span class="keyword">if</span> d[i] == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            A = A * B % N</span><br><span class="line">        <span class="comment">#  a fault occurs j steps before the end of the exponentiation</span></span><br><span class="line">        <span class="keyword">if</span> i &gt;= n-<span class="number">1</span>-j:</span><br><span class="line">            N = N_</span><br><span class="line">        B = B**<span class="number">2</span> % N</span><br><span class="line">    <span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">message,key</span>):</span><br><span class="line">    key = <span class="built_in">bytes</span>.fromhex(md5(<span class="built_in">str</span>(key).encode()).hexdigest())</span><br><span class="line">    enc = AES.new(key,mode=AES.MODE_ECB)</span><br><span class="line">    c   = enc.encrypt(pad(message))</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">border = <span class="string">&quot;|&quot;</span></span><br><span class="line"><span class="built_in">print</span>(border*<span class="number">75</span>)</span><br><span class="line"><span class="built_in">print</span>(border, <span class="string">&quot;Hi all, I have another algorithm that can quickly calculate powers. &quot;</span>, border)</span><br><span class="line"><span class="built_in">print</span>(border, <span class="string">&quot;But still there&#x27;s something wrong with it. Your task is to get      &quot;</span>, border)</span><br><span class="line"><span class="built_in">print</span>(border, <span class="string">&quot;its private key,and decrypt the cipher to cat the flag ^-^          &quot;</span>, border)</span><br><span class="line"><span class="built_in">print</span>(border*<span class="number">75</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"><span class="comment"># generate</span></span><br><span class="line">    p = getPrime(<span class="number">512</span>)</span><br><span class="line">    q = getPrime(<span class="number">512</span>)</span><br><span class="line">    n = p*q</span><br><span class="line">    e = <span class="number">17</span></span><br><span class="line">    <span class="keyword">if</span> GCD(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>)) == <span class="number">1</span>:</span><br><span class="line">        d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">        n_ = n </span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">n_ = n</span><br><span class="line">msg = bytes_to_long(<span class="string">b&quot;Welcome_come_to_WMCTF&quot;</span>)</span><br><span class="line">sig = <span class="built_in">pow</span>(msg,d,n)</span><br><span class="line"><span class="keyword">assert</span> sig == myfastexp(msg,d,n,<span class="number">0</span>,n_)</span><br><span class="line">CHANGE = <span class="literal">True</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        ans = <span class="built_in">input</span>(<span class="string">&quot;| Options: \n|\t[G]et data \n|\t[S]ignatrue \n|\t[F]ault injection \n|\t[Q]uit\n&quot;</span>).lower().strip()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> ans == <span class="string">&#x27;f&#x27;</span>:</span><br><span class="line">            <span class="keyword">if</span> CHANGE:</span><br><span class="line">                <span class="built_in">print</span>(border,<span class="string">&quot;You have one chance to change one byte of N. &quot;</span>)</span><br><span class="line">                temp,index = <span class="built_in">input</span>(<span class="string">&quot;bytes, and index:&quot;</span>).strip().split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">                <span class="keyword">assert</span> <span class="number">0</span>&lt;= <span class="built_in">int</span>(temp) &lt;=<span class="number">255</span></span><br><span class="line">                <span class="keyword">assert</span> <span class="number">0</span>&lt;= <span class="built_in">int</span>(index) &lt;= <span class="number">1023</span> </span><br><span class="line">                n_ = n ^ (<span class="built_in">int</span>(temp)&lt;&lt;<span class="built_in">int</span>(index))</span><br><span class="line">                <span class="built_in">print</span>(border,<span class="string">f&quot;[+] update: n_ -&gt; \&quot;<span class="subst">&#123;n_&#125;</span>\&quot;&quot;</span>)</span><br><span class="line">                CHANGE = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(border,<span class="string">&quot;Greedy...&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> ans == <span class="string">&#x27;g&#x27;</span>:</span><br><span class="line">            <span class="built_in">print</span>(border,<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(border,<span class="string">f&quot;flag_ciphertext = <span class="subst">&#123;encrypt(flag,d).<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> ans == <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">            index = <span class="built_in">input</span>(<span class="string">&quot;Where your want to interfere:&quot;</span>).strip()</span><br><span class="line">            sig_ = myfastexp(msg,d,n,<span class="built_in">int</span>(index),n_)</span><br><span class="line">            <span class="built_in">print</span>(border,<span class="string">f&quot;signature of \&quot;Welcome_come_to_WMCTF\&quot; is <span class="subst">&#123;sig_&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> ans == <span class="string">&#x27;q&#x27;</span>:</span><br><span class="line">            quit()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(border,<span class="string">&quot;Err...&quot;</span>)</span><br><span class="line">        quit()</span><br></pre></td></tr></table></figure>
<p>æˆ‘è§‰å¾—å¾ˆæœ‰æ„æ€çš„ä¸€ä¸ªé”™è¯¯æ³¨å…¥é¢˜ç›®ï¼Œåœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹æ€è·¯ã€‚</p>
<p>é¦–å…ˆæ¢³ç†é¢˜ç›®ä»»åŠ¡ï¼Œåœ¨è¿æ¥ä¸Šé¶æœºåï¼Œé¢˜ç›®éšæœºç”Ÿæˆé•¿åº¦ä¸º512æ¯”ç‰¹çš„ç´ æ•°pã€qï¼Œå¹¶ä»¥pã€qã€e=17ç”ŸæˆRSAåŠ è§£å¯†çš„å‰©ä½™å‚æ•°nã€dã€‚åŒæ—¶ç”Ÿæˆä¸€ä¸ªn_ï¼Œåœ¨å¼€å§‹æ—¶å…¶å€¼ä¸nç›¸ç­‰ã€‚</p>
<p>ç„¶åï¼Œé¢˜ç›®ä»¥ä¸€ä¸ªå·²çŸ¥çš„msgè®¡ç®—äº†å…¶æ­£ç¡®è§£å¯†å€¼pow(msg,d,n)ä½œä¸ºsigï¼Œç„¶åè¿›å…¥äº¤äº’ç¯èŠ‚ã€‚</p>
<p>é¶æœºæä¾›çš„æ“ä½œæœ‰:</p>
<ul>
<li>è¾“å…¥â€fâ€ï¼Œå¯ä»¥æ›´æ”¹æ¨¡æ•°nçš„ä»»æ„8æ¯”ç‰¹ä¸ºè‡ªå®šä¹‰å€¼ï¼Œå¹¶ä¸”è¯¥æ“ä½œåœ¨å…¨ç¨‹ä»…èƒ½è¿›è¡Œä¸€æ¬¡</li>
<li>è¾“å…¥â€gâ€ï¼Œå¯ä»¥è·å¾—æ­£ç¡®çš„åˆå§‹æ¨¡æ•°nï¼Œå¹¶è·å¾—AESåŠ å¯†åçš„flagå€¼ï¼Œå…¶ä¸­AESçš„å¯†é’¥ä¸ºç§é’¥d</li>
<li>è¾“å…¥â€sâ€ï¼Œå¯ä»¥æŒ‡å®šä½ç½®è¿›è¡Œä¸€æ¬¡é”™è¯¯æ³¨å…¥ï¼Œé”™è¯¯æ³¨å…¥å…·ä½“æ˜¯æ€æ ·çš„ç¨åè®²</li>
<li>è¾“å…¥â€qâ€ï¼Œé€€å‡ºäº¤äº’</li>
</ul>
<p>æ‰€ä»¥æˆ‘ä»¬è¦å®Œæˆçš„ä»»åŠ¡æ˜¯ï¼šæ”¹å˜nçš„æŸ8ä¸ªæ¯”ç‰¹ï¼Œä½¿å…¶æ›´å®¹æ˜“è¢«æˆ‘ä»¬åˆ©ç”¨ï¼›å¹¶ä½¿ç”¨é¢˜ç›®æä¾›çš„é”™è¯¯æ³¨å…¥æ“ä½œè¿˜åŸç§é’¥dï¼Œä¹‹åAESè§£å¯†å¯†æ–‡ã€‚</p>
<p>é‚£ä¹ˆä¸»è¦é—®é¢˜å°±æœ‰ä¸¤ä¸ªï¼š</p>
<ul>
<li>å¦‚ä½•æ”¹å˜nï¼Ÿ</li>
<li>å¦‚ä½•åˆ©ç”¨é”™è¯¯æ³¨å…¥è¿˜åŸdï¼Ÿ</li>
</ul>
<p>æ¥ä¸‹æ¥å°±å¼€å§‹é¢˜ç›®åˆ†æã€‚é¦–å…ˆä¼šä»‹ç»ä¸€ç‚¹å‰ç½®çŸ¥è¯†ã€‚</p>
<h4 id="å¿«é€Ÿå¹‚"><a href="#å¿«é€Ÿå¹‚" class="headerlink" title="å¿«é€Ÿå¹‚"></a>å¿«é€Ÿå¹‚</h4><p>é¢˜ç›®æä¾›çš„é”™è¯¯æ³¨å…¥å°±æ˜¯åŸºäºå¿«é€Ÿå¹‚çš„ï¼Œå› æ­¤è¦å®Œæˆé¢˜ç›®å…ˆè¦çŸ¥é“å¿«é€Ÿå¹‚çš„åŸºæœ¬åŸç†ã€‚</p>
<p>é¦–å…ˆï¼Œå¦‚æœæŒ‰æ­£å¸¸æ€è·¯è¿›è¡Œæ¨¡å¹‚è¿ç®—ï¼Œé‚£ä¹ˆå¦‚æœè¦è®¡ç®—pow(c,d,n)ï¼Œå°±éœ€è¦å…ˆä»¤m = cï¼Œç„¶åè¿›è¡Œdæ¬¡ä¸‹åˆ—è¿ç®—ï¼š</p>
<script type="math/tex; mode=display">
m = m*c \quad (mod\; n)</script><p>è€Œå¦‚æœdçš„æ•°é‡çº§è¾ƒå¤§ï¼Œè¿™ç§è¿ç®—çš„æ•ˆç‡æ˜¯ä¸å¯æ¥å—çš„ï¼Œå› æ­¤éœ€è¦åº”ç”¨å¿«é€Ÿå¹‚ã€‚</p>
<p>å¿«é€Ÿå¹‚çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šå…ˆæŠŠå¹‚æ¬¡è½¬ä¸ºäºŒè¿›åˆ¶è¡¨ç¤ºï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä¸¾ä¸ªç®€å•ä¾‹å­ï¼Œå‡è®¾d = 23ï¼Œé‚£ä¹ˆå°±æœ‰å…¶äºŒè¿›åˆ¶ä¸ºï¼š</p>
<script type="math/tex; mode=display">
bin(d) = 10111</script><p>è€Œcçš„dæ¬¡æ–¹æ¨¡nå…¶å®å°±å¯ä»¥åˆ©ç”¨äºŒè¿›åˆ¶è½¬åŒ–ä¸ºå¦‚ä¸‹è¿ç®—ï¼š</p>
<script type="math/tex; mode=display">
m = (1*c) * (1*c^2) * (1*c^{2^2}) * (0*c^{2^3}) * (1*c^{2^4}) \quad(mod\;n)</script><p>å…¶ä¸­ï¼Œæ¯ä¸€é¡¹çš„ç³»æ•°æ˜¯dçš„äºŒè¿›åˆ¶é€†è¿‡æ¥åå¯¹åº”ä½ç½®çš„å€¼ï¼Œä¹˜æ•°æ˜¯cçš„å¯¹åº”æ¬¡å¹³æ–¹ã€‚è¿™æ ·åšä¸ºä»€ä¹ˆå‡å°‘äº†æ¬¡æ•°å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºcçš„å¯¹åº”æ¬¡å¹³æ–¹ï¼Œåªéœ€è¦åœ¨å‰ä¸€ä¸ªcçš„å¯¹åº”æ¬¡å¹³æ–¹çš„åŸºç¡€ä¸Šå†åšä¸€æ¬¡å¹³æ–¹å°±å¥½ã€‚å› æ­¤ï¼Œç”¨å¿«é€Ÿå¹‚å¯ä»¥æŠŠæ¨¡å¹‚è¿ç®—çš„å¤æ‚åº¦å‡å°‘åˆ°lognçš„æ•°é‡çº§ã€‚å…¶ä»£ç å½¢å¼ç”¨ç›´è§‚ä¸€ç‚¹çš„æ–¹å¼å®ç°å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">myfastexp</span>(<span class="params">c,d,n</span>):</span><br><span class="line">    d = <span class="built_in">bin</span>(d)[<span class="number">2</span>:][::-<span class="number">1</span>]</span><br><span class="line">    m = [c]</span><br><span class="line">    temp = c</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(d)-<span class="number">1</span>):</span><br><span class="line">        temp = temp ** <span class="number">2</span> % n</span><br><span class="line">        m.append(temp)</span><br><span class="line">    final = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(d)):</span><br><span class="line">        <span class="keyword">if</span>(d[i] == <span class="string">&quot;1&quot;</span>):</span><br><span class="line">            final = final * m[i] % n</span><br><span class="line">    <span class="keyword">return</span> final</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªå‡½æ•°ä¸­mæ•°ç»„å­˜æ”¾cçš„å„æ¬¡å¹³æ–¹çš„æ•°å€¼ï¼Œç„¶åä¸bçš„äºŒè¿›åˆ¶é€†åºå¯¹åº”ç›¸ä¹˜ï¼Œæœ€ç»ˆè¿”å›pow(c,d,n)çš„è®¡ç®—å€¼ï¼Œä¸æˆ‘ä»¬åˆšæ‰è¯´çš„è¿‡ç¨‹å®Œå…¨ç›¸åŒã€‚è€Œæ›´ä¸€èˆ¬çš„ï¼Œä¼šå†™æˆå¦‚ä¸‹å½¢å¼ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">normal_fastexp</span>(<span class="params">c,d,n</span>):</span><br><span class="line">    d = <span class="built_in">bin</span>(d)[<span class="number">2</span>:][::-<span class="number">1</span>]</span><br><span class="line">    final = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(d)):</span><br><span class="line">        <span class="keyword">if</span>(d[i] == <span class="string">&quot;1&quot;</span>):</span><br><span class="line">            final = final * c % n</span><br><span class="line">        c = c**<span class="number">2</span> % n</span><br><span class="line">    <span class="keyword">return</span> final</span><br></pre></td></tr></table></figure>
<p>åªæ˜¯ç²¾ç®€äº†ä»£ç ï¼Œå®é™…è¿›è¡Œçš„æ“ä½œä¾ç„¶æ˜¯å®Œå…¨ç›¸åŒçš„ã€‚</p>
<h4 id="é”™è¯¯æ³¨å…¥"><a href="#é”™è¯¯æ³¨å…¥" class="headerlink" title="é”™è¯¯æ³¨å…¥"></a>é”™è¯¯æ³¨å…¥</h4><p>äº†è§£äº†å¿«é€Ÿå¹‚åï¼Œå†æ¥çœ‹é¢˜ç›®æä¾›çš„é”™è¯¯æ³¨å…¥ä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">myfastexp</span>(<span class="params">m,d,N,j,N_</span>):</span><br><span class="line">    A = <span class="number">1</span></span><br><span class="line">    B = m</span><br><span class="line">    d = <span class="built_in">bin</span>(d)[<span class="number">2</span>:][::-<span class="number">1</span>]</span><br><span class="line">    n = <span class="built_in">len</span>(d)</span><br><span class="line">    N = N</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        <span class="keyword">if</span> d[i] == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            A = A * B % N</span><br><span class="line">        <span class="comment">#  a fault occurs j steps before the end of the exponentiation</span></span><br><span class="line">        <span class="keyword">if</span> i &gt;= n-<span class="number">1</span>-j:</span><br><span class="line">            N = N_</span><br><span class="line">        B = B**<span class="number">2</span> % N</span><br><span class="line">    <span class="keyword">return</span> A</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬å¯ä»¥æä¾›ä¸€ä¸ªé”™è¯¯æ³¨å…¥ä½ç½®ï¼Œåœ¨å¿«é€Ÿå¹‚è¿ç®—åˆ°é”™è¯¯æ³¨å…¥ä½ç½®ä¹‹å‰ï¼Œå…¶æ¨¡æ•°æ˜¯æ­£ç¡®çš„nï¼›è€Œå¿«é€Ÿå¹‚è¿ç®—åˆ°é”™è¯¯æ³¨å…¥ä½ç½®çš„æ—¶å€™ï¼Œæ¨¡æ•°ä¼šæ”¹å˜ä¸ºæˆ‘ä»¬æ”¹å˜äº†ä¸€ä¸ªå­—èŠ‚çš„n_ï¼Œå¹¶ä¸”åœ¨ä¹‹åéƒ½æŒ‰ç…§è¿™ä¸ªè¢«æ”¹å˜çš„æ¨¡æ•°è¿›è¡Œå¿«é€Ÿå¹‚ã€‚</p>
<p>æˆ‘ä»¬å‡è®¾dä¸º1023æ¯”ç‰¹ï¼Œå…¶äºŒè¿›åˆ¶åºåˆ—ä¸º1xxxâ€¦xxxxï¼Œæˆ‘ä»¬å½“å‰æä¾›çš„æ³¨å…¥ä½ç½®æ˜¯0ï¼Œæˆ‘ä»¬ç”»ä¸€ä¸‹é¢˜ç›®çš„é”™è¯¯æ³¨å…¥å¦‚ä½•å¾—åˆ°ç»“æœï¼š</p>
<p><img src="/post/601c0957/image-20231019160100082.png" alt="image-20231019160100082"></p>
<p>æ³¨æ„åˆ°åˆ°é”™è¯¯æ³¨å…¥ä½ç½®æ—¶ï¼Œé¢˜ç›®çš„å¿«é€Ÿå¹‚ä»ç„¶æ˜¯å…ˆè®¡ç®—ä¹˜ï¼Œå†æ”¹å˜æ¨¡æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ³¨å…¥ä½ç½®ä¸º0æ—¶ï¼Œæœ€åçš„ç»“æœå…¶å®æ˜¯æ­£ç¡®ç»“æœã€‚è€Œå›¾ä¸­çš„çº¢è‰²éƒ¨åˆ†å°±æ˜¯ç”±äºé”™è¯¯æ³¨å…¥ã€æ¨¡æ•°æ”¹å˜å¯¼è‡´çš„mçš„å¯¹åº”æ¬¡æ–¹å¹‚è®¡ç®—é”™è¯¯ï¼Œåœ¨è¿™é‡Œï¼Œçº¢è‰²éƒ¨åˆ†ç­‰äºï¼š</p>
<script type="math/tex; mode=display">
(m^{2^{1021}})^2 \quad (mod\;n')</script><p>nâ€™å°±æ˜¯n_ï¼Œå› ä¸ºæˆ‘çš„hexoè½¬ä¹‰æœ‰é—®é¢˜ï¼Œå…¬å¼å—é‡Œä¸€ç›´æ‰“ä¸å‡ºä¸‹åˆ’çº¿ï¼Œæ‰€ä»¥ç”¨nâ€™ä»£æ›¿ã€‚</p>
<p>é‚£ä¹ˆå½“æ³¨å…¥ä½ç½®æ˜¯1æ—¶ï¼Œå¾—åˆ°çš„ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="/post/601c0957/image-20231019160120731.png" alt="image-20231019160120731"></p>
<p>æ­¤æ—¶å¯ä»¥å‘ç°ï¼Œåœ¨è®¡ç®—æœ€åä¸€æ¬¡å¿«é€Ÿå¹‚çš„ç»“æœæ—¶ï¼Œæˆ‘ä»¬é”™è¯¯çš„ä½¿ç”¨äº†n_è€Œénä¸‹çš„må¯¹åº”æ¬¡æ–¹ï¼Œå› æ­¤ç»“æœäº§ç”Ÿäº†é”™è¯¯ã€‚è€Œè¿™ä¸ªé”™è¯¯ç»“æœå¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼ï¼š</p>
<script type="math/tex; mode=display">
sig' = fault * right</script><p>rightæŒ‡å¿«é€Ÿå¹‚åœ¨æ³¨å…¥ä½ç½®åŠä¹‹å‰çš„æ­£ç¡®ç»“æœï¼ŒfaultæŒ‡åœ¨æ³¨å…¥ä½ç½®ä¹‹åçš„é”™è¯¯ç»“æœï¼Œä»–ä»¬æ˜¯å¯ä»¥ä»¥ä¹˜ç§¯å½¢å¼ä½“ç°åœ¨æœ€ç»ˆç»“æœé‡Œçš„ã€‚æˆ‘ä»¬ä»¥æ­¤ä¸ºä¾æ®æŠŠdçš„äºŒè¿›åˆ¶ä¸²åˆ†ä¸ºé«˜ä½dhighå’Œä½ä½dlowï¼Œåˆ™rightç­‰äºï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">pow</span>(m,<span class="built_in">int</span>(dlow,<span class="number">2</span>),n)</span><br></pre></td></tr></table></figure>
<p>faultç­‰äºï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">pow</span>(Bad,<span class="built_in">int</span>(dhigh,<span class="number">2</span>),n_)</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼ŒBadå°±æ˜¯ç”±äºé”™è¯¯æ³¨å…¥äº§ç”Ÿçš„é”™è¯¯mçš„å¯¹åº”æ¬¡æ–¹å¹‚ï¼Œä¹Ÿå°±æ˜¯å€’æ•°ç¬¬äºŒä¸ªçº¢è‰²å—çš„æ¨¡nâ€™ä¸‹çš„å¹³æ–¹ã€‚è€Œè¿™ä¸ªå€¼æ˜¯å¯ä»¥è®¡ç®—å‡ºæ¥çš„ï¼Œå› ä¸ºæˆ‘ä»¬æ‹¥æœ‰dçš„é«˜ä½1ã€nâ€™ä»¥åŠmï¼›è€Œæˆ‘ä»¬åˆæ‹¥æœ‰é¶æœºè¿”å›çš„sigâ€™ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç”¨ä¹‹å‰çš„ç­‰å¼è®¡ç®—å‡ºrightåœ¨æ¨¡nä¸‹çš„å€¼ã€‚</p>
<p>ç”¨å¤„åœ¨å“ªé‡Œå‘¢ï¼Ÿæˆ‘ä»¬ç»§ç»­å¾€åæ¨è¿›ä¸€ä½ï¼š</p>
<p><img src="/post/601c0957/image-20231019160254754.png" alt="image-20231019160254754"></p>
<p>é‚£ä¹ˆå‡è®¾dçš„ç¬¬äºŒé«˜ä½ä¸º0ï¼Œé‚£ä¹ˆå°±æœ‰ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">int</span>(dhigh,<span class="number">2</span>) = <span class="number">2</span>*<span class="built_in">int</span>(dhigh,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">int</span>(dlow,<span class="number">2</span>) = <span class="built_in">int</span>(dlow,<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆç”±äºdlowä¸å˜ï¼Œæ‰€ä»¥è¿™ä¸€æ¬¡æˆ‘ä»¬è®¡ç®—å‡ºçš„rightåº”è¯¥ä¸å‰ä¸€æ¬¡ç›¸ç­‰ï¼Œè€Œå¦‚æœä¸ç­‰ï¼Œå°±è¯´æ˜dçš„ç¬¬äºŒé«˜ä½ä¸º1.</p>
<p>ä»¥æ­¤ç±»æ¨ï¼Œæˆ‘ä»¬å°±èƒ½è¿˜åŸå‡ºdçš„æ‰€æœ‰äºŒè¿›åˆ¶ä½ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œdä¸ä¸€å®šæ˜¯1023ä½ï¼Œå› æ­¤å¯èƒ½éœ€è¦å¤šæ¬¡è¿æ¥é¶æœºï¼Œç›´åˆ°éšæœºåˆ°æŸæ¬¡dæ˜¯1023ä½æ—¶æ‰èƒ½æ­£ç¡®è§£å¯†ã€‚è€Œä¹‹æ‰€ä»¥é€‰æ‹©1023ï¼Œæ˜¯å› ä¸ºæµ‹è¯•ä¸‹æ¥dæ˜¯1023æ¯”ç‰¹æ¦‚ç‡æœ€å¤§ï¼Œèƒ½è¾¾åˆ°40%å·¦å³ï¼Œå› æ­¤æˆåŠŸç‡æœ€å¤§ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">message,key</span>):</span><br><span class="line">    key = <span class="built_in">bytes</span>.fromhex(md5(<span class="built_in">str</span>(key).encode()).hexdigest())</span><br><span class="line">    enc = AES.new(key,mode=AES.MODE_ECB)</span><br><span class="line">    c   = enc.decrypt(message)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    r = remote(<span class="string">&quot;node5.anna.nssctf.cn&quot;</span>,<span class="number">28015</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">#part1 get c,n</span></span><br><span class="line">    r.recvuntil(<span class="string">b&quot;[Q]uit&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">b&quot;g&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;n =&quot;</span>)</span><br><span class="line">    n = <span class="built_in">int</span>(r.recvline().strip().decode())</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;flag_ciphertext =&quot;</span>)</span><br><span class="line">    c = long_to_bytes(<span class="built_in">int</span>(r.recvline().strip().decode(),<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">#part2 get n_</span></span><br><span class="line">    change_byte = <span class="number">0</span></span><br><span class="line">    ind = <span class="number">0</span></span><br><span class="line">    find = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> temp <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">if</span>(find):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">for</span> index <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1024</span>):</span><br><span class="line">            n_ = n ^ (temp&lt;&lt;index)</span><br><span class="line">            <span class="keyword">if</span> isPrime(n_):</span><br><span class="line">                change_byte = temp</span><br><span class="line">                ind = index</span><br><span class="line">                find = <span class="number">1</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    sendnum = <span class="built_in">str</span>(change_byte) + <span class="string">&quot;,&quot;</span> + <span class="built_in">str</span>(ind)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;[Q]uit&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">b&quot;f&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;and index:&quot;</span>)</span><br><span class="line">    r.sendline(sendnum.encode())</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;n_ -&gt; &quot;</span>)</span><br><span class="line">    n_ = <span class="built_in">int</span>(r.recvline().strip().decode()[<span class="number">1</span>:-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">#part3 get d</span></span><br><span class="line">    len_d = <span class="number">1023</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getm</span>(<span class="params">m,n,n_</span>):</span><br><span class="line">        final = []</span><br><span class="line">        c = m</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(len_d):</span><br><span class="line">            final.append(c)</span><br><span class="line">            c = c**<span class="number">2</span> % n</span><br><span class="line">        <span class="keyword">return</span> final</span><br><span class="line">    msg = bytes_to_long(<span class="string">b&quot;Welcome_come_to_WMCTF&quot;</span>)</span><br><span class="line">    m = getm(msg,n,n_)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getd</span>(<span class="params">d,siglist,n_,m</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">1</span>,len_d-<span class="number">1</span>):</span><br><span class="line">            current = siglist[i]</span><br><span class="line">            inv_Bad = inverse(<span class="built_in">pow</span>(m[len_d-<span class="number">1</span>-i]**<span class="number">2</span>%n_,<span class="built_in">int</span>(d,<span class="number">2</span>),n_),n_)</span><br><span class="line">            cur = current * inv_Bad % n_</span><br><span class="line">            </span><br><span class="line">            nextsig = siglist[i+<span class="number">1</span>]</span><br><span class="line">            next_inv_Bad = inverse(<span class="built_in">pow</span>(m[len_d-<span class="number">2</span>-i]**<span class="number">2</span>%n_,<span class="number">2</span>*<span class="built_in">int</span>(d,<span class="number">2</span>),n_),n_)</span><br><span class="line">            inv_next = nextsig * next_inv_Bad % n_</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(inv_next == cur):</span><br><span class="line">                d += <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                d += <span class="string">&quot;1&quot;</span></span><br><span class="line">        <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line">    siglist = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> trange(len_d):</span><br><span class="line">        r.recvuntil(<span class="string">b&quot;[Q]uit&quot;</span>)</span><br><span class="line">        r.sendline(<span class="string">b&quot;s&quot;</span>)</span><br><span class="line">        r.recvuntil(<span class="string">b&quot;interfere:&quot;</span>)</span><br><span class="line">        index = i</span><br><span class="line">        r.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">        r.recvuntil(<span class="string">b&quot; is &quot;</span>)</span><br><span class="line">        sig_ = <span class="built_in">int</span>(r.recvline().strip().decode())</span><br><span class="line">        siglist.append(sig_)</span><br><span class="line"></span><br><span class="line">    init_d = <span class="string">&quot;1&quot;</span></span><br><span class="line">    d = getd(init_d,siglist,n_,m) + <span class="string">&quot;1&quot;</span></span><br><span class="line">    d = <span class="built_in">int</span>(d,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">#part4 getflag</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="string">b&quot;NSSCTF&quot;</span> <span class="keyword">in</span> decrypt(c,d)):</span><br><span class="line">        <span class="built_in">print</span>(decrypt(c,d))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    r.close()</span><br><span class="line"></span><br><span class="line"><span class="comment">#NSSCTF&#123;f89d3e5c-138b-4d6d-8da9-cbe1a9dad5cd&#125;</span></span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œé€‰æ‹©ä¸€ä¸ªç´ æ•°n_æ˜¯ä¸ºäº†ä¿è¯è®¡ç®—å‡ºé€†å…ƒã€‚</p>
<p>è€Œå¦ä¸€é“WMCTFçš„welcomesigner1ï¼Œå…¶å®ä¹Ÿæ˜¯å¼‚æ›²åŒå·¥ï¼Œå˜åŒ–éå¸¸å°ï¼Œå¯ä»¥å°è¯•ç»ƒä¹ ã€‚</p>
<p><br></p>
<p><br></p>
<h3 id="signature"><a href="#signature" class="headerlink" title="signature"></a>signature</h3><p>é¢˜ç›®æ¥æºï¼šEIS 2019</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">b2n</span>(<span class="params">b</span>):</span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> b:</span><br><span class="line">        res *= <span class="number">2</span></span><br><span class="line">        res += i</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">n2b</span>(<span class="params">n, length</span>):</span><br><span class="line">    tmp = <span class="built_in">bin</span>(n)[<span class="number">2</span>:]</span><br><span class="line">    tmp = <span class="string">&#x27;0&#x27;</span>*(length-<span class="built_in">len</span>(tmp)) + tmp</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> tmp]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s2n</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(binascii.hexlify(s), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">msg</span>):</span><br><span class="line">    msg = n2b(s2n(msg), <span class="built_in">len</span>(msg)*<span class="number">8</span>)</span><br><span class="line">    msg += b1</span><br><span class="line">    <span class="keyword">for</span> shift <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(msg)-<span class="number">64</span>):</span><br><span class="line">        <span class="keyword">if</span> msg[shift]:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65</span>):</span><br><span class="line">                msg[shift+i] ^= b2[i]</span><br><span class="line">    res = msg[-<span class="number">64</span>:]</span><br><span class="line">    <span class="keyword">return</span> b2n(res)</span><br><span class="line"></span><br><span class="line">b1 = n2b(<span class="number">0xdeadbeeffeedcafe</span>, <span class="number">64</span>)</span><br><span class="line">b2  = n2b(<span class="number">0x10000000247f43cb7</span>, <span class="number">65</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    signal.alarm(<span class="number">60</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;/home/ctf/flag&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        flag = f.read()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Welcome to the Signature Challenge!&quot;</span>)</span><br><span class="line">        raw = os.urandom(<span class="number">256</span>)</span><br><span class="line">        pos = random.randint(<span class="number">0</span>, <span class="number">248</span>)</span><br><span class="line">        raw_hex = <span class="built_in">bytearray</span>(binascii.hexlify(raw))</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            raw_hex[(pos+i)*<span class="number">2</span>] = <span class="built_in">ord</span>(<span class="string">&#x27;_&#x27;</span>)</span><br><span class="line">            raw_hex[(pos+i)*<span class="number">2</span>+<span class="number">1</span>] = <span class="built_in">ord</span>(<span class="string">&#x27;_&#x27;</span>)</span><br><span class="line">        raw_hex = <span class="built_in">bytes</span>(raw_hex)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Here is the message: <span class="subst">&#123;raw_hex.decode(<span class="string">&#x27;ascii&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">        ans = <span class="built_in">input</span>(<span class="string">&quot;Please fill the blank: &quot;</span>)</span><br><span class="line">        ans = <span class="built_in">bytes</span>.fromhex(ans)</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(ans) == <span class="number">8</span></span><br><span class="line"></span><br><span class="line">        raw = <span class="built_in">bytearray</span>(raw)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            raw[pos+i] = ans[i]</span><br><span class="line">        raw = <span class="built_in">bytes</span>(raw)</span><br><span class="line">        <span class="keyword">if</span> sign(raw) == <span class="number">0x1337733173311337</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Great! Here is your flag: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Wrong! Bye~&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Error!&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®çš„å‰å‡ ä¸ªå‡½æ•°æ— éå°±æ˜¯å­—èŠ‚æµä¸æ•°å­—ã€æ•°å­—ä¸äºŒè¿›åˆ¶ã€äºŒè¿›åˆ¶ä¸åˆ—è¡¨çš„è½¬åŒ–ï¼Œç¨å¾®çœ‹çœ‹ä¼ é€’å‚æ•°ä»¥åŠè¿”å›å€¼å°±å¥½ã€‚æ¥ä¸‹æ¥ä¸»è¦åˆ†æé¢˜ç›®ä»»åŠ¡ï¼š</p>
<ul>
<li>è¿æ¥ä¸Šé¶æœºåï¼Œå¼€å§‹é™æ—¶60s</li>
<li>é¶æœºéšæœºç”Ÿæˆ256å­—èŠ‚rawï¼Œå¹¶å°†å…¶è½¬ä¸º16è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œç„¶åéšæœºç”Ÿæˆä¸€ä¸ª0-248çš„ä½ç½®pos</li>
<li>å°†16è¿›åˆ¶ä¸²ä¸­ä»¥poså¼€å¤´çš„è¿ç»­åå…­ä¸ªå­—ç¬¦ä»¥â€_â€ä»£æ›¿ï¼Œç›¸å½“äºæŠ¹æ‰äº†åå…­ä¸ªåå…­è¿›åˆ¶å­—ç¬¦</li>
<li>é¶æœºå‘é€æŠ¹æ‰åçš„åå…­è¿›åˆ¶ä¸²ç»™æˆ‘ä»¬ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æŠ¹æ‰çš„ä½ç½®å¡«å……ä¸Š16ä¸ªåå…­è¿›åˆ¶å­—ç¬¦</li>
<li>é¶æœºä¼šå°†ç»æˆ‘ä»¬å¡«å……åçš„åå…­è¿›åˆ¶ä¸²è½¬åŒ–ä¸ºå­—èŠ‚ï¼Œå¹¶è¿›è¡Œsignæ“ä½œï¼Œå¦‚æœsignæ“ä½œå¾—åˆ°çš„ç»“æœä¸º0x1337733173311337ï¼Œåˆ™å¾—åˆ°flag</li>
</ul>
<p>é‚£ä¹ˆä¸»è¦è¦å…³æ³¨çš„å°±æ˜¯è¿™ä¸ªsignå‡½æ•°åˆ°åº•å¯¹msgè¿›è¡Œäº†ä»€ä¹ˆæ“ä½œï¼š</p>
<ul>
<li>å°†ä¼ å…¥çš„å­—èŠ‚æµmsgè½¬åŒ–ä¸ºäºŒè¿›åˆ¶åˆ—è¡¨ï¼Œå¹¶åœ¨åé¢è¿æ¥ä¸Šb1çš„äºŒè¿›åˆ¶åˆ—è¡¨</li>
<li>å¯¹ä¸Šè¿°äºŒè¿›åˆ¶åˆ—è¡¨çš„msgå¯¹åº”éƒ¨åˆ†è¿›è¡Œéå†ã€‚å¦‚æœå½“å‰ä½ç½®ä¸º1ï¼Œåˆ™å°†ä»¥è¯¥ä½ç½®å¼€å¤´çš„65ä½äºŒè¿›åˆ¶ä¸b2è¿›è¡Œå¼‚æˆ–</li>
<li>éå†å®Œæˆåï¼Œb1å¯¹åº”ä½ç½®çš„äºŒè¿›åˆ¶ä¸²è½¬ä¸ºæ•°å­—ï¼Œä½œä¸ºsignçš„è¿”å›å€¼</li>
</ul>
<p>è€Œå¯ä»¥å‘ç°ï¼Œè¿™ä¸ªsignçš„è¿‡ç¨‹å®Œå…¨æ˜¯å¯ä»¥é€†æ¨å›å»çš„ã€‚æ¯”å¦‚ï¼Œè¿æ¥ä¸Šb1åçš„äºŒè¿›åˆ¶åˆ—è¡¨çš„æœ€åä¸€ä½ï¼Œæœ€å¤šåªå¼‚æˆ–äº†ä¸€æ¬¡ï¼Œå€’æ•°ç¬¬äºŒä½æœ€å¤šåªå¼‚æˆ–äº†ä¸¤æ¬¡ï¼Œä¾æ­¤ç±»æ¨ã€‚è€Œæœ€åä¸€æ¬¡å¼‚æˆ–æ˜¯å¦è¿›è¡Œï¼Œå¯ä»¥ç”±b1çš„æœ€åä¸€ä¸ªäºŒè¿›åˆ¶ä½æ˜¯å¦ä¸ç›®æ ‡0x1337733173311337çš„æœ€åä¸€ä¸ªäºŒè¿›åˆ¶ä½ç›¸ç­‰æ¥åˆ¤æ–­ã€‚å¦‚æœä¸ç›¸ç­‰è¯´æ˜è¿›è¡Œäº†å¼‚æˆ–ï¼Œå°±æŠŠæœ€åå…­åäº”ä¸ªäºŒè¿›åˆ¶ä½ä¸b2å¯¹åº”å¼‚æˆ–å›å»ï¼›ç›¸ç­‰åˆ™ä¸ç”¨ç®¡ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬å°±å®Œæˆäº†å¯¹æœ€åä¸€ä½äºŒè¿›åˆ¶çš„å¤„ç†ï¼Œç„¶åå°†å¤„ç†è¿‡åå¾—åˆ°çš„å€’æ•°ç¬¬äºŒä¸ªäºŒè¿›åˆ¶ä½çœ‹ä½œéœ€è¦å¤„ç†çš„æœ€åä¸€ä¸ªäºŒè¿›åˆ¶ä½ï¼Œé—®é¢˜å°±è½¬åŒ–ä¸ºäº†åˆšæ‰çš„é—®é¢˜ï¼Œä¾æ¬¡ç±»æ¨å°±å¯ä»¥å¾—åˆ°å¡«å……éƒ¨åˆ†çš„å€¼ã€‚</p>
<p>ç„¶è€Œï¼Œè§£å‡ºæ¥çš„å¡«å……éƒ¨åˆ†ä»ç„¶ä¼šå—åˆ°å¡«å……éƒ¨åˆ†ä¹‹å‰å­—èŠ‚å¼‚æˆ–çš„å½±å“ï¼Œå› æ­¤è¿˜éœ€è¦å¤„ç†ä¸€ä¸‹ã€‚ä½†æ˜¯æœ‰ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„åŠæ³•ï¼šç”±äºposæ˜¯0-248çš„éšæœºæ•°ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åå¤è¿æ¥é¶æœºï¼Œéšæœºåˆ°posä¸º0æ—¶å°±ä¸éœ€è¦å†è¿›è¡Œé¢å¤–å¤„ç†äº†ã€‚å¹¶ä¸”ç”±ç”Ÿæ—¥æ”»å‡»çš„æ€æƒ³å¯ä»¥çŸ¥é“ï¼Œè¿æ¥248æ¬¡å°±æœ‰å¤§äº50çš„æ¦‚ç‡éšæœºåˆ°è‡³å°‘ä¸€æ¬¡posä¸º0ï¼Œä¹Ÿå¹¶ä¸è´¹ä»€ä¹ˆæ—¶é—´ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">b2n</span>(<span class="params">b</span>):</span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> b:</span><br><span class="line">        res *= <span class="number">2</span></span><br><span class="line">        res += i</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">n2b</span>(<span class="params">n, length</span>):</span><br><span class="line">    tmp = <span class="built_in">bin</span>(n)[<span class="number">2</span>:]</span><br><span class="line">    tmp = <span class="string">&#x27;0&#x27;</span>*(length-<span class="built_in">len</span>(tmp)) + tmp</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> tmp]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s2n</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(binascii.hexlify(s), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">msg</span>):</span><br><span class="line">    msg = n2b(s2n(msg), <span class="built_in">len</span>(msg)*<span class="number">8</span>)</span><br><span class="line">    msg += b1</span><br><span class="line">    <span class="keyword">for</span> shift <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(msg)-<span class="number">64</span>):</span><br><span class="line">        <span class="keyword">if</span> msg[shift]:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65</span>):</span><br><span class="line">                msg[shift+i] ^= b2[i]</span><br><span class="line">    res = msg[-<span class="number">64</span>:]</span><br><span class="line">    <span class="keyword">return</span> b2n(res)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calc</span>(<span class="params">msg</span>):</span><br><span class="line">    final = <span class="string">&quot;0000000000000000&quot;</span> + msg[<span class="number">16</span>:] + <span class="string">&quot;deadbeeffeedcafe&quot;</span></span><br><span class="line">    aim = <span class="string">&quot;1337733173311337&quot;</span></span><br><span class="line">    length = <span class="built_in">len</span>(final)*<span class="number">4</span></span><br><span class="line">    temp = n2b(<span class="built_in">int</span>(final,<span class="number">16</span>),length)</span><br><span class="line">    aim = n2b(<span class="built_in">int</span>(aim,<span class="number">16</span>),length)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> trange(length-<span class="number">1</span>,<span class="number">64</span>-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span>(temp[i] != aim[i]):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65</span>):</span><br><span class="line">                aim[i-j] ^= b2[-j-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(aim)):</span><br><span class="line">        aim[i] = <span class="built_in">str</span>(aim[i])</span><br><span class="line"></span><br><span class="line">    tt = <span class="built_in">hex</span>(<span class="built_in">int</span>(<span class="string">&quot;&quot;</span>.join(aim),<span class="number">2</span>))[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">return</span> tt[:<span class="number">16</span>]</span><br><span class="line"></span><br><span class="line">b1 = n2b(<span class="number">0xdeadbeeffeedcafe</span>, <span class="number">64</span>)</span><br><span class="line">b2 = n2b(<span class="number">0x10000000247f43cb7</span>, <span class="number">65</span>)</span><br><span class="line">b3 = n2b(<span class="number">0x1337733173311337</span>, <span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">1000</span>):</span><br><span class="line">    r = remote(<span class="string">&quot;node4.anna.nssctf.cn&quot;</span>,<span class="number">28634</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;message: &quot;</span>)</span><br><span class="line">    msg = r.recvline().strip().decode()</span><br><span class="line">    <span class="keyword">if</span>(msg[<span class="number">0</span>] != <span class="string">&quot;_&quot;</span>):</span><br><span class="line">        r.close()</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    r.recvuntil(<span class="string">b&quot;blank: &quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(msg)</span><br><span class="line">    r.sendline(calc(msg))</span><br><span class="line">    <span class="built_in">print</span>(r.recvline())</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#NSSCTF&#123;9e8b2a1a-ad77-4ef3-a161-2f8693c7a0ac&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
]]></content>
      <categories>
        <category>cryptoè¶£é¢˜</category>
      </categories>
  </entry>
  <entry>
    <title>Cryptoè¶£é¢˜-RSA</title>
    <url>/post/ea445335.html</url>
    <content><![CDATA[<p>è¯¥æ–‡ç« ä¸»è¦è®°å½•ä¸€äº›RSAç›¸å…³çš„è¶£é¢˜</p>
<span id="more"></span>
<h3 id="RSA3"><a href="#RSA3" class="headerlink" title="RSA3"></a>RSA3</h3><p>é¢˜ç›®æ¥æºï¼š2023æ±Ÿè‹çœé¢†èˆªæ¯</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p1, q1 = getPrime(<span class="number">512</span>), getPrime(<span class="number">512</span>)</span><br><span class="line">n1 = p1*q1</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">p2, q2 = getPrime(<span class="number">512</span>), getPrime(<span class="number">512</span>)</span><br><span class="line">n2 = p2*q2</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n1 = <span class="subst">&#123;n1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n2 = <span class="subst">&#123;n2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c1 = <span class="subst">&#123;<span class="built_in">pow</span>(m,e,n2)&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c2 = <span class="subst">&#123;<span class="built_in">pow</span>(n1-m,e,n2)&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n1 = 52579135273678950581073020233998071974221658902576724000130040488018033110534210901239397446395736563148970863970460542205225993317478251099451639165369081820130823165642873594136020122857712288395352930384057524510346112486008850200845915783772351449146183974239444691330777565342525218070680067550270554767</span></span><br><span class="line"><span class="comment"># n2 = 68210568831848267339414957973218186686176324296418282565773310695862151827108036984694027795077376921170907068110296451176263520249799154781062517066423984526868547296781709439425857993705489037768605485740968600877866332458671029054092942851472208033494968784822459369206497698469167909174346042658361616469</span></span><br><span class="line"><span class="comment"># c1 = 42941712708129054668823891960764339394032538100909746015733801598044118605733969558717842106784388091495719003761324737091667431446354282990525549196642753967283958283202592037329821712755519455155110675327321252333824912095517427885925854391047828862338332559137577789387455868761466777370476884779752953853</span></span><br><span class="line"><span class="comment"># c2 = 62704043252861638895370674827559804184650708692227789532879941590038911799857232898692335429773480889624046167792573885125945511356456073688435911975161053231589019934427151230924004944847291434167067905803180207183209888082275583120633408232749119300200555327883719466349164062163459300518993952046873724005</span></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®æ„å›¾å¾ˆæ˜ç¡®ï¼šæ˜æ–‡çº¿æ€§ç›¸å…³ï¼Œæ‰€ä»¥ç›´æ¥æ±‚è§£å¤šé¡¹å¼gcdæ˜¯å¯ä»¥åšå‡ºæ¥çš„ã€‚</p>
<p>ä¸è¿‡é—®é¢˜åœ¨äºï¼Œæœ¬é¢˜eå¾ˆå¤§ï¼Œæ‰€ä»¥å¦‚æœç›´æ¥æ±‚è§£gcdï¼Œæ—¶é—´ä¼šèŠ±çš„è¾ƒé•¿(çº¦30-40åˆ†é’Ÿ)ã€‚å› æ­¤å­¦ä¹ äº†ä¸€æ³¢Half-gcdï¼Œè¿™æ˜¯ä¸€ç§èƒ½æœ‰æ•ˆå‡å°‘æ±‚è§£å¤šé¡¹å¼çš„å…¬å› å¼æ‰€éœ€æ—¶é—´çš„æ–¹æ³•ã€‚</p>
<p><a href="https://www.cnblogs.com/whx1003/p/16217087.html">å¤šé¡¹å¼ gcd çš„æ­£ç¡®å§¿åŠ¿ï¼šHalf-GCD ç®—æ³• - whx1003 - åšå®¢å›­ (cnblogs.com)</a></p>
<p>exp.ipynb:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">HGCD</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="number">2</span> * b.degree() &lt;= a.degree() <span class="keyword">or</span> a.degree() == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    m = a.degree() // <span class="number">2</span></span><br><span class="line">    a_top, a_bot = a.quo_rem(x^m)</span><br><span class="line">    b_top, b_bot = b.quo_rem(x^m)</span><br><span class="line">    R00, R01, R10, R11 = HGCD(a_top, b_top)</span><br><span class="line">    c = R00 * a + R01 * b</span><br><span class="line">    d = R10 * a + R11 * b</span><br><span class="line">    q, e = c.quo_rem(d)</span><br><span class="line">    d_top, d_bot = d.quo_rem(x^(m // <span class="number">2</span>))</span><br><span class="line">    e_top, e_bot = e.quo_rem(x^(m // <span class="number">2</span>))</span><br><span class="line">    S00, S01, S10, S11 = HGCD(d_top, e_top)</span><br><span class="line">    RET00 = S01 * R00 + (S00 - q * S01) * R10</span><br><span class="line">    RET01 = S01 * R01 + (S00 - q * S01) * R11</span><br><span class="line">    RET10 = S11 * R00 + (S10 - q * S11) * R10</span><br><span class="line">    RET11 = S11 * R01 + (S10 - q * S11) * R11</span><br><span class="line">    <span class="keyword">return</span> RET00, RET01, RET10, RET11</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GCD</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="built_in">print</span>(a.degree(), b.degree())</span><br><span class="line">    q, r = a.quo_rem(b)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line">    R00, R01, R10, R11 = HGCD(a, b)</span><br><span class="line">    c = R00 * a + R01 * b</span><br><span class="line">    d = R10 * a + R11 * b</span><br><span class="line">    <span class="keyword">if</span> d == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> c.monic()</span><br><span class="line">    q, r = c.quo_rem(d)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> d</span><br><span class="line">    <span class="keyword">return</span> GCD(d, r)</span><br><span class="line"></span><br><span class="line">sys.setrecursionlimit(<span class="number">500000</span>)</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n1 = <span class="number">52579135273678950581073020233998071974221658902576724000130040488018033110534210901239397446395736563148970863970460542205225993317478251099451639165369081820130823165642873594136020122857712288395352930384057524510346112486008850200845915783772351449146183974239444691330777565342525218070680067550270554767</span></span><br><span class="line">n2 = <span class="number">68210568831848267339414957973218186686176324296418282565773310695862151827108036984694027795077376921170907068110296451176263520249799154781062517066423984526868547296781709439425857993705489037768605485740968600877866332458671029054092942851472208033494968784822459369206497698469167909174346042658361616469</span></span><br><span class="line">c1 = <span class="number">42941712708129054668823891960764339394032538100909746015733801598044118605733969558717842106784388091495719003761324737091667431446354282990525549196642753967283958283202592037329821712755519455155110675327321252333824912095517427885925854391047828862338332559137577789387455868761466777370476884779752953853</span></span><br><span class="line">c2 = <span class="number">62704043252861638895370674827559804184650708692227789532879941590038911799857232898692335429773480889624046167792573885125945511356456073688435911975161053231589019934427151230924004944847291434167067905803180207183209888082275583120633408232749119300200555327883719466349164062163459300518993952046873724005</span></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n2))</span><br><span class="line">f = x^e - c1</span><br><span class="line">g = (n1 - x)^e - c2</span><br><span class="line"></span><br><span class="line">res = GCD(f,g)</span><br><span class="line"></span><br><span class="line">m = -res.monic().coefficients()[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line">flag = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<p><strong>CnHongKe{Fr4nkl1n_R31ter_4nd_gcD}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="BUAA-AITMCLAB-amp-Level4"><a href="#BUAA-AITMCLAB-amp-Level4" class="headerlink" title="BUAA^AITMCLAB&amp;Level4"></a>BUAA^AITMCLAB&amp;Level4</h3><p>é¢˜ç›®æ¥æºï¼šBUAA^AITMCLAB</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nextprime</span>(<span class="params">n</span>):</span><br><span class="line">    n = (n + <span class="number">1</span>) | <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> isPrime(n):</span><br><span class="line">        n += <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;********************&quot;</span></span><br><span class="line"></span><br><span class="line">m = s2n(flag)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">The getPrime() may not function properly, </span></span><br><span class="line"><span class="string">but it does not affect your understanding of the problem.</span></span><br><span class="line"><span class="string">lzh hopes you could attack successfully!</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        p = getPrime(<span class="number">512</span>)</span><br><span class="line">        q = nextprime(p + randint(<span class="number">0</span>, <span class="number">2</span> ** <span class="number">421</span>))</span><br><span class="line">        n = p * q</span><br><span class="line">        phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">        d = randint(<span class="number">0</span>, n ** <span class="number">0.32</span>)</span><br><span class="line">        e = invmod(d, phi)</span><br><span class="line">        c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e = %d&quot;</span> % e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n = %d&quot;</span> % n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c = %d&quot;</span> % c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">e = 127036799282947905048902487711584293137462029654908427023257952239618526367628289911517200900560275901894224980635962598874227610508820071266987288647014766036842887978917984803634331617282487399497533040203094883612898714070428079645997317171821336677275458853187399657424389496685642081231802149635762872559</span></span><br><span class="line"><span class="string">n = 132088710602356228013302555046538954329350662026107113731378784700414952971644185280357218688811203701759378494801162526951176546636432770036424692378302192072727185223575484138108758895692654294532714346938723454356449079919300753046965831240595578485766587254369907195552714255698916905317581605325719354369</span></span><br><span class="line"><span class="string">c = 37469551975972446825344827206550506280313465311789923639857075387733761352303008843234906464758618751401773666419762541561815375332688727694620079867717788238335220300725633402928195673814423768862538733435901134624477748268790427128392777900896313025911483334568923415572174037203375831796896263863229112204</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># try to find the ã€Œflagã€</span></span><br><span class="line"><span class="comment"># and don&#x27;t forget to submit it to the platform</span></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®æœ€æœ‰ç”¨çš„ä¿¡æ¯æ˜¯ï¼š</p>
<ul>
<li>på’Œqé«˜ä½ç›¸è¿‘</li>
<li>då°äºn^0.32</li>
</ul>
<p>çœ‹åˆ°å¡äº†dçš„ç•Œï¼Œç¬¬ä¸€ååº”å°±æ˜¯ä½è§£å¯†æŒ‡æ•°æ”»å‡»ï¼Œå¯ä»¥é‡‡ç”¨wiener attackæˆ–è€…boneh and durfee attackã€‚ä½†æ˜¯é—®é¢˜åœ¨äºï¼š</p>
<ul>
<li>wiener attackï¼šè¦æ±‚då°äº$ \frac{1}{3}n^{\frac{1}{4}}$</li>
<li>boneh and durfee attackï¼šè¦æ±‚då°äºn^0.292</li>
</ul>
<p>è€Œé¢˜ç›®åªç•Œå®šäº†0.32ï¼Œè¶…è¿‡äº†ä¸¤ç§æ”»å‡»çš„èŒƒå›´ã€‚ä¸è¿‡ä¸è¦ç´§ï¼Œé¦–å…ˆè¯•ä¸€è¯•boneh and durfee attackï¼Œå› ä¸ºæœ‰ä¸åˆ°1/8çš„æ¦‚ç‡æˆåŠŸ(dåœ¨(0,n^0.32)éšæœºç”Ÿæˆï¼Œå› æ­¤æœ‰1/8æ¦‚ç‡è½åœ¨(0,n^0.29)çš„åŒºé—´ï¼Œå› æ­¤å¯èƒ½ä¼šæˆåŠŸ)</p>
<p>å¯æƒœçš„æ˜¯å¤±è´¥äº†ï¼Œé‚£ä¹ˆå°±åªèƒ½å¦å¯»ä»–æ³•ã€‚ç”±é¢˜ç›®æ¡ä»¶å¯çŸ¥ï¼Œpã€qé«˜ä½ç›¸åŒè¿™ä¸ªé¢å¤–ä¿¡æ¯è‚¯å®šæ˜¯éœ€è¦ç”¨ä¸Šçš„ï¼Œä»¥æ­¤æ¥æ‰©å¤§èƒ½æ”»å‡»çš„dçš„ä¸Šç•Œï¼Œä½†æ˜¯å¹¶ä¸çŸ¥é“æ€ä¹ˆç”¨ã€‚æœ€åä»Xennyå¸ˆå‚…é‚£é‡Œå¾—åˆ°ä¸€ç¯‡è®ºæ–‡ï¼š</p>
<p><a href="http://ijns.jalaxy.com.tw/contents/ijns-v14-n2/ijns-2012-v14-n2-p80-85.pdf">http://ijns.jalaxy.com.tw/contents/ijns-v14-n2/ijns-2012-v14-n2-p80-85.pdf</a></p>
<p>å…³é”®éƒ¨åˆ†ï¼š</p>
<p><img src="/post/ea445335/image-20231001174839341.png" alt="image-20231001174839341"></p>
<p><img src="/post/ea445335/image-20231001174939785.png" alt="image-20231001174939785"></p>
<p>è¿™ç¯‡è®ºæ–‡è¯æ˜äº†ï¼šå½“pã€qé«˜ä½æ¥è¿‘åˆ°ä¸€å®šç¨‹åº¦æ—¶ï¼Œ$\frac{e}{n-2\sqrt{n}+1}$ æ˜¯ $\frac{k}{d}$ çš„æ”¶æ•›å­ï¼Œå¹¶ä¸”æ‹“å®½äº†å¯ä»¥è¿›è¡Œwiener attackæ”»å‡»çš„dçš„ä¸Šç•Œã€‚</p>
<p>å› æ­¤åªéœ€è¦æŠŠwiener attackä¸­çš„ n æ”¹ä¸º $n-2\sqrt{n}+1$ å³å¯ã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">127036799282947905048902487711584293137462029654908427023257952239618526367628289911517200900560275901894224980635962598874227610508820071266987288647014766036842887978917984803634331617282487399497533040203094883612898714070428079645997317171821336677275458853187399657424389496685642081231802149635762872559</span></span><br><span class="line">n = <span class="number">132088710602356228013302555046538954329350662026107113731378784700414952971644185280357218688811203701759378494801162526951176546636432770036424692378302192072727185223575484138108758895692654294532714346938723454356449079919300753046965831240595578485766587254369907195552714255698916905317581605325719354369</span></span><br><span class="line">c = <span class="number">37469551975972446825344827206550506280313465311789923639857075387733761352303008843234906464758618751401773666419762541561815375332688727694620079867717788238335220300725633402928195673814423768862538733435901134624477748268790427128392777900896313025911483334568923415572174037203375831796896263863229112204</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ContinuedFraction</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, numerator, denumerator</span>):</span><br><span class="line">        self.numberlist = []  <span class="comment"># number in continued fraction</span></span><br><span class="line">        self.fractionlist = []  <span class="comment"># the near fraction list</span></span><br><span class="line">        self.GenerateNumberList(numerator, denumerator)</span><br><span class="line">        self.GenerateFractionList()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">GenerateNumberList</span>(<span class="params">self, numerator, denumerator</span>):</span><br><span class="line">        <span class="keyword">while</span> numerator != <span class="number">1</span>:</span><br><span class="line">            quotient = numerator // denumerator</span><br><span class="line">            remainder = numerator % denumerator</span><br><span class="line">            self.numberlist.append(quotient)</span><br><span class="line">            numerator = denumerator</span><br><span class="line">            denumerator = remainder</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">GenerateFractionList</span>(<span class="params">self</span>):</span><br><span class="line">        self.fractionlist.append([self.numberlist[<span class="number">0</span>], <span class="number">1</span>])</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(self.numberlist)):</span><br><span class="line">            numerator = self.numberlist[i]</span><br><span class="line">            denumerator = <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i):</span><br><span class="line">                temp = numerator</span><br><span class="line">                numerator = denumerator + numerator * self.numberlist[i - j - <span class="number">1</span>]</span><br><span class="line">                denumerator = temp</span><br><span class="line">            self.fractionlist.append([numerator, denumerator])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = ContinuedFraction(e, n-<span class="number">2</span>*iroot(n,<span class="number">2</span>)[<span class="number">0</span>]+<span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> k, d <span class="keyword">in</span> a.fractionlist:</span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">    flag = long_to_bytes(m)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;aitmc&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<p><strong>aitmc{W0Oo!!Y0u_3re_a_m3ster_of_W1ener_H3ck!!}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="AITMCLAB-quiz2"><a href="#AITMCLAB-quiz2" class="headerlink" title="AITMCLAB quiz2"></a>AITMCLAB quiz2</h3><p>é¢˜ç›®æ¥æºï¼šAITMCLAB</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Welcome to quiz2!!!</span></span><br><span class="line"><span class="keyword">from</span> AITMCLab.libnum <span class="keyword">import</span> s2n</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> isPrime</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line">p = <span class="number">104879397075344024438671231239628115011303349344697797964879592144922079000957</span> </span><br><span class="line">q = <span class="number">104879397075344024438671231239628115011303349344697797964879592144922079001013</span></span><br><span class="line"><span class="keyword">assert</span> isPrime(p) <span class="keyword">and</span> isPrime(q)</span><br><span class="line">n = p * q</span><br><span class="line">flag = s2n(<span class="string">&#x27;flag&#123;************&#125;&#x27;</span>)</span><br><span class="line">r = randint(<span class="number">1</span>, n)</span><br><span class="line">c = (<span class="built_in">pow</span>(n + <span class="number">1</span>, flag, n * n) * <span class="built_in">pow</span>(r, n, n * n)) % (n * n)</span><br><span class="line"><span class="built_in">print</span> (c)</span><br><span class="line"><span class="comment"># 13134489820394613222282607681686272081419875146946401883172682167011759113388373349180457979897848113275982219264879081189886853062717764580364698888338032141434053832247476010400449272010082460437747190468766740274587999336359171283098137261396013153130265440425676242061845667887640808895666325466803989428</span></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®æœ¬èº«åº”è¯¥è¿˜éœ€è¦æ±‚ä¸€ä¸‹pã€qçš„ï¼Œä½†æ˜¯ç›´æ¥ç»™å¥½äº†é‚£å°±ç”¨ç»™å¥½çš„åšå§ã€‚</p>
<p>å‘ç°åŠ å¯†å°±ä¸€æ­¥ï¼Œå¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
c\equiv (n+1)^{flag}*r^n\quad(mod\;n^2)</script><p>å…¶ä¸­ï¼Œræ˜¯ä¸€ä¸ªéšæœºæ•°ï¼Œä¸”é¢˜ç›®æœªç»™å‡ºã€‚</p>
<p>é¦–å…ˆï¼Œç”±äºæ¨¡ $ n^2$ çš„ç¼˜æ•…ï¼Œ$ (n+1)^{flag}$ å¯ä»¥ç”¨äºŒé¡¹å¼å®šç†å±•å¼€ï¼Œç„¶åæ¶ˆæ‰å¤§éƒ¨åˆ†é¡¹ï¼š</p>
<script type="math/tex; mode=display">
(n+1)^{flag} \equiv n*flag+1\quad(mod\;n^2)</script><p>å› æ­¤æœ‰ï¼š</p>
<script type="math/tex; mode=display">
c\equiv (n*flag+1)*r^n\quad(mod\;n^2)</script><p>r æ˜¯æœªçŸ¥çš„éšæœºæ•°ï¼Œå› æ­¤è¦æ¶ˆæ‰ï¼Œæ¶ˆæ‰ r çš„æ–¹å¼ç±»ä¼¼äº RSA çš„è§£å¯†è¿‡ç¨‹ï¼Œå¦‚ä¸‹ï¼š</p>
<p>å› ä¸ºï¼š</p>
<script type="math/tex; mode=display">
\phi(n^2) = \phi(p^2q^2) = \phi(p^2)\phi(q^2) = pq(p-1)(q-1)</script><p>æ‰€ä»¥ ï¼š</p>
<script type="math/tex; mode=display">
c^{(p-1)(q-1)} \equiv ((n*flag+1)*r^n)^{(p-1)(q-1)} \quad(mod\;n^2)</script><p>å³ ï¼š</p>
<script type="math/tex; mode=display">
c^{(p-1)(q-1)} \equiv (n*flag+1)^{(p-1)(q-1)}*r^{n(p-1)(q-1)} \quad(mod\;n^2)</script><p>æ³¨æ„åˆ°ä¸Šå¼ä¸­ï¼š</p>
<script type="math/tex; mode=display">
r^{n(p-1)(q-1)}\equiv r^{\phi(n^2)}\equiv 1\quad(mod\;n^2)</script><p>å› æ­¤å°±æ¶ˆæ‰äº† rï¼Œå¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
c^{(p-1)(q-1)} \equiv (n*flag+1)^{(p-1)(q-1)} \quad(mod\;n^2)</script><p>å³ä¾§çš„å¼å­åˆå¯ä»¥ç”¨äºŒé¡¹å¼å®šç†å±•å¼€ï¼Œå¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
(n*flag+1)^{(p-1)(q-1)}\equiv (p-1)(q-1)n*flag+1 \quad(mod\;n^2)</script><p>å› æ­¤ï¼š</p>
<script type="math/tex; mode=display">
c^{(p-1)(q-1)}\equiv (p-1)(q-1)n*flag+1 \quad(mod\;n^2)</script><p>å‡ä¸€ï¼Œé™¤ä»¥nåï¼Œå†æ±‚(p-1)(q-1)å¯¹n^2çš„é€†å…ƒå³å¯ï¼Œä½†æ˜¯ä¼šå‘ç°æ±‚å‡ºçš„æ¨¡ n^2 ä¸‹çš„å¹¶ä¸æ˜¯æœ€ç»ˆçš„ flagï¼ŒçŒœæµ‹å¯èƒ½é¢˜ç›®åŸæœ¬é¢˜é¢è¿˜æœ‰é¢å¤–ä¿¡æ¯ç•Œå®šäº† flag çš„èŒƒå›´ï¼Œé‚£ä¹ˆè½¬åˆ°æ¨¡ n ä¸‹å³å¯å¾—åˆ°æœ€ç»ˆflagã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">104879397075344024438671231239628115011303349344697797964879592144922079000957</span> </span><br><span class="line">q = <span class="number">104879397075344024438671231239628115011303349344697797964879592144922079001013</span></span><br><span class="line">n = p * q</span><br><span class="line">c = <span class="number">13134489820394613222282607681686272081419875146946401883172682167011759113388373349180457979897848113275982219264879081189886853062717764580364698888338032141434053832247476010400449272010082460437747190468766740274587999336359171283098137261396013153130265440425676242061845667887640808895666325466803989428</span></span><br><span class="line"></span><br><span class="line">m = (<span class="built_in">pow</span>(c,(p-<span class="number">1</span>)*(q-<span class="number">1</span>),n**<span class="number">2</span>) - <span class="number">1</span>) // n * inverse((p-<span class="number">1</span>)*(q-<span class="number">1</span>),n**<span class="number">2</span>) % n</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>flag{can_you_find_me??}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="2048bit-e"><a href="#2048bit-e" class="headerlink" title="2048bit e"></a>2048bit e</h3><p>é¢˜ç›®æ¥æºï¼šæš‚ä¸æ˜ç¡®</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, getStrongPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> factorial</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p, q = getStrongPrime(<span class="number">1024</span>), getStrongPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">RSAgen</span>(<span class="params">e = <span class="literal">None</span></span>):</span><br><span class="line">    d = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> e:</span><br><span class="line">        <span class="keyword">while</span>(d.bit_length() &lt; <span class="number">2047</span>):</span><br><span class="line">            e = getPrime(<span class="number">2047</span>)</span><br><span class="line">            d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> (p*q, p, q, e, d)</span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n = &#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">key = RSAgen()</span><br><span class="line">k = randint(<span class="number">600</span>, <span class="number">1200</span>)</span><br><span class="line">f = factorial(k)</span><br><span class="line"></span><br><span class="line">leak = (<span class="built_in">pow</span>(key[<span class="number">3</span>], <span class="number">2</span>) + (key[<span class="number">3</span>]*key[<span class="number">4</span>] - <span class="number">1</span>)*f)*getPrime(<span class="number">256</span>) + k</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2048 bit e is very expensive, i should use standard e for my encryption   </span></span><br><span class="line"></span><br><span class="line">key = RSAgen(<span class="number">65537</span>)</span><br><span class="line">e = key[<span class="number">3</span>]</span><br><span class="line">flag = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(flag, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;leak = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#OUTPUT</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#n = 26155610563918771040451217453770153423175480849248932666067623213096628137347700281227651842637531066158966523562535269946270160966349550464316855975843702602386644310622115374093643617687763127399565005930283899166880048303714803385714487858740617133136915034968428269114907303042424391192431406494414712801428682398922655599872605973327217541188045983390427079210204358352343375551675052592229757120847888780576171954181304712725822439789885440973203535622584052397858824995170393109932313608251208103032787250637381098134254687242226624254464180882206386756799922789661143241398308165644172112918996116051241341767</span></span><br><span class="line"><span class="comment">#c = 14882143057207490168145609595794327950964467559973424621597752378687475531116051048471999976592360385753040756962986881197575420871063219354858309758384966841729075968439470757951580317772601028800980369844502945471937420415705013093369495725032356110007789188647453706470456907380267324946203780527015651994928850341098799680560649210763871810476662426271293840410794844793663532229448343601068354829550752842074478598115636890530640204633346276888013284576380941564885085920559055293159358576137659586044231684426664502650956119257574114940925398612801662412390652208379645262117964212231444035372237602987220161154</span></span><br><span class="line"><span class="comment">#leak = 8882329530176003989563469282320326448513961425520889104820115352134009331360402757127024139665879246460280903840841878434886334764358389863635520069842148223207565079555357126011768633841724238023402746185876779525887392481984149029421348288859961294980594601070755980946189936784537926893399566710815892754474482631518313221065280747677073806153015411511245208373763611976120763693741604815436190527484656588721635559583703292529849150438632820886160326184322723507482566078134710656764953471923255683042573911453728381364857973339477093454501755540396376196910045154990604723000628164844678783206034532184996212426411646863562670787117170937484057232253132378686191307517787281075273286073730517840320844224160937065166742670192503005084799125432651202276745876948826479983116284656814139188066381428020724692363565714860614527931752152240198254329317479816158596931824787225489069026346088037877441040453722896865574447079406031506283100005929709985031578939782011738018467829080816081913925121672327305968766974521281843700741425497908524015911173859409613820295440717780859694704848500536323185048069666385294578000406894438137681553061828379901393410655028227052289995544806138411605538810055799529381568985312754486907514057810886832822416112077637141046599291719695931641341477116694041607732362173173111829958139812135983269100274129925726662395368378059697391687349679786945510641238252220381519030943165126475181808810902040710261462429322977874350519175554159491968977598607860470919877896807912649830555310344788510811708640852621939517683512617800947347015328336403343549764926804605586325355602602157724502283094424228440314761426084409569002423419659272529716195776451657960565924304898320195699180560668631806178645741692749524883469846005409211271022431433039546590781549630715275308124729500303196140494010253387465310270348759187686632848767083559239773341844408450815683523679200221818741654323193797457218877776650125241324891467161777274139708214831833313936201971466603547791591622683172049635972772551806007816208466413199652425970868250229578051299718112290796388965170374760048006586491240415960299655674234758022536120132945656010849673271011148857409644260456852793444292102864629782613888832787049959589501287519423225832100567897316528973935415321329220397090613054817402449251249956025659833660199528249628136823951941068620183704359665779941064385612344970878816496323047753331967618070575102035154652470553061929831610193694052912228006377979477318327954292917783836426814224401489211262556447908499035071972531345812915421543036881828636718727357962701875285833936517812391121587399727281240931927431811181444977909594218984279921315492877394195428208756441893687385105650326859023900280137352737660777503064484456016697716191624303099683835521939233782390584505763849676573364198388306561033652480971048175488758111144736636640190185417713883213429725379415164862080052393396741667399031632758281193771891210430178563364662790052209648349668663621672614807647401120518076403133998551484399204398325200361951412241887720441234483010617920388630542945062451586033688057992061925968617174491390233664273716567854279453909892176120950383253842037120054072618389794275273311333932588139102552015371447182882116160259277516530183031644054520783191752410514938160605548110059282703060409667276475969749797140136872904654013231613962248971564712815341527356396922068564215026284215874684201258558000033165916019163319759952566031082383620943938948623145286816988139057606627616639594815749554968862963450819772941547102531289115954195402127419754744687573822011699197232836491588776322734503766502102575418226503487579619923510951731702344792411606628965837547432575532404303417689912716247856960760491417279481456633424179644033150732614552508566990237704498608189201159580503580410535170284429946552129635519661513317741471932078145289068540132823</span></span><br></pre></td></tr></table></figure>
<p>æ¢³ç†ä¸€ä¸‹åŠ å¯†æµç¨‹ï¼Œé¢˜ç›®é¦–å…ˆç”¨äº†é»˜è®¤å‚æ•° e=None ç”Ÿæˆäº†ä¸€ç»„ RSA å¯†é’¥ï¼Œå¹¶åŸºäºæ­¤å¯†é’¥æ³„éœ²äº†ä¸€ä¸ªä¿¡æ¯ leak ã€‚æ³„æ¼ leak ä¹‹åï¼Œç”¨ e=65537 ç”Ÿæˆäº†å¦ä¸€ç»„å…¬ç§é’¥ï¼Œå¹¶ä¸”ç”¨å¦ä¸€ç»„å…¬ç§é’¥åŠ å¯†æ˜æ–‡åï¼Œç»™å‡ºå¯†æ–‡ã€‚</p>
<p>æ³¨æ„åˆ°ä¸¤æ¬¡ RSAgen() è¿‡ç¨‹ä¸­ï¼Œnã€pã€qä¸‰ä¸ªé‡æ˜¯ä¸å˜çš„ã€‚å› æ­¤è§£é¢˜çš„æ€è·¯å°±æ˜¯ï¼šç”±ç¬¬ä¸€ç»„ eã€d æ³„æ¼çš„ä¿¡æ¯ leakï¼Œè·å– n çš„åˆ†è§£ï¼Œä»è€Œè§£å¯†ç¬¬äºŒç»„å¯†æ–‡ã€‚</p>
<p>é‚£ä¹ˆ leak ç©¶ç«Ÿæ³„éœ²äº†ä»€ä¹ˆï¼Ÿå…ˆæŠŠè¡¨è¾¾å¼å†™å‡ºæ¥ï¼š</p>
<script type="math/tex; mode=display">
leak = (e_1^2+(e_1d_1-1)(k!))a+k</script><p>å…¶ä¸­ï¼Œ</p>
<ul>
<li>aæ˜¯ä¸€ä¸ª256æ¯”ç‰¹çš„éšæœºç´ æ•°ï¼Œæœªç»™å‡º</li>
<li>kæ˜¯ä¸€ä¸ª(600,1200)ä¹‹é—´çš„æ•´æ•°ï¼Œæœªç»™å‡º</li>
</ul>
<p>æ•´ä¸ª leak å¼å­é‡Œå°±æ²¡æœ‰ä¸€ä¸ªå‚æ•°æ˜¯çŸ¥é“çš„ï¼Œé‚£æ€ä¹ˆåŠï¼Ÿé¦–å…ˆå°±ä¼šè§‚å¯Ÿåˆ° k å¯èƒ½çš„èŒƒå›´æ¯”è¾ƒå°ï¼Œåªæœ‰ 600 ç§å¯èƒ½ï¼Œå› æ­¤çªç ´å£åº”è¯¥åœ¨äºå…ˆæ‰¾åˆ°ä¸€ç§åˆé€‚çš„çˆ†ç ´æ€è·¯ï¼Œæ±‚è§£å‡º kã€‚ä¸ºäº†è¾¾åˆ°æ±‚è§£ k çš„ç›®çš„ï¼Œå…ˆæŠŠ leak çš„è¡¨è¾¾å¼æ‹†æˆæ›´å®¹æ˜“ç†è§£çš„å½¢å¼ï¼š</p>
<script type="math/tex; mode=display">
leak = ae_1^2+a(e_1d_1-1)(k!)+k</script><p>æˆ‘ä»¬åœ¨(600,1200)ä¹‹é—´å– i è¿›è¡Œçˆ†ç ´ï¼Œé‚£ä¹ˆå½“ i å–(600,k) ä¹‹é—´çš„æ•°æ—¶ï¼Œä¸‹é¢çš„ç­‰å¼æˆç«‹ï¼š</p>
<script type="math/tex; mode=display">
ae_1^2 = leak -i \quad (mod\;i!)</script><p>è¿™æ˜¯å› ä¸ºï¼Œç”±äº i &lt; kï¼Œæ‰€ä»¥æœ‰ $ i! \mid k!$ </p>
<p>è€Œå½“å–çš„ i å¤§äº k æ—¶ï¼Œ $ i! \nmid k!$ ï¼Œå› æ­¤æ¨¡ $ i!$ æ— æ³•æ¨¡æ‰leakä¸­ $a(e_1d_1-1)(k!)$ è¿™ä¸€éƒ¨åˆ†ã€‚è¿™ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœ $ leak -i \quad (mod\;i!) $ çš„è®¡ç®—å€¼å‘ç”Ÿäº†å˜åŒ–ï¼Œå°±è¯´æ˜æˆ‘ä»¬å–å¾—äº†æ­£ç¡®çš„ kã€‚å¹¶ä¸”åœ¨çˆ†ç ´è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ—©å°±æ‹¥æœ‰äº†æ­£ç¡®çš„ $ ae_1^2$</p>
<p>æ±‚å¾—äº† k ä¹‹åï¼Œå°±è¦æƒ³åŠæ³•æ±‚å‡ºå‰©ä¸‹å‡ ä¸ªå‚æ•°ï¼Œè€Œç”±äºæ‹¥æœ‰ $ ae_1^2$ ï¼Œæ‰€ä»¥å®¹æ˜“æƒ³åˆ°ç»§ç»­ä» a ä¸‹æ‰‹ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬å†æŠŠ leak çš„è¡¨è¾¾å¼å†™æˆå¦ä¸€ä¸ªå®¹æ˜“ç†è§£çš„å½¢å¼ï¼š</p>
<script type="math/tex; mode=display">
leak = (a(e_1d_1-1))(k!)+(ae_1^2+k)</script><p>ä¸ºä»€ä¹ˆè¯´ä»–æ›´å®¹æ˜“ç†è§£ï¼Ÿå› ä¸ºè¿™å°±å†™æˆäº†ä¸€ä¸ªæ ‡å‡†çš„å¸¦ä½™é™¤æ³•å½¢å¼ï¼š</p>
<script type="math/tex; mode=display">
a=kb+c\quad,\quad c<b</script><p>è€Œå¯¹è¿™ä¸ªå¸¦ä½™é™¤æ³•ï¼Œæ˜¾ç„¶æœ‰ï¼š</p>
<script type="math/tex; mode=display">
a \div b = k</script><p>è€Œæ”¾åœ¨ leak ç»„æˆçš„å¸¦ä½™é™¤æ³•ä¸­ï¼Œç”±äº $k!$ çš„æ•°é‡çº§æ˜¾ç„¶å¤§äº $ (ae_1^2+k)$ ï¼Œå› æ­¤å°±æœ‰ï¼š</p>
<script type="math/tex; mode=display">
leak \div (k!) = a(e_1d_1-1)</script><p>å°†å¾—åˆ°çš„å€¼ä¸ $ae_1^2$ æ±‚gcdå³å¯å¾—åˆ° a ï¼Œæ¥ä¸‹æ¥å°±èƒ½æ¢å¤ $e_1ï¼Œd_1$ï¼Œç„¶åå°±è½¬åŒ–æˆå·²çŸ¥ eï¼Œd åˆ†è§£ n çš„é—®é¢˜äº†ã€‚åˆ†è§£å‡º n åå°±å¯ä»¥é¡ºåˆ©æ±‚è§£å¯†æ–‡ã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> factorial</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"></span><br><span class="line">n = <span class="number">26155610563918771040451217453770153423175480849248932666067623213096628137347700281227651842637531066158966523562535269946270160966349550464316855975843702602386644310622115374093643617687763127399565005930283899166880048303714803385714487858740617133136915034968428269114907303042424391192431406494414712801428682398922655599872605973327217541188045983390427079210204358352343375551675052592229757120847888780576171954181304712725822439789885440973203535622584052397858824995170393109932313608251208103032787250637381098134254687242226624254464180882206386756799922789661143241398308165644172112918996116051241341767</span></span><br><span class="line">c = <span class="number">14882143057207490168145609595794327950964467559973424621597752378687475531116051048471999976592360385753040756962986881197575420871063219354858309758384966841729075968439470757951580317772601028800980369844502945471937420415705013093369495725032356110007789188647453706470456907380267324946203780527015651994928850341098799680560649210763871810476662426271293840410794844793663532229448343601068354829550752842074478598115636890530640204633346276888013284576380941564885085920559055293159358576137659586044231684426664502650956119257574114940925398612801662412390652208379645262117964212231444035372237602987220161154</span></span><br><span class="line">leak = <span class="number">8882329530176003989563469282320326448513961425520889104820115352134009331360402757127024139665879246460280903840841878434886334764358389863635520069842148223207565079555357126011768633841724238023402746185876779525887392481984149029421348288859961294980594601070755980946189936784537926893399566710815892754474482631518313221065280747677073806153015411511245208373763611976120763693741604815436190527484656588721635559583703292529849150438632820886160326184322723507482566078134710656764953471923255683042573911453728381364857973339477093454501755540396376196910045154990604723000628164844678783206034532184996212426411646863562670787117170937484057232253132378686191307517787281075273286073730517840320844224160937065166742670192503005084799125432651202276745876948826479983116284656814139188066381428020724692363565714860614527931752152240198254329317479816158596931824787225489069026346088037877441040453722896865574447079406031506283100005929709985031578939782011738018467829080816081913925121672327305968766974521281843700741425497908524015911173859409613820295440717780859694704848500536323185048069666385294578000406894438137681553061828379901393410655028227052289995544806138411605538810055799529381568985312754486907514057810886832822416112077637141046599291719695931641341477116694041607732362173173111829958139812135983269100274129925726662395368378059697391687349679786945510641238252220381519030943165126475181808810902040710261462429322977874350519175554159491968977598607860470919877896807912649830555310344788510811708640852621939517683512617800947347015328336403343549764926804605586325355602602157724502283094424228440314761426084409569002423419659272529716195776451657960565924304898320195699180560668631806178645741692749524883469846005409211271022431433039546590781549630715275308124729500303196140494010253387465310270348759187686632848767083559239773341844408450815683523679200221818741654323193797457218877776650125241324891467161777274139708214831833313936201971466603547791591622683172049635972772551806007816208466413199652425970868250229578051299718112290796388965170374760048006586491240415960299655674234758022536120132945656010849673271011148857409644260456852793444292102864629782613888832787049959589501287519423225832100567897316528973935415321329220397090613054817402449251249956025659833660199528249628136823951941068620183704359665779941064385612344970878816496323047753331967618070575102035154652470553061929831610193694052912228006377979477318327954292917783836426814224401489211262556447908499035071972531345812915421543036881828636718727357962701875285833936517812391121587399727281240931927431811181444977909594218984279921315492877394195428208756441893687385105650326859023900280137352737660777503064484456016697716191624303099683835521939233782390584505763849676573364198388306561033652480971048175488758111144736636640190185417713883213429725379415164862080052393396741667399031632758281193771891210430178563364662790052209648349668663621672614807647401120518076403133998551484399204398325200361951412241887720441234483010617920388630542945062451586033688057992061925968617174491390233664273716567854279453909892176120950383253842037120054072618389794275273311333932588139102552015371447182882116160259277516530183031644054520783191752410514938160605548110059282703060409667276475969749797140136872904654013231613962248971564712815341527356396922068564215026284215874684201258558000033165916019163319759952566031082383620943938948623145286816988139057606627616639594815749554968862963450819772941547102531289115954195402127419754744687573822011699197232836491588776322734503766502102575418226503487579619923510951731702344792411606628965837547432575532404303417689912716247856960760491417279481456633424179644033150732614552508566990237704498608189201159580503580410535170284429946552129635519661513317741471932078145289068540132823</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç¡®å®š k = 1000</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">for k in range(600,1200):</span></span><br><span class="line"><span class="string">    t = factorial(k)</span></span><br><span class="line"><span class="string">    ae2 = int((leak-k) % t)</span></span><br><span class="line"><span class="string">    if(len(bin(ae2)) != 4351):</span></span><br><span class="line"><span class="string">        print(k-1)</span></span><br><span class="line"><span class="string">        break</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">k = <span class="number">1000</span></span><br><span class="line">ae2 = <span class="built_in">int</span>((leak-k) % factorial(k))</span><br><span class="line">temp = leak // factorial(k)</span><br><span class="line">a = GCD(ae2,temp)</span><br><span class="line"></span><br><span class="line">e = iroot(ae2//a,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">d = (((leak - k)//a - e**<span class="number">2</span>) // factorial(k) + <span class="number">1</span>) // e</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#å·²çŸ¥eï¼Œdåˆ†è§£n</span></span><br><span class="line">t = e*d - <span class="number">1</span></span><br><span class="line">s = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> t % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">    s += <span class="number">1</span></span><br><span class="line">    t //= <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, s):</span><br><span class="line">    c1 = <span class="built_in">pow</span>(<span class="number">2</span>, <span class="built_in">int</span>(<span class="built_in">pow</span>(<span class="number">2</span>, i-<span class="number">1</span>, n)*t), n)</span><br><span class="line">    c2 = <span class="built_in">pow</span>(<span class="number">2</span>, <span class="built_in">int</span>(<span class="built_in">pow</span>(<span class="number">2</span>, i, n)*t), n)</span><br><span class="line">    <span class="keyword">if</span> c1 != <span class="number">1</span> <span class="keyword">and</span> c1 != (-<span class="number">1</span> % n) <span class="keyword">and</span> c2 == <span class="number">1</span>:</span><br><span class="line">        p = GCD(c1 - <span class="number">1</span>, n)</span><br><span class="line">        q = n // p</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(<span class="number">65537</span>,phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<p><strong>flag{gcd_is_always_useful}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="hardrsa"><a href="#hardrsa" class="headerlink" title="hardrsa"></a>hardrsa</h3><p>æ„Ÿè°¢å‡ ä½å¸ˆå‚…å¯¹æˆ‘æä¾›çš„å¸®åŠ©ï¼Œé€šè¿‡è¿™ä¸€é“é¢˜æ”¶è·äº†å¾ˆå¤šã€‚</p>
<p>é¢˜ç›®æ¥æºï¼šæ±Ÿè‹çœæ•°æ®å®‰å…¨ç«èµ› 2023</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> message</span><br><span class="line"></span><br><span class="line">p, q = [getPrime(<span class="number">1024</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]</span><br><span class="line">n = p * q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">msg: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="keyword">return</span> msg + long_to_bytes(<span class="built_in">len</span>(msg) &amp; <span class="number">0xff</span>) * (<span class="number">2048</span> // <span class="number">8</span> - <span class="built_in">len</span>(msg) - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x: <span class="built_in">int</span>, poly: <span class="built_in">list</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span>([</span><br><span class="line">        poly[i] * <span class="built_in">pow</span>(x, i, n) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(poly))</span><br><span class="line">    ]) % n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">commit</span>(<span class="params">m: <span class="built_in">int</span>, d: <span class="built_in">int</span>, key: <span class="built_in">int</span>, poly: <span class="built_in">list</span>[<span class="built_in">int</span>]</span>) -&gt; (<span class="built_in">int</span>, <span class="built_in">int</span>):</span><br><span class="line">    sig = <span class="built_in">pow</span>(m, d, n)</span><br><span class="line">    c1 = (sig + <span class="built_in">pow</span>(key, <span class="number">8</span>, n) + <span class="built_in">pow</span>(key, <span class="number">4</span>, n) + <span class="built_in">pow</span>(key, <span class="number">2</span>, n)) % n</span><br><span class="line">    c2 = f(key, poly)</span><br><span class="line">    <span class="keyword">return</span> c1, c2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reveal</span>(<span class="params">comm: (<span class="params"><span class="built_in">int</span>, <span class="built_in">int</span></span>), e: <span class="built_in">int</span>, key: <span class="built_in">int</span>, poly: <span class="built_in">list</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    c1, c2 = comm</span><br><span class="line">    <span class="keyword">assert</span> f(key, poly) == c2</span><br><span class="line">    sig = (c1 - <span class="built_in">pow</span>(key, <span class="number">8</span>, n) - <span class="built_in">pow</span>(key, <span class="number">4</span>, n) - <span class="built_in">pow</span>(key, <span class="number">2</span>, n)) % n</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(sig, e, n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">part1</span>(<span class="params">msg</span>):</span><br><span class="line">    e = <span class="number">233</span></span><br><span class="line">    <span class="keyword">assert</span> GCD(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>)) == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    m = bytes_to_long(pad(msg))</span><br><span class="line">    c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;# Part1: RSA-Encrypted Ciphertext\n&quot;</span></span><br><span class="line">          <span class="string">f&quot;<span class="subst">&#123;e = &#125;</span>\n&quot;</span></span><br><span class="line">          <span class="string">f&quot;<span class="subst">&#123;n = &#125;</span>\n&quot;</span></span><br><span class="line">          <span class="string">f&quot;<span class="subst">&#123;c = &#125;</span>\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">part2</span>(<span class="params">msg</span>):</span><br><span class="line">    e = getPrime(<span class="number">256</span>)</span><br><span class="line">    <span class="keyword">assert</span> GCD(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>)) == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    d = inverse(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">    key = getPrime(<span class="number">1024</span>)</span><br><span class="line">    poly = [randint(n // <span class="number">2</span>, n) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)]</span><br><span class="line"></span><br><span class="line">    m = bytes_to_long(msg)</span><br><span class="line">    comm = commit(m, d, key, poly)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;# Part2: RSA-Committed Promise\n&quot;</span></span><br><span class="line">          <span class="string">f&quot;<span class="subst">&#123;e = &#125;</span>\n&quot;</span></span><br><span class="line">          <span class="string">f&quot;<span class="subst">&#123;n = &#125;</span>\n&quot;</span></span><br><span class="line">          <span class="string">f&quot;<span class="subst">&#123;poly = &#125;</span>\n&quot;</span></span><br><span class="line">          <span class="string">f&quot;<span class="subst">&#123;comm = &#125;</span>\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">part1(message)</span><br><span class="line">part2(message)</span><br></pre></td></tr></table></figure>
<p>æ•°æ®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Part1: RSA-Encrypted Ciphertext</span></span><br><span class="line">e = <span class="number">233</span></span><br><span class="line">n = <span class="number">11804593083540766953191768473584891632857464298610295673456410319093405751966708262984066641796004658380825990723088997287209884308749055923966759203552497405777188930982989535372734594928432767182748217929177897158889489317608554405915470112027996617864702664597137007278287666634774284031478676422259138168442639629844443754737406734109480041155382192976640499144347256893867447543190494469466088332396851821283556702874066317163371254358756837283841870127393406798300254660201670728912096447184875821681550977470988174485488514169553325962974156396460297399345856735492168813016282687198473612371220123462499438299</span></span><br><span class="line">c = <span class="number">4236463649246394372490570028773321531426122440354351428997745409269923078428264643984899276198044684405861411922920531424639487584475747440112668094733950281377813868988540407013967573584191516922420060508458881142111648007775541541206593622564564631875373635260315932740995440619035591722675173125322220642392862827996987221780888705796026865917969313975598350208578877195524822778355327253625950282635041414028859491576352297298051077024341409125083650148374909480761558443601847884116325029903499801566422663448734010004472905405209374692154735955178855634936508017264189084568424915164265136679303107745093554391</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Part2: RSA-Committed Promise</span></span><br><span class="line">e = <span class="number">99181398864848350371016820825262886005052515653150198897546275436659368873943</span></span><br><span class="line">n = <span class="number">11804593083540766953191768473584891632857464298610295673456410319093405751966708262984066641796004658380825990723088997287209884308749055923966759203552497405777188930982989535372734594928432767182748217929177897158889489317608554405915470112027996617864702664597137007278287666634774284031478676422259138168442639629844443754737406734109480041155382192976640499144347256893867447543190494469466088332396851821283556702874066317163371254358756837283841870127393406798300254660201670728912096447184875821681550977470988174485488514169553325962974156396460297399345856735492168813016282687198473612371220123462499438299</span></span><br><span class="line">poly = [<span class="number">11693140800527031176333218506340138430240732192854115958431704393516665671354696442539228569575338743555295185742126489158430815263152939757778849261704565332700814864041988371030487621611557506812653488873444536543143499111306076278080422306914610758456202844384883419669780999835836102076447921204517046598938140064244383099665415296806730515287813702062130475281955202867695799707516205462251852912274330831232375362037653669046715539164625549785400699583991291522758317569231805551847554593188947041531361947659444681456741424693383958548943092649257246992511287359572983628972516677506780721131000304618999959240</span>, <span class="number">8649833849514355009128561581797540267452805179286553003531347469534976088903045945255322948772127884435044654450320045837146400545547035413423698519877318250595578140049443137749594587635124784776640002144869420735353810166877391696732603701567388813523929688499591774843294322221335666734637085035509293762539158494372418206937167893545676403532672666734540153869114591107560124251452526082108870638702356111887843199439729119638581693415233654435010304861838471514755642714031294943492873471199466178392719343340089957082809543276507257853855309815913146064538017999492250838671852901021723088900839652630087246141</span>, <span class="number">10438652195883831412435505413668253747222376993835057512571018586886172468948369796145782100970559858131410652399919261454018181151110711244715955202406007064700539815605400586293839962095578425689125884220411946405356203770630361655071021743875660757465221991116870667245627142015074048387044977823496726850652712591020608153928488470683315016742274925734216097962308837642472645606961264797331661105479206824511239562468503777960135923781994521205671697654968415294210654160582131094288074290198995839634141037654146239631046959485219534841518635072303135929794463631818179287771643492272214514760725403082404954077</span>, <span class="number">6299797573437298253264628040275849948907328879976403409079992234253896659195171862234483958852183317706433020249500667696777456584466888790659866599735145200280792478137705987287433143791976037155630359309176772317673958151640355448435973240969550879845354695745860375206302178000370970096709147495071090575765018242388707621300316998885753178573503094652529005706228511805022756376570371219075764243214260191102332714962783026379460713478294288812651004299398765770489801066856526467071118037951998756053462219010773133084404686760087508480150118199064293552990969966284945601004840346771690026959557356854894243142</span>, <span class="number">5983820380221904115440358005660480412823344425839483679019674090060688612423646544886814493835896810583739677554610487986153726859924027361158809156736196645803178995096319914672180274662462472664438431485027075620562484665653780178408855146763748596173882017604170478152671447791422988271913561725716787175269110153429606771827175728957339646431861352878283239969487426243742285835160804730331718691578524218241320715981666141098574100230167376734068738383108974392515927882240711793555447542821660698352614753928088082506778754171275154966436158307349089886252792151153113074617130452582559608047038630881997177039</span>, <span class="number">8645965524213201512342533940160639034615963495013466945596780273953897799745861434427630308300521898525016597999525817531163934211570038600077012713829688089842641388807750705270930654414851381582193662566863633088157205775657627097344504719056435375579887356258011212827309329133255360061251120340523712584772477488197868145839887008419529501177350232970834479788126170916738231188284692568626261063508315725550701926154671018704631776622326225119240790109750932269682399309418540027656506064831086635915646225839228991353015865676434534451013307891476809505965003364463706502868834742525815830814492484165778659587</span>, <span class="number">8166140295702705700395932322789090244824428366114951893911644134774959163562810185361333621863609139128772766004899397707351421904667080061768039818505350911041979508989714659275009135159974367690971928143915291585444591471643654394998052988522554930699706249604920467869677602144648519540475773077094544621879816388166112425971849485960827238183936548150306573608653859245355573339051077997289111414512279487536882904628267661230723738630443448632824642827281459881525198877210749057510831197018233179399730814958129875964180438394548470264377690208812256581197996134290095012248199229098363134875105995583143456168</span>, <span class="number">7886150187486607733887128114395381216280632497989629748521639744973030901762862876238518693357844959238094796545062411041606956447558438012468158689781248611833577676585338278147089873855656470245899229225464314602079901728048645256171396517696354087510327916826422932730522688556064550363916637523771395744826680925934243060230500845916621676929436788265600433752247152028066595489876401981088262668869028915433063354318691392248675089923289405167438193023160255479805758334680481491101176946904940583407560870907209114968515837974428072735042388612237381596523708101955987248270337329833158967647159556534902013893</span>]</span><br><span class="line">comm = (<span class="number">9026467857515594907139807322545643350722792398333959966810869076838279879742354562376888810480050803270079309674260152449220680190968011586239815898932783620194546687257066163982003360839627375768650529178687560019057911732404297565185448089372452182330617296119274984700102752558018626083227105916899465707167123429214371669495986051607781832508462509001195586237627932854012820647829936908023798167666909963391041754465967388417732502397794744032988693994711566201865393143230144593516438201799281519569197057042946810458619730130134659584342739598850633062984339223231306255977280483664354044871774659593149033209</span>, <span class="number">5887596182170973664955287957462647377802905573127495764035296813527168813405478740764981971139443147816701320451276508908764320611456709375484716332728626903126128547418401252520849124559671921918551772662755206548324883488334170067283423978156495671895979491847768306791576421069205614999618915580196468910801165217204877300901375945537974466575619851388784172797986385425693707736028155214422059085724499916277733254676564775837649200298391496783417808690237433893136207762575843230800924871422368332950754364751040187058272878178869385694948947692002564148365094951441755961075673329949416511183562799400968841515</span>)</span><br></pre></td></tr></table></figure>
<p>ç®€å•æ¢³ç†ä¸€ä¸‹é¢˜ç›®çš„å·²çŸ¥ä¿¡æ¯ï¼Œå¯ä»¥è¡¨è¾¾æˆä»¥ä¸‹ä¸¤ä¸ªå¼å­ï¼š</p>
<script type="math/tex; mode=display">
(pad(m))^{233} \equiv c\quad(mod\;n) \tag{1}</script><script type="math/tex; mode=display">
m^{d_2}+key^8+key^4+key^2 \equiv commit[0] \quad (mod\;n) \tag{2}</script><p>ç„¶åè¿˜æœ‰ï¼š</p>
<script type="math/tex; mode=display">
\sum_{i=0}^7poly[i]*key^i \equiv commit[1] \quad (mod\;n) \tag{3}</script><p>é¦–å…ˆï¼Œå¯¹äºmçš„padæ“ä½œï¼Œåªæœ‰å°‘äº256ç§å¯èƒ½ï¼Œå› æ­¤å¯ä»¥ç”¨çˆ†ç ´æ“ä½œæ±‚è§£ã€‚</p>
<p>ä¸€ä¸ªæ¯”è¾ƒæœ´ç´ çš„æ€è·¯æ˜¯ï¼šæƒ³åŠæ³•æ±‚è§£å‡º(2)ä¸­çš„d2ï¼Œç„¶åæ±‚(1)(2)ä¸¤å¼çš„GrÃ¶bneråŸºï¼Œä»è€Œç›´æ¥è§£å‡ºkeyä¸mã€‚ä½†æ˜¯ä»å·²çŸ¥çš„ä¿¡æ¯å¥½åƒå¹¶ä¸èƒ½ç®€å•æœ‰æ•ˆåœ°å¾—å‡ºå…³äºd2çš„ä¿¡æ¯ï¼Œå› æ­¤è¿™ä¸ªæ–¹æ³•ä½œç½¢ã€‚</p>
<p>ä½†æ˜¯æ¶ˆå…ƒæ˜¯åŠ¿åœ¨å¿…è¡Œçš„ï¼Œè§‚å¯Ÿåˆ°ä¸‰ä¸ªå¼å­å‡åœ¨æ¨¡nç¯ä¸Šï¼Œå› æ­¤ä¸»è¦å°±è¦æƒ³å¦‚ä½•æ¶ˆå…ƒã€‚é¦–å…ˆï¼Œæ ¹æ®(2)(3)ä¸¤å¼ï¼Œå¯ä»¥ç”¨resultantæ¶ˆå»keyï¼Œè½¬åŒ–æˆä¸€ä¸ªå…³äºm^dçš„å•å˜é‡å¤šé¡¹å¼ï¼Œç„¶åç”±(1)(2)ä¸¤å¼æ±‚gcdå°±èƒ½å¾—åˆ°mã€‚</p>
<p>ä½†æ˜¯ï¼Œè¿˜æ˜¯è€é—®é¢˜ï¼Œæ²¡æœ‰d2æ€ä¹ˆæ±‚gcdå‘¢ï¼Ÿæ‰€ä»¥æ— è®ºæ€ä¹ˆæ ·ï¼Œè¿™ä¸ªd2æ˜¯ç»•ä¸å¼€çš„ä¸€ä¸ªé—®é¢˜ï¼Œè€Œæˆ‘ä»¬èƒ½åˆ©ç”¨çš„å…³äºd2ä¿¡æ¯å°±åªæœ‰ä¸€æ¡ï¼š</p>
<script type="math/tex; mode=display">
e_2*d_2 \equiv 1 \quad (mod\;\phi(n))</script><p>å…³é”®å°±åœ¨äºæ€ä¹ˆåˆ©ç”¨ï¼Œå› ä¸ºæˆ‘ä»¬ç°åœ¨æœ‰çš„æ˜¯ä¸€ä¸ªå…³äºm^d2çš„æ¨¡nä¸‹çš„å¤šé¡¹å¼ï¼Œè€Œå¹¶ä¸æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå› æ­¤æ²¡æœ‰åŠæ³•ç®€å•çš„ç›´æ¥æ±‚e2æ¬¡å¹‚ã€‚ç„¶ååœ¨å‡ ä½å¸ˆå‚…çš„å¸®åŠ©ä¸‹ï¼Œå­¦ä¹ äº†ä¸€ä¸‹ä¼´éšçŸ©é˜µçš„ä½¿ç”¨ï¼šåœ¨sageä¸­ï¼Œå¦‚æœæ‹¥æœ‰ä¸€ä¸ªmonicçš„å¤šé¡¹å¼f(x)ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨companion_matrixå‡½æ•°å°†å…¶è½¬åŒ–ä¸ºä¸€ä¸ªä¼´éšçŸ©é˜µFï¼Œå¹¶ä¸”çŸ©é˜µFçš„ç‰¹å¾å¤šé¡¹å¼å°±æ˜¯f(x)ã€‚é‚£ä½ å¯ä»¥æƒ³åˆ°ï¼Œåœ¨è¿™é¢˜ç›®é‡Œ,æˆ‘ä»¬ç›´æ¥æŠŠm^d2çœ‹ä½œå˜é‡xï¼Œé‚£ä¹ˆf(x)æœ‰æ ¹m^d2ï¼Œè€Œm^d2æ—¢æ˜¯f(x)çš„æ ¹ï¼Œä¹Ÿæ˜¯Fçš„ç‰¹å¾å€¼ã€‚</p>
<p>è€ŒçŸ©é˜µæ˜¯å¯ä»¥æ±‚å¹‚æ¬¡çš„ï¼ŒF^e2æ¬¡æ–¹çš„ç‰¹å¾å€¼å°±æ˜¯m^(d2*e2)ï¼Œé‚£ä¹ˆåœ¨æ¨¡nçš„ç¯ä¸‹ï¼Œè¯¥ç‰¹å¾å€¼å°±æ˜¯mï¼Œæ­¤æ—¶æˆ‘ä»¬å†ç”¨charpolyå‡½æ•°æ±‚F^e2çš„ç‰¹å¾å¤šé¡¹å¼ï¼Œå°±å¾—åˆ°äº†ä¸€ä¸ªæ ¹ä¸ºmçš„å¤šé¡¹å¼äº†ã€‚</p>
<p>é‚£ä¹ˆæ¥ä¸‹æ¥çš„å·¥ä½œå°±å¾ˆå®¹æ˜“ï¼ŒæŠŠè¯¥å¤šé¡¹å¼å’Œ(1)å¼æ±‚è§£gcdï¼Œå°±èƒ½å¾—åˆ°(x-m)ï¼Œå°±èƒ½å¾—åˆ°æ˜æ–‡mäº†ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GCD</span>(<span class="params">g1, g2</span>):</span><br><span class="line">        <span class="keyword">while</span> g2:</span><br><span class="line">            g1, g2 = g2, g1 % g2</span><br><span class="line">        <span class="keyword">return</span> g1.monic()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Part1: RSA-Encrypted Ciphertext</span></span><br><span class="line">e1 = <span class="number">233</span></span><br><span class="line">n = <span class="number">11804593083540766953191768473584891632857464298610295673456410319093405751966708262984066641796004658380825990723088997287209884308749055923966759203552497405777188930982989535372734594928432767182748217929177897158889489317608554405915470112027996617864702664597137007278287666634774284031478676422259138168442639629844443754737406734109480041155382192976640499144347256893867447543190494469466088332396851821283556702874066317163371254358756837283841870127393406798300254660201670728912096447184875821681550977470988174485488514169553325962974156396460297399345856735492168813016282687198473612371220123462499438299</span></span><br><span class="line">c1 = <span class="number">4236463649246394372490570028773321531426122440354351428997745409269923078428264643984899276198044684405861411922920531424639487584475747440112668094733950281377813868988540407013967573584191516922420060508458881142111648007775541541206593622564564631875373635260315932740995440619035591722675173125322220642392862827996987221780888705796026865917969313975598350208578877195524822778355327253625950282635041414028859491576352297298051077024341409125083650148374909480761558443601847884116325029903499801566422663448734010004472905405209374692154735955178855634936508017264189084568424915164265136679303107745093554391</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Part2: RSA-Committed Promise</span></span><br><span class="line">e2 = <span class="number">99181398864848350371016820825262886005052515653150198897546275436659368873943</span></span><br><span class="line">n = <span class="number">11804593083540766953191768473584891632857464298610295673456410319093405751966708262984066641796004658380825990723088997287209884308749055923966759203552497405777188930982989535372734594928432767182748217929177897158889489317608554405915470112027996617864702664597137007278287666634774284031478676422259138168442639629844443754737406734109480041155382192976640499144347256893867447543190494469466088332396851821283556702874066317163371254358756837283841870127393406798300254660201670728912096447184875821681550977470988174485488514169553325962974156396460297399345856735492168813016282687198473612371220123462499438299</span></span><br><span class="line">poly = [<span class="number">11693140800527031176333218506340138430240732192854115958431704393516665671354696442539228569575338743555295185742126489158430815263152939757778849261704565332700814864041988371030487621611557506812653488873444536543143499111306076278080422306914610758456202844384883419669780999835836102076447921204517046598938140064244383099665415296806730515287813702062130475281955202867695799707516205462251852912274330831232375362037653669046715539164625549785400699583991291522758317569231805551847554593188947041531361947659444681456741424693383958548943092649257246992511287359572983628972516677506780721131000304618999959240</span>, <span class="number">8649833849514355009128561581797540267452805179286553003531347469534976088903045945255322948772127884435044654450320045837146400545547035413423698519877318250595578140049443137749594587635124784776640002144869420735353810166877391696732603701567388813523929688499591774843294322221335666734637085035509293762539158494372418206937167893545676403532672666734540153869114591107560124251452526082108870638702356111887843199439729119638581693415233654435010304861838471514755642714031294943492873471199466178392719343340089957082809543276507257853855309815913146064538017999492250838671852901021723088900839652630087246141</span>, <span class="number">10438652195883831412435505413668253747222376993835057512571018586886172468948369796145782100970559858131410652399919261454018181151110711244715955202406007064700539815605400586293839962095578425689125884220411946405356203770630361655071021743875660757465221991116870667245627142015074048387044977823496726850652712591020608153928488470683315016742274925734216097962308837642472645606961264797331661105479206824511239562468503777960135923781994521205671697654968415294210654160582131094288074290198995839634141037654146239631046959485219534841518635072303135929794463631818179287771643492272214514760725403082404954077</span>, <span class="number">6299797573437298253264628040275849948907328879976403409079992234253896659195171862234483958852183317706433020249500667696777456584466888790659866599735145200280792478137705987287433143791976037155630359309176772317673958151640355448435973240969550879845354695745860375206302178000370970096709147495071090575765018242388707621300316998885753178573503094652529005706228511805022756376570371219075764243214260191102332714962783026379460713478294288812651004299398765770489801066856526467071118037951998756053462219010773133084404686760087508480150118199064293552990969966284945601004840346771690026959557356854894243142</span>, <span class="number">5983820380221904115440358005660480412823344425839483679019674090060688612423646544886814493835896810583739677554610487986153726859924027361158809156736196645803178995096319914672180274662462472664438431485027075620562484665653780178408855146763748596173882017604170478152671447791422988271913561725716787175269110153429606771827175728957339646431861352878283239969487426243742285835160804730331718691578524218241320715981666141098574100230167376734068738383108974392515927882240711793555447542821660698352614753928088082506778754171275154966436158307349089886252792151153113074617130452582559608047038630881997177039</span>, <span class="number">8645965524213201512342533940160639034615963495013466945596780273953897799745861434427630308300521898525016597999525817531163934211570038600077012713829688089842641388807750705270930654414851381582193662566863633088157205775657627097344504719056435375579887356258011212827309329133255360061251120340523712584772477488197868145839887008419529501177350232970834479788126170916738231188284692568626261063508315725550701926154671018704631776622326225119240790109750932269682399309418540027656506064831086635915646225839228991353015865676434534451013307891476809505965003364463706502868834742525815830814492484165778659587</span>, <span class="number">8166140295702705700395932322789090244824428366114951893911644134774959163562810185361333621863609139128772766004899397707351421904667080061768039818505350911041979508989714659275009135159974367690971928143915291585444591471643654394998052988522554930699706249604920467869677602144648519540475773077094544621879816388166112425971849485960827238183936548150306573608653859245355573339051077997289111414512279487536882904628267661230723738630443448632824642827281459881525198877210749057510831197018233179399730814958129875964180438394548470264377690208812256581197996134290095012248199229098363134875105995583143456168</span>, <span class="number">7886150187486607733887128114395381216280632497989629748521639744973030901762862876238518693357844959238094796545062411041606956447558438012468158689781248611833577676585338278147089873855656470245899229225464314602079901728048645256171396517696354087510327916826422932730522688556064550363916637523771395744826680925934243060230500845916621676929436788265600433752247152028066595489876401981088262668869028915433063354318691392248675089923289405167438193023160255479805758334680481491101176946904940583407560870907209114968515837974428072735042388612237381596523708101955987248270337329833158967647159556534902013893</span>]</span><br><span class="line">comm = (<span class="number">9026467857515594907139807322545643350722792398333959966810869076838279879742354562376888810480050803270079309674260152449220680190968011586239815898932783620194546687257066163982003360839627375768650529178687560019057911732404297565185448089372452182330617296119274984700102752558018626083227105916899465707167123429214371669495986051607781832508462509001195586237627932854012820647829936908023798167666909963391041754465967388417732502397794744032988693994711566201865393143230144593516438201799281519569197057042946810458619730130134659584342739598850633062984339223231306255977280483664354044871774659593149033209</span>, <span class="number">5887596182170973664955287957462647377802905573127495764035296813527168813405478740764981971139443147816701320451276508908764320611456709375484716332728626903126128547418401252520849124559671921918551772662755206548324883488334170067283423978156495671895979491847768306791576421069205614999618915580196468910801165217204877300901375945537974466575619851388784172797986385425693707736028155214422059085724499916277733254676564775837649200298391496783417808690237433893136207762575843230800924871422368332950754364751040187058272878178869385694948947692002564148365094951441755961075673329949416511183562799400968841515</span>)</span><br><span class="line"></span><br><span class="line">P.&lt;x, y&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">x, y = P.gens()</span><br><span class="line">f = <span class="built_in">sum</span>([poly[i] * x^i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(poly))]) - comm[<span class="number">1</span>]</span><br><span class="line">g = x^<span class="number">2</span> + x^<span class="number">4</span> + x^<span class="number">8</span> + y - comm[<span class="number">0</span>]</span><br><span class="line">h = f.sylvester_matrix(g, x).det().univariate_polynomial().monic()</span><br><span class="line">h_coefficients = h.coefficients()</span><br><span class="line">Hd2 = companion_matrix(h_coefficients)</span><br><span class="line">H = Hd2^e2</span><br><span class="line">final = H.charpoly()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">200</span>,<span class="number">255</span>):</span><br><span class="line">    length = (<span class="number">2048</span> // <span class="number">8</span> - i - <span class="number">1</span>)</span><br><span class="line">    f1 = ((x * <span class="number">256</span>^length + bytes_to_long(long_to_bytes(i) * length))^e1 - c1).univariate_polynomial()</span><br><span class="line">    mm = GCD(final, f1)</span><br><span class="line">    <span class="keyword">if</span> mm <span class="keyword">not</span> <span class="keyword">in</span> ZZ:</span><br><span class="line">        m = <span class="built_in">int</span>(-mm.monic()[<span class="number">0</span>])</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">        <span class="keyword">break</span> </span><br><span class="line">        </span><br><span class="line"><span class="comment">#flag&#123;07ba38d7a9affba269a613da6d99a7ff&#125;</span></span><br></pre></td></tr></table></figure>
<p>å…¶å®å¾ˆå¤šç»†èŠ‚æˆ‘æ‡‚çš„å¹¶ä¸é€å½»ï¼ŒåŒ…æ‹¬å„ç§sageå‡½æ•°çš„ä½¿ç”¨ï¼Œéœ€è¦å¤šå¤šå­¦ä¹ äº†ã€‚</p>
<p><br></p>
<p><br></p>
<h3 id="easycrt"><a href="#easycrt" class="headerlink" title="easycrt"></a>easycrt</h3><p>é¢˜ç›®æ¥æºï¼šå¹¿ä¸œå¼ºç½‘æ¯ 2021 ä¸ªäººå†³èµ›</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, long_to_bytes</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> gcd,invmod</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = p * q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n&quot;</span>,n)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span> + sha1(long_to_bytes(q)).hexdigest() + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">r1 = getPrime(<span class="number">18</span>)</span><br><span class="line">r2 = getPrime(<span class="number">18</span>)</span><br><span class="line">r3 = getPrime(<span class="number">18</span>)</span><br><span class="line">pad = getPrime(<span class="number">18</span>)</span><br><span class="line"></span><br><span class="line">d = invmod(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">iq = invmod(q*r2,p*r1)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    m = randint(<span class="number">1</span>, n-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> m % <span class="number">7</span> == <span class="number">6</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;m&quot;</span>,m)</span><br><span class="line"></span><br><span class="line">dp = d % (p - <span class="number">1</span>)</span><br><span class="line">dq = d % (q - <span class="number">1</span>)</span><br><span class="line">Sp = <span class="built_in">pow</span>(m + pad, dp, p * r1)</span><br><span class="line">S1 = <span class="built_in">pow</span>(m, dp % (r1 - <span class="number">1</span>), r1)</span><br><span class="line">Sq = <span class="built_in">pow</span>(m, dq, q * r2)</span><br><span class="line">S2 = <span class="built_in">pow</span>(m, dq % (r2 - <span class="number">1</span>), r2)</span><br><span class="line">S = Sq + (q * r2) * (iq * (Sp - Sq) % (p * r1))</span><br><span class="line">c1 = (S - S1 + <span class="number">1</span>) % r1</span><br><span class="line">c2 = (S - S2 + <span class="number">1</span>) % r2</span><br><span class="line">y = (r3 * c1 + (<span class="number">2</span>**<span class="number">18</span> - r3) * c2) // <span class="number">2</span>**<span class="number">18</span></span><br><span class="line"></span><br><span class="line">sig = <span class="built_in">pow</span>(S, y, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;sig&quot;</span>,sig)</span><br></pre></td></tr></table></figure>
<p>enc.txtï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">n = 15607652517362093645325317106793899509049466286289406123011562305732952834110025278707770877710387511133525615547749067167022163144871246026729711471170089144091842130735468670759804996736436114870014417745362424832770744726487119356277902631543992047543702092569479132696642375458263796132196310174835558347436349470015821172039278202738123606756327018331739326913099131587338291813228001362150294270185257672772964543656446660394264977076202429526267205338019235884610484301330863633308326891900441046466311908648695612469874605299959023321039907455357375512719105021644958752946075704546448277530349374124925552999</span><br><span class="line">sig = 10529383690563626041913943912548148193819837348659016705087283692659198195639818226546674852244543732342882844923086010181839287638468160452876441986475739097061958400475370429389938633409459705321551413680888540996412276373484717577799632143058273282184901897121998551083953391761808538319274041663569149845813852812460215349964039044454715161276326154052689106577168080671792457943959674009099696029742287088741014864890643610109608810518217249714342499311259749863368245284452473571531519289299316677019474225948437231068806941146456877792741550185160112281625929417877458463803652501300748844407304985956111227832</span><br><span class="line">m = 9221389214846452074650198574187733045048782681343858755771769264298997816865330014844850679483076796014601281496675756079954850050104766792742802672859212829451854911463986483312887597249074612447791144976425525708325445215521780736722325242438897188724275411273730095000042905697065812817717123169837477587937321878898881598591204738992809905166463654289137499334014194236642634848110827034366887478823691109550776819273014443942468214983033609722152912395399288856874022406788892463061718806118721777027702827433908594054906653446257493698282318911042247500866249480426304090761922444970044089807749920717682404402</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®çš„ä¿¡æ¯å¾ˆå¤šï¼Œå®Œæˆè¿™ä¸€é¢˜çš„å…³é”®å°±æ˜¯è¦æ³¨æ„åˆ°å…¶ä¸­çœŸæ­£æœ‰ç”¨çš„å‡ ä¸ªä¿¡æ¯ï¼Œå¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
S_q = m^{dq} \quad (mod\; r_2q)</script><script type="math/tex; mode=display">
S = S_q + r_2q*(iq*(S_p-S_q) \;mod \;(r_1p))</script><script type="math/tex; mode=display">
sig = S^{y} \quad (mod\;n)</script><p>è¿™å‡ ä¸ªä¿¡æ¯æœ‰ç”¨åœ¨å“ªé‡Œå‘¢ï¼Ÿé¦–å…ˆï¼ŒSå…¶å®å°±æ˜¯å¯¹Spã€Sqçš„ä¸­å›½å‰©ä½™å®šç†ç»„åˆï¼Œå‘¼åº”é¢˜ç›®crtã€‚ä¸è¿‡æ²¡çœ‹å‡ºæ¥ä¹Ÿä¸é‡è¦ï¼Œæˆ‘ä»¬æŠŠè¿™å‡ ä¸ªå¼å­å‡æ”¾åœ¨æ¨¡qä¸‹åˆ†æï¼š</p>
<script type="math/tex; mode=display">
S_q \equiv m^{dq} \quad (mod\;q)</script><script type="math/tex; mode=display">
S \equiv S_q \quad (mod\;q)</script><script type="math/tex; mode=display">
sig \equiv S^y \quad(mod\;q)</script><p>é¦–å…ˆæœ‰ï¼š</p>
<script type="math/tex; mode=display">
S_q^e \equiv m \quad(mod\;q)</script><p>å› æ­¤ï¼š</p>
<script type="math/tex; mode=display">
sig^e \equiv m^y \quad (mod\;q)</script><p>è€Œæ³¨æ„åˆ°yç”±å¦‚ä¸‹æ–¹å¼äº§ç”Ÿï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">y = (r3 * c1 + (<span class="number">2</span>**<span class="number">18</span> - r3) * c2) // <span class="number">2</span>**<span class="number">18</span></span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­çš„å‡ ä¸ªå‚æ•°å‡è¾ƒå°ï¼Œå› æ­¤yçš„æ•°é‡çº§å¤§çº¦ä¹Ÿå°±åœ¨2^18ä»¥å†…ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥çˆ†ç ´yï¼Œä»è€Œæœ‰ï¼š</p>
<script type="math/tex; mode=display">
sig^e - m^y = kq</script><p>æ±‚è§£è¯¥å¼ä¸nçš„gcdå°±èƒ½å¾—åˆ°qï¼Œè¿›è€Œæ¢å¤flagã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">15607652517362093645325317106793899509049466286289406123011562305732952834110025278707770877710387511133525615547749067167022163144871246026729711471170089144091842130735468670759804996736436114870014417745362424832770744726487119356277902631543992047543702092569479132696642375458263796132196310174835558347436349470015821172039278202738123606756327018331739326913099131587338291813228001362150294270185257672772964543656446660394264977076202429526267205338019235884610484301330863633308326891900441046466311908648695612469874605299959023321039907455357375512719105021644958752946075704546448277530349374124925552999</span></span><br><span class="line">sig = <span class="number">10529383690563626041913943912548148193819837348659016705087283692659198195639818226546674852244543732342882844923086010181839287638468160452876441986475739097061958400475370429389938633409459705321551413680888540996412276373484717577799632143058273282184901897121998551083953391761808538319274041663569149845813852812460215349964039044454715161276326154052689106577168080671792457943959674009099696029742287088741014864890643610109608810518217249714342499311259749863368245284452473571531519289299316677019474225948437231068806941146456877792741550185160112281625929417877458463803652501300748844407304985956111227832</span></span><br><span class="line">m = <span class="number">9221389214846452074650198574187733045048782681343858755771769264298997816865330014844850679483076796014601281496675756079954850050104766792742802672859212829451854911463986483312887597249074612447791144976425525708325445215521780736722325242438897188724275411273730095000042905697065812817717123169837477587937321878898881598591204738992809905166463654289137499334014194236642634848110827034366887478823691109550776819273014443942468214983033609722152912395399288856874022406788892463061718806118721777027702827433908594054906653446257493698282318911042247500866249480426304090761922444970044089807749920717682404402</span></span><br><span class="line"></span><br><span class="line">c1 = <span class="built_in">pow</span>(sig,<span class="number">65537</span>,n)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">2</span>**<span class="number">18</span>):</span><br><span class="line">    <span class="keyword">if</span>(GCD(c1-<span class="built_in">pow</span>(m,i,n),n) != <span class="number">1</span>):</span><br><span class="line">        q = GCD(c1-<span class="built_in">pow</span>(m,i,n),n)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;NSSCTF&#123;&quot;</span> + sha1(long_to_bytes(q)).hexdigest() + <span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#NSSCTF&#123;947d9f457b224fb7779b84158ea72861b4e72af3&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="BABY-RSA"><a href="#BABY-RSA" class="headerlink" title="BABY RSA"></a>BABY RSA</h3><p>é¢˜ç›®æ¥æºï¼šHITCTF 2021</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">size = <span class="number">4096</span></span><br><span class="line">next_state = getRandomInteger(size // <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">keygen</span>(<span class="params">size</span>):</span><br><span class="line">    q = getPrime(size)</span><br><span class="line">    k = <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = q * k + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> isPrime(p):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">    g = <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">pow</span>(g, q, p) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        g += <span class="number">1</span></span><br><span class="line">    A = getRandomInteger(size) % q</span><br><span class="line">    B = getRandomInteger(size) % q</span><br><span class="line">    d = getRandomInteger(size) % q</span><br><span class="line">    h = <span class="built_in">pow</span>(g, d, p)</span><br><span class="line">    <span class="keyword">return</span> (g, h, A, B, p, q)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rand</span>(<span class="params">A, B, M</span>):</span><br><span class="line">    <span class="keyword">global</span> next_state</span><br><span class="line">    next_state, ret = (B * next_state + A) % M, next_state</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">pubkey, m</span>):</span><br><span class="line">    g, h, A, B, p, q = pubkey</span><br><span class="line">    <span class="keyword">assert</span> <span class="number">0</span> &lt; m &lt;= p</span><br><span class="line">    r = rand(A, B, q)</span><br><span class="line">    e = <span class="number">0xfaab</span></span><br><span class="line">    c1 = (<span class="built_in">pow</span>(m,e,p) * <span class="built_in">pow</span>(h, r, p)) % p</span><br><span class="line">    r = rand(A, B, q)</span><br><span class="line">    c2 = (m * <span class="built_in">pow</span>(h, r, p)) % p</span><br><span class="line">    <span class="keyword">return</span> (c1, c2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pubkey= keygen(size)</span><br><span class="line"><span class="built_in">print</span>(pubkey)</span><br><span class="line"></span><br><span class="line">secret = bytes_to_long(<span class="string">&quot;HITCTF2021(xxxxxxxxxxxxxxxxxxx)&quot;</span>)</span><br><span class="line">c1,c2= enc(pubkey, secret)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(c1, c2)</span><br><span class="line"></span><br><span class="line"><span class="comment">#pk = (52, </span></span><br><span class="line"><span class="comment">#47782489586021221729935382562238217213800826152327617948974334325027793433971508995399461776417812670604694882926777607105164020070178881963632306169611641854448509182837621758791538269408388860349616761041456174827996858614494726877767399938809515247000929894281600963992080920650256329287847887064428158469516438206831721224607859023980203694210651902538562842945949404149023836218548894116477022953606370852246884414011363477543284815671096832245521762246149180260936985618856296642080245029837974725521906177900378634071571992373478242159162403228753252168867425697897820696887070051128304178291193132322824455442092893684929701869625045112839344191126228806117685809636908190595562295591835629941512331963039016185366202513504464795106031092314892430859175307526232632986110464780357940552264674214665391043812843917461961230679207586174459563057178720743465356337218948534837994061644332424634750340190113117958830588820626581860957277456320434445207368613679418733984291985618038226928033006640791987978775285182325347153201516936002001839296455263977479446850434913069389565277028444638437387429263495729274142916464752814676819557878779855996225208596159171827854923873570163767937947956753277454486339143489103105750331110111L,</span></span><br><span class="line"><span class="comment">#433229619560374735022060612660487139311547277564407316269466855779330930804160973325703376198605206390912154427123102710354958367692760474727012214464298979098489170777185729836132968187705068687678796437447631516334893543456227545790012358063578349956636488453355182971532300478038635153420232589545761194907476691636706445176390661463152150169542241304542401678253873515488446133330974312465916350895130227137954122794991542025930903127027608739905609108321738139103065645651901833223353774916656293079960486497159730921219805951217073283062070931854507016733789164315751827862830668829125950364981217520865411859759718244136420504507997449935455788230060974032741364271601426191469331266168231203426316280988734802654397014768828735251891167507794161264913387252048434549271931367148180980260205843989153008044839641263127846901551223167574691783927938948745126094512037792728067785201012834153473172824948188352810070916677679450209134179624791196123158336411804834221293611075447043002901607162001357780058394706516204775756666576041740010288970758149528406172022049389998133360726123682741312251431519423867620962951022993364287241463507027520966721930799696555390707280246584903566049326608205785466271642132178515338520410658L, </span></span><br><span class="line"><span class="comment">#594494499417894774789048451572687632660208181953899084791149805130704950465573064455173172705283156011806901684972459390817538594318847879599780068410149543731305374894040638491310362570467887919519584736646557258917947483658649575357363123407313011773027073062592473100264464401987309633458687673513776139455296286685115396610808047870099635374955339289799615102534094497730932884838674370338192153202045642565170696704452991192684466848026383861073123033948004049599266417667125680356386669226827901570782628388996520826906941293858994180130505009152517646592286697346622724843482147801718703310671546709185342317509441259927498881276856470161174444209513355803640646947368551446328198695259259829546707119878154837158880677882305548928799964929213106969848547576414765380870575558771867763848114411251654245747231121164090765647221739709450477815688276801154266722035408374135871417564206013020997849375553619152730479571927135850379285559873197371293312934173379820835252091990919727655797413411368987930118553258247264348519581466374312010472449698571319621067244494880512957538208007914329691196084901181642263713183616896210154681618376310287185315262021479758282631576946335858068664109425856174388362174761355148787245515144L, </span></span><br><span class="line"><span class="comment">#261181509476485410165375351178418657075805043256124045823778754055035546150122155335065215645750231604267318872693494310557376958843829685914382636208107544361140482291909865660810395856913449414106045946602124226832733980696161639105193768954092281635195760991693212657816181524313660831938528737461195472275606167593968953647934279724693129491600232382201769523725243272086370087058597321533767924008747705935388941121530345216164771817150616453601212026925759807092457510188966636612860912597984231762129535299227711879953931847880037605415987083573556274570400085013894504645789376654166259691075373526751505971657856429187752015665407876751018316490729668209646098952144838144486106489379202197360745365239628186669447122272538227142855706247593556669905666428363734481409983627496127639634726855140379146669911302677456457202808949896992958886949162850488164457334796828240069980922051762068458877051063958308363343196940785994299643315504146607392461323382470475501119070077564995866998018505817611171892860136485534016608294708527673407517876647349723758712907513973353401204912431800080247493896815299218218930415151745986776831977527196435124521552249406640177674130330651411672455343809240941664288436809369136070604763156723L, </span></span><br><span class="line"><span class="comment">#781980567294866497501123805923409152921571985796778580310714832500106425599168129745704238460330034743315325966148186558555020834861765526689768371880561510063294857161406783415599987595549249742832472894018336008481239463162160596123334637587102639626334613747584469035377788994951080335145295621141303809208401699383140579784234370433212962549701294557490327915345039736785539182810171621358586598828585945914338147070450135377738837775900049262279077924927424572133106317931037834170242253287377939407573458979723688263335125293054004806634691866986695432845509236568546421095177774413671436200824471636980556801370827632298658729537149331589875199074040922783371553748936641151156007453231144303475285524669545469070200964887839003421723671399980708592531935414262678088053843196096190537828523518384368702604524858315737895816793263164649577505835816917629234902199990503712784374018119048109158314524143587749590847895032293396106716513485468884408566836474462501500356497238218550499994067382687458598481617175106389271282319486609800621311007926196777720697327886147764674266204885628982776927834776344964727336572310616726876742447686216871630304048650918084364293803385183867282800430566589645701462385656793820570672943583L)</span></span><br><span class="line"><span class="comment">#c1,c2 = (94439884067875866926510480826480805218086956848743547499198006820458557396798764306362789177343865957780128049481100649740991723046823411381255593998762330282701428367295145704749575923764033888430043419432755523895502809914793389377786178823780078298402526077689075100615167801149188073166609798060195606072633000544828049766057724062947725409167355039403877440527580919770561607036599124342541749265192021823491918944278440530549040290346018294412510920437610359378345321588108996817523300112050660236797578506114472897358316471445079369284771733206616722439988368610144077799745808242486800244677553898369876207696781377538070465563883203111584722721805287175889444151342208592141472448213468221732504380079996468560634932304003913239528756529682825338927264423302712140156109639630352986070846491530710979222740690647201189995078959423441714667664068681190006816257273563900319001844315873583504406793282181337548468252678860728542345494826571860793722889527787190697802307747398283993641414712543326007228545296721676768940364724157476527100408795556913732012808496296586935767075610857696900781575977854898411278115773743046743452254128886824788564219765260031723480676483312846917497210349237445933078576069670523680684713623446L, 36397082263544765924779841921119370016762339442058655416586193728619075025998163340396086334077244844310435402140631243689371206933579011146142036715931618067708305508617210563902014072058872403638202493268214994615135134434419245572034705984431586848768861656760831721539666418749603708776469542844144251059399582543923184073020411373179905155719536662312209785364646479188735299232303697790049147771382959302788060004896713986087257232599766636580823138965201801581260077589060485570410897810958498454358737888682940093471597533949463149992040055832220962541050083923086389598838921222167415555331634007862804183991931445726265293675584802614392692457772587297132115782027787479633548163420352103982803350538152059924978489540395956166707435927694988026192837010341182919501051673735679100778154041581361254807291072654267471473503037873994575370262350787611333206450177404857861689910339996980215797433744385047164909022377659304404477322770853683922772248965438499817404000913895236832920522508813098567854697829563333570746651008308539370730448094601234580689549622502198266967939450827346984012446321546195185770288650359658551649011648788273482810013579385313367223458143686448798406205345442061625590854243243883117300950978940L)</span></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®å‚æ•°è¾ƒå¤šï¼Œå› æ­¤éœ€è¦æ¢³ç†ä¸€ä¸‹å„ä¸ªå‚æ•°çš„äº§ç”Ÿæ–¹å¼ä»¥åŠå„ä¸ªå‡½æ•°çš„ä½œç”¨ã€‚</p>
<p>é¦–å…ˆæ˜¯å‚æ•°ï¼š</p>
<ul>
<li>pã€qå‡ä¸ºç´ æ•°ï¼Œä¸”æœ‰ p = kq+1</li>
<li>é€‰å–ä¸€ä¸ªé˜¶ä¸ºqçš„æ•°g</li>
<li>éšæœºç”Ÿæˆä¸‰ä¸ªå°äºqçš„å‚æ•°Aã€Bã€d</li>
<li>è®¡ç®—h=g^d % pï¼Œè¿”å›å‚æ•°(g, h, A, B, p, q)</li>
</ul>
<p>ç„¶åæ˜¯å‡½æ•°ï¼š</p>
<ul>
<li>randå‡½æ•°ï¼Œå®ç°ä¸€ä¸ªLCGåŠŸèƒ½</li>
<li>encå‡½æ•°ï¼Œå°†flagè¿›è¡Œå¦‚ä¸‹åŠ å¯†ï¼Œå¹¶è¿”å›c1ã€c2ï¼š</li>
</ul>
<script type="math/tex; mode=display">
c1 \equiv m^eh^r \quad(mod\;p)</script><script type="math/tex; mode=display">
c2 \equiv mh^{Br+A \;(mod\;q)} \quad(mod\;p)</script><p>é¦–å…ˆè§‚å¯Ÿåˆ°c1ã€c2ä¸­æœªçŸ¥çš„å‚æ•°ä¸€å…±åªæœ‰mä¸rï¼Œè€Œmæ˜¯æˆ‘ä»¬éœ€è¦æ±‚è§£çš„flagï¼Œå› æ­¤éœ€è¦æƒ³åŠæ³•æ¶ˆæ‰rã€‚è€Œråœ¨æŒ‡æ•°ä¸Šå¹¶ä¸”æ¨¡äº†qï¼Œæ‰€ä»¥è¦å…ˆåˆ¤æ–­å‡ºè¿™ä¸ªæ¨¡qçš„ä½œç”¨ã€‚</p>
<p>è€Œåœ¨å‚æ•°ç”Ÿæˆä¸­ï¼Œæˆ‘ä»¬åˆ†æè¿‡gæ˜¯ä¸€ä¸ªé˜¶ä¸ºqçš„å…ƒç´ ï¼Œè€Œh=g^d % pï¼Œé‚£ä¹ˆç”±å…ƒç´ çš„é˜¶çš„ç›¸å…³çŸ¥è¯†å¯ä»¥çŸ¥é“ï¼Œhçš„é˜¶ä¸ºï¼š</p>
<script type="math/tex; mode=display">
\frac{q}{gcd(d,q)}</script><p>è€Œç”±äºqæ˜¯ä¸ªç´ æ•°ï¼Œå› æ­¤hä¹Ÿæ˜¯ä¸€ä¸ªé˜¶ä¸ºqçš„ç´ æ•°ï¼Œæ‰€ä»¥æ»¡è¶³ï¼š</p>
<script type="math/tex; mode=display">
h^q \equiv 1 \quad(mod\;p)</script><p>è¿™æ ·è¯´åªæ˜¯ä¸ºäº†äº†è§£çš„æ›´æ¸…æ¥šä¸€ç‚¹ï¼Œå®é™…ä¸Šåªéœ€è¦å°†h=g^dä»£å…¥è®¡ç®—ä¹Ÿèƒ½å‘ç°ä¸Šå¼ã€‚è€Œè¿™ä¸ªå¼å­çš„ä½œç”¨å°±æ˜¯æ¶ˆé™¤æ¨¡qåœ¨æŒ‡æ•°ä¸Šçš„å½±å“ï¼Œå¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
h^{Br+A \;(mod\;q)} \equiv h^{Br+A+kq} \equiv h^{Br+A}*(h^q)^k  \equiv h^{Br+A} \quad (mod\;p)</script><p>æ‰€ä»¥åœ¨æ¶ˆå…ƒè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å…¶å®ä¸éœ€è¦å…³æ³¨qã€‚å› æ­¤æ¶ˆå…ƒåˆ†ææ­¥éª¤å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
c2 \equiv mh^{rB}h^A \quad(mod\;p)</script><script type="math/tex; mode=display">
c1^B \equiv m^{eB}h^{rB} \quad(mod\;p)</script><p>æ‰€ä»¥ï¼š</p>
<script type="math/tex; mode=display">
c1^Bc2^{-1}h^A \equiv m^{eB}h^{rB}*m^{-1}h^{-rB}h^{-A}*h^A \equiv m^{eB-1} \quad (mod\;p)</script><p>å› æ­¤æˆ‘ä»¬è·å¾—äº†ï¼š</p>
<script type="math/tex; mode=display">
m^{eB-1} \quad (mod\;p)</script><p>å¯ä»¥ç›´æ¥RSAè§£å¯†ï¼Œä½†æ˜¯å‘ç°eB-1ä¸p-1æœ‰å…¬å› å­167ï¼Œå› æ­¤éœ€è¦å…ˆæ±‚è§£éƒ¨åˆ†é€†å…ƒåAMMå¼€æ ¹ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">(g, h, A, B, p, q) = (<span class="number">52</span>, <span class="number">47782489586021221729935382562238217213800826152327617948974334325027793433971508995399461776417812670604694882926777607105164020070178881963632306169611641854448509182837621758791538269408388860349616761041456174827996858614494726877767399938809515247000929894281600963992080920650256329287847887064428158469516438206831721224607859023980203694210651902538562842945949404149023836218548894116477022953606370852246884414011363477543284815671096832245521762246149180260936985618856296642080245029837974725521906177900378634071571992373478242159162403228753252168867425697897820696887070051128304178291193132322824455442092893684929701869625045112839344191126228806117685809636908190595562295591835629941512331963039016185366202513504464795106031092314892430859175307526232632986110464780357940552264674214665391043812843917461961230679207586174459563057178720743465356337218948534837994061644332424634750340190113117958830588820626581860957277456320434445207368613679418733984291985618038226928033006640791987978775285182325347153201516936002001839296455263977479446850434913069389565277028444638437387429263495729274142916464752814676819557878779855996225208596159171827854923873570163767937947956753277454486339143489103105750331110111</span>,<span class="number">433229619560374735022060612660487139311547277564407316269466855779330930804160973325703376198605206390912154427123102710354958367692760474727012214464298979098489170777185729836132968187705068687678796437447631516334893543456227545790012358063578349956636488453355182971532300478038635153420232589545761194907476691636706445176390661463152150169542241304542401678253873515488446133330974312465916350895130227137954122794991542025930903127027608739905609108321738139103065645651901833223353774916656293079960486497159730921219805951217073283062070931854507016733789164315751827862830668829125950364981217520865411859759718244136420504507997449935455788230060974032741364271601426191469331266168231203426316280988734802654397014768828735251891167507794161264913387252048434549271931367148180980260205843989153008044839641263127846901551223167574691783927938948745126094512037792728067785201012834153473172824948188352810070916677679450209134179624791196123158336411804834221293611075447043002901607162001357780058394706516204775756666576041740010288970758149528406172022049389998133360726123682741312251431519423867620962951022993364287241463507027520966721930799696555390707280246584903566049326608205785466271642132178515338520410658</span>, <span class="number">594494499417894774789048451572687632660208181953899084791149805130704950465573064455173172705283156011806901684972459390817538594318847879599780068410149543731305374894040638491310362570467887919519584736646557258917947483658649575357363123407313011773027073062592473100264464401987309633458687673513776139455296286685115396610808047870099635374955339289799615102534094497730932884838674370338192153202045642565170696704452991192684466848026383861073123033948004049599266417667125680356386669226827901570782628388996520826906941293858994180130505009152517646592286697346622724843482147801718703310671546709185342317509441259927498881276856470161174444209513355803640646947368551446328198695259259829546707119878154837158880677882305548928799964929213106969848547576414765380870575558771867763848114411251654245747231121164090765647221739709450477815688276801154266722035408374135871417564206013020997849375553619152730479571927135850379285559873197371293312934173379820835252091990919727655797413411368987930118553258247264348519581466374312010472449698571319621067244494880512957538208007914329691196084901181642263713183616896210154681618376310287185315262021479758282631576946335858068664109425856174388362174761355148787245515144</span>, <span class="number">261181509476485410165375351178418657075805043256124045823778754055035546150122155335065215645750231604267318872693494310557376958843829685914382636208107544361140482291909865660810395856913449414106045946602124226832733980696161639105193768954092281635195760991693212657816181524313660831938528737461195472275606167593968953647934279724693129491600232382201769523725243272086370087058597321533767924008747705935388941121530345216164771817150616453601212026925759807092457510188966636612860912597984231762129535299227711879953931847880037605415987083573556274570400085013894504645789376654166259691075373526751505971657856429187752015665407876751018316490729668209646098952144838144486106489379202197360745365239628186669447122272538227142855706247593556669905666428363734481409983627496127639634726855140379146669911302677456457202808949896992958886949162850488164457334796828240069980922051762068458877051063958308363343196940785994299643315504146607392461323382470475501119070077564995866998018505817611171892860136485534016608294708527673407517876647349723758712907513973353401204912431800080247493896815299218218930415151745986776831977527196435124521552249406640177674130330651411672455343809240941664288436809369136070604763156723</span>, <span class="number">781980567294866497501123805923409152921571985796778580310714832500106425599168129745704238460330034743315325966148186558555020834861765526689768371880561510063294857161406783415599987595549249742832472894018336008481239463162160596123334637587102639626334613747584469035377788994951080335145295621141303809208401699383140579784234370433212962549701294557490327915345039736785539182810171621358586598828585945914338147070450135377738837775900049262279077924927424572133106317931037834170242253287377939407573458979723688263335125293054004806634691866986695432845509236568546421095177774413671436200824471636980556801370827632298658729537149331589875199074040922783371553748936641151156007453231144303475285524669545469070200964887839003421723671399980708592531935414262678088053843196096190537828523518384368702604524858315737895816793263164649577505835816917629234902199990503712784374018119048109158314524143587749590847895032293396106716513485468884408566836474462501500356497238218550499994067382687458598481617175106389271282319486609800621311007926196777720697327886147764674266204885628982776927834776344964727336572310616726876742447686216871630304048650918084364293803385183867282800430566589645701462385656793820570672943583</span>)</span><br><span class="line">c1,c2 = (<span class="number">94439884067875866926510480826480805218086956848743547499198006820458557396798764306362789177343865957780128049481100649740991723046823411381255593998762330282701428367295145704749575923764033888430043419432755523895502809914793389377786178823780078298402526077689075100615167801149188073166609798060195606072633000544828049766057724062947725409167355039403877440527580919770561607036599124342541749265192021823491918944278440530549040290346018294412510920437610359378345321588108996817523300112050660236797578506114472897358316471445079369284771733206616722439988368610144077799745808242486800244677553898369876207696781377538070465563883203111584722721805287175889444151342208592141472448213468221732504380079996468560634932304003913239528756529682825338927264423302712140156109639630352986070846491530710979222740690647201189995078959423441714667664068681190006816257273563900319001844315873583504406793282181337548468252678860728542345494826571860793722889527787190697802307747398283993641414712543326007228545296721676768940364724157476527100408795556913732012808496296586935767075610857696900781575977854898411278115773743046743452254128886824788564219765260031723480676483312846917497210349237445933078576069670523680684713623446</span>, <span class="number">36397082263544765924779841921119370016762339442058655416586193728619075025998163340396086334077244844310435402140631243689371206933579011146142036715931618067708305508617210563902014072058872403638202493268214994615135134434419245572034705984431586848768861656760831721539666418749603708776469542844144251059399582543923184073020411373179905155719536662312209785364646479188735299232303697790049147771382959302788060004896713986087257232599766636580823138965201801581260077589060485570410897810958498454358737888682940093471597533949463149992040055832220962541050083923086389598838921222167415555331634007862804183991931445726265293675584802614392692457772587297132115782027787479633548163420352103982803350538152059924978489540395956166707435927694988026192837010341182919501051673735679100778154041581361254807291072654267471473503037873994575370262350787611333206450177404857861689910339996980215797433744385047164909022377659304404477322770853683922772248965438499817404000913895236832920522508813098567854697829563333570746651008308539370730448094601234580689549622502198266967939450827346984012446321546195185770288650359658551649011648788273482810013579385313367223458143686448798406205345442061625590854243243883117300950978940</span>)</span><br><span class="line">e = <span class="number">0xfaab</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#c = pow(m,eB-1,p)</span></span><br><span class="line">c = <span class="built_in">pow</span>(c1,B%q,p)*inverse(c2,p)*<span class="built_in">pow</span>(h,A%q,p) % p</span><br><span class="line">E = e*B-<span class="number">1</span></span><br><span class="line">d = inverse(E//<span class="number">167</span>,p-<span class="number">1</span>)</span><br><span class="line">c1 = <span class="built_in">pow</span>(c,d,p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">onemod</span>(<span class="params">e, q</span>):</span><br><span class="line">    p = random.randint(<span class="number">1</span>, q-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">pow</span>(p, (q-<span class="number">1</span>)//e, q) == <span class="number">1</span>):  <span class="comment"># (r,s)=1</span></span><br><span class="line">        p = random.randint(<span class="number">1</span>, q)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AMM_rth</span>(<span class="params">o, r, q</span>):  <span class="comment"># r|(q-1</span></span><br><span class="line">    <span class="keyword">assert</span>((q-<span class="number">1</span>) % r == <span class="number">0</span>)</span><br><span class="line">    p = onemod(r, q)</span><br><span class="line"></span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    s = q-<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>(s % r == <span class="number">0</span>):</span><br><span class="line">        s = s//r</span><br><span class="line">        t += <span class="number">1</span></span><br><span class="line">    k = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>((s*k+<span class="number">1</span>) % r != <span class="number">0</span>):</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">    alp = (s*k+<span class="number">1</span>)//r</span><br><span class="line"></span><br><span class="line">    a = <span class="built_in">pow</span>(p, r**(t-<span class="number">1</span>)*s, q)</span><br><span class="line">    b = <span class="built_in">pow</span>(o, r*a-<span class="number">1</span>, q)</span><br><span class="line">    c = <span class="built_in">pow</span>(p, s, q)</span><br><span class="line">    h = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, t-<span class="number">1</span>):</span><br><span class="line">        d = <span class="built_in">pow</span>(<span class="built_in">int</span>(b), r**(t-<span class="number">1</span>-i), q)</span><br><span class="line">        <span class="keyword">if</span> d == <span class="number">1</span>:</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            j = (-math.log(d, a)) % r</span><br><span class="line">        b = (b*(c**(r*j))) % q</span><br><span class="line">        h = (h*c**j) % q</span><br><span class="line">        c = (c*r) % q</span><br><span class="line">    result = (<span class="built_in">pow</span>(o, alp, q)*h)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ALL_Solution</span>(<span class="params">m, q, rt, cq, e</span>):</span><br><span class="line">    mp = []</span><br><span class="line">    <span class="keyword">for</span> pr <span class="keyword">in</span> rt:</span><br><span class="line">        r = (pr*m) % q</span><br><span class="line">        <span class="comment"># assert(pow(r, e, q) == cq)</span></span><br><span class="line">        mp.append(r)</span><br><span class="line">    <span class="keyword">return</span> mp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ALL_ROOT2</span>(<span class="params">r, q</span>):  <span class="comment"># use function set() and .add() ensure that the generated elements are not repeated</span></span><br><span class="line">    li = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">len</span>(li) &lt; r):</span><br><span class="line">        p = <span class="built_in">pow</span>(random.randint(<span class="number">1</span>, q-<span class="number">1</span>), (q-<span class="number">1</span>)//r, q)</span><br><span class="line">        li.add(p)</span><br><span class="line">    <span class="keyword">return</span> li</span><br><span class="line"></span><br><span class="line">cp = c1 % p</span><br><span class="line"></span><br><span class="line">mp = AMM_rth(cp, <span class="number">167</span>, p)</span><br><span class="line"></span><br><span class="line">rt1 = ALL_ROOT2(<span class="number">167</span>, p)</span><br><span class="line"></span><br><span class="line">amp = ALL_Solution(mp, p, rt1, cp, <span class="number">167</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> amp:</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">b&quot;HITCTF&quot;</span> <span class="keyword">in</span> long_to_bytes(<span class="built_in">int</span>(i))):</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(i)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#HITCTF2021&#123;Numb3r_Th30ry_1s_Funny!&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="ISITDTU-RSA"><a href="#ISITDTU-RSA" class="headerlink" title="ISITDTU_RSA"></a>ISITDTU_RSA</h3><p>é¢˜ç›®æ¥æºï¼šISITDTU CTF 2023</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">from</span> FLAG <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p1 = <span class="number">401327687854144602104262478345650053155149834850813791388612732559616436344229998525081674131271</span></span><br><span class="line">p2 = <span class="number">500233813775302774885494989064149819654733094475237733501199023993441312997760959607567274704359</span></span><br><span class="line">p3 = <span class="number">969568679903672924738597736880903133415133378800072135853678043226600595571519034043189730269981</span></span><br><span class="line">e1 = <span class="number">398119</span></span><br><span class="line">e2 = <span class="number">283609</span></span><br><span class="line">e3 = <span class="number">272383</span></span><br><span class="line"></span><br><span class="line">c = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(c, e1, p1)</span><br><span class="line">c = <span class="built_in">pow</span>(c, e2, p2)</span><br><span class="line">c = <span class="built_in">pow</span>(c, e3, p3)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># c = 104229015434394780017196823454597012062804737684103834919430099907512793339407667578022877402970</span></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®å°†flagä¾æ¬¡ç”¨ç±»ä¼¼RSAåŠ å¯†çš„æ–¹å¼è¿ç»­åŠ å¯†äº†ä¸‰æ¬¡æ¯æ¬¡ä½¿ç”¨ä¸€ä¸ªä¸åŒçš„ç´ æ•°eiä½œä¸ºåŠ å¯†æŒ‡æ•°ï¼Œä½¿ç”¨ä¸€ä¸ªä¸åŒçš„ç´ æ•°piä½œä¸ºæ¨¡æ•°ã€‚æœ€ç›´æ¥çš„æƒ³æ³•è‡ªç„¶å°±æ˜¯ç›´æ¥æ±‚è§£è§£å¯†æŒ‡æ•°diï¼Œç„¶åè¿ç»­è§£å¯†ä¸‰æ¬¡å°±èƒ½å¾—åˆ°æ˜æ–‡ã€‚</p>
<p>ä½†æ˜¯ï¼Œå®é™…æ“ä½œæ—¶å‘ç°ï¼Œä»»ä½•ä¸€ä¸ªè§£å¯†æŒ‡æ•°éƒ½ä¸å­˜åœ¨ï¼Œè¿™æ˜¯å› ä¸ºæ¯ä¸€ä¸ªeiéƒ½è¢«pi-1æ•´é™¤ï¼Œå› æ­¤æ— æ³•æ±‚è§£é€†å…ƒã€‚è€Œè¿™ä¸ªæ—¶å€™ï¼Œæ­£å¸¸æ€è·¯æ¥æƒ³çš„è¯è‡ªç„¶é©¬ä¸Šå°±ä¼šæƒ³åˆ°AMMç®—æ³•ã€‚</p>
<p>ä½†æ˜¯ç›´æ¥ç”¨AMMç®—æ³•ä¼šé‡åˆ°ä¸€äº›é—®é¢˜ï¼š</p>
<ul>
<li>æŒ‡æ•°æ•°é‡çº§ç›¸å¯¹è¾ƒå¤§ï¼Œå¯èƒ½AMMé€Ÿåº¦ä¼šæ¯”è¾ƒæ…¢</li>
<li>æ¯ä¸€æ¬¡AMMå¼€æ ¹ä¼šå¼€å‡ºeiä¸ªæ ¹ï¼Œè€Œä¸‹ä¸€æ¬¡è¿›è¡ŒAMMå¼€æ ¹æ—¶ï¼Œéœ€è¦å¯¹ä¸Šä¸€æ¬¡AMMå¼€æ ¹å¾—åˆ°çš„æ‰€æœ‰æ ¹å†è¿›è¡Œä¸€æ¬¡å¼€æ ¹ã€‚æ¯”å¦‚ç¬¬äºŒæ¬¡å¼€æ ¹æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ç¬¬ä¸€æ¬¡AMMå¾—åˆ°çš„272383ä¸ªæ ¹å‡è¿›è¡Œä¸€æ¬¡AMMç®—æ³•ï¼Œåœ¨ç¬¬ä¸‰æ¬¡å¼€æ ¹æ—¶åˆ™æ›´å¤šï¼Œè¿™ä¸ªæ•°é‡çº§æ˜¯ä¸å¯æ¥å—çš„</li>
</ul>
<p>ä¸ç®¡æ€ä¹ˆæ ·å…ˆå¼€ä¸€æ¬¡æ ¹è¯•è¯•ï¼Œå®é™…æ“ä½œä¸€ä¸‹ä¼šå‘ç°ï¼ŒAMMå¼€å‡ åä¸‡æ¬¡æ–¹æ ¹å¹¶å¾—åˆ°æ‰€æœ‰è§£å…¶å®ä¹Ÿåªéœ€è¦ä¸‰å››åˆ†é’Ÿï¼Œå› æ­¤ç¬¬ä¸€ä¸ªé—®é¢˜å¹¶ä¸ç”¨ç‰¹åˆ«å…³å¿ƒï¼Œä¸»è¦å°±æ˜¯è¦è§£å†³ç¬¬äºŒä¸ªé—®é¢˜ï¼šå¦‚ä½•å¤„ç†è¿™ä¸ªä¸‰ä¸ªåŠ å¯†æŒ‡æ•°ç›¸ä¹˜çš„è¶…å¤§å¤æ‚åº¦ï¼Ÿ</p>
<p>è¦è§£å†³è¿™ä¸€ç‚¹éœ€è¦æ³¨æ„åˆ°ä»¥ä¸‹äº‹å®ï¼Œç”±äºï¼š</p>
<script type="math/tex; mode=display">
c1 = m^{e1} \quad(mod\;p1)</script><script type="math/tex; mode=display">
c2 = c1^{e2} \quad(mod\;p2)</script><script type="math/tex; mode=display">
c3 = c2^{e3} \quad(mod\;p3)</script><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æˆ‘ä»¬AMMç®—æ³•å¼€å‡ºçš„e3ä¸ªæ ¹ä¸­ï¼Œæ­£ç¡®çš„æ ¹éœ€è¦æ»¡è¶³æ˜¯æ¨¡p2ä¸‹çš„e2æ¬¡å‰©ä½™ï¼›åŒç†ï¼Œç¬¬äºŒæ¬¡AMMç®—æ³•åï¼Œæ­£ç¡®çš„æ ¹éœ€è¦æ»¡è¶³æ˜¯æ¨¡p1ä¸‹çš„e1æ¬¡å‰©ä½™ã€‚</p>
<p>è€Œä¸€ä¸ªæ•°æ˜¯å¦æ˜¯æ¨¡pä¸‹çš„kæ¬¡å‰©ä½™è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥é€šè¿‡ç±»ä¼¼äºåˆ¤æ–­æ¨¡pä¸‹çš„äºŒæ¬¡å‰©ä½™çš„æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¿ç”¨æ¬§æ‹‰åˆ¤åˆ«å¼å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
a^{\frac{p-1}{k}} \equiv 1 \quad (mod\;p)</script><p>å¦‚æœä¸€ä¸ªæ•°aæ»¡è¶³ä¸Šå¼ï¼Œé‚£ä¹ˆä»–å°±æ˜¯æ¨¡pä¸‹çš„kæ¬¡å‰©ä½™ã€‚é‚£ä¹ˆæœ‰äº†è¿™ä¸ªåˆ¤åˆ«æ–¹å¼åï¼Œå¯¹äºç¬¬ä¸€æ¬¡AMMç®—æ³•å¾—åˆ°çš„e3ä¸ªæ ¹ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆåˆ¤æ–­å…¶æ˜¯å¦æ˜¯æ¨¡p2ä¸‹çš„e2æ¬¡å‰©ä½™ï¼Œç„¶åæ‰¾åˆ°ç¬¦åˆè¦æ±‚çš„æ ¹ï¼Œå†å¯¹å…¶è¿›è¡ŒAMMç®—æ³•å¼€e2æ¬¡æ ¹ï¼Œä»¥æ­¤ç±»æ¨ï¼Œæœ€åç”±äºflagå¤´æœªçŸ¥(åšå‡ºæ¥å‰ä¸çŸ¥é“è¿™æ˜¯ä»€ä¹ˆæ¯”èµ›çš„ä»€ä¹ˆé¢˜ï¼Œåˆ«çš„å¸ˆå‚…é—®æˆ‘çš„)ï¼Œæœ€åä¸€æ¬¡AMMå¾—åˆ°çš„e1ä¸ªæ ¹ä¸­ï¼Œå¯ä»¥é‡‡ç”¨åˆ¤æ–­å­—èŠ‚æµè½¬æˆçš„å­—ç¬¦ä¸²ä¸­æ²¡æœ‰â€\xâ€æ¥ç¡®å®šæ˜¯flagä¸²ã€‚</p>
<p>é‚£ä¹ˆå®é™…è€—æ—¶ä¹Ÿå°±æ˜¯ä¸‰æ¬¡ç‹¬ç«‹çš„AMMç®—æ³•çš„æ€»è€—æ—¶ï¼Œçº¦10åˆ†é’Ÿã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">p1 = <span class="number">401327687854144602104262478345650053155149834850813791388612732559616436344229998525081674131271</span></span><br><span class="line">p2 = <span class="number">500233813775302774885494989064149819654733094475237733501199023993441312997760959607567274704359</span></span><br><span class="line">p3 = <span class="number">969568679903672924738597736880903133415133378800072135853678043226600595571519034043189730269981</span></span><br><span class="line">e1 = <span class="number">398119</span></span><br><span class="line">e2 = <span class="number">283609</span></span><br><span class="line">e3 = <span class="number">272383</span></span><br><span class="line">c = <span class="number">53439232235483323845772940768628860612955240528996700091904547428796321356639732497361321352956</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">onemod</span>(<span class="params">e, q</span>):</span><br><span class="line">    p = random.randint(<span class="number">1</span>, q-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">pow</span>(p, (q-<span class="number">1</span>)//e, q) == <span class="number">1</span>):  <span class="comment"># (r,s)=1</span></span><br><span class="line">        p = random.randint(<span class="number">1</span>, q)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AMM_rth</span>(<span class="params">o, r, q</span>):  <span class="comment"># r|(q-1</span></span><br><span class="line">    <span class="keyword">assert</span>((q-<span class="number">1</span>) % r == <span class="number">0</span>)</span><br><span class="line">    p = onemod(r, q)</span><br><span class="line"></span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    s = q-<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>(s % r == <span class="number">0</span>):</span><br><span class="line">        s = s//r</span><br><span class="line">        t += <span class="number">1</span></span><br><span class="line">    k = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>((s*k+<span class="number">1</span>) % r != <span class="number">0</span>):</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">    alp = (s*k+<span class="number">1</span>)//r</span><br><span class="line"></span><br><span class="line">    a = <span class="built_in">pow</span>(p, r**(t-<span class="number">1</span>)*s, q)</span><br><span class="line">    b = <span class="built_in">pow</span>(o, r*a-<span class="number">1</span>, q)</span><br><span class="line">    c = <span class="built_in">pow</span>(p, s, q)</span><br><span class="line">    h = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, t-<span class="number">1</span>):</span><br><span class="line">        d = <span class="built_in">pow</span>(<span class="built_in">int</span>(b), r**(t-<span class="number">1</span>-i), q)</span><br><span class="line">        <span class="keyword">if</span> d == <span class="number">1</span>:</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            j = (-math.log(d, a)) % r</span><br><span class="line">        b = (b*(c**(r*j))) % q</span><br><span class="line">        h = (h*c**j) % q</span><br><span class="line">        c = (c*r) % q</span><br><span class="line">    result = (<span class="built_in">pow</span>(o, alp, q)*h)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ALL_Solution</span>(<span class="params">m, q, rt, cq, e</span>):</span><br><span class="line">    mp = []</span><br><span class="line">    <span class="keyword">for</span> pr <span class="keyword">in</span> rt:</span><br><span class="line">        r = (pr*m) % q</span><br><span class="line">        <span class="comment"># assert(pow(r, e, q) == cq)</span></span><br><span class="line">        mp.append(r)</span><br><span class="line">    <span class="keyword">return</span> mp</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ALL_ROOT2</span>(<span class="params">r, q</span>):  <span class="comment"># use function set() and .add() ensure that the generated elements are not repeated</span></span><br><span class="line">    li = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">len</span>(li) &lt; r):</span><br><span class="line">        p = <span class="built_in">pow</span>(random.randint(<span class="number">1</span>, q-<span class="number">1</span>), (q-<span class="number">1</span>)//r, q)</span><br><span class="line">        li.add(p)</span><br><span class="line">    <span class="keyword">return</span> li</span><br><span class="line"></span><br><span class="line">cp3 = c % p3</span><br><span class="line">mp3 = AMM_rth(cp3, e3, p3)</span><br><span class="line">rt3 = ALL_ROOT2(e3, p3)</span><br><span class="line">amp3 = ALL_Solution(mp3, p3, rt3, cp3, e3)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> amp3:</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">pow</span>(<span class="built_in">int</span>(i),(p2-<span class="number">1</span>)//e2,p2)==<span class="number">1</span>):</span><br><span class="line">        c2 = <span class="built_in">int</span>(i)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;3 Done!&quot;</span>)</span><br><span class="line"></span><br><span class="line">cp2 = c % p2</span><br><span class="line">mp2 = AMM_rth(cp2, e2, p2)</span><br><span class="line">rt2 = ALL_ROOT2(e2, p2)</span><br><span class="line">amp2 = ALL_Solution(mp2, p2, rt2, cp2, e2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> amp2:</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">pow</span>(<span class="built_in">int</span>(i),(p1-<span class="number">1</span>)//e1,p1)==<span class="number">1</span>):</span><br><span class="line">        c1 = <span class="built_in">int</span>(i)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;2 Done!&quot;</span>)</span><br><span class="line"></span><br><span class="line">cp1 = c % p1</span><br><span class="line">mp1 = AMM_rth(cp1, e1, p1)</span><br><span class="line">rt1 = ALL_ROOT2(e1, p1)</span><br><span class="line">amp1 = ALL_Solution(mp1, p1, rt1, cp1, e1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> amp1:</span><br><span class="line">    temp = <span class="built_in">str</span>(long_to_bytes(<span class="built_in">int</span>(i)))</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">&quot;\\x&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> temp):</span><br><span class="line">        <span class="built_in">print</span>(temp)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ISITDTU&#123;s0_m4ny_m0dul4r_r00t5&#125;</span></span><br></pre></td></tr></table></figure>
<p>åŒæ—¶æ³¨æ„ï¼Œæ­£å¸¸æ¥è¯´åº”è¯¥æŠŠæ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„eiæ¬¡å‰©ä½™éƒ½è¿›è¡Œä¸€æ¬¡AMMç®—æ³•ï¼Œä½†æ˜¯è¿™ä¸ªé¢˜å®é™…åšä¸‹æ¥æ¯æ¬¡AMMåéƒ½ç¡®å®åªæœ‰ä¸€ä¸ªæ ¹ç¬¦åˆè¦æ±‚ï¼Œå› æ­¤å¯ä»¥è¿™ä¹ˆå†™ã€‚</p>
<p><br></p>
<p><br></p>
]]></content>
      <categories>
        <category>cryptoè¶£é¢˜</category>
      </categories>
  </entry>
  <entry>
    <title>Cryptoè¶£é¢˜-hash</title>
    <url>/post/923bfbdd.html</url>
    <content><![CDATA[<p>è¯¥æ–‡ç« ä¸»è¦è®°å½•ä¸€äº›å“ˆå¸Œå‡½æ•°ç›¸å…³çš„è¶£é¢˜</p>
<span id="more"></span>
<h3 id="babyhash"><a href="#babyhash" class="headerlink" title="babyhash"></a>babyhash</h3><p>é¢˜ç›®æ¥æºï¼šISG 2023</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> ecdsa <span class="keyword">import</span> SigningKey</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Hash</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, data</span>):</span><br><span class="line">        self.data = data</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">digest</span>(<span class="params">self</span>):</span><br><span class="line">        data = <span class="built_in">bytes</span>(self.data)</span><br><span class="line">        data = pad(data, <span class="number">16</span>)</span><br><span class="line">        text = <span class="string">b&quot;\x00&quot;</span> * <span class="number">16</span></span><br><span class="line">        hash_result = <span class="string">b&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(data), <span class="number">16</span>):</span><br><span class="line">            key = data[i:i+<span class="number">16</span>]</span><br><span class="line">            text = AES.new(key, AES.MODE_ECB).encrypt(text)</span><br><span class="line">            hash_result += text</span><br><span class="line">        <span class="keyword">return</span> hash_result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Task</span>(socketserver.BaseRequestHandler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, *args, **kargs</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__(*args, **kargs)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">timeout_handler</span>(<span class="params">self, signum, frame</span>):</span><br><span class="line">        <span class="keyword">raise</span> TimeoutError</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">proof_of_work</span>(<span class="params">self</span>):</span><br><span class="line">        random.seed(urandom(<span class="number">8</span>))</span><br><span class="line">        proof = <span class="string">&quot;&quot;</span>.join(</span><br><span class="line">            [random.choice(string.ascii_letters + string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)]</span><br><span class="line">        )</span><br><span class="line">        digest = sha256(proof.encode()).hexdigest()</span><br><span class="line">        self.dosend(<span class="string">&quot;sha256(XXXX + &#123;&#125;) == &#123;&#125;&quot;</span>.<span class="built_in">format</span>(proof[<span class="number">4</span>:], digest))</span><br><span class="line">        self.dosend(<span class="string">&quot;Give me XXXX:&quot;</span>)</span><br><span class="line">        x = self.request.recv(<span class="number">10</span>)</span><br><span class="line">        x = (x.strip()).decode()</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(x) != <span class="number">4</span> <span class="keyword">or</span> sha256((x + proof[<span class="number">4</span>:]).encode()).hexdigest() != digest:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">dosend</span>(<span class="params">self, msg</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            self.request.sendall(msg.encode(<span class="string">&quot;latin-1&quot;</span>) + <span class="string">b&quot;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">self, sk, msg</span>):</span><br><span class="line">        <span class="keyword">return</span> sk.sign(msg, hashfunc=Hash)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">self, vk, msg, signature</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            vk.verify(signature, msg, hashfunc=Hash)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;error&quot;</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;Invalid signature&quot;</span>&#125;</span><br><span class="line">        msg = json.loads(msg.decode())</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> msg.get(<span class="string">&quot;admin&quot;</span>, <span class="literal">False</span>):</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;error&quot;</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;You are not admin&quot;</span>&#125;</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;success&quot;</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;You are admin&quot;</span>, <span class="string">&quot;flag&quot;</span>: flag&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">challenge</span>(<span class="params">self, sk, vk</span>):</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            self.dosend(<span class="string">&quot;Input your choice:\n[1] Sign in\n [2] Verify\n [3] Exit&quot;</span>)</span><br><span class="line">            choice = self.request.recv(<span class="number">2</span>).strip()</span><br><span class="line">            choice = <span class="built_in">int</span>(choice.decode())</span><br><span class="line">            <span class="keyword">if</span> choice == <span class="number">1</span>:</span><br><span class="line">                self.dosend(<span class="string">&quot;Input your username:&quot;</span>)</span><br><span class="line">                buf = <span class="string">b&quot;&quot;</span></span><br><span class="line">                <span class="keyword">while</span> <span class="built_in">len</span>(buf) &lt; <span class="number">1000</span>:</span><br><span class="line">                    buf += self.request.recv(<span class="number">1</span>)</span><br><span class="line">                    <span class="keyword">if</span> buf[-<span class="number">1</span>:] == <span class="string">b&quot;\n&quot;</span>:</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                name = <span class="string">&quot;&quot;</span>.join( <span class="built_in">chr</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> buf <span class="keyword">if</span> <span class="built_in">chr</span>(x).isalnum())</span><br><span class="line">                msg_to_sign = &#123;<span class="string">&quot;admin&quot;</span>: <span class="literal">False</span>, <span class="string">&quot;username&quot;</span>: name&#125;</span><br><span class="line">                msg_to_sign = json.dumps(msg_to_sign).encode()</span><br><span class="line">                sig = self.sign(sk, msg_to_sign).<span class="built_in">hex</span>()</span><br><span class="line">                info = &#123;<span class="string">&quot;sig&quot;</span>: sig&#125;</span><br><span class="line">                self.dosend(<span class="string">&quot;Your signature: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(json.dumps(info)))</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> choice == <span class="number">2</span>:</span><br><span class="line">                self.dosend(<span class="string">&quot;Input your msg and sigature in JSON form:&quot;</span>)</span><br><span class="line">                buf = <span class="string">b&quot;&quot;</span></span><br><span class="line">                <span class="keyword">while</span> <span class="built_in">len</span>(buf) &lt; <span class="number">1000</span>:</span><br><span class="line">                    buf += self.request.recv(<span class="number">1</span>)</span><br><span class="line">                    <span class="keyword">if</span> buf[-<span class="number">1</span>:] == <span class="string">b&quot;\n&quot;</span>:</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                buf = buf.decode()</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;buf&#x27;</span>, buf)</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    info = json.loads(buf)</span><br><span class="line">                <span class="keyword">except</span>:</span><br><span class="line">                    self.dosend(<span class="string">&quot;Invalid JSON&quot;</span>)</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                msg = info[<span class="string">&#x27;msg&#x27;</span>].encode()</span><br><span class="line">                sig = <span class="built_in">bytes</span>.fromhex(info[<span class="string">&#x27;sig&#x27;</span>])</span><br><span class="line">                send_info = self.verify(vk, msg, sig)</span><br><span class="line">                self.dosend(json.dumps(send_info))</span><br><span class="line">            <span class="keyword">if</span> choice == <span class="number">3</span>:</span><br><span class="line">                self.request.close()</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">try</span>: </span><br><span class="line">            signal.signal(signal.SIGALRM, self.timeout_handler)</span><br><span class="line">            signal.alarm(<span class="number">60</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> self.proof_of_work():</span><br><span class="line">                self.dosend(<span class="string">&quot;You must solve proof of work&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            signal.alarm(<span class="number">60</span>)</span><br><span class="line">            </span><br><span class="line">            sk = SigningKey.generate()</span><br><span class="line">            vk = sk.get_verifying_key()</span><br><span class="line">            self.challenge(sk, vk)</span><br><span class="line">             </span><br><span class="line">            </span><br><span class="line">        <span class="keyword">except</span> TimeoutError:</span><br><span class="line">            self.dosend(<span class="string">&quot;Timeout&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(e)</span><br><span class="line">            self.dosend(<span class="string">&quot;WTF?&quot;</span>)</span><br><span class="line">            self.request.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ThreadedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST, PORT = <span class="string">&quot;0.0.0.0&quot;</span>, <span class="number">10500</span></span><br><span class="line">    server = ThreadedServer((HOST, PORT), Task)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure>
<p>æ¢³ç†ä¸€ä¸‹é¢˜ç›®ä»»åŠ¡ï¼š</p>
<ul>
<li>é€šè¿‡proof</li>
<li>ç”¨ç°æœ‰åº“ecdsaç”Ÿæˆä¸€ä¸ªç­¾åå¯¹è±¡skï¼ŒåŒæ—¶ç”Ÿæˆå¯¹åº”çš„éªŒç­¾å¯¹è±¡vkåï¼Œè¿›å…¥challenge</li>
<li>åœ¨challengeä¸­ï¼Œè¾“å…¥1ï¼Œå¯ä»¥è¾“å…¥ä¸€ä¸ªusernameï¼Œå¯¹ <code>&#123;&quot;admin&quot;: False, &quot;username&quot;: name&#125;</code>å½¢å¼çš„msgè¿›è¡Œç­¾åï¼Œé¶æœºè¿”å›ç­¾åå€¼ï¼›è¾“å…¥2ï¼Œå¯ä»¥è¾“å…¥ä¸€ä¸ªJSONå½¢å¼çš„æ•°æ®å¯¹è±¡å¦‚ï¼š<code>&#123;&#39;msg&#39;: &#39;&#123;&quot;admin&quot;: false, &quot;username&quot;: name&#125;&#39;, &#39;sig&#39;: sig&#125;</code>ï¼Œé¶æœºå°†å¯¹è¾“å…¥çš„æ•°æ®å¯¹è±¡è¿›è¡ŒéªŒç­¾ã€‚</li>
<li>å¦‚æœéªŒç­¾é€šè¿‡ï¼Œä¸”â€adminâ€å€¼ä¸ä¸ºfalseï¼Œåˆ™å¾—åˆ°flagã€‚</li>
</ul>
<p>è€Œåœ¨æœ¬é¢˜çš„ç­¾åæµç¨‹ä¸­ï¼Œå“ˆå¸Œå‡½æ•°æ˜¯è‡ªå®šä¹‰çš„ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Hash</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, data</span>):</span><br><span class="line">        self.data = data</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">digest</span>(<span class="params">self</span>):</span><br><span class="line">        data = <span class="built_in">bytes</span>(self.data)</span><br><span class="line">        data = pad(data, <span class="number">16</span>)</span><br><span class="line">        text = <span class="string">b&quot;\x00&quot;</span> * <span class="number">16</span></span><br><span class="line">        hash_result = <span class="string">b&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(data), <span class="number">16</span>):</span><br><span class="line">            key = data[i:i+<span class="number">16</span>]</span><br><span class="line">            text = AES.new(key, AES.MODE_ECB).encrypt(text)</span><br><span class="line">            hash_result += text</span><br><span class="line">        <span class="keyword">return</span> hash_result</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯æŠŠmsgçš„å†…å®¹åˆ†ä¸ºé•¿åº¦ä¸º16çš„è‹¥å¹²ç»„ï¼Œå¹¶åˆ†åˆ«å½“ä½œAESçš„keyå¹¶å¯¹bâ€\x00â€ * 16è¿›è¡ŒAESåŠ å¯†ï¼Œå¾—åˆ°çš„ç»“æœæ‹¼æ¥èµ·æ¥å°±æ˜¯å“ˆå¸Œå€¼ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯æ„é€ ä¸€ä¸ªmsgï¼Œä½¿å¾—å…¶è‡ªå®šä¹‰å“ˆå¸Œå€¼ä¸<code>&#123;&quot;admin&quot;: false, &quot;username&quot;: name&#125;</code>ç›¸åŒï¼ŒåŒæ—¶æ»¡è¶³â€adminâ€çš„å€¼ä¸ä¸ºfalseã€‚</p>
<p>é¦–å…ˆæœ‰ä¸€ç‚¹å°±å¾ˆå¥‡æ€ªï¼šè¿™ä¸ªå“ˆå¸Œå‡½æ•°é•¿åº¦ä¼šéšç€dataçš„é•¿åº¦å˜åŒ–è€Œå˜åŒ–ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœç»™ä¸€ä¸ªè¶³å¤Ÿé•¿çš„dataï¼Œå°±ä¼šäº§ç”Ÿä¸€ä¸ªè¶³å¤Ÿå¤§çš„å“ˆå¸Œå€¼ï¼Œç°æœ‰çš„ecdsaåº“æ˜¯å¦ä¼šå¯¹è¿™ç§æƒ…å†µè¿›è¡Œå¤„ç†ï¼Ÿ</p>
<p>ç»“æœå‘ç°çœŸçš„ä¼šå¤„ç†ï¼Œå¦‚ä¸‹å›¾ä¸­æ‰€ç¤ºï¼Œallow_truncateåœ¨signå‡½æ•°ä¸­æ˜¯é»˜è®¤ä¸ºtrueçš„ï¼Œè€Œbaselenç»æµ‹éªŒæ˜¯24ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœå“ˆå¸Œè¶…é•¿ï¼Œä»–åªä¼šå–å‰24ä¸ªä½œä¸ºæ‘˜è¦å€¼ï¼š</p>
<p><img src="/post/923bfbdd/image-20231018171953594.png" alt="image-20231018171953594"></p>
<p>è¿™ä¹Ÿå°±æ˜¯è¯´ï¼Œé¢˜ç›®ä¸­è‡ªå®šä¹‰çš„å“ˆå¸Œå‡½æ•°ä¸ç®¡äº§ç”Ÿå¤šé•¿çš„å­—èŠ‚æµï¼Œç”±äºå“ˆå¸Œæ‘˜è¦åªå–24ä¸ªï¼Œå› æ­¤åªæœ‰å‰ä¸¤ä¸ªåˆ†ç»„çš„dataä¼šå¯¹æœ€ç»ˆè¢«ä½¿ç”¨åˆ°ç­¾åé‡Œçš„å“ˆå¸Œå€¼äº§ç”Ÿå½±å“,ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¼ å…¥çš„JSONå¯¹è±¡çš„ç¬¬ä¸‰åäºŒä¸ªä»¥åçš„å­—ç¬¦éƒ½ä¸ä¼šå½±å“éªŒç­¾ã€‚è€Œè§‚å¯Ÿverifyå‡½æ•°ï¼Œä»–å…¶å®æ˜¯å…ˆæŠŠä¼ å…¥çš„msgå½“ä½œå­—èŠ‚ä¸²è¿›è¡ŒéªŒç­¾ï¼Œå†æŠŠå…¶å½“ä½œJSONå¯¹è±¡æ£€éªŒæ˜¯å¦â€adminâ€ä¸ºfalseï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">self, vk, msg, signature</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            vk.verify(signature, msg, hashfunc=Hash)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;error&quot;</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;Invalid signature&quot;</span>&#125;</span><br><span class="line">        msg = json.loads(msg.decode())</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> msg.get(<span class="string">&quot;admin&quot;</span>, <span class="literal">False</span>):</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;error&quot;</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;You are not admin&quot;</span>&#125;</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;success&quot;</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;You are admin&quot;</span>, <span class="string">&quot;flag&quot;</span>: flag&#125;</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯JSONå¯¹è±¡æ˜¯å¯ä»¥è¦†ç›–å‰é¢çš„â€adminâ€çš„å€¼çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å°†msgçš„å€¼è®¾ç½®æˆä¸‹é¢è¿™ç§å½¢å¼ï¼Œå†ä¼ ç»™é¶æœºï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&#123;<span class="string">&quot;admin&quot;</span>: false, <span class="string">&quot;username&quot;</span>: name, <span class="string">&quot;admin&quot;</span>: name&#125;</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆå¯¹äºæœåŠ¡å™¨æ¥è¯´ï¼Œå…¶éªŒç­¾æ˜¯ç”¨çš„ä¸Šé¢è¿™ä¸ª<strong>å­—ç¬¦ä¸²</strong>çš„è‡ªå®šä¹‰å“ˆå¸Œçš„å‰32ä½æ¥è¿›è¡ŒéªŒç­¾ï¼Œå› æ­¤å½“ç„¶èƒ½éªŒç­¾é€šè¿‡ã€‚è€Œåœ¨éªŒç­¾é€šè¿‡åï¼Œä»–æŠŠè¿™ä¸ªå­—ç¬¦ä¸²é€šè¿‡loadsè½¬æˆJSONå¯¹è±¡ï¼Œâ€adminâ€çš„å€¼å°±è¢«è¦†ç›–æˆä¸ºäº†nameï¼Œå› æ­¤å°±èƒ½å¾—åˆ°flagï¼å“ˆå“ˆï¼Œæœ‰ç‚¹å‘é„™ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>():</span><br><span class="line">	table = string.digits + string.ascii_letters</span><br><span class="line">	temp = r.recvuntil(<span class="string">b&quot;sha256(XXXX + &quot;</span>)</span><br><span class="line">	temp = r.recvline()</span><br><span class="line">	suffix = temp[:<span class="number">16</span>].decode()</span><br><span class="line">	hex1 = temp[<span class="number">20</span>:].strip().decode()</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> tqdm(table):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> table:</span><br><span class="line">			<span class="keyword">for</span> k <span class="keyword">in</span> table:</span><br><span class="line">				<span class="keyword">for</span> m <span class="keyword">in</span> table:</span><br><span class="line">					temp1 = i+j+k+m</span><br><span class="line">					<span class="keyword">if</span>(sha256((temp1+suffix).encode()).hexdigest() == hex1):</span><br><span class="line">						r.sendline(temp1.encode())</span><br><span class="line">						<span class="keyword">return</span></span><br><span class="line">					</span><br><span class="line">r = remote(<span class="string">&quot;node4.anna.nssctf.cn&quot;</span>,<span class="number">28234</span>)</span><br><span class="line">proof_of_work()</span><br><span class="line">r.recvuntil(<span class="string">b&quot;[3] Exit&quot;</span>)</span><br><span class="line">r.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&quot;Input your username:&quot;</span>)</span><br><span class="line">r.sendline(<span class="string">b&quot;Tiffany&quot;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&quot;signature: &quot;</span>)</span><br><span class="line">sig = r.recvline().strip().decode()[<span class="number">9</span>:-<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&quot;[3] Exit&quot;</span>)</span><br><span class="line">r.sendline(<span class="string">b&quot;2&quot;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&quot;JSON form:&quot;</span>)</span><br><span class="line"></span><br><span class="line">msg = <span class="string">&#x27;&#123;&quot;admin&quot;: false, &quot;username&quot;: &quot;Tiffany&quot;, &quot;admin&quot;: &quot;Tiffany&quot;&#125;&#x27;</span></span><br><span class="line">msg_to_sign = &#123;<span class="string">&quot;msg&quot;</span>: msg, <span class="string">&quot;sig&quot;</span>: sig&#125;</span><br><span class="line"><span class="built_in">print</span>(msg_to_sign)</span><br><span class="line">msg_to_sign = json.dumps(msg_to_sign).encode()</span><br><span class="line"></span><br><span class="line">r.sendline(msg_to_sign)</span><br><span class="line">r.recvline()</span><br><span class="line"><span class="built_in">print</span>(r.recvline())</span><br><span class="line">r.close()</span><br><span class="line"></span><br><span class="line"><span class="comment">#NSSCTF&#123;e90c5b52-3eb4-4f69-a8ec-7f6e5fe0617f&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
]]></content>
      <categories>
        <category>cryptoè¶£é¢˜</category>
      </categories>
  </entry>
  <entry>
    <title>Cryptoè¶£é¢˜-åˆ†ç»„å¯†ç </title>
    <url>/post/a5bd8c0d.html</url>
    <content><![CDATA[<p>è¿™ç¯‡æ–‡ç« ä¸»è¦è®°å½•ä¸€äº›åˆ†ç»„å¯†ç ç›¸å…³çš„è¶£é¢˜</p>
<span id="more"></span>
<h3 id="EASY-dfa"><a href="#EASY-dfa" class="headerlink" title="EASY_dfa"></a>EASY_dfa</h3><p>æœ€è¿‘åšåˆ°çš„æˆ‘è§‰å¾—ç›¸å½“æœ‰æ„æ€çš„ä¸€ä¸ªé¢˜ï¼Œåœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹è§£é¢˜è¿‡ç¨‹</p>
<p>é¢˜ç›®æ¥æºï¼šå·æ¸ç½‘ç»œå®‰å…¨ç«èµ› 2022</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> sample, choice</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> unhexlify</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> hexdigits</span><br><span class="line"><span class="keyword">from</span> signal <span class="keyword">import</span> alarm</span><br><span class="line"></span><br><span class="line">logo = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"> _______   ________  ________       ___    ___ </span></span><br><span class="line"><span class="string">|\  ___ \ |\   __  \|\   ____\     |\  \  /  /|</span></span><br><span class="line"><span class="string">\ \   __/|\ \  \|\  \ \  \___|_    \ \  \/  / /</span></span><br><span class="line"><span class="string"> \ \  \_|/_\ \   __  \ \_____  \    \ \    / / </span></span><br><span class="line"><span class="string">  \ \  \_|\ \ \  \ \  \|____|\  \    \/  /  /  </span></span><br><span class="line"><span class="string">   \ \_______\ \__\ \__\____\_\  \ __/  / /    </span></span><br><span class="line"><span class="string">    \|_______|\|__|\|__|\_________\\\___/ /    </span></span><br><span class="line"><span class="string">                       \|_________\|___|/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">     ________  ________ ________         </span></span><br><span class="line"><span class="string">    |\   ___ \|\  _____\\\   __  \        </span></span><br><span class="line"><span class="string">    \ \  \_|\ \ \  \__/\ \  \|\  \       </span></span><br><span class="line"><span class="string">     \ \  \ \\\ \ \   __\\\ \   __  \      </span></span><br><span class="line"><span class="string">      \ \  \_\\\ \ \  \_| \ \  \ \  \     </span></span><br><span class="line"><span class="string">       \ \_______\ \__\   \ \__\ \__\    </span></span><br><span class="line"><span class="string">         \|_______|\|__|    \|__|\|__|    </span></span><br><span class="line"><span class="string">                                                                                                                                 </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">_memu = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">1. Encrypt</span></span><br><span class="line"><span class="string">2. Get flag</span></span><br><span class="line"><span class="string">3. Exit</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof</span>():</span><br><span class="line">    plain = <span class="string">&quot;&quot;</span>.join([choice(hexdigits) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">    <span class="built_in">print</span>(plain)</span><br><span class="line">    s = sha256(plain.encode()).hexdigest()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;sha256(<span class="subst">&#123;plain[:<span class="number">16</span>]&#125;</span>xxxx) = <span class="subst">&#123;s&#125;</span>&quot;</span>)</span><br><span class="line">    xxxx = <span class="built_in">input</span>(<span class="string">&quot;plz enter the xxxx: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> xxxx != plain[<span class="number">16</span>:]:</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rev</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        x = rotl(x, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rotl</span>(<span class="params">x, n</span>): <span class="keyword">return</span> ((x &lt;&lt; n) &amp; <span class="number">0xffffffff</span>) | ((x &gt;&gt; (<span class="number">32</span> - n)) &amp; <span class="number">0xffffffff</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xorl</span>(<span class="params">x, y</span>): <span class="keyword">return</span> <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> a, b: a ^ b, x, y))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Int2List</span>(<span class="params">x</span>): <span class="keyword">return</span> [x &gt;&gt; <span class="number">24</span>, (x &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xff</span>, (x &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>, x &amp; <span class="number">0xff</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">List2Int</span>(<span class="params">x</span>): <span class="keyword">return</span> x[<span class="number">0</span>] &lt;&lt; <span class="number">24</span> | x[<span class="number">1</span>] &lt;&lt; <span class="number">16</span> | x[<span class="number">2</span>] &lt;&lt; <span class="number">8</span> | x[<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Enc</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, key</span>):</span><br><span class="line">        self.K = key</span><br><span class="line">        self.S = sample([i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)], <span class="number">256</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">l</span>(<span class="params">self, B: <span class="built_in">list</span></span>) -&gt; <span class="built_in">list</span>:</span><br><span class="line">        B = List2Int(B)</span><br><span class="line">        B = B ^ rotl(B, <span class="number">2</span>) ^ rotl(B, <span class="number">10</span>) ^ rotl(B, <span class="number">18</span>) ^ rotl(B, <span class="number">24</span>)</span><br><span class="line">        <span class="keyword">return</span> Int2List(B)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, plain</span>):</span><br><span class="line">        T = xorl(self.K[:<span class="number">4</span>], plain)</span><br><span class="line">        T = Int2List(rev(List2Int(T)))</span><br><span class="line">        T = self.l([self.S[i] <span class="keyword">for</span> i <span class="keyword">in</span> T])</span><br><span class="line">        T = xorl(self.K[<span class="number">4</span>:], T)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>(T).<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">E</span>():</span><br><span class="line">    plain = <span class="built_in">input</span>(<span class="string">&quot;plz enter your plaintext: &quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;cipher = <span class="subst">&#123;C.encrypt(unhexlify(plain))&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_Flag</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;cipher = <span class="subst">&#123;f&#125;</span>&quot;</span>)</span><br><span class="line">    plain = <span class="built_in">input</span>(<span class="string">&quot;plz enter your plaintext: &quot;</span>)</span><br><span class="line">    c = C.encrypt(unhexlify(plain))</span><br><span class="line">    <span class="keyword">if</span> c == f:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;wrong!&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">memu</span>():</span><br><span class="line">    choose = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> choose == <span class="string">&quot;1&quot;</span>:</span><br><span class="line">        E()</span><br><span class="line">    <span class="keyword">elif</span> choose == <span class="string">&quot;2&quot;</span>:</span><br><span class="line">        Get_Flag()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Bye~&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    proof()</span><br><span class="line">    <span class="built_in">print</span>(logo)</span><br><span class="line">    key = urandom(<span class="number">8</span>)</span><br><span class="line">    C = Enc(key)</span><br><span class="line">    f = C.encrypt(urandom(<span class="number">4</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;sbox: <span class="subst">&#123;C.S&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(_memu)</span><br><span class="line">    alarm(<span class="number">10</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        memu()</span><br></pre></td></tr></table></figure>
<p>ä»£ç ç•¥æœ‰ç‚¹é•¿ï¼Œä¸€æ­¥ä¸€æ­¥æ¥ï¼Œè¿˜æ˜¯ä»åˆ†æåŠ å¯†æµç¨‹å¼€å§‹ï¼š</p>
<p>é¦–å…ˆï¼Œè¦è¿‡ä¸€ä¸ªproofï¼Œä¸ºçˆ†ç ´ä¸€ä¸ªåå…­è¿›åˆ¶ä¸²çš„æœ«å››ä½å“ˆå¸Œï¼Œè¿™ä¸ªæœ¬æ¥æ²¡ä»€ä¹ˆå¥½è®²çš„ï¼Œä½†æ˜¯ä»”ç»†çœ‹å¯ä»¥å‘ç°é¢˜ç›®è¿™é‡Œé”…äº†ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">proof</span>():</span><br><span class="line">    plain = <span class="string">&quot;&quot;</span>.join([choice(hexdigits) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">    <span class="built_in">print</span>(plain)</span><br><span class="line">    s = sha256(plain.encode()).hexdigest()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;sha256(<span class="subst">&#123;plain[:<span class="number">16</span>]&#125;</span>xxxx) = <span class="subst">&#123;s&#125;</span>&quot;</span>)</span><br><span class="line">    xxxx = <span class="built_in">input</span>(<span class="string">&quot;plz enter the xxxx: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> xxxx != plain[<span class="number">16</span>:]:</span><br><span class="line">        exit()</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œä»–ç›´æ¥printäº†æ˜æ–‡ä¸²ï¼Œå› æ­¤åªéœ€è¦æ¥å—æ˜æ–‡ä¸²ï¼Œå¹¶æŠŠæœ«å››ä¸ªåå…­è¿›åˆ¶æ•°å‘é€å›å»å³å¯é€šè¿‡proofã€‚å…¶å®è¿™ä¹Ÿæ²¡ä»€ä¹ˆï¼Œä¸è¿‡æ˜¯ä¸€ä¸ªå°å¤±è¯¯ã€‚ä½†ä¹‹æ‰€ä»¥æˆ‘è¦ç‰¹åœ°è®²å‡ºæ¥ï¼Œåœ¨è¿™ç¯‡wpåé¢ä¼šè¯´æ˜åŸå› ã€‚</p>
<p>è¿‡äº†proofåï¼ŒåŠ å¯†æ­£å¼å¼€å§‹ï¼š</p>
<ul>
<li>ç”Ÿæˆä¸€ä¸ª8å­—èŠ‚çš„éšæœºå¯†é’¥key</li>
<li>ç”¨è¿™ä¸ªkeyåˆå§‹åŒ–ä¸€ä¸ªEncå¯¹è±¡C</li>
<li>ç”Ÿæˆä¸€ä¸ª4å­—èŠ‚çš„éšæœºæ˜æ–‡ï¼Œè®°ä½œplainï¼Œå¹¶ç”¨Encå¯¹è±¡Cè¿›è¡ŒåŠ å¯†ï¼Œå¾—åˆ°f</li>
<li>ç»™å‡ºCä¸­çš„Sç›’</li>
<li>ç»™æˆ‘ä»¬10sæ—¶é—´ï¼Œå¯ä»¥é€‰æ‹©è¿›è¡Œä»¥ä¸‹ä¸¤ç§æ“ä½œï¼š</li>
<li><ul>
<li>è¾“å…¥â€1â€ï¼Œå¯ä»¥è‡ªè¡Œæ„é€ ä¸€ç»„æ˜æ–‡è¿›è¡ŒåŠ å¯†ï¼Œé¶æœºç«¯ä¼šè¿”å›åŠ å¯†åçš„å¯†æ–‡</li>
<li>è¾“å…¥â€2â€ï¼Œå¯ä»¥è¾“å…¥ä¸€ä¸ªæ˜æ–‡ï¼Œå¦‚æœè¾“å…¥çš„æ˜æ–‡è¢«åŠ å¯†åä¸fç›¸ç­‰ï¼Œåˆ™æ ¸éªŒé€šè¿‡ï¼Œå‘æ”¾flag</li>
</ul>
</li>
</ul>
<p>è¿™æ˜¯é¶æœºç«¯éœ€å®Œæˆçš„ä»»åŠ¡çš„é€»è¾‘ï¼Œå†æ¥çœ‹çœ‹Encå¯¹è±¡å…·ä½“æ˜¯æ€ä¹ˆåŠ å¯†çš„ï¼Œä¹Ÿå°±æ˜¯encryptå‡½æ•°ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, plain</span>):</span><br><span class="line">    T = xorl(self.K[:<span class="number">4</span>], plain)</span><br><span class="line">    T = Int2List(rev(List2Int(T)))</span><br><span class="line">    T = self.l([self.S[i] <span class="keyword">for</span> i <span class="keyword">in</span> T])</span><br><span class="line">    T = xorl(self.K[<span class="number">4</span>:], T)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(T).<span class="built_in">hex</span>()</span><br></pre></td></tr></table></figure>
<ul>
<li>ç”Ÿæˆä¸€ä¸ªSç›’ï¼Œæ˜¯ä¸€ä¸ª(0,256)ä¹‹é—´çš„éšæœºç½®æ¢</li>
<li>å°†æ˜æ–‡ä¸keyçš„å‰å››ä¸ªå­—èŠ‚ä½œå¼‚æˆ–ï¼Œå¾—åˆ°T</li>
<li>ç¬¬äºŒè¡Œï¼Œåšå®Œäº†é¢˜ä¹Ÿä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨ï¼Œä¼°è®¡æ˜¯å‡ºé¢˜æ²¡åˆ å¹²å‡€</li>
<li>å°†Tä½œSç›’ç½®æ¢åï¼Œè°ƒç”¨lå‡½æ•°ï¼Œå¾—åˆ°æ›´æ–°åçš„T</li>
<li>å°†Tä¸keyçš„ååŠæ®µå¼‚æˆ–ï¼Œå¹¶ç»™å‡ºåå…­è¿›åˆ¶å¯†æ–‡</li>
</ul>
<p>å…¶ä¸­ï¼Œlå‡½æ•°å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">l</span>(<span class="params">self, B: <span class="built_in">list</span></span>) -&gt; <span class="built_in">list</span>:</span><br><span class="line">    B = List2Int(B)</span><br><span class="line">    B = B ^ rotl(B, <span class="number">2</span>) ^ rotl(B, <span class="number">10</span>) ^ rotl(B, <span class="number">18</span>) ^ rotl(B, <span class="number">24</span>)</span><br><span class="line">    <span class="keyword">return</span> Int2List(B)</span><br></pre></td></tr></table></figure>
<p>ä½ åº”è¯¥å¯ä»¥æ„Ÿè§‰åˆ°ï¼Œå¦‚æœèƒ½å¤ŸçŸ¥é“lå‡½æ•°çš„å¯†æ–‡ï¼Œé‚£ä¹ˆè¿™ç§çº§åˆ«çš„åŠ å¯†å¯¹äºz3æ¥è¯´ï¼Œæ±‚è§£å‡ºæ˜æ–‡ä¸æ˜¯éš¾äº‹ã€‚</p>
<p>è‡³æ­¤ï¼Œé¢˜ç›®åŠ å¯†æµç¨‹å°±æ¢³ç†ç»“æŸäº†ï¼Œæ¥ä¸‹æ¥è¿›è¡Œåˆ°åˆ†æç¯èŠ‚ã€‚</p>
<h4 id="æ€è·¯ä¸€ï¼šç”Ÿæ—¥æ”»å‡»"><a href="#æ€è·¯ä¸€ï¼šç”Ÿæ—¥æ”»å‡»" class="headerlink" title="æ€è·¯ä¸€ï¼šç”Ÿæ—¥æ”»å‡»"></a>æ€è·¯ä¸€ï¼šç”Ÿæ—¥æ”»å‡»</h4><p>åˆšæ‰æˆ‘ç‰¹æ„è¯´ï¼Œé¢˜ç›®çš„proofé”…äº†ï¼Œä¸éœ€è¦å®é™…çˆ†ç ´ï¼Œä½œç”¨å°±åœ¨è¿™é‡Œã€‚èŠ‚çœä¸‹æ¥çš„çˆ†ç ´æ—¶é—´ç»™ç”Ÿæ—¥æ”»å‡»æä¾›äº†ä¸€ç‚¹å¯èƒ½æ€§ã€‚</p>
<p>ä½ å¯ä»¥å‘ç°ï¼Œé¢˜ç›®å®è´¨ä¸Šå°±æ˜¯è¦æ±‚ç»™å‡ºæ­£ç¡®çš„4ä¸ªæ˜æ–‡å­—èŠ‚ã€‚è€Œ4ä¸ªå­—èŠ‚ä¸€å…±æœ‰2^32æ¬¡æ–¹ç§å¯èƒ½æ€§ï¼Œå› æ­¤æˆ‘ä»¬éšä¾¿è¾“å…¥å››ä¸ªå­—èŠ‚ç»™é¶æœºï¼Œä¹Ÿæœ‰ $ \frac{1}{2^{32}}$ çš„æœºä¼šæˆåŠŸã€‚è€Œå¤±è´¥äº†çš„è¯ï¼Œå°±é‡æ–°è¿æ¥é¶æœºï¼Œå†éšä¾¿è¾“å…¥å››ä¸ªå­—èŠ‚ï¼Œå¦‚æ­¤é‡å¤ã€‚æ ¹æ®ç”Ÿæ—¥æ”»å‡»ç†è®ºï¼Œå¦‚æœèƒ½å¤Ÿåå¤è¿›è¡Œ2^32æ¬¡ï¼Œæˆ‘ä»¬å°±æœ‰è¶…è¿‡50%çš„å‡ ç‡è‡³å°‘æˆåŠŸæ”»å‡»ä¸€æ¬¡ï¼Œé‚£ä¹ˆå°±èƒ½æ‹¿åˆ°flagã€‚</p>
<p>å½“ç„¶ï¼Œå³ä½¿proofé”…äº†ï¼ŒçœŸçš„è¦è¿›è¡Œ2^32æ¬¡æ–¹æ¬¡çš„è¯ï¼Œå¯ä»¥ç”¨tqdmæµ‹è¯•ä¸€ä¸‹å¤§æ¦‚éœ€è¦600000ä¸ªå°æ—¶ï¼Œä»ç„¶æ˜¯ä¸ç°å®çš„ã€‚ä½†æ˜¯è¿™ç¡®å®æ˜¯ä¸ªæ€è·¯ï¼Œä¸€ç‚¹åŠæ³•éƒ½æ²¡æœ‰çš„æ—¶å€™ï¼Œå¯ä»¥æ‹¼æ‹¼è¿æ°”ã€‚</p>
<h4 id="æ€è·¯äºŒï¼šæ„é€ æ˜æ–‡"><a href="#æ€è·¯äºŒï¼šæ„é€ æ˜æ–‡" class="headerlink" title="æ€è·¯äºŒï¼šæ„é€ æ˜æ–‡"></a>æ€è·¯äºŒï¼šæ„é€ æ˜æ–‡</h4><p>ç”Ÿæ—¥æ”»å‡»åªèƒ½è¯´æœ‰éå¸¸å¾®å°çš„æˆåŠŸçš„æœºä¼šã€‚çœŸæ­£è¦åšçš„è¯ï¼Œè¿˜æ˜¯å¾—åˆ†æä¸€ä¸‹åŠ å¯†æµç¨‹ï¼Œä»¥åŠå¦‚ä½•æ„é€ å‡ºå¯ç”¨çš„æ˜æ–‡ã€‚</p>
<p>é¦–å…ˆè¦æ³¨æ„åˆ°ï¼Œæˆ‘ä»¬åªæœ‰10sæ—¶é—´ï¼Œè¿™æ˜¯ä¸ªéå¸¸é‡è¦çš„ä¿¡æ¯ã€‚ç»è¿‡æˆ‘ç”¨tqdmæµ‹è¯•ï¼Œæˆ‘ä»¬å¤§æ¦‚æœ€å¤šèƒ½æ„é€ 30-40ç»„æ˜æ–‡è®©æœåŠ¡å™¨åŠ å¯†ã€‚å¹¶ä¸”ï¼Œè€ƒè™‘åˆ°è¿˜éœ€è¦ç”¨æ„é€ å‡ºçš„æ˜æ–‡ä¿¡æ¯å¯¹fè¿›è¡Œè§£å¯†ï¼Œå®é™…ä¸Šæ¥è¯´å¯èƒ½æœ€å¤šåªèƒ½æ„é€ 10-20ç»„æ˜æ–‡ã€‚</p>
<p>è¿™ä¸ªç”¨å¤„æŒºå¤§çš„ï¼Œç›´æ¥å®Œå…¨æ’é™¤äº†ä¸­é—´ç›¸é‡æ”»å‡»ã€å»ºç«‹å­—å…¸æŸ¥æ‰¾ç­‰æ€è·¯ã€‚å› æ­¤ç°åœ¨çš„ä¸»è¦ç›®æ ‡å°±æ˜¯ï¼šå¦‚ä½•ç”¨æœ‰é™çš„ã€å°‘é‡çš„æ˜æ–‡ï¼Œå»æ³„éœ²Encå¯¹è±¡Cçš„ä¿¡æ¯ï¼Œä»è€Œè§£å¯†å¯†æ–‡ã€‚</p>
<p>ä½ åº”è¯¥èƒ½çœ‹å‡ºæ¥ï¼Œå¦‚æœä½ èƒ½è·å¾—å¯†é’¥keyçš„å®Œæ•´8ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆè§£å¯†æ˜¯å¾ˆå®¹æ˜“çš„ï¼Œåªéœ€è¦å¯¹åº”å¼‚æˆ–ã€é€†ç½®æ¢ã€z3è§£æ–¹ç¨‹å°±å¯ä»¥è§£å¯†å‡ºæ˜æ–‡ã€‚</p>
<p>å› æ­¤ï¼Œé‡å¿ƒæ”¾åœ¨æ±‚è§£keyä¸Šä¹Ÿå°±æ˜¯è‡ªç„¶è€Œç„¶çš„æ€è·¯ã€‚å¾ˆå®¹æ˜“æƒ³åˆ°ï¼Œå¦‚æœå‘é€å››ä¸ªå­—èŠ‚çš„â€\x00â€ç»™é¶æœºç«¯ï¼Œé‚£ä¹ˆå†è§‚å¯Ÿencryptå‡½æ•°ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, plain</span>):</span><br><span class="line">    T = xorl(self.K[:<span class="number">4</span>], plain)</span><br><span class="line">    T = Int2List(rev(List2Int(T)))</span><br><span class="line">    T = self.l([self.S[i] <span class="keyword">for</span> i <span class="keyword">in</span> T])</span><br><span class="line">    T = xorl(self.K[<span class="number">4</span>:], T)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(T).<span class="built_in">hex</span>()</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆç¬¬ä¸€æ­¥å¾—åˆ°çš„Tå…¶å®å°±æ˜¯keyçš„å‰å››ä¸ªå­—èŠ‚ï¼Œåœ¨ä¹‹åä¹Ÿæ˜¯keyçš„å‰å››ä¸ªå­—èŠ‚è¿›è¡Œç½®æ¢ã€è°ƒç”¨lå‡½æ•°ç­‰ã€‚</p>
<p>è€Œç¬¬äºŒæ¬¡ï¼Œè€ƒè™‘å‘é€ä¸‹é¢è¿™æ ·çš„å­—èŠ‚ä¸²ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">b&quot;\x00&quot;</span> * <span class="number">3</span> + <span class="string">b&quot;\x01&quot;</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å‘ç°ï¼Œç¬¬ä¸€éƒ¨å¾—åˆ°çš„Tï¼Œå‰é¢ä¸‰ä¸ªå­—èŠ‚å¹¶æ²¡æœ‰å—åˆ°å½±å“ï¼Œä»ç„¶æ˜¯keyçš„å‰ä¸‰ä¸ªå­—èŠ‚ï¼Œåªæœ‰æœ€åä¸€å­—èŠ‚çš„æœ€åä¸€æ¯”ç‰¹å–äº†åã€‚å› æ­¤ï¼Œåˆ°ç¬¬ä¸‰æ­¥ç½®æ¢æ—¶ï¼Œå‰ä¸‰ä¸ªå­—èŠ‚çš„ç½®æ¢ä»ç„¶æ˜¯ä¸å˜çš„ï¼Œå˜çš„åªæœ‰ç¬¬å››ä¸ªå­—èŠ‚ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç»è¿‡è¿™ä¸¤æ¬¡æ˜æ–‡çš„å‘é€ï¼Œlå‡½æ•°è¾“å…¥çš„å‚æ•°åˆ—è¡¨åªæœ‰æœ€åä¸€ä¸ªå‘ç”Ÿäº†æ”¹å˜ï¼</p>
<p>è€Œæˆ‘ä»¬å†çœ‹lå‡½æ•°åŠ å¯†è¿‡ç¨‹ï¼Œä¸ºäº†ç›´è§‚æˆ‘ç”»ä¸ªå›¾åƒï¼š</p>
<p><img src="/post/a5bd8c0d/image-20231007231119071.png" alt="image-20231007231119071"></p>
<p>çº¢è‰²éƒ¨åˆ†ä»£è¡¨ä¸¤æ¬¡æ„é€ çš„æ˜æ–‡åœ¨è°ƒlå‡½æ•°æ—¶çš„ä¸åŒé‡ï¼Œé»„è‰²éƒ¨åˆ†ä»£è¡¨å¾—åˆ°å¯†æ–‡ï¼Œçº¿æ¡è¡¨ç¤ºè¯¥çº¿æ¡ä¸å¦ä¸€çº¿æ¡ä¹‹é—´çš„äº”ä¸ªéƒ¨åˆ†å¼‚æˆ–å¾—åˆ°ä¸‹æ–¹çš„å¯†æ–‡ã€‚</p>
<p>é‚£ä¹ˆä½ ä»”ç»†çœ‹è¿™ä¸ªå›¾ï¼Œä½ ä¼šå‘ç°ï¼Œç¬¬äºŒå—å¯†æ–‡å’Œç¬¬ä¸‰å—å¯†æ–‡ï¼Œå¯¹äºçº¢è‰²å—å¼‚æˆ–çš„é‡æ˜¯ç›¸åŒçš„ï¼é‚£ä¹ˆæˆ‘ä»¬å°†ä¸¤æ¬¡æœåŠ¡å™¨è¿”å›çš„å¯†æ–‡å¼‚æˆ–ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿåœ¨ä¸‹é¢çš„åˆ†æè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æŠŠkeyçš„å‰åŠéƒ¨åˆ†è®°ä½œkey1ï¼ŒååŠéƒ¨åˆ†è®°ä½œkey2.</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬æŠŠmç»ç½®æ¢åçš„åˆ—è¡¨è®°ä½œP(m)ï¼Œç»lå‡½æ•°åçš„åˆ—è¡¨è®°ä½œl(P(m))ï¼Œä¹Ÿå°±æ˜¯mç»ç¬¬ä¸‰æ­¥å˜æ¢åï¼Œè®°ä½œ(l(P(m)))ã€‚é‚£ä¹ˆä¸¤æ¬¡æ„é€ æ˜æ–‡åˆ°ç¬¬ä¸‰æ­¥å‰åˆ†åˆ«æ˜¯key1ã€key1â€™ï¼Œåˆ™æœ‰ï¼š</p>
<script type="math/tex; mode=display">
c1 \oplus c2 = (l(P(key_1)) \oplus key_2) \oplus (l(P(key_1')) \oplus key_2)</script><p>é‚£ä¹ˆå°±å¯ä»¥æ¶ˆæ‰key2ï¼Œå³ï¼š</p>
<script type="math/tex; mode=display">
c1 \oplus c2 = l(P(key_1) \oplus l(P(key_1'))</script><p>è€Œæ ¹æ®åˆšæ‰çš„ç”»å›¾åˆ†æï¼Œå¯†æ–‡ä¸­é—´ä¸¤å—å¯¹çº¢è‰²çš„å¼‚æˆ–åˆ©ç”¨æ˜¯ç›¸åŒçš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å•ç‹¬åˆ†æä¸Šå¼çš„ä¸­é—´ä¸¤å—ï¼Œå¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
ä¸­é—´ä¸¤å—å¼‚æˆ– = ä¸¤æ¬¡æ˜æ–‡çš„ä¸åŒçº¢è‰²é‡å¼‚æˆ–</script><p>è¿™ä¸€éƒ¨åˆ†ä¸€å®šè¦ç»“åˆå›¾å¤šç†è§£ç†è§£ï¼Œæˆ‘æ²¡æœ‰æƒ³åˆ°è®²çš„ç‰¹åˆ«æ¸…æ¥šçš„åŠæ³•ï¼Œå¦‚æœå“ªé‡Œä¸æ˜ç™½å¯ä»¥ä¸æˆ‘äº¤æµã€‚</p>
<p>è€Œä¸¤æ¬¡ä¸åŒçš„çº¢è‰²é‡åˆ†åˆ«æ˜¯(key1)å’Œ(key1^1)ç»ç½®æ¢å¾—åˆ°çš„æœ€åä¸€å­—èŠ‚ï¼Œè€Œæˆ‘ä»¬æ‹¥æœ‰è¿™ä¸ªå¼‚æˆ–å€¼ä»¥åŠSç›’ï¼Œå› æ­¤å¯ä»¥åæŸ¥åˆ°æ‰€æœ‰å¯èƒ½çš„è§£ã€‚ä¸€èˆ¬æ¥è¯´ä¼šæœ‰1-4ç»„ã€‚</p>
<p>é‚£ä¹ˆé€šè¿‡ä¸Šè¿°æ–¹æ³•ï¼Œæˆ‘ä»¬å°±è·å¾—äº†key1çš„ä¸€ä¸ªå­—èŠ‚ï¼Œè€Œç±»ä¼¼çš„ï¼Œé€šè¿‡æ„é€ ä¸‹é¢å‡ ç»„æ˜æ–‡å¹¶å‘é€ï¼Œå¯ä»¥é€šè¿‡ç›¸åŒçš„åˆ†æå¾—åˆ°key1çš„å‰©ä¸‹ä¸‰ä¸ªå­—èŠ‚ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">b&quot;\x00&quot;</span>*<span class="number">2</span> + <span class="string">b&quot;\x01&quot;</span>*<span class="number">1</span> +<span class="string">b&quot;\x00&quot;</span>*<span class="number">1</span></span><br><span class="line"><span class="string">b&quot;\x00&quot;</span>*<span class="number">1</span> + <span class="string">b&quot;\x01&quot;</span>*<span class="number">1</span> +<span class="string">b&quot;\x00&quot;</span>*<span class="number">2</span></span><br><span class="line"><span class="string">b&quot;\x01&quot;</span>*<span class="number">1</span> + <span class="string">b&quot;\x00&quot;</span>*<span class="number">3</span></span><br></pre></td></tr></table></figure>
<p>è€Œæœ‰äº†key1åï¼Œæˆ‘ä»¬å°±å¯ä»¥å‘é€key1ä½œä¸ºæ˜æ–‡ï¼Œé‚£ä¹ˆç»ç¬¬ä¸€æ­¥å¼‚æˆ–åå¾—åˆ°çš„Tå°±æ˜¯å››ä¸ªå…¨é›¶å­—èŠ‚ï¼Œé‚£ä¹ˆä¹Ÿå°±è‡ªç„¶çš„å¯ä»¥å¾—åˆ°ç¬¬ä¸‰æ­¥ç½®æ¢ä»¥åŠåŠ å¯†åçš„å€¼ï¼Œå†ä¸æœåŠ¡å™¨è¿”å›çš„å¯†æ–‡å¼‚æˆ–å°±èƒ½å¾—åˆ°key2.</p>
<p>å¾—åˆ°key2åï¼Œè§£å¯†ç›¸å¯¹æ¥è¯´å°±å¾ˆå®¹æ˜“äº†ï¼Œå¯ä»¥è‡ªè¡Œé€†åºå®ç°ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæœ‰ä¸€ä¸ªåœ°æ–¹å¯¼è‡´æˆ‘ä»¬å¯èƒ½ä¸æˆåŠŸï¼š</p>
<ul>
<li>æ¯æ¬¡è·å¾—çš„key1çš„æŸå­—èŠ‚å¯èƒ½æœ‰å¤šè§£</li>
</ul>
<p>ä½†æ˜¯æ²¡å…³ç³»ï¼Œæˆ‘ä»¬åªéœ€è¦å¤šä¸é¶æœºäº¤äº’å‡ æ¬¡ï¼Œç›´åˆ°æ»¡è¶³key1çš„å››ä¸ªå­—èŠ‚éƒ½æ˜¯æ­£ç¡®è§£å³å¯ã€‚è¿™ä¸€æ®µå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æœ¬åœ°è°ƒè¯•ä¸€ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> sample, choice</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> hexdigits</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rev</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        x = rotl(x, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">l</span>(<span class="params">B</span>):</span><br><span class="line">    B = List2Int(B)</span><br><span class="line">    B = B ^ rotl(B, <span class="number">2</span>) ^ rotl(B, <span class="number">10</span>) ^ rotl(B, <span class="number">18</span>) ^ rotl(B, <span class="number">24</span>)</span><br><span class="line">    <span class="keyword">return</span> Int2List(B)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rotl</span>(<span class="params">x, n</span>): <span class="keyword">return</span> ((x &lt;&lt; n) &amp; <span class="number">0xffffffff</span>) | ((x &gt;&gt; (<span class="number">32</span> - n)) &amp; <span class="number">0xffffffff</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xorl</span>(<span class="params">x, y</span>): <span class="keyword">return</span> <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> a, b: a ^ b, x, y))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Int2List</span>(<span class="params">x</span>): <span class="keyword">return</span> [x &gt;&gt; <span class="number">24</span>, (x &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xff</span>, (x &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>, x &amp; <span class="number">0xff</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">List2Int</span>(<span class="params">x</span>): <span class="keyword">return</span> x[<span class="number">0</span>] &lt;&lt; <span class="number">24</span> | x[<span class="number">1</span>] &lt;&lt; <span class="number">16</span> | x[<span class="number">2</span>] &lt;&lt; <span class="number">8</span> | x[<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">K,cipher</span>):</span><br><span class="line">    T = List2Int(xorl(K[<span class="number">4</span>:],cipher))</span><br><span class="line">    s = Solver() </span><br><span class="line">    B = BitVec(<span class="string">&#x27;B&#x27;</span>,<span class="number">32</span>)</span><br><span class="line">    s.add(B ^ rotl(B, <span class="number">2</span>) ^ rotl(B, <span class="number">10</span>) ^ rotl(B, <span class="number">18</span>) ^ rotl(B, <span class="number">24</span>) == T)</span><br><span class="line">    <span class="keyword">if</span> s.check() == sat:    <span class="comment">#æ£€æµ‹æ˜¯å¦æœ‰è§£</span></span><br><span class="line">        result = <span class="built_in">str</span>(s.model()) </span><br><span class="line">        T = Int2List(<span class="built_in">int</span>(result[<span class="number">5</span>:-<span class="number">1</span>]))</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(T)):</span><br><span class="line">            T[i] = inv_S[T[i]]</span><br><span class="line">    T = List2Int(xorl(K[:<span class="number">4</span>],T))</span><br><span class="line">    <span class="keyword">return</span> long_to_bytes(T).<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Enc</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, key</span>):</span><br><span class="line">        self.K = key</span><br><span class="line">        self.S = sample([i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)], <span class="number">256</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">l</span>(<span class="params">self, B: <span class="built_in">list</span></span>) -&gt; <span class="built_in">list</span>:</span><br><span class="line">        B = List2Int(B)</span><br><span class="line">        B = B ^ rotl(B, <span class="number">2</span>) ^ rotl(B, <span class="number">10</span>) ^ rotl(B, <span class="number">18</span>) ^ rotl(B, <span class="number">24</span>)</span><br><span class="line">        <span class="keyword">return</span> Int2List(B)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, plain</span>):</span><br><span class="line">        T = xorl(self.K[:<span class="number">4</span>], plain)</span><br><span class="line">        T = Int2List(rev(List2Int(T)))</span><br><span class="line">        temp = [self.S[i] <span class="keyword">for</span> i <span class="keyword">in</span> T]</span><br><span class="line">        T = self.l(temp)</span><br><span class="line">        T = xorl(self.K[<span class="number">4</span>:], T)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>(T)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">E</span>(<span class="params">m</span>):</span><br><span class="line">    plain = hexlify(m)</span><br><span class="line">    <span class="keyword">return</span> C.encrypt(unhexlify(plain))</span><br><span class="line"></span><br><span class="line">fin = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            key = urandom(<span class="number">8</span>)</span><br><span class="line">            C = Enc(key)</span><br><span class="line">            x = []</span><br><span class="line">            x.append(E(<span class="string">b&quot;\x00&quot;</span>*<span class="number">4</span>))</span><br><span class="line">            x.append(E(<span class="string">b&quot;\x00&quot;</span>*<span class="number">3</span> + <span class="string">b&quot;\x01&quot;</span>*<span class="number">1</span> +<span class="string">b&quot;\x00&quot;</span>*<span class="number">0</span>))</span><br><span class="line">            x.append(E(<span class="string">b&quot;\x00&quot;</span>*<span class="number">2</span> + <span class="string">b&quot;\x01&quot;</span>*<span class="number">1</span> +<span class="string">b&quot;\x00&quot;</span>*<span class="number">1</span>))</span><br><span class="line">            x.append(E(<span class="string">b&quot;\x00&quot;</span>*<span class="number">1</span> + <span class="string">b&quot;\x01&quot;</span>*<span class="number">1</span> +<span class="string">b&quot;\x00&quot;</span>*<span class="number">2</span>))</span><br><span class="line">            x.append(E(<span class="string">b&quot;\x00&quot;</span>*<span class="number">0</span> + <span class="string">b&quot;\x01&quot;</span>*<span class="number">1</span> +<span class="string">b&quot;\x00&quot;</span>*<span class="number">3</span>))</span><br><span class="line">            c = urandom(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">            S = C.S</span><br><span class="line">            inv_S = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)]</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">                inv_S[S[i]] = i</span><br><span class="line"></span><br><span class="line">            <span class="comment">#è·å–key</span></span><br><span class="line">            key_prefix = []</span><br><span class="line"></span><br><span class="line">            <span class="comment">#1.è·å–key[:4]</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">5</span>):</span><br><span class="line">                <span class="keyword">if</span>(i % <span class="number">2</span> == <span class="number">0</span>):</span><br><span class="line">                    temp = (xorl(x[<span class="number">0</span>],x[i]))[i-<span class="number">2</span>]</span><br><span class="line">                <span class="keyword">elif</span>(i % <span class="number">2</span> == <span class="number">1</span>):</span><br><span class="line">                    temp = (xorl(x[<span class="number">0</span>],x[i]))[i]</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">                    t1 = (S[j]&gt;&gt;<span class="number">6</span>) + ((S[j]&amp;<span class="number">0b111111</span>)&lt;&lt;<span class="number">2</span>)</span><br><span class="line">                    t2 = (S[j^<span class="number">1</span>]&gt;&gt;<span class="number">6</span>) + ((S[j^<span class="number">1</span>]&amp;<span class="number">0b111111</span>)&lt;&lt;<span class="number">2</span>)</span><br><span class="line">                    <span class="keyword">if</span>(t1^t2 == temp):</span><br><span class="line">                        key_prefix.append(inv_S[S[j]])</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">            key_prefix = key_prefix[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">            key_suffix = Int2List(bytes_to_long(E(long_to_bytes(List2Int(key_prefix)))))</span><br><span class="line">            T = [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">            temp = l([S[i] <span class="keyword">for</span> i <span class="keyword">in</span> T])</span><br><span class="line">            key_suffix = xorl(temp, key_suffix)</span><br><span class="line">            key_final = long_to_bytes(List2Int(key_prefix)) + long_to_bytes(List2Int(key_suffix))</span><br><span class="line"></span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span>(decrypt(key_final,E(c)) == c.<span class="built_in">hex</span>()):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(count)</span><br><span class="line">    fin += count</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(fin//<span class="number">10</span>)</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥è®¡ç®—å‡ºï¼Œå¹³å‡éœ€è¦180æ¬¡å·¦å³ï¼Œèƒ½è·å¾—ä¸€æ¬¡key1çš„å®Œå…¨æ­£ç¡®çš„è§£ã€‚è¿æ°”å¥½çš„è¯å‡ ç»„å°±èƒ½å‡ºï¼Œè¿æ°”ä¸å¥½æ¥è¿‘ä¸€åƒç»„ä¹Ÿæœ‰å¯èƒ½ï¼Œä¸è¿‡æ²¡äº‹ï¼Œäº¤äº’æŒ‚ç€è·‘å°±å¥½ã€‚</p>
<p>è€Œæœ¬åœ°èƒ½æ­£ç¡®è§£å¯†çš„è¯ï¼Œæˆ‘ä»¬å°±èƒ½é¡ºåˆ©ç¼–å†™é¶æœºä»£ç äº†ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rotl</span>(<span class="params">x, n</span>): <span class="keyword">return</span> ((x &lt;&lt; n) &amp; <span class="number">0xffffffff</span>) | ((x &gt;&gt; (<span class="number">32</span> - n)) &amp; <span class="number">0xffffffff</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xorl</span>(<span class="params">x, y</span>): <span class="keyword">return</span> <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> a, b: a ^ b, x, y))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">List2Int</span>(<span class="params">x</span>): <span class="keyword">return</span> x[<span class="number">0</span>] &lt;&lt; <span class="number">24</span> | x[<span class="number">1</span>] &lt;&lt; <span class="number">16</span> | x[<span class="number">2</span>] &lt;&lt; <span class="number">8</span> | x[<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Int2List</span>(<span class="params">x</span>): <span class="keyword">return</span> [x &gt;&gt; <span class="number">24</span>, (x &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xff</span>, (x &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>, x &amp; <span class="number">0xff</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">l</span>(<span class="params">B</span>):</span><br><span class="line">    B = List2Int(B)</span><br><span class="line">    B = B ^ rotl(B, <span class="number">2</span>) ^ rotl(B, <span class="number">10</span>) ^ rotl(B, <span class="number">18</span>) ^ rotl(B, <span class="number">24</span>)</span><br><span class="line">    <span class="keyword">return</span> Int2List(B)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">K,cipher,inv_S</span>):</span><br><span class="line">    T = List2Int(xorl(K[<span class="number">4</span>:],cipher))</span><br><span class="line">    s = Solver() </span><br><span class="line">    B = BitVec(<span class="string">&#x27;B&#x27;</span>,<span class="number">32</span>)</span><br><span class="line">    s.add(B ^ rotl(B, <span class="number">2</span>) ^ rotl(B, <span class="number">10</span>) ^ rotl(B, <span class="number">18</span>) ^ rotl(B, <span class="number">24</span>) == T)</span><br><span class="line">    <span class="keyword">if</span> s.check() == sat:    <span class="comment">#æ£€æµ‹æ˜¯å¦æœ‰è§£</span></span><br><span class="line">        result = <span class="built_in">str</span>(s.model()) </span><br><span class="line">        T = Int2List(<span class="built_in">int</span>(result[<span class="number">5</span>:-<span class="number">1</span>]))</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(T)):</span><br><span class="line">            T[i] = inv_S[T[i]]</span><br><span class="line">    T = List2Int(xorl(K[:<span class="number">4</span>],T))</span><br><span class="line">    <span class="keyword">return</span> long_to_bytes(T).<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getflag</span>():</span><br><span class="line">        <span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                r = remote(<span class="string">&quot;node4.anna.nssctf.cn&quot;</span>,<span class="number">28579</span>)</span><br><span class="line">                temp = r.recvline().strip().decode()[-<span class="number">4</span>:]</span><br><span class="line">                r.sendline(temp.encode())</span><br><span class="line">                r.recvuntil(<span class="string">b&quot;sbox: &quot;</span>)</span><br><span class="line">                S = <span class="built_in">eval</span>(r.recvline())</span><br><span class="line">                inv_S = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)]</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">                    inv_S[S[i]] = i</span><br><span class="line"></span><br><span class="line">                x = []</span><br><span class="line">                <span class="comment">#0</span></span><br><span class="line">                temp = r.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">                r.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">                temp = r.recvuntil(<span class="string">b&quot; plaintext: &quot;</span>)</span><br><span class="line">                r.sendline(hexlify(<span class="string">b&quot;\x00&quot;</span>*<span class="number">4</span>))</span><br><span class="line">                temp = r.recvuntil(<span class="string">b&quot;cipher =&quot;</span>)</span><br><span class="line">                x.append(unhexlify(r.recvline().strip()))</span><br><span class="line"></span><br><span class="line">                <span class="comment">#1</span></span><br><span class="line">                temp = r.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">                r.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">                temp = r.recvuntil(<span class="string">b&quot; plaintext: &quot;</span>)</span><br><span class="line">                r.sendline(hexlify(<span class="string">b&quot;\x00&quot;</span>*<span class="number">3</span> + <span class="string">b&quot;\x01&quot;</span>*<span class="number">1</span> +<span class="string">b&quot;\x00&quot;</span>*<span class="number">0</span>))</span><br><span class="line">                temp = r.recvuntil(<span class="string">b&quot;cipher =&quot;</span>)		</span><br><span class="line">                x.append(unhexlify(r.recvline().strip()))</span><br><span class="line"></span><br><span class="line">                <span class="comment">#2</span></span><br><span class="line">                temp = r.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">                r.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">                temp = r.recvuntil(<span class="string">b&quot; plaintext: &quot;</span>)</span><br><span class="line">                r.sendline(hexlify(<span class="string">b&quot;\x00&quot;</span>*<span class="number">2</span> + <span class="string">b&quot;\x01&quot;</span>*<span class="number">1</span> +<span class="string">b&quot;\x00&quot;</span>*<span class="number">1</span>))</span><br><span class="line">                temp = r.recvuntil(<span class="string">b&quot;cipher =&quot;</span>)</span><br><span class="line">                x.append(unhexlify(r.recvline().strip()))</span><br><span class="line"></span><br><span class="line">                <span class="comment">#3</span></span><br><span class="line">                temp = r.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">                r.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">                temp = r.recvuntil(<span class="string">b&quot; plaintext: &quot;</span>)</span><br><span class="line">                r.sendline(hexlify(<span class="string">b&quot;\x00&quot;</span>*<span class="number">1</span> + <span class="string">b&quot;\x01&quot;</span>*<span class="number">1</span> +<span class="string">b&quot;\x00&quot;</span>*<span class="number">2</span>))</span><br><span class="line">                temp = r.recvuntil(<span class="string">b&quot;cipher =&quot;</span>)</span><br><span class="line">                x.append(unhexlify(r.recvline().strip()))</span><br><span class="line"></span><br><span class="line">                <span class="comment">#4</span></span><br><span class="line">                temp = r.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">                r.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">                temp = r.recvuntil(<span class="string">b&quot; plaintext: &quot;</span>)</span><br><span class="line">                r.sendline(hexlify(<span class="string">b&quot;\x00&quot;</span>*<span class="number">0</span> + <span class="string">b&quot;\x01&quot;</span>*<span class="number">1</span> +<span class="string">b&quot;\x00&quot;</span>*<span class="number">3</span>))</span><br><span class="line">                temp = r.recvuntil(<span class="string">b&quot;cipher =&quot;</span>)</span><br><span class="line">                x.append(unhexlify(r.recvline().strip()))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                <span class="comment">#è·å–key</span></span><br><span class="line">                key_prefix = []</span><br><span class="line"></span><br><span class="line">                <span class="comment">#1.è·å–key[:4]</span></span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">5</span>):</span><br><span class="line">                    <span class="keyword">if</span>(i % <span class="number">2</span> == <span class="number">0</span>):</span><br><span class="line">                        temp = (xorl(x[<span class="number">0</span>],x[i]))[i-<span class="number">2</span>]</span><br><span class="line">                    <span class="keyword">elif</span>(i % <span class="number">2</span> == <span class="number">1</span>):</span><br><span class="line">                        temp = (xorl(x[<span class="number">0</span>],x[i]))[i]</span><br><span class="line">                    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">255</span>):</span><br><span class="line">                        t1 = (S[j]&gt;&gt;<span class="number">6</span>) + ((S[j]&amp;<span class="number">0b111111</span>)&lt;&lt;<span class="number">2</span>)</span><br><span class="line">                        t2 = (S[j^<span class="number">1</span>]&gt;&gt;<span class="number">6</span>) + ((S[j^<span class="number">1</span>]&amp;<span class="number">0b111111</span>)&lt;&lt;<span class="number">2</span>)</span><br><span class="line">                        <span class="keyword">if</span>(t1^t2 == temp):</span><br><span class="line">                            key_prefix.append(inv_S[S[j]])</span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">                key_prefix = key_prefix[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">                <span class="comment">#2.è·å–key[4:]</span></span><br><span class="line">                temp = r.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">                r.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">                temp = r.recvuntil(<span class="string">b&quot; plaintext: &quot;</span>)</span><br><span class="line">                r.sendline(hexlify(long_to_bytes(List2Int(key_prefix))))</span><br><span class="line">                temp = r.recvuntil(<span class="string">b&quot;cipher =&quot;</span>)</span><br><span class="line">                key_suffix = Int2List(bytes_to_long(unhexlify(r.recvline().strip())))</span><br><span class="line">                T = [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">                temp = l([S[i] <span class="keyword">for</span> i <span class="keyword">in</span> T])</span><br><span class="line">                key_suffix = xorl(temp, key_suffix)</span><br><span class="line">                key_final = long_to_bytes(List2Int(key_prefix)) + long_to_bytes(List2Int(key_suffix))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                <span class="comment">#è·å–flag</span></span><br><span class="line">                temp = r.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">                r.sendline(<span class="string">b&quot;2&quot;</span>)</span><br><span class="line">                temp = r.recvuntil(<span class="string">b&quot;cipher =&quot;</span>)</span><br><span class="line">                cipher = unhexlify(r.recvline().strip())</span><br><span class="line">                t = decrypt(key_final,cipher,inv_S)</span><br><span class="line">                r.sendline(t)</span><br><span class="line">                temp = r.recvline()</span><br><span class="line">                <span class="built_in">print</span>(temp)</span><br><span class="line">                <span class="keyword">if</span>(<span class="string">b&quot;wrong&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> temp):</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                </span><br><span class="line">                r.close()</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">getflag()</span><br><span class="line"></span><br><span class="line"><span class="comment">#NSSCTF&#123;4f9d3982-be4b-4c4a-8ca0-db1a69b28b03&#125;</span></span><br></pre></td></tr></table></figure>
<p>å°±è¿™ä¸€é¢˜è€Œè¨€ï¼Œè¿˜æ˜¯æœ‰ä¸å°‘ä¸æ˜¯å¾ˆå¥½è®²æ¸…æ¥šçš„åœ°æ–¹ï¼Œå¯èƒ½æˆ‘çš„åšæ³•ä¹Ÿå¹¶ä¸ç®€æ´ã€‚å¦‚æœçœ‹äº†è¿™ç¯‡æ–‡ç« ä½ æœ‰ä»»ä½•æƒ³è¯´çš„ï¼Œéƒ½æ¬¢è¿ä¸æˆ‘äº¤æµï¼</p>
<p><br></p>
<p><br></p>
<h3 id="newAES"><a href="#newAES" class="headerlink" title="newAES"></a>newAES</h3><p>é¢˜ç›®æ¥æºï¼šç¾ŠåŸæ¯ 2023 å†³èµ›</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line">SboxOriginal = (</span><br><span class="line">    <span class="number">0x63</span>, <span class="number">0x7C</span>, <span class="number">0x77</span>, <span class="number">0x7B</span>, <span class="number">0xF2</span>, <span class="number">0x6B</span>, <span class="number">0x6F</span>, <span class="number">0xC5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2B</span>, <span class="number">0xFE</span>, <span class="number">0xD7</span>, <span class="number">0xAB</span>, <span class="number">0x76</span>,</span><br><span class="line">    <span class="number">0xCA</span>, <span class="number">0x82</span>, <span class="number">0xC9</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xF0</span>, <span class="number">0xAD</span>, <span class="number">0xD4</span>, <span class="number">0xA2</span>, <span class="number">0xAF</span>, <span class="number">0x9C</span>, <span class="number">0xA4</span>, <span class="number">0x72</span>, <span class="number">0xC0</span>,</span><br><span class="line">    <span class="number">0xB7</span>, <span class="number">0xFD</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3F</span>, <span class="number">0xF7</span>, <span class="number">0xCC</span>, <span class="number">0x34</span>, <span class="number">0xA5</span>, <span class="number">0xE5</span>, <span class="number">0xF1</span>, <span class="number">0x71</span>, <span class="number">0xD8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,</span><br><span class="line">    <span class="number">0x04</span>, <span class="number">0xC7</span>, <span class="number">0x23</span>, <span class="number">0xC3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9A</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>, <span class="number">0xEB</span>, <span class="number">0x27</span>, <span class="number">0xB2</span>, <span class="number">0x75</span>,</span><br><span class="line">    <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2C</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x6E</span>, <span class="number">0x5A</span>, <span class="number">0xA0</span>, <span class="number">0x52</span>, <span class="number">0x3B</span>, <span class="number">0xD6</span>, <span class="number">0xB3</span>, <span class="number">0x29</span>, <span class="number">0xE3</span>, <span class="number">0x2F</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x53</span>, <span class="number">0xD1</span>, <span class="number">0x00</span>, <span class="number">0xED</span>, <span class="number">0x20</span>, <span class="number">0xFC</span>, <span class="number">0xB1</span>, <span class="number">0x5B</span>, <span class="number">0x6A</span>, <span class="number">0xCB</span>, <span class="number">0xBE</span>, <span class="number">0x39</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0xCF</span>,</span><br><span class="line">    <span class="number">0xD0</span>, <span class="number">0xEF</span>, <span class="number">0xAA</span>, <span class="number">0xFB</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xF9</span>, <span class="number">0x02</span>, <span class="number">0x7F</span>, <span class="number">0x50</span>, <span class="number">0x3C</span>, <span class="number">0x9F</span>, <span class="number">0xA8</span>,</span><br><span class="line">    <span class="number">0x51</span>, <span class="number">0xA3</span>, <span class="number">0x40</span>, <span class="number">0x8F</span>, <span class="number">0x92</span>, <span class="number">0x9D</span>, <span class="number">0x38</span>, <span class="number">0xF5</span>, <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xDA</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xFF</span>, <span class="number">0xF3</span>, <span class="number">0xD2</span>,</span><br><span class="line">    <span class="number">0xCD</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xC4</span>, <span class="number">0xA7</span>, <span class="number">0x7E</span>, <span class="number">0x3D</span>, <span class="number">0x64</span>, <span class="number">0x5D</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,</span><br><span class="line">    <span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4F</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>, <span class="number">0x2A</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xEE</span>, <span class="number">0xB8</span>, <span class="number">0x14</span>, <span class="number">0xDE</span>, <span class="number">0x5E</span>, <span class="number">0x0B</span>, <span class="number">0xDB</span>,</span><br><span class="line">    <span class="number">0xE0</span>, <span class="number">0x32</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0xC2</span>, <span class="number">0xD3</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>,</span><br><span class="line">    <span class="number">0xE7</span>, <span class="number">0xC8</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>, <span class="number">0x8D</span>, <span class="number">0xD5</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xEA</span>, <span class="number">0x65</span>, <span class="number">0x7A</span>, <span class="number">0xAE</span>, <span class="number">0x08</span>,</span><br><span class="line">    <span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0xA6</span>, <span class="number">0xB4</span>, <span class="number">0xC6</span>, <span class="number">0xE8</span>, <span class="number">0xDD</span>, <span class="number">0x74</span>, <span class="number">0x1F</span>, <span class="number">0x4B</span>, <span class="number">0xBD</span>, <span class="number">0x8B</span>, <span class="number">0x8A</span>,</span><br><span class="line">    <span class="number">0x70</span>, <span class="number">0x3E</span>, <span class="number">0xB5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xB9</span>, <span class="number">0x86</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0x9E</span>,</span><br><span class="line">    <span class="number">0xE1</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xD9</span>, <span class="number">0x8E</span>, <span class="number">0x94</span>, <span class="number">0x9B</span>, <span class="number">0x1E</span>, <span class="number">0x87</span>, <span class="number">0xE9</span>, <span class="number">0xCE</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xDF</span>,</span><br><span class="line">    <span class="number">0x8C</span>, <span class="number">0xA1</span>, <span class="number">0x89</span>, <span class="number">0x0D</span>, <span class="number">0xBF</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2D</span>, <span class="number">0x0F</span>, <span class="number">0xB0</span>, <span class="number">0x54</span>, <span class="number">0xBB</span>, <span class="number">0x16</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">xtime = <span class="keyword">lambda</span> a: (((a &lt;&lt; <span class="number">1</span>) ^ <span class="number">0x1B</span>) &amp; <span class="number">0xFF</span>) <span class="keyword">if</span> (a &amp; <span class="number">0x80</span>) <span class="keyword">else</span> (a &lt;&lt; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Rcon = (</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x40</span>,</span><br><span class="line">    <span class="number">0x80</span>, <span class="number">0x1B</span>, <span class="number">0x36</span>, <span class="number">0x6C</span>, <span class="number">0xD8</span>, <span class="number">0xAB</span>, <span class="number">0x4D</span>, <span class="number">0x9A</span>,</span><br><span class="line">    <span class="number">0x2F</span>, <span class="number">0x5E</span>, <span class="number">0xBC</span>, <span class="number">0x63</span>, <span class="number">0xC6</span>, <span class="number">0x97</span>, <span class="number">0x35</span>, <span class="number">0x6A</span>,</span><br><span class="line">    <span class="number">0xD4</span>, <span class="number">0xB3</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0xEF</span>, <span class="number">0xC5</span>, <span class="number">0x91</span>, <span class="number">0x39</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">text2matrix</span>(<span class="params">text</span>):</span><br><span class="line">    text = <span class="built_in">int</span>(text.<span class="built_in">hex</span>(), <span class="number">16</span>)</span><br><span class="line">    matrix = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        byte = (text &gt;&gt; (<span class="number">8</span> * (<span class="number">15</span> - i))) &amp; <span class="number">0xFF</span></span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">4</span> == <span class="number">0</span>:</span><br><span class="line">            matrix.append([byte])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            matrix[i // <span class="number">4</span>].append(byte)</span><br><span class="line">    <span class="keyword">return</span> matrix</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix2text</span>(<span class="params">matrix</span>):</span><br><span class="line">    text = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            text |= (matrix[i][j] &lt;&lt; (<span class="number">120</span> - <span class="number">8</span> * (<span class="number">4</span> * i + j)))</span><br><span class="line">    <span class="keyword">return</span> text.to_bytes(<span class="number">16</span>, byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AES</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, master_key, Sbox=SboxOriginal</span>):</span><br><span class="line">        self.Sbox = Sbox</span><br><span class="line">        self.InvSbox = [<span class="number">0</span>]* <span class="number">256</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            self.InvSbox[self.Sbox[i]] = i</span><br><span class="line">        self.change_key(master_key)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">change_key</span>(<span class="params">self, master_key</span>):</span><br><span class="line">        self.round_keys = text2matrix(master_key)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>, <span class="number">4</span> * <span class="number">11</span>):</span><br><span class="line">            self.round_keys.append([])</span><br><span class="line">            <span class="keyword">if</span> i % <span class="number">4</span> == <span class="number">0</span>:</span><br><span class="line">                byte = self.round_keys[i - <span class="number">4</span>][<span class="number">0</span>]        \</span><br><span class="line">                     ^ self.Sbox[self.round_keys[i - <span class="number">1</span>][<span class="number">1</span>]]  \</span><br><span class="line">                     ^ Rcon[i // <span class="number">4</span>]</span><br><span class="line">                self.round_keys[i].append(byte)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">4</span>):</span><br><span class="line">                    byte = self.round_keys[i - <span class="number">4</span>][j]    \</span><br><span class="line">                         ^ self.Sbox[self.round_keys[i - <span class="number">1</span>][(j + <span class="number">1</span>) % <span class="number">4</span>]]</span><br><span class="line">                    self.round_keys[i].append(byte)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                    byte = self.round_keys[i - <span class="number">4</span>][j]    \</span><br><span class="line">                         ^ self.round_keys[i - <span class="number">1</span>][j]</span><br><span class="line">                    self.round_keys[i].append(byte)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, plaintext</span>):</span><br><span class="line">        self.plain_state = text2matrix(plaintext)</span><br><span class="line"></span><br><span class="line">        self.__add_round_key(self.plain_state, self.round_keys[:<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>):</span><br><span class="line">            self.__round_encrypt(self.plain_state, self.round_keys[<span class="number">4</span> * i : <span class="number">4</span> * (i + <span class="number">1</span>)])</span><br><span class="line"></span><br><span class="line">        self.__sub_bytes(self.plain_state)</span><br><span class="line">        self.__shift_rows(self.plain_state)</span><br><span class="line">        self.__add_round_key(self.plain_state, self.round_keys[<span class="number">40</span>:])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> matrix2text(self.plain_state)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, ciphertext</span>):</span><br><span class="line">        self.cipher_state = text2matrix(ciphertext)</span><br><span class="line"></span><br><span class="line">        self.__add_round_key(self.cipher_state, self.round_keys[<span class="number">40</span>:])</span><br><span class="line">        self.__inv_shift_rows(self.cipher_state)</span><br><span class="line">        self.__inv_sub_bytes(self.cipher_state)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">            self.__round_decrypt(self.cipher_state, self.round_keys[<span class="number">4</span> * i : <span class="number">4</span> * (i + <span class="number">1</span>)])</span><br><span class="line"></span><br><span class="line">        self.__add_round_key(self.cipher_state, self.round_keys[:<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> matrix2text(self.cipher_state)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__add_round_key</span>(<span class="params">self, s, k</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                s[i][j] ^= k[i][j]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__round_encrypt</span>(<span class="params">self, state_matrix, key_matrix</span>):</span><br><span class="line">        self.__sub_bytes(state_matrix)</span><br><span class="line">        self.__shift_rows(state_matrix)</span><br><span class="line">        self.__mix_columns(state_matrix)</span><br><span class="line">        self.__add_round_key(state_matrix, key_matrix)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__round_decrypt</span>(<span class="params">self, state_matrix, key_matrix</span>):</span><br><span class="line">        self.__add_round_key(state_matrix, key_matrix)</span><br><span class="line">        self.__inv_mix_columns(state_matrix)</span><br><span class="line">        self.__inv_shift_rows(state_matrix)</span><br><span class="line">        self.__inv_sub_bytes(state_matrix)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__sub_bytes</span>(<span class="params">self, s</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                s[i][j] = self.Sbox[s[i][j]]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__inv_sub_bytes</span>(<span class="params">self, s</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                s[i][j] = self.InvSbox[s[i][j]]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__shift_rows</span>(<span class="params">self, s</span>):</span><br><span class="line">        s[<span class="number">0</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>] = s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>], s[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">        s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>], s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>] = s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>], s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>]</span><br><span class="line">        s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>], s[<span class="number">3</span>][<span class="number">3</span>] = s[<span class="number">3</span>][<span class="number">3</span>], s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__inv_shift_rows</span>(<span class="params">self, s</span>):</span><br><span class="line">        s[<span class="number">0</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>] = s[<span class="number">3</span>][<span class="number">1</span>], s[<span class="number">0</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>]</span><br><span class="line">        s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>], s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>] = s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>], s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>]</span><br><span class="line">        s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>], s[<span class="number">3</span>][<span class="number">3</span>] = s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>], s[<span class="number">3</span>][<span class="number">3</span>], s[<span class="number">0</span>][<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__mix_single_column</span>(<span class="params">self, a</span>):</span><br><span class="line">        t = a[<span class="number">0</span>] ^ a[<span class="number">1</span>] ^ a[<span class="number">2</span>] ^ a[<span class="number">3</span>]</span><br><span class="line">        u = a[<span class="number">0</span>]</span><br><span class="line">        a[<span class="number">0</span>] ^= t ^ xtime(a[<span class="number">0</span>] ^ a[<span class="number">1</span>])</span><br><span class="line">        a[<span class="number">1</span>] ^= t ^ xtime(a[<span class="number">1</span>] ^ a[<span class="number">2</span>])</span><br><span class="line">        a[<span class="number">2</span>] ^= t ^ xtime(a[<span class="number">2</span>] ^ a[<span class="number">3</span>])</span><br><span class="line">        a[<span class="number">3</span>] ^= t ^ xtime(a[<span class="number">3</span>] ^ u)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__mix_columns</span>(<span class="params">self, s</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            self.__mix_single_column(s[i])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__inv_mix_columns</span>(<span class="params">self, s</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            u = xtime(xtime(s[i][<span class="number">0</span>] ^ s[i][<span class="number">2</span>]))</span><br><span class="line">            v = xtime(xtime(s[i][<span class="number">1</span>] ^ s[i][<span class="number">3</span>]))</span><br><span class="line">            s[i][<span class="number">0</span>] ^= u</span><br><span class="line">            s[i][<span class="number">1</span>] ^= v</span><br><span class="line">            s[i][<span class="number">2</span>] ^= u</span><br><span class="line">            s[i][<span class="number">3</span>] ^= v</span><br><span class="line"></span><br><span class="line">        self.__mix_columns(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mybox = [<span class="number">105</span>, <span class="number">121</span>, <span class="number">73</span>, <span class="number">89</span>, <span class="number">41</span>, <span class="number">57</span>, <span class="number">9</span>, <span class="number">25</span>, <span class="number">233</span>, <span class="number">249</span>, <span class="number">201</span>, <span class="number">217</span>, <span class="number">169</span>, <span class="number">185</span>, <span class="number">137</span>, <span class="number">153</span>, <span class="number">104</span>, <span class="number">120</span>, <span class="number">72</span>, <span class="number">88</span>, <span class="number">40</span>, <span class="number">56</span>, <span class="number">8</span>, <span class="number">24</span>, <span class="number">232</span>, <span class="number">248</span>, <span class="number">200</span>, <span class="number">216</span>, <span class="number">168</span>, <span class="number">184</span>, <span class="number">136</span>, <span class="number">152</span>, <span class="number">107</span>, <span class="number">123</span>, <span class="number">75</span>, <span class="number">91</span>, <span class="number">43</span>, <span class="number">59</span>, <span class="number">11</span>, <span class="number">27</span>, <span class="number">235</span>, <span class="number">251</span>, <span class="number">203</span>, <span class="number">219</span>, <span class="number">171</span>, <span class="number">187</span>, <span class="number">139</span>, <span class="number">155</span>, <span class="number">106</span>, <span class="number">122</span>, <span class="number">74</span>, <span class="number">90</span>, <span class="number">42</span>, <span class="number">58</span>, <span class="number">10</span>, <span class="number">26</span>, <span class="number">234</span>, <span class="number">250</span>, <span class="number">202</span>, <span class="number">218</span>, <span class="number">170</span>, <span class="number">186</span>, <span class="number">138</span>, <span class="number">154</span>, <span class="number">109</span>, <span class="number">125</span>, <span class="number">77</span>, <span class="number">93</span>, <span class="number">45</span>, <span class="number">61</span>, <span class="number">13</span>, <span class="number">29</span>, <span class="number">237</span>, <span class="number">253</span>, <span class="number">205</span>, <span class="number">221</span>, <span class="number">173</span>, <span class="number">189</span>, <span class="number">141</span>, <span class="number">157</span>, <span class="number">108</span>, <span class="number">124</span>, <span class="number">76</span>, <span class="number">92</span>, <span class="number">44</span>, <span class="number">60</span>, <span class="number">12</span>, <span class="number">28</span>, <span class="number">236</span>, <span class="number">252</span>, <span class="number">204</span>, <span class="number">220</span>, <span class="number">172</span>, <span class="number">188</span>, <span class="number">140</span>, <span class="number">156</span>, <span class="number">111</span>, <span class="number">127</span>, <span class="number">79</span>, <span class="number">95</span>, <span class="number">47</span>, <span class="number">63</span>, <span class="number">15</span>, <span class="number">31</span>, <span class="number">239</span>, <span class="number">255</span>, <span class="number">207</span>, <span class="number">223</span>, <span class="number">175</span>, <span class="number">191</span>, <span class="number">143</span>, <span class="number">159</span>, <span class="number">110</span>, <span class="number">126</span>, <span class="number">78</span>, <span class="number">94</span>, <span class="number">46</span>, <span class="number">62</span>, <span class="number">14</span>, <span class="number">30</span>, <span class="number">238</span>, <span class="number">254</span>, <span class="number">206</span>, <span class="number">222</span>, <span class="number">174</span>, <span class="number">190</span>, <span class="number">142</span>, <span class="number">158</span>, <span class="number">97</span>, <span class="number">113</span>, <span class="number">65</span>, <span class="number">81</span>, <span class="number">33</span>, <span class="number">49</span>, <span class="number">1</span>, <span class="number">17</span>, <span class="number">225</span>, <span class="number">241</span>, <span class="number">193</span>, <span class="number">209</span>, <span class="number">161</span>, <span class="number">177</span>, <span class="number">129</span>, <span class="number">145</span>, <span class="number">96</span>, <span class="number">112</span>, <span class="number">64</span>, <span class="number">80</span>, <span class="number">32</span>, <span class="number">48</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">224</span>, <span class="number">240</span>, <span class="number">192</span>, <span class="number">208</span>, <span class="number">160</span>, <span class="number">176</span>, <span class="number">128</span>, <span class="number">144</span>, <span class="number">99</span>, <span class="number">115</span>, <span class="number">67</span>, <span class="number">83</span>, <span class="number">35</span>, <span class="number">51</span>, <span class="number">3</span>, <span class="number">19</span>, <span class="number">227</span>, <span class="number">243</span>, <span class="number">195</span>, <span class="number">211</span>, <span class="number">163</span>, <span class="number">179</span>, <span class="number">131</span>, <span class="number">147</span>, <span class="number">98</span>, <span class="number">114</span>, <span class="number">66</span>, <span class="number">82</span>, <span class="number">34</span>, <span class="number">50</span>, <span class="number">2</span>, <span class="number">18</span>, <span class="number">226</span>, <span class="number">242</span>, <span class="number">194</span>, <span class="number">210</span>, <span class="number">162</span>, <span class="number">178</span>, <span class="number">130</span>, <span class="number">146</span>, <span class="number">101</span>, <span class="number">117</span>, <span class="number">69</span>, <span class="number">85</span>, <span class="number">37</span>, <span class="number">53</span>, <span class="number">5</span>, <span class="number">21</span>, <span class="number">229</span>, <span class="number">245</span>, <span class="number">197</span>, <span class="number">213</span>, <span class="number">165</span>, <span class="number">181</span>, <span class="number">133</span>, <span class="number">149</span>, <span class="number">100</span>, <span class="number">116</span>, <span class="number">68</span>, <span class="number">84</span>, <span class="number">36</span>, <span class="number">52</span>, <span class="number">4</span>, <span class="number">20</span>, <span class="number">228</span>, <span class="number">244</span>, <span class="number">196</span>, <span class="number">212</span>, <span class="number">164</span>, <span class="number">180</span>, <span class="number">132</span>, <span class="number">148</span>, <span class="number">103</span>, <span class="number">119</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">39</span>, <span class="number">55</span>, <span class="number">7</span>, <span class="number">23</span>, <span class="number">231</span>, <span class="number">247</span>, <span class="number">199</span>, <span class="number">215</span>, <span class="number">167</span>, <span class="number">183</span>, <span class="number">135</span>, <span class="number">151</span>, <span class="number">102</span>, <span class="number">118</span>, <span class="number">70</span>, <span class="number">86</span>, <span class="number">38</span>, <span class="number">54</span>, <span class="number">6</span>, <span class="number">22</span>, <span class="number">230</span>, <span class="number">246</span>, <span class="number">198</span>, <span class="number">214</span>, <span class="number">166</span>, <span class="number">182</span>, <span class="number">134</span>, <span class="number">150</span>]</span><br><span class="line">plaintext = <span class="string">b&quot;I will give you some hint: &quot;</span> + flag</span><br><span class="line">plaintext = pad(plaintext,<span class="number">16</span>,<span class="string">&quot;pkcs7&quot;</span>)</span><br><span class="line">ciphertext = <span class="string">b&quot;&quot;</span> </span><br><span class="line">key = os.urandom(<span class="number">16</span>)</span><br><span class="line">aes = AES(key, Sbox=mybox)</span><br><span class="line"><span class="keyword">while</span> <span class="built_in">len</span>(plaintext) &gt; <span class="number">0</span>:</span><br><span class="line">    ciphertext += aes.encrypt(plaintext[:<span class="number">16</span>])</span><br><span class="line">    plaintext = plaintext[<span class="number">16</span>:]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;ciphertext.<span class="built_in">hex</span>()&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = 26ec146dddda72b791585e5ecbc6a947bd6159d4de35df6c7717cd8eca1acd319f07803d8127f41b7ac7cdadc250ec8bb66f3661d772665a1622ffeba82996551463b738a997cd2c7081894fa9a5246c</span></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ä»£ç ä¸çŸ­ï¼Œä¸è¿‡å¤§éƒ¨åˆ†æ˜¯AESçš„å…·ä½“å®ç°ï¼Œæ‰€ä»¥ä¸ç”¨ç®¡ã€‚é¢˜ç›®çœŸæ­£æœ‰ç”¨çš„ä¿¡æ¯å…¶å®å°±ä¸¤ç‚¹ï¼š</p>
<ul>
<li>æ›´æ¢äº†ä¸€ä¸ªAESçš„Sç›’</li>
<li>ç»™äº†ä¸¤ç»„æ˜æ–‡ï¼Œä»¥åŠAESåŠ å¯†åçš„å¯¹åº”å¯†æ–‡</li>
</ul>
<p>ç¬¬ä¸€æ„Ÿè§‰åº”è¯¥æ˜¯AESçš„æŸä¸€éƒ¨åˆ†ä½œäº†å°æ”¹åŠ¨ï¼Œç„¶åå¯¼è‡´äº§ç”Ÿäº†æ¼æ´ã€‚ä½†æ˜¯æŠŠSç›’æ¢æˆæ™®é€šçš„Sç›’ä¹‹åï¼Œç”¨è‡ªå·±æ„é€ çš„keyï¼Œå°†æ˜æ–‡åˆ†åˆ«ç”¨è¿™ä¸ªAESå’Œcyberchefçš„AESè¿›è¡ŒåŠ å¯†ï¼Œç»“æœæ˜¯å®Œå…¨ä¸€æ ·çš„ï¼è¯´æ˜è¿™ä¸ªAESçœŸçš„å°±æ˜¯å®Œæ•´ã€æ™®é€šçš„AESåŠ å¯†ï¼Œæ²¡æœ‰æ”¹åŠ¨ä»»ä½•åœ°æ–¹ã€‚</p>
<p>ç„¶åå°±æ‡µäº†å¾ˆä¹…ï¼Œå› ä¸ºå¥½åƒæ²¡å¬è¯´è¿‡AESè¿˜èƒ½å·²çŸ¥æ˜æ–‡æ”»å‡»ã€‚ä½†æ˜¯é¢˜ç›®ç›®çš„å…¶å®å·²ç»å¾ˆæ¸…æ¥šäº†ï¼šæ ¹æ®è¿™ä¸ªæ›´æ¢çš„Sç›’ä»¥åŠä¸¤ç»„æ˜å¯†æ–‡å¯¹ï¼Œå¯¹AESè¿›è¡Œå·²çŸ¥æ˜æ–‡æ”»å‡»ã€‚</p>
<p>é‚£è‚¯å®šå°±æ˜¯è¿™ä¸ªSç›’è®¾è®¡çš„æœ‰é—®é¢˜ï¼ŒæŸ¥é˜…åå‘ç°é’ˆå¯¹Sç›’ç¡®å®æœ‰ä¸€ç§å·®åˆ†å¯†ç åˆ†ææ–¹å¼ï¼Œç„¶åå°±å­¦ä¹ äº†ä¸€æ³¢ï¼š</p>
<p><a href="https://blog.csdn.net/weixin_43734797/article/details/124055427">å¯†ç åˆ†æï¼ˆä¸€ï¼‰ï¼šå·®åˆ†å¯†ç åˆ†æ-CSDNåšå®¢</a></p>
<p>ç®€å•è¯´æ˜ä¸€ä¸‹æˆ‘çš„ç†è§£ï¼Œåœ¨è¿™é‡Œæˆ‘æŠŠå·®åˆ†åˆ†æçš„ç›¸å…³æ¦‚å¿µæ ¹æ®é¢˜ç›®å…·ä½“åŒ–ä¸€ä¸‹ï¼š</p>
<p><strong>å·®åˆ†ï¼š</strong>ä¸¤ç»„æ˜æ–‡çš„å¼‚æˆ–å€¼ï¼Œå°±æ˜¯æ˜æ–‡å·®åˆ†ï¼›åŒç†ï¼Œä¸¤ç»„å¯†æ–‡çš„å¼‚æˆ–å€¼ï¼Œå°±æ˜¯å¯†æ–‡å·®åˆ†ã€‚</p>
<p><strong>å·®åˆ†åˆ†æçš„ä¾æ®ï¼š</strong>ä¸å¯†é’¥å¼‚æˆ–ï¼Œä¸ä¼šæ”¹å˜å·®åˆ†</p>
<p>ä»€ä¹ˆå«ä¸ä¼šæ”¹å˜å·®åˆ†ï¼Ÿæˆ‘ä»¬æŠŠAESçš„è¡Œç§»ä½ã€åˆ—æ··æ·†éƒ½å…ˆä¸ç®¡ï¼Œå…ˆå•ç‹¬çœ‹ä¸€ä¸‹ç”¨åˆ°Sç›’çš„éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯å­—èŠ‚ä»£æ¢ä»¥åŠè¿›è¡Œä»£æ¢å‰çš„è½®å¯†é’¥åŠ ã€‚è¿™æ ·çš„è¯ï¼Œç®€å•ç”»ä¸ªè‰å›¾ï¼š</p>
<p><img src="/post/a5bd8c0d/image-20231010101627908.png" alt="image-20231010101627908"></p>
<p>é‚£ä¹ˆä¸ä¼šæ”¹å˜å·®åˆ†å°±ä½“ç°åœ¨ä¸‹é¢çš„å¼å­ä¸­ï¼šè‹¥æœ‰</p>
<script type="math/tex; mode=display">
m_1 \oplus m_2 = t</script><p>åˆ™ï¼š</p>
<script type="math/tex; mode=display">
m_1' \oplus m_2'  = (m_1\oplus roundkey) \oplus (m_2\oplus roundkey) = t</script><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œè½®å¯†é’¥å…¶å®æ˜¯å¯¹å·®åˆ†æ²¡æœ‰ä»»ä½•å½±å“çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆåˆ©ç”¨è¿™ä¸ªäº‹å®è¿›è¡Œæ”»å‡»å‘¢ï¼Ÿ</p>
<p>å†å›åˆ°åˆšæ‰åŠ å¯†çš„é‚£ä¸ªå›¾ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œm1â€™ç»Sç›’ä»£æ¢åå˜æˆc1ï¼Œm2â€™ç»Sç›’ä»£æ¢åå˜æˆc2ï¼Œé‚£ä¹ˆå‡è®¾c1,c2çš„å¯†æ–‡å·®åˆ†æ˜¯rï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ‹¥æœ‰äº†ä¸€ä¸ªSç›’çš„å·®åˆ†å¯¹ (t,r) ã€‚</p>
<p>è€ŒSç›’æ˜¯ä¸€ä¸ªå­—èŠ‚ä»£æ¢æ“ä½œï¼Œå› æ­¤è¾“å…¥ä¸€å…±å°±æœ‰ä¸€ä¸ªå­—èŠ‚ç§å¯èƒ½ï¼Œä¹Ÿå°±æ˜¯256ç§ï¼Œè€Œå¯¹åº”çš„ï¼Œæ‰€æœ‰å¯èƒ½çš„(m1,m2)æ˜æ–‡å¯¹ä¹Ÿå°±æœ‰256*256ç§ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ ¹æ®æ‰€æœ‰çš„(m1,m2)ï¼Œç”¨å·²çŸ¥çš„Sç›’æ±‚å‡ºæ‰€æœ‰çš„(c1,c2)ï¼Œä»è€Œæ±‚å‡ºæ‰€æœ‰æ˜æ–‡å·®åˆ†åŠå¯¹åº”çš„å¯†æ–‡å·®åˆ†ï¼Œç„¶åå»ºç«‹å‡ºä¸€å¼ Sç›’çš„å·®åˆ†è¡¨ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">t = [[<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        t[i^j][sbox[i]^sbox[j]] += <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>é‚£ä½ åº”è¯¥è¦æƒ³åˆ°ï¼Œè¿™ç§å·®åˆ†å¯¹äºä¸€ä¸ªè®¾è®¡è‰¯å¥½çš„Sç›’æ¥è¯´ï¼Œè¦æ˜¾å¾—å¾ˆéšæœºï¼Œå› ä¸ºSç›’çš„å­—èŠ‚ä»£æ¢æœ¬èº«æ˜¯ä¸€ä¸ªéçº¿æ€§æ“ä½œï¼Œå¦‚æœéšæœºæ€§ä¸å¤Ÿï¼Œé‚£ä¹ˆä¼šè®©è¿™ä¸ªSç›’æœ‰è¾ƒå¤§çš„æ¦‚ç‡æš´éœ²çº¿æ€§ç‰¹å¾ã€‚</p>
<p>è¿™ä¹ˆè¯´å¯èƒ½è¿˜æ˜¯æœ‰ç‚¹æŠ½è±¡ï¼Œç›´æ¥åˆ—å‡ºä¸¤ç§Sç›’çš„å·®åˆ†è¡¨å°±ç›´è§‚äº†ï¼Œç®€å•æ‰“å°ä¸€ä¸‹å‰å‡ è¡Œçœ‹çœ‹ï¼š</p>
<p>æ­£å¸¸Sç›’çš„å·®åˆ†è¡¨ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">[<span class="number">256</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>]</span><br><span class="line">[<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>]</span><br><span class="line">[<span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>]</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªé¢˜ç›®çš„Sç›’çš„å·®åˆ†è¡¨ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">[<span class="number">256</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">[<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">256</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">[<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">256</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">[<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">256</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<p>èƒ½æ„Ÿå—åˆ°åŒºåˆ«äº†å§ï¼Œè¿™ä¸ªé¢˜ç›®çš„Sç›’çš„å·®åˆ†è¡¨å®Œå…¨å°±æ²¡æœ‰ä»»ä½•éšæœºæ€§ï¼Œæ˜æ–‡å·®åˆ†ä¸å¯†æ–‡å·®åˆ†å®Œå…¨æ˜¯å›ºå®šçš„ï¼è€Œè¿™ä¸ªå›ºå®šçš„å·®åˆ†å°±ä¸ä¼šå—è½®å¯†é’¥åŠ çš„å½±å“ï¼Œå› æ­¤æˆ‘ä»¬å®Œå…¨ä¸éœ€è¦å¯†é’¥ï¼ŒæŠŠå¯¹åº”å¯†é’¥çš„æ“ä½œå‰”é™¤æ‰å³å¯ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åªéœ€è¦å°†å·²çŸ¥å¯†æ–‡ä¸æœªçŸ¥å¯†æ–‡æ±‚å·®åˆ†ï¼Œç„¶åå°†è¿™ä¸ªå·®åˆ†ç”¨AESè§£å¯†(å»é™¤è½®å¯†é’¥åŠ )ï¼Œæ±‚å‡ºåˆå§‹çš„æ˜æ–‡å·®åˆ†ï¼Œç„¶åå°†è¿™ä¸ªå·®åˆ†ä¸å·²çŸ¥æ˜æ–‡å†æ±‚å·®åˆ†ï¼Œå°±èƒ½å¾—åˆ°æœªçŸ¥çš„æ˜æ–‡äº†ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºæ˜¯å¯¹å·®åˆ†è¿›è¡ŒAESè§£å¯†ï¼Œæ‰€ä»¥ç”¨çš„å¹¶ä¸æ˜¯é¢˜ç›®ç»™çš„Sç›’ï¼Œè€Œæ˜¯ç”±Sç›’æ±‚å‡ºçš„å·®åˆ†Sç›’ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">a,b</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([i^j <span class="keyword">for</span> i,j <span class="keyword">in</span> <span class="built_in">zip</span>(a,b)])</span><br><span class="line"></span><br><span class="line">xtime = <span class="keyword">lambda</span> a: (((a &lt;&lt; <span class="number">1</span>) ^ <span class="number">0x1B</span>) &amp; <span class="number">0xFF</span>) <span class="keyword">if</span> (a &amp; <span class="number">0x80</span>) <span class="keyword">else</span> (a &lt;&lt; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">Rcon = (</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x40</span>,</span><br><span class="line">    <span class="number">0x80</span>, <span class="number">0x1B</span>, <span class="number">0x36</span>, <span class="number">0x6C</span>, <span class="number">0xD8</span>, <span class="number">0xAB</span>, <span class="number">0x4D</span>, <span class="number">0x9A</span>,</span><br><span class="line">    <span class="number">0x2F</span>, <span class="number">0x5E</span>, <span class="number">0xBC</span>, <span class="number">0x63</span>, <span class="number">0xC6</span>, <span class="number">0x97</span>, <span class="number">0x35</span>, <span class="number">0x6A</span>,</span><br><span class="line">    <span class="number">0xD4</span>, <span class="number">0xB3</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0xEF</span>, <span class="number">0xC5</span>, <span class="number">0x91</span>, <span class="number">0x39</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">text2matrix</span>(<span class="params">text</span>):</span><br><span class="line">    text = <span class="built_in">int</span>(text.<span class="built_in">hex</span>(), <span class="number">16</span>)</span><br><span class="line">    matrix = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        byte = (text &gt;&gt; (<span class="number">8</span> * (<span class="number">15</span> - i))) &amp; <span class="number">0xFF</span></span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">4</span> == <span class="number">0</span>:</span><br><span class="line">            matrix.append([byte])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            matrix[i // <span class="number">4</span>].append(byte)</span><br><span class="line">    <span class="keyword">return</span> matrix</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix2text</span>(<span class="params">matrix</span>):</span><br><span class="line">    text = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            text |= (matrix[i][j] &lt;&lt; (<span class="number">120</span> - <span class="number">8</span> * (<span class="number">4</span> * i + j)))</span><br><span class="line">    <span class="keyword">return</span> text.to_bytes(<span class="number">16</span>, byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AES</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, Sbox</span>):</span><br><span class="line">        self.Sbox = Sbox</span><br><span class="line">        self.InvSbox = [<span class="number">0</span>]* <span class="number">256</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            self.InvSbox[self.Sbox[i]] = i</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, ciphertext</span>):</span><br><span class="line">        self.cipher_state = text2matrix(ciphertext)</span><br><span class="line">        self.__inv_shift_rows(self.cipher_state)</span><br><span class="line">        self.__inv_sub_bytes(self.cipher_state)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">            self.__round_decrypt(self.cipher_state)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> matrix2text(self.cipher_state)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__round_decrypt</span>(<span class="params">self, state_matrix</span>):</span><br><span class="line">        self.__inv_mix_columns(state_matrix)</span><br><span class="line">        self.__inv_shift_rows(state_matrix)</span><br><span class="line">        self.__inv_sub_bytes(state_matrix)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__inv_sub_bytes</span>(<span class="params">self, s</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                s[i][j] = self.InvSbox[s[i][j]]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__inv_shift_rows</span>(<span class="params">self, s</span>):</span><br><span class="line">        s[<span class="number">0</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>] = s[<span class="number">3</span>][<span class="number">1</span>], s[<span class="number">0</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>]</span><br><span class="line">        s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>], s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>] = s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>], s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>]</span><br><span class="line">        s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>], s[<span class="number">3</span>][<span class="number">3</span>] = s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>], s[<span class="number">3</span>][<span class="number">3</span>], s[<span class="number">0</span>][<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__mix_single_column</span>(<span class="params">self, a</span>):</span><br><span class="line">        t = a[<span class="number">0</span>] ^ a[<span class="number">1</span>] ^ a[<span class="number">2</span>] ^ a[<span class="number">3</span>]</span><br><span class="line">        u = a[<span class="number">0</span>]</span><br><span class="line">        a[<span class="number">0</span>] ^= t ^ xtime(a[<span class="number">0</span>] ^ a[<span class="number">1</span>])</span><br><span class="line">        a[<span class="number">1</span>] ^= t ^ xtime(a[<span class="number">1</span>] ^ a[<span class="number">2</span>])</span><br><span class="line">        a[<span class="number">2</span>] ^= t ^ xtime(a[<span class="number">2</span>] ^ a[<span class="number">3</span>])</span><br><span class="line">        a[<span class="number">3</span>] ^= t ^ xtime(a[<span class="number">3</span>] ^ u)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__mix_columns</span>(<span class="params">self, s</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            self.__mix_single_column(s[i])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__inv_mix_columns</span>(<span class="params">self, s</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            u = xtime(xtime(s[i][<span class="number">0</span>] ^ s[i][<span class="number">2</span>]))</span><br><span class="line">            v = xtime(xtime(s[i][<span class="number">1</span>] ^ s[i][<span class="number">3</span>]))</span><br><span class="line">            s[i][<span class="number">0</span>] ^= u</span><br><span class="line">            s[i][<span class="number">1</span>] ^= v</span><br><span class="line">            s[i][<span class="number">2</span>] ^= u</span><br><span class="line">            s[i][<span class="number">3</span>] ^= v</span><br><span class="line"></span><br><span class="line">        self.__mix_columns(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_sbox_diff</span>(<span class="params">sbox</span>):          </span><br><span class="line">    t = [[<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            t[i^j][sbox[i]^sbox[j]] += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    sbox_diff = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            <span class="keyword">if</span> t[i][j] == <span class="number">256</span>:</span><br><span class="line">                sbox_diff[i] = j</span><br><span class="line">    <span class="keyword">return</span> sbox_diff</span><br><span class="line"></span><br><span class="line">sbox = [<span class="number">105</span>, <span class="number">121</span>, <span class="number">73</span>, <span class="number">89</span>, <span class="number">41</span>, <span class="number">57</span>, <span class="number">9</span>, <span class="number">25</span>, <span class="number">233</span>, <span class="number">249</span>, <span class="number">201</span>, <span class="number">217</span>, <span class="number">169</span>, <span class="number">185</span>, <span class="number">137</span>, <span class="number">153</span>, <span class="number">104</span>, <span class="number">120</span>, <span class="number">72</span>, <span class="number">88</span>, <span class="number">40</span>, <span class="number">56</span>, <span class="number">8</span>, <span class="number">24</span>, <span class="number">232</span>, <span class="number">248</span>, <span class="number">200</span>, <span class="number">216</span>, <span class="number">168</span>, <span class="number">184</span>, <span class="number">136</span>, <span class="number">152</span>, <span class="number">107</span>, <span class="number">123</span>, <span class="number">75</span>, <span class="number">91</span>, <span class="number">43</span>, <span class="number">59</span>, <span class="number">11</span>, <span class="number">27</span>, <span class="number">235</span>, <span class="number">251</span>, <span class="number">203</span>, <span class="number">219</span>, <span class="number">171</span>, <span class="number">187</span>, <span class="number">139</span>, <span class="number">155</span>, <span class="number">106</span>, <span class="number">122</span>, <span class="number">74</span>, <span class="number">90</span>, <span class="number">42</span>, <span class="number">58</span>, <span class="number">10</span>, <span class="number">26</span>, <span class="number">234</span>, <span class="number">250</span>, <span class="number">202</span>, <span class="number">218</span>, <span class="number">170</span>, <span class="number">186</span>, <span class="number">138</span>, <span class="number">154</span>, <span class="number">109</span>, <span class="number">125</span>, <span class="number">77</span>, <span class="number">93</span>, <span class="number">45</span>, <span class="number">61</span>, <span class="number">13</span>, <span class="number">29</span>, <span class="number">237</span>, <span class="number">253</span>, <span class="number">205</span>, <span class="number">221</span>, <span class="number">173</span>, <span class="number">189</span>, <span class="number">141</span>, <span class="number">157</span>, <span class="number">108</span>, <span class="number">124</span>, <span class="number">76</span>, <span class="number">92</span>, <span class="number">44</span>, <span class="number">60</span>, <span class="number">12</span>, <span class="number">28</span>, <span class="number">236</span>, <span class="number">252</span>, <span class="number">204</span>, <span class="number">220</span>, <span class="number">172</span>, <span class="number">188</span>, <span class="number">140</span>, <span class="number">156</span>, <span class="number">111</span>, <span class="number">127</span>, <span class="number">79</span>, <span class="number">95</span>, <span class="number">47</span>, <span class="number">63</span>, <span class="number">15</span>, <span class="number">31</span>, <span class="number">239</span>, <span class="number">255</span>, <span class="number">207</span>, <span class="number">223</span>, <span class="number">175</span>, <span class="number">191</span>, <span class="number">143</span>, <span class="number">159</span>, <span class="number">110</span>, <span class="number">126</span>, <span class="number">78</span>, <span class="number">94</span>, <span class="number">46</span>, <span class="number">62</span>, <span class="number">14</span>, <span class="number">30</span>, <span class="number">238</span>, <span class="number">254</span>, <span class="number">206</span>, <span class="number">222</span>, <span class="number">174</span>, <span class="number">190</span>, <span class="number">142</span>, <span class="number">158</span>, <span class="number">97</span>, <span class="number">113</span>, <span class="number">65</span>, <span class="number">81</span>, <span class="number">33</span>, <span class="number">49</span>, <span class="number">1</span>, <span class="number">17</span>, <span class="number">225</span>, <span class="number">241</span>, <span class="number">193</span>, <span class="number">209</span>, <span class="number">161</span>, <span class="number">177</span>, <span class="number">129</span>, <span class="number">145</span>, <span class="number">96</span>, <span class="number">112</span>, <span class="number">64</span>, <span class="number">80</span>, <span class="number">32</span>, <span class="number">48</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">224</span>, <span class="number">240</span>, <span class="number">192</span>, <span class="number">208</span>, <span class="number">160</span>, <span class="number">176</span>, <span class="number">128</span>, <span class="number">144</span>, <span class="number">99</span>, <span class="number">115</span>, <span class="number">67</span>, <span class="number">83</span>, <span class="number">35</span>, <span class="number">51</span>, <span class="number">3</span>, <span class="number">19</span>, <span class="number">227</span>, <span class="number">243</span>, <span class="number">195</span>, <span class="number">211</span>, <span class="number">163</span>, <span class="number">179</span>, <span class="number">131</span>, <span class="number">147</span>, <span class="number">98</span>, <span class="number">114</span>, <span class="number">66</span>, <span class="number">82</span>, <span class="number">34</span>, <span class="number">50</span>, <span class="number">2</span>, <span class="number">18</span>, <span class="number">226</span>, <span class="number">242</span>, <span class="number">194</span>, <span class="number">210</span>, <span class="number">162</span>, <span class="number">178</span>, <span class="number">130</span>, <span class="number">146</span>, <span class="number">101</span>, <span class="number">117</span>, <span class="number">69</span>, <span class="number">85</span>, <span class="number">37</span>, <span class="number">53</span>, <span class="number">5</span>, <span class="number">21</span>, <span class="number">229</span>, <span class="number">245</span>, <span class="number">197</span>, <span class="number">213</span>, <span class="number">165</span>, <span class="number">181</span>, <span class="number">133</span>, <span class="number">149</span>, <span class="number">100</span>, <span class="number">116</span>, <span class="number">68</span>, <span class="number">84</span>, <span class="number">36</span>, <span class="number">52</span>, <span class="number">4</span>, <span class="number">20</span>, <span class="number">228</span>, <span class="number">244</span>, <span class="number">196</span>, <span class="number">212</span>, <span class="number">164</span>, <span class="number">180</span>, <span class="number">132</span>, <span class="number">148</span>, <span class="number">103</span>, <span class="number">119</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">39</span>, <span class="number">55</span>, <span class="number">7</span>, <span class="number">23</span>, <span class="number">231</span>, <span class="number">247</span>, <span class="number">199</span>, <span class="number">215</span>, <span class="number">167</span>, <span class="number">183</span>, <span class="number">135</span>, <span class="number">151</span>, <span class="number">102</span>, <span class="number">118</span>, <span class="number">70</span>, <span class="number">86</span>, <span class="number">38</span>, <span class="number">54</span>, <span class="number">6</span>, <span class="number">22</span>, <span class="number">230</span>, <span class="number">246</span>, <span class="number">198</span>, <span class="number">214</span>, <span class="number">166</span>, <span class="number">182</span>, <span class="number">134</span>, <span class="number">150</span>]</span><br><span class="line">m = <span class="string">b&quot;I will give you some hint: DASCT&quot;</span></span><br><span class="line">ciphertext = <span class="string">b&quot;&quot;</span> </span><br><span class="line">aes = AES(Sbox=get_sbox_diff(sbox))</span><br><span class="line"></span><br><span class="line">c = <span class="string">&quot;26ec146dddda72b791585e5ecbc6a947bd6159d4de35df6c7717cd8eca1acd319f07803d8127f41b7ac7cdadc250ec8bb66f3661d772665a1622ffeba82996551463b738a997cd2c7081894fa9a5246c&quot;</span></span><br><span class="line">c1 = long_to_bytes(<span class="built_in">int</span>(c[:<span class="number">64</span>],<span class="number">16</span>))</span><br><span class="line">c2 = long_to_bytes(<span class="built_in">int</span>(c[<span class="number">64</span>:],<span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;DASCT&quot;</span>,end = <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c2)//<span class="number">16</span>):</span><br><span class="line">    diff1 = xor(c1[:<span class="number">16</span>],c2[<span class="number">16</span>*i:<span class="number">16</span>*i+<span class="number">16</span>])</span><br><span class="line">    temp1 = aes.decrypt(diff1)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(xor(temp1,m[:<span class="number">16</span>]))[<span class="number">2</span>:-<span class="number">1</span>],end = <span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#DASCTF&#123;de423c9aa5df7e683bd4b08bbca2a3409c018867&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="aes"><a href="#aes" class="headerlink" title="aes"></a>aes</h3><p>é¢˜ç›®æ¥æºï¼šEIS 2019</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> Counter</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">msg, key</span>):</span><br><span class="line">    ctr = Counter.new(<span class="number">128</span>,  initial_value=<span class="built_in">sum</span>(msg))</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CTR, counter=ctr)</span><br><span class="line">    <span class="keyword">return</span> cipher.encrypt(msg)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    signal.alarm(<span class="number">60</span>)</span><br><span class="line">    key = os.urandom(<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;/home/ctf/flag&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        flag = f.read()</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">30</span></span><br><span class="line">    enc_flag = enc(flag, key)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Welcome to the our AES encryption system!&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Here is your encrypted flag: <span class="subst">&#123;enc_flag&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            plaintext = <span class="built_in">input</span>(<span class="string">&quot;Please input your plaintext: &quot;</span>)</span><br><span class="line">            plaintext = <span class="built_in">bytes</span>.fromhex(plaintext)</span><br><span class="line">            ciphertext = enc(plaintext, key)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Here is your ciphertext: <span class="subst">&#123;ciphertext&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Error!&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Bye~&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>é¶æœºæä¾›äº†å¦‚ä¸‹æ“ä½œï¼š</p>
<ul>
<li>è¿æ¥ä¸Šé¶æœºåï¼Œå¼€å§‹è®¡æ—¶60s</li>
<li>éšæœºç”Ÿæˆåå…­å­—èŠ‚ä½œä¸ºAESå¯†é’¥</li>
<li>ä½¿ç”¨AES_CTRæ¨¡å¼å¯¹flagè¿›è¡ŒåŠ å¯†ï¼Œå…¶ä¸­Counterç”±flagçš„æ‰€æœ‰å­—èŠ‚å’Œç”Ÿæˆï¼Œå¹¶ç»™å‡ºflagçš„åŠ å¯†å€¼</li>
<li>å¯ä»¥ä¸æœåŠ¡å™¨è¿›è¡Œä¸‰åæ¬¡äº¤äº’ï¼Œæ¯ä¸€æ¬¡äº¤äº’ä¸­ï¼Œå¯ä»¥è¾“å…¥ä¸€æ®µæ˜æ–‡ï¼Œå¹¶è·å¾—å…¶AES_CTRæ¨¡å¼çš„åŠ å¯†å€¼ï¼Œå¯¹åº”Counterä»ç„¶ç”±è¾“å…¥æ˜æ–‡çš„å­—èŠ‚å’Œäº§ç”Ÿ</li>
</ul>
<p>é¦–å…ˆå°±æ³¨æ„åˆ°ç”¨äº†ä¸€ä¸ªå¹³æ—¶ä¸æ€ä¹ˆè§çš„AES_CTRæ¨¡å¼ï¼Œé‚£ä¹ˆé—®é¢˜è‚¯å®šä¹Ÿå‡ºåœ¨è¿™é‡Œï¼Œå…ˆäº†è§£ä¸€æ³¢CTRæ¨¡å¼æ˜¯ä»€ä¹ˆï¼š</p>
<p><a href="https://wumansgy.github.io/2018/11/03/AESçš„CTRæ¨¡å¼åŠ å¯†è§£å¯†è¯¦è§£/">AESçš„CTRæ¨¡å¼åŠ å¯†è§£å¯†è¯¦è§£ | Wumanâ€™s Blog (wumansgy.github.io)</a></p>
<p>å…¶æ ¸å¿ƒå¦‚ä¸‹ï¼š</p>
<p><img src="/post/a5bd8c0d/image-20231019210651725.png" alt="image-20231019210651725"></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œä»–çš„AESåŠ å¯†æ˜¯ä½œç”¨äºCounterè€Œéæ˜æ–‡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå…¶åŠ å¯†æµç¨‹æ˜¯å°†è¢«AESåŠ å¯†çš„Counterä¸æ˜æ–‡å¼‚æˆ–å¾—åˆ°å¯†æ–‡ã€‚</p>
<p>è€Œè¿™é“é¢˜æ˜¾ç„¶æä¾›äº†Counterçš„é¢å¤–ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯å…¶initial_valueæ˜¯ä¼ å…¥æ˜æ–‡çš„å­—èŠ‚å’Œã€‚è€Œflagå›ºå®šä¸º30ä¸ªå­—èŠ‚ï¼Œå› æ­¤å…¶å’Œåªæœ‰256*30ç§å¯èƒ½æ€§ï¼Œå®Œå…¨å¯ä»¥çˆ†ç ´ã€‚è€Œå½“æˆ‘ä»¬å–çš„æ˜æ–‡å€¼å­—èŠ‚å’Œæ­£å¥½ç­‰äºflagçš„å­—èŠ‚å’Œæ—¶ï¼Œå…¶AESåŠ å¯†çš„ç»“æœç›¸åŒï¼Œå› æ­¤æœ‰ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag = flag_enc ^ input ^ input_enc</span><br></pre></td></tr></table></figure>
<p>è‡³äºé™æ—¶60sä»¥åŠé™30æ¬¡ï¼Œå®Œå…¨ä¸é‡è¦ï¼Œå› ä¸ºå¯ä»¥åå¤è¿æ¥é¶æœºè€Œflagä¸ä¼šå˜ã€‚å½“ç„¶æ³¨æ„è¾“å…¥æ˜æ–‡é•¿åº¦åº”ä¸flagä¸€è‡´ï¼Œå‡ä¸º30ã€‚</p>
<p>ç„¶è€Œï¼Œåœ¨NSSä¸Šå¤ç°æœ¬é¢˜æ—¶ï¼Œçˆ†ç ´å®Œæ‰€æœ‰èŒƒå›´ä¾ç„¶æ²¡æœ‰ç»“æœï¼Œæ­¤æ—¶æ‰“å°å‡ºä¼ å›çš„flag_encï¼Œå‘ç°æ˜¯45å­—èŠ‚ï¼Œè¯´æ˜é¢˜ç›®æ”¹åŠ¨äº†flagä¸å®¹å™¨é•œåƒçš„é™„ä»¶ï¼Œä½†æ˜¯ä¸‹å‘çš„é™„ä»¶å¿˜è®°æ”¹äº†ï¼Œå› æ­¤éœ€è¦æ‰©å¤§èŒƒå›´è‡³256*45ã€‚å¹¶ä¸”ç”±äºæ”¹åŠ¨è¿‡flagï¼Œé‚£ä¹ˆflagå¤´åº”è¯¥è€ƒè™‘â€NSSCTFâ€ã€‚åŒæ—¶ï¼Œè€ƒè™‘åˆ°flagå‡ä¸ºå¯è§å­—ç¬¦ï¼Œå› æ­¤å¤ç°æ—¶è¿˜å¯ä»¥è¿›ä¸€æ­¥ç¼©å°ä¸€ç‚¹èŒƒå›´ã€‚</p>
<p>expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> count <span class="keyword">in</span> trange(<span class="number">256</span>//<span class="number">2</span>*<span class="number">3</span>):</span><br><span class="line">    r = remote(<span class="string">&quot;node4.anna.nssctf.cn&quot;</span>,<span class="number">28353</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;flag:&quot;</span>)</span><br><span class="line">    flag_enc = <span class="built_in">eval</span>(r.recvline().strip().decode())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">        r.recvuntil(<span class="string">b&quot;plaintext: &quot;</span>)</span><br><span class="line">        num = <span class="number">30</span> * count + i</span><br><span class="line">        input1 = <span class="string">b&quot;&quot;</span></span><br><span class="line">        <span class="keyword">while</span>(num &gt; <span class="number">255</span>):</span><br><span class="line">            num -= <span class="number">255</span></span><br><span class="line">            input1 += <span class="string">b&quot;\xff&quot;</span></span><br><span class="line">        input1 += long_to_bytes(num)</span><br><span class="line">        pad = (<span class="number">45</span>-<span class="built_in">len</span>(input1))*<span class="string">b&quot;\x00&quot;</span></span><br><span class="line">        input1 += pad           </span><br><span class="line">        r.sendline(input1.<span class="built_in">hex</span>())</span><br><span class="line">        r.recvuntil(<span class="string">b&quot;ciphertext:&quot;</span>)</span><br><span class="line">        input_c = <span class="built_in">eval</span>(r.recvline().strip().decode())</span><br><span class="line">        flag = long_to_bytes(bytes_to_long(input_c) ^ bytes_to_long(flag_enc) ^ bytes_to_long(input1))</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">b&quot;NSSCTF&quot;</span> <span class="keyword">in</span> flag):</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            exit()</span><br><span class="line">    r.close()</span><br><span class="line"></span><br><span class="line"><span class="comment">#NSSCTF&#123;b93abc9b-7972-4c46-b13f-5eed06787edc&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
]]></content>
      <categories>
        <category>cryptoè¶£é¢˜</category>
      </categories>
  </entry>
  <entry>
    <title>Cryptoè¶£é¢˜-å…¶ä»–</title>
    <url>/post/97bbcbc9.html</url>
    <content><![CDATA[<p>è¯¥æ–‡ç« ä¸»è¦è®°å½•ä¸€äº›ç‰¹æ®Šçš„è¶£é¢˜</p>
<span id="more"></span>
<h3 id="Shamiré—¨é™"><a href="#Shamiré—¨é™" class="headerlink" title="Shamiré—¨é™"></a>Shamiré—¨é™</h3><p>é¢˜ç›®æ¥æºï¼šæš‚ä¸æ˜ç¡®</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">å…¬å¸ä½¿ç”¨Shamiré—¨é™å¯†é’¥è®¾è®¡äº†ä¸€ä¸ªç§˜å¯†ä¿å­˜æ–¹æ¡ˆï¼Œå°†fagä¿å­˜äº†èµ·æ¥ï¼Œæœ€ç»ˆçš„è®¾è®¡æ•ˆæœå¦‚ä¸‹å¯†é’¥æ€»å…±æœ‰<span class="number">9</span>ä»½ï¼Œæ‹¿åˆ°ä»»æ„<span class="number">5</span>ä¸ªå¯†é’¥å³å¯è§£å‡ºä¿å­˜çš„flag.ç°åœ¨æˆ‘ä»¬çŸ¥é“å…¬å…±çš„å¯†é’¥:</span><br><span class="line">p=<span class="number">0x3b9f64aeadae9545d899102c8c1874e3d4f12caf6ded3eb8454c27fd7058ff31a5742aee60b2b7</span></span><br><span class="line">ä»¥åŠå¦‚ä¸‹<span class="number">5</span>ä¸ªå¯†é’¥:</span><br><span class="line"><span class="number">0x13570e530aaa3639e622d02ca8a0f89089ad0ee3ba51edd95490653b684aaeedd3a762938d08b3</span></span><br><span class="line"><span class="number">0xb583b75e84190f9d081234088b23e6b634110bda167a21bdfb4b5608a65e7283e8531547623d8</span></span><br><span class="line"><span class="number">0x8d3bbbb28592b1a00885c11633369568fcb8bbfdec3cbf4d8cd5546728ca99f24cbe0ac214a39</span></span><br><span class="line"><span class="number">0x13816f03e972210516c17b13a008ee8fd9b888839d6e1ce203fd7723f5e8e0443c2c6279c8dab9</span></span><br><span class="line"><span class="number">0x1553e323763e4c3ba53f6f93e0feb01d6b168fdda30fd87e949664eb4c8f2fd8414e2c14df8f5e</span></span><br><span class="line">è¯·æ¢å¤flag</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®æ˜ç¡®è¯´äº†è¿™æ˜¯ä¸€ä¸ªShamiré—¨é™æ–¹æ¡ˆï¼Œå…ˆæ¥ç®€å•æ¢³ç†ä¸€ä¸‹Shamiré—¨é™æ–¹æ¡ˆçš„åŸºæœ¬å®æ–½æ–¹å¼ï¼Œå¤§æ¦‚åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥:</p>
<p>1ã€<strong>æ ¹æ®æ¢å¤ç§˜å¯†æœ€å°äººæ•°åŠç§˜å¯†æ¶ˆæ¯ï¼Œç”Ÿæˆç§˜å¯†å¤šé¡¹å¼</strong></p>
<ul>
<li>å°†ç§˜å¯†æ¶ˆæ¯è½¬åŒ–ä¸ºæ•´æ•°ï¼Œè®°ä¸º secret</li>
<li>é¦–å…ˆï¼Œè®¾ç½®ä¸€ä¸ªéœ€æ¢å¤ç§˜å¯†çš„æœ€å°äººæ•° t ï¼Œè€Œé¢˜ç›®ä¸­è¯´â€æ‹¿åˆ°ä»»æ„5ä¸ªå¯†é’¥å³å¯è§£å‡ºä¿å­˜çš„flagâ€ï¼Œå› æ­¤t=5</li>
<li>è®¾ç½®ä¸€ä¸ªå…¬é’¥ p ï¼Œä½œä¸ºä¹‹åç”Ÿæˆçš„å¤šé¡¹å¼æ‰€å¤„çš„æœ‰é™åŸŸ</li>
<li>ç”Ÿæˆä¸€ä¸ª t-1 æ¬¡çš„å¤šé¡¹å¼ï¼Œæ»¡è¶³ï¼š</li>
</ul>
<script type="math/tex; mode=display">
f(x) = a_{t-1}*x^{t-1}+a_{t-2}*x^{t-2}+...+a_{2}*x^{2}+a_{1}*x^{1}+a_0 \quad(mod\;p)</script><script type="math/tex; mode=display">
å…¶ä¸­ï¼Œa_1ã€a_2ã€...ã€a_{t-2}ã€a_{t-1}ä¸ºéšæœºæ•°ï¼Œa0=secret</script><ul>
<li>å› æ­¤å¯ä»¥çœ‹å‡ºï¼Œå½“å¤šé¡¹å¼å– x=0 æ—¶ï¼Œå¯¹åº”çš„ f(x)=f(0)=a0=secretï¼Œå³ç§˜å¯†æ¶ˆæ¯</li>
</ul>
<p><br></p>
<p>2ã€<strong>æ ¹æ®ç§˜å¯†å¤šé¡¹å¼ï¼Œè¿›è¡Œå¯†é’¥åˆ†å‘</strong></p>
<ul>
<li>è®¾å®é™…å‚ä¸å¯†é’¥åˆ†å‘çš„äººæ•°ä¸º n ï¼Œåˆ™å°† 1~n(æœ‰æ—¶ä¹Ÿå¯èƒ½æ˜¯nä¸ªä¸åŒçš„éšæœºæ•°)ä¾æ¬¡ä»£å…¥ç§˜å¯†å¤šé¡¹å¼ f(x)ï¼Œä¾¿å¾—åˆ°nç»„å¯†é’¥ï¼š</li>
</ul>
<script type="math/tex; mode=display">
(1ï¼Œf(1))ã€(2,f(2))ã€...(n-1,f(n-1))ã€(n,f(n))</script><ul>
<li>å°†ç”Ÿæˆçš„ n ä¸ªå¯†é’¥åˆ†å‘ç»™ n ä¸ªäºº</li>
</ul>
<p><br></p>
<p>3ã€<strong>é”€æ¯ç§˜å¯†å¤šé¡¹å¼</strong></p>
<p><br></p>
<p>è‡³æ­¤ï¼ŒShamiré—¨é™æ–¹æ¡ˆä¾¿å®æ–½å®Œæˆäº†ï¼Œè¿™ç§åˆ†æ³•æ–¹æ¡ˆæ¶‰åŠåˆ°ä¸¤ä¸ªæ•°å­—ï¼Œä¸€ä¸ªæ˜¯éœ€æ¢å¤ç§˜å¯†çš„æœ€å°äººæ•° t ï¼Œä¸€ä¸ªæ˜¯å®é™…å‚ä¸å¯†é’¥åˆ†å‘çš„äººæ•° n ï¼Œå› æ­¤å¯ä»¥ç§°ä¸º (t,n) - é—¨é™æ–¹æ¡ˆã€‚</p>
<p>éœ€è¦æ³¨æ„åˆ°çš„æ˜¯ï¼Œåœ¨å®Œæˆå¯†é’¥åˆ†å‘ä¹‹åï¼Œç§˜å¯†å¤šé¡¹å¼ä¾¿éšä¹‹è¢«é”€æ¯äº†ã€‚é‚£ä¹ˆåœ¨æ‹¥æœ‰è¶³å¤Ÿæ•°é‡çš„å¯†é’¥(&gt;=t)çš„æƒ…å†µä¸‹ï¼Œæ€ä¹ˆæ¢å¤ç§˜å¯†ä¿¡æ¯ secretå‘¢ï¼Ÿè¿™å°±éœ€è¦ç”¨åˆ°æ‹‰æ ¼æœ—æ—¥æ’å€¼å…¬å¼ï¼Œæˆ‘ä»¬ä¸å¦¨å…ˆæŠŠå¯†é’¥è®°ä¸º:</p>
<script type="math/tex; mode=display">
(x_1ï¼Œf(x_1))ã€(x_2,f(x_2))ã€...(x_{n-1},f(x_{n-1}))ã€(x_n,f(x_n))</script><p>åˆ™æ’å€¼å¤šé¡¹å¼å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
f(x) = \sum_{i=1}^{t}[{f(x_i)}*\prod_{j=1,j\neq i}^{t}{\frac{x-x_j}{x_i-x_j}}]\quad(mod\;p)</script><p>ç›´è§‚ä¸€ç‚¹å¯ä»¥å±•å¼€å†™æˆä¸‹å¼ï¼š</p>
<script type="math/tex; mode=display">
f(x) = f(x_1)\frac{(x-x_2)(x-x_3)...(x-x_t)}{(x1-x_2)(x1-x_3)...(x1-x_t)} + f(x_2)\frac{(x-x_1)(x-x_3)...(x-x_t)}{(x2-x_1)(x2-x_3)...(x2-x_t)} + ... +
f(x_t)\frac{(x-x_1)(x-x_2)...(x-x_{t-1})}{(x_t-x_1)(x_t-x_2)...(x_t-x_{t-1})}
\quad(mod\;p)</script><p>è§‚å¯Ÿä¸€ä¸‹è¿™ä¸ªå¤šé¡¹å¼çš„æ€§è´¨ï¼š</p>
<ul>
<li>æ˜¯ä¸€ä¸ª t-1 æ¬¡å¤šé¡¹å¼</li>
<li>åˆ†å‘çš„å¯†é’¥å‡æ˜¯å¤šé¡¹å¼ä¸Šçš„ç‚¹ï¼š</li>
</ul>
<script type="math/tex; mode=display">
(x_1ï¼Œf(x_1))ã€(x_2,f(x_2))ã€...(x_{n-1},f(x_{n-1}))ã€(x_n,f(x_n))</script><ul>
<li>è¿™æ˜¯å› ä¸ºï¼Œä»£å…¥å…¶ä¸­ä»»æ„ä¸€ä¸ªå¯†é’¥çš„æ¨ªåæ ‡ï¼Œåˆ™åªæœ‰ä»£å…¥çš„é‚£ä¸€é¡¹ä¸ä¸º0ï¼Œè€Œå…¶ä»–å…¨ä¸º0ï¼Œæ‹¿ x1 ä¸¾ä¾‹ï¼š</li>
</ul>
<script type="math/tex; mode=display">
f(x_1) = f(x_1)\frac{(x_1-x_2)(x_1-x_3)...(x_1-x_t)}{(x1-x_2)(x1-x_3)...(x1-x_t)} + f(x_2)\frac{(x_1-x_1)(x_1-x_3)...(x_1-x_t)}{(x2-x_1)(x2-x_3)...(x2-x_t)} + ... +
f(x_t)\frac{(x_1-x_1)(x_1-x_2)...(x_1-x_{t-1})}{(x_t-x_1)(x_t-x_2)...(x_t-x_{t-1})}
\quad(mod\;p)</script><ul>
<li>å³ï¼š</li>
</ul>
<script type="math/tex; mode=display">
f(x_1) = f(x_1)*1 + f(x_2)*0 + ... +
f(x_t)*0
\quad(mod\;p)</script><script type="math/tex; mode=display">
æ‰€ä»¥æœ‰ f(x_1) = f(x_1)
\quad(mod\;p)</script><p>æ‰€ä»¥å½“æœ‰è¶³å¤Ÿå¤šçš„ç‚¹( t-1 æ¬¡å¤šé¡¹å¼éœ€è¦ t ä¸ªç‚¹)è¿›è¡Œæ’å€¼æ—¶ï¼Œå°±å¯ä»¥ä»£å…¥ 0 è¿›å…¥æ’å€¼å¤šé¡¹å¼ï¼Œè§£å‡ºçš„å¸¸æ•°é¡¹å³ä¸ºç§˜å¯†æ¶ˆæ¯ secret</p>
<p><br></p>
<p>å®Œå…¨äº†è§£äº†Shamiré—¨é™æ–¹æ¡ˆåå†æ¥çœ‹è¿™ä¸ªé¢˜ï¼Œå°±å¯ä»¥å‘ç°å¯†é’¥æ•°é‡æ˜¯å®Œå…¨è¶³å¤Ÿçš„ï¼Œä½†æ˜¯ä¸æ¸…æ¥š5ä¸ªäººå…·ä½“åˆ†åˆ°çš„æ˜¯9ä¸ªå¯†é’¥ä¸­çš„å“ªä¸€ä¸ªå¯†é’¥ï¼Œå› æ­¤è¿˜éœ€è¦å…¨æ’åˆ—çˆ†ç ´å¤„ç†ã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> permutations</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">0x3b9f64aeadae9545d899102c8c1874e3d4f12caf6ded3eb8454c27fd7058ff31a5742aee60b2b7</span></span><br><span class="line">c = [<span class="number">0x13570e530aaa3639e622d02ca8a0f89089ad0ee3ba51edd95490653b684aaeedd3a762938d08b3</span>,<span class="number">0xb583b75e84190f9d081234088b23e6b634110bda167a21bdfb4b5608a65e7283e8531547623d8</span>,<span class="number">0x8d3bbbb28592b1a00885c11633369568fcb8bbfdec3cbf4d8cd5546728ca99f24cbe0ac214a39</span>,<span class="number">0x13816f03e972210516c17b13a008ee8fd9b888839d6e1ce203fd7723f5e8e0443c2c6279c8dab9</span>,<span class="number">0x1553e323763e4c3ba53f6f93e0feb01d6b168fdda30fd87e949664eb4c8f2fd8414e2c14df8f5e</span>]</span><br><span class="line"></span><br><span class="line">m = ([<span class="number">0</span>, c[<span class="number">0</span>]],[<span class="number">0</span>, c[<span class="number">1</span>]],[<span class="number">0</span>, c[<span class="number">2</span>]],[<span class="number">0</span>, c[<span class="number">3</span>]],[<span class="number">0</span>, c[<span class="number">4</span>]])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> permutations(<span class="built_in">range</span>(<span class="number">9</span>),<span class="number">5</span>):</span><br><span class="line">        m[<span class="number">0</span>][<span class="number">0</span>] = i[<span class="number">0</span>]</span><br><span class="line">        m[<span class="number">1</span>][<span class="number">0</span>] = i[<span class="number">1</span>]</span><br><span class="line">        m[<span class="number">2</span>][<span class="number">0</span>] = i[<span class="number">2</span>]</span><br><span class="line">        m[<span class="number">3</span>][<span class="number">0</span>] = i[<span class="number">3</span>]</span><br><span class="line">        m[<span class="number">4</span>][<span class="number">0</span>] = i[<span class="number">4</span>]</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = (</span><br><span class="line">                m[<span class="number">0</span>][<span class="number">1</span>] * (<span class="number">0</span> - m[<span class="number">1</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">2</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">3</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">4</span>][<span class="number">0</span>]) * inverse((m[<span class="number">0</span>][<span class="number">0</span>] - m[<span class="number">1</span>][<span class="number">0</span>]) * (m[<span class="number">0</span>][<span class="number">0</span>] - m[<span class="number">2</span>][<span class="number">0</span>]) * (m[<span class="number">0</span>][<span class="number">0</span>] - m[<span class="number">3</span>][<span class="number">0</span>]) * (m[<span class="number">0</span>][<span class="number">0</span>] - m[<span class="number">4</span>][<span class="number">0</span>]), p) +</span><br><span class="line">                m[<span class="number">1</span>][<span class="number">1</span>] * (<span class="number">0</span> - m[<span class="number">0</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">2</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">3</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">4</span>][<span class="number">0</span>]) * inverse((m[<span class="number">1</span>][<span class="number">0</span>] - m[<span class="number">0</span>][<span class="number">0</span>]) * (m[<span class="number">1</span>][<span class="number">0</span>] - m[<span class="number">2</span>][<span class="number">0</span>]) * (m[<span class="number">1</span>][<span class="number">0</span>] - m[<span class="number">3</span>][<span class="number">0</span>]) * (m[<span class="number">1</span>][<span class="number">0</span>] - m[<span class="number">4</span>][<span class="number">0</span>]), p) +</span><br><span class="line">                m[<span class="number">2</span>][<span class="number">1</span>] * (<span class="number">0</span> - m[<span class="number">1</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">0</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">3</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">4</span>][<span class="number">0</span>]) * inverse((m[<span class="number">2</span>][<span class="number">0</span>] - m[<span class="number">1</span>][<span class="number">0</span>]) * (m[<span class="number">2</span>][<span class="number">0</span>] - m[<span class="number">0</span>][<span class="number">0</span>]) * (m[<span class="number">2</span>][<span class="number">0</span>] - m[<span class="number">3</span>][<span class="number">0</span>]) * (m[<span class="number">2</span>][<span class="number">0</span>] - m[<span class="number">4</span>][<span class="number">0</span>]), p) +</span><br><span class="line">                m[<span class="number">3</span>][<span class="number">1</span>] * (<span class="number">0</span> - m[<span class="number">1</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">2</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">0</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">4</span>][<span class="number">0</span>]) * inverse((m[<span class="number">3</span>][<span class="number">0</span>] - m[<span class="number">1</span>][<span class="number">0</span>]) * (m[<span class="number">3</span>][<span class="number">0</span>] - m[<span class="number">2</span>][<span class="number">0</span>]) * (m[<span class="number">3</span>][<span class="number">0</span>] - m[<span class="number">0</span>][<span class="number">0</span>]) * (m[<span class="number">3</span>][<span class="number">0</span>] - m[<span class="number">4</span>][<span class="number">0</span>]), p) +</span><br><span class="line">                m[<span class="number">4</span>][<span class="number">1</span>] * (<span class="number">0</span> - m[<span class="number">1</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">2</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">3</span>][<span class="number">0</span>]) * (<span class="number">0</span> - m[<span class="number">0</span>][<span class="number">0</span>]) * inverse((m[<span class="number">4</span>][<span class="number">0</span>] - m[<span class="number">1</span>][<span class="number">0</span>]) * (m[<span class="number">4</span>][<span class="number">0</span>] - m[<span class="number">2</span>][<span class="number">0</span>]) * (m[<span class="number">4</span>][<span class="number">0</span>] - m[<span class="number">3</span>][<span class="number">0</span>]) * (m[<span class="number">4</span>][<span class="number">0</span>] - m[<span class="number">0</span>][<span class="number">0</span>]), p)</span><br><span class="line">                ) % p</span><br><span class="line">            temp = <span class="built_in">str</span>(long_to_bytes(r))</span><br><span class="line">            <span class="keyword">if</span>(<span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> temp):</span><br><span class="line">                <span class="built_in">print</span>(temp)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line"><span class="comment">#flag&#123;b14f4963671a457cf22ec271356e0f78&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p><br></p>
<h3 id="sqrt"><a href="#sqrt" class="headerlink" title="sqrt"></a>sqrt</h3><p>é¢˜ç›®æ¥æºï¼šbricsctf-2023-Quals</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">P = Permutations(<span class="number">256</span>).random_element()</span><br><span class="line"><span class="built_in">print</span>(P**<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>([x^y <span class="keyword">for</span> x,y <span class="keyword">in</span> <span class="built_in">zip</span>(hashlib.sha512(<span class="built_in">str</span>(P).encode()).digest(), <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read())])</span><br></pre></td></tr></table></figure>
<p>å¯†æ–‡txtï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[41, 124, 256, 27, 201, 93, 40, 133, 47, 10, 69, 253, 13, 245, 165, 166, 118, 230, 197, 249, 115, 18, 71, 24, 100, 14, 160, 28, 251, 96, 106, 5, 244, 58, 67, 44, 150, 42, 255, 74, 168, 182, 153, 209, 227, 232, 159, 128, 125, 11, 135, 90, 76, 30, 84, 31, 1, 149, 48, 95, 216, 94, 157, 131, 196, 172, 105, 169, 202, 203, 121, 210, 53, 9, 147, 89, 39, 68, 59, 141, 87, 207, 51, 180, 19, 81, 57, 103, 228, 77, 12, 129, 185, 85, 45, 123, 50, 116, 65, 213, 104, 64, 54, 155, 222, 112, 3, 252, 21, 33, 138, 151, 211, 233, 204, 97, 239, 113, 82, 200, 23, 231, 177, 26, 72, 4, 78, 183, 199, 6, 49, 29, 250, 119, 32, 56, 110, 187, 35, 143, 83, 25, 70, 2, 66, 101, 217, 120, 224, 142, 191, 136, 189, 127, 132, 36, 174, 146, 152, 140, 193, 62, 178, 17, 148, 248, 167, 88, 73, 229, 134, 156, 158, 60, 63, 242, 221, 34, 214, 20, 171, 139, 226, 186, 164, 181, 236, 107, 111, 61, 99, 108, 179, 223, 137, 212, 237, 102, 161, 145, 184, 173, 247, 162, 205, 154, 55, 117, 254, 38, 75, 234, 7, 46, 109, 22, 175, 144, 219, 220, 195, 190, 98, 79, 15, 170, 80, 235, 52, 8, 37, 243, 198, 86, 43, 192, 241, 240, 208, 130, 188, 114, 218, 215, 206, 176, 238, 16, 246, 126, 122, 163, 225, 92, 91, 194]</span><br><span class="line">[18, 188, 48, 47, 100, 234, 225, 8, 187, 34, 124, 113, 118, 252, 137, 196, 125, 20, 251, 168, 167, 5, 225, 134, 66, 203, 26, 148, 63, 181, 213, 124, 170, 234, 35, 120, 47, 69, 157, 69, 194]</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®éå¸¸ç®€çŸ­ï¼Œæµç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>å°†256ä¸ªå…ƒç´ è¿›è¡Œå…¨æ’åˆ—ï¼Œå¹¶éšæœºæŠ½å–å…¶ä¸­ä¸€ä¸ªæ’åˆ—ï¼Œè®°ä¸º P</li>
<li>æ‰“å°å‡ºè¯¥æ’åˆ—çš„å¹³æ–¹</li>
<li>å°†è¯¥æ’åˆ— P çš„ sha512 å€¼ä¸flagæ˜æ–‡ç›¸å¼‚æˆ–ï¼Œæ‰“å°å‡ºå¯†æ–‡</li>
</ul>
<p>å› æ­¤ï¼Œä»»åŠ¡å°±åªæœ‰ä¸€ä¸ªï¼šæ ¹æ®æ’åˆ—çš„å¹³æ–¹ï¼Œè¿˜åŸå‡ºè¯¥æ’åˆ—ï¼Œå¹¶ä¸å¯†æ–‡å¼‚æˆ–å°±èƒ½è¿˜åŸflag</p>
<p>æœ‰ä¸€ä¸ªæ¦‚å¿µä¸€å®šè¦å…ˆç†è§£æ¸…æ¥šï¼Œæ’åˆ—çš„å¹³æ–¹æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿç”¨ä»£ç å¯ä»¥å¦‚ä¸‹è¡¨ç¤ºï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">C[i] = P[P[i]]</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ç»„æ’åˆ—å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªç½®æ¢ï¼Œé‚£ä¹ˆæ’åˆ—çš„å¹³æ–¹å°±æ˜¯è¿›è¡ŒäºŒé‡ç½®æ¢ã€‚</p>
<p>é‚£ä¹ˆæ€ä¹ˆè¿˜åŸå‘¢ï¼Œæˆ‘ä»¬ç”¨å›¾çš„æ–¹å¼æ¥ç†è§£ï¼Œå›¾ä¸Šä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘å¦ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä»£è¡¨çš„å°±æ˜¯ç»è¿‡ä¸€æ¬¡ç½®æ¢åï¼Œè¯¥èŠ‚ç‚¹ç½®æ¢åˆ°æŒ‡å‘èŠ‚ç‚¹çš„ä½ç½®ï¼Œæ¯”å¦‚ä¸‹é¢è¿™å¼ å›¾å°±å¯ä»¥è¡¨ç¤ºä¸€ä¸ªç½®æ¢ï¼š</p>
<p><strong>(å¶æ•°ä¸ªç‚¹çš„æƒ…å†µ)</strong></p>
<p><img src="/post/97bbcbc9/image-20230926104953693.png" alt="image-20230926104953693"></p>
<p>è¿™å¼ å›¾ä»£è¡¨ï¼š0ç½®æ¢åˆ°1ã€1ç½®æ¢åˆ°2ã€â€¦5ç½®æ¢åˆ°0ï¼Œè¿™å¾ˆå¥½ç†è§£</p>
<p>é‚£ä¹ˆè¿™ä¸ªç½®æ¢å¹³æ–¹åä¼šæ˜¯ä»€ä¹ˆæ ·å­ï¼Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦æŠŠä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘èŠ‚ç‚¹æ‰€æŒ‡å‘çš„èŠ‚ç‚¹ä½œä¸ºæ–°çš„ç½®æ¢å³å¯ï¼Œè¯´èµ·æ¥æœ‰ç‚¹ç»•ï¼Œè¿˜æ˜¯ä¸¾ä¸ªä¾‹å­ï¼š0æŒ‡å‘1ï¼Œ1æŒ‡å‘2ï¼Œæ‰€ä»¥å¹³æ–¹åï¼Œ0æŒ‡å‘2ï¼Œè¿™å°±å¾ˆå®¹æ˜“æ˜ç™½äº†ã€‚</p>
<p>æ‰€ä»¥ä¸Šé¢çš„ç½®æ¢å¹³æ–¹åä¼šå˜æˆå¦‚ä¸‹å½¢å¼ï¼š</p>
<p><img src="/post/97bbcbc9/image-20230926105347447.png" alt="image-20230926105347447"></p>
<p>é‚£ä¹ˆè¿˜åŸçš„æ–¹å¼å°±æ˜¯å°†ä¸¤ä¸ªç¯å¹¶æ’ï¼Œç„¶åæŒ¨ä¸ªæ’å…¥ï¼Œå¦‚ä¸‹ï¼š</p>
<p><img src="/post/97bbcbc9/image-20230926105546460.png" alt="image-20230926105546460"></p>
<p>ä½†æ˜¯æ˜¾ç„¶ï¼Œç”±äºæ’å…¥çš„ç›¸å¯¹ä½ç½®ä¸åŒï¼Œè¿™æ ·è¿˜åŸå°±å¯èƒ½ä¼šå¾—åˆ°å¤šä¸ªä¸åŒçš„åˆå§‹ç½®æ¢ï¼Œè€Œä»–ä»¬å¹³æ–¹åéƒ½æ˜¯æ»¡è¶³è¦æ±‚çš„ã€‚</p>
<p>ä¸Šé¢çš„ä¾‹å­æ˜¯å¶æ•°ä¸ªç‚¹çš„æƒ…å†µï¼Œæƒ³ä¸€æƒ³å¥‡æ•°ä¸ªç‚¹å¹³æ–¹åä¼šå¦‚ä½•ï¼š</p>
<p><strong>(å¥‡æ•°ä¸ªç‚¹çš„æƒ…å†µ)</strong></p>
<p><img src="/post/97bbcbc9/image-20230926105945860.png" alt="image-20230926105945860"></p>
<p>ç»§ç»­åˆ©ç”¨<strong>æŠŠä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘èŠ‚ç‚¹æ‰€æŒ‡å‘çš„èŠ‚ç‚¹ä½œä¸ºæ–°çš„ç½®æ¢</strong>è¿™ä¸€ç‚¹ï¼Œå¯ä»¥çœ‹å‡ºå¹³æ–¹åï¼Œç¯å¹¶æ²¡æœ‰è£‚å¼€ï¼Œåªæ˜¯äº¤æ¢äº†ä½ç½®ï¼š</p>
<p><img src="/post/97bbcbc9/image-20230926110200084.png" alt="image-20230926110200084"></p>
<p>ä»”ç»†æƒ³æƒ³å°±èƒ½æ˜ç™½ï¼Œè¿™ç§å½¢å¼çš„è¿˜åŸæ˜¯å”¯ä¸€çš„ï¼Œä¸ä¼šæœ‰å¤šç§æƒ…å†µã€‚</p>
<p>æƒ³æ¸…æ¥šç½®æ¢ä¸å›¾çš„å…³ç³»åï¼Œå›åˆ°é¢˜ç›®æœ¬èº«æ¥ï¼ŒæŒ‰å¦‚ä¸‹æ­¥éª¤åˆ†æï¼š</p>
<p>1ã€<strong>é¦–å…ˆå°±è¦æŠŠå¹³æ–¹åçš„æ’åˆ—å…ˆè½¬åŒ–ä¸ºè‹¥å¹²ä¸ªç¯ï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ‰“å°ç¯</span></span><br><span class="line">n = [<span class="number">18</span>, <span class="number">188</span>, <span class="number">48</span>, <span class="number">47</span>, <span class="number">100</span>, <span class="number">234</span>, <span class="number">225</span>, <span class="number">8</span>, <span class="number">187</span>, <span class="number">34</span>, <span class="number">124</span>, <span class="number">113</span>, <span class="number">118</span>, <span class="number">252</span>, <span class="number">137</span>, <span class="number">196</span>, <span class="number">125</span>, <span class="number">20</span>, <span class="number">251</span>, <span class="number">168</span>, <span class="number">167</span>, <span class="number">5</span>, <span class="number">225</span>, <span class="number">134</span>, <span class="number">66</span>, <span class="number">203</span>, <span class="number">26</span>, <span class="number">148</span>, <span class="number">63</span>, <span class="number">181</span>, <span class="number">213</span>, <span class="number">124</span>, <span class="number">170</span>, <span class="number">234</span>, <span class="number">35</span>, <span class="number">120</span>, <span class="number">47</span>, <span class="number">69</span>, <span class="number">157</span>, <span class="number">69</span>, <span class="number">194</span>]</span><br><span class="line"></span><br><span class="line">P2 = [<span class="number">41</span>, <span class="number">124</span>, <span class="number">256</span>, <span class="number">27</span>, <span class="number">201</span>, <span class="number">93</span>, <span class="number">40</span>, <span class="number">133</span>, <span class="number">47</span>, <span class="number">10</span>, <span class="number">69</span>, <span class="number">253</span>, <span class="number">13</span>, <span class="number">245</span>, <span class="number">165</span>, <span class="number">166</span>, <span class="number">118</span>, <span class="number">230</span>, <span class="number">197</span>, <span class="number">249</span>, <span class="number">115</span>, <span class="number">18</span>, <span class="number">71</span>, <span class="number">24</span>, <span class="number">100</span>, <span class="number">14</span>, <span class="number">160</span>, <span class="number">28</span>, <span class="number">251</span>, <span class="number">96</span>, <span class="number">106</span>, <span class="number">5</span>, <span class="number">244</span>, <span class="number">58</span>, <span class="number">67</span>, <span class="number">44</span>, <span class="number">150</span>, <span class="number">42</span>, <span class="number">255</span>, <span class="number">74</span>, <span class="number">168</span>, <span class="number">182</span>, <span class="number">153</span>, <span class="number">209</span>, <span class="number">227</span>, <span class="number">232</span>, <span class="number">159</span>, <span class="number">128</span>, <span class="number">125</span>, <span class="number">11</span>, <span class="number">135</span>, <span class="number">90</span>, <span class="number">76</span>, <span class="number">30</span>, <span class="number">84</span>, <span class="number">31</span>, <span class="number">1</span>, <span class="number">149</span>, <span class="number">48</span>, <span class="number">95</span>, <span class="number">216</span>, <span class="number">94</span>, <span class="number">157</span>, <span class="number">131</span>, <span class="number">196</span>, <span class="number">172</span>, <span class="number">105</span>, <span class="number">169</span>, <span class="number">202</span>, <span class="number">203</span>, <span class="number">121</span>, <span class="number">210</span>, <span class="number">53</span>, <span class="number">9</span>, <span class="number">147</span>, <span class="number">89</span>, <span class="number">39</span>, <span class="number">68</span>, <span class="number">59</span>, <span class="number">141</span>, <span class="number">87</span>, <span class="number">207</span>, <span class="number">51</span>, <span class="number">180</span>, <span class="number">19</span>, <span class="number">81</span>, <span class="number">57</span>, <span class="number">103</span>, <span class="number">228</span>, <span class="number">77</span>, <span class="number">12</span>, <span class="number">129</span>, <span class="number">185</span>, <span class="number">85</span>, <span class="number">45</span>, <span class="number">123</span>, <span class="number">50</span>, <span class="number">116</span>, <span class="number">65</span>, <span class="number">213</span>, <span class="number">104</span>, <span class="number">64</span>, <span class="number">54</span>, <span class="number">155</span>, <span class="number">222</span>, <span class="number">112</span>, <span class="number">3</span>, <span class="number">252</span>, <span class="number">21</span>, <span class="number">33</span>, <span class="number">138</span>, <span class="number">151</span>, <span class="number">211</span>, <span class="number">233</span>, <span class="number">204</span>, <span class="number">97</span>, <span class="number">239</span>, <span class="number">113</span>, <span class="number">82</span>, <span class="number">200</span>, <span class="number">23</span>, <span class="number">231</span>, <span class="number">177</span>, <span class="number">26</span>, <span class="number">72</span>, <span class="number">4</span>, <span class="number">78</span>, <span class="number">183</span>, <span class="number">199</span>, <span class="number">6</span>, <span class="number">49</span>, <span class="number">29</span>, <span class="number">250</span>, <span class="number">119</span>, <span class="number">32</span>, <span class="number">56</span>, <span class="number">110</span>, <span class="number">187</span>, <span class="number">35</span>, <span class="number">143</span>, <span class="number">83</span>, <span class="number">25</span>, <span class="number">70</span>, <span class="number">2</span>, <span class="number">66</span>, <span class="number">101</span>, <span class="number">217</span>, <span class="number">120</span>, <span class="number">224</span>, <span class="number">142</span>, <span class="number">191</span>, <span class="number">136</span>, <span class="number">189</span>, <span class="number">127</span>, <span class="number">132</span>, <span class="number">36</span>, <span class="number">174</span>, <span class="number">146</span>, <span class="number">152</span>, <span class="number">140</span>, <span class="number">193</span>, <span class="number">62</span>, <span class="number">178</span>, <span class="number">17</span>, <span class="number">148</span>, <span class="number">248</span>, <span class="number">167</span>, <span class="number">88</span>, <span class="number">73</span>, <span class="number">229</span>, <span class="number">134</span>, <span class="number">156</span>, <span class="number">158</span>, <span class="number">60</span>, <span class="number">63</span>, <span class="number">242</span>, <span class="number">221</span>, <span class="number">34</span>, <span class="number">214</span>, <span class="number">20</span>, <span class="number">171</span>, <span class="number">139</span>, <span class="number">226</span>, <span class="number">186</span>, <span class="number">164</span>, <span class="number">181</span>, <span class="number">236</span>, <span class="number">107</span>, <span class="number">111</span>, <span class="number">61</span>, <span class="number">99</span>, <span class="number">108</span>, <span class="number">179</span>, <span class="number">223</span>, <span class="number">137</span>, <span class="number">212</span>, <span class="number">237</span>, <span class="number">102</span>, <span class="number">161</span>, <span class="number">145</span>, <span class="number">184</span>, <span class="number">173</span>, <span class="number">247</span>, <span class="number">162</span>, <span class="number">205</span>, <span class="number">154</span>, <span class="number">55</span>, <span class="number">117</span>, <span class="number">254</span>, <span class="number">38</span>, <span class="number">75</span>, <span class="number">234</span>, <span class="number">7</span>, <span class="number">46</span>, <span class="number">109</span>, <span class="number">22</span>, <span class="number">175</span>, <span class="number">144</span>, <span class="number">219</span>, <span class="number">220</span>, <span class="number">195</span>, <span class="number">190</span>, <span class="number">98</span>, <span class="number">79</span>, <span class="number">15</span>, <span class="number">170</span>, <span class="number">80</span>, <span class="number">235</span>, <span class="number">52</span>, <span class="number">8</span>, <span class="number">37</span>, <span class="number">243</span>, <span class="number">198</span>, <span class="number">86</span>, <span class="number">43</span>, <span class="number">192</span>, <span class="number">241</span>, <span class="number">240</span>, <span class="number">208</span>, <span class="number">130</span>, <span class="number">188</span>, <span class="number">114</span>, <span class="number">218</span>, <span class="number">215</span>, <span class="number">206</span>, <span class="number">176</span>, <span class="number">238</span>, <span class="number">16</span>, <span class="number">246</span>, <span class="number">126</span>, <span class="number">122</span>, <span class="number">163</span>, <span class="number">225</span>, <span class="number">92</span>, <span class="number">91</span>, <span class="number">194</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(P2)):</span><br><span class="line">    P2[i] -= <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(P2[<span class="number">204</span>])</span><br><span class="line">lenlist = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(P2)):</span><br><span class="line">    <span class="built_in">len</span> = <span class="number">1</span></span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    loc = P2[i]</span><br><span class="line">    chain = [loc]</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">        t = P2[loc]</span><br><span class="line">        loc = t</span><br><span class="line">        chain.append(loc)</span><br><span class="line">        <span class="built_in">len</span> += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(t == i):</span><br><span class="line">            <span class="comment">#print(i,&quot;,&quot;,len)</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">len</span> == <span class="number">2</span>):</span><br><span class="line">                <span class="built_in">print</span>(chain)</span><br><span class="line">                <span class="built_in">print</span>(i+<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="comment">#print(lenlist.count(2))</span></span><br><span class="line"><span class="comment">#2*82 + 75 + 3*3 + 1*8</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å‘ç°ï¼Œå¹³æ–¹åçš„ç½®æ¢å¯ä»¥æ‹†åˆ†ä¸º ï¼š</p>
<ul>
<li>2ä¸ªé•¿ä¸º 82 çš„ç¯</li>
<li>1ä¸ªé•¿ä¸º75çš„ç¯</li>
<li>3ä¸ªé•¿ä¸º3çš„ç¯</li>
<li>8ä¸ªå•å…ƒç¯</li>
</ul>
<p><br></p>
<p>2ã€<strong>æ¥ä¸‹æ¥å°±æ˜¯åˆ†æå¦‚ä½•è¿˜åŸï¼š</strong></p>
<ul>
<li>å¯¹äºé•¿ä¸º 82 çš„ç¯ï¼Œä»–ä¸€å®šæ˜¯é•¿ä¸º 164 çš„ç¯æ‹†åˆ†è€Œæˆ</li>
<li>é•¿ä¸º 75 çš„ç¯ä¸€å®šæ˜¯æœ¬èº«é•¿å°±ä¸º 75 çš„ç¯</li>
<li>3ä¸ªé•¿ä¸º3çš„ç¯ï¼Œå¯èƒ½æœ¬èº«å°±æ˜¯ 3 ä¸ªé•¿ä¸º 3 çš„ç¯ï¼›ä¹Ÿå¯èƒ½æœ¬èº«æ˜¯ä¸€ä¸ªé•¿ä¸º 3 çš„ç¯åŠ ä¸Šä¸€ä¸ªé•¿ä¸º 6 çš„ç¯æ‹†åˆ†è€Œæˆ</li>
<li>8ä¸ªå•å…ƒç¯ï¼Œå¯èƒ½æœ¬èº«å°±æ˜¯ 8 ä¸ªå•å…ƒç¯ï¼Œä¹Ÿå¯èƒ½æ˜¯ 1-4 ä¸ª 2 å…ƒç¯åŠ ä¸Šå‰©ä¸‹çš„å•å…ƒç¯</li>
</ul>
<p>å› æ­¤ï¼Œè¦è€ƒè™‘ä¸Šè¿°çš„æ‰€æœ‰å¯èƒ½æƒ…å†µï¼Œæ±‚å‡ºæ‰€æœ‰ç¬¦åˆè¦æ±‚çš„æ’åˆ—ï¼Œå¹¶ä¸å¯†æ–‡å¼‚æˆ–åšçˆ†ç ´ã€‚æŒ‰ç†æ¥è¯´ï¼Œä¸€èˆ¬çˆ†ç ´éœ€è¦çš„æ˜¯flagå¤´ï¼Œä½†æ˜¯ç”±äºæˆ‘å¹¶ä¸çŸ¥é“flagå¤´æ˜¯ä»€ä¹ˆ(åˆ«çš„å¸ˆå‚…é—®çš„)ï¼Œæ‰€ä»¥é‡‡ç”¨å…¨ä¸ºå¯è§å­—ç¬¦æ¥çˆ†ç ´ã€‚</p>
<p>å¤æ‚åº¦ç»è®¡ç®—åº”è¯¥æ˜¯ ï¼š(å¯¹å“ªä¸€éƒ¨åˆ†å¤æ‚åº¦ä¸æ¸…æ¥šå¯ä»¥é—®æˆ‘) </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">82*1*4*C(8,2)*C(6,2)*C(4,2)*16</span><br></pre></td></tr></table></figure>
<p>çº¦ä¸ºä¸€åƒå¤šä¸‡ï¼Œå¤§æ¦‚è·‘äº”åˆ†é’Ÿå·¦å³å¯ä»¥å…¨éƒ¨å®Œæˆã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> combinations</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ‰“å°ç¯</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = [18, 188, 48, 47, 100, 234, 225, 8, 187, 34, 124, 113, 118, 252, 137, 196, 125, 20, 251, 168, 167, 5, 225, 134, 66, 203, 26, 148, 63, 181, 213, 124, 170, 234, 35, 120, 47, 69, 157, 69, 194]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">P2 = [41, 124, 256, 27, 201, 93, 40, 133, 47, 10, 69, 253, 13, 245, 165, 166, 118, 230, 197, 249, 115, 18, 71, 24, 100, 14, 160, 28, 251, 96, 106, 5, 244, 58, 67, 44, 150, 42, 255, 74, 168, 182, 153, 209, 227, 232, 159, 128, 125, 11, 135, 90, 76, 30, 84, 31, 1, 149, 48, 95, 216, 94, 157, 131, 196, 172, 105, 169, 202, 203, 121, 210, 53, 9, 147, 89, 39, 68, 59, 141, 87, 207, 51, 180, 19, 81, 57, 103, 228, 77, 12, 129, 185, 85, 45, 123, 50, 116, 65, 213, 104, 64, 54, 155, 222, 112, 3, 252, 21, 33, 138, 151, 211, 233, 204, 97, 239, 113, 82, 200, 23, 231, 177, 26, 72, 4, 78, 183, 199, 6, 49, 29, 250, 119, 32, 56, 110, 187, 35, 143, 83, 25, 70, 2, 66, 101, 217, 120, 224, 142, 191, 136, 189, 127, 132, 36, 174, 146, 152, 140, 193, 62, 178, 17, 148, 248, 167, 88, 73, 229, 134, 156, 158, 60, 63, 242, 221, 34, 214, 20, 171, 139, 226, 186, 164, 181, 236, 107, 111, 61, 99, 108, 179, 223, 137, 212, 237, 102, 161, 145, 184, 173, 247, 162, 205, 154, 55, 117, 254, 38, 75, 234, 7, 46, 109, 22, 175, 144, 219, 220, 195, 190, 98, 79, 15, 170, 80, 235, 52, 8, 37, 243, 198, 86, 43, 192, 241, 240, 208, 130, 188, 114, 218, 215, 206, 176, 238, 16, 246, 126, 122, 163, 225, 92, 91, 194]</span></span><br><span class="line"><span class="string">for i in range(len(P2)):</span></span><br><span class="line"><span class="string">    P2[i] -= 1</span></span><br><span class="line"><span class="string">print(P2[204])</span></span><br><span class="line"><span class="string">lenlist = []</span></span><br><span class="line"><span class="string">for i in range(len(P2)):</span></span><br><span class="line"><span class="string">    len = 1</span></span><br><span class="line"><span class="string">    t = 0</span></span><br><span class="line"><span class="string">    loc = P2[i]</span></span><br><span class="line"><span class="string">    chain = [loc]</span></span><br><span class="line"><span class="string">    while(1):</span></span><br><span class="line"><span class="string">        t = P2[loc]</span></span><br><span class="line"><span class="string">        loc = t</span></span><br><span class="line"><span class="string">        chain.append(loc)</span></span><br><span class="line"><span class="string">        len += 1</span></span><br><span class="line"><span class="string">        if(t == i):</span></span><br><span class="line"><span class="string">            #print(i,&quot;,&quot;,len)</span></span><br><span class="line"><span class="string">            if(len == 2):</span></span><br><span class="line"><span class="string">                print(chain)</span></span><br><span class="line"><span class="string">                print(i+1)</span></span><br><span class="line"><span class="string">            break</span></span><br><span class="line"><span class="string">#print(lenlist.count(2))</span></span><br><span class="line"><span class="string">#2*82 + 75 + 3*3 + 1*8</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#éªŒè¯å‡½æ•°</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        tt = [0 for k in range(256)]</span></span><br><span class="line"><span class="string">        for k in range(256):</span></span><br><span class="line"><span class="string">            tt[k] = P[P[k]] + 1</span></span><br><span class="line"><span class="string">        for k in range(256):</span></span><br><span class="line"><span class="string">            if(tt[k]!= c[k]):</span></span><br><span class="line"><span class="string">                print(k)</span></span><br><span class="line"><span class="string">        exit()</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">chain1 = [<span class="number">9</span>,<span class="number">12</span>,<span class="number">23</span>,<span class="number">27</span>,<span class="number">166</span>,<span class="number">204</span>,<span class="number">218</span>,<span class="number">219</span>]</span><br><span class="line">group_size = <span class="number">2</span></span><br><span class="line">num_groups = <span class="number">4</span></span><br><span class="line">all_groupings = <span class="built_in">list</span>(combinations(chain1, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_groupings</span>(<span class="params">chain1, group_size, num_groups</span>):</span><br><span class="line">    <span class="keyword">if</span> num_groups == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">yield</span> [chain1]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> combo <span class="keyword">in</span> combinations(chain1, group_size):</span><br><span class="line">            remaining_chain1 = [e <span class="keyword">for</span> e <span class="keyword">in</span> chain1 <span class="keyword">if</span> e <span class="keyword">not</span> <span class="keyword">in</span> combo]</span><br><span class="line">            <span class="keyword">for</span> rest_grouping <span class="keyword">in</span> generate_groupings(remaining_chain1, group_size, num_groups - <span class="number">1</span>):</span><br><span class="line">                <span class="keyword">yield</span> [<span class="built_in">list</span>(combo)] + rest_grouping</span><br><span class="line"></span><br><span class="line">chain1r = <span class="built_in">list</span>(generate_groupings(chain1, group_size, num_groups))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = [<span class="number">18</span>, <span class="number">188</span>, <span class="number">48</span>, <span class="number">47</span>, <span class="number">100</span>, <span class="number">234</span>, <span class="number">225</span>, <span class="number">8</span>, <span class="number">187</span>, <span class="number">34</span>, <span class="number">124</span>, <span class="number">113</span>, <span class="number">118</span>, <span class="number">252</span>, <span class="number">137</span>, <span class="number">196</span>, <span class="number">125</span>, <span class="number">20</span>, <span class="number">251</span>, <span class="number">168</span>, <span class="number">167</span>, <span class="number">5</span>, <span class="number">225</span>, <span class="number">134</span>, <span class="number">66</span>, <span class="number">203</span>, <span class="number">26</span>, <span class="number">148</span>, <span class="number">63</span>, <span class="number">181</span>, <span class="number">213</span>, <span class="number">124</span>, <span class="number">170</span>, <span class="number">234</span>, <span class="number">35</span>, <span class="number">120</span>, <span class="number">47</span>, <span class="number">69</span>, <span class="number">157</span>, <span class="number">69</span>, <span class="number">194</span>]</span><br><span class="line">c = [<span class="number">41</span>, <span class="number">124</span>, <span class="number">256</span>, <span class="number">27</span>, <span class="number">201</span>, <span class="number">93</span>, <span class="number">40</span>, <span class="number">133</span>, <span class="number">47</span>, <span class="number">10</span>, <span class="number">69</span>, <span class="number">253</span>, <span class="number">13</span>, <span class="number">245</span>, <span class="number">165</span>, <span class="number">166</span>, <span class="number">118</span>, <span class="number">230</span>, <span class="number">197</span>, <span class="number">249</span>, <span class="number">115</span>, <span class="number">18</span>, <span class="number">71</span>, <span class="number">24</span>, <span class="number">100</span>, <span class="number">14</span>, <span class="number">160</span>, <span class="number">28</span>, <span class="number">251</span>, <span class="number">96</span>, <span class="number">106</span>, <span class="number">5</span>, <span class="number">244</span>, <span class="number">58</span>, <span class="number">67</span>, <span class="number">44</span>, <span class="number">150</span>, <span class="number">42</span>, <span class="number">255</span>, <span class="number">74</span>, <span class="number">168</span>, <span class="number">182</span>, <span class="number">153</span>, <span class="number">209</span>, <span class="number">227</span>, <span class="number">232</span>, <span class="number">159</span>, <span class="number">128</span>, <span class="number">125</span>, <span class="number">11</span>, <span class="number">135</span>, <span class="number">90</span>, <span class="number">76</span>, <span class="number">30</span>, <span class="number">84</span>, <span class="number">31</span>, <span class="number">1</span>, <span class="number">149</span>, <span class="number">48</span>, <span class="number">95</span>, <span class="number">216</span>, <span class="number">94</span>, <span class="number">157</span>, <span class="number">131</span>, <span class="number">196</span>, <span class="number">172</span>, <span class="number">105</span>, <span class="number">169</span>, <span class="number">202</span>, <span class="number">203</span>, <span class="number">121</span>, <span class="number">210</span>, <span class="number">53</span>, <span class="number">9</span>, <span class="number">147</span>, <span class="number">89</span>, <span class="number">39</span>, <span class="number">68</span>, <span class="number">59</span>, <span class="number">141</span>, <span class="number">87</span>, <span class="number">207</span>, <span class="number">51</span>, <span class="number">180</span>, <span class="number">19</span>, <span class="number">81</span>, <span class="number">57</span>, <span class="number">103</span>, <span class="number">228</span>, <span class="number">77</span>, <span class="number">12</span>, <span class="number">129</span>, <span class="number">185</span>, <span class="number">85</span>, <span class="number">45</span>, <span class="number">123</span>, <span class="number">50</span>, <span class="number">116</span>, <span class="number">65</span>, <span class="number">213</span>, <span class="number">104</span>, <span class="number">64</span>, <span class="number">54</span>, <span class="number">155</span>, <span class="number">222</span>, <span class="number">112</span>, <span class="number">3</span>, <span class="number">252</span>, <span class="number">21</span>, <span class="number">33</span>, <span class="number">138</span>, <span class="number">151</span>, <span class="number">211</span>, <span class="number">233</span>, <span class="number">204</span>, <span class="number">97</span>, <span class="number">239</span>, <span class="number">113</span>, <span class="number">82</span>, <span class="number">200</span>, <span class="number">23</span>, <span class="number">231</span>, <span class="number">177</span>, <span class="number">26</span>, <span class="number">72</span>, <span class="number">4</span>, <span class="number">78</span>, <span class="number">183</span>, <span class="number">199</span>, <span class="number">6</span>, <span class="number">49</span>, <span class="number">29</span>, <span class="number">250</span>, <span class="number">119</span>, <span class="number">32</span>, <span class="number">56</span>, <span class="number">110</span>, <span class="number">187</span>, <span class="number">35</span>, <span class="number">143</span>, <span class="number">83</span>, <span class="number">25</span>, <span class="number">70</span>, <span class="number">2</span>, <span class="number">66</span>, <span class="number">101</span>, <span class="number">217</span>, <span class="number">120</span>, <span class="number">224</span>, <span class="number">142</span>, <span class="number">191</span>, <span class="number">136</span>, <span class="number">189</span>, <span class="number">127</span>, <span class="number">132</span>, <span class="number">36</span>, <span class="number">174</span>, <span class="number">146</span>, <span class="number">152</span>, <span class="number">140</span>, <span class="number">193</span>, <span class="number">62</span>, <span class="number">178</span>, <span class="number">17</span>, <span class="number">148</span>, <span class="number">248</span>, <span class="number">167</span>, <span class="number">88</span>, <span class="number">73</span>, <span class="number">229</span>, <span class="number">134</span>, <span class="number">156</span>, <span class="number">158</span>, <span class="number">60</span>, <span class="number">63</span>, <span class="number">242</span>, <span class="number">221</span>, <span class="number">34</span>, <span class="number">214</span>, <span class="number">20</span>, <span class="number">171</span>, <span class="number">139</span>, <span class="number">226</span>, <span class="number">186</span>, <span class="number">164</span>, <span class="number">181</span>, <span class="number">236</span>, <span class="number">107</span>, <span class="number">111</span>, <span class="number">61</span>, <span class="number">99</span>, <span class="number">108</span>, <span class="number">179</span>, <span class="number">223</span>, <span class="number">137</span>, <span class="number">212</span>, <span class="number">237</span>, <span class="number">102</span>, <span class="number">161</span>, <span class="number">145</span>, <span class="number">184</span>, <span class="number">173</span>, <span class="number">247</span>, <span class="number">162</span>, <span class="number">205</span>, <span class="number">154</span>, <span class="number">55</span>, <span class="number">117</span>, <span class="number">254</span>, <span class="number">38</span>, <span class="number">75</span>, <span class="number">234</span>, <span class="number">7</span>, <span class="number">46</span>, <span class="number">109</span>, <span class="number">22</span>, <span class="number">175</span>, <span class="number">144</span>, <span class="number">219</span>, <span class="number">220</span>, <span class="number">195</span>, <span class="number">190</span>, <span class="number">98</span>, <span class="number">79</span>, <span class="number">15</span>, <span class="number">170</span>, <span class="number">80</span>, <span class="number">235</span>, <span class="number">52</span>, <span class="number">8</span>, <span class="number">37</span>, <span class="number">243</span>, <span class="number">198</span>, <span class="number">86</span>, <span class="number">43</span>, <span class="number">192</span>, <span class="number">241</span>, <span class="number">240</span>, <span class="number">208</span>, <span class="number">130</span>, <span class="number">188</span>, <span class="number">114</span>, <span class="number">218</span>, <span class="number">215</span>, <span class="number">206</span>, <span class="number">176</span>, <span class="number">238</span>, <span class="number">16</span>, <span class="number">246</span>, <span class="number">126</span>, <span class="number">122</span>, <span class="number">163</span>, <span class="number">225</span>, <span class="number">92</span>, <span class="number">91</span>, <span class="number">194</span>]</span><br><span class="line"></span><br><span class="line">chain821 = [<span class="number">193</span>, <span class="number">222</span>, <span class="number">97</span>, <span class="number">115</span>, <span class="number">96</span>, <span class="number">49</span>, <span class="number">10</span>, <span class="number">68</span>, <span class="number">201</span>, <span class="number">172</span>, <span class="number">157</span>, <span class="number">145</span>, <span class="number">100</span>, <span class="number">103</span>, <span class="number">154</span>, <span class="number">131</span>, <span class="number">28</span>, <span class="number">250</span>, <span class="number">121</span>, <span class="number">230</span>, <span class="number">36</span>, <span class="number">149</span>, <span class="number">141</span>, <span class="number">24</span>, <span class="number">99</span>, <span class="number">212</span>, <span class="number">6</span>, <span class="number">39</span>, <span class="number">73</span>, <span class="number">8</span>, <span class="number">46</span>, <span class="number">158</span>, <span class="number">151</span>, <span class="number">135</span>, <span class="number">55</span>, <span class="number">30</span>, <span class="number">105</span>, <span class="number">111</span>, <span class="number">150</span>, <span class="number">190</span>, <span class="number">98</span>, <span class="number">64</span>, <span class="number">195</span>, <span class="number">211</span>, <span class="number">233</span>, <span class="number">85</span>, <span class="number">80</span>, <span class="number">86</span>, <span class="number">56</span>, <span class="number">0</span>, <span class="number">40</span>, <span class="number">167</span>, <span class="number">87</span>, <span class="number">102</span>, <span class="number">53</span>, <span class="number">29</span>, <span class="number">95</span>, <span class="number">122</span>, <span class="number">176</span>, <span class="number">220</span>, <span class="number">194</span>, <span class="number">136</span>, <span class="number">109</span>, <span class="number">32</span>, <span class="number">243</span>, <span class="number">214</span>, <span class="number">108</span>, <span class="number">20</span>, <span class="number">114</span>, <span class="number">203</span>, <span class="number">161</span>, <span class="number">61</span>, <span class="number">93</span>, <span class="number">84</span>, <span class="number">18</span>, <span class="number">196</span>, <span class="number">236</span>, <span class="number">240</span>, <span class="number">187</span>, <span class="number">106</span>, <span class="number">2</span>, <span class="number">255</span>]</span><br><span class="line">chain822 = [<span class="number">125</span>, <span class="number">3</span>, <span class="number">26</span>, <span class="number">159</span>, <span class="number">139</span>, <span class="number">142</span>, <span class="number">69</span>, <span class="number">202</span>, <span class="number">246</span>, <span class="number">237</span>, <span class="number">239</span>, <span class="number">129</span>, <span class="number">5</span>, <span class="number">92</span>, <span class="number">184</span>, <span class="number">163</span>, <span class="number">16</span>, <span class="number">117</span>, <span class="number">112</span>, <span class="number">210</span>, <span class="number">74</span>, <span class="number">146</span>, <span class="number">216</span>, <span class="number">174</span>, <span class="number">62</span>, <span class="number">156</span>, <span class="number">173</span>, <span class="number">59</span>, <span class="number">94</span>, <span class="number">44</span>, <span class="number">226</span>, <span class="number">79</span>, <span class="number">140</span>, <span class="number">82</span>, <span class="number">50</span>, <span class="number">134</span>, <span class="number">31</span>, <span class="number">4</span>, <span class="number">200</span>, <span class="number">183</span>, <span class="number">185</span>, <span class="number">180</span>, <span class="number">170</span>, <span class="number">133</span>, <span class="number">118</span>, <span class="number">81</span>, <span class="number">206</span>, <span class="number">54</span>, <span class="number">83</span>, <span class="number">179</span>, <span class="number">19</span>, <span class="number">248</span>, <span class="number">245</span>, <span class="number">175</span>, <span class="number">241</span>, <span class="number">113</span>, <span class="number">232</span>, <span class="number">197</span>, <span class="number">101</span>, <span class="number">63</span>, <span class="number">130</span>, <span class="number">48</span>, <span class="number">124</span>, <span class="number">71</span>, <span class="number">209</span>, <span class="number">37</span>, <span class="number">41</span>, <span class="number">181</span>, <span class="number">138</span>, <span class="number">34</span>, <span class="number">66</span>, <span class="number">104</span>, <span class="number">221</span>, <span class="number">189</span>, <span class="number">60</span>, <span class="number">215</span>, <span class="number">21</span>, <span class="number">17</span>, <span class="number">229</span>, <span class="number">7</span>, <span class="number">132</span>, <span class="number">249</span>]</span><br><span class="line">chain75 = [<span class="number">90</span>, <span class="number">11</span>, <span class="number">252</span>, <span class="number">224</span>, <span class="number">14</span>, <span class="number">164</span>, <span class="number">147</span>, <span class="number">119</span>, <span class="number">199</span>, <span class="number">144</span>, <span class="number">65</span>, <span class="number">171</span>, <span class="number">155</span>, <span class="number">35</span>, <span class="number">43</span>, <span class="number">208</span>, <span class="number">253</span>, <span class="number">91</span>, <span class="number">128</span>, <span class="number">198</span>, <span class="number">160</span>, <span class="number">192</span>, <span class="number">178</span>, <span class="number">213</span>, <span class="number">45</span>, <span class="number">231</span>, <span class="number">242</span>, <span class="number">217</span>, <span class="number">143</span>, <span class="number">1</span>, <span class="number">123</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">244</span>, <span class="number">205</span>, <span class="number">153</span>, <span class="number">126</span>, <span class="number">77</span>, <span class="number">67</span>, <span class="number">168</span>, <span class="number">72</span>, <span class="number">52</span>, <span class="number">75</span>, <span class="number">88</span>, <span class="number">227</span>, <span class="number">234</span>, <span class="number">42</span>, <span class="number">152</span>, <span class="number">188</span>, <span class="number">110</span>, <span class="number">137</span>, <span class="number">186</span>, <span class="number">235</span>, <span class="number">191</span>, <span class="number">107</span>, <span class="number">251</span>, <span class="number">162</span>, <span class="number">177</span>, <span class="number">33</span>, <span class="number">57</span>, <span class="number">148</span>, <span class="number">223</span>, <span class="number">78</span>, <span class="number">58</span>, <span class="number">47</span>, <span class="number">127</span>, <span class="number">182</span>, <span class="number">225</span>, <span class="number">169</span>, <span class="number">228</span>, <span class="number">51</span>, <span class="number">89</span>, <span class="number">76</span>, <span class="number">38</span>, <span class="number">254</span>]</span><br><span class="line">chain31 = [<span class="number">15</span>, <span class="number">165</span>, <span class="number">247</span>]</span><br><span class="line">chain32 = [<span class="number">207</span>, <span class="number">116</span>, <span class="number">238</span>]</span><br><span class="line">chain33 = [<span class="number">120</span>, <span class="number">22</span>, <span class="number">70</span>]</span><br><span class="line">chain1 = [<span class="number">9</span>,<span class="number">12</span>,<span class="number">23</span>,<span class="number">27</span>,<span class="number">166</span>,<span class="number">204</span>,<span class="number">218</span>,<span class="number">219</span>]</span><br><span class="line"></span><br><span class="line">locdic = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¤„ç†chain3(å››ç§æƒ…å†µ)</span></span><br><span class="line"><span class="comment">#æƒ…å†µ1ï¼š3ä¸ªä¸‰ç¯</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span>):</span><br><span class="line">    chain31r = [<span class="number">15</span>, <span class="number">247</span>, <span class="number">165</span>]</span><br><span class="line">    chain32r = [<span class="number">207</span>, <span class="number">238</span>, <span class="number">116</span>]</span><br><span class="line">    chain33r = [<span class="number">120</span>, <span class="number">70</span>, <span class="number">22</span>]</span><br><span class="line">    <span class="comment">#æ·»åŠ å…¥ä½ç½®å­—å…¸</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        locdic[chain31r[i]] = chain31r[(i+<span class="number">1</span>)%<span class="number">3</span>]</span><br><span class="line">        locdic[chain32r[i]] = chain32r[(i+<span class="number">1</span>)%<span class="number">3</span>]</span><br><span class="line">        locdic[chain33r[i]] = chain33r[(i+<span class="number">1</span>)%<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#æƒ…å†µ2:1ä¸ªä¸‰ç¯,1ä¸ªå…­ç¯</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span>):</span><br><span class="line">    chain31r = [<span class="number">15</span>, <span class="number">247</span>, <span class="number">165</span>]</span><br><span class="line">    chain6r = [<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>)]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        <span class="keyword">if</span>(j % <span class="number">2</span> == <span class="number">0</span>):</span><br><span class="line">            chain6r[j] = chain32[j//<span class="number">2</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            chain6r[j] = chain33[(j//<span class="number">2</span> + <span class="number">0</span>) % <span class="number">6</span>] </span><br><span class="line">    <span class="comment">#æ·»åŠ å…¥ä½ç½®å­—å…¸</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        locdic[chain31r[i]] = chain31r[(i+<span class="number">1</span>)%<span class="number">3</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        locdic[chain6r[i]] = chain6r[(i+<span class="number">1</span>)%<span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span>):</span><br><span class="line">    chain32r = [<span class="number">120</span>, <span class="number">70</span>, <span class="number">22</span>]</span><br><span class="line">    chain6r = [<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>)]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        <span class="keyword">if</span>(j % <span class="number">2</span> == <span class="number">0</span>):</span><br><span class="line">            chain6r[j] = chain31[j//<span class="number">2</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            chain6r[j] = chain33[(j//<span class="number">2</span> + <span class="number">0</span>) % <span class="number">6</span>] </span><br><span class="line">    <span class="comment">#æ·»åŠ å…¥ä½ç½®å­—å…¸</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        locdic[chain32r[i]] = chain32r[(i+<span class="number">1</span>)%<span class="number">3</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        locdic[chain6r[i]] = chain6r[(i+<span class="number">1</span>)%<span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span>):</span><br><span class="line">    chain33r = [<span class="number">120</span>, <span class="number">70</span>, <span class="number">22</span>]</span><br><span class="line">    chain6r = [<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>)]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        <span class="keyword">if</span>(j % <span class="number">2</span> == <span class="number">0</span>):</span><br><span class="line">            chain6r[j] = chain31[j//<span class="number">2</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            chain6r[j] = chain32[(j//<span class="number">2</span> + <span class="number">0</span>) % <span class="number">6</span>] </span><br><span class="line">    <span class="comment">#æ·»åŠ å…¥ä½ç½®å­—å…¸</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        locdic[chain33r[i]] = chain33r[(i+<span class="number">1</span>)%<span class="number">3</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        locdic[chain6r[i]] = chain6r[(i+<span class="number">1</span>)%<span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¤„ç†chain75(ç¡®å®š)</span></span><br><span class="line">chain75r = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">75</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">75</span>):</span><br><span class="line">    chain75r[<span class="number">2</span>*i%<span class="number">75</span>] = chain75[i]</span><br><span class="line"><span class="comment">#æ·»åŠ å…¥ä½ç½®å­—å…¸</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">75</span>):</span><br><span class="line">    locdic[chain75r[i]] = chain75r[(i+<span class="number">1</span>)%<span class="number">75</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#å—¯é€ å‰©ä¸‹ä¸¤ç§ç¯çš„ç»„åˆ</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">82</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="comment">#é€ ä¸€ä¸ªå‰¯æœ¬</span></span><br><span class="line">    locdic1 = locdic</span><br><span class="line">    chain164r = [<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">164</span>)]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">164</span>):</span><br><span class="line">        <span class="keyword">if</span>(j % <span class="number">2</span> == <span class="number">0</span>):</span><br><span class="line">            chain164r[j] = chain821[j//<span class="number">2</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            chain164r[j] = chain822[(j//<span class="number">2</span> + i) % <span class="number">82</span>] </span><br><span class="line">    <span class="comment">#æ·»åŠ å…¥ä½ç½®å­—å…¸</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">164</span>):</span><br><span class="line">        locdic1[chain164r[i]] = chain164r[(i+<span class="number">1</span>)%<span class="number">164</span>]</span><br><span class="line">      </span><br><span class="line">    <span class="comment">#4ä¸ªäºŒå…ƒç¯ï¼ˆåŒ…å«å•ç¯æƒ…å†µï¼‰</span></span><br><span class="line">    <span class="keyword">for</span> mm <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        ttt = <span class="built_in">bin</span>(mm)[<span class="number">2</span>:].zfill(<span class="number">4</span>)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(chain1r)):</span><br><span class="line">            locdic2 = locdic1</span><br><span class="line">            <span class="keyword">if</span>(ttt[<span class="number">0</span>] == <span class="string">&quot;1&quot;</span>):</span><br><span class="line">                locdic2[chain1r[j][<span class="number">0</span>][<span class="number">0</span>]] = chain1r[j][<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">                locdic2[chain1r[j][<span class="number">0</span>][<span class="number">1</span>]] = chain1r[j][<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                locdic2[chain1r[j][<span class="number">0</span>][<span class="number">0</span>]] = chain1r[j][<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">                locdic2[chain1r[j][<span class="number">0</span>][<span class="number">1</span>]] = chain1r[j][<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span>(ttt[<span class="number">1</span>] == <span class="string">&quot;1&quot;</span>):</span><br><span class="line">                locdic2[chain1r[j][<span class="number">1</span>][<span class="number">0</span>]] = chain1r[j][<span class="number">1</span>][<span class="number">1</span>]</span><br><span class="line">                locdic2[chain1r[j][<span class="number">1</span>][<span class="number">1</span>]] = chain1r[j][<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                locdic2[chain1r[j][<span class="number">1</span>][<span class="number">0</span>]] = chain1r[j][<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line">                locdic2[chain1r[j][<span class="number">1</span>][<span class="number">1</span>]] = chain1r[j][<span class="number">1</span>][<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span>(ttt[<span class="number">2</span>] == <span class="string">&quot;1&quot;</span>):</span><br><span class="line">                locdic2[chain1r[j][<span class="number">2</span>][<span class="number">0</span>]] = chain1r[j][<span class="number">2</span>][<span class="number">1</span>]</span><br><span class="line">                locdic2[chain1r[j][<span class="number">2</span>][<span class="number">1</span>]] = chain1r[j][<span class="number">2</span>][<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                locdic2[chain1r[j][<span class="number">2</span>][<span class="number">0</span>]] = chain1r[j][<span class="number">2</span>][<span class="number">0</span>]</span><br><span class="line">                locdic2[chain1r[j][<span class="number">2</span>][<span class="number">1</span>]] = chain1r[j][<span class="number">2</span>][<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span>(ttt[<span class="number">3</span>] == <span class="string">&quot;1&quot;</span>):</span><br><span class="line">                locdic2[chain1r[j][<span class="number">3</span>][<span class="number">0</span>]] = chain1r[j][<span class="number">3</span>][<span class="number">1</span>]</span><br><span class="line">                locdic2[chain1r[j][<span class="number">3</span>][<span class="number">1</span>]] = chain1r[j][<span class="number">3</span>][<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                locdic2[chain1r[j][<span class="number">3</span>][<span class="number">0</span>]] = chain1r[j][<span class="number">3</span>][<span class="number">0</span>]</span><br><span class="line">                locdic2[chain1r[j][<span class="number">3</span>][<span class="number">1</span>]] = chain1r[j][<span class="number">3</span>][<span class="number">1</span>]</span><br><span class="line">            P = [locdic2[j]+<span class="number">1</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)]</span><br><span class="line">            </span><br><span class="line">            t = <span class="string">&quot;&quot;</span></span><br><span class="line">            <span class="keyword">for</span> x,y <span class="keyword">in</span> <span class="built_in">zip</span>(hashlib.sha512(<span class="built_in">str</span>(P).encode()).digest(), n):</span><br><span class="line">                <span class="keyword">if</span>((x^y)&gt;=<span class="number">32</span> <span class="keyword">and</span> (x^y)&lt;=<span class="number">127</span>):</span><br><span class="line">                    t+=<span class="built_in">chr</span>(x^y)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">len</span>(t) &gt; <span class="number">10</span>):</span><br><span class="line">                <span class="built_in">print</span>(t)</span><br><span class="line">                exit()</span><br><span class="line">                </span><br><span class="line"><span class="comment">#brics+&#123;ab99943f6dae4f20595c8645fcf8289e&#125;</span></span><br></pre></td></tr></table></figure>
<p>è„šæœ¬æ¯”è¾ƒä¸‘ï¼Œåªèƒ½å°±é¢˜è®ºé¢˜ï¼Œä¸èƒ½ä½œä¸ºè¯¥ç±»æ±‚å¹³æ–¹æ ¹ç½®æ¢çš„é€šè§£ã€‚</p>
<p><br></p>
<p><br></p>
<h3 id="prng-åŠ å¼ºç‰ˆ"><a href="#prng-åŠ å¼ºç‰ˆ" class="headerlink" title="prng(åŠ å¼ºç‰ˆ)"></a>prng(åŠ å¼ºç‰ˆ)</h3><p>(é¢˜ç›®å…·ä½“åç§°å¹¶ä¸æ˜¯è¿™ä¸ªï¼Œåªæ˜¯æˆ‘è¿˜æ²¡æœ‰æ‰¾åˆ°å¯¹åº”é¢˜ç›®åï¼Œå°±å…ˆç”¨ç€)</p>
<p>é¢˜ç›®æ¥æºï¼šæ±Ÿè‹çœé¢†èˆªæ¯</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">base</span>(<span class="params">n, l</span>):</span><br><span class="line">    bb = []</span><br><span class="line">    <span class="keyword">while</span> n &gt; <span class="number">0</span>:</span><br><span class="line">        n, r = <span class="built_in">divmod</span>(n, l)</span><br><span class="line">        bb.append(r)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">str</span>(d) <span class="keyword">for</span> d <span class="keyword">in</span> bb[::-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">prng</span>(<span class="params">secret</span>):</span><br><span class="line">	seed = base(secret, <span class="number">5</span>)</span><br><span class="line">	seed = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(seed)]</span><br><span class="line">	length = <span class="built_in">len</span>(seed)</span><br><span class="line">	R = [[ random.randint(<span class="number">0</span>,<span class="number">4</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length**<span class="number">2</span>)]</span><br><span class="line">	S = []</span><br><span class="line">	<span class="keyword">for</span> r <span class="keyword">in</span> R:</span><br><span class="line">		s = <span class="number">0</span></span><br><span class="line">		<span class="keyword">for</span> index <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">			s += (r[index] + seed[index]) % <span class="number">5</span></span><br><span class="line">		s %= <span class="number">2</span></span><br><span class="line">		S.append(s)</span><br><span class="line">	<span class="keyword">return</span> R, S</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">R, S = prng(m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	f.write(<span class="string">f&#x27;R = <span class="subst">&#123;R&#125;</span>\nS = <span class="subst">&#123;S&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>æ¢³ç†åŠ å¯†æµç¨‹ï¼š</p>
<ul>
<li>å°†flagè½¬ä¸ºå¤§æ•´æ•°åï¼Œå°†è¯¥æ•´æ•°è½¬ä¸ºäº”è¿›åˆ¶æ•°ï¼Œå¹¶è½¬ä¸ºåˆ—è¡¨ï¼Œä½œä¸ºseed</li>
<li>è®°åˆ—è¡¨seedé•¿åº¦ä¸ºn</li>
<li>ç”Ÿæˆä¸€ä¸ª $ n^2*n$ çš„çŸ©é˜µRï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ ä¸º0-4çš„éšæœºæ•°</li>
<li>åˆ©ç”¨RçŸ©é˜µï¼Œå¯¹seedçŸ©é˜µåšå¦‚ä¸‹åŠ å¯†ï¼š(å…¶ä¸­ï¼Œ$ i=1,2â€¦n^2$)</li>
</ul>
<script type="math/tex; mode=display">
s_i=\sum_{j=1}^{n}{(({r_{ij}+seed_i})(mod\;5))} \quad(mod\;2)</script><ul>
<li>å°† $ s_i$ æ‹¼æ¥ä¸ºSå‘é‡åï¼Œæä¾›Rä¸Sï¼Œæ±‚è§£æ˜æ–‡</li>
</ul>
<p>è‡ªå·±åšæ˜¯ä¸€ç‚¹æ€è·¯éƒ½æ²¡æœ‰ï¼Œæœ€ç»ˆæ‰¾åˆ°äº† ZM.J å¸ˆå‚…çš„ä¸€ç¯‡wpï¼Œå‘ç°é¢˜ç›®æ˜¯ç±»ä¼¼çš„ï¼š</p>
<p><a href="https://zhuanlan.zhihu.com/p/643573246">[CryptoCTF] CryptoCTF 2023 toughåˆ†ç±» å›¢é˜Ÿè§£é¢˜writeup - çŸ¥ä¹ (zhihu.com)</a></p>
<p>äºæ˜¯å°±å¯ä»¥è¿ç§»åˆ°è¿™é“é¢˜ç›®ä¸­æ¥ï¼š</p>
<p>é¦–å…ˆï¼Œç”±äºseedä¸­æ¯ä¸ªæ•°å­—éƒ½æ˜¯0-4ä¹‹ä¸­çš„æŸä¸ªæ•°mï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå¯¹å…¶è¿›è¡Œç¼–ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0 : (1,0,0,0,0)</span><br><span class="line">1 : (0,1,0,0,0)</span><br><span class="line">2 : (0,0,1,0,0)</span><br><span class="line">3 : (0,0,0,1,0)</span><br><span class="line">4 : (0,0,0,0,1)</span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬ç›¸å½“äºæŠŠä¸€ä¸ª0-4çš„æ•°è½¬åŒ–ä¸ºäº†äº”ä¸ªå˜é‡ç»„æˆçš„ä¸€ä¸ªå‘é‡ï¼š</p>
<script type="math/tex; mode=display">
m = \left(
 \begin{matrix}
   x_{0} \\
   x_{1} \\
   x_{2} \\
   x_{3}  \\
   x_{4}  \\
  \end{matrix}
  \right)</script><p>å…¶ä¸­ï¼Œæ¯ä¸ªå˜é‡ $ x_i$ åªæœ‰0æˆ–1ä¸¤ç§å–å€¼ï¼Œå¹¶ä¸”å¯¹äºä»»æ„ä¸€ä¸ª0-4çš„æ•°mï¼Œ $ x_i$ æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªå˜é‡ä¸º1ï¼Œå…¶ä»–å‡ä¸º0</p>
<p>è¿™ä¹ˆåšçš„æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯è®©æˆ‘ä»¬èƒ½å¤Ÿå°†è¿™ä¸ªå…ˆæ¨¡5å†æ¨¡2çš„æ²¡æœ‰åŠæ³•è§£çš„çº¿æ€§æ–¹ç¨‹ç»„ï¼Œå˜åŒ–åˆ°ä¸€ä¸ªå¯ä»¥è§£çš„å½¢å¼ã€‚</p>
<p>ä¸ºä»€ä¹ˆè¿™æ ·å˜æ¢åå°±å¯ä»¥è§£ï¼Ÿç”±åŠ å¯†æµç¨‹çŸ¥é“ï¼Œ$ r_{ij},seed_i$ å‡ä¸º0-4ä¹‹é—´çš„æ•°ï¼Œå› æ­¤ç›¸åŠ åæ¨¡5æ¨¡2çš„ç»“æœå®Œå…¨å¯ä»¥ç”¨ä¸€å¼ è¡¨åŠ ä»¥è¡¨ç¤ºï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>4</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
<p>è¡¨çš„å«ä¹‰æ˜¯ï¼Œå½“ r å– i ï¼Œseed å– j æ—¶ï¼Œè¡¨ä¸­ç¬¬ i è¡Œç¬¬ j åˆ—å³ä¸º$ (r+seed)\;(mod\;5)\;(mod\;2)$ çš„å€¼</p>
<p>ç„¶ååœ¨è¿™é‡Œä¸¾ä¸ªç®€å•çš„ä¾‹å­æ¥çœ‹ä¸€ä¸‹å¦‚ä½•å˜æ¢åŸé¢˜ç›®çš„çº¿æ€§æ–¹ç¨‹åˆ°è¿™ç§å½¢å¼ä¸‹ï¼š</p>
<p>å‡è®¾$ s = (2+m_0)+(3+m_1)+(4+m_2) \;(mod\;5)\;(mod\;2)$ï¼Œ</p>
<p>ç¬¬ä¸€æ­¥ï¼ŒæŠŠæ¯ä¸ª $ m_i$ è¡¨ç¤ºä¸ºäº”ä¸ªå˜é‡çš„å½¢å¼ï¼š</p>
<script type="math/tex; mode=display">
m_0 = \left(
 \begin{matrix}
   x_{00} \\
   x_{01} \\
   x_{02} \\
   x_{03}  \\
   x_{04}  \\
  \end{matrix}
  \right),
  m_1 = \left(
 \begin{matrix}
   x_{10} \\
   x_{11} \\
   x_{12} \\
   x_{13}  \\
   x_{14}  \\
  \end{matrix}
  \right),
  m_2 = \left(
 \begin{matrix}
   x_{20} \\
   x_{21} \\
   x_{22} \\
   x_{23}  \\
   x_{24}  \\
  \end{matrix}
  \right)</script><p>ç¬¬äºŒæ­¥ï¼ŒæŠŠæ¯ä¸€ä¸ªrè½¬åŒ–æˆå¯¹åº”ç³»æ•°çŸ©é˜µï¼š</p>
<p>æ¯”å¦‚ï¼Œr=2æ—¶ï¼Œçœ‹ä¸Šè¡¨çš„å–2çš„è¡Œï¼Œéœ€è¦å˜é‡1æˆ–4å–1å°±èƒ½å¾—åˆ°1ï¼Œå¦åˆ™ä¸º0ï¼›r=3æ—¶ï¼Œçœ‹ä¸Šè¡¨çš„å–3çš„è¡Œï¼Œéœ€è¦å˜é‡0æˆ–3å–1å°±èƒ½å¾—åˆ°1ï¼Œå¦åˆ™ä¸º0ï¼›r=4æ—¶ï¼Œçœ‹ä¸Šè¡¨çš„å–4çš„è¡Œï¼Œéœ€è¦å˜é‡2æˆ–4å–1å°±èƒ½å¾—åˆ°1ï¼Œå¦åˆ™ä¸º0</p>
<p>è¿™åˆæ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿæ¯”å¦‚ $ (2+1) \;(mod\;5)\;(mod\;2)$ï¼Œç”±çœŸå€¼è¡¨å¯çŸ¥ï¼Œä»–å°±å®Œå…¨ç­‰ä»·äºä¸‹é¢çš„å½¢å¼ï¼š</p>
<script type="math/tex; mode=display">
(0,1,0,0,1)*\left(
 \begin{matrix}
   0 \\
   1 \\
   0 \\
   0  \\
   0  \\
  \end{matrix}
  \right) \quad(mod\;2)</script><p>è¿™ä¹ˆåšçš„å¥½å¤„å°±æ˜¯ï¼š</p>
<ul>
<li>å»é™¤äº†æ¨¡5çš„å½±å“</li>
<li>ç”±åŠ æ³•è½¬æˆäº†ä¹˜æ³•ï¼Œå˜æˆäº†çŸ©é˜µå¯è§£çš„å½¢å¼</li>
</ul>
<p>å› æ­¤ï¼Œåˆšæ‰çš„ç­‰å¼$ s = (2+m_0)+(3+m_1)+(4+m_2) \;(mod\;5)\;(mod\;2)$å°±å½»åº•å»é™¤äº†ä¸æ¨¡5çš„å…³ç³»ï¼Œè€Œåªå‰©ä¸‹æ¨¡2ä¸‹çš„çº¿æ€§å…³ç³»ä¸å˜é‡ï¼Œå˜æˆäº†ä¸‹é¢è¿™ç§å½¢å¼ï¼š</p>
<script type="math/tex; mode=display">
s = (0,1,0,0,1)*\left(
 \begin{matrix}
   x_{00} \\
   x_{01} \\
   x_{02} \\
   x_{03}  \\
   x_{04}  \\
  \end{matrix}
  \right)
  + (1,0,0,1,0)*\left(
 \begin{matrix}
   x_{10} \\
   x_{11} \\
   x_{12} \\
   x_{13}  \\
   x_{14}  \\
  \end{matrix}
  \right)
  + (0,0,1,0,1) * \left(
 \begin{matrix}
   x_{20} \\
   x_{21} \\
   x_{22} \\
   x_{23}  \\
   x_{24}  \\
  \end{matrix}
  \right)
  \quad(mod\;2)</script><p>è€ŒæŠŠè¿™ç§å½¢å¼åº”ç”¨äºæˆ‘ä»¬éœ€è¦æ±‚è§£çš„é—®é¢˜ä¹‹ä¸­ï¼Œå°±å¯ä»¥æŠŠseedä¸­åŸæœ¬çš„nä¸ªå˜é‡è½¬åŒ–æˆ5nä¸ªå˜é‡ï¼Œå› æ­¤åªéœ€è¦ä»n^2ä¸ªçº¿æ€§æ–¹ç¨‹ä¸­æ‹¿å‡º5nä¸ªçº¿æ€§çº¿æ€§æ–¹ç¨‹å³å¯è§£å¾—æ‰€æœ‰çš„å˜é‡å–å€¼ï¼Œå†ç”¨åˆšæ‰å¯¹mçš„ç¼–ç è¿˜åŸå³å¯ã€‚</p>
<p>ä½ å¯èƒ½ä¼šå‘ç°æ±‚è§£åçš„å‘é‡å¹¶ä¸å…¨æ˜¯åˆšæ‰çš„ç¼–ç å½¢å¼ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0 : (1,0,0,0,0)</span><br><span class="line">1 : (0,1,0,0,0)</span><br><span class="line">2 : (0,0,1,0,0)</span><br><span class="line">3 : (0,0,0,1,0)</span><br><span class="line">4 : (0,0,0,0,1)</span><br></pre></td></tr></table></figure>
<p>è€Œå‡ºç°äº†ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(1,1,1,1,0)</span><br></pre></td></tr></table></figure>
<p>äº‹å®ä¸Šï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬å¹¶æ²¡æœ‰æŠŠåˆšæ‰è¯´çš„è¿™ä¸€ç‚¹åŠ å…¥åˆ°çº¿æ€§æ–¹ç¨‹ç»„çš„çº¦æŸä¸­ï¼š</p>
<ul>
<li>å¯¹äºä»»æ„ä¸€ä¸ª0-4çš„æ•°mï¼Œ $ x_i$ æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªå˜é‡ä¸º1ï¼Œå…¶ä»–å‡ä¸º0</li>
</ul>
<p>ä½†æ˜¯å½±å“ä¸å¤§äº†ï¼Œå› ä¸ºä½ å¤§æ¦‚ä¹Ÿèƒ½çŒœåˆ°(1,1,1,1,0)å¯¹åº”çš„å°±æ˜¯ä¸åŠ è¯¥é™åˆ¶æ—¶4çš„ç¼–ç ï¼Œå› æ­¤å¯¹åº”è¿˜åŸå°±å¥½</p>
<p>exp.ipynb:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&#x27;E:\vscode\output4.txt&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="built_in">exec</span>(f.read())</span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(R[<span class="number">0</span>])</span><br><span class="line">A = []</span><br><span class="line">B = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span> * n):</span><br><span class="line">    a = []</span><br><span class="line">    B.append(S[i])</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        <span class="keyword">if</span> (R[i][j] == <span class="number">0</span>):</span><br><span class="line">            a.extend([<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span> ,<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">elif</span> (R[i][j] == <span class="number">1</span>):</span><br><span class="line">            a.extend([<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>])</span><br><span class="line">        <span class="keyword">elif</span> (R[i][j] == <span class="number">2</span>):</span><br><span class="line">            a.extend([<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>])</span><br><span class="line">        <span class="keyword">elif</span> (R[i][j] == <span class="number">3</span>):</span><br><span class="line">            a.extend([<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>])</span><br><span class="line">        <span class="keyword">elif</span> (R[i][j] == <span class="number">4</span>):</span><br><span class="line">            a.extend([<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>])</span><br><span class="line">    A.append(a)</span><br><span class="line"></span><br><span class="line">A = matrix(GF(<span class="number">2</span>), A)</span><br><span class="line">B = vector(GF(<span class="number">2</span>), B)</span><br><span class="line">x = A.solve_right(B)</span><br><span class="line"><span class="comment">#print(x)</span></span><br><span class="line"></span><br><span class="line">flag = []</span><br><span class="line">temp = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    <span class="keyword">if</span> (x[<span class="number">5</span>*i] == <span class="number">1</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">1</span>] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">2</span>] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">3</span>] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">4</span>] == <span class="number">0</span>):</span><br><span class="line">        flag.append(<span class="string">&quot;0&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> (x[<span class="number">5</span>*i] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">1</span>] == <span class="number">1</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">2</span>] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">3</span>] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">4</span>] == <span class="number">0</span>):</span><br><span class="line">        flag.append(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> (x[<span class="number">5</span>*i] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">1</span>] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">2</span>] == <span class="number">1</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">3</span>] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">4</span>] == <span class="number">0</span>):</span><br><span class="line">        flag.append(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> (x[<span class="number">5</span>*i] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">1</span>] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">2</span>] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">3</span>] == <span class="number">1</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">4</span>] == <span class="number">0</span>):</span><br><span class="line">        flag.append(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> (x[<span class="number">5</span>*i] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">1</span>] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">2</span>] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">3</span>] == <span class="number">0</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">4</span>] == <span class="number">1</span>):</span><br><span class="line">        flag.append(<span class="string">&quot;4&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> (x[<span class="number">5</span>*i] == <span class="number">1</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">1</span>] == <span class="number">1</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">2</span>] == <span class="number">1</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">3</span>] == <span class="number">1</span>) <span class="keyword">and</span> (x[<span class="number">5</span>*i+<span class="number">4</span>] == <span class="number">0</span>):</span><br><span class="line">        flag.append(<span class="string">&quot;4&quot;</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span>.join(flag)</span><br><span class="line">flag = long_to_bytes(<span class="built_in">int</span>(flag, <span class="number">5</span>))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#CnHongKe&#123;179bdc38ea135c35f1f973c039a422a7&#125;</span></span><br></pre></td></tr></table></figure>
<p>(æœ‰ä¸æ‡‚çš„åœ°æ–¹æ¬¢è¿ä¸æˆ‘äº¤æµï¼)</p>
<p><br></p>
<p><br></p>
]]></content>
      <categories>
        <category>cryptoè¶£é¢˜</category>
      </categories>
  </entry>
  <entry>
    <title>Cryptoè¶£é¢˜-å¤å…¸å¯†ç </title>
    <url>/post/165cec8c.html</url>
    <content><![CDATA[<p>è¯¥æ–‡ç« ä¸»è¦è®°å½•ä¸€äº›å¤å…¸å¯†ç ç›¸å…³çš„è¶£é¢˜</p>
<span id="more"></span>
<h3 id="Ex-Viginere"><a href="#Ex-Viginere" class="headerlink" title="Ex Viginere?"></a>Ex Viginere?</h3><p>é¢˜ç›®æ¥æºï¼šMoeCTF 2021</p>
<h4 id="åŠ å¯†æµç¨‹è§£è¯»"><a href="#åŠ å¯†æµç¨‹è§£è¯»" class="headerlink" title="åŠ å¯†æµç¨‹è§£è¯»"></a>åŠ å¯†æµç¨‹è§£è¯»</h4><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¿™éš¾é“æ˜¯ç»´å‰å°¼äºšå—ï¼Ÿ</span><br><span class="line">text is a plain English text which only consists of lowercase letters (without any symbol)</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> a, b, text, key, flag</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">table = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> key <span class="keyword">in</span> text</span><br><span class="line"><span class="keyword">assert</span> a * b &lt; <span class="number">100</span></span><br><span class="line"><span class="keyword">assert</span> flag == <span class="string">b&#x27;moectf&#123;&#x27;</span> + key.encode() + <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> md5(key.encode()+<span class="string">b&#x27;How_Interesting_the_Cryptography_Is&#x27;</span>).hexdigest() == <span class="string">&#x27;196cf7098c7ea6e3e4d03691fb9d4f58&#x27;</span></span><br><span class="line"></span><br><span class="line">k1 = []</span><br><span class="line">k2 = []</span><br><span class="line"></span><br><span class="line">sequence = [<span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line">n = randint(<span class="number">114514</span>,<span class="number">1919810</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65536</span>):<span class="comment">#2**16</span></span><br><span class="line">    sequence.append((sequence[-<span class="number">1</span>] + sequence[-<span class="number">2</span>]) % n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(a):</span><br><span class="line">    k1.append(sequence[randint(<span class="number">0</span>, <span class="number">65536</span>)] % <span class="number">26</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(b):</span><br><span class="line">    k2.append(sequence[randint(<span class="number">0</span>, <span class="number">65536</span>)] % <span class="number">26</span>)</span><br><span class="line"></span><br><span class="line">c = <span class="string">&#x27;&#x27;</span>.join(table[((<span class="built_in">ord</span>(x) - <span class="number">97</span>) * (k1[i % a]) + k2[i % b]) % <span class="number">26</span>] <span class="keyword">for</span> i, x <span class="keyword">in</span> <span class="built_in">enumerate</span>(text))</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">r&#x27;./cipher&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(c)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
<p>å¹¶ä¸”ç»™å®šcipheræ–‡ä»¶ï¼Œå…¶ä¸­å†…å®¹ä¸ºé•¿åº¦ä¸º108361çš„å­—æ¯æ–‡æœ¬ï¼š</p>
<p><img src="/post/165cec8c/image-20230929101431427.png" alt="image-20230929101431427"></p>
<p>æŠŠåŠ å¯†ç¨‹åºä¸€ç‚¹ä¸€ç‚¹è¯»å®Œï¼Œå¯ä»¥æå–å‡ºä»¥ä¸‹ä¿¡æ¯ï¼š</p>
<ul>
<li>æœ€ç»ˆ flag ç”± key ç»„æˆï¼Œå…¶ä¸­ key æ˜¯è¢«åŠ å¯†çš„åŸæ–‡ä¸­çš„æŸä¸ªå­—ç¬¦ä¸²</li>
<li>key åœ¨åŸæ–‡ä¸­çš„ä½ç½®æœªçŸ¥ï¼Œä¸”é•¿åº¦æœªçŸ¥</li>
<li>ç”Ÿæˆä¸€ä¸ªéšæœºæ•° nï¼Œä½œä¸ºä¹‹åç”Ÿæˆ sequence åºåˆ—çš„æ¨¡æ•°</li>
<li>sequence åºåˆ—å…¶å®å°±æ˜¯æ¨¡ n æ„ä¹‰ä¸‹çš„æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œå…±ç”Ÿæˆ 65536 é¡¹</li>
<li>ä» sequence åºåˆ—ä¸­éšæœºé€‰æ‹© a é¡¹å¹¶æ¨¡ 26ï¼Œä½œä¸ºåŠ å¯†æ‰€éœ€çš„ k1 åºåˆ—</li>
<li>ä» sequence åºåˆ—ä¸­éšæœºé€‰æ‹© b é¡¹å¹¶æ¨¡ 26ï¼Œä½œä¸ºåŠ å¯†æ‰€éœ€çš„ k2 åºåˆ—</li>
<li>å¯¹åŸæ–‡ä¸­çš„æ¯ä¸€ä¸ªå­—ç¬¦ m è¿›è¡Œä»¿å°„åŠ å¯†å¾—åˆ°å¯†æ–‡ï¼Œå…¶ä¸­ä»¿å°„åŠ å¯†çš„ A ä¸º k1[i % a]ï¼ŒB ä¸º k2[i % b]</li>
</ul>
<p>æ­¤å¤–è¿˜æœ‰ä¸€äº›é¢å¤–ä¿¡æ¯ï¼š</p>
<ul>
<li>ä¸€æ®µæœ‰å…³ key çš„md5å€¼</li>
<li>a*b &lt; 100</li>
</ul>
<h4 id="å¼•å…¥é‡åˆæŒ‡æ•°"><a href="#å¼•å…¥é‡åˆæŒ‡æ•°" class="headerlink" title="å¼•å…¥é‡åˆæŒ‡æ•°"></a>å¼•å…¥é‡åˆæŒ‡æ•°</h4><p>å› ä¸ºå¯†æ–‡å¾ˆé•¿ï¼Œæ‰€ä»¥å¯ä»¥ç”¨ç»Ÿè®¡æ–¹é¢çš„æ€æƒ³æ¥è§£å†³é¢˜ç›®ï¼Œå› æ­¤å¼•å…¥<strong>é‡åˆæŒ‡æ•°</strong>çš„æ¦‚å¿µï¼š<strong>é‡åˆæŒ‡æ•°æ˜¯æŒ‡å­—ç¬¦ä¸²ä¸­ä¸¤ä¸ªéšæœºå…ƒç´ ç›¸åŒçš„æ¦‚ç‡ã€‚</strong>å› æ­¤ï¼Œå‡å¦‚æˆ‘ä»¬ä»…è€ƒè™‘å®Œå…¨ç”±è‹±æ–‡å­—ç¬¦ç»„æˆçš„æ–‡æœ¬ï¼Œé‚£ä¹ˆä¸€ä¸ªæ–‡æœ¬çš„é‡åˆæŒ‡æ•°å°±æŒ‰å¦‚ä¸‹æ–¹å¼è®¡ç®—ï¼š(é‡åˆæŒ‡æ•°ä»¥ In è¡¨ç¤º,p(a)è¡¨ç¤º a åœ¨æ–‡æœ¬ä¸­å‡ºç°çš„é¢‘ç‡)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">In = p(a)*p(a) + p(b)*p(b) + p(c)*p(c) + ... + p(z)*p(z)</span><br></pre></td></tr></table></figure>
<p>ä»£ç å®ç°å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">table = ascii_lowercase</span><br><span class="line"></span><br><span class="line"><span class="comment">#obj:å¾…åˆ†å‰²å­—ç¬¦ä¸²  #sec:åˆ†å‰²é•¿åº¦</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cut</span>(<span class="params">obj, sec</span>):</span><br><span class="line">    <span class="keyword">return</span> [obj[i:i+sec] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(obj),sec)]</span><br><span class="line"></span><br><span class="line"><span class="comment">#è®¡ç®—é‡åˆæŒ‡æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">In</span>(<span class="params">c</span>):</span><br><span class="line">    freq = &#123;i:<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> table&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(table)):</span><br><span class="line">        freq[table[i]] = c.count(table[i]) / <span class="built_in">len</span>(c)</span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> table:</span><br><span class="line">        index += freq[i] * freq[i]</span><br><span class="line">    <span class="keyword">return</span> index</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆå¯¹äºä¸‹åˆ—ä¸¤ç§æ–‡æœ¬åˆ†åˆ«è®¡ç®—é‡åˆæŒ‡æ•°ï¼Œå°±èƒ½çœ‹å‡ºå®ƒä»¬çš„åŒºåˆ«ï¼š(æ–‡æœ¬å­—ç¬¦å‡è¶³å¤Ÿå¤šï¼Œç¬¦åˆç»Ÿè®¡æ¦‚å¿µ)</p>
<p>1ã€å®Œå…¨éšæœºçš„è‹±æ–‡æ–‡æœ¬(26ä¸ªå­—æ¯å‡éšæœºç”Ÿæˆï¼Œå› æ­¤å‡ºç°é¢‘ç‡ç›¸å½“ï¼Œå‡ä¸º 1/26)</p>
<p>2ã€æ­£å¸¸çš„è‹±æ–‡æ–‡æœ¬(26ä¸ªå­—ç¬¦æœ‰ä½¿ç”¨é¢‘ç‡ä¸Šçš„å·®åˆ«)ï¼Œä¸€èˆ¬æ¥è¯´å¦‚ä¸‹ï¼š</p>
<p><img src="/post/165cec8c/image-20230930103629784.png" alt="image-20230930103629784"></p>
<p>1ã€</p>
<script type="math/tex; mode=display">
In = \sum_{i=1}^{26}{(\frac{1}{26})^2} = \frac{1}{26} \approx 0.038</script><p>2ã€</p>
<script type="math/tex; mode=display">
In = \sum_{i=1}^{26}{p(i)^2}  \approx 0.065</script><p>ç”±æ­¤ï¼Œæˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªåŒºåˆ†éšæœºæ–‡æœ¬ä¸è‹±æ–‡æ–‡æœ¬çš„é‡è¦ä¾æ®ã€‚</p>
<h4 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h4><h5 id="part1ï¼šæ‰¾å‡ºå¯†é’¥é•¿åº¦"><a href="#part1ï¼šæ‰¾å‡ºå¯†é’¥é•¿åº¦" class="headerlink" title="part1ï¼šæ‰¾å‡ºå¯†é’¥é•¿åº¦"></a>part1ï¼šæ‰¾å‡ºå¯†é’¥é•¿åº¦</h5><p>é‡åˆæŒ‡æ•°å¦‚ä½•åº”ç”¨åˆ°é¢˜ç›®é‡Œå‘¢ï¼Ÿé¦–å…ˆæƒ³æ˜ç™½ä¸€ç‚¹ï¼šè¢«åŒä¸€ä¸ªå¯†é’¥(aã€bå‡ç›¸åŒ)åŠ å¯†çš„æ˜æ–‡ï¼Œä¸€å®šä¼šå˜æˆåŒä¸€ä¸ªå¯†æ–‡ã€‚å› æ­¤æˆ‘ä»¬å¦‚æœèƒ½å¤Ÿæ‰¾åˆ°æ‰€æœ‰è¢«åŒä¸€ä¸ªå¯†é’¥åŠ å¯†çš„å¯†æ–‡ç»„ï¼Œé‚£ä¹ˆè¯¥å¯†æ–‡ç»„çš„é‡åˆæŒ‡æ•°æ˜¯ç¬¦åˆæ­£å¸¸è‹±æ–‡æ–‡æœ¬çš„(å¯ä»¥ä»”ç»†æƒ³æƒ³)</p>
<p>æ‰€ä»¥æˆ‘ä»¬å°±éœ€è¦å…ˆç”±é‡åˆæŒ‡æ•°æ‰¾åˆ°å“ªäº›å¯†æ–‡æ˜¯è¢«åŒä¸€ä¸ªå¯†é’¥åŠ å¯†çš„ï¼Œå®é™…ä¸Šè¿™å°±æ˜¯åœ¨æ±‚ gcd(a,b) ,è€Œç”±é¢˜ç›®æ¡ä»¶ a*b &lt; 100ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å¾ˆå¿«çˆ†ç ´å‡ºæ¥ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#part1 ä¾æ®é‡åˆæŒ‡æ•°æ‰¾å‡ºa*b=77</span></span><br><span class="line">t = c</span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">        temp = cut(t,i)</span><br><span class="line">        temp1 = [<span class="string">&quot;&quot;</span> <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(i)]</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(temp)-<span class="number">1</span>):</span><br><span class="line">            temp1[<span class="number">0</span>] += temp[k][<span class="number">0</span>]</span><br><span class="line">        index = In(<span class="string">&quot;&quot;</span>.join(temp1[<span class="number">0</span>]))</span><br><span class="line">        <span class="keyword">if</span>(index &gt; <span class="number">0.060</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;lenkey = &quot;</span>,i,<span class="string">&quot;   In = &quot;</span>,index)</span><br></pre></td></tr></table></figure>
<p>çˆ†ç ´å¾—åˆ°a*b = 77ï¼Œå› æ­¤a=7ï¼Œb=11æˆ–a=11ï¼Œb=7</p>
<h5 id="part2ï¼šç¡®å®šå¯†é’¥å†…å®¹"><a href="#part2ï¼šç¡®å®šå¯†é’¥å†…å®¹" class="headerlink" title="part2ï¼šç¡®å®šå¯†é’¥å†…å®¹"></a>part2ï¼šç¡®å®šå¯†é’¥å†…å®¹</h5><p>ç¡®å®šäº†å¯†é’¥é•¿åº¦åï¼Œç°åœ¨å°±éœ€è¦ç¡®å®šå¯†é’¥çš„å†…å®¹å…·ä½“æ˜¯ä»€ä¹ˆï¼Œä¹Ÿå°±æ˜¯ k1ã€k2é‡Œç©¶ç«Ÿæ˜¯ä»€ä¹ˆæ•°å­—ã€‚</p>
<p>é¦–å…ˆä¼šå‘ç°ä¸€ä¸ª trickï¼Œé‚£å°±æ˜¯ sequence åºåˆ—çš„ç”Ÿæˆæ ¹æœ¬æ²¡ä»€ä¹ˆç”¨ï¼Œç”±äºæœ€ç»ˆæ˜¯åœ¨mod 26 ä¸‹è¿›è¡Œè®¡ç®—ï¼Œå› æ­¤ç›´æ¥æŠŠsequence å½“æˆä¸€ä¸ªç”± 0-25 ç»„æˆçš„éšæœºåºåˆ—å°±å¯ä»¥ã€‚é‚£ä¹ˆæ€ä¹ˆç¡®å®šå‘¢ï¼Œä¾ç„¶æ˜¯åˆ©ç”¨é‡åˆæŒ‡æ•°ï¼Œåªæ˜¯è¦æ¢ä¸€ç§ç”¨æ³•ã€‚</p>
<p>å…ˆå¼•å…¥ä¸€ä¸ªç»“è®ºï¼š</p>
<p>å‡è®¾ $ p1, p2 , p3â€¦, pn$ä¸ºé€’å‡çš„æ¦‚ç‡åˆ†å¸ƒ( $ p1\geq p2 \geq p3â€¦\geq pn$ )ï¼Œä»¤$ q1â€™, q2â€™ , q3â€™â€¦, qnâ€™$ä¸º $ q1, q2 , q3â€¦, qn$çš„ä»»æ„ç½®æ¢ï¼Œåˆ™å½“ $ q1â€™, q2â€™ , q3â€™â€¦, qnâ€™$ æ°å¥½ä¹Ÿä¸ºé€’å‡çš„æ¦‚ç‡åˆ†å¸ƒæ—¶ï¼Œä¸‹å¼å–å¾—æœ€å¤§å€¼ï¼š</p>
<script type="math/tex; mode=display">
\sum_{i=1}^{26}{pi*qi'}</script><p>è¿™ä¸ªç»“è®ºçš„è¯æ˜å¹¶ä¸å¤æ‚ï¼Œå¯ä»¥è‡ªè¡Œå°è¯•ã€‚</p>
<p>è¿™ä¸ªç»“è®ºæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿæˆ‘ä»¬ç°åœ¨å…ˆæŠŠå¯†æ–‡æŒ‰é•¿åº¦ä¸º 77 åˆ†ç»„ï¼Œå¹¶å–å‡ºæ¯ç»„çš„ç¬¬ä¸€ä¸ªå­—æ¯ç»„æˆä¸€ä¸ªæ–°çš„å¯†æ–‡ä¸²ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–°çš„å¯†æ–‡ä¸²çš„æ‰€æœ‰å­—ç¬¦ï¼Œéƒ½æ˜¯è¢«k1[0]ã€k2[0]è¿™ä¸ªå¯†é’¥åŠ å¯†çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬çˆ†ç ´çš„å¯†é’¥ç©ºé—´å¤§å°ä¸€å…±å°±åªæœ‰12*26 = 312(å‚è€ƒä»¿å°„å¯†ç )ã€‚</p>
<p>çˆ†ç ´çš„ä¾æ®æ˜¯ä»€ä¹ˆï¼Ÿä»ç„¶æ˜¯é‡åˆæŒ‡æ•°ï¼Œå¯¹äºç°åœ¨è¢«åŠ å¯†çš„å¯†æ–‡ï¼Œå®ƒè‡ªèº«çš„é‡åˆæŒ‡æ•°æ˜¯ç¬¦åˆ0.065çš„ï¼Œå› ä¸ºæ˜¯å•è¡¨ä»£æ¢ï¼›ä½†æ˜¯åŠ å¯†è¿‡åï¼Œå„ä¸ªå­—ç¬¦çš„é¢‘ç‡å‘ç”Ÿäº†é”™ä½ã€‚æ¯”å¦‚æ­£å¸¸è‹±æ–‡æ–‡æœ¬ä¸­é¢‘ç‡æœ€é«˜çš„æ˜¯ eï¼Œè€ŒåŠ å¯†åå¯èƒ½å˜æˆäº† zã€‚é‚£ä¹ˆæŠŠæ­£å¸¸è‹±æ–‡æ–‡æœ¬çš„æ¦‚ç‡åˆ†å¸ƒå½“ä½œpï¼ŒæŠŠåŠ å¯†æ–‡æœ¬çš„æ¦‚ç‡åˆ†å¸ƒå½“ä½œqï¼Œå°±èƒ½å‘ç°å¯ä»¥åˆ©ç”¨åˆšæ‰å¼•å…¥çš„ç»“è®ºæ¥è¿›è¡Œçˆ†ç ´äº†ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#part2 ä¾æ®ä¸è‹±è¯­å­—é¢‘å»åˆæŒ‡æ•°æ‰¾å‡ºå…·ä½“çš„k1ã€k2</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">        <span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">            <span class="keyword">if</span> GCD(a,<span class="number">26</span>)!= <span class="number">1</span> :</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">                temp = cut(t,<span class="number">77</span>)</span><br><span class="line">                temp1 = [<span class="string">&quot;&quot;</span> <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">77</span>)]</span><br><span class="line">                <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(temp)-<span class="number">1</span>):</span><br><span class="line">                    temp1[i] += temp[k][i]</span><br><span class="line">                m = <span class="string">&#x27;&#x27;</span></span><br><span class="line">                <span class="keyword">for</span> x <span class="keyword">in</span> temp1[i]:</span><br><span class="line">                    m += table[((table.index(x)-b)*inverse(a,<span class="number">26</span>))%<span class="number">26</span>]</span><br><span class="line">                index = In_m(<span class="string">&quot;&quot;</span>.join(m))</span><br><span class="line">                <span class="comment">#print(index)</span></span><br><span class="line">                <span class="keyword">if</span>(index &gt; <span class="number">0.060</span>):</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;a = &quot;</span>,a,<span class="string">&quot;   b = &quot;</span>,b,<span class="string">&quot;,index = &quot;</span>,index)</span><br></pre></td></tr></table></figure>
<p>ä¹‹æ‰€ä»¥åªçˆ†ç ´11ä¸ªè€Œä¸çˆ†ç ´å…¨éƒ¨77ä¸ªï¼Œé“ç†ä¹Ÿå¾ˆç®€å•ï¼Œçˆ†ç ´11ä¸ªå·²ç»èƒ½å¤Ÿæ‰¾å‡ºå…¨éƒ¨çš„k1ã€k2äº†ã€‚</p>
<h5 id="part3ï¼šçˆ†ç ´md5"><a href="#part3ï¼šçˆ†ç ´md5" class="headerlink" title="part3ï¼šçˆ†ç ´md5"></a>part3ï¼šçˆ†ç ´md5</h5><p>çŸ¥é“äº†å¯†é’¥åå°±å¾ˆè½»æ¾ï¼Œå°±æ˜¯ä¸ªçº¯ç²¹çš„çˆ†ç ´é—®é¢˜äº†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#part3 çˆ†ç ´å¯†é’¥md5</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span>):</span><br><span class="line">    m = <span class="string">&quot;&quot;</span></span><br><span class="line">    k1 = [<span class="number">9</span>,<span class="number">7</span>,<span class="number">25</span>,<span class="number">11</span>,<span class="number">11</span>,<span class="number">19</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">25</span>,<span class="number">9</span>,<span class="number">7</span>]</span><br><span class="line">    k2 = [<span class="number">25</span>,<span class="number">19</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">25</span>,<span class="number">20</span>,<span class="number">8</span>]</span><br><span class="line">    a = <span class="number">11</span></span><br><span class="line">    b = <span class="number">7</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(t)):</span><br><span class="line">        temp = ((table.index(t[i])-k2[i%b])*inverse(k1[i%a],<span class="number">26</span>))%<span class="number">26</span></span><br><span class="line">        m += table[temp]</span><br><span class="line"></span><br><span class="line">    Pad = <span class="string">b&#x27;How_Interesting_the_Cryptography_Is&#x27;</span></span><br><span class="line">    MD5 = <span class="string">&#x27;196cf7098c7ea6e3e4d03691fb9d4f58&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)-i):</span><br><span class="line">            key = m[j:j+i]</span><br><span class="line">            <span class="keyword">if</span> (md5(key.encode()+Pad).hexdigest() == MD5):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;moectf&#123;&#x27;</span>+key+<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>å®Œæ•´expï¼š(è®°å¾—æ”¹ä¸€ä¸‹ifæ¡ä»¶)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&#x27;E:\vscode\cipher&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    c = f.read()</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line">table = ascii_lowercase</span><br><span class="line">dic = &#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">0.08167</span>,<span class="string">&#x27;b&#x27;</span>: <span class="number">0.01492</span>,<span class="string">&#x27;c&#x27;</span>: <span class="number">0.02782</span>,<span class="string">&#x27;d&#x27;</span>:<span class="number">0.04253</span>,<span class="string">&#x27;e&#x27;</span>: <span class="number">0.12702</span>,<span class="string">&#x27;f&#x27;</span>:<span class="number">0.02228</span>,<span class="string">&#x27;g&#x27;</span>: <span class="number">0.02015</span>,<span class="string">&#x27;h&#x27;</span>:<span class="number">0.06094</span>,<span class="string">&#x27;i&#x27;</span>:<span class="number">0.06966</span>,<span class="string">&#x27;j&#x27;</span>:<span class="number">0.00153</span>,<span class="string">&#x27;k&#x27;</span>:<span class="number">0.00772</span>,<span class="string">&#x27;l&#x27;</span>:<span class="number">0.04025</span>,<span class="string">&#x27;m&#x27;</span>:<span class="number">0.02406</span>,<span class="string">&#x27;n&#x27;</span>:<span class="number">0.06749</span>,<span class="string">&#x27;o&#x27;</span>:<span class="number">0.07507</span>,<span class="string">&#x27;p&#x27;</span>:<span class="number">0.01929</span>,<span class="string">&#x27;q&#x27;</span>:<span class="number">0.00095</span>,<span class="string">&#x27;r&#x27;</span>:<span class="number">0.05987</span>,<span class="string">&#x27;s&#x27;</span>:<span class="number">0.06327</span>,<span class="string">&#x27;t&#x27;</span>:<span class="number">0.09056</span>,<span class="string">&#x27;u&#x27;</span>:<span class="number">0.02758</span>,<span class="string">&#x27;v&#x27;</span>:<span class="number">0.00978</span>,<span class="string">&#x27;w&#x27;</span>:<span class="number">0.02360</span>,<span class="string">&#x27;x&#x27;</span>:<span class="number">0.00150</span>,<span class="string">&#x27;y&#x27;</span>:<span class="number">0.01974</span>,<span class="string">&#x27;z&#x27;</span>:<span class="number">0.00074</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#obj:å¾…åˆ†å‰²å­—ç¬¦ä¸²  #sec:åˆ†å‰²é•¿åº¦</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cut</span>(<span class="params">obj, sec</span>):</span><br><span class="line">    <span class="keyword">return</span> [obj[i:i+sec] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(obj),sec)]</span><br><span class="line"></span><br><span class="line"><span class="comment">#è®¡ç®—é‡åˆæŒ‡æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">In</span>(<span class="params">c</span>):</span><br><span class="line">    freq = &#123;i:<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> table&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(table)):</span><br><span class="line">        freq[table[i]] = c.count(table[i]) / <span class="built_in">len</span>(c)</span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> table:</span><br><span class="line">        index += freq[i] * freq[i]</span><br><span class="line">    <span class="keyword">return</span> index</span><br><span class="line"></span><br><span class="line"><span class="comment">#è®¡ç®—ä¸è‹±è¯­å­—é¢‘å»åˆæŒ‡æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">In_m</span>(<span class="params">c</span>):</span><br><span class="line">    freq = &#123;i:<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> table&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(table)):</span><br><span class="line">        freq[table[i]] = c.count(table[i]) / <span class="built_in">len</span>(c)</span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> table:</span><br><span class="line">        index += freq[i] * dic[i]</span><br><span class="line">    <span class="keyword">return</span> index</span><br><span class="line"></span><br><span class="line"><span class="comment">#part1 ä¾æ®é‡åˆæŒ‡æ•°æ‰¾å‡ºa*b=77</span></span><br><span class="line">t = c</span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">        temp = cut(t,i)</span><br><span class="line">        temp1 = [<span class="string">&quot;&quot;</span> <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(i)]</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(temp)-<span class="number">1</span>):</span><br><span class="line">            temp1[<span class="number">0</span>] += temp[k][<span class="number">0</span>]</span><br><span class="line">        index = In(<span class="string">&quot;&quot;</span>.join(temp1[<span class="number">0</span>]))</span><br><span class="line">        <span class="keyword">if</span>(index &gt; <span class="number">0.060</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;lenkey = &quot;</span>,i,<span class="string">&quot;   In = &quot;</span>,index)</span><br><span class="line"></span><br><span class="line"><span class="comment">#part2 ä¾æ®ä¸è‹±è¯­å­—é¢‘å»åˆæŒ‡æ•°æ‰¾å‡ºå…·ä½“çš„k1ã€k2</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">        <span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">            <span class="keyword">if</span> GCD(a,<span class="number">26</span>)!= <span class="number">1</span> :</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">                temp = cut(t,<span class="number">77</span>)</span><br><span class="line">                temp1 = [<span class="string">&quot;&quot;</span> <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">77</span>)]</span><br><span class="line">                <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(temp)-<span class="number">1</span>):</span><br><span class="line">                    temp1[i] += temp[k][i]</span><br><span class="line">                m = <span class="string">&#x27;&#x27;</span></span><br><span class="line">                <span class="keyword">for</span> x <span class="keyword">in</span> temp1[i]:</span><br><span class="line">                    m += table[((table.index(x)-b)*inverse(a,<span class="number">26</span>))%<span class="number">26</span>]</span><br><span class="line">                index = In_m(<span class="string">&quot;&quot;</span>.join(m))</span><br><span class="line">                <span class="comment">#print(index)</span></span><br><span class="line">                <span class="keyword">if</span>(index &gt; <span class="number">0.060</span>):</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;a = &quot;</span>,a,<span class="string">&quot;   b = &quot;</span>,b,<span class="string">&quot;,index = &quot;</span>,index)</span><br><span class="line"></span><br><span class="line"><span class="comment">#part3 çˆ†ç ´å¯†é’¥md5</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span>):</span><br><span class="line">    m = <span class="string">&quot;&quot;</span></span><br><span class="line">    k1 = [<span class="number">9</span>,<span class="number">7</span>,<span class="number">25</span>,<span class="number">11</span>,<span class="number">11</span>,<span class="number">19</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">25</span>,<span class="number">9</span>,<span class="number">7</span>]</span><br><span class="line">    k2 = [<span class="number">25</span>,<span class="number">19</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">25</span>,<span class="number">20</span>,<span class="number">8</span>]</span><br><span class="line">    a = <span class="number">11</span></span><br><span class="line">    b = <span class="number">7</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(t)):</span><br><span class="line">        temp = ((table.index(t[i])-k2[i%b])*inverse(k1[i%a],<span class="number">26</span>))%<span class="number">26</span></span><br><span class="line">        m += table[temp]</span><br><span class="line"></span><br><span class="line">    Pad = <span class="string">b&#x27;How_Interesting_the_Cryptography_Is&#x27;</span></span><br><span class="line">    MD5 = <span class="string">&#x27;196cf7098c7ea6e3e4d03691fb9d4f58&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)-i):</span><br><span class="line">            key = m[j:j+i]</span><br><span class="line">            <span class="keyword">if</span> (md5(key.encode()+Pad).hexdigest() == MD5):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;moectf&#123;&#x27;</span>+key+<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line">                exit()</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>moectf{pieceofchocolate}</strong></p>
<p>ä¸€ä¸ªå¾ˆçº¯ç²¹çš„å¤å…¸å¯†ç åˆ†æè¿‡ç¨‹ï¼Œå…¶å®æ˜¯éå¸¸æœ‰æ„æ€ä¹Ÿéå¸¸æœ‰ä»·å€¼çš„ã€‚</p>
<p><br><br></p>
]]></content>
      <categories>
        <category>cryptoè¶£é¢˜</category>
      </categories>
  </entry>
  <entry>
    <title>Cryptoè¶£é¢˜-å‰ªæ</title>
    <url>/post/342113ee.html</url>
    <content><![CDATA[<p>è¯¥æ–‡ç« ä¸»è¦è®°å½•ä¸€äº›æ·±æœå‰ªæç›¸å…³çš„è¶£é¢˜</p>
<span id="more"></span>
<h3 id="é¦–å°¾å‰ªæ"><a href="#é¦–å°¾å‰ªæ" class="headerlink" title="é¦–å°¾å‰ªæ"></a>é¦–å°¾å‰ªæ</h3><p>é¢˜ç›®æ¥æºï¼šæš‚ä¸æ˜ç¡®</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">256</span>)</span><br><span class="line">q = getPrime(<span class="number">256</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">_q = <span class="built_in">int</span>(<span class="built_in">bin</span>(q)[<span class="number">2</span>:][::-<span class="number">1</span>] , <span class="number">2</span>)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(p ^ _q)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">47761879279815109356923025519387920397647575481870870315845640832106405230526</span></span><br><span class="line"><span class="string">10310021142875344535823132048350287610122830618624222175188882916320750885684668357543070611134424902255744858233485983896082731376191044874283981089774677</span></span><br><span class="line"><span class="string">999963120986258459742830847940927620860107164857685447047839375819380831715400110131705491405902374029088041611909274341590559275004502111124764419485191</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><strong>å·²çŸ¥æ¡ä»¶ï¼š</strong></p>
<ul>
<li>p ä¸ q çš„åæ–¹å‘äºŒè¿›åˆ¶çš„å¼‚æˆ–å€¼ï¼Œå…±256bitï¼Œè®°ä¸ºpxorq</li>
</ul>
<p><strong>æœç´¢æ–¹å¼ï¼š</strong></p>
<ul>
<li><p>ä»ä¸¤ç«¯å‘ä¸­é—´æœç´¢</p>
</li>
<li><p>æ¯ä¸€æ¬¡æœç´¢ï¼Œéœ€åˆ©ç”¨å½“å‰ pxorq ä¸¤ç«¯çš„bitä½ã€‚è¿™æ˜¯å› ä¸ºï¼Œpxorq çš„å½“å‰æœ€é«˜ä½å¯¹åº”pçš„æœ€é«˜ä½åŠqçš„æœ€ä½ä½ï¼Œpxorq çš„å½“å‰æœ€ä½ä½å¯¹åº”pçš„æœ€ä½ä½åŠqçš„æœ€é«˜ä½ (å…¶ä¸­æœ€é«˜ã€æœ€ä½å‡æ˜¯å¯¹äºå½“å‰æœç´¢è€Œè¨€)</p>
</li>
<li>å¦‚æœå½“å‰éœ€æœç´¢çš„æœ€é«˜ä½ä¸ºâ€1â€ï¼Œåˆ™å¯¹åº”ä¸¤ç§å¯èƒ½ï¼špè¯¥ä½ä¸º1ï¼Œqå¯¹åº”ä½ä½ä¸º0ï¼›pè¯¥ä½ä¸º0ï¼Œqå¯¹åº”ä½ä½ä¸º1ã€‚å‰©ä¸‹ä¾æ­¤ç±»æ¨</li>
</ul>
<p><strong>å‰ªææ¡ä»¶ï¼š</strong></p>
<ul>
<li>å°†pã€qæœªæœç´¢åˆ°çš„ä½å…¨å¡«0ï¼Œä¹˜ç§¯åº”å°äºn</li>
<li>å°†pã€qæœªæœç´¢åˆ°çš„ä½å…¨å¡«1ï¼Œä¹˜ç§¯åº”å¤§äºn</li>
<li>pã€q ä½ k ä½ä¹˜ç§¯å†å–ä½ k ä½ï¼Œåº”ä¸ n çš„ä½ k ä½ç›¸åŒ</li>
</ul>
<p>å¦‚æ­¤è¿›è¡Œå‰ªæå³å¯ï¼š</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.setrecursionlimit(<span class="number">1500</span>)</span><br><span class="line"></span><br><span class="line">pxorq = <span class="number">47761879279815109356923025519387920397647575481870870315845640832106405230526</span></span><br><span class="line">n = <span class="number">10310021142875344535823132048350287610122830618624222175188882916320750885684668357543070611134424902255744858233485983896082731376191044874283981089774677</span></span><br><span class="line">c = <span class="number">999963120986258459742830847940927620860107164857685447047839375819380831715400110131705491405902374029088041611909274341590559275004502111124764419485191</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">pxorq = <span class="built_in">str</span>(<span class="built_in">bin</span>(pxorq)[<span class="number">2</span>:]).zfill(<span class="number">256</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find</span>(<span class="params">ph,qh,pl,ql</span>):</span><br><span class="line">    l = <span class="built_in">len</span>(ph)</span><br><span class="line">    tmp0 = ph + (<span class="number">256</span>-<span class="number">2</span>*l)*<span class="string">&quot;0&quot;</span> + pl</span><br><span class="line">    tmp1 = ph + (<span class="number">256</span>-<span class="number">2</span>*l)*<span class="string">&quot;1&quot;</span> + pl</span><br><span class="line">    tmq0 = qh + (<span class="number">256</span>-<span class="number">2</span>*l)*<span class="string">&quot;0&quot;</span> + ql</span><br><span class="line">    tmq1 = qh + (<span class="number">256</span>-<span class="number">2</span>*l)*<span class="string">&quot;1&quot;</span> + ql</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">int</span>(tmp0,<span class="number">2</span>)*<span class="built_in">int</span>(tmq0,<span class="number">2</span>) &gt; n):</span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">int</span>(tmp1,<span class="number">2</span>)*<span class="built_in">int</span>(tmq1,<span class="number">2</span>) &lt; n):</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">int</span>(pl,<span class="number">2</span>)*<span class="built_in">int</span>(ql,<span class="number">2</span>) % (<span class="number">2</span>**(l-<span class="number">1</span>)) != n % (<span class="number">2</span>**(l-<span class="number">1</span>))):</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(l == <span class="number">128</span>):</span><br><span class="line">        pp0 = <span class="built_in">int</span>(tmp0,<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span>(n % pp0 == <span class="number">0</span>):</span><br><span class="line">            pf = pp0</span><br><span class="line">            qf = n//pp0</span><br><span class="line">            phi = (pf-<span class="number">1</span>)*(qf-<span class="number">1</span>)</span><br><span class="line">            d = inverse(e,phi)</span><br><span class="line">            m1 = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(m1))</span><br><span class="line">            exit()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span>(pxorq[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> pxorq[<span class="number">255</span>-l] == <span class="string">&quot;1&quot;</span>):</span><br><span class="line">            find(ph+<span class="string">&quot;1&quot;</span>,qh+<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>+pl,<span class="string">&quot;0&quot;</span>+ql)</span><br><span class="line">            find(ph+<span class="string">&quot;0&quot;</span>,qh+<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>+pl,<span class="string">&quot;1&quot;</span>+ql)</span><br><span class="line">            find(ph+<span class="string">&quot;1&quot;</span>,qh+<span class="string">&quot;1&quot;</span>,<span class="string">&quot;0&quot;</span>+pl,<span class="string">&quot;0&quot;</span>+ql)</span><br><span class="line">            find(ph+<span class="string">&quot;0&quot;</span>,qh+<span class="string">&quot;1&quot;</span>,<span class="string">&quot;0&quot;</span>+pl,<span class="string">&quot;1&quot;</span>+ql)</span><br><span class="line">        <span class="keyword">elif</span>(pxorq[l] == <span class="string">&quot;1&quot;</span> <span class="keyword">and</span> pxorq[<span class="number">255</span>-l] == <span class="string">&quot;0&quot;</span>):</span><br><span class="line">            find(ph+<span class="string">&quot;1&quot;</span>,qh+<span class="string">&quot;0&quot;</span>,<span class="string">&quot;0&quot;</span>+pl,<span class="string">&quot;0&quot;</span>+ql)</span><br><span class="line">            find(ph+<span class="string">&quot;0&quot;</span>,qh+<span class="string">&quot;0&quot;</span>,<span class="string">&quot;0&quot;</span>+pl,<span class="string">&quot;1&quot;</span>+ql)</span><br><span class="line">            find(ph+<span class="string">&quot;1&quot;</span>,qh+<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>+pl,<span class="string">&quot;0&quot;</span>+ql)</span><br><span class="line">            find(ph+<span class="string">&quot;0&quot;</span>,qh+<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>+pl,<span class="string">&quot;1&quot;</span>+ql)</span><br><span class="line">        <span class="keyword">elif</span>(pxorq[l] == <span class="string">&quot;0&quot;</span> <span class="keyword">and</span> pxorq[<span class="number">255</span>-l] == <span class="string">&quot;1&quot;</span>):</span><br><span class="line">            find(ph+<span class="string">&quot;0&quot;</span>,qh+<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>+pl,<span class="string">&quot;0&quot;</span>+ql)</span><br><span class="line">            find(ph+<span class="string">&quot;0&quot;</span>,qh+<span class="string">&quot;1&quot;</span>,<span class="string">&quot;0&quot;</span>+pl,<span class="string">&quot;0&quot;</span>+ql)</span><br><span class="line">            find(ph+<span class="string">&quot;1&quot;</span>,qh+<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>+pl,<span class="string">&quot;1&quot;</span>+ql)</span><br><span class="line">            find(ph+<span class="string">&quot;1&quot;</span>,qh+<span class="string">&quot;1&quot;</span>,<span class="string">&quot;0&quot;</span>+pl,<span class="string">&quot;1&quot;</span>+ql)</span><br><span class="line">        <span class="keyword">elif</span>(pxorq[l] == <span class="string">&quot;0&quot;</span> <span class="keyword">and</span> pxorq[<span class="number">255</span>-l] == <span class="string">&quot;0&quot;</span>):</span><br><span class="line">            find(ph+<span class="string">&quot;0&quot;</span>,qh+<span class="string">&quot;0&quot;</span>,<span class="string">&quot;0&quot;</span>+pl,<span class="string">&quot;0&quot;</span>+ql)</span><br><span class="line">            find(ph+<span class="string">&quot;1&quot;</span>,qh+<span class="string">&quot;0&quot;</span>,<span class="string">&quot;0&quot;</span>+pl,<span class="string">&quot;1&quot;</span>+ql)</span><br><span class="line">            find(ph+<span class="string">&quot;0&quot;</span>,qh+<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>+pl,<span class="string">&quot;0&quot;</span>+ql)</span><br><span class="line">            find(ph+<span class="string">&quot;1&quot;</span>,qh+<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>+pl,<span class="string">&quot;1&quot;</span>+ql)</span><br><span class="line"></span><br><span class="line">find(<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<p><strong>flag{f55a2740-c15d-af88-1815-a1b4aab19ccf}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="ç‰¹æ®Šå‰ªæ"><a href="#ç‰¹æ®Šå‰ªæ" class="headerlink" title="ç‰¹æ®Šå‰ªæ"></a>ç‰¹æ®Šå‰ªæ</h3><p>é¢˜ç›®æ¥æºï¼šæš‚ä¸æ˜ç¡®</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p1 = sympy.randprime(<span class="number">2</span> ** <span class="number">1023</span>,<span class="number">2</span> ** <span class="number">1024</span>)</span><br><span class="line">q1 = sympy.randprime(<span class="number">2</span> ** <span class="number">1023</span>,<span class="number">2</span> ** <span class="number">1024</span>)</span><br><span class="line">a1 = p1 ^ q1</span><br><span class="line">b1 = p1 * q1</span><br><span class="line">c1 = <span class="built_in">pow</span>(bytes_to_long(flag[:<span class="number">19</span>]),e,p1*q1)</span><br><span class="line">p2 = sympy.randprime(<span class="number">2</span> ** <span class="number">511</span>, <span class="number">2</span> ** <span class="number">512</span>)</span><br><span class="line">q2 = sympy.randprime(<span class="number">2</span> ** <span class="number">511</span>, <span class="number">2</span> ** <span class="number">512</span>)</span><br><span class="line">a2 = (p2 * q2) ^ (p2 + q2)</span><br><span class="line">b2 = (p2 * q2) ^ (p2 - q2)</span><br><span class="line">c2 = <span class="built_in">pow</span>(bytes_to_long(flag[<span class="number">19</span>:]),e,p2*q2)</span><br><span class="line">f= <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(a1)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(b1)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(c1)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(a2)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(b2)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(c2)+<span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®txtï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a1=<span class="number">67739512154277162085770157687437441198363095490607019903179640765859289435128844487312739643781929328039885340492248268381181927215444058044731882600621443249379470235583032722854561171610662253187419453432598163528304052508578209017561499836803166110456130462444164049945234353225230736363194196935115979960</span></span><br><span class="line">b1=<span class="number">17185396829856546439605443867156437815015135756541052637907770783830686534153389303291740769607944691156059669175157827203495395745826694347428694508457493991041224390283763876476601200114028282946724348906485066220181559142937065978299071246507281834301352443856315199896106182934770582627129779923357891915723961923663378398066801894395956482176730300442901078199030200112352639266103862753546370851947797706641058966862813099369195689336228579744994641830699890792017097474275824545664085264972274642572927392940910981115837831275773192989084712813373293435228956787629490757407431010258942490818726318175944867633</span></span><br><span class="line">c1=<span class="number">2180773316568266715369209198734610509148388893757598741330158376506447322216176787253641696053169188685408469718202047474660716095850135317790263924418449270019680259700945680062960717565507426032265137192689118286560945331123730529355709043463330231284484658907466172538703301303440062783852136344472063837313195697915205569416630439851250171277336484771753816776835527532090668694986220968152676688392975798850738947165707984817923309381811015047150056144403783079156300625762879231698942313672034730244627530962258121618021680413439757194393609777357848156392150372631861473658135778661768208071991812674187273360</span></span><br><span class="line">a2=<span class="number">102834527596695950719979111423985349726489864165244791755647652205679952999516919199218636781810880771255724153293007819995198831162629014290926266777774940370836206596205967641213842702547665263659933022253549718321445029287279257463914991950587622466780705329578580061019164231870445205566240956950369224751</span></span><br><span class="line">b2=<span class="number">102834527596695950719979111423985349726489864165244791755647652205679952999516919199218636781810880771255724153293007819995198831162629014290926266777774949520538413350277489291427420271328741830415622921056457371226207219443304838109001023043838810016379140438034881290332449739051404396455209891630254998985</span></span><br><span class="line">c2=<span class="number">46285230821397377383998198689981002335902850753318921384068480704506522918467396194184971163720421808774010121239873784436865080818119851642074388303787396280596526597467664310187113430990219486840906481260493087443528880139543560763852844535689852804877233056126591516506599561944164619603448246607830867682</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥æ˜æ˜¾çœ‹å‡ºï¼Œé¢˜ç›®åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå‡æ˜¯åˆ©ç”¨å‰ªæï¼š</p>
<h4 id="ç¬¬ä¸€éƒ¨åˆ†ï¼š"><a href="#ç¬¬ä¸€éƒ¨åˆ†ï¼š" class="headerlink" title="ç¬¬ä¸€éƒ¨åˆ†ï¼š"></a>ç¬¬ä¸€éƒ¨åˆ†ï¼š</h4><p><strong>å·²çŸ¥æ¡ä»¶ï¼š</strong></p>
<ul>
<li>p1 ä¸ q1 çš„å¼‚æˆ–å€¼ï¼Œå…±1024bitï¼Œè®°ä¸ºa1</li>
</ul>
<p><strong>æœç´¢æ–¹å¼ï¼š</strong></p>
<ul>
<li><p>ä»é«˜ä½å‘ä½ä½æœç´¢</p>
</li>
<li><p>æ¯ä¸€æ¬¡æœç´¢ï¼Œéœ€åˆ©ç”¨å½“å‰ a1 çš„æœ€é«˜ä½</p>
</li>
<li>è‹¥å½“å‰ a1 çš„æœ€é«˜ä½ä¸ºâ€1â€ï¼Œåˆ™å¯¹åº”ä¸¤ç§å¯èƒ½ï¼špè¯¥ä½ä¸º1ï¼Œqè¯¥ä½ä¸º0ï¼›pè¯¥ä½ä¸º0ï¼Œqè¯¥ä½ä¸º1ã€‚å‰©ä¸‹ä¾æ­¤ç±»æ¨</li>
</ul>
<p><strong>å‰ªææ¡ä»¶ï¼š</strong></p>
<ul>
<li>å°†p1ã€q1æœªæœç´¢åˆ°çš„ä½å…¨å¡«0ï¼Œä¹˜ç§¯åº”å°äºn</li>
<li>å°†p1ã€q1æœªæœç´¢åˆ°çš„ä½å…¨å¡«1ï¼Œä¹˜ç§¯åº”å¤§äºn</li>
<li>p1 &gt; q1ï¼ˆè¿™æ˜¯å› ä¸ºï¼Œp1å’Œq1è‚¯å®šä¸€ä¸ªæ¯”å¦ä¸€ä¸ªå¤§ï¼Œå› æ­¤å¯ä»¥å‡å°‘ä¸€åŠå¤æ‚åº¦ï¼‰</li>
</ul>
<h4 id="ç¬¬äºŒéƒ¨åˆ†ï¼š"><a href="#ç¬¬äºŒéƒ¨åˆ†ï¼š" class="headerlink" title="ç¬¬äºŒéƒ¨åˆ†ï¼š"></a>ç¬¬äºŒéƒ¨åˆ†ï¼š</h4><p><strong>å·²çŸ¥æ¡ä»¶ï¼š</strong></p>
<ul>
<li>(p2 * q2)ä¸(p2 + q2)çš„å¼‚æˆ–å€¼ï¼Œè®°ä¸ºa2</li>
<li>(p2 * q2)ä¸(p2 - q2)çš„å¼‚æˆ–å€¼ï¼Œè®°ä¸ºb2</li>
</ul>
<p><strong>æœç´¢æ–¹å¼ï¼š</strong></p>
<ul>
<li><p>ä»ä½ä½å‘é«˜ä½æœç´¢</p>
</li>
<li><p>æ¯ä¸€æ¬¡æœç´¢ï¼Œéœ€åˆ©ç”¨å½“å‰ a2ã€b2 çš„æœ€ä½ä½</p>
</li>
<li>ç¡¬æœç´¢å½“å‰ä½çš„æ‰€æœ‰å››ç§å¯èƒ½ï¼š00ã€01ã€10ã€11</li>
</ul>
<p><strong>å‰ªææ¡ä»¶ï¼š</strong></p>
<ul>
<li>è‹¥å½“å‰å·²æœç´¢äº† k ä½ï¼Œåˆ™éœ€æ»¡è¶³ï¼š</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">t1 = (<span class="built_in">int</span>(p,<span class="number">2</span>)*<span class="built_in">int</span>(q,<span class="number">2</span>))</span><br><span class="line">t2 = (<span class="built_in">int</span>(p,<span class="number">2</span>)+<span class="built_in">int</span>(q,<span class="number">2</span>))</span><br><span class="line">t3 = (<span class="built_in">int</span>(p,<span class="number">2</span>)-<span class="built_in">int</span>(q,<span class="number">2</span>))</span><br><span class="line">mask = <span class="number">2</span>**k-<span class="number">1</span></span><br><span class="line"></span><br><span class="line">((t1^t2)&amp;mask) == (a2&amp;mask) <span class="keyword">and</span> ((t1^t3)&amp;mask) == (b2&amp;mask)</span><br></pre></td></tr></table></figure>
<p>æŒ‰ç…§æ­¤æ–¹å¼å°±å¯ä»¥é€’å½’æ·±æœå‡ºp2ã€q2</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.setrecursionlimit(<span class="number">1500</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#part1,å‰ªæ</span></span><br><span class="line">a1=<span class="number">67739512154277162085770157687437441198363095490607019903179640765859289435128844487312739643781929328039885340492248268381181927215444058044731882600621443249379470235583032722854561171610662253187419453432598163528304052508578209017561499836803166110456130462444164049945234353225230736363194196935115979960</span></span><br><span class="line">b1=<span class="number">17185396829856546439605443867156437815015135756541052637907770783830686534153389303291740769607944691156059669175157827203495395745826694347428694508457493991041224390283763876476601200114028282946724348906485066220181559142937065978299071246507281834301352443856315199896106182934770582627129779923357891915723961923663378398066801894395956482176730300442901078199030200112352639266103862753546370851947797706641058966862813099369195689336228579744994641830699890792017097474275824545664085264972274642572927392940910981115837831275773192989084712813373293435228956787629490757407431010258942490818726318175944867633</span></span><br><span class="line">c1=<span class="number">2180773316568266715369209198734610509148388893757598741330158376506447322216176787253641696053169188685408469718202047474660716095850135317790263924418449270019680259700945680062960717565507426032265137192689118286560945331123730529355709043463330231284484658907466172538703301303440062783852136344472063837313195697915205569416630439851250171277336484771753816776835527532090668694986220968152676688392975798850738947165707984817923309381811015047150056144403783079156300625762879231698942313672034730244627530962258121618021680413439757194393609777357848156392150372631861473658135778661768208071991812674187273360</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">a1 = <span class="string">&quot;0&quot;</span> + <span class="built_in">str</span>(<span class="built_in">bin</span>(a1)[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find</span>(<span class="params">p,q</span>):</span><br><span class="line">    l = <span class="built_in">len</span>(p)</span><br><span class="line">    tmp0 = p + (<span class="number">1024</span>-l)*<span class="string">&quot;0&quot;</span></span><br><span class="line">    tmp1 = p + (<span class="number">1024</span>-l)*<span class="string">&quot;1&quot;</span></span><br><span class="line">    tmq0 = q + (<span class="number">1024</span>-l)*<span class="string">&quot;0&quot;</span></span><br><span class="line">    tmq1 = q + (<span class="number">1024</span>-l)*<span class="string">&quot;1&quot;</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">int</span>(tmp0,<span class="number">2</span>) &lt; <span class="built_in">int</span>(tmq0,<span class="number">2</span>)):</span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">int</span>(tmp0,<span class="number">2</span>)*<span class="built_in">int</span>(tmq0,<span class="number">2</span>) &gt; b1):</span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    <span class="keyword">elif</span>(<span class="built_in">int</span>(tmp1,<span class="number">2</span>)*<span class="built_in">int</span>(tmq1,<span class="number">2</span>) &lt; b1):</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(l == <span class="number">1024</span>):</span><br><span class="line">        pp = <span class="built_in">int</span>(tmp0,<span class="number">2</span>)</span><br><span class="line">        qq = <span class="built_in">int</span>(tmq0,<span class="number">2</span>)</span><br><span class="line">        d = inverse(e,(pp-<span class="number">1</span>)*(qq-<span class="number">1</span>))</span><br><span class="line">        m = long_to_bytes(<span class="built_in">pow</span>(c1,d,pp*qq))</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(m)[<span class="number">2</span>:-<span class="number">1</span>],end = <span class="string">&quot;&quot;</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span>(a1[l] == <span class="string">&quot;1&quot;</span>):</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            find(p+<span class="string">&quot;0&quot;</span>,q+<span class="string">&quot;0&quot;</span>)</span><br><span class="line">            find(p+<span class="string">&quot;1&quot;</span>,q+<span class="string">&quot;1&quot;</span>)</span><br><span class="line"></span><br><span class="line">tempp = <span class="string">&quot;&quot;</span></span><br><span class="line">tempq = <span class="string">&quot;&quot;</span></span><br><span class="line">find(tempp,tempq)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#part2 ç¡¬å‰ªæ</span></span><br><span class="line">a2=<span class="number">102834527596695950719979111423985349726489864165244791755647652205679952999516919199218636781810880771255724153293007819995198831162629014290926266777774940370836206596205967641213842702547665263659933022253549718321445029287279257463914991950587622466780705329578580061019164231870445205566240956950369224751</span></span><br><span class="line">b2=<span class="number">102834527596695950719979111423985349726489864165244791755647652205679952999516919199218636781810880771255724153293007819995198831162629014290926266777774949520538413350277489291427420271328741830415622921056457371226207219443304838109001023043838810016379140438034881290332449739051404396455209891630254998985</span></span><br><span class="line">c2=<span class="number">46285230821397377383998198689981002335902850753318921384068480704506522918467396194184971163720421808774010121239873784436865080818119851642074388303787396280596526597467664310187113430990219486840906481260493087443528880139543560763852844535689852804877233056126591516506599561944164619603448246607830867682</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find</span>(<span class="params">p,q,k</span>):</span><br><span class="line">    mask = <span class="number">2</span>**k-<span class="number">1</span></span><br><span class="line"></span><br><span class="line">    t1 = (<span class="built_in">int</span>(p,<span class="number">2</span>)*<span class="built_in">int</span>(q,<span class="number">2</span>))</span><br><span class="line">    t2 = (<span class="built_in">int</span>(p,<span class="number">2</span>)+<span class="built_in">int</span>(q,<span class="number">2</span>))</span><br><span class="line">    t3 = (<span class="built_in">int</span>(p,<span class="number">2</span>)-<span class="built_in">int</span>(q,<span class="number">2</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">len</span>(<span class="built_in">bin</span>(<span class="built_in">int</span>(p,<span class="number">2</span>))[<span class="number">2</span>:]) == <span class="number">512</span> <span class="keyword">and</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(<span class="built_in">int</span>(q,<span class="number">2</span>))[<span class="number">2</span>:]) == <span class="number">512</span>):</span><br><span class="line">        pp = <span class="built_in">int</span>(p,<span class="number">2</span>)</span><br><span class="line">        qq = <span class="built_in">int</span>(q,<span class="number">2</span>)</span><br><span class="line">        d = inverse(e,(pp-<span class="number">1</span>)*(qq-<span class="number">1</span>))</span><br><span class="line">        m = long_to_bytes(<span class="built_in">pow</span>(c2,d,pp*qq))</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">len</span>(m) &lt; <span class="number">20</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(m)[<span class="number">2</span>:-<span class="number">1</span>])</span><br><span class="line">            exit()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(((t1^t2)&amp;mask) == (a2&amp;mask) <span class="keyword">and</span> ((t1^t3)&amp;mask) == (b2&amp;mask)):</span><br><span class="line">        find(<span class="string">&quot;0&quot;</span>+p,<span class="string">&quot;0&quot;</span>+q,k+<span class="number">1</span>)</span><br><span class="line">        find(<span class="string">&quot;0&quot;</span>+p,<span class="string">&quot;1&quot;</span>+q,k+<span class="number">1</span>)</span><br><span class="line">        find(<span class="string">&quot;1&quot;</span>+p,<span class="string">&quot;0&quot;</span>+q,k+<span class="number">1</span>)</span><br><span class="line">        find(<span class="string">&quot;1&quot;</span>+p,<span class="string">&quot;1&quot;</span>+q,k+<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">p = <span class="string">&quot;1&quot;</span></span><br><span class="line">q = <span class="string">&quot;1&quot;</span></span><br><span class="line"></span><br><span class="line">find(p,q,<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>å¤§æ¦‚éœ€è¦åå‡ ç§’ã€‚</p>
<p>flagï¼š</p>
<p><strong>flag{u2w6tnettv2a9fbo5qh73k8082h2q9j3}</strong></p>
<p><br></p>
<p><br></p>
]]></content>
      <categories>
        <category>cryptoè¶£é¢˜</category>
      </categories>
  </entry>
  <entry>
    <title>Cryptoè¶£é¢˜-æ›²çº¿</title>
    <url>/post/187210a7.html</url>
    <content><![CDATA[<p>è¯¥æ–‡ç« ä¸»è¦è®°å½•ä¸€äº›æ›²çº¿ç›¸å…³çš„è¶£é¢˜</p>
<span id="more"></span>
<h3 id="EdRSA"><a href="#EdRSA" class="headerlink" title="EdRSA"></a>EdRSA</h3><p>é¢˜ç›®æ¥æºï¼šæš‚ä¸æ˜ç¡®</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sagemath</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">P, Q</span>):</span><br><span class="line">    (x1, y1) = P</span><br><span class="line">    (x2, y2) = Q</span><br><span class="line"></span><br><span class="line">    x3 = (x1*y2 + y1*x2) * inverse(<span class="number">1</span> + d*x1*x2*y1*y2, p) % p</span><br><span class="line">    y3 = (y1*y2 - a*x1*x2) * inverse(<span class="number">1</span> - d*x1*x2*y1*y2, p) % p</span><br><span class="line">    <span class="keyword">return</span> (x3, y3)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">x, P</span>):</span><br><span class="line">    Q = (<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span> x &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> x % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">            Q = add(Q, P)</span><br><span class="line">        P = add(P, P)</span><br><span class="line">        x = x &gt;&gt; <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> Q</span><br><span class="line"></span><br><span class="line">p = <span class="number">64141017538026690847507665744072764126523219720088055136531450296140542176327</span></span><br><span class="line">a = <span class="number">362</span></span><br><span class="line">d = <span class="number">7</span></span><br><span class="line">gx=bytes_to_long(flag)</span><br><span class="line">PR.&lt;y&gt;=PolynomialRing(Zmod(p))</span><br><span class="line">f=(d*gx^<span class="number">2</span>-<span class="number">1</span>)*y^<span class="number">2</span>+(<span class="number">1</span>-a*gx^<span class="number">2</span>)</span><br><span class="line">gy=<span class="built_in">int</span>(f.roots()[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> (a*gx^<span class="number">2</span>+gy^<span class="number">2</span>)%p==(<span class="number">1</span>+d*gx^<span class="number">2</span>*gy^<span class="number">2</span>)%p</span><br><span class="line"></span><br><span class="line">G=(gx,gy)</span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;eG = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(mul(e, G)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#eG = (602246821311345089174443402780402388933602410138142480089649941718527311147, 17625197557740535449294773567986004828160284887369041337984750097736030549853)</span></span><br></pre></td></tr></table></figure>
<p>ç®€å•çœ‹ä¸€ä¸‹é¢˜ç›®æµç¨‹ï¼Œé¢˜ç›®å®šä¹‰äº†ä¸€ä¸ªæœ‰é™åŸŸä¸Šä¸€æ¡æ›²çº¿çš„ç‚¹åŠ å’Œç‚¹ä¹˜æ“ä½œï¼Œå…¶ä¸­æ›²çº¿å½¢å¼ä¸ºï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">assert</span> (a*gx^<span class="number">2</span>+gy^<span class="number">2</span>)%p==(<span class="number">1</span>+d*gx^<span class="number">2</span>*gy^<span class="number">2</span>)%p</span><br></pre></td></tr></table></figure>
<p>å†™å‡ºè¡¨è¾¾å¼å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
ax^2+y^2 = 1+dx^2y^2\quad(mod\;p)</script><p>æœç´¢ä¸€ä¸‹ï¼Œå‘ç°è¿™æ˜¯æ ‡å‡†å‹çš„æ‰­æ›²çˆ±å¾·åæ›²çº¿ï¼š(Twisted Edwards Curves)</p>
<p><a href="https://lazzzaro.github.io/2021/01/20/crypto-æ›²çº¿/">æ›²çº¿ | Lazzaro (lazzzaro.github.io)</a></p>
<p>è€Œä»”ç»†æ ¸å¯¹ä¸€ä¸‹ç‚¹åŠ ä¸ç‚¹ä¹˜ï¼Œå‘ç°éƒ½æ˜¯å®Œå…¨å¯¹çš„ä¸Šçš„ã€‚å› æ­¤é—®é¢˜å°±è½¬åŒ–ä¸ºï¼Œå·²çŸ¥Edcurveä¸Šçš„ä¸€ä¸ªeå€ç‚¹ï¼Œæ±‚è§£è¯¥eå€ç‚¹å¯¹åº”çš„åŸç‚¹Gçš„æ¨ªåæ ‡ï¼Œå³ä¸ºflagã€‚</p>
<p>æƒ³ä¸€æƒ³ï¼Œå¦‚æœè¿™æ˜¯ä¸€æ¡å¸¸è§å½¢å¼çš„æ¤­åœ†æ›²çº¿ï¼Œæ±‚è§£æ–¹å¼æ˜¯ä»€ä¹ˆï¼Ÿæ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ul>
<li>ç”¨sageä¸­çš„order()å‡½æ•°æ±‚è§£å‡ºè¯¥æ¤­åœ†æ›²çº¿çš„é˜¶n</li>
<li>æ±‚å‡ºeå…³äºé˜¶nçš„é€†å…ƒï¼Œè®°ä¸ºt</li>
<li>æ±‚å€ç‚¹G=t*(eG)ï¼Œæ¨ªåæ ‡å³ä¸ºæ‰€æ±‚</li>
</ul>
<p>é‚£ä¹ˆå†å›å¤´ï¼Œè¿™ä¸ªæ±‚è§£è¿‡ç¨‹å¯¹äºEdcurveè‚¯å®šä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œä¸è¿‡é—®é¢˜å°±åœ¨äºï¼Œsageä¸­æ²¡æœ‰åŠæ³•ç›´æ¥æ±‚å‡ºEdcurveè¿™ç§å½¢å¼çš„æ›²çº¿çš„é˜¶ï¼Œå› æ­¤ç¡®å®šæ€è·¯ï¼š</p>
<ul>
<li>å°†Edcurveé€šè¿‡æ¢å…ƒæ˜ å°„ï¼Œå˜æ¢ä¸ºå¸¸è§çš„æ¤­åœ†æ›²çº¿çš„å½¢å¼</li>
<li>æ±‚è§£å‡ºå¯¹åº”æ¤­åœ†æ›²çº¿çš„é˜¶ï¼Œè®°ä¸ºs</li>
<li>æ±‚å€ç‚¹Gâ€™ = s*(eGâ€™)</li>
<li>å°†æ±‚è§£å‡ºçš„Gâ€™å†å˜æ¢å›Edcurveä¸Šå¾—åˆ°Gï¼Œå…¶æ¨ªåæ ‡å³ä¸ºæ‰€æ±‚</li>
</ul>
<p>å› æ­¤éš¾ç‚¹å°±åœ¨äºå¦‚ä½•é€šè¿‡æ¢å…ƒè¿›è¡Œæ›²çº¿æ˜ å°„ï¼Œè¿™é‡Œé™ˆè¿°ä¸€ä¸‹æ¢å…ƒè¿‡ç¨‹ï¼š<strong>(ä»¥ä¸‹é™¤æ³•å‡ä¸ºæœ‰é™åŸŸä¸Šé™¤æ³•ï¼Œå³ä¹˜é€†å…ƒ)</strong></p>
<p><strong>ç¬¬ä¸€æ­¥ï¼š</strong>è½¬åŒ–ä¸ºè’™å“¥é©¬åˆ©æ›²çº¿æ–¹ç¨‹(Montgomery)ï¼š</p>
<p>å‚è€ƒï¼š<a href="https://christianepeters.files.wordpress.com/2012/10/20080620-rennes.pdf">Edwards Curves (wordpress.com)</a></p>
<script type="math/tex; mode=display">
x' = \frac{1+y}{1-y}</script><script type="math/tex; mode=display">
y'=\frac{1+y}{x(1-y)}</script><script type="math/tex; mode=display">
B=\frac{4}{a-d}</script><script type="math/tex; mode=display">
A=\frac{2(a+d)}{a-d}</script><p>ä»£å…¥åˆ°Edcurveçš„æ›²çº¿æ–¹ç¨‹ä¹‹åï¼Œæ›²çº¿ä¼šè½¬åŒ–ä¸ºè’™å“¥é©¬åˆ©æ›²çº¿ï¼Œå…¶æ–¹ç¨‹å½¢å¼å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
B(y')^2 = (x')^3+A(x')^2+(x')\quad(mod\;p)</script><p><strong>ç¬¬äºŒæ­¥ï¼š</strong>è½¬åŒ–ä¸ºæ¤­åœ†æ›²çº¿æ–¹ç¨‹(Weierstrass)ï¼š</p>
<p>å‚è€ƒï¼š<a href="https://en.wikipedia.org/wiki/Montgomery_curve">Montgomery curve - Wikipedia</a></p>
<script type="math/tex; mode=display">
x'' = \frac{3x'+A}{3B}</script><script type="math/tex; mode=display">
y''=\frac{y'}{B}</script><script type="math/tex; mode=display">
a=\frac{3-A^2}{3B^2}</script><script type="math/tex; mode=display">
b=\frac{2A^3-9A}{27B^3}</script><p>æ­¤æ—¶è’™å“¥é©¬åˆ©æ›²çº¿å°±å˜æˆäº†æ¤­åœ†æ›²çº¿æ–¹ç¨‹å½¢å¼ï¼š</p>
<script type="math/tex; mode=display">
(y'')^2 = (x'')^3+a(x'')+b\quad(mod\;p)</script><p>ç„¶åæ±‚è¯¥æ›²çº¿çš„é˜¶ï¼Œä»è€Œæ±‚è§£å‡ºè¿œåŸç‚¹Gï¼Œå¹¶ä¸”é‡æ–°é€†å˜æ¢å›Edcurveï¼Œå¾—åˆ°çš„æ¨ªåæ ‡å³ä¸ºflagã€‚</p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p = <span class="number">64141017538026690847507665744072764126523219720088055136531450296140542176327</span></span><br><span class="line">a = <span class="number">362</span></span><br><span class="line">d = <span class="number">7</span></span><br><span class="line">c = <span class="number">1</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">P, Q</span>):</span><br><span class="line">    (x1, y1) = P</span><br><span class="line">    (x2, y2) = Q</span><br><span class="line"></span><br><span class="line">    x3 = (x1*y2 + y1*x2) * inverse(<span class="number">1</span> + d*x1*x2*y1*y2, p) % p</span><br><span class="line">    y3 = (y1*y2 - a*x1*x2) * inverse(<span class="number">1</span> - d*x1*x2*y1*y2, p) % p</span><br><span class="line">    <span class="keyword">return</span> (x3, y3)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">x, P</span>):</span><br><span class="line">    Q = (<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span> x &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> x % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">            Q = add(Q, P)</span><br><span class="line">        P = add(P, P)</span><br><span class="line">        x = x &gt;&gt; <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> Q</span><br><span class="line"></span><br><span class="line">P.&lt;z&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">aa = a</span><br><span class="line">dd = (d*c^<span class="number">4</span>)%p</span><br><span class="line">J = (<span class="number">2</span>*(aa+dd)*inverse(aa-dd,p))%p</span><br><span class="line">K = (<span class="number">4</span>*inverse(aa-dd,p))%p</span><br><span class="line">A = ((<span class="number">3</span>-J^<span class="number">2</span>)*inverse(<span class="number">3</span>*K^<span class="number">2</span>,p))%p</span><br><span class="line">B = ((<span class="number">2</span>*J^<span class="number">3</span>-<span class="number">9</span>*J)*inverse(<span class="number">27</span>*K^<span class="number">3</span>,p))%p</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span>  P(z^<span class="number">3</span>+A*z+B).roots():</span><br><span class="line">    alpha = <span class="built_in">int</span>(i[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> P(z^<span class="number">2</span>-(<span class="number">3</span>*alpha^<span class="number">2</span>+A)).roots():</span><br><span class="line">        s = <span class="built_in">int</span>(j[<span class="number">0</span>])</span><br><span class="line">        s = inverse(s, p)</span><br><span class="line">        <span class="keyword">if</span> J==alpha*<span class="number">3</span>*s%p:</span><br><span class="line">            Alpha = alpha</span><br><span class="line">            S = s</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">twist_to_weier</span>(<span class="params">x,y</span>):</span><br><span class="line">    v = x*inverse(c,p)%p</span><br><span class="line">    w = y*inverse(c,p)%p</span><br><span class="line">    <span class="keyword">assert</span> (aa*v^<span class="number">2</span>+w^<span class="number">2</span>)%p==(<span class="number">1</span>+dd*v^<span class="number">2</span>*w^<span class="number">2</span>)%p</span><br><span class="line">    s = (<span class="number">1</span>+w)*inverse(<span class="number">1</span>-w,p)%p</span><br><span class="line">    t = s*inverse(v,p)%p</span><br><span class="line">    <span class="keyword">assert</span> (K*t^<span class="number">2</span>)%p==(s^<span class="number">3</span>+J*s^<span class="number">2</span>+s)%p</span><br><span class="line">    xW = (<span class="number">3</span>*s+J) * inverse(<span class="number">3</span>*K, p) % p</span><br><span class="line">    yW = t * inverse(K, p) % p</span><br><span class="line">    <span class="keyword">assert</span> yW^<span class="number">2</span> % p == (xW^<span class="number">3</span>+A*xW+B) % p</span><br><span class="line">    <span class="keyword">return</span> (xW,yW)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">weier_to_twist</span>(<span class="params">x,y</span>):</span><br><span class="line">    xM=S*(x-Alpha)%p</span><br><span class="line">    yM=S*y%p</span><br><span class="line">    <span class="keyword">assert</span> (K*yM^<span class="number">2</span>)%p==(xM^<span class="number">3</span>+J*xM^<span class="number">2</span>+xM)%p</span><br><span class="line">    xe = xM*inverse(yM,p)%p</span><br><span class="line">    ye = (xM-<span class="number">1</span>)*inverse(xM+<span class="number">1</span>,p)%p</span><br><span class="line">    <span class="keyword">assert</span> (aa*xe^<span class="number">2</span>+ye^<span class="number">2</span>)%p==(<span class="number">1</span>+dd*xe^<span class="number">2</span>*ye^<span class="number">2</span>)%p</span><br><span class="line">    xq = xe*c%p</span><br><span class="line">    yq = ye*c%p</span><br><span class="line">    <span class="keyword">assert</span> (a*xq^<span class="number">2</span>+yq^<span class="number">2</span>)%p==c^<span class="number">2</span>*(<span class="number">1</span>+d*xq^<span class="number">2</span>*yq^<span class="number">2</span>)%p</span><br><span class="line">    <span class="keyword">return</span> (xq,yq)</span><br><span class="line"> </span><br><span class="line">E = EllipticCurve(GF(p), [A, B])</span><br><span class="line">order = E.order()</span><br><span class="line">eG = (<span class="number">602246821311345089174443402780402388933602410138142480089649941718527311147</span>, <span class="number">17625197557740535449294773567986004828160284887369041337984750097736030549853</span>)</span><br><span class="line">eG = twist_to_weier(<span class="number">602246821311345089174443402780402388933602410138142480089649941718527311147</span>, <span class="number">17625197557740535449294773567986004828160284887369041337984750097736030549853</span>)</span><br><span class="line"><span class="comment">#print(eG)</span></span><br><span class="line">eG = E(eG)</span><br><span class="line">t = inverse(e,order)</span><br><span class="line">G = t*eG</span><br><span class="line"><span class="comment">#print(G)</span></span><br><span class="line"><span class="comment">#(36261107889873779109466209751550197981810668464592052789439409682189116521876 , 28177359502202272008748289223947413248814289299639597442379536527477393059697)</span></span><br><span class="line">G = weier_to_twist(<span class="number">36261107889873779109466209751550197981810668464592052789439409682189116521876</span> , <span class="number">28177359502202272008748289223947413248814289299639597442379536527477393059697</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(G[<span class="number">0</span>])))</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>DASCTF{y0u_kn0w_edcurv3_w3LL!!}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="EC-Party-I"><a href="#EC-Party-I" class="headerlink" title="EC_Party-I"></a>EC_Party-I</h3><p>é¢˜ç›®æ¥æºï¼šâ€œåä¸ºæ¯â€ç¬¬äºŒå±Šä¸­å›½ç ”ç©¶ç”Ÿç½‘ç»œå®‰å…¨åˆ›æ–°å¤§èµ›</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">5</span>]==<span class="string">b&#x27;flag&#123;&#x27;</span> <span class="keyword">and</span> flag[-<span class="number">1</span>:]==<span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line">flag = flag[<span class="number">5</span>:-<span class="number">1</span>]</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rabin</span>(<span class="params">m</span>):</span><br><span class="line">    m = m+os.urandom(<span class="number">32</span>)</span><br><span class="line">    p = getPrime(<span class="number">384</span>)</span><br><span class="line">    q = getPrime(<span class="number">384</span>)</span><br><span class="line">    Fp = GF(p)</span><br><span class="line">    Fq = GF(q)</span><br><span class="line">    n = p*q</span><br><span class="line">    e = <span class="number">2</span></span><br><span class="line">    a = random.randint(<span class="number">0</span>, p-<span class="number">1</span>)</span><br><span class="line">    b = random.randint(<span class="number">0</span>, p-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    Ep = EllipticCurve(Zmod(p), [a, b])</span><br><span class="line">    Eq = EllipticCurve(Zmod(q), [a, b])</span><br><span class="line">    En = EllipticCurve(Zmod(n), [a, b])</span><br><span class="line">    ord_p = Ep.order()</span><br><span class="line">    ord_q = Eq.order()</span><br><span class="line"></span><br><span class="line">    xm = bytes_to_long(m)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            Gp = Ep.lift_x(Fp(xm))</span><br><span class="line">            Gq = Eq.lift_x(Fq(xm))</span><br><span class="line">            ym = crt([<span class="built_in">int</span>(Gp.xy()[<span class="number">1</span>]),<span class="built_in">int</span>(Gq.xy()[<span class="number">1</span>])],[p,q])</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> :</span><br><span class="line">            xm += <span class="number">1</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    M = En((xm,ym))</span><br><span class="line">    C = e*M</span><br><span class="line">    pk = [a, b, n, C]</span><br><span class="line">    leak = ord_p*ord_q</span><br><span class="line">    <span class="keyword">return</span> pk, leak</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(rabin(flag))</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">[138681122158674534796479818810828100269024674330030901179877002756402543027343312824423418859769980312713625658733, 4989541340743108588577899263469059346332852532421276369038720203527706762720292559751463880310075002363945271507040, 762981334990685089884160169295988791471426441106522959345412318178660817286272606245181160960267776171409174142433857335352402619564485470678152764621235882232914864951345067231483720755544188962798600739631026707678945887174897543, (19591102741441427006422487362547101973286873135330241799412389205281057650306427438686318050682578531286702107543065985988634367524715153650482199099194389191525898366546842016339136884277515665890331906261550080128989942048438965, 728465071542637655949094554469510039681717865811604984652385614821789556549826602178972137405550902004858456181137844771163710123158955524137202319902378503104952106036911634918189377295743976966073577013775200078470659428344462772), 762981334990685089884160169295988791471426441106522959345445792076415993922016249232021560266153453470937452118572318136597282436269660557904217923887981072203978473274822142705255987334355747997513083011853917049784914749699536828]</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>æ¢³ç†é¢˜ç›®åŠ å¯†æµç¨‹ï¼š</p>
<ul>
<li>é¢˜ç›®å°†flagè½¬åŒ–æˆå¤§æ•´æ•°åï¼Œè½¬åŒ–ä¸ºåŸºç‚¹Mçš„æ¨ªåæ ‡</li>
<li>ç”Ÿæˆä¸¤ä¸ªå¤§ç´ æ•°pã€qï¼Œn=p*q</li>
<li>ç”Ÿæˆéšæœºæ•°aã€bï¼Œå¹¶ä»¥æ­¤ç”Ÿæˆä¸‰æ¡æ¤­åœ†æ›²çº¿Epã€Eqã€En</li>
<li>æ±‚å‡ºåŸºç‚¹Måœ¨Epã€Eqä¸Šçš„å€ç‚¹ï¼Œå¹¶ç”¨ä¸­å›½å‰©ä½™å®šç†æ±‚å‡ºç»„åˆåçš„çºµåæ ‡</li>
<li>ç»™å‡ºæ³„éœ²ä¿¡æ¯leak=order(Ep)*order(Eq)</li>
</ul>
<p>é‚£ä¹ˆæ˜¾ç„¶å¦‚æœèƒ½è·å¾—nçš„åˆ†è§£ï¼Œé¢˜ç›®å°±æ²¡æœ‰éš¾åº¦äº†ï¼Œè€Œæ³„æ¼çš„leakå°±æ˜¯nçš„åˆ†è§£çš„é‡è¦ä¾æ®ã€‚å…¶å…·ä½“åŸç†å¯ä»¥å‚è€ƒï¼š(å› ä¸ºæˆ‘å…¶å®ä¹Ÿå¹¶æ²¡æœ‰ç†è§£æ¸…æ¥š)</p>
<p><a href="https://github.com/maple3142/My-CTF-Challenges/blob/master/HITCON CTF 2022/Chimera/README.md">My-CTF-Challenges/HITCON CTF 2022/Chimera/README.md at master Â· maple3142/My-CTF-Challenges (github.com)</a></p>
<p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å…ˆè·å¾—leakçš„å› å¼åˆ†è§£ï¼š</p>
<p><img src="/post/187210a7/image-20230930114139546.png" alt="image-20230930114139546"></p>
<p>ç”±äºleak=order(Ep)*order(Eq)ï¼Œå› æ­¤leakä¹˜ä»»ä½•ç‚¹éƒ½åº”è¯¥æ˜¯Enã€Epã€Eqçš„å…±åŒOç‚¹(æ— ç©·è¿œç‚¹)ï¼Œä½†æ˜¯å°†leakæŒ¨ä¸ªé™¤ä»¥å…¶å› å­ï¼Œå†ä¸Cç‚¹ç›¸ä¹˜ï¼Œå°±å¯èƒ½ä¼šäº§ç”Ÿå€ç‚¹åœ¨Epä¸Šï¼Œè€Œä¸åœ¨Eqä¸Šçš„æƒ…å†µï¼Œè¿™ä¼šä½¿æ±‚è§£å…³äºnçš„é€†å…ƒä¸å­˜åœ¨ï¼Œsageä¾¿ä¼šåœ¨è¿™æ—¶æŠ›å‡ºä¸€ä¸ªæŠ¥é”™ï¼Œè€Œåœ¨æŠ¥é”™ä¿¡æ¯ä¸­å°±èƒ½çœ‹åˆ°kpä»¥åŠnçš„åˆ†è§£ï¼š(è¿™æ˜¯æˆ‘çš„ç†è§£ï¼Œå¦‚æœæœ‰ä¸å¯¹çš„åœ°æ–¹æ¬¢è¿å¸ˆå‚…æŒ‡å‡º)</p>
<p><img src="/post/187210a7/image-20230930114719034.png" alt="image-20230930114719034"></p>
<p>è¿™ä¸ªæ•°å­—å°±æ˜¯kpï¼Œä¸næ±‚gcdå³å¯å¾—åˆ°pï¼Œä¹Ÿå¯ä»¥åœ¨æœ€åä¸€è¡ŒæŠ¥é”™ä¿¡æ¯ä¸­ç›´æ¥çœ‹åˆ°nçš„åˆ†è§£ã€‚</p>
<p>å…¶å®è¿™ç§åˆ†è§£æ–¹å¼å°±æ˜¯<a href="https://en.wikipedia.org/wiki/Lenstra_elliptic-curve_factorization">Lenstra elliptic-curve factorization</a>.çš„æ ¸å¿ƒåŸç†ï¼Œä½†æˆ‘æ²¡æœ‰å®Œå…¨ç†è§£ã€‚</p>
<p>æ±‚è§£å‡ºpã€qåï¼Œå°±é¡ºåŠ¿è·å¾—äº†ä¸¤æ¡æ›²çº¿ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å¦‚ä½•ç”±æ›²çº¿ä¸Šçš„å€ç‚¹(2M)æ±‚è§£å‡ºåŸç‚¹çš„é—®é¢˜ï¼Œä¸€èˆ¬æœ‰ä¸¤ç±»è§£æ³•ï¼š</p>
<p>1ã€å¦‚æœ2ä¸æ›²çº¿é˜¶äº’ç´ ï¼Œåˆ™å¯ä»¥ç›´æ¥æ±‚è§£2çš„é€†å…ƒï¼Œå°†å€ç‚¹ä¹˜ä¸Šé€†å…ƒå³å¾—åŸç‚¹</p>
<p>2ã€å¦‚æœä¸äº’ç´ ï¼Œåˆ™å¯ä»¥è”ç«‹æ¤­åœ†æ›²çº¿æœ¬èº«æ–¹ç¨‹åŠå€ç‚¹æ–¹ç¨‹ï¼Œåœ¨æœ‰é™åŸŸä¸‹æ±‚æ ¹</p>
<p>è€Œåœ¨æœ¬é¢˜ä¸­ï¼Œ2ä¸Eqçš„é˜¶äº’ç´ ï¼Œå› æ­¤é‡‡ç”¨ç¬¬ä¸€ç§è§£æ³•ï¼›ä¸Epçš„é˜¶ä¸äº’ç´ ï¼Œå› æ­¤é‡‡ç”¨ç¬¬äºŒç§è§£æ³•ï¼Œç¬¬äºŒç§è§£æ³•è”ç«‹æ–¹ç¨‹è¿‡ç¨‹å¦‚ä¸‹ï¼š(è®°Mä¸º(x1,y1),2Mä¸º(x2,y2))</p>
<script type="math/tex; mode=display">
y^2=x^3+ax+b\quad(mod\;p)</script><script type="math/tex; mode=display">
x_2=k^2âˆ’2x_1\quad(mod\;p)</script><script type="math/tex; mode=display">
k = \frac{3x_1^2 + a}{2y_1}\quad(mod\;p)</script><p>è”ç«‹ä¸Šè¿°ä¸‰å¼å¯å¾—æ–¹ç¨‹ï¼š</p>
<script type="math/tex; mode=display">
\frac{(3x_1^2+a)^2}{(2y_1)^2} - 2x_1 - x_2 = 0\quad(mod\;p)</script><p>å³ï¼š</p>
<script type="math/tex; mode=display">
(3x_1^2+a)^2 - 2x_1*4(x_1^3+ax_1+b) - x_2*4(x_1^3+ax_1+b) = 0\quad(mod\;p)</script><p>æ­¤æ—¶æ–¹ç¨‹ä¸­ä»…æœ‰x1ä¸€ä¸ªæœªçŸ¥æ•°ï¼Œåœ¨æ¨¡pä¸‹è§£æ–¹ç¨‹å³å¯ï¼Œè§£å®Œåç”¨ä¸­å›½å‰©ä½™å®šç†å°†æ¨¡pä¸æ¨¡qä¸‹çš„è§£ç»„åˆå³å¾—flagã€‚</p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">2</span></span><br><span class="line">a,b,n,C,leak = [<span class="number">138681122158674534796479818810828100269024674330030901179877002756402543027343312824423418859769980312713625658733</span>, <span class="number">4989541340743108588577899263469059346332852532421276369038720203527706762720292559751463880310075002363945271507040</span>, <span class="number">762981334990685089884160169295988791471426441106522959345412318178660817286272606245181160960267776171409174142433857335352402619564485470678152764621235882232914864951345067231483720755544188962798600739631026707678945887174897543</span>, (<span class="number">19591102741441427006422487362547101973286873135330241799412389205281057650306427438686318050682578531286702107543065985988634367524715153650482199099194389191525898366546842016339136884277515665890331906261550080128989942048438965</span>, <span class="number">728465071542637655949094554469510039681717865811604984652385614821789556549826602178972137405550902004858456181137844771163710123158955524137202319902378503104952106036911634918189377295743976966073577013775200078470659428344462772</span>), <span class="number">762981334990685089884160169295988791471426441106522959345445792076415993922016249232021560266153453470937452118572318136597282436269660557904217923887981072203978473274822142705255987334355747997513083011853917049784914749699536828</span>]</span><br><span class="line">E = EllipticCurve(Zmod(n),[a,b])</span><br><span class="line">C = E(C)</span><br><span class="line"></span><br><span class="line"><span class="comment">#factordb</span></span><br><span class="line"><span class="comment">#2^2,3^4,13,199,307,647,157259,297617,8452217,411927661365999433,1157516701716180046249,1338688620929080207819,31226697952255326809332037614333,581208663471376553417319728009366348095695079579751839149645355600351572890241761173016580183555305805091712621</span></span><br><span class="line">leak_fac = [<span class="number">2</span>,<span class="number">3</span>,<span class="number">13</span>,<span class="number">199</span>,<span class="number">307</span>,<span class="number">647</span>,<span class="number">157259</span>,<span class="number">297617</span>,<span class="number">8452217</span>,<span class="number">411927661365999433</span>,<span class="number">1157516701716180046249</span>,<span class="number">1338688620929080207819</span>,<span class="number">31226697952255326809332037614333</span>,<span class="number">581208663471376553417319728009366348095695079579751839149645355600351572890241761173016580183555305805091712621</span>]</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">for i in leak_fac:</span></span><br><span class="line"><span class="string">    temp = leak // i * C</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">kp = <span class="number">422522588482185975632147929645103216180089543839772868484032620301855259044079430236142637458472152787337779544279109415705783248825091269039840404202119229567311048216047356951966653331710686649176005328509793328313264251738045723</span></span><br><span class="line">p = GCD(kp,n)</span><br><span class="line">q = n//p</span><br><span class="line"></span><br><span class="line">Ep = EllipticCurve(Zmod(p), [a, b])</span><br><span class="line">Eq = EllipticCurve(Zmod(q), [a, b])</span><br><span class="line">ord_p = Ep.order()</span><br><span class="line">ord_q = Eq.order()</span><br><span class="line"><span class="comment">#print(ord_p)</span></span><br><span class="line"><span class="comment">#print(ord_q)</span></span><br><span class="line"></span><br><span class="line">dq = inverse(e,ord_q)</span><br><span class="line">Q = dq*Eq(C)</span><br><span class="line">mq = <span class="built_in">int</span>(Q[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(Ep(C))</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(GF(p))</span><br><span class="line">f = (<span class="number">3</span>*(x**<span class="number">2</span>)+a)**<span class="number">2</span> - <span class="number">2</span>*x*(<span class="number">4</span>*(x**<span class="number">3</span>+a*x+b)) - <span class="built_in">int</span>(C[<span class="number">0</span>])*<span class="number">4</span>*(x**<span class="number">3</span>+a*x+b)</span><br><span class="line">res = f.roots()</span><br><span class="line"><span class="comment">#print(res)</span></span><br><span class="line"></span><br><span class="line">n = [p,q]</span><br><span class="line"><span class="keyword">if</span>(res):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">        c = [<span class="built_in">int</span>(i[<span class="number">0</span>]),mq]</span><br><span class="line">        m = crt(c,n)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>flag{3crab1n_s0unds_go0d}</strong></p>
<p><br></p>
<p><br></p>
]]></content>
      <categories>
        <category>cryptoè¶£é¢˜</category>
      </categories>
  </entry>
  <entry>
    <title>NSSCTF-2nd-wp-crypto</title>
    <url>/post/39588.html</url>
    <content><![CDATA[<p>è¿™æ¬¡cryptoé¢˜ç›®æ€»ä½“éš¾åº¦ä¸å¤§ï¼Œé‡ç‚¹æ˜¯å¯¹ä¸€äº›åŸºç¡€çŸ¥è¯†çš„ç†è§£è¿ç”¨ã€‚</p>
<span id="more"></span>
<h2 id="EzRSA"><a href="#EzRSA" class="headerlink" title="EzRSA"></a>EzRSA</h2><p>é¢˜ç›®:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">assert</span> m.bit_length()&lt;<span class="number">200</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">kbits = <span class="number">103</span></span><br><span class="line">m = (m &gt;&gt; kbits) &lt;&lt; kbits</span><br><span class="line">Mod = getPrime(<span class="number">1024</span>)</span><br><span class="line">hint1 = (<span class="number">2021</span>-<span class="number">2023</span>*m) % Mod</span><br><span class="line">hint2 = <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">2023</span>, Mod)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;hint1 =&#x27;</span>,hint1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;hint2 =&#x27;</span>,hint2)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = ...</span></span><br><span class="line"><span class="string">c = ...</span></span><br><span class="line"><span class="string">hint1 = ...</span></span><br><span class="line"><span class="string">hint2 = ...</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>æœ‰ä»¥ä¸‹ä¿¡æ¯:</p>
<ul>
<li>m.bit_length()&lt;200 , è¯´æ˜æ˜æ–‡è¾ƒå°</li>
<li>kbits = 103 , m = (m &gt;&gt; kbits) &lt;&lt; kbits , éšè—äº†æ˜æ–‡ä½ä½</li>
<li>hint1 = (2021-2023*m) % Mod</li>
<li>hint2 = pow(2, 2023, Mod)</li>
</ul>
<p>ç§ç§éƒ½æŒ‡å‘coppersmith , é¦–å…ˆçœ‹hint2ï¼Œ</p>
<script type="math/tex; mode=display">
hint2  \equiv  2^{2023}  mod(Mod)</script><p>åˆ©ç”¨åŒä½™å…³ç³»,</p>
<script type="math/tex; mode=display">
2^{2023} - hint2 = k*Mod</script><p>å¾—åˆ°Modçš„kå€,å› æ­¤å¯ä»¥åˆ©ç”¨k*Modå»ºç«‹ç¯ï¼Œè§£å‡ºhint1ä¸­çš„å°æ ¹mï¼Œè§£å¾—mé«˜ä½åå·²çŸ¥é«˜ä½æ”»å‡»å³å¯ã€‚</p>
<p><br></p>
<p>exp.ipynb:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = ...</span><br><span class="line">c = ...</span><br><span class="line">hint1 = ...</span><br><span class="line">hint2 = ...</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">kM = <span class="number">2</span>**<span class="number">2023</span>-hint2</span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(kM))</span><br><span class="line">f = <span class="number">2023</span>*x + hint1 - <span class="number">2021</span></span><br><span class="line">f = f.monic()</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^<span class="number">200</span>,beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="keyword">if</span> roots:</span><br><span class="line">    mhigh = roots[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">mhigh = <span class="number">1746716778150027565782467891299010283212636160</span></span><br><span class="line">PR.&lt;y&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = (mhigh + y)^<span class="number">3</span> - c</span><br><span class="line">f = f.monic()</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^<span class="number">104</span>,beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="keyword">if</span> roots:</span><br><span class="line">    m = mhigh + roots[<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">print</span>(m)</span><br><span class="line">m = <span class="number">1746716778150037336346788439252154990602710653</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flag:</p>
<font size="4" color="red">NSSCTF{Rea1_Si9n3n}</font>

<p><br></p>
<p>(èµ›ä¸­çš„æ—¶å€™ï¼Œè¿™é¢˜è§£æ•°æ¯”funnyencryptè¿˜å¤šï¼Œå½“æ—¶å°±æ„Ÿè§‰æœ‰ç‚¹è¯¡å¼‚ã€‚èµ›åæ‰å‘ç°å› ä¸ºæ˜å¯†æ–‡éƒ½å¾ˆå°ï¼Œæ‰€ä»¥ç›´æ¥å¼€ä¸‰æ¬¡æ ¹å°±å¯ä»¥äº†ã€‚ã€‚)</p>
<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="FunnyEncrypt"><a href="#FunnyEncrypt" class="headerlink" title="FunnyEncrypt"></a>FunnyEncrypt</h2><p>é¢˜ç›®:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">âœ§âœ¡âœ­</span><br><span class="line">âœ¡âœ® âœ£âœ´âœ¯ âœ¤âœ¶âœ¬âœ¬âœ± âœ¬âœ¤ âœ±âœ¦âœ¢âœ¥âœ®âœ¯âœ§âœ§, âœ´âœ¬âœ·âœ¯ âœ¡âœ§ âœ£âœ´âœ¯ âœ¶âœ¡âœ°âœ´âœ£. âœ¡âœ£ â‚âœ¢âœ¡âœ®âœ°âœ§ âœ©âœ¬âœ¸âœ¤âœ¬âœ¢âœ£, âœ¤âœ¦âœ¡âœ£âœ´, âœ¦âœ®âœ± âœ©âœ¬âœ®âœ¤âœ¡âœ±âœ¯âœ®âœ©âœ¯. âœ¡âœ£ âœ°âœ¡âœ²âœ¯âœ§ âœ³âœ§ âœ°âœ³âœ¡âœ±âœ¦âœ®âœ©âœ¯ â˜…âœ´âœ¯âœ® â˜…âœ¯ âœ¦âœ¢âœ¯ âœ¶âœ¬âœ§âœ£, âœ¦âœ®âœ± âœ°âœ¡âœ²âœ¯âœ§ âœ§âœ³âœ·âœ·âœ¬âœ¢âœ£ â˜…âœ´âœ¯âœ® â˜…âœ¯ âœ¦âœ¢âœ¯ âœ¦âœ¤âœ¢âœ¦âœ¡âœ±. âœ¦âœ®âœ± âœ£âœ´âœ¯ âœ¸âœ¬âœ¸âœ¯âœ®âœ£ â˜…âœ¯ âœ°âœ¡âœ²âœ¯ âœ³âœ· âœ´âœ¬âœ·âœ¯, â˜…âœ¯ âœ°âœ¡âœ²âœ¯ âœ³âœ· âœ¬âœ³âœ¢ âœ¶âœ¡âœ²âœ¯âœ§. âœ£âœ´âœ¯ â˜…âœ¬âœ¢âœ¶âœ± â˜…âœ¯ âœ¶âœ¡âœ²âœ¯ âœ¡âœ® âœ¡âœ§ âœ±âœ¡âœ§âœ¡âœ®âœ£âœ¯âœ°âœ¢âœ¦âœ£âœ¡âœ®âœ° âœ¡âœ®âœ£âœ¬ âœ¦ âœ·âœ¶âœ¦âœ©âœ¯ âœ¬âœ¤ âœ¸âœ¦âœ¶âœ¡âœ©âœ¯ âœ¦âœ®âœ± âœ´âœ¦âœ£âœ¢âœ¯âœ±, â˜…âœ´âœ¯âœ¢âœ¯ â˜…âœ¯ âœ®âœ¯âœ¯âœ± âœ´âœ¬âœ·âœ¯ âœ¦âœ®âœ± âœ¤âœ¡âœ®âœ± âœ¡âœ£ âœ´âœ¦âœ¢âœ±âœ¯âœ¢. âœ¡âœ® âœ£âœ´âœ¡âœ§ â˜…âœ¬âœ¢âœ¶âœ± âœ¬âœ¤ âœ¤âœ¯âœ¦âœ¢, âœ´âœ¬âœ·âœ¯ âœ£âœ¬ âœ¤âœ¡âœ®âœ± â‚âœ¯âœ£âœ£âœ¯âœ¢, â‚âœ³âœ£ âœ¯âœ¦âœ§âœ¡âœ¯âœ¢ âœ§âœ¦âœ¡âœ± âœ£âœ´âœ¦âœ® âœ±âœ¬âœ®âœ¯, âœ£âœ´âœ¯ âœ¸âœ¬âœ¢âœ¯ âœ¸âœ¯âœ¦âœ®âœ¡âœ®âœ°âœ¤âœ³âœ¶ âœ¶âœ¡âœ¤âœ¯ âœ¬âœ¤ âœ¤âœ¦âœ¡âœ£âœ´ â˜…âœ¡âœ¶âœ¶ âœ¸âœ¦âœ¥âœ¯ âœ¶âœ¡âœ¤âœ¯ âœ¸âœ¯âœ¦âœ®âœ¡âœ®âœ°âœ¤âœ³âœ¶.</span><br><span class="line">âœ§âœ¬âœ¸âœ¯âœ£âœ¡âœ¸âœ¯âœ§ â˜…âœ¯ âœ£âœ´âœ¡âœ®âœ¥ âœ¬âœ¤ âœ±âœ¢âœ¯âœ¦âœ¸âœ§ âœ¦âœ§ âœ¤âœ¦âœ®âœ£âœ¦âœ§âœ¡âœ¯âœ§ - âœ¡âœ£&#x27;âœ§ âœ¯âœ¦âœ§âœµ âœ£âœ¬ âœ±âœ¬ â˜…âœ´âœ¯âœ® âœµâœ¬âœ³ âœ´âœ¦âœ²âœ¯ âœ¸âœ¬âœ®âœ¯âœµ, âœ¢âœ¯âœ®âœ£, âœ¦âœ®âœ± â˜…âœ¬âœ¢âœ¥. â‚âœ³âœ£ âœµâœ¬âœ³ âœ©âœ¦âœ®&#x27;âœ£ âœ·âœ¢âœ¯âœ·âœ¦âœ¢âœ¯ âœµâœ¬âœ³âœ¢âœ§âœ¯âœ¶âœ¤ âœ¦âœ®âœ± âœ«âœ³âœ¸âœ· âœ¬âœ¤âœ¤ âœ£âœ´âœ¯ âœ©âœ¶âœ¡âœ¤âœ¤: âœµâœ¬âœ³ âœ§âœ´âœ¬âœ³âœ¶âœ± âœ°âœ¢âœ¬â˜… âœµâœ¬âœ³âœ¢ â˜…âœ¡âœ®âœ°âœ§ âœ¤âœ¡âœ¢âœ§âœ£. âœ¦ âœ¶âœ¡âœ£âœ£âœ¶âœ¯ â‚âœ¡âœ£ âœ£âœ¬â˜…âœ¦âœ¢âœ± âœ£âœ´âœ¯ âœ±âœ¢âœ¯âœ¦âœ¸. âœ§âœ£âœ¯âœ· â‚âœµ âœ§âœ£âœ¯âœ·. âœ£âœ¦âœ¥âœ¯ âœ¦ âœ§âœ£âœ¯âœ· âœ¤âœ¬âœ¢â˜…âœ¦âœ¢âœ±. âœ¦âœ¤âœ£âœ¯âœ¢ âœ¦âœ¶âœ¶, âœ¡âœ£&#x27;âœ§ âœµâœ¬âœ³âœ¢ âœ¸âœ¡âœ§âœ§âœ¡âœ¬âœ®.</span><br><span class="line">âœ¥âœ¯âœ¯âœ· âœ¤âœ¦âœ¡âœ£âœ´ âœ¦âœ®âœ± âœ´âœ¬âœ·âœ¯ âœ¤âœ¬âœ¢ âœ£âœ´âœ¯ âœ¤âœ³âœ£âœ³âœ¢âœ¯. âœ¸âœ¦âœ¥âœ¯ âœµâœ¬âœ³âœ¢ âœ¸âœ¬âœ§âœ£ âœ§âœ¡âœ®âœ©âœ¯âœ¢âœ¯ âœ±âœ¢âœ¯âœ¦âœ¸âœ§, âœ¦âœ®âœ± â˜…âœ´âœ¯âœ® âœ£âœ´âœ¯ âœ¬âœ·âœ·âœ¬âœ¢âœ£âœ³âœ®âœ¡âœ£âœ¡âœ¯âœ§ âœ©âœ¬âœ¸âœ¯, âœ£âœ´âœ¯âœµ â˜…âœ¡âœ¶âœ¶ âœ¤âœ¡âœ°âœ´âœ£ âœ¤âœ¬âœ¢ âœ£âœ´âœ¯âœ¸. âœ¡âœ£ âœ¸âœ¦âœµ âœ£âœ¦âœ¥âœ¯ âœ¦ âœ§âœ¯âœ¦âœ§âœ¬âœ® âœ¬âœ¢ âœ¸âœ¬âœ¢âœ¯, â‚âœ³âœ£ âœ£âœ´âœ¯ âœ¯âœ®âœ±âœ¡âœ®âœ° â˜…âœ¡âœ¶âœ¶ âœ®âœ¬âœ£ âœ©âœ´âœ¦âœ®âœ°âœ¯. âœ¦âœ¸â‚âœ¡âœ£âœ¡âœ¬âœ®, â‚âœ¯âœ§âœ£, â‚âœ¯âœ©âœ¬âœ¸âœ¯ âœ¦ âœ¢âœ¯âœ¦âœ¶âœ¡âœ£âœµ. âœ¦âœ® âœ³âœ®âœ©âœ¯âœ¢âœ£âœ¦âœ¡âœ® âœ¤âœ³âœ£âœ³âœ¢âœ¯, âœ¬âœ®âœ¶âœµ âœ¬âœ®âœ¯ âœ§âœ£âœ¯âœ· âœ¦âœ£ âœ¦ âœ£âœ¡âœ¸âœ¯, âœ£âœ´âœ¯ âœ´âœ¬âœ·âœ¯ âœ©âœ¦âœ® âœ¢âœ¯âœ¦âœ¶âœ¡âœªâœ¯ âœ£âœ´âœ¯ âœ±âœ¢âœ¯âœ¦âœ¸ âœ¬âœ¤ âœ£âœ´âœ¯ âœ´âœ¡âœ°âœ´âœ¯âœ§âœ£. â˜…âœ¯ âœ¸âœ³âœ§âœ£ âœ£âœ¢âœ¯âœ¦âœ§âœ³âœ¢âœ¯ âœ£âœ´âœ¯ âœ±âœ¢âœ¯âœ¦âœ¸, âœ£âœ¬ âœ·âœ¢âœ¬âœ£âœ¯âœ©âœ£ âœ¡âœ£ âœ¦ âœ§âœ¯âœ¦âœ§âœ¬âœ®, âœ¶âœ¯âœ£ âœ¡âœ£ âœ¡âœ® âœ£âœ´âœ¯ âœ´âœ¯âœ¦âœ¢âœ£ â‹âœ³âœ¡âœ¯âœ£âœ¶âœµ âœ°âœ¯âœ¢âœ¸âœ¡âœ®âœ¦âœ¶.</span><br><span class="line">âœ¬âœ®âœ¶âœµ â˜…âœ´âœ¯âœ® âœµâœ¬âœ³ âœ³âœ®âœ±âœ¯âœ¢âœ§âœ£âœ¦âœ®âœ± âœ£âœ´âœ¯ âœ£âœ¢âœ³âœ¯ âœ¸âœ¯âœ¦âœ®âœ¡âœ®âœ° âœ¬âœ¤ âœ¶âœ¡âœ¤âœ¯ âœ©âœ¦âœ® âœµâœ¬âœ³ âœ¶âœ¡âœ²âœ¯ âœ£âœ¢âœ³âœ¶âœµ. â‚âœ¡âœ£âœ£âœ¯âœ¢âœ§â˜…âœ¯âœ¯âœ£ âœ¦âœ§ âœ¶âœ¡âœ¤âœ¯ âœ¡âœ§, âœ¡âœ£&#x27;âœ§ âœ§âœ£âœ¡âœ¶âœ¶ â˜…âœ¬âœ®âœ±âœ¯âœ¢âœ¤âœ³âœ¶, âœ¦âœ®âœ± âœ¡âœ£&#x27;âœ§ âœ¤âœ¦âœ§âœ©âœ¡âœ®âœ¦âœ£âœ¡âœ®âœ° âœ¯âœ²âœ¯âœ® âœ¡âœ® âœ£âœ¢âœ¦âœ°âœ¯âœ±âœµ. âœ¡âœ¤ âœµâœ¬âœ³&#x27;âœ¢âœ¯ âœ«âœ³âœ§âœ£ âœ¦âœ¶âœ¡âœ²âœ¯, âœ£âœ¢âœµ âœ´âœ¦âœ¢âœ±âœ¯âœ¢ âœ¦âœ®âœ± âœ£âœ¢âœµ âœ£âœ¬ âœ¶âœ¡âœ²âœ¯ â˜…âœ¬âœ®âœ±âœ¯âœ¢âœ¤âœ³âœ¶âœ¶âœµ.</span><br><span class="line">âœ¡ â‚âœ¯âœ¶âœ¡âœ¯âœ²âœ¯ âœ£âœ´âœ¯âœ¢âœ¯ âœ¡âœ§ âœ¦ âœ·âœ¯âœ¢âœ§âœ¬âœ® â˜…âœ´âœ¬ â‚âœ¢âœ¡âœ®âœ°âœ§ âœ§âœ³âœ®âœ§âœ´âœ¡âœ®âœ¯ âœ¡âœ®âœ£âœ¬ âœµâœ¬âœ³âœ¢ âœ¶âœ¡âœ¤âœ¯. âœ£âœ´âœ¦âœ£ âœ·âœ¯âœ¢âœ§âœ¬âœ® âœ¸âœ¦âœµ âœ´âœ¦âœ²âœ¯ âœ¯âœ®âœ¬âœ³âœ°âœ´ âœ£âœ¬ âœ§âœ·âœ¢âœ¯âœ¦âœ± âœ¦âœ¢âœ¬âœ³âœ®âœ±. â‚âœ³âœ£ âœ¡âœ¤ âœµâœ¬âœ³ âœ¢âœ¯âœ¦âœ¶âœ¶âœµ âœ´âœ¦âœ²âœ¯ âœ£âœ¬ â˜…âœ¦âœ¡âœ£ âœ¤âœ¬âœ¢ âœ§âœ¬âœ¸âœ¯âœ¬âœ®âœ¯ âœ£âœ¬ â‚âœ¢âœ¡âœ®âœ° âœµâœ¬âœ³ âœ£âœ´âœ¯ âœ§âœ³âœ® âœ¦âœ®âœ± âœ°âœ¡âœ²âœ¯ âœµâœ¬âœ³ âœ¦ âœ°âœ¬âœ¬âœ± âœ¤âœ¯âœ¯âœ¶âœ¡âœ®âœ°, âœ£âœ´âœ¯âœ® âœµâœ¬âœ³ âœ¸âœ¦âœµ âœ´âœ¦âœ²âœ¯ âœ£âœ¬ â˜…âœ¦âœ¡âœ£ âœ¦ âœ¶âœ¬âœ®âœ° âœ£âœ¡âœ¸âœ¯.</span><br><span class="line">âœ¡âœ® âœ¦ â˜…âœ¬âœ¢âœ±,âœ¡ âœ´âœ¬âœ·âœ¯ âœµâœ¬âœ³ â˜…âœ¡âœ¶âœ¶ âœ¶âœ¡âœ¥âœ¯ âœ©âœ¢âœµâœ·âœ£âœ¬âœ°âœ¢âœ¦âœ·âœ´âœµ.âœ£âœ´âœ¡âœ§ âœ¡âœ§ âœµâœ¬âœ³âœ¢ âœ¤âœ¶âœ¦âœ°:âœ®âœ§âœ§âœ©âœ£âœ¤&#123;âœ©âœ¢âœµâœ·âœ£âœ¬_âœ¡âœ§_âœ§âœ¬_âœ¡âœ®âœ£âœ¯âœ¢âœ¯âœ§âœ£âœ¡âœ®âœ°_â˜…âœ´âœµ_âœ±âœ¬âœ®&#x27;âœ£_âœµâœ¬âœ³_âœ«âœ¬âœ¡âœ®_âœ³âœ§&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>è§è¿‡çš„å›¾å½¢åŠ å¯†ä¸­å¹¶æ²¡æœ‰ç±»ä¼¼è¿™ä¸ªçš„ï¼Œä¸è¿‡ç¿»çœ‹ä¸€ä¸‹é©¬ä¸Šå°±èƒ½å‘ç°æ–‡ä»¶å°¾éƒ¨çš„è¿™ä¸€ä¸²ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">âœ®âœ§âœ§âœ©âœ£âœ¤&#123;âœ©âœ¢âœµâœ·âœ£âœ¬_âœ¡âœ§_âœ§âœ¬_âœ¡âœ®âœ£âœ¯âœ¢âœ¯âœ§âœ£âœ¡âœ®âœ°_â˜…âœ´âœµ_âœ±âœ¬âœ®&#x27;âœ£_âœµâœ¬âœ³_âœ«âœ¬âœ¡âœ®_âœ³âœ§&#125;</span><br></pre></td></tr></table></figure>
<p>å‰ç¼€è‚¯å®šæ˜¯nssctfï¼Œæ˜¯å¯¹çš„ä¸Šçš„ï¼ŒçŒœæµ‹æ˜¯ç®€å•çš„æ›¿æ¢å¯†ç ï¼Œå†™ä¸ªè„šæœ¬åäº¤ç»™quipqiupå³å¯</p>
<p>exp.py:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">âœ§âœ¡âœ­</span></span><br><span class="line"><span class="string">âœ¡âœ® âœ£âœ´âœ¯ âœ¤âœ¶âœ¬âœ¬âœ± âœ¬âœ¤ âœ±âœ¦âœ¢âœ¥âœ®âœ¯âœ§âœ§, âœ´âœ¬âœ·âœ¯ âœ¡âœ§ âœ£âœ´âœ¯ âœ¶âœ¡âœ°âœ´âœ£. âœ¡âœ£ â‚âœ¢âœ¡âœ®âœ°âœ§ âœ©âœ¬âœ¸âœ¤âœ¬âœ¢âœ£, âœ¤âœ¦âœ¡âœ£âœ´, âœ¦âœ®âœ± âœ©âœ¬âœ®âœ¤âœ¡âœ±âœ¯âœ®âœ©âœ¯. âœ¡âœ£ âœ°âœ¡âœ²âœ¯âœ§ âœ³âœ§ âœ°âœ³âœ¡âœ±âœ¦âœ®âœ©âœ¯ â˜…âœ´âœ¯âœ® â˜…âœ¯ âœ¦âœ¢âœ¯ âœ¶âœ¬âœ§âœ£, âœ¦âœ®âœ± âœ°âœ¡âœ²âœ¯âœ§ âœ§âœ³âœ·âœ·âœ¬âœ¢âœ£ â˜…âœ´âœ¯âœ® â˜…âœ¯ âœ¦âœ¢âœ¯ âœ¦âœ¤âœ¢âœ¦âœ¡âœ±. âœ¦âœ®âœ± âœ£âœ´âœ¯ âœ¸âœ¬âœ¸âœ¯âœ®âœ£ â˜…âœ¯ âœ°âœ¡âœ²âœ¯ âœ³âœ· âœ´âœ¬âœ·âœ¯, â˜…âœ¯ âœ°âœ¡âœ²âœ¯ âœ³âœ· âœ¬âœ³âœ¢ âœ¶âœ¡âœ²âœ¯âœ§. âœ£âœ´âœ¯ â˜…âœ¬âœ¢âœ¶âœ± â˜…âœ¯ âœ¶âœ¡âœ²âœ¯ âœ¡âœ® âœ¡âœ§ âœ±âœ¡âœ§âœ¡âœ®âœ£âœ¯âœ°âœ¢âœ¦âœ£âœ¡âœ®âœ° âœ¡âœ®âœ£âœ¬ âœ¦ âœ·âœ¶âœ¦âœ©âœ¯ âœ¬âœ¤ âœ¸âœ¦âœ¶âœ¡âœ©âœ¯ âœ¦âœ®âœ± âœ´âœ¦âœ£âœ¢âœ¯âœ±, â˜…âœ´âœ¯âœ¢âœ¯ â˜…âœ¯ âœ®âœ¯âœ¯âœ± âœ´âœ¬âœ·âœ¯ âœ¦âœ®âœ± âœ¤âœ¡âœ®âœ± âœ¡âœ£ âœ´âœ¦âœ¢âœ±âœ¯âœ¢. âœ¡âœ® âœ£âœ´âœ¡âœ§ â˜…âœ¬âœ¢âœ¶âœ± âœ¬âœ¤ âœ¤âœ¯âœ¦âœ¢, âœ´âœ¬âœ·âœ¯ âœ£âœ¬ âœ¤âœ¡âœ®âœ± â‚âœ¯âœ£âœ£âœ¯âœ¢, â‚âœ³âœ£ âœ¯âœ¦âœ§âœ¡âœ¯âœ¢ âœ§âœ¦âœ¡âœ± âœ£âœ´âœ¦âœ® âœ±âœ¬âœ®âœ¯, âœ£âœ´âœ¯ âœ¸âœ¬âœ¢âœ¯ âœ¸âœ¯âœ¦âœ®âœ¡âœ®âœ°âœ¤âœ³âœ¶ âœ¶âœ¡âœ¤âœ¯ âœ¬âœ¤ âœ¤âœ¦âœ¡âœ£âœ´ â˜…âœ¡âœ¶âœ¶ âœ¸âœ¦âœ¥âœ¯ âœ¶âœ¡âœ¤âœ¯ âœ¸âœ¯âœ¦âœ®âœ¡âœ®âœ°âœ¤âœ³âœ¶.</span></span><br><span class="line"><span class="string">âœ§âœ¬âœ¸âœ¯âœ£âœ¡âœ¸âœ¯âœ§ â˜…âœ¯ âœ£âœ´âœ¡âœ®âœ¥ âœ¬âœ¤ âœ±âœ¢âœ¯âœ¦âœ¸âœ§ âœ¦âœ§ âœ¤âœ¦âœ®âœ£âœ¦âœ§âœ¡âœ¯âœ§ - âœ¡âœ£&#x27;âœ§ âœ¯âœ¦âœ§âœµ âœ£âœ¬ âœ±âœ¬ â˜…âœ´âœ¯âœ® âœµâœ¬âœ³ âœ´âœ¦âœ²âœ¯ âœ¸âœ¬âœ®âœ¯âœµ, âœ¢âœ¯âœ®âœ£, âœ¦âœ®âœ± â˜…âœ¬âœ¢âœ¥. â‚âœ³âœ£ âœµâœ¬âœ³ âœ©âœ¦âœ®&#x27;âœ£ âœ·âœ¢âœ¯âœ·âœ¦âœ¢âœ¯ âœµâœ¬âœ³âœ¢âœ§âœ¯âœ¶âœ¤ âœ¦âœ®âœ± âœ«âœ³âœ¸âœ· âœ¬âœ¤âœ¤ âœ£âœ´âœ¯ âœ©âœ¶âœ¡âœ¤âœ¤: âœµâœ¬âœ³ âœ§âœ´âœ¬âœ³âœ¶âœ± âœ°âœ¢âœ¬â˜… âœµâœ¬âœ³âœ¢ â˜…âœ¡âœ®âœ°âœ§ âœ¤âœ¡âœ¢âœ§âœ£. âœ¦ âœ¶âœ¡âœ£âœ£âœ¶âœ¯ â‚âœ¡âœ£ âœ£âœ¬â˜…âœ¦âœ¢âœ± âœ£âœ´âœ¯ âœ±âœ¢âœ¯âœ¦âœ¸. âœ§âœ£âœ¯âœ· â‚âœµ âœ§âœ£âœ¯âœ·. âœ£âœ¦âœ¥âœ¯ âœ¦ âœ§âœ£âœ¯âœ· âœ¤âœ¬âœ¢â˜…âœ¦âœ¢âœ±. âœ¦âœ¤âœ£âœ¯âœ¢ âœ¦âœ¶âœ¶, âœ¡âœ£&#x27;âœ§ âœµâœ¬âœ³âœ¢ âœ¸âœ¡âœ§âœ§âœ¡âœ¬âœ®.</span></span><br><span class="line"><span class="string">âœ¥âœ¯âœ¯âœ· âœ¤âœ¦âœ¡âœ£âœ´ âœ¦âœ®âœ± âœ´âœ¬âœ·âœ¯ âœ¤âœ¬âœ¢ âœ£âœ´âœ¯ âœ¤âœ³âœ£âœ³âœ¢âœ¯. âœ¸âœ¦âœ¥âœ¯ âœµâœ¬âœ³âœ¢ âœ¸âœ¬âœ§âœ£ âœ§âœ¡âœ®âœ©âœ¯âœ¢âœ¯ âœ±âœ¢âœ¯âœ¦âœ¸âœ§, âœ¦âœ®âœ± â˜…âœ´âœ¯âœ® âœ£âœ´âœ¯ âœ¬âœ·âœ·âœ¬âœ¢âœ£âœ³âœ®âœ¡âœ£âœ¡âœ¯âœ§ âœ©âœ¬âœ¸âœ¯, âœ£âœ´âœ¯âœµ â˜…âœ¡âœ¶âœ¶ âœ¤âœ¡âœ°âœ´âœ£ âœ¤âœ¬âœ¢ âœ£âœ´âœ¯âœ¸. âœ¡âœ£ âœ¸âœ¦âœµ âœ£âœ¦âœ¥âœ¯ âœ¦ âœ§âœ¯âœ¦âœ§âœ¬âœ® âœ¬âœ¢ âœ¸âœ¬âœ¢âœ¯, â‚âœ³âœ£ âœ£âœ´âœ¯ âœ¯âœ®âœ±âœ¡âœ®âœ° â˜…âœ¡âœ¶âœ¶ âœ®âœ¬âœ£ âœ©âœ´âœ¦âœ®âœ°âœ¯. âœ¦âœ¸â‚âœ¡âœ£âœ¡âœ¬âœ®, â‚âœ¯âœ§âœ£, â‚âœ¯âœ©âœ¬âœ¸âœ¯ âœ¦ âœ¢âœ¯âœ¦âœ¶âœ¡âœ£âœµ. âœ¦âœ® âœ³âœ®âœ©âœ¯âœ¢âœ£âœ¦âœ¡âœ® âœ¤âœ³âœ£âœ³âœ¢âœ¯, âœ¬âœ®âœ¶âœµ âœ¬âœ®âœ¯ âœ§âœ£âœ¯âœ· âœ¦âœ£ âœ¦ âœ£âœ¡âœ¸âœ¯, âœ£âœ´âœ¯ âœ´âœ¬âœ·âœ¯ âœ©âœ¦âœ® âœ¢âœ¯âœ¦âœ¶âœ¡âœªâœ¯ âœ£âœ´âœ¯ âœ±âœ¢âœ¯âœ¦âœ¸ âœ¬âœ¤ âœ£âœ´âœ¯ âœ´âœ¡âœ°âœ´âœ¯âœ§âœ£. â˜…âœ¯ âœ¸âœ³âœ§âœ£ âœ£âœ¢âœ¯âœ¦âœ§âœ³âœ¢âœ¯ âœ£âœ´âœ¯ âœ±âœ¢âœ¯âœ¦âœ¸, âœ£âœ¬ âœ·âœ¢âœ¬âœ£âœ¯âœ©âœ£ âœ¡âœ£ âœ¦ âœ§âœ¯âœ¦âœ§âœ¬âœ®, âœ¶âœ¯âœ£ âœ¡âœ£ âœ¡âœ® âœ£âœ´âœ¯ âœ´âœ¯âœ¦âœ¢âœ£ â‹âœ³âœ¡âœ¯âœ£âœ¶âœµ âœ°âœ¯âœ¢âœ¸âœ¡âœ®âœ¦âœ¶.</span></span><br><span class="line"><span class="string">âœ¬âœ®âœ¶âœµ â˜…âœ´âœ¯âœ® âœµâœ¬âœ³ âœ³âœ®âœ±âœ¯âœ¢âœ§âœ£âœ¦âœ®âœ± âœ£âœ´âœ¯ âœ£âœ¢âœ³âœ¯ âœ¸âœ¯âœ¦âœ®âœ¡âœ®âœ° âœ¬âœ¤ âœ¶âœ¡âœ¤âœ¯ âœ©âœ¦âœ® âœµâœ¬âœ³ âœ¶âœ¡âœ²âœ¯ âœ£âœ¢âœ³âœ¶âœµ. â‚âœ¡âœ£âœ£âœ¯âœ¢âœ§â˜…âœ¯âœ¯âœ£ âœ¦âœ§ âœ¶âœ¡âœ¤âœ¯ âœ¡âœ§, âœ¡âœ£&#x27;âœ§ âœ§âœ£âœ¡âœ¶âœ¶ â˜…âœ¬âœ®âœ±âœ¯âœ¢âœ¤âœ³âœ¶, âœ¦âœ®âœ± âœ¡âœ£&#x27;âœ§ âœ¤âœ¦âœ§âœ©âœ¡âœ®âœ¦âœ£âœ¡âœ®âœ° âœ¯âœ²âœ¯âœ® âœ¡âœ® âœ£âœ¢âœ¦âœ°âœ¯âœ±âœµ. âœ¡âœ¤ âœµâœ¬âœ³&#x27;âœ¢âœ¯ âœ«âœ³âœ§âœ£ âœ¦âœ¶âœ¡âœ²âœ¯, âœ£âœ¢âœµ âœ´âœ¦âœ¢âœ±âœ¯âœ¢ âœ¦âœ®âœ± âœ£âœ¢âœµ âœ£âœ¬ âœ¶âœ¡âœ²âœ¯ â˜…âœ¬âœ®âœ±âœ¯âœ¢âœ¤âœ³âœ¶âœ¶âœµ.</span></span><br><span class="line"><span class="string">âœ¡ â‚âœ¯âœ¶âœ¡âœ¯âœ²âœ¯ âœ£âœ´âœ¯âœ¢âœ¯ âœ¡âœ§ âœ¦ âœ·âœ¯âœ¢âœ§âœ¬âœ® â˜…âœ´âœ¬ â‚âœ¢âœ¡âœ®âœ°âœ§ âœ§âœ³âœ®âœ§âœ´âœ¡âœ®âœ¯ âœ¡âœ®âœ£âœ¬ âœµâœ¬âœ³âœ¢ âœ¶âœ¡âœ¤âœ¯. âœ£âœ´âœ¦âœ£ âœ·âœ¯âœ¢âœ§âœ¬âœ® âœ¸âœ¦âœµ âœ´âœ¦âœ²âœ¯ âœ¯âœ®âœ¬âœ³âœ°âœ´ âœ£âœ¬ âœ§âœ·âœ¢âœ¯âœ¦âœ± âœ¦âœ¢âœ¬âœ³âœ®âœ±. â‚âœ³âœ£ âœ¡âœ¤ âœµâœ¬âœ³ âœ¢âœ¯âœ¦âœ¶âœ¶âœµ âœ´âœ¦âœ²âœ¯ âœ£âœ¬ â˜…âœ¦âœ¡âœ£ âœ¤âœ¬âœ¢ âœ§âœ¬âœ¸âœ¯âœ¬âœ®âœ¯ âœ£âœ¬ â‚âœ¢âœ¡âœ®âœ° âœµâœ¬âœ³ âœ£âœ´âœ¯ âœ§âœ³âœ® âœ¦âœ®âœ± âœ°âœ¡âœ²âœ¯ âœµâœ¬âœ³ âœ¦ âœ°âœ¬âœ¬âœ± âœ¤âœ¯âœ¯âœ¶âœ¡âœ®âœ°, âœ£âœ´âœ¯âœ® âœµâœ¬âœ³ âœ¸âœ¦âœµ âœ´âœ¦âœ²âœ¯ âœ£âœ¬ â˜…âœ¦âœ¡âœ£ âœ¦ âœ¶âœ¬âœ®âœ° âœ£âœ¡âœ¸âœ¯.</span></span><br><span class="line"><span class="string">âœ¡âœ® âœ¦ â˜…âœ¬âœ¢âœ±,âœ¡ âœ´âœ¬âœ·âœ¯ âœµâœ¬âœ³ â˜…âœ¡âœ¶âœ¶ âœ¶âœ¡âœ¥âœ¯ âœ©âœ¢âœµâœ·âœ£âœ¬âœ°âœ¢âœ¦âœ·âœ´âœµ.âœ£âœ´âœ¡âœ§ âœ¡âœ§ âœµâœ¬âœ³âœ¢ âœ¤âœ¶âœ¦âœ°:âœ®âœ§âœ§âœ©âœ£âœ¤&#123;âœ©âœ¢âœµâœ·âœ£âœ¬_âœ¡âœ§_âœ§âœ¬_âœ¡âœ®âœ£âœ¯âœ¢âœ¯âœ§âœ£âœ¡âœ®âœ°_â˜…âœ´âœµ_âœ±âœ¬âœ®&#x27;âœ£_âœµâœ¬âœ³_âœ«âœ¬âœ¡âœ®_âœ³âœ§&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">table = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz&#123;&#125; _-,.&#x27;:&quot;</span></span><br><span class="line">list1 = [<span class="string">&#x27;âœ§&#x27;</span>, <span class="string">&#x27;âœ¡&#x27;</span>, <span class="string">&#x27;âœ­&#x27;</span>, <span class="string">&#x27;âœ®&#x27;</span>, <span class="string">&#x27;âœ£&#x27;</span>, <span class="string">&#x27;âœ´&#x27;</span>, <span class="string">&#x27;âœ¯&#x27;</span>, <span class="string">&#x27;âœ¤&#x27;</span>, <span class="string">&#x27;âœ¶&#x27;</span>, <span class="string">&#x27;âœ¬&#x27;</span>, <span class="string">&#x27;âœ±&#x27;</span>, <span class="string">&#x27;âœ¦&#x27;</span>, <span class="string">&#x27;âœ¢&#x27;</span>, <span class="string">&#x27;âœ¥&#x27;</span>, <span class="string">&#x27;âœ·&#x27;</span>, <span class="string">&#x27;âœ°&#x27;</span>, <span class="string">&#x27;â‚&#x27;</span>, <span class="string">&#x27;âœ©&#x27;</span>, <span class="string">&#x27;âœ¸&#x27;</span>, <span class="string">&#x27;âœ²&#x27;</span>, <span class="string">&#x27;âœ³&#x27;</span>, <span class="string">&#x27;â˜…&#x27;</span>, <span class="string">&#x27;âœµ&#x27;</span>, <span class="string">&#x27;âœ«&#x27;</span>, <span class="string">&#x27;âœª&#x27;</span>, <span class="string">&#x27;â‹&#x27;</span>] </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(list1))</span><br><span class="line"></span><br><span class="line">cfinal = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">    <span class="keyword">if</span>(c[i] <span class="keyword">not</span> <span class="keyword">in</span> table):</span><br><span class="line">        <span class="keyword">if</span>(c[i] == <span class="string">&quot;\n&quot;</span>):</span><br><span class="line">            cfinal.append(c[i])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ind = list1.index(c[i])</span><br><span class="line">            cfinal.append(table[ind])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        cfinal.append(c[i])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(cfinal))</span><br><span class="line"></span><br><span class="line"><span class="comment">#quipqiup</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">six</span></span><br><span class="line"><span class="string">in the flood of darkness, hope is the light. it brings comfort, faith, and confidence. it gives us guidance when we are lost, and gives support when we are afraid. and the moment we give up hope, we give up our lives. the world we live in is disintegrating into a place of malice and hatred, where we need hope and find it harder. in this world of fear, hope to find better, but easier said than done, the more meaningful life of faith will make life meaningful.</span></span><br><span class="line"><span class="string">sometimes we think of dreams as fantasies - it&#x27;s easy to do when you have money, rent, and work. but you can&#x27;t prepare yourself </span></span><br><span class="line"><span class="string">and jump off the cliff: you should grow your wings first. a little bit toward the dream. step by step. take a step forward. after all, it&#x27;s your mission.</span></span><br><span class="line"><span class="string">keep faith and hope for the future. make your most sincere dreams, and when the opportunities come, they will fight for them. it may take a season or more, but the ending will not change. ambition, best, become a reality. an uncertain future, only one step at a time, the hope can realize the dream of the highest. we must treasure the dream, to protect it a season, let it in the heart quietly germinal.</span></span><br><span class="line"><span class="string">only when you understand the true meaning of life can you live truly. bittersweet as life is, it&#x27;s still wonderful, and it&#x27;s fascinating even in tragedy. if you&#x27;re just alive, try harder and try to live wonderfully.</span></span><br><span class="line"><span class="string">i believe there is a person who brings sunshine into your life. that person may have enough to spread around. but if you really </span></span><br><span class="line"><span class="string">have to wait for someone to bring you the sun and give you a good feeling, then you may have to wait a long time.</span></span><br><span class="line"><span class="string">in a word,i hope you will like cryptography.this is your flag:nssctf&#123;crypto_is_so_interesting_why_don&#x27;t_you_join_us&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flag:</p>
<font size="4" color="red">NSSCTF{crypto_is_so_interesting_why_don't_you_join_us}</font>

<p>(å‰ç¼€å±…ç„¶è¦å¤§å†™ï¼Œè¿™å°±æœ‰ç‚¹å‘äº†ã€‚ã€‚)</p>
<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="Math"><a href="#Math" class="headerlink" title="Math"></a>Math</h2><p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">length = <span class="built_in">len</span>(flag)</span><br><span class="line">flag1 = flag[:length//<span class="number">2</span>]</span><br><span class="line">flag2 = flag[length//<span class="number">2</span>:]</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">m1 = bytes_to_long(flag1)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line"></span><br><span class="line">p1 = gmpy2.invert(p,q)</span><br><span class="line">q1 = gmpy2.invert(q,p)</span><br><span class="line">c = <span class="built_in">pow</span>(m1,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p1=&quot;</span>,p1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;q1=&quot;</span>,q1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;phi=&quot;</span>,phi)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">p1= ...</span></span><br><span class="line"><span class="string">q1= ...</span></span><br><span class="line"><span class="string">c= ...</span></span><br><span class="line"><span class="string">phi= ...</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">m2 = bytes_to_long(flag2)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">c = <span class="built_in">pow</span>(m2, e, n)</span><br><span class="line">hint = <span class="built_in">pow</span>(<span class="number">2023</span> * p + <span class="number">114514</span>, q, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;hint=&quot;</span>,hint)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n= ...</span></span><br><span class="line"><span class="string">c= ...</span></span><br><span class="line"><span class="string">hint= ...</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®å°†flagåˆ†ä¸ºä¸¤éƒ¨åˆ†åˆ†åˆ«è¿›è¡ŒåŠ å¯†ï¼Œåˆ†å¼€æ¥è¯´ï¼š</p>
<ul>
<li>ç¬¬ä¸€éƒ¨åˆ†</li>
</ul>
<p>ç»™äº†på…³äºqçš„é€†å…ƒåŠqå…³äºpçš„é€†å…ƒï¼Œhitconctf 2019 qualså‡ºè¿‡è¿™ä¸ªé¢˜ç›®ï¼Œå…·ä½“æ¨å¯¼è¿‡ç¨‹å‚è€ƒ<a href="[AiDai|HITCON CTF 2019 Quals-Writeup (aidaip.github.io">è¿™ä¸€ç¯‡</a>](<a href="https://aidaip.github.io/ctf/2019/10/16/HITCON-CTF-2019-Quals-Writeup.html">https://aidaip.github.io/ctf/2019/10/16/HITCON-CTF-2019-Quals-Writeup.html</a>))</p>
<ul>
<li>ç¬¬äºŒéƒ¨åˆ†</li>
</ul>
<p>å·²çŸ¥ï¼š</p>
<script type="math/tex; mode=display">
hint \equiv (2023*p + 114514)^q  (mod n)</script><p>è¿™ç§é¢˜ç›®æ˜¾ç„¶æ˜¯æ„é€ å‡ºpæˆ–qçš„å€æ•°ï¼Œä»è€Œä¸næ±‚gcdå¾—åˆ°åˆ†è§£çš„ã€‚å¯¹äºè¿™ä¸ªç­‰å¼ï¼Œå¾ˆå®¹æ˜“å°±èƒ½æƒ³åˆ°åˆ©ç”¨åŒä½™æ€§è´¨å…ˆåŒ–ä¸ºä¸€ä¸‹ä¸¤ä¸ªç­‰å¼ï¼š</p>
<script type="math/tex; mode=display">
hint \equiv (2023*p + 114514)^q  (mod p)</script><script type="math/tex; mode=display">
hint \equiv (2023*p + 114514)^q  (mod q)</script><p>ä¹ä¸€çœ‹åº”è¯¥æ˜¯ç¬¬äºŒä¸ªç­‰å¼æ›´åŠ å¥½ç”¨ï¼Œå› ä¸ºå¯ä»¥åˆ©ç”¨è´¹é©¬å°å®šç†æ¶ˆå»æŒ‡æ•°ï¼Œå˜å½¢ä¸º:</p>
<script type="math/tex; mode=display">
hint \equiv 2023*p + 114514  (mod q)</script><p>ä½†æ˜¯è¿™é‡Œå°±å¡å£³äº†ï¼Œå› ä¸ºå³ä½¿åˆ©ç”¨åŒä½™æ€§è´¨æŠŠæ¨¡ç­‰å¼è½¬åŒ–ä¸ºç­‰å¼ï¼Œå¾—åˆ°çš„ä¾ç„¶å«æœ‰pï¼Œqä¸¤ä¸ªå› å­ï¼Œæ²¡æœ‰åŠæ³•ä¸næ±‚gcdã€‚</p>
<p>æ‰€ä»¥è€ƒè™‘åˆ©ç”¨å¦ä¸€ä¸ªç­‰å¼ï¼Œç”±äºæŒ‡æ•°qæ²¡æœ‰åŠæ³•æ¶ˆæ‰äº†ï¼Œæ‰€ä»¥åªèƒ½åˆ©ç”¨äºŒé¡¹å¼å®šç†å±•å¼€ã€‚åˆç”±äºmod pçš„å…³ç³»ï¼Œæ¨¡ç­‰å¼æ­£å¥½åªå‰©ä¸‹äº†æœ€åä¸€é¡¹ï¼Œå³ï¼š</p>
<script type="math/tex; mode=display">
hint \equiv 114514^q  (mod p)</script><p>æ€ä¹ˆåˆ©ç”¨è¿™ä¸ªç­‰å¼å‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™éœ€è¦æ•é”ä¸€ç‚¹å¯Ÿè§‰åˆ°è´¹é©¬å°å®šç†(ä¹Ÿè®¸åˆšåˆšæ‹†åˆ†å‡ºæ¥çš„å¦ä¸€ä¸ªå¼å­çš„å˜å½¢å°±æ˜¯ç»™æˆ‘ä»¬çš„æç¤º)ï¼Œç”±è´¹é©¬å°å®šç†æˆ‘ä»¬çŸ¥é“ï¼š</p>
<script type="math/tex; mode=display">
a \equiv a^p  (mod p)</script><p>æŠŠ $114514^q$ çœ‹ä½œaï¼Œå°±å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
(114514^q) \equiv (114514^q)^p \equiv 114514^n (mod p)</script><p>æ‰€ä»¥æœ‰ï¼š</p>
<script type="math/tex; mode=display">
hint \equiv 114514^n  (mod p)</script><script type="math/tex; mode=display">
hint = 114514^n + k*p</script><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå°†$(hint - 114514^n)$ä¸næ±‚gcdï¼Œå³å¯å¾—åˆ°pï¼Œè¿›è€Œæ±‚è§£RSA</p>
<p><br></p>
<p>exp.py:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">a, b</span>):</span><br><span class="line">  <span class="keyword">while</span>(b): </span><br><span class="line">    a,b = b, a % b </span><br><span class="line">  <span class="keyword">return</span> a </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mysqrt</span>(<span class="params">d</span>):</span><br><span class="line">  st = <span class="number">1</span></span><br><span class="line">  en = <span class="number">10</span>**<span class="number">1300</span></span><br><span class="line">  <span class="keyword">while</span> st&lt;=en:</span><br><span class="line">    mid = (st+en)//<span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> mid*mid == d: <span class="keyword">return</span> mid</span><br><span class="line">    <span class="keyword">if</span> mid*mid &lt; d: st=mid+<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>: en=mid-<span class="number">1</span></span><br><span class="line">  <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a1, a2</span>):</span><br><span class="line">    x1, x2 = <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    y1, y2 = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> a2:</span><br><span class="line">        q = a1 // a2</span><br><span class="line">        a1, a2 = a2, a1 - q * a2</span><br><span class="line">        x1, x2 = x2, x1 - q * x2</span><br><span class="line">        y1, y2 = y2, y1 - q * y2</span><br><span class="line">    <span class="keyword">return</span> (x1, y1, a1)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line">ipmq= ...</span><br><span class="line">iqmp= ...</span><br><span class="line">phi= ...</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">enc = ...</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">gg = gcd(iqmp-<span class="number">1</span>,ipmq-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">c = phi // gg</span><br><span class="line">a = (ipmq-<span class="number">1</span>)//gg</span><br><span class="line">b = (iqmp-<span class="number">1</span>)//gg</span><br><span class="line"><span class="comment"># p*a + q*b = c</span></span><br><span class="line">pmod = inverse(a, b)*c%b</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>):</span><br><span class="line">    p = pmod + j*b</span><br><span class="line">    <span class="keyword">if</span> p &gt; (<span class="number">1</span>&lt;&lt;<span class="number">1024</span>): <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> isPrime(p): <span class="keyword">continue</span></span><br><span class="line">    q = (c-p*a)//b</span><br><span class="line">    <span class="keyword">assert</span>(p*a+q*b==c)</span><br><span class="line">    <span class="keyword">if</span> (iqmp*q-<span class="number">1</span>)%p == <span class="number">0</span> <span class="keyword">and</span> (ipmq*p-<span class="number">1</span>)%q == <span class="number">0</span>:</span><br><span class="line">        M = <span class="built_in">pow</span>(enc,d,p*q)</span><br><span class="line">        flag += <span class="built_in">str</span>(long_to_bytes(M))[<span class="number">2</span>:-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2</span></span><br><span class="line">n= ...</span><br><span class="line">c= ...</span><br><span class="line">hint= ...</span><br><span class="line">h2 = <span class="built_in">pow</span>(<span class="number">114514</span>,n,n)</span><br><span class="line">p = GCD(n,hint-h2)</span><br><span class="line">q = n//p</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">flag += <span class="built_in">str</span>(long_to_bytes(m))[<span class="number">2</span>:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flag:</p>
<font size="4" color="red">NSSCTF{e713afa4-fcd8-419f-a1a6-959449b4df5a}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="LatticeLCG"><a href="#LatticeLCG" class="headerlink" title="LatticeLCG"></a>LatticeLCG</h2><p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;NSSCTF&#123;******************************&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">a = getPrime(<span class="number">512</span>)</span><br><span class="line">seed = getPrime(<span class="number">512</span>)</span><br><span class="line">b = bytes_to_long(flag)</span><br><span class="line">n = getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">e1 = <span class="number">2333</span></span><br><span class="line">e2 = <span class="number">23333</span></span><br><span class="line">c1 = <span class="built_in">pow</span>(a,e1,n)</span><br><span class="line">c2 = <span class="built_in">pow</span>(a,e2,n)</span><br><span class="line"></span><br><span class="line">output = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    seed = (a*seed+b)%n</span><br><span class="line">    output.append(seed)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c1 = &quot;</span>,c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c2 = &quot;</span>,c2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;output1 = &quot;</span>,output[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;output2 = &quot;</span>,output[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = [getPrime(<span class="number">128</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)]</span><br><span class="line">out = []</span><br><span class="line">m = getPrime(<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> e:</span><br><span class="line">    out.append(<span class="built_in">pow</span>(m,i,n))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e=&quot;</span>,e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;out=&quot;</span>,out)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">c1 = ...</span></span><br><span class="line"><span class="string">c2 = ...</span></span><br><span class="line"><span class="string">output1 = ...</span></span><br><span class="line"><span class="string">output2 = ...</span></span><br><span class="line"><span class="string">e= []</span></span><br><span class="line"><span class="string">out= []</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>å¡äº†å¾ˆä¹…ï¼Œæœäº†å¾ˆå¤šæ ¼ç›¸å…³é—®é¢˜ä¹Ÿæ²¡æœ‰æœåˆ°ç±»ä¼¼çš„ï¼Œæ‰“ç®—æ”¾å¼ƒè¿™ä¸ªé¢˜å»ç¡è§‰çš„æ—¶å€™ï¼Œçªç„¶æç„¶å¤§æ‚Ÿã€‚è¿™é‡Œå¥½å¥½é˜è¿°ä¸€ä¸‹æˆ‘çš„æ€è·¯ï¼Œå¸Œæœ›èƒ½å¸®åŠ©åˆ°ä¸€äº›å’Œæˆ‘ä¸€æ ·åˆšåˆšæ¥è§¦æ ¼çš„ctferã€‚</p>
<p>é¦–å…ˆï¼Œé¢˜ç›®å¾ˆæ˜æ˜¾çš„åˆ†æˆäº†ä¸‰ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li>å…±æ¨¡æ”»å‡»</li>
<li>LCGæ±‚å‚æ•°</li>
<li>Lattice</li>
</ul>
<p>é¦–å…ˆè¦æ˜ç¡®æ±‚è§£é¡ºåºã€‚flagä»¥LCGä¸­å‚æ•°bçš„å½¢å¼å­˜åœ¨ï¼Œå› æ­¤LCGåº”è¯¥æ˜¯é¢˜ç›®çš„æœ€åä¸€æ­¥ã€‚å¹¶ä¸”è¦æƒ³æ±‚è§£å‡ºè¿™ä¸ªLCGçš„bï¼Œæ˜¯éœ€è¦çŸ¥é“aä¸nçš„å€¼çš„ï¼Œåœ¨ç¬¬ä¸€éƒ¨å…±æ¨¡æ”»å‡»ä¸­æ˜¾ç„¶æ˜¯å·²çŸ¥næ±‚è§£aã€‚æ‰€ä»¥å°±æ˜ç¡®äº†å¦‚ä¸‹çš„è§£é¢˜é¡ºåºï¼š</p>
<ol>
<li>Latticeæ±‚è§£æ¨¡æ•°n</li>
<li>å…±æ¨¡æ”»å‡»æ±‚è§£a</li>
<li>LCGæ¢å¤å‚æ•°bï¼Œå¾—åˆ°flag</li>
</ol>
<p>åé¢ä¸¤ä¸ªæ­¥éª¤éå¸¸å®¹æ˜“ï¼Œä¸»è¦é—®é¢˜å°±åœ¨ç¬¬ä¸€æ­¥ï¼š<strong>ä¸ºä»€ä¹ˆè¦åˆ©ç”¨æ ¼æ±‚è§£nï¼Ÿ</strong> <strong>æ€ä¹ˆç”¨æ ¼æ±‚è§£nï¼Ÿ</strong>ä¸‹é¢æ˜¯æˆ‘å¯¹è¿™ä¸ªé—®é¢˜çš„åˆ†æï¼š</p>
<p>å…ˆæ¥çœ‹çœ‹ç»™äº†äº›ä»€ä¹ˆæ¡ä»¶ï¼šä¸€ä¸ª64bitçš„å°é‡mï¼Œä¾æ¬¡äº§ç”Ÿ20ä¸ª128bitçš„ç´ æ•°å¯¹å…¶è¿›è¡Œç±»ä¼¼RSAçš„åŠ å¯†ï¼Œå¹¶ä¸”ç»™äº†æˆ‘ä»¬åŠ å¯†æŒ‡æ•°çš„åˆ—è¡¨ä»¥åŠå¯†æ–‡çš„åˆ—è¡¨ã€‚é¢˜ç›®æ»¡è¶³ä¸¤ä¸ªç»å…¸æ¡ä»¶ï¼š<strong>å­˜åœ¨å°é‡</strong> ï¼Œ<strong>æä¾›å¤šä¸ªæ–¹ç¨‹ç»„å‚æ•°</strong>ï¼Œè¿™æ ·çš„é—®é¢˜åœ¨å¾ˆå¤šcryptoé¢˜ç›®ä¸­éƒ½æ˜¯ç”¨æ ¼æ–¹æ³•æ±‚è§£çš„ï¼Œæ‰€ä»¥è¦æƒ³åˆ°åˆ©ç”¨æ ¼æ–¹æ³•(é¢˜ç›®çš„åå­—è™½ç„¶è¯´å¾—å¾ˆæ˜ç™½ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰ï¼Œçœ‹åˆ°è¿™ç§å½¢å¼ä¹Ÿåº”è¯¥è”æƒ³åˆ°è¿™ä¸ªæ–¹æ³•)</p>
<p>æ³¨æ„åˆ°mä¸å˜ï¼Œæ¨¡æ•°nä¹Ÿä¸å˜ï¼ŒåŒæ—¶åŠ å¯†æŒ‡æ•°äº’ç´ ï¼Œè¿™å…¶å®å¾ˆåƒå…±æ¨¡æ”»å‡»çš„æƒ…æ™¯ï¼Œåªæ˜¯næœªçŸ¥ã€‚å›æƒ³ä¸€ä¸‹åœ¨å·²çŸ¥æ¨¡æ•°nçš„æƒ…å†µä¸‹å…±æ¨¡æ”»å‡»çš„å®æ–½æ–¹æ³•ï¼Œä¸éš¾äº§ç”Ÿä¸‹é¢è¿™ä¸ªè§£é¢˜æ€è·¯ï¼š</p>
<p>å–20ä¸ªæ–¹ç¨‹çš„å‰ä¸‰ä¸ªå¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
out1 \equiv m^{e1} \; (mod\;  n)</script><script type="math/tex; mode=display">
out2 \equiv m^{e2} \; (mod\;  n)</script><script type="math/tex; mode=display">
out3 \equiv m^{e3} \; (mod\;  n)</script><p>å› ä¸ºe1ï¼Œe2äº’ç´ ï¼Œæ‰€ä»¥å­˜åœ¨aï¼Œbï¼Œä½¿å¾—ï¼š</p>
<script type="math/tex; mode=display">
a*e1+b*e2 = 1</script><p>æ‰€ä»¥å¯ä»¥å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
out1^{a}*out2^{b}\equiv m^{a*e1+b*e2} \equiv m \quad (mod \;n)</script><p>è¿™æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿæˆ‘ä»¬åŒæ ·ä¹Ÿå¯¹2ã€3ä¸¤å¼ï¼Œ1ã€3ä¸¤å¼è¿›è¡Œè¿™æ ·çš„æ“ä½œï¼Œç»“åˆä¸Šé¢è¿™ä¸ªå¼å­èƒ½å¾—åˆ°ä¸‰ç»„æ¨¡ç­‰å¼ï¼š</p>
<script type="math/tex; mode=display">
out1^{a}*out2^{b} \equiv m \quad (mod \;n)\qquad--1</script><script type="math/tex; mode=display">
out2^{c}*out3^{d} \equiv m \quad (mod \;n)\qquad--2</script><script type="math/tex; mode=display">
out1^{f}*out3^{g} \equiv m \quad (mod \;n)\qquad--3</script><p>1ã€2å¼ä½œå·®ï¼Œ2ã€3å¼ä½œå·®ï¼Œå°±å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
out1^{a}*out2^{b} -out2^{c}*out3^{d}\equiv 0 \quad (mod \;n)</script><script type="math/tex; mode=display">
out1^{f}*out3^{g} -out2^{c}*out3^{d}\equiv 0 \quad (mod \;n)</script><p>è€Œç°åœ¨ç­‰å¼å·¦ä¾§å·²ç»æ²¡æœ‰æœªçŸ¥é‡äº†(a,b,c,d,f,gå‡èƒ½å¤Ÿé€šè¿‡æ‰©å±•æ¬§å‡ é‡Œå¾—æ±‚å‡º)ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ±‚è§£ä»–ä»¬çš„gcdå¾—åˆ°nã€‚</p>
<p>å¯ä»¥è¯´ï¼Œæƒ³åˆ°è¿™ä¸ªæ€è·¯çš„æ—¶å€™æˆ‘ä¸ºä¹‹ä¸€æŒ¯ï¼Œå¯æƒœå®é™…æ“ä½œçš„æ—¶å€™è¿™ä¸ªæ–¹æ³•å¹¶ä¸èƒ½å®æ–½ï¼ŒåŸå› ä¹Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬è¿›è¡Œçš„å¹¶éæ¨¡å¹‚è¿ç®—ï¼Œè€Œæ˜¯æ™®é€šå¹‚è¿ç®—ï¼Œ<strong>å¹¶ä¸”aï¼Œbè¿™äº›æŒ‡æ•°æ•°é‡çº§å¾ˆå¤§(æ³¨æ„è¿™ä¸€ç‚¹)</strong>ï¼Œæ‰€ä»¥æ˜¯å®Œå…¨æ²¡æœ‰åŠæ³•ç…§è¿™ä¸ªæ€è·¯è§£ä¸‹å»çš„ã€‚è¿™æ—¶å€™æˆ‘ä¹Ÿæ²¡æœ‰æƒ³åˆ°æ€ä¹ˆåˆ©ç”¨æ ¼ï¼Œæ‰€ä»¥è¿›åº¦ä¹Ÿåœæ»äº†ï¼Œä¸€å¡å¡åˆ°äº†æ™šä¸Šã€‚</p>
<p>æ™šä¸Šæˆ‘åå¤æ€è€ƒçš„æ—¶å€™ï¼Œåˆæƒ³åˆ°äº†æˆ‘åˆšåˆšè¯´çš„é‚£ä¸€ç‚¹ï¼Œä¹Ÿå°±æ˜¯å®æ–½ä¸äº†å…±æ¨¡æ”»å‡»çš„åŸå› ï¼Œåœ¨äº<strong>æŒ‡æ•°çš„æ•°é‡çº§å¾ˆå¤§ï¼Œæ²¡æœ‰åŠæ³•å¹‚è¿ç®—</strong>ã€‚æˆ‘ä¹Ÿçªç„¶è”æƒ³åˆ°äº†Latticeä¸­LLLç®—æ³•çš„é‡è¦åº”ç”¨â€”â€”æ±‚è§£æœ€çŸ­å‘é‡ã€‚é‚£ä¹ˆä¸€åˆ‡ä¹Ÿå°±è¯´å¾—é€šäº†ï¼Œä¹‹æ‰€ä»¥ç»™20ä¸ªç´ æ•°ä½œä¸ºåŠ å¯†æŒ‡æ•°ï¼Œå°±æ˜¯å¯ä»¥åº”ç”¨äºæ ¼å¯†ç ä¸­ï¼Œå…‹æœåˆšæ‰å…±æ¨¡æ”»å‡»ä¸­ä¸¤ä¸¤ç»„åˆæ—¶è®¡ç®—å‡ºçš„aï¼Œbè¿‡å¤§çš„é—®é¢˜ã€‚æ‰€ä»¥æ„é€ æ ¼çš„æ€è·¯å°±æ¥äº†ï¼š</p>
<p>å› ä¸º20ä¸ªæŒ‡æ•°eå‡äº’ç´ ï¼Œæ‰€ä»¥ä¸€å®šå­˜åœ¨a1ï¼Œa2ï¼Œa3â€¦a20ï¼Œä½¿å¾—</p>
<script type="math/tex; mode=display">
a1*e1+a2*e2+a3*e3+...a20*e20 = 1</script><p>æ‰€ä»¥å¯ä»¥åˆ—å‡ºç­‰å¼ï¼š</p>
<script type="math/tex; mode=display">
\left[\begin{matrix}
a1 & a2 & a3 ... & a20
\end{matrix}\right] 

*
\left[\begin{matrix}
e1 & 1 & 0 & 0 ... & 0\\
e2 & 0 & 1 & 0 ... & 0\\
e3 & 0 & 0 & 1 ... & 0\\
...\\
e20 & 0 & 0 & 0 ... & 1\\
\end{matrix}\right]

=

\left[\begin{matrix}
1 & a1 & a2 ... & a20
\end{matrix}\right]</script><p>å¾ˆæ˜æ˜¾ï¼Œè¿™ä¸ªæ ¼ç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚ï¼Œæˆ‘ä»¬åªéœ€è¦ä»è§„çº¦å‡ºæ¥çš„çŸ­å‘é‡ä¸­æŒ‘å‡ºä¸¤ç»„ï¼ŒæŒ‰ç†æ¥è¯´ï¼Œæˆ‘ä»¬åªéœ€è¦ç±»ä¼¼çš„è¿›è¡Œåˆšæ‰çš„å…±æ¨¡æ”»å‡»å³å¯ã€‚</p>
<p>å¯æ˜¯å®é™…æ“ä½œåˆé‡åˆ°äº†é—®é¢˜ï¼Œè¿™æ ·è§„çº¦å‡ºæ¥çš„å‘é‡ç»„æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">[ <span class="number">45</span> -<span class="number">58</span>   <span class="number">5</span> -<span class="number">16</span>  <span class="number">12</span>  -<span class="number">7</span> -<span class="number">27</span>  <span class="number">19</span>   <span class="number">6</span>  <span class="number">14</span>  <span class="number">29</span> -<span class="number">23</span> -<span class="number">36</span>  <span class="number">44</span> -<span class="number">15</span>   <span class="number">1</span>   <span class="number">8</span>  <span class="number">14</span>  -<span class="number">7</span>  <span class="number">11</span>  -<span class="number">9</span>]</span><br><span class="line">[-<span class="number">14</span> -<span class="number">27</span>  <span class="number">20</span>   <span class="number">6</span> -<span class="number">40</span>  <span class="number">20</span> -<span class="number">34</span>  -<span class="number">2</span> -<span class="number">16</span>  <span class="number">51</span>  <span class="number">35</span> -<span class="number">23</span> -<span class="number">51</span>  <span class="number">13</span>   <span class="number">3</span> -<span class="number">21</span>   <span class="number">0</span>  <span class="number">17</span>  <span class="number">11</span>  -<span class="number">7</span>   <span class="number">1</span>]</span><br><span class="line">[ <span class="number">15</span> -<span class="number">36</span> -<span class="number">21</span> -<span class="number">13</span>   <span class="number">6</span>  -<span class="number">7</span>  -<span class="number">1</span> -<span class="number">59</span> -<span class="number">23</span>  <span class="number">42</span> -<span class="number">33</span>  <span class="number">15</span> -<span class="number">30</span>  -<span class="number">4</span>  <span class="number">39</span>  <span class="number">26</span>  <span class="number">41</span>   <span class="number">1</span>  <span class="number">19</span>  <span class="number">10</span>   <span class="number">9</span>]</span><br><span class="line">[-<span class="number">23</span>   <span class="number">4</span>  <span class="number">49</span> -<span class="number">19</span>  <span class="number">22</span>  -<span class="number">9</span>  <span class="number">24</span> -<span class="number">20</span> -<span class="number">20</span>   <span class="number">3</span> -<span class="number">24</span>   <span class="number">4</span> -<span class="number">43</span> -<span class="number">86</span>  <span class="number">40</span>  <span class="number">44</span>  -<span class="number">1</span>  -<span class="number">1</span>  <span class="number">26</span>  <span class="number">25</span>   <span class="number">1</span>]</span><br><span class="line">[ <span class="number">72</span>  <span class="number">15</span> -<span class="number">11</span> -<span class="number">19</span>  <span class="number">26</span> -<span class="number">31</span> -<span class="number">56</span> -<span class="number">25</span>   <span class="number">5</span>  <span class="number">33</span> -<span class="number">27</span> -<span class="number">23</span>  <span class="number">12</span>  <span class="number">22</span>  <span class="number">11</span>  -<span class="number">1</span>  <span class="number">21</span> -<span class="number">17</span>  <span class="number">51</span> -<span class="number">31</span>   <span class="number">9</span>]</span><br><span class="line">[-<span class="number">35</span> -<span class="number">73</span>  -<span class="number">8</span>  <span class="number">19</span> -<span class="number">29</span>  <span class="number">23</span>  -<span class="number">3</span>  <span class="number">20</span> -<span class="number">10</span>  <span class="number">18</span>  <span class="number">46</span>  <span class="number">29</span>  -<span class="number">9</span>  <span class="number">69</span> -<span class="number">30</span>   <span class="number">9</span> -<span class="number">64</span>  <span class="number">13</span>  <span class="number">10</span> -<span class="number">26</span>   <span class="number">3</span>]</span><br><span class="line">[ <span class="number">20</span>  <span class="number">46</span>  <span class="number">12</span>  -<span class="number">3</span>  <span class="number">28</span>  -<span class="number">1</span> -<span class="number">68</span>  <span class="number">15</span>   <span class="number">3</span> -<span class="number">21</span> -<span class="number">48</span> -<span class="number">20</span>  <span class="number">43</span>  <span class="number">54</span>   <span class="number">9</span>  <span class="number">14</span>  -<span class="number">5</span>   <span class="number">0</span> -<span class="number">44</span> -<span class="number">24</span>   <span class="number">8</span>]</span><br><span class="line">[ <span class="number">49</span>   <span class="number">0</span> -<span class="number">10</span>   <span class="number">0</span> -<span class="number">46</span> -<span class="number">47</span>  <span class="number">24</span>  -<span class="number">2</span>  <span class="number">13</span>  <span class="number">10</span>  -<span class="number">3</span>  <span class="number">48</span>  <span class="number">43</span> -<span class="number">28</span>  -<span class="number">3</span>  <span class="number">53</span> -<span class="number">15</span>  -<span class="number">6</span>  <span class="number">31</span> -<span class="number">23</span>  <span class="number">12</span>]</span><br><span class="line">[ -<span class="number">6</span>   <span class="number">0</span>   <span class="number">9</span>  <span class="number">42</span> -<span class="number">49</span> -<span class="number">38</span>   <span class="number">8</span>  <span class="number">12</span>   <span class="number">7</span>  <span class="number">39</span>  <span class="number">30</span> -<span class="number">26</span>  <span class="number">18</span>  <span class="number">37</span>  <span class="number">28</span> -<span class="number">28</span>   <span class="number">8</span>   <span class="number">2</span> -<span class="number">67</span> -<span class="number">21</span> -<span class="number">15</span>]</span><br><span class="line">[-<span class="number">56</span>  <span class="number">23</span>  <span class="number">22</span>  <span class="number">29</span>  -<span class="number">7</span> -<span class="number">19</span>  <span class="number">19</span>  -<span class="number">8</span>   <span class="number">6</span>  <span class="number">35</span>   <span class="number">4</span>  -<span class="number">8</span>  <span class="number">22</span>  -<span class="number">2</span> -<span class="number">44</span> -<span class="number">69</span>  <span class="number">16</span>  -<span class="number">8</span>  -<span class="number">7</span> -<span class="number">45</span>  <span class="number">21</span>]</span><br><span class="line">[-<span class="number">21</span>  <span class="number">16</span>  <span class="number">34</span> -<span class="number">39</span>  <span class="number">36</span>   <span class="number">1</span>  <span class="number">57</span> -<span class="number">30</span>  -<span class="number">2</span>  -<span class="number">2</span> -<span class="number">36</span>  -<span class="number">9</span>   <span class="number">9</span> -<span class="number">27</span>   <span class="number">8</span> -<span class="number">31</span> -<span class="number">31</span>  <span class="number">32</span>  <span class="number">12</span>  -<span class="number">2</span>  <span class="number">15</span>]</span><br><span class="line">[ -<span class="number">9</span>  -<span class="number">7</span>   <span class="number">6</span>  <span class="number">40</span>  <span class="number">32</span> -<span class="number">49</span> -<span class="number">26</span> -<span class="number">60</span>  <span class="number">17</span>   <span class="number">0</span> -<span class="number">13</span>   <span class="number">7</span>  <span class="number">25</span>  <span class="number">57</span> -<span class="number">19</span>  <span class="number">28</span>  -<span class="number">3</span> -<span class="number">34</span>  <span class="number">11</span> -<span class="number">12</span> -<span class="number">17</span>]</span><br><span class="line">[-<span class="number">30</span> -<span class="number">13</span>  <span class="number">28</span> -<span class="number">42</span>   <span class="number">8</span> -<span class="number">46</span>  <span class="number">56</span>  <span class="number">33</span> -<span class="number">56</span> -<span class="number">40</span> -<span class="number">24</span>   <span class="number">4</span>  <span class="number">10</span>  <span class="number">15</span>  <span class="number">46</span>  <span class="number">50</span> -<span class="number">13</span>  <span class="number">18</span> -<span class="number">21</span>  <span class="number">17</span>  <span class="number">16</span>]</span><br><span class="line">[-<span class="number">17</span> -<span class="number">11</span>  -<span class="number">5</span>  <span class="number">29</span>  <span class="number">14</span>   <span class="number">6</span> -<span class="number">13</span>   <span class="number">4</span>  <span class="number">42</span> -<span class="number">69</span>  <span class="number">30</span>   <span class="number">9</span>   <span class="number">3</span> -<span class="number">37</span>   <span class="number">5</span>   <span class="number">7</span> -<span class="number">17</span>  <span class="number">50</span>   <span class="number">6</span>  <span class="number">14</span> -<span class="number">38</span>]</span><br><span class="line">[ <span class="number">53</span> -<span class="number">12</span>  <span class="number">16</span>  <span class="number">36</span>   <span class="number">1</span>  <span class="number">38</span> -<span class="number">52</span>  <span class="number">25</span> -<span class="number">10</span> -<span class="number">41</span>  -<span class="number">3</span> -<span class="number">37</span>   <span class="number">6</span> -<span class="number">12</span>   <span class="number">1</span>  -<span class="number">4</span> -<span class="number">25</span>  <span class="number">41</span>   <span class="number">5</span>   <span class="number">1</span>  <span class="number">29</span>]</span><br><span class="line">[ -<span class="number">3</span>   <span class="number">1</span>  <span class="number">36</span>  <span class="number">22</span>   <span class="number">7</span>  -<span class="number">5</span> -<span class="number">10</span>  <span class="number">15</span> -<span class="number">10</span> -<span class="number">27</span>  <span class="number">35</span> -<span class="number">60</span> -<span class="number">36</span>   <span class="number">9</span> -<span class="number">57</span>  <span class="number">33</span> -<span class="number">21</span>  <span class="number">43</span>  <span class="number">28</span> -<span class="number">44</span>   <span class="number">8</span>]</span><br><span class="line">[ <span class="number">32</span> -<span class="number">26</span>  <span class="number">18</span>  -<span class="number">9</span>  -<span class="number">5</span>  <span class="number">37</span>  -<span class="number">8</span>   <span class="number">2</span> -<span class="number">36</span> -<span class="number">28</span>  <span class="number">43</span>  <span class="number">10</span> -<span class="number">32</span>  <span class="number">37</span> -<span class="number">24</span> -<span class="number">70</span>  <span class="number">22</span> -<span class="number">35</span>  <span class="number">49</span>  -<span class="number">2</span>  <span class="number">31</span>]</span><br><span class="line">[-<span class="number">33</span>  <span class="number">15</span> -<span class="number">25</span>   <span class="number">1</span> -<span class="number">40</span>   <span class="number">3</span>  -<span class="number">2</span> -<span class="number">32</span>  <span class="number">15</span>   <span class="number">9</span> -<span class="number">20</span> -<span class="number">27</span> -<span class="number">27</span>  <span class="number">35</span>  <span class="number">26</span>  -<span class="number">1</span> -<span class="number">45</span> -<span class="number">12</span>  <span class="number">45</span>  <span class="number">23</span>  <span class="number">36</span>]</span><br><span class="line">[-<span class="number">17</span>   <span class="number">0</span>  <span class="number">18</span> -<span class="number">20</span> -<span class="number">75</span>  -<span class="number">5</span>  <span class="number">55</span>  <span class="number">42</span>  <span class="number">16</span>   <span class="number">8</span> -<span class="number">45</span>   <span class="number">5</span> -<span class="number">24</span> -<span class="number">20</span> -<span class="number">50</span> -<span class="number">11</span>   <span class="number">0</span>  <span class="number">27</span>  <span class="number">40</span>  <span class="number">18</span>   <span class="number">8</span>]</span><br><span class="line">[ <span class="number">11</span>   <span class="number">5</span>  <span class="number">16</span>  <span class="number">37</span>  -<span class="number">2</span>  -<span class="number">6</span>  <span class="number">28</span>  <span class="number">19</span> -<span class="number">21</span>   <span class="number">5</span>  -<span class="number">8</span>  <span class="number">63</span>  -<span class="number">8</span> -<span class="number">21</span>  <span class="number">22</span> -<span class="number">23</span> -<span class="number">57</span>  <span class="number">13</span>  -<span class="number">5</span>  <span class="number">15</span> -<span class="number">39</span>]</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€åˆ—å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„1ï¼Œè¯´æ˜ç¬¬ä¸€åˆ—æ˜¯1çš„å‘é‡å¯¹æ¯”èµ·æ¥é•¿åº¦å¹¶ä¸å°ã€‚å†æƒ³ä¸€ä¸‹è§„çº¦çš„ç›®çš„ï¼Œå…¶å®å¾ˆå®¹æ˜“å°±èƒ½ç›¸åŒç¬¬ä¸€åˆ—æ˜¯å¤šå°‘å¹¶ä¸é‡è¦ï¼Œé‡è¦çš„æ˜¯<strong>çŸ­å‘é‡çš„ç¬¬ä¸€åˆ—ç›¸åŒ</strong>(è¿™ä¸€ç‚¹éå¸¸å®¹æ˜“æƒ³é€šï¼Œæ²¡ç†è§£çš„è¯ä»”ç»†æƒ³æƒ³)ã€‚è€Œè¦è®©ä»–ä»¬ç›¸åŒï¼Œæœ€æœ‰æ•ˆçš„åŠæ³•å°±æ˜¯è®©ä»–ä»¬å‡ä¸º0ï¼Œæƒ³åˆ°è¿™ä¸€ç‚¹åï¼Œå°±å¯ä»¥åœ¨æ ¼çš„ç¬¬ä¸€åˆ—ä¹˜ä¸Šä¸€ä¸ªå¤§æ•°Kï¼Œä»è€Œæœ‰æ•ˆçš„è°ƒæ•´ä¸€ä¸‹æ ¼ï¼Œå¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
\left[\begin{matrix}
K*e1 & 1 & 0 & 0 ... & 0\\
K*e2 & 0 & 1 & 0 ... & 0\\
K*e3 & 0 & 0 & 1 ... & 0\\
...\\
K*e20 & 0 & 0 & 0 ... & 1\\
\end{matrix}\right]</script><p>è¿™æ ·ä¸€æ¥ï¼Œæœ€çŸ­å‘é‡çš„ç¬¬ä¸€åˆ—å°±ä¸å¤ªå¯èƒ½ä¸æ˜¯0äº†(å› ä¸ºä¼šå¯¹åº”çš„æ‰©å¤§Kå€ï¼Œæ˜¾è‘—åœ°ä½¿è§„çº¦å‘é‡å˜é•¿)ï¼Œæˆ‘æµ‹è¯•å‡ºå–100å·¦å³å³å¯ï¼Œç„¶åå°±å¯ä»¥æ±‚è§£æœ€å¤§å…¬çº¦æ•°(æ­¤æ—¶è¿˜éœ€æ³¨æ„ä¸¤ç‚¹å°é—®é¢˜ï¼šä¸€æ˜¯è§„çº¦å‡ºçš„çŸ­å‘é‡æœ‰è´Ÿæ•°ï¼Œæ™®é€šå¹‚è¿ç®—ä¸­ä¼šå˜æˆåˆ†æ•°å½¢å¼ï¼Œé€šåˆ†è‡³ç­‰å¼å³ä¾§å³å¯ï¼›äºŒæ˜¯æ±‚å¾—çš„å…¬çº¦æ•°ä»æœ‰å¯èƒ½æ˜¯kå€çš„nï¼Œéœ€è¦å»é™¤ä¸€äº›å°å› å­)ï¼Œæœ€ç»ˆå¾—åˆ°nã€‚</p>
<p><br></p>
<p>recovern.ipynb:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">e= []</span><br><span class="line">c= []</span><br><span class="line"></span><br><span class="line"><span class="comment">#step1</span></span><br><span class="line">L = Matrix(ZZ, <span class="number">20</span>, <span class="number">21</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    L[i,<span class="number">0</span>] = e[i]*<span class="number">1000</span></span><br><span class="line">    L[i,i+<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">L = L.LLL()</span><br><span class="line"></span><br><span class="line">alist1 = L[<span class="number">0</span>][<span class="number">1</span>:]</span><br><span class="line">k1nl = <span class="number">1</span></span><br><span class="line">k1nr = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    <span class="keyword">if</span>(alist1[i]&lt;<span class="number">0</span>):</span><br><span class="line">        k1nr *= c[i]**(-alist1[i])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        k1nl *= c[i]**alist1[i]</span><br><span class="line">k1n = k1nl-k1nr</span><br><span class="line"></span><br><span class="line">alist2 = L[<span class="number">1</span>][<span class="number">1</span>:]</span><br><span class="line">k2nl = <span class="number">1</span></span><br><span class="line">k2nr = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    <span class="keyword">if</span>(alist2[i]&lt;<span class="number">0</span>):</span><br><span class="line">        k2nr *= c[i]**(-alist2[i])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        k2nl *= c[i]**alist2[i]</span><br><span class="line">k2n = k2nl-k2nr</span><br><span class="line"></span><br><span class="line">n = gcd(k1n,k2n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">10000</span>):</span><br><span class="line">    <span class="keyword">while</span>(n % i == <span class="number">0</span>):</span><br><span class="line">        n //= i</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ£€æŸ¥ä¸€ä¸‹nçš„é•¿åº¦æ˜¯å¦ä¸º1024bit</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(<span class="built_in">bin</span>(n)[<span class="number">2</span>:]))</span><br><span class="line"><span class="built_in">print</span>(n)</span><br></pre></td></tr></table></figure>
<p>åä¸¤ä¸ªé—®é¢˜ä¹Ÿå°±è¿åˆƒè€Œè§£ï¼Œæœ€ç»ˆå¾—åˆ°flagï¼š</p>
<font size="4" color="red">NSSCTF{407f8832-6ffd-43bf-91a0-6900758cdff7}</font>

<p><br></p>
<p><br></p>
<p><br></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ€»çš„è¯´æ¥ï¼Œå¯¹æ ¼çš„åº”ç”¨è¿˜ä¸å¤Ÿçµæ´»ï¼Œè¿˜éœ€è¦åŠ æ·±å­¦ä¹ ã€‚</p>
<p>å¦‚æœå„ä½æœ‰ä¸æ‡‚çš„åœ°æ–¹æˆ–è€…å‘ç°äº†æ–‡ä¸­çš„é—®é¢˜ï¼Œæ¬¢è¿è”ç³»æˆ‘ï¼Œä¸€èµ·å­¦ä¹ è¿›æ­¥ã€‚</p>
]]></content>
      <categories>
        <category>wp-crypto</category>
      </categories>
  </entry>
  <entry>
    <title>miscè¶£é¢˜(ä¸€)</title>
    <url>/post/77e39860.html</url>
    <content><![CDATA[<p>åœ¨CNSS 2023çš„å¤ä»¤è¥çº¿ä¸Šé¢˜ä¸­æ‰¾åˆ°çš„ä¸€é“miscé¢˜ï¼Œçœ‹åˆ°æ ‡é¢˜æœ‰Cryptoï¼Œæ„Ÿå…´è¶£å°±å»è¯•äº†ä¸€è¯•ï¼Œå‘ç°ç¡®å®æ˜¯é“æ¯”è¾ƒæœ‰æ„æ€çš„é¢˜ç›®ï¼Œå°±åœ¨æ­¤è®°å½•ä¸€ä¸‹ï¼ŒåŒæ—¶ä¹Ÿå¼€å¯ <strong>miscè¶£é¢˜</strong> è¿™ä¸€åˆ†ç±»ã€‚</p>
<span id="more"></span>
<h2 id="ğŸ”‘-Shino-çš„-Crypto-æ¢¦æƒ³"><a href="#ğŸ”‘-Shino-çš„-Crypto-æ¢¦æƒ³" class="headerlink" title="ğŸ”‘ Shino çš„ Crypto æ¢¦æƒ³"></a>ğŸ”‘ Shino çš„ Crypto æ¢¦æƒ³</h2><p>é¢˜ç›®æ¥æºï¼š2023-CNSS-Summer</p>
<p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">åˆšåˆšæ¥è§¦ç½‘ç»œå®‰å…¨ä¸ä¹…çš„ Shino æœ‰ä¸€ä¸ªæˆä¸º Crypto æ–¹å‘ä¸“å®¶çš„æ¢¦æƒ³ï¼Œæ‰€ä»¥ä»–å†™äº†ä¸€ä¸ªå¾ˆå®‰å…¨çš„åŠ å¯†ç®—æ³•ï¼Œä½ å¯ä»¥å¸®ä»–çœ‹çœ‹å—ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>ç«¯å£ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc 47.108.140.140 11037</span><br></pre></td></tr></table></figure>
<p>Hintï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1ã€ä½ å¯èƒ½éœ€è¦pwntools</span><br><span class="line">2ã€cnss&#123;a-zA-Z0-9_&#125;</span><br><span class="line">   ä¿è¯&#125;åªåœ¨ flag ç»“å°¾å‡ºç°ä¸€æ¬¡</span><br><span class="line">   flag é•¿åº¦ä¸å¤§äº 50</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> cipher, key</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Encoder</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.stream = self.randomBox(self._init_box(key))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">do_encrypt</span>(<span class="params">self, c</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">ord</span>(c) ^ <span class="built_in">next</span>(self.stream)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_init_box</span>(<span class="params">self, crypt_key</span>):</span><br><span class="line">        Box = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">        key_length = <span class="built_in">len</span>(crypt_key)</span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            index = <span class="built_in">ord</span>(crypt_key[(i % key_length)])</span><br><span class="line">            j = (j + Box[i] + index) % <span class="number">256</span></span><br><span class="line">            Box[i], Box[j] = Box[j], Box[i]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Box</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">randomBox</span>(<span class="params">self, S</span>):</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            i = i + <span class="number">1</span> &amp; <span class="number">255</span></span><br><span class="line">            j = j + S[i] &amp; <span class="number">255</span></span><br><span class="line">            S[i], S[j] = S[j], S[i]</span><br><span class="line">            <span class="keyword">yield</span> S[(S[i] + S[j] &amp; <span class="number">255</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">encoder = Encoder()</span><br><span class="line">flag = <span class="built_in">input</span>(<span class="string">&quot;input flag&gt;&gt; &quot;</span>)</span><br><span class="line">table = string.digits + string.ascii_letters + <span class="string">&quot;&#123;&#125;_&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">correct = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="built_in">len</span>(flag):</span><br><span class="line">    <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(flag) <span class="keyword">and</span> flag[i] <span class="keyword">not</span> <span class="keyword">in</span> table:</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> i &gt;= <span class="built_in">len</span>(flag):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> cipher[i] != encoder.do_encrypt(flag[i]):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong flag!&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        correct += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> correct == <span class="built_in">len</span>(cipher):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Correct flag!&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Wrong flag!&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆï¼Œé¢˜ç›®çš„åŠ å¯†ç®—æ³•æ˜¯RC4ï¼Œå¯ä»¥å…ˆæ£€æŸ¥ä¸€ä¸‹æœ‰æ— å˜ç§ï¼Œæ–¹æ³•æ˜¯è‡ªå·±éšä¾¿ä½¿ç”¨ä¸€ç»„æ˜æ–‡å’Œå¯†é’¥ï¼Œåˆ†åˆ«ç”¨è¯¥ç¨‹åºä¸åœ¨çº¿ç½‘ç«™åŠ å¯†ï¼Œæ£€æŸ¥ç»“æœæ˜¯å¦ç›¸åŒã€‚è¿™æ ·æ“ä½œä¹‹åå¯ä»¥å‘ç°ï¼Œç»“æœæ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œè¿™è¯´æ˜æœ¬é¢˜å¹¶æ²¡æœ‰å¯¹RC4è¿›è¡Œé­”æ”¹ï¼Œä¹Ÿå› æ­¤è§£é¢˜çš„æ€è·¯ä¹Ÿå°±å¾ˆè‡ªç„¶çš„ä»å¼€å§‹çš„è§£å¯†ç è½¬å˜æˆäº†æ‰¾æ¼æ´ã€‚</p>
<p>è€Œè¦æ‰¾æ¼æ´çš„ç¨‹åºæ®µå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">encoder = Encoder()</span><br><span class="line">flag = <span class="built_in">input</span>(<span class="string">&quot;input flag&gt;&gt; &quot;</span>)</span><br><span class="line">table = string.digits + string.ascii_letters + <span class="string">&quot;&#123;&#125;_&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">correct = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="built_in">len</span>(flag):</span><br><span class="line">    <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(flag) <span class="keyword">and</span> flag[i] <span class="keyword">not</span> <span class="keyword">in</span> table:</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> i &gt;= <span class="built_in">len</span>(flag):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> cipher[i] != encoder.do_encrypt(flag[i]):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong flag!&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        correct += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> correct == <span class="built_in">len</span>(cipher):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Correct flag!&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Wrong flag!&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>å…ˆå¤§è‡´ç†è§£ç¨‹åºå†…å®¹ï¼šç¨‹åºéœ€è¦ä½ è¾“å…¥ä¸€ä¸²flagå€¼ï¼Œå¹¶å°†flagå€¼é€ä¸ªè¿›è¡ŒRC4åŠ å¯†å¹¶æ£€æŸ¥æ˜¯å¦ä¸å¯†æ–‡ç›¸ç­‰ï¼Œå½“è¾“å…¥çš„flagä¸²åŠ å¯†å€¼ä¸å¯†æ–‡å®Œå…¨ç›¸ç­‰æ—¶ï¼Œä¾¿é€šè¿‡äº†æ£€æŸ¥ï¼Œç¨‹åºè¾“å‡ºâ€Correct flag!â€ã€‚</p>
<p>æ‰€ä»¥ï¼Œè¿™ä¹ˆä¸€å¤§æ®µå…¶å®å°±åªå®ç°äº†ä¸€ä¸ªå†…å®¹ï¼šæ£€æŸ¥ä½ è¾“å…¥çš„flagå’Œä½ å®é™…è¦æäº¤çš„flagæ˜¯å¦ç›¸ç­‰ï¼å¯ä»¥è¯´ï¼Œæ•´ä¸ªç¨‹åºéƒ½æ˜¯ä¸€ä¸ªéšœçœ¼æ³•ï¼Œå…¶å®ä¸è¦è¿™ä¸ªRC4ï¼Œç›´æ¥ç”¨ä»¥ä¸‹çš„ä»£ç æ£€æŸ¥ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼š(å‡è®¾å®é™…flagä¸²åä¸ºsecret)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag = <span class="built_in">input</span>(<span class="string">&quot;input flag&gt;&gt; &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(flag == secret):</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;Correct flag!&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;Wrong flag!&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å°±è¡Œäº†ï¼æ‰€ä»¥ç”¨è¿™ä¹ˆä¸€å¤§æ®µæ¥æ ¸æŸ¥flagä¸€å®šæœ‰é—®é¢˜ã€‚</p>
<p>ä»”ç»†æ ¸æŸ¥ï¼Œæœç„¶ï¼Œä¸‹é¢è¿™æ®µä»£ç å¤§æœ‰ç„æœºï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> i &lt; <span class="built_in">len</span>(flag):</span><br><span class="line">    <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(flag) <span class="keyword">and</span> flag[i] <span class="keyword">not</span> <span class="keyword">in</span> table:</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> i &gt;= <span class="built_in">len</span>(flag):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> cipher[i] != encoder.do_encrypt(flag[i]):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong flag!&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç å­˜åœ¨ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li>è¾“å…¥çš„flagä¸²ä¸­å«æœ‰ä¸åœ¨tableä¸­çš„é¡¹æ—¶ï¼Œä¼šä¸€ç›´è·³è¿‡ç›´è‡³è¯»åˆ°tableä¸­çš„å­—ç¬¦ä¸ºæ­¢ï¼Œä½†æ˜¯æŒ‡æ•° i ä¼šä¸€ç›´å¢åŠ ã€‚</li>
<li>åˆ¤æ–­æŒ‡æ•° i è¿‡å¤§ï¼Œä¾é çš„æ˜¯è¾“å…¥çš„å­—ç¬¦ä¸²é•¿åº¦ï¼Œè€Œä¸æ˜¯å®é™…çš„flagä¸²ã€‚</li>
<li>å°†cipher[i]ä¸encrypt(flag[i])è¿›è¡Œæ¯”å¯¹æ—¶ï¼Œå¹¶æ²¡æœ‰å¯¹cipherçš„æŒ‡æ•°è¿›è¡Œæ£€æŸ¥ã€‚</li>
</ul>
<p>è¿™ä½“ç°äº†ä¸€ä¸ªå¾ˆé‡è¦çš„ä¿¡æ¯ï¼š</p>
<ul>
<li>å¦‚æœä½ çš„è¾“å…¥æ˜¯æ­£å¸¸çš„é”™è¯¯flagä¸²ï¼Œä»–ä¼šæ‰“å°çš„å†…å®¹æ˜¯â€Wrong flag!â€</li>
<li>å¦‚æœä½ çš„è¾“å…¥æ˜¯ä¸æ­£å¸¸çš„æ„é€ çš„å­—ç¬¦ä¸²å¯¼è‡´cipher[i]è¶Šç•Œäº†ï¼Œç¨‹åºä¸ä¼šæ­£å¸¸æ‰“å°å†…å®¹ï¼Œè€Œä¼šæŠ¥é”™ï¼</li>
</ul>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œæ„é€ å¦‚ä¸‹ä¸¤ä¸ªä¸²ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag = &quot;cnss&#123;1234567890abcdefgh&#125;&quot;</span><br><span class="line">flag = chr(0) * 50 + &quot;c&quot;</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆï¼Œç¨‹åºå¯¹ç¬¬ä¸¤ä¸ªå­—ç¬¦ä¸²çš„å¤„ç†åˆ†åˆ«æ˜¯ï¼š</p>
<p>ç”±äºç¬¬ä¸€ä¸ªä¸²å­—ç¬¦å‡åœ¨tableä¸­ï¼Œå› æ­¤ç¨‹åºä»…ä»…ä¼šå°†æ¯ä¸ªå­—ç¬¦ä¸æ­£ç¡®flagè¿›è¡Œæ¯”å¯¹ï¼Œç›´åˆ°æŸä¸ªå­—ç¬¦æ¯”å¯¹å¤±è´¥æ—¶ï¼Œæ‰“å°å‡ºâ€Wrong flag!â€</p>
<p>è€Œç¬¬äºŒä¸ªä¸²å‰äº”åä¸ªå­—ç¬¦å‡æ˜¯ASCIIç ä¸º0çš„å­—ç¬¦ï¼Œæ˜¯ä¸åœ¨tableä¸­çš„ï¼Œå› æ­¤ç¨‹åºä¼šå…ˆåå¤æ‰§è¡Œä»¥ä¸‹è¯­å¥ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> i &lt; <span class="built_in">len</span>(flag) <span class="keyword">and</span> flag[i] <span class="keyword">not</span> <span class="keyword">in</span> table:</span><br><span class="line">    i += <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>ç›´è‡³ç¬¬51ä¸ªå­—ç¬¦â€câ€ï¼Œç”±äºâ€câ€åœ¨tableä¸­ï¼Œå› æ­¤ä¼šè¿›è¡Œæ¯”å¯¹ã€‚æ­¤æ—¶i=51ï¼Œè€Œç”±é¢˜ç›®çŸ¥é“ï¼Œflagé•¿åº¦ä¸å¤§äº50ï¼Œå› æ­¤è¿™æ—¶æ‰§è¡Œè¿™æ¡è¯­å¥è¿›è¡Œæ¯”å¯¹æ—¶ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> cipher[i] != encoder.do_encrypt(flag[i]):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Wrong flag!&quot;</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>cipher[i]æ˜¯å¿…å®šè¶Šç•Œçš„ï¼é‚£ä¹ˆç¨‹åºå°±ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œè€Œä¸å†æ˜¯æ‰“å°â€Wrong flag!â€äº†ã€‚</p>
<p>è¿™æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿç”¨å¤„å¾ˆå¤§ã€‚é¦–å…ˆæˆ‘ä»¬å°±å¯ä»¥åå¤æ„é€ å¦‚ä¸‹å­—ç¬¦ä¸²ï¼Œå‘é€ç»™é¶æœºç«¯æ¥ç¡®å®šçœŸå®flagçš„æ­£ç¡®é•¿åº¦ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag = <span class="built_in">chr</span>(<span class="number">0</span>) * <span class="number">49</span> + <span class="string">&quot;c&quot;</span></span><br><span class="line">flag = <span class="built_in">chr</span>(<span class="number">0</span>) * <span class="number">48</span> + <span class="string">&quot;c&quot;</span></span><br><span class="line">flag = <span class="built_in">chr</span>(<span class="number">0</span>) * <span class="number">47</span> + <span class="string">&quot;c&quot;</span></span><br><span class="line">......</span><br></pre></td></tr></table></figure>
<p>ä¸ºä»€ä¹ˆè¿™æ ·å°±å¯ä»¥ç¡®å®šé•¿åº¦å‘¢ï¼Ÿæˆ‘ä»¬å‡è®¾flagçš„æ­£ç¡®é•¿åº¦æ˜¯30ï¼Œé‚£ä¹ˆå‘é€ä¸‹é¢å­—ç¬¦ä¸²ç»™é¶æœºï¼Œé¶æœºçš„å›åº”éƒ½æ˜¯â€œå¼‚å¸¸â€è€Œéé”™è¯¯ï¼Œè¿™æ˜¯å› ä¸ºcipheræ•°ç»„çš„ä¸‹æ ‡æœ€å¤šåªèƒ½å–åˆ°29ï¼Œä¸€æ—¦æ¶‰åŠåˆ°cipher[30]ç”šè‡³æ›´å¤šå°±ä¼šäº§ç”Ÿè¶Šç•Œå¼‚å¸¸ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag = <span class="built_in">chr</span>(<span class="number">0</span>) * <span class="number">49</span> + <span class="string">&quot;c&quot;</span></span><br><span class="line">flag = <span class="built_in">chr</span>(<span class="number">0</span>) * <span class="number">48</span> + <span class="string">&quot;c&quot;</span></span><br><span class="line">flag = <span class="built_in">chr</span>(<span class="number">0</span>) * <span class="number">47</span> + <span class="string">&quot;c&quot;</span></span><br><span class="line">......</span><br><span class="line">flag = <span class="built_in">chr</span>(<span class="number">0</span>) * <span class="number">30</span> + <span class="string">&quot;c&quot;</span></span><br></pre></td></tr></table></figure>
<p>ç„¶è€Œå‘é€ä¸‹ä¸€ä¸ªflagä¸²ï¼Œä¹Ÿå°±æ˜¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag = <span class="built_in">chr</span>(<span class="number">0</span>) * <span class="number">29</span> + <span class="string">&quot;c&quot;</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ—¶ï¼Œç”±äºæ²¡æœ‰è¶Šç•Œï¼Œç¨‹åºä¼šå›åº”â€Wrong flag!â€ï¼Œè€Œä¸å†æŠ›å‡ºå¼‚å¸¸äº†ã€‚</p>
<p>æ‰€ä»¥ï¼Œç”±ä¸Šè¿°æ–¹å¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥æœ€ç»ˆç¡®å®šflagçš„çœŸå®é•¿åº¦æ˜¯24ï¼Œä¹‹ååˆ™å¯ä»¥åå¤æ„é€ ä¸‹åˆ—å­—ç¬¦ä¸²ï¼Œå¹¶å‘é€ç»™é¶æœºç«¯æ¥é€ä¸ªæ ¸æŸ¥å­—ç¬¦æ˜¯å¦æ­£ç¡®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> table:</span><br><span class="line">	flag = <span class="string">&quot;cnss&#123;&quot;</span> + i + <span class="built_in">chr</span>(<span class="number">0</span>)*<span class="number">100</span> + <span class="string">&quot;a&quot;</span></span><br></pre></td></tr></table></figure>
<p>é“ç†ä¹Ÿæ˜¯ç›¸åŒçš„ï¼Œå¦‚æœiæ˜¯é”™è¯¯å­—ç¬¦ï¼Œé‚£ä¹ˆæ ¸æŸ¥ä¸é€šè¿‡ï¼Œç¨‹åºç›´æ¥å›åº”â€Wrong flag!â€ï¼Œè€Œå¦‚æœæ˜¯æ­£ç¡®å­—ç¬¦ï¼Œç¨‹åºåˆ™ä¼šç»§ç»­å‘åè¯»ï¼Œä¸€ç›´åˆ°è¯»åˆ°è¶Šç•Œçš„â€aâ€åï¼ŒæŠ›å‡ºè¶Šç•Œå¼‚å¸¸ã€‚</p>
<p>å¾—åˆ°è¿™ä¸ªå­—ç¬¦ä¸º â€œ1â€ åï¼Œå°†ä»–åŠ å…¥â€cnss{â€œä¸²åï¼Œç»§ç»­æ„é€ ä¸‹é¢å­—ç¬¦ä¸²ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> table:</span><br><span class="line">	flag = <span class="string">&quot;cnss&#123;1&quot;</span> + i + <span class="built_in">chr</span>(<span class="number">0</span>)*<span class="number">100</span> + <span class="string">&quot;a&quot;</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æ­¤åå¤å‘é€ç›´è‡³flagä¸²å·²çŸ¥çš„éƒ¨åˆ†é•¿åº¦ä¸º24å³å¯ã€‚</p>
<p>æ„é€ å­—ç¬¦ä¸²å¹¶å‘é€ç»™é¶æœºç«¯éœ€è¦ç”¨åˆ°pwntoolsï¼ŒåŒæ—¶è¿˜æœ‰ä¸€äº›å°ç»†èŠ‚éœ€è¦æ³¨æ„ï¼Œæ¯”å¦‚éœ€è¦å‘é€çš„æ˜¯å­—èŠ‚æµè€Œéå­—ç¬¦ä¸²æµã€‚ä½†æ˜¯è¿™äº›æ…¢æ…¢è°ƒè¯•ç¨‹åºå°±å¥½äº†ã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">table = string.digits + string.ascii_letters + <span class="string">&quot;&#123;&#125;_&quot;</span></span><br><span class="line"></span><br><span class="line">init = <span class="string">b&#x27;cnss&#123;&#x27;</span></span><br><span class="line">has_find = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span>(has_find == <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(table)):</span><br><span class="line">        r=remote(<span class="string">&quot;47.108.140.140&quot;</span>,<span class="number">11037</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r.sendline(init + long_to_bytes(<span class="built_in">ord</span>(table[i])) + <span class="string">b&#x27;\x00&#x27;</span>*<span class="number">100</span> + <span class="string">b&quot;a&quot;</span>)</span><br><span class="line">            temp = r.recvline()</span><br><span class="line">            <span class="keyword">if</span>(<span class="string">b&quot;Correct&quot;</span> <span class="keyword">in</span> temp):</span><br><span class="line">                exit(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">len</span>(init) == <span class="number">23</span>):</span><br><span class="line">                has_find = <span class="number">1</span></span><br><span class="line">                r.close()</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            init += long_to_bytes(<span class="built_in">ord</span>(table[i]))</span><br><span class="line">            <span class="built_in">print</span>(init)</span><br><span class="line">            r.close()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        r.close()</span><br><span class="line"><span class="built_in">print</span>(init + <span class="string">b&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flagï¼š</p>
<p><strong>cnss{1nd3X_0Ut_oF_r4nge}</strong></p>
<p><br></p>
<p>ç¡®å®å¾ˆæœ‰æ„æ€ï¼</p>
]]></content>
      <categories>
        <category>miscè¶£é¢˜</category>
      </categories>
  </entry>
  <entry>
    <title>2023-SICTF-#Round2-wp-crypto</title>
    <url>/post/445800a5.html</url>
    <content><![CDATA[<p>è¿™æ¬¡æ¯”èµ›Cryptoéš¾åº¦æ¯”è¾ƒåŸºç¡€ï¼Œæ‰‹é€Ÿå¿«æ‰æ˜¯ç¡¬é“ç†ã€‚</p>
<span id="more"></span>
<p>Rankï¼š2</p>
<p><img src="/post/445800a5/image-20230911152911874.png" alt="image-20230911152911874"></p>
<p><br></p>
<p><br></p>
<h3 id="ç­¾åˆ°-å¤å…¸å¤§æ‚çƒ©"><a href="#ç­¾åˆ°-å¤å…¸å¤§æ‚çƒ©" class="headerlink" title="[ç­¾åˆ°]å¤å…¸å¤§æ‚çƒ©"></a>[ç­¾åˆ°]å¤å…¸å¤§æ‚çƒ©</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¯·å°è¯•è§£å¯†å®ƒã€‚</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ğŸ©ğŸ‘ƒğŸªğŸ¼ğŸ‘…ğŸ¯ğŸ©ğŸ‘ˆğŸ‘‡ğŸ‘­ğŸ‘ŸğŸ‘ğŸºğŸ­ğŸ‘‰ğŸ‘™ğŸ‘¤ğŸ‘‹ğŸ‘šğŸªğŸ«ğŸ‘ğŸ‘¢ğŸ‘®ğŸ‘±ğŸ¼ğŸ‘¢ğŸ‘¨ğŸ‘ ğŸ‘­ğŸ½ğŸ°ğŸ»ğŸ‘šğŸ‘‚ğŸ‘§ğŸ‘ ğŸ‘¥ğŸ‘›ğŸ‘®ğŸ‘¯ğŸ‘®ğŸ‘¬ğŸ¾ğŸ‘ğŸ‘›ğŸ‘ŒğŸ‘šğŸ‘ğŸ¨ğŸ‘ğŸ‘‰ğŸ‘†ğŸ¿ğŸ‘†ğŸ‘˜ğŸ‘‡ğŸºğŸ‘¦ğŸ¸ğŸ‘ƒğŸ­ğŸ‘ŸğŸ‘‘ğŸ‘ªğŸ‘ƒğŸ‘ğŸ»ğŸ»ğŸ‘œğŸ§ğŸ‘‡ğŸ‘ŠğŸ§ğŸ¾ğŸ¼ğŸ‘‡ğŸ«ğŸºğŸ‘ğŸ‘†ğŸ‘ªğŸ¼ğŸ‘‹ğŸ‘ŒğŸ‘§ğŸ»ğŸ‘ğŸ©ğŸºğŸ‘¥ğŸ½ğŸ‘‹ğŸ‘‰ğŸ°ğŸ‘ğŸ‘ ğŸ‘ ğŸ‘£ğŸ§ğŸ«ğŸ‘§ğŸ­ğŸ‘¢ğŸ¯ğŸ‘‘ğŸ‘‘ğŸ®ğŸ‘‚ğŸ‘ğŸ»ğŸ‘¥ğŸ‘šğŸ®ğŸ‘‹ğŸ‘¬ğŸ‘ŒğŸ‘¥ğŸ‘ğŸ‘£ğŸ‘…ğŸ‘§ğŸ‘¯ğŸ‘¦ğŸ‘ŒğŸ‘ŒğŸ‘ğŸ‘ ğŸ‘ŒğŸ½ğŸ‘‰ğŸ‘ƒğŸ‘ŠğŸ«ğŸ‘‰ğŸ¨ğŸ®ğŸ‘©ğŸ‘†ğŸªğŸ¯ğŸ‘˜ğŸ‘ğŸ‘ğŸ¼ğŸ‘©ğŸ‘ğŸ‘ŠğŸ‘ğŸ‘¡ğŸ‘€ğŸ‘°ğŸ‘‹ğŸ‘£ğŸ‘¨ğŸ‘§ğŸ‘ğŸ‘œğŸ‘ğŸ‘›ğŸ®ğŸ‘˜ğŸ‘…ğŸ‘ ğŸ¿ğŸ‘‚ğŸ‘°ğŸ‘„ğŸ‘ˆğŸ‘ğŸ‘ ğŸ‘¤ğŸ‘ƒğŸ‘›ğŸ‘˜ğŸ­ğŸ‘…ğŸ‘±ğŸ‘†ğŸ‘¬ğŸ‘«ğŸ‘¥ğŸ‘†ğŸ½ğŸ‘ğŸ‘ğŸ‘¥ğŸ‘ŠğŸ‘‡ğŸ‘‰ğŸ‘ŠğŸ‘©ğŸ‘ŒğŸ‘­ğŸ«ğŸ«ğŸ‘¬ğŸ‘±ğŸ¯ğŸ‘‡ğŸºğŸ‘ğŸ‘ğŸ‘‘ğŸ‘™ğŸ®ğŸ‘œğŸ‘‹ğŸ‘˜ğŸ‘ªğŸ‘©ğŸ‘šğŸ‘¦ğŸ‘¨ğŸ‘€ğŸ‘©ğŸ‘ğŸ‘‰ğŸ‘ƒğŸ¾ğŸ‘¥ğŸ‘€ğŸ«ğŸ‘ğŸ‘ğŸ©ğŸ§ğŸ‘°ğŸ‘†ğŸ‘‡ğŸ‘¨ğŸªğŸ‘ƒğŸ­ğŸ‘¦ğŸ«ğŸ‘±</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€å±‚å¾ˆæ˜æ˜¾æ˜¯base100ï¼Œä¹‹åçš„æ¯ä¸€å±‚åƒå“ªä¸ªbaseç”¨å“ªä¸ªè§£å¯†å³å¯ï¼š</p>
<p>1ã€ base100ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2L3EN82QPvhfC6RbmTc34VkwzEkqivF9DcKpindwxwuGYdUcg1XROHOaPCoAL6hZsLJDDe0PS0GEP4CYOsETUpDY2CnFTR9Wiil04p6k8ZZ7KXDnc7TuUnJlNpxoUUViUFRLS4R17rO38aXXErVSVjIyTlqpVeYd7aNiHKyMQfimLda6NzOutnOFJYnSPRSrUv44uz8PCJgZb7eTasrcoqIrYRLGnI4fV20yOPq3L6o4z</span><br></pre></td></tr></table></figure>
<p>2ã€ base62ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">UlhoYUdxZTdaY1FCbXFyaWl5S0ZKaW4yN2ZiWkpTZHhOd2hBVk1wNzRvUWE0VWs2RXVqTlpkTHNvYVpxNHRMUDd3dXk4OGJiSlhlTGJnN2dxR2RkTm15dGs1S1RGdlk3TmpRR0wzenFrQ3BCM3lmUTFTUkY0OU13Z0JjZkFxWjFhNng=</span><br></pre></td></tr></table></figure>
<p>3ã€base64ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">RXhaGqe7ZcQBmqriiyKFJin27fbZJSdxNwhAVMp74oQa4Uk6EujNZdLsoaZq4tLP7wuy88bbJXeLbg7gqGddNmytk5KTFvY7NjQGL3zqkCpB3yfQ1SRF49MwgBcfAqZ1a6x</span><br></pre></td></tr></table></figure>
<p>4ã€ base58ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">G53XC4LIK5DWQ53UIFSGCUTCJFCGM4DSM5UXOYTILBUXU6TXJ5SUUT2DONHTQZ3GJNCFSUDINRXE6MTEINUXOQLVLI4VU===</span><br></pre></td></tr></table></figure>
<p>5ã€ base32ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">7wqqhWGhwtAdaRbIDfprgiwbhXizzwOeJOCsO8gfKDYPhlnO2dCiwAuZ9Z</span><br></pre></td></tr></table></figure>
<p>6ã€base62ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SICTF&#123;fe853b49-8730-462e-86f5-fc8e9789f077&#125;</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>SICTF{fe853b49-8730-462e-86f5-fc8e9789f077}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="Radio"><a href="#Radio" class="headerlink" title="Radio"></a>Radio</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ ‘æœ¨æ–°å¼€å‘äº†ä¸€ä¸ªåŠ å¯†ç³»ç»Ÿï¼Œè¿™ä¸ªç³»ç»Ÿä¼šæŠŠä»–çš„ç§˜å¯†åŠ å¯†å¾ˆå¤šæ¬¡ç„¶åå‘é€ç»™ä¸åŒçš„ç”¨æˆ·ï¼Œä½ èƒ½æ‰¾åˆ°å…¶ä¸­çš„æ¼æ´å—ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n1 = p * q</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n2 = p * q</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n3 = p * q</span><br><span class="line">e = <span class="number">17</span></span><br><span class="line">c1 = <span class="built_in">pow</span>(m,e,n1)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m,e,n2)</span><br><span class="line">c3 = <span class="built_in">pow</span>(m,e,n3)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n1 =&quot;</span>,n1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n2 =&quot;</span>,n2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n3 =&quot;</span>,n3)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c1 =&quot;</span>,c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c2 =&quot;</span>,c2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c3 =&quot;</span>,c3)</span><br></pre></td></tr></table></figure>
<p>ç»å…¸çš„å¹¿æ’­æ”»å‡»ï¼Œæ€è·¯å°±æ˜¯ä½¿ç”¨ä¸­å›½å‰©ä½™å®šç†å¾—åˆ°$\quad mod \; (n1n2n3)\quad$ä¸‹çš„$\quad m^{17}\quad$ï¼Œå†å¼€17æ¬¡æ–¹æ ¹å³å¯ã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt </span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n1 = </span><br><span class="line">n2 = </span><br><span class="line">n3 = </span><br><span class="line">c1 = </span><br><span class="line">c2 = </span><br><span class="line">c3 = </span><br><span class="line">e = <span class="number">17</span></span><br><span class="line"></span><br><span class="line">n = [n1,n2,n3]</span><br><span class="line">c = [c1,c2,c3]</span><br><span class="line">M = crt(n,c)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(iroot(M,<span class="number">17</span>)[<span class="number">0</span>]))</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>SICTF{fdc0afb5-1c81-46b9-a28a-241f5f64419d}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="MingTianPao"><a href="#MingTianPao" class="headerlink" title="MingTianPao"></a>MingTianPao</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">è¿™ä¸ªé¢˜ç›®åå……åˆ†è¡¨ç°äº†ä½œè€…ç”±äºå­¦CTFå¯¼è‡´åƒä¸ä¸Šé¥­ï¼Œæ˜å¤©å°±æ‰“ç®—è·‘è·¯çš„å¿ƒé‡Œæƒ³æ³•ã€‚</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, message</span><br><span class="line"><span class="comment"># message is a Classic English Story</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    tmp = (message[i*<span class="number">30</span>:(i+<span class="number">1</span>)*<span class="number">30</span>].encode())</span><br><span class="line">    <span class="built_in">print</span>(binascii.hexlify(strxor(tmp,flag)).decode())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1f2037202a1e6d06353b61263d050a0538493b3018544e14171d2b1c4218</span></span><br><span class="line"><span class="comment"># 3769373b66142f31297f291126410e042b01162d59103a0c005221075013</span></span><br><span class="line"><span class="comment"># 37242c202e1e3f743c36371130410c1e2b491a31574406014505291a550e</span></span><br><span class="line"><span class="comment"># 7f6922742e1a213270372e01264105193004532b1f554e120c1e2a145618</span></span><br><span class="line"><span class="comment"># 7d69143c23156d18392b35183141310e3b49213613590003453a291a555d</span></span><br><span class="line"><span class="comment"># 36273731341e297424372454230e0c0f2c49127f005f020245112718545d</span></span><br><span class="line"><span class="comment"># 26396320295b2531227161273c04430f360d533118444e0f0b1d31554615</span></span><br><span class="line"><span class="comment"># 323d6335660c24373b3a2554350f0a063e05533712101905165e66145f19</span></span><br><span class="line"><span class="comment"># 733e222766152220703e27063508074b300f53371e5d40444735291a555d</span></span><br><span class="line"><span class="comment"># 37283a7432146d2d3f2a6d541808171f330c530d12544e360c162f1b565d</span></span><br></pre></td></tr></table></figure>
<p>å¾ˆæ˜ç¡®çš„ä¸€ä¸ªMany-Time-Padï¼Œä¹Ÿå¯¹åº”äº†é¢˜ç›®åå­—MTPï¼Œé¢„æœŸæ¥è¯´åº”è¯¥æ˜¯ä¸Šä¸€ä¸ªçŸ¥åMTPè„šæœ¬æ±‚è§£ã€‚</p>
<p>ä½†æ˜¯å…¶å®å®Œå…¨ä¸éœ€è¦ï¼Œå› ä¸ºé¢˜ç›®ç»™äº†è¿™æ ·ä¸€ä¸ªæç¤ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># message is a Classic English Story</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬åˆæœ‰flagçš„å‰å…­ä¸ªå­—ç¬¦ï¼š<strong>SICTF{</strong></p>
<p>é‚£ä¹ˆæ‹¿å»å¼‚æˆ–ä¸€ä¸‹å°±æœ‰ï¼š</p>
<p><img src="/post/445800a5/image-20230908224043439.png" alt="image-20230908224043439"></p>
<p>åˆç†çŒœæµ‹è¿™æ˜¯ä¸€ä¸ªLittleå¼€å¤´çš„è‹±è¯­æ•…äº‹ï¼Œé‚£ä¹ˆç”±äºå¼‚æˆ–çš„å¯é€†æ€§ï¼Œç›´æ¥æŠŠå¯†æ–‡æ¬ä¸Šæ˜æ–‡çš„ä½ç½®ï¼Œæ¥è¯•å‡ ä¸ªï¼š</p>
<p>Little Princeï¼ˆå°ç‹å­ï¼‰ï¼š</p>
<p><img src="/post/445800a5/image-20230908224223829.png" alt="image-20230908224223829"></p>
<p>ä¸å¤ªå¯¹ï¼Œæ¢ä¸€ä¸ªï¼ŒLittle Red Riding Hoodï¼š</p>
<p><img src="/post/445800a5/image-20230908224336581.png" alt="image-20230908224336581"></p>
<p>è¿™å°±æˆäº†ï¼Œåˆå¯ä»¥çœ‹å‡ºflagä¸²åé¢åº”è¯¥æ˜¯wonderfulçš„å˜å½¢ï¼Œé‚£ä¹ˆå†æŠŠflagä¸²æ¬ä¸Šæ¥é€ä¸ªå°è¯•å³å¯ï¼šï¼ˆå› ä¸ºå¯ä»¥å˜çš„å…¶å®å°±å¤§å°å†™ã€ä»¥åŠå½¢è¿‘æ•°å­—ï¼Œä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªå­—ç¬¦å¢åŠ ï¼Œè¯•å‡ æ¬¡å°±å‡ºæ¥äº†ï¼‰ï¼š</p>
<p><img src="/post/445800a5/image-20230908224509359.png" alt="image-20230908224509359"></p>
<p>flagï¼š</p>
<p><strong>SICTF{MTP_AtTack_is_w0nderFu1}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="Easy-CopperSmith"><a href="#Easy-CopperSmith" class="headerlink" title="Easy_CopperSmith"></a>Easy_CopperSmith</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä½ çŸ¥é“CopperSmithå—ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">leak = p &gt;&gt; <span class="number">230</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(leak)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">114007680041157617250208809154392208683967639953423906669116998085115503737001019559692895227927818755160444076128820965038044269092587109196557720941716578025622244634385547194563001079609897387390680250570961313174656874665690193604984942452581886657386063927035039087208310041149977622001887997061312418381</span></span><br><span class="line"><span class="string">6833525680083767201563383553257365403889275861180069149272377788671845720921410137177</span></span><br><span class="line"><span class="string">87627846271126693177889082381507430884663777705438987267317070845965070209704910716182088690758208915234427170455157948022843849997441546596567189456637997191173043345521331111329110083529853409188141263211030032553825858341099759209550785745319223409181813931086979471131074015406202979668575990074985441810</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>ç›´ç™½çš„pé«˜ä½æ³„æ¼ï¼Œç›´æ¥è§£å¯†å³å¯ã€‚</p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">114007680041157617250208809154392208683967639953423906669116998085115503737001019559692895227927818755160444076128820965038044269092587109196557720941716578025622244634385547194563001079609897387390680250570961313174656874665690193604984942452581886657386063927035039087208310041149977622001887997061312418381</span></span><br><span class="line">p4 = <span class="number">6833525680083767201563383553257365403889275861180069149272377788671845720921410137177</span></span><br><span class="line">c = <span class="number">87627846271126693177889082381507430884663777705438987267317070845965070209704910716182088690758208915234427170455157948022843849997441546596567189456637997191173043345521331111329110083529853409188141263211030032553825858341099759209550785745319223409181813931086979471131074015406202979668575990074985441810</span></span><br><span class="line">e =  <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">pbits = <span class="number">512</span></span><br><span class="line">kbits=pbits - p4.nbits()</span><br><span class="line">p4 = p4 &lt;&lt; kbits</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x + p4</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^kbits,beta=<span class="number">0.4</span>,epsilon = <span class="number">0.01</span>)</span><br><span class="line"><span class="comment"># ç»è¿‡ä»¥ä¸Šä¸€äº›å‡½æ•°å¤„ç†åï¼Œnå’Œpå·²ç»è¢«è½¬åŒ–ä¸º10è¿›åˆ¶</span></span><br><span class="line"><span class="keyword">if</span> roots:</span><br><span class="line">    p= p4 + <span class="built_in">int</span>(roots[<span class="number">0</span>])</span><br><span class="line">    q = n//p</span><br><span class="line">d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>SICTF{3f9366ed-b8e4-412f-bbd0-62616a24115c}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="ç­¾åˆ°é¢˜æ¥å’¯ï¼"><a href="#ç­¾åˆ°é¢˜æ¥å’¯ï¼" class="headerlink" title="ç­¾åˆ°é¢˜æ¥å’¯ï¼"></a>ç­¾åˆ°é¢˜æ¥å’¯ï¼</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç­¾åˆ°é¢˜æ¥å’¯ï¼</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span>  Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">e = getPrime(<span class="number">10</span>)</span><br><span class="line">n = p*q</span><br><span class="line">c1 = <span class="built_in">pow</span>(<span class="number">114</span>*m+<span class="number">2333</span>,e,n)</span><br><span class="line">c2 = <span class="built_in">pow</span>(<span class="number">514</span>*m+<span class="number">4555</span>,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c1 = <span class="subst">&#123;c1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c2 = <span class="subst">&#123;c2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 18993579800590288733556762316465854395650778003397512624355925069287661487515652428099677335464809283955351330659278915073219733930542167360381688856732762552737791137784222098296804826261681852699742456526979985201331982720936091963830799430264680941164508709453794113576607749669278887105809727027129736803614327631979056934906547015919204770702496676692691248702461766117271815398943842909579917102217310779431999448597899109808086655029624478062317317442297276087073653945439820988375066353157221370129064423613949039895822016206336117081475698987326594199181180346821431242733826487765566154350269651592993856883</span></span><br><span class="line"><span class="string">c1 = 3089900890429368903963127778258893993015616003863275300568951378177309984878857933740319974151823410060583527905656182419531008417050246901514691111335764182779077027419410717272164998075313101695833565450587029584857433998627248705518025411896438130004108810308599666206694770859843696952378804678690327442746359836105117371144846629293505396610982407985241783168161504309420302314102538231774470927864959064261347913286659384383565379900391857812482728653358741387072374314243068833590379370244368317200796927931678203916569721211768082289529948017340699194622234734381555103898784827642197721866114583358940604520</span></span><br><span class="line"><span class="string">c2 = 6062491672599671503583327431533992487890060173533816222838721749216161789662841049274959778509684968479022417053571624473283543736981267659104310293237792925201009775193492423025040929132360886500863823523629213703533794348606076463773478200331006341206053010168741302440409050344170767489936681627020501853981450212305108039373119567034948781143698613084550376070802084805644270376620484786155554275798939105737707005991882264123315436368611647275530607811665999620394422672764116158492214128572456571553281799359243174598812137554860109807481900330449364878168308833006964726761878461761560543284533578701661413931</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>ç»å…¸çš„æ˜æ–‡ç›¸å…³æ¶ˆæ¯æ”»å‡»ï¼Œç•¥åšäº†ä¸€ç‚¹å˜ç§ã€‚æ€è·¯å¦‚ä¸‹ï¼Œåˆ—å‡ºä¸¤ä¸ªå¤šé¡¹å¼ï¼š</p>
<script type="math/tex; mode=display">
(114*x+2333)^{e}\equiv c1\quad (mod\;n)</script><script type="math/tex; mode=display">
(514*x+4555)^{e}\equiv c2\quad (mod\;n)</script><p>åˆå› ä¸ºæ˜æ–‡mæ˜¾ç„¶æ˜¯ä¸¤ä¸ªæ¨¡å¤šé¡¹å¼çš„æ ¹ï¼Œå› æ­¤ä¸¤ä¸ªæ¨¡å¤šé¡¹å¼æœ‰å…¬å› å­ï¼š</p>
<script type="math/tex; mode=display">
(x-m)</script><p>å› æ­¤æ„é€ å‡ºæ¨¡nç¯ä¸‹çš„ä¸¤ä¸ªå¤šé¡¹å¼ï¼Œå¹¶æ±‚å…¬å› å¼å³å¯ã€‚è‡³äºeæ˜¯å¤šå°‘ï¼Œä»…éœ€è¦åœ¨æŒ‡å®šèŒƒå›´å†…çˆ†ç ´ä¸€ä¸‹å°±å¯ä»¥ã€‚</p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">18993579800590288733556762316465854395650778003397512624355925069287661487515652428099677335464809283955351330659278915073219733930542167360381688856732762552737791137784222098296804826261681852699742456526979985201331982720936091963830799430264680941164508709453794113576607749669278887105809727027129736803614327631979056934906547015919204770702496676692691248702461766117271815398943842909579917102217310779431999448597899109808086655029624478062317317442297276087073653945439820988375066353157221370129064423613949039895822016206336117081475698987326594199181180346821431242733826487765566154350269651592993856883</span></span><br><span class="line">c1 = <span class="number">3089900890429368903963127778258893993015616003863275300568951378177309984878857933740319974151823410060583527905656182419531008417050246901514691111335764182779077027419410717272164998075313101695833565450587029584857433998627248705518025411896438130004108810308599666206694770859843696952378804678690327442746359836105117371144846629293505396610982407985241783168161504309420302314102538231774470927864959064261347913286659384383565379900391857812482728653358741387072374314243068833590379370244368317200796927931678203916569721211768082289529948017340699194622234734381555103898784827642197721866114583358940604520</span></span><br><span class="line">c2 = <span class="number">6062491672599671503583327431533992487890060173533816222838721749216161789662841049274959778509684968479022417053571624473283543736981267659104310293237792925201009775193492423025040929132360886500863823523629213703533794348606076463773478200331006341206053010168741302440409050344170767489936681627020501853981450212305108039373119567034948781143698613084550376070802084805644270376620484786155554275798939105737707005991882264123315436368611647275530607811665999620394422672764116158492214128572456571553281799359243174598812137554860109807481900330449364878168308833006964726761878461761560543284533578701661413931</span></span><br><span class="line">a1 = <span class="number">114</span></span><br><span class="line">b1 = <span class="number">2333</span></span><br><span class="line">a2 = <span class="number">514</span></span><br><span class="line">b2 = <span class="number">4555</span></span><br><span class="line">elist = [<span class="number">521</span>,<span class="number">523</span>,<span class="number">541</span>,<span class="number">547</span>,<span class="number">557</span>,<span class="number">563</span>,<span class="number">569</span>,<span class="number">571</span>,<span class="number">577</span>,<span class="number">587</span>,<span class="number">593</span>,<span class="number">599</span>,<span class="number">601</span>,<span class="number">607</span>,<span class="number">613</span>,<span class="number">617</span>,<span class="number">619</span>,<span class="number">631</span>,<span class="number">641</span>,<span class="number">643</span>,<span class="number">647</span>,<span class="number">653</span>,<span class="number">659</span>,<span class="number">661</span>,<span class="number">673</span>,<span class="number">677</span>,<span class="number">683</span>,<span class="number">691</span>,<span class="number">701</span>,<span class="number">709</span>,<span class="number">719</span>,<span class="number">727</span>,<span class="number">733</span>,<span class="number">739</span>,<span class="number">743</span>,<span class="number">751</span>,<span class="number">757</span>,<span class="number">761</span>,<span class="number">769</span>,<span class="number">773</span>,<span class="number">787</span>,<span class="number">797</span>,<span class="number">809</span>,<span class="number">811</span>,<span class="number">821</span>,<span class="number">823</span>,<span class="number">827</span>,<span class="number">829</span>,<span class="number">839</span>,<span class="number">853</span>,<span class="number">857</span>,<span class="number">859</span>,<span class="number">863</span>,<span class="number">877</span>,<span class="number">881</span>,<span class="number">883</span>,<span class="number">887</span>,<span class="number">907</span>,<span class="number">911</span>,<span class="number">919</span>,<span class="number">929</span>,<span class="number">937</span>,<span class="number">941</span>,<span class="number">947</span>,<span class="number">953</span>,<span class="number">967</span>,<span class="number">971</span>,<span class="number">977</span>,<span class="number">983</span>,<span class="number">991</span>,<span class="number">997</span>,<span class="number">1009</span>,<span class="number">1013</span>,<span class="number">1019</span>,<span class="number">1021</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>(<span class="params">c1, c2, e, n</span>):</span><br><span class="line">    PR.&lt;x&gt;=PolynomialRing(Zmod(n))</span><br><span class="line">    g1 = (a1*x + b1)^e - c1</span><br><span class="line">    g2 = (a2*x + b2)^e - c2</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">g1, g2</span>):</span><br><span class="line">        <span class="keyword">while</span> g2:</span><br><span class="line">            g1, g2 = g2, g1 % g2</span><br><span class="line">        <span class="keyword">return</span> g1.monic()</span><br><span class="line">    <span class="keyword">return</span> -gcd(g1, g2)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> elist:</span><br><span class="line">    m1 = attack(c1, c2, e, n)</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">b&quot;SICTF&quot;</span> <span class="keyword">in</span> long_to_bytes(<span class="built_in">int</span>(m1))):</span><br><span class="line">        flag = long_to_bytes(<span class="built_in">int</span>(m1))</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>SICTF{hhh!!franklin_reiter_is_easy}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="small-e"><a href="#small-e" class="headerlink" title="small_e"></a>small_e</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¿™ä¸ªä½åŠ å¯†æŒ‡æ•°æ”»å‡»ä¸ºä»€ä¹ˆæ‰“ä¸å‡ºæ¥å“‡ï¼Ÿæ˜¯ä¸æ˜¯é¢˜æœ‰é—®é¢˜æï¼Ÿå·®è¯„ï¼</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line">flag=<span class="string">&quot;SICTF&#123;&quot;</span>+<span class="built_in">str</span>(uuid.uuid4())+<span class="string">&quot;&#125;&quot;</span></span><br><span class="line">m=libnum.s2n(flag)</span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line">n=p*q</span><br><span class="line">e=<span class="number">3</span></span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line">m1=((m&gt;&gt;<span class="number">60</span>)&lt;&lt;<span class="number">60</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e=&quot;</span>,e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;((m&gt;&gt;60)&lt;&lt;60)=&quot;</span>,m1)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n= 23407088262641313744603678186127228163189328033499381357614318160776774708961658114505773173784501557046914457908828086210961235530240151825359345210845219656000760996670856300710703016947799649686427460688236465568188205550456293373157997725204643414082796492333552579250010906010553831060540937802882205118399938918764313169385349293602085310111289583058965780887097301702677087443291977479125263301000328313103296364864396361278863921717374909215078711198899810620522933994481419395021233240234478331179727351050575360886334237633420906629984625441302945112631166021776379103081857393866576659121443879590011160797</span></span><br><span class="line"><span class="string">e= 3</span></span><br><span class="line"><span class="string">c= 1584727211980974717747362694412040878682966138197627512650829607105625096823456063149392973232737929737200028676411430124019573130595696272668927725536797627059576270068695792221537212669276826952363636924278717182163166234322320044764324434683614360641636360301452618063418349310497430566465329766916213742181</span></span><br><span class="line"><span class="string">((m&gt;&gt;60)&lt;&lt;60)= 11658736990073967239197168945911788935424691658202162501032766529463315401599017877851823976178979438592</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>å·²çŸ¥æ˜æ–‡é«˜ä½æ”»å‡»ï¼Œç›´æ¥ä¸Šè„šæœ¬ã€‚</p>
<p>exp.ipynbï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n= <span class="number">23407088262641313744603678186127228163189328033499381357614318160776774708961658114505773173784501557046914457908828086210961235530240151825359345210845219656000760996670856300710703016947799649686427460688236465568188205550456293373157997725204643414082796492333552579250010906010553831060540937802882205118399938918764313169385349293602085310111289583058965780887097301702677087443291977479125263301000328313103296364864396361278863921717374909215078711198899810620522933994481419395021233240234478331179727351050575360886334237633420906629984625441302945112631166021776379103081857393866576659121443879590011160797</span></span><br><span class="line">e= <span class="number">3</span></span><br><span class="line">c= <span class="number">1584727211980974717747362694412040878682966138197627512650829607105625096823456063149392973232737929737200028676411430124019573130595696272668927725536797627059576270068695792221537212669276826952363636924278717182163166234322320044764324434683614360641636360301452618063418349310497430566465329766916213742181</span></span><br><span class="line">m= <span class="number">11658736990073967239197168945911788935424691658202162501032766529463315401599017877851823976178979438592</span></span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = (m + x)^e - c</span><br><span class="line">f = f.monic()</span><br><span class="line">roots = f.small_roots()</span><br><span class="line"></span><br><span class="line">m = m + <span class="built_in">int</span>(roots[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>SICTF{2ca8e589-4a31-4909-80f0-9ecfc8f8cb37}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="easy-math"><a href="#easy-math" class="headerlink" title="easy_math"></a>easy_math</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å…¶å®æ•°å­¦å¾ˆç®€å•è¾£ï¼</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span>  Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">hint1 = getPrime(<span class="number">13</span>)*p+getPrime(<span class="number">256</span>)*q</span><br><span class="line">hint2 = getPrime(<span class="number">13</span>)*p+getPrime(<span class="number">256</span>)*q</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;hint1 = <span class="subst">&#123;hint1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;hint2 = <span class="subst">&#123;hint2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 68123067052840097285002963401518347625939222208495512245264898037784706226045178539672509359795737570458454279990340789711761542570505016930986418403583534761200927746744298082254959321108829717070206277856970403191060311901559017372393931121345743640657503994132925993800497309703877076541759570410784984067</span></span><br><span class="line"><span class="string">hint1 = 564294243979930441832363430202216879765636227726919016842676871868826273613344463155168512928428069316237289920953421495330355385445649203238665802121198919543532254290185502622234014832349396422316629991217252686524462096711723580</span></span><br><span class="line"><span class="string">hint2 = 484307144682854466149980416084532076579378210225500554261260145338511061452958092407101769145891750844383042274498826787696953308289632616886162073232218214504005935332891893378072083589751354946391146889055039887781077066257013110</span></span><br><span class="line"><span class="string">c = 57751903193610662622957432730720223801836323458721550133101805763463060486486266309568004721657732742899781400754207249733137375171400440423755473421971160000575072519031824740691618617905549725344323721903857290320737224300672847773455169809689188843070599176261204013341324705808617411345132933937680951713</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>æ³¨æ„åˆ°hint1ã€hint2çš„ç”Ÿæˆè¿‡ç¨‹ï¼š</p>
<script type="math/tex; mode=display">
hint1 = a1*p+b1*q</script><script type="math/tex; mode=display">
hint2 = a2*p+b2*q</script><p>è€Œpå‰çš„ç³»æ•°a1ã€a2å¾ˆå°ï¼Œå› æ­¤å¯ä»¥å…ˆæ‰“å°å‡ºæ‰€æœ‰13æ¯”ç‰¹çš„ç´ æ•°å­˜åœ¨ä¸€å¼ è¡¨å†…ï¼Œä½œä¸ºa1ã€a2çš„æ‰€æœ‰å¯èƒ½å–å€¼ï¼Œç„¶åå¦‚ä¸‹æ“ä½œï¼š</p>
<script type="math/tex; mode=display">
a2*hint1-a1*hint2=a2*(a1*p+b1*q) - a1*(a2*p+b2*q)=(a2*b1-a1*b2)*q</script><p>ä¸næ±‚gcdå³å¯å¾—åˆ°qï¼Œä¹‹åè¿›è¡ŒRSAè§£å¯†å³å¯ã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span>  Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">68123067052840097285002963401518347625939222208495512245264898037784706226045178539672509359795737570458454279990340789711761542570505016930986418403583534761200927746744298082254959321108829717070206277856970403191060311901559017372393931121345743640657503994132925993800497309703877076541759570410784984067</span></span><br><span class="line">hint1 = <span class="number">564294243979930441832363430202216879765636227726919016842676871868826273613344463155168512928428069316237289920953421495330355385445649203238665802121198919543532254290185502622234014832349396422316629991217252686524462096711723580</span></span><br><span class="line">hint2 = <span class="number">484307144682854466149980416084532076579378210225500554261260145338511061452958092407101769145891750844383042274498826787696953308289632616886162073232218214504005935332891893378072083589751354946391146889055039887781077066257013110</span></span><br><span class="line">c = <span class="number">57751903193610662622957432730720223801836323458721550133101805763463060486486266309568004721657732742899781400754207249733137375171400440423755473421971160000575072519031824740691618617905549725344323721903857290320737224300672847773455169809689188843070599176261204013341324705808617411345132933937680951713</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">primelist = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">12</span>,<span class="number">2</span>**<span class="number">13</span>) <span class="keyword">if</span> isPrime(i)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> primelist:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> primelist:</span><br><span class="line">        <span class="keyword">if</span>(GCD(hint1*i - hint2*j,n) != <span class="number">1</span>):</span><br><span class="line">            q = GCD(hint1*i - hint2*j,n)</span><br><span class="line">p = n//q</span><br><span class="line">d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>flagï¼š</p>
<p><strong>SICTF{452aebb6-9c16-441a-ac42-fc608bf6063f}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>è¶Šç†Ÿç»ƒæ‰‹é€Ÿå°±ä¼šè¶Šå¿«ï¼Œç»§ç»­åŠªåŠ›ï¼</p>
]]></content>
      <categories>
        <category>wp-crypto</category>
      </categories>
  </entry>
  <entry>
    <title>2023-SICTF-#Round2-wp-misc</title>
    <url>/post/ccf22797.html</url>
    <content><![CDATA[<p>Cryptoå…¼èŒmiscæ‰‹ï¼Œæµ…åšç‚¹miscå¨±ä¹å¨±ä¹</p>
<span id="more"></span>
<p><strong>Rankï¼š2</strong></p>
<p><img src="/post/ccf22797/image-20230911152802298.png" alt="image-20230911152802298"></p>
<p><br></p>
<p><br></p>
<h3 id="ç­¾åˆ°-Welcome"><a href="#ç­¾åˆ°-Welcome" class="headerlink" title="[ç­¾åˆ°]Welcome"></a>[ç­¾åˆ°]Welcome</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å…³æ³¨å¾®ä¿¡å…¬ä¼—å·å¹¶å‘é€&quot;SICTF2023&quot;å°±å¯ä»¥è·å¾—flagè¾£ï¼</span><br></pre></td></tr></table></figure>
<p>ç­¾åˆ°é¢˜ï¼Œç…§ç€åšå³å¯ã€‚</p>
<p><img src="/post/ccf22797/image-20230908162949748.png" alt></p>
<p>flagï¼š</p>
<p><strong>SICTF{Welcome_to_SICTF2023_#Round2}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="Pixel-art"><a href="#Pixel-art" class="headerlink" title="Pixel_art"></a>Pixel_art</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¿™å¼ é¢œè‰²å¾ˆå¥‡æ€ªçš„å›¾ç‰‡åˆ°åº•æ˜¯å¹²ä»€ä¹ˆçš„å‘¢ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>ä¸‹è½½é¢˜ç›®é™„ä»¶ï¼Œæ˜¯ä¸€ä¸ªzipå‹ç¼©åŒ…ï¼Œè§£å¯†æç¤ºéœ€è¦å¯†ç ï¼Œä½†æ˜¯ä¹Ÿå¹¶æ²¡æœ‰åˆ«çš„å¯†ç æç¤ºï¼Œæ‰€ä»¥ç¬¬ä¸€ååº”å°±æ˜¯ä¼ªåŠ å¯†ã€‚åå…­è¿›åˆ¶æ‰“å¼€æ–‡ä»¶ï¼š</p>
<p><img src="/post/ccf22797/image-20230908171507928.png" alt="image-20230908171507928"></p>
<p>å°†è¿™é‡Œçš„1æ”¹ä¸º0å³å¯è§£å¯†å‹ç¼©åŒ…ï¼Œå¾—åˆ°å›¾ç‰‡ï¼š</p>
<p><img src="/post/ccf22797/Pixel_art.png" alt="Pixel_art"></p>
<p>å¹¶æ²¡æœ‰å‘ç°å¦‚é¢˜ç›®æè¿°ä¸­æ‰€è¯´çš„å¥‡æ€ªçš„åƒç´ ç‚¹ï¼Œåœ¨stegsolveä¸­æ‰“å¼€ï¼Œåˆ‡æ¢å„ç§æŸ¥çœ‹æ–¹å¼ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå‘ç°ã€‚äºæ˜¯æƒ³åˆ°LSBéšå†™ï¼Œå¯ä»¥å‘ç°ï¼š</p>
<p><img src="/post/ccf22797/image-20230908171812016.png" alt="image-20230908171812016"></p>
<p>æœç„¶è—äº†ä¸œè¥¿ï¼Œä¿å­˜ä¸ºpngæ–‡ä»¶åæŸ¥çœ‹ï¼š</p>
<p><img src="/post/ccf22797/pixel.png" alt="pixel"></p>
<p>è¿™å›¾ä¹Ÿå¤ªå°äº†ï¼ŒæŸ¥çœ‹å…¶è¯¦ç»†ä¿¡æ¯ï¼Œæœç„¶å‘ç°ï¼š</p>
<p><img src="/post/ccf22797/image-20230908171941968.png" alt="image-20230908171941968"></p>
<p>å¤§å°ä»…æœ‰20*20ï¼Œä¸éš¾æƒ³åˆ°flagè¢«åŠ å¯†è¿›äº†åƒç´ ç‚¹é‡Œã€‚å†™ä¸€ä¸ªè„šæœ¬æå–åƒç´ ç‚¹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">image = Image.<span class="built_in">open</span>(<span class="string">&#x27;temp.png&#x27;</span>)  <span class="comment"># æ›¿æ¢ä¸ºä½ çš„å›¾ç‰‡æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">width, height = image.size</span><br><span class="line">pixel_data = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">        pixel = image.getpixel((x, y))</span><br><span class="line">        pixel_data.append(pixel)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(pixel_data)</span><br></pre></td></tr></table></figure>
<p>æ‰“å°å‡ºæ¥çš„åƒç´ ç‚¹åˆ—è¡¨æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">[(<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">33</span>, <span class="number">63</span>, <span class="number">33</span>), (<span class="number">33</span>, <span class="number">46</span>, <span class="number">63</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">63</span>, <span class="number">46</span>, <span class="number">63</span>), (<span class="number">33</span>, <span class="number">46</span>, <span class="number">63</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">33</span>, <span class="number">46</span>), (<span class="number">63</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">46</span>), (<span class="number">46</span>, <span class="number">46</span>, <span class="number">33</span>), (<span class="number">63</span>, <span class="number">33</span>, <span class="number">33</span>), (<span class="number">46</span>, <span class="number">63</span>, <span class="number">33</span>), (<span class="number">33</span>, <span class="number">33</span>, <span class="number">33</span>), (<span class="number">33</span>, <span class="number">33</span>, <span class="number">63</span>), (<span class="number">46</span>, <span class="number">63</span>, <span class="number">33</span>), (<span class="number">46</span>, <span class="number">63</span>, <span class="number">33</span>), ......, (<span class="number">46</span>, <span class="number">46</span>, <span class="number">33</span>), (<span class="number">46</span>, <span class="number">63</span>, <span class="number">46</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)]</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆè¿™ä¸‰ä¸ªæ•°å­—æ˜¾ç„¶æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œå½“ä½œASCIIç æ‰“å°å‡ºå¯¹åº”å­—ç¬¦å‘ç°ï¼šåˆ†åˆ«æ˜¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">46-. </span><br><span class="line">33-!</span><br><span class="line">63-?</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸‰ä¸ªå­—ç¬¦ä¸éš¾å¯¹åº”åˆ°OokåŠ å¯†ä¸Šï¼Œå†™ä¸ªå®Œæ•´è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">image = Image.<span class="built_in">open</span>(<span class="string">&#x27;temp.png&#x27;</span>)  <span class="comment"># æ›¿æ¢ä¸ºä½ çš„å›¾ç‰‡æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">width, height = image.size</span><br><span class="line">pixel_data = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">        pixel = image.getpixel((x, y))</span><br><span class="line">        pixel_data.append(pixel)</span><br><span class="line"></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(pixel_data)):</span><br><span class="line">    <span class="keyword">if</span>(pixel_data[i] == (<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>)):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> pixel_data[i]:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Ook&quot;</span>+<span class="built_in">chr</span>(j),end = <span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>æ‹¿ç”Ÿæˆçš„å­—ç¬¦ä¸²å»åœ¨çº¿ç½‘å€è§£å¯†ï¼š</p>
<p><img src="/post/ccf22797/image-20230908172734509.png" alt="image-20230908172734509"></p>
<p>flagï¼š</p>
<p><strong>SICTF{0141ac35-ec19-4cee-a906-22805fdbed77}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="baby-zip"><a href="#baby-zip" class="headerlink" title="baby_zip"></a>baby_zip</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ”»ç ´è¿™ä¸ªå‹ç¼©åŒ…ï¼</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ç»™äº†ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œé¦–å…ˆæ£€æŸ¥å‡ºæ˜¯çœŸåŠ å¯†ï¼Œç„¶åå°è¯•ziprelloçˆ†ç ´æ— æœï¼Œbinwalkä¹Ÿæ²¡æœ‰å‘ç°é¢å¤–æ–‡ä»¶ï¼Œé‚£ä¹ˆå°±åªèƒ½æ˜¯æ·±å…¥æ˜æ–‡æ”»å‡»äº†ã€‚</p>
<p>æ·±å…¥æ˜æ–‡æ”»å‡»å‚è€ƒï¼š</p>
<p><a href="https://hasegawaazusa.github.io/zip-crack-note.html#zip-ç ´è§£">zipå‹ç¼©åŒ…å–è¯ç¬”è®° | ç‹¬å¥ã®å°å±‹ (hasegawaazusa.github.io)</a></p>
<p>ç”±å‚è€ƒåšå®¢çŸ¥ï¼Œè¿›è¡Œæ·±å…¥æ˜æ–‡æ”»å‡»éœ€è¦è‡³å°‘12ä¸ªå·²çŸ¥å­—èŠ‚ã€‚è€Œç”±äºå·²çŸ¥å‹ç¼©åŒ…å†…ä¸ºpngæ–‡ä»¶ï¼Œä¹Ÿå°±çŸ¥é“æ–‡ä»¶å¤´ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 52</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬è‡³å°‘çŸ¥é“äº†16ä¸ªå‡†ç¡®çš„å­—èŠ‚ï¼Œè¶…è¿‡äº†12ä¸ªå­—èŠ‚ï¼Œå·²ç»æ»¡è¶³æ·±å…¥æ˜æ–‡æ”»å‡»çš„æ¡ä»¶äº†ï¼Œ(å¤šçš„å·²çŸ¥å­—èŠ‚å¯ä»¥åŠ å¿«é€Ÿåº¦)ï¼Œæ¥ä¸‹æ¥å°±ä½¿ç”¨å·¥å…·å³å¯ã€‚</p>
<p><img src="/post/ccf22797/image-20230909112256733.png" alt="image-20230909112256733"></p>
<p>ä¸¤æ­¥æ“ä½œåˆ†åˆ«æ˜¯ï¼šæŠŠå·²çŸ¥åå…­è¿›åˆ¶çš„å­—èŠ‚å†™å…¥æ–‡ä»¶key.txtï¼Œå†è¿›è¡Œæ·±å…¥æ˜æ–‡æ”»å‡»å³å¯ã€‚è·‘äº†æ¥è¿‘äºŒååˆ†é’Ÿåï¼Œå‡ºäº†zipçš„ä¸‰æ®µå†…éƒ¨å¯†ç (ä¸Šå›¾ä¸­æœ€åä¸€è¡Œ)ï¼Œç›´æ¥è¿›è¡Œè§£å¯†å³å¯ï¼š</p>
<p><img src="/post/ccf22797/image-20230909112437253.png" alt="image-20230909112437253"></p>
<p>å¾—åˆ°å›¾ç‰‡ï¼š</p>
<p><img src="/post/ccf22797/flag1.png" alt="flag1"></p>
<p>åå…­è¿›åˆ¶æ‰“å¼€æœ«å°¾å³å¾—flagï¼š</p>
<p><img src="/post/ccf22797/image-20230909112540496.png" alt="image-20230909112540496"></p>
<p>flagï¼š</p>
<p><strong>SICTF{3a4998b8-345e-4943-a689-d01e8b08defb}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="ä¸€èµ·ä¸Šå·ä¸"><a href="#ä¸€èµ·ä¸Šå·ä¸" class="headerlink" title="ä¸€èµ·ä¸Šå·ä¸"></a>ä¸€èµ·ä¸Šå·ä¸</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä½ ä¸ºä»€ä¹ˆè¿˜ä¸ä¸Šå·å•Šï¼Ÿå®ï¼</span><br><span class="line">Hintï¼šä½ çŸ¥é“CobaltStrikeå—ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ç»™äº†ä¸€ä¸ªæµé‡åŒ…ï¼Œå¯¼å‡ºhttpæµå¯¹è±¡ï¼Œå¯ä»¥å‘ç°ä¸€ä¸ªkey.zipï¼š</p>
<p><img src="/post/ccf22797/image-20230909142543063.png" alt="image-20230909142543063"></p>
<p>å¯¼å‡ºè¯¥å‹ç¼©åŒ…å¹¶è§£å‹ï¼Œå¾—åˆ°ä¸€ä¸ªkeyæ–‡ä»¶ï¼Œé‚£ç°åœ¨è¦åšçš„å°±æ˜¯æå–å‡ºkeyä¸­çš„ä¿¡æ¯ï¼Œå»è§£å¯†æµé‡ä¸­çš„æ•°æ®ã€‚ä½†æ˜¯æ€ä¹ˆæ‰¾éƒ½æ²¡æ‰¾åˆ°è¿™ç§keyæ–‡ä»¶æ€ä¹ˆä½¿ç”¨ï¼Œæ€è·¯ä¹Ÿå°±æš‚æ—¶åœæ»äº†ã€‚</p>
<p>ç›´åˆ°hintå‡ºç°ï¼Œé‚£å°±ç›´æ¥æœç´¢CobaltStrikeï¼Œå‘ç°ä¸€é“ç±»ä¼¼æµé‡åˆ†æé¢˜ï¼Œç…§ç€ä¸€æ­¥æ­¥åšå°±æœ‰äº†(å…¶ä¸­CS_Decryptä¸­æœ‰ä¸€ä¸ªè„šæœ¬ç”¨åˆ°M2Cryptoåº“ï¼Œä½†æ˜¯pipä¸ä¸‹æ¥ï¼Œæœç´¢èµ„æ–™å‘ç°è¿™ä¸ªåº“åœæ­¢æ›´æ–°å¾ˆä¹…äº†ï¼Œå¯èƒ½pythonç‰ˆæœ¬å¯¹ä¸ä¸Šï¼Œå¹³æ›¿ä¸ºpycryptodomeå³å¯)ï¼š</p>
<p><a href="https://blog.csdn.net/qq_43264813/article/details/120560209">2021å¹´â€œç»¿åŸæ¯â€ç½‘ç»œå®‰å…¨å¤§èµ›-Misc-æµé‡åˆ†æ_å¤œç™½å›çš„åšå®¢-CSDNåšå®¢</a></p>
<p>å¾—åˆ°flagï¼š</p>
<p><img src="/post/ccf22797/image-20230909142844158.png" alt="image-20230909142844158"></p>
<p>flagï¼š</p>
<p><strong>SICTF{88a39373-e204-43b6-b321-33ac8972fde9}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="QR-QR-QR"><a href="#QR-QR-QR" class="headerlink" title="QR_QR_QR"></a>QR_QR_QR</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æˆ‘å°±æ‰«ç è€Œå·²å•¦ï¼ä¸ºä»€ä¹ˆè¦ç”¨pwntoolsï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ç»™äº†ä¸€ä¸ªç«¯å£ï¼Œå…ˆç”¨xshellæ‰‹åŠ¨äº¤äº’ä¸€ä¸‹ï¼š</p>
<p><img src="/post/ccf22797/image-20230910150031807.png" alt="image-20230910150031807"></p>
<p>å¯ä»¥ä¾ç¨€çœ‹å‡ºæ˜¯äºŒç»´ç çš„å®šä½ç¬¦ï¼Œé‚£ä¹ˆæ€è·¯å°±æ˜¯æŠŠè¿™äº›0ã€1è½¬åŒ–ä¸ºäºŒç»´ç å¹¶æ‰«ç å¾—åˆ°æ•°æ®ï¼Œä½†æ˜¯ç²˜å‡ºæ¥æ•°æ®æƒ³å†™è„šæœ¬çš„æ—¶å€™å‘ç°ï¼š</p>
<p><img src="/post/ccf22797/image-20230910150225007.png" alt="image-20230910150225007"></p>
<p>ç¬‘æ­»ï¼Œvscodeå³ä¾§çš„é¢„è§ˆç›´æ¥æ˜¾ç¤ºå‡ºäº†äºŒç»´ç çš„æ•ˆæœï¼Œé‚£ç›´æ¥æ‰«ç å¾—åˆ°æ•°æ®ï¼š</p>
<p><img src="/post/ccf22797/image-20230910150358330.png" alt="image-20230910150358330"></p>
<p>ä½†æ˜¯ä¸Šä¼ è¿™ä¸²æ•°æ®çš„æ—¶å€™å‘ç°ï¼š</p>
<p><img src="/post/ccf22797/image-20230910150429700.png" alt="image-20230910150429700"></p>
<p>è¶…æ—¶äº†ï¼Œå½³äºï¼Œé‚£ç¡®å®å¾—å†™è„šæœ¬è‡ªåŠ¨äº¤äº’ï¼Œäº¤äº’ä¸€æ¬¡åå‘ç°é¶æœºç«¯è¿˜ä¼šå‘é€äºŒç»´ç æ•°æ®ï¼Œé‚£åº”è¯¥æ˜¯è¦å¾ªç¯ä¸€å®šæ¬¡æ•°åæ‰ä¼šç»™flagäº†ã€‚</p>
<p>ä¹‹åå°±æ˜¯æ¯ç‡¥çš„debugæ—¶é—´ã€‚</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> pyzbar.pyzbar <span class="keyword">import</span> decode</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&quot;210.44.151.51&quot;</span>,<span class="number">10468</span>)</span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    count += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(count)</span><br><span class="line">    data = <span class="built_in">list</span>(r.recvuntil(<span class="string">b&quot;P&quot;</span>)[:-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å®šä¹‰å›¾åƒçš„å®½åº¦å’Œé«˜åº¦ï¼ˆæ ¹æ®æ•°æ®é•¿åº¦è°ƒæ•´ï¼‰</span></span><br><span class="line">    width = <span class="number">116</span></span><br><span class="line">    height = <span class="number">116</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># åˆ›å»ºä¸€ä¸ªç©ºç™½å›¾åƒ</span></span><br><span class="line">    image = Image.new(<span class="string">&quot;1&quot;</span>, (width, height), color=<span class="number">1</span>)  <span class="comment"># 1è¡¨ç¤ºå•è‰²ï¼ˆé»‘ç™½ï¼‰</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># è·å–å›¾åƒçš„åƒç´ è®¿é—®å¯¹è±¡</span></span><br><span class="line">    pixels = image.load()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°†01æ•°æ®å¡«å……åˆ°å›¾åƒä¸­</span></span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">            index = y * width + x</span><br><span class="line">            <span class="keyword">if</span> index &lt; <span class="built_in">len</span>(data) <span class="keyword">and</span> data[index] == <span class="number">48</span>:</span><br><span class="line">                pixels[x, y] = <span class="number">0</span>  <span class="comment"># å°†0å†™ä¸ºé»‘è‰²åƒç´ ç‚¹</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                pixels[x, y] = <span class="number">1</span>  <span class="comment"># å°†0å†™ä¸ºé»‘è‰²åƒç´ ç‚¹</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¿å­˜å›¾åƒä¸ºæ–‡ä»¶</span></span><br><span class="line">    image.save(<span class="string">&quot;1.png&quot;</span>)</span><br><span class="line">    decocdeQR = decode(Image.<span class="built_in">open</span>(<span class="string">&quot;1.png&quot;</span>))[<span class="number">0</span>].data</span><br><span class="line">    r.sendline(decocdeQR)</span><br><span class="line">    temp = r.recvline()</span><br><span class="line">    <span class="built_in">print</span>(temp)</span><br><span class="line">    temp = r.recvline()</span><br><span class="line">    <span class="built_in">print</span>(temp)</span><br></pre></td></tr></table></figure>
<p>å¾ªç¯1000æ¬¡åï¼Œé¶æœºç«¯å‘é€flagï¼š</p>
<p><strong>SICTF{d7d23552-d917-4ad4-962c-e415dd5b5b6e}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="fast-morse"><a href="#fast-morse" class="headerlink" title="fast_morse"></a>fast_morse</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ä½ å¥½å¿«å•Šï¼ï¼ˆflagéœ€è¦åŒ…å«SICTF&#123;&#125;ï¼‰</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ç»™äº†ä¸€ä¸ªéŸ³é¢‘ï¼ŒAudacityæ‰“å¼€ï¼š</p>
<p><img src="/post/ccf22797/image-20230910150829891.png" alt="image-20230910150829891"></p>
<p>ç»å…¸çš„éŸ³é¢‘éšå†™æ‘©æ–¯ç”µç ï¼Œä½†æ˜¯æ•²å®Œæ‘©æ–¯å¯†ç ï¼Œæœ€åå¾—åˆ°çš„uuidå°‘äº†ä¸€ä½ï¼Œ<del>ç§èŠå‡ºé¢˜äººæ‹¿flagå³å¯</del>ã€‚</p>
<p><br></p>
<p><br></p>
<h3 id="Easy-Shark"><a href="#Easy-Shark" class="headerlink" title="Easy_Shark"></a>Easy_Shark</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">é²¨é±¼ï¼å—·å‘œï¼</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ç»™äº†ä¸€ä¸ªæµé‡æ–‡ä»¶ï¼Œè¿½è¸ªtcpæµèƒ½å‘ç°ä¸€æ®µphpä»£ç ï¼š</p>
<p><img src="/post/ccf22797/image-20230910151203093.png" alt="image-20230910151203093"></p>
<p>å¯ä»¥çœ‹å‡ºï¼Œåœ¨opensslæ‰©å±•æœ‰æ•ˆæ—¶ï¼Œè¿™æ®µä»£ç å¯¹æ•°æ®çš„è§£å¯†æ–¹å¼ä¸ºAES_128åbase64ï¼Œå¹¶ä¸”ç»™äº†keyçš„å€¼(ä¹‹åäº†è§£åˆ°è¿™æ˜¯å¾ˆæ˜æ˜¾çš„å†°èçš„ç‰¹å¾)ã€‚é‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨cyberchefï¼Œå¯¹ä¹‹åçš„æ¯ä¸ªtcpæµé‡Œçš„base64æ•°æ®è¿›è¡Œæ¢å¤ï¼š</p>
<p><img src="/post/ccf22797/image-20230910151658797.png" alt="image-20230910151658797"></p>
<p>å†æŠŠè§£å¯†å‡ºæ¥çš„å¯†æ–‡å†…éƒ¨çš„base64æ®µæå–å‡ºæ¥ï¼Œå†è¿›è¡Œè§£å¯†ï¼Œå°±å¯ä»¥åœ¨æœ€åº•ä¸‹å‘ç°ï¼š</p>
<p><img src="/post/ccf22797/image-20230910151851063.png" alt="image-20230910151851063"></p>
<p>å¯ä»¥çœ‹å‡ºï¼Œå®é™…ä¸Šè¿™æ®µç¨‹åºå°±æ˜¯åœ¨æ‰§è¡Œæœ€ä¸‹æ–¹çš„cmdå‘½ä»¤ï¼Œç„¶åå¯¹å›å¤çš„æ•°æ®ä¹Ÿè¿›è¡Œå¦‚ä¸Šè§£å¯†ï¼Œå°±å¯ä»¥å¾—åˆ°å‘½ä»¤æ‰§è¡Œåçš„å¯¹åº”å†…å®¹ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œå¯ä»¥å¾—åˆ°ä¸¤ä¸ªæœ‰ç”¨çš„ä¿¡æ¯ï¼š</p>
<p>GronKey.txtï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1,50,61,8,9,20,63,41</span><br></pre></td></tr></table></figure>
<p>flag.txtï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">TGLBOMSJNSRAJAZDEZXGHSJNZWHG</span><br></pre></td></tr></table></figure>
<p>flagçš„å†…å®¹ç›´æ¥æäº¤ä¸Šå»æ˜¯ä¸å¯¹çš„ï¼Œå› æ­¤è‚¯å®šè¿˜éœ€è¦è¿›è¡Œè§£å¯†ï¼Œè€Œå¦‚ä½•è§£å¯†å°±éœ€è¦ç”¨åˆ°GronKey.txtï¼Œå¹¶ä¸”æŒ‰æ­£å¸¸æ€è·¯ï¼ŒGronKeyè¿™ä¸ªåå­—è‚¯å®šæ˜¯ä¸ªæç¤ºã€‚æœ€ç»ˆæœç´¢åˆ°äº†Gronsfeldå¯†ç ï¼Œè§£å¯†å³å¯ï¼š</p>
<p>exp.pyï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span>  Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pycipher <span class="keyword">import</span> Gronsfeld</span><br><span class="line"></span><br><span class="line">t = [<span class="number">1</span>,<span class="number">50</span>,<span class="number">61</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">20</span>,<span class="number">63</span>,<span class="number">41</span>]</span><br><span class="line">temp = <span class="string">&quot;TGLBOMSJNSRAJAZDEZXGHSJNZWHG&quot;</span></span><br><span class="line"><span class="built_in">print</span> (Gronsfeld(t).decipher(temp))</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæœ‰ä¸ªæ¯”è¾ƒå‘çš„ç‚¹ï¼šå› ä¸ºæˆ‘æ˜¯çŸ¥é“Gronsfeldè¿™ä¸ªå¯†ç çš„ï¼Œä½†æ˜¯æˆ‘è®°å¾—ä»–çš„å¯†é’¥åªèƒ½æ˜¯0-9çš„æ•°å­—ï¼ŒåŠ å¯†åŸç†å°±æ˜¯å­—æ¯åŠ ä¸Šå¯†é’¥å¯¹åº”æ•°å­—(ç±»ä¼¼äºç»´å‰å°¼äºšå¯†ç )ï¼Œæ‰€ä»¥å¼€å§‹å°±æ’é™¤äº†è¿™ä¸ªåŠ å¯†æ–¹å¼ã€‚ä¹‹åä¸€ç›´æ²¡æœ‰æœåˆ°å…¶ä»–çš„Gronå¼€å¤´çš„åŠ å¯†ï¼Œå¡äº†å¾ˆä¹…ã€‚åæ¥æˆ‘æœåˆ°äº†ä¸€ä¸ªGronsfeldåœ¨çº¿åŠ å¯†ï¼š</p>
<p><a href="https://www.wishingstarmoye.com/ctf/vigenere">Vigenere / Gronsfeld - è®¸æ„¿æ˜Ÿ (wishingstarmoye.com)</a></p>
<p>å¯ä»¥å‘ç°ï¼Œä»–ç¡®å®ç”¨äº†è¶…è¿‡10çš„æ•°å­—å½“ä½œå¯†é’¥ï¼Œé‚£è¿™åˆ°åº•æ˜¯æ€ä¹ˆåŠ å¯†çš„å‘¢ï¼Ÿæˆ‘æ€è€ƒäº†ä¸€ä¸‹ï¼Œå‘ç°ä»–çš„åŠ å¯†æ–¹å¼åº”è¯¥æ˜¯ï¼šåŠ å¯†æ—¶ï¼Œæ¯ä¸ªå­—æ¯å³ç§»å¯†é’¥åˆ—è¡¨ä¸­å¯¹åº”æ•°å­—çš„ä½æ•°ï¼›è€Œè§£å¯†æ—¶ï¼Œæ¯ä¸ªå­—æ¯å·¦ç§»å¯†é’¥åˆ—è¡¨ä¸­å¯¹åº”æ•°å­—çš„ä½æ•°ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼ŒTå·¦ç§»1ä½å¾—åˆ°Sï¼Œè¿™å¾ˆå¥½ç†è§£ï¼›è€ŒGå·¦ç§»50ä½ï¼Œå…¶å®å°±æ˜¯å³ç§»2ä½(å› ä¸ºæ¨¡26çš„ç¼˜æ•…)ï¼Œå› æ­¤å¾—åˆ°Iã€‚</p>
<p>è¿™æ ·å°±å¯ä»¥é¡ºåˆ©è§£å¯†äº†ã€‚</p>
<p>flagï¼š</p>
<p><strong>SICTF{SHUMUISAGOODBOYYYYYYYYY}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="è¿˜ä¸ä¸Šå·"><a href="#è¿˜ä¸ä¸Šå·" class="headerlink" title="è¿˜ä¸ä¸Šå·"></a>è¿˜ä¸ä¸Šå·</h3><p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ä¸€èµ·ä¸Šå·ä¸ï¼Ÿæ¥ï¼æˆ‘æ•™ä½ æ€ä¹ˆå†™payloadï¼</span><br><span class="line">Hint1ï¼šå››ä½çˆ†ç ´,å¤šæ³¨æ„ä¸€ä¸‹ç»†èŠ‚ï¼Œé™¤äº†CSè¿˜æœ‰ä¸€éƒ¨åˆ†</span><br><span class="line">Hint2ï¼šå‹ç¼©åŒ…å¯†ç ä¸ºwe1l</span><br></pre></td></tr></table></figure>
<p>å…¶å®è¿™é“é¢˜å°±æ˜¯Easy_sharkå’Œä¸€èµ·ä¸Šå·ä¸çš„ç»“åˆï¼Œè¿™ä¸¤ä¸ªéƒ½åšå‡ºæ¥çš„è¯ï¼Œè¿™é¢˜å…¶å®éš¾åº¦ä¸å¤§äº†ã€‚</p>
<p>é¢˜ç›®ç»™äº†ä¸¤ä¸ªæµé‡åŒ…ï¼Œç”±åå­—å¯ä»¥çŸ¥é“ä¸€ä¸ªåŒ…å¯¹åº”ä¸€åŠflagã€‚å…¶ä¸­ï¼ŒåŒ…1å½¢å¼å¯¹åº”Ez_sharkï¼ŒåŒ…2å½¢å¼å¯¹åº”ä¸€èµ·ä¸Šå·ä¸ã€‚</p>
<p>ä»åŒ…1å…¥æ‰‹ï¼Œå¯ä»¥å‘ç°å¯¹æ¯”èµ·Ez_sharkï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯ä»–æ²¡æœ‰ç»™å‡ºAESçš„keyå€¼ï¼Œå› æ­¤å¿…é¡»è¦æƒ³åŠæ³•æ‰¾å‡ºkeyã€‚è€ŒåŒ…2æ­£å¥½æœ‰ä¸ªkey.zipï¼Œè¿›è¡Œå¯¼å‡ºï¼š</p>
<p><img src="/post/ccf22797/image-20230910153507463.png" alt="image-20230910153507463"></p>
<p>å¾—åˆ°çš„key.zipä¸èƒ½ç›´æ¥è§£å‹ï¼Œå¹¶ä¸”æ˜¯çœŸåŠ å¯†ï¼ŒåŒæ—¶ä¹Ÿæ²¡æ³•è¿›è¡Œæ˜æ–‡æ”»å‡»ï¼Œé‚£ä¹ˆå°±ziprelloçˆ†ç ´å§ï¼Œæœ€åå¾—åˆ°å¯†ç æ˜¯we1l(å¹¶ä¸”åæ¥Hintç»™äº†)ã€‚</p>
<p>æ‰“å¼€keyæ–‡ä»¶ï¼š</p>
<p><img src="/post/ccf22797/image-20230910153756977.png" alt="image-20230910153756977"></p>
<p>æ˜¾ç„¶æœ‰é›¶å®½å­—ç¬¦ï¼Œåˆ©ç”¨åœ¨çº¿ç½‘ç«™<a href="http://330k.github.io/misc_tools/unicode_steganography.html">Unicode Steganography with Zero-Width Characters (330k.github.io)</a>è¿›è¡Œé›¶å®½å­—ç¬¦è§£å¯†ï¼š</p>
<p><img src="/post/ccf22797/image-20230910154112768.png" alt="image-20230910154112768"></p>
<p>è¿™é‡Œè¦æ³¨æ„åœ¨ç½‘é¡µä¸‹æ–¹å‹¾é€‰è¯¥æ–‡æœ¬ä¸­æ‰€æœ‰å­˜åœ¨çš„é›¶å®½å­—ç¬¦ï¼Œä¸ç„¶è§£å¯†ä¼šå¤±è´¥ï¼š</p>
<p><img src="/post/ccf22797/image-20230910154140388.png" alt="image-20230910154140388"></p>
<p>å› æ­¤å°±å¾—åˆ°äº†AESçš„keyï¼Œå¯ä»¥æŒ‰ç…§Ez_Sharkçš„æ–¹å¼å¯¹åŒ…1çš„æµé‡ä¾æ¬¡è¿›è¡Œè§£å¯†ï¼Œèƒ½å¾—åˆ°ä¸¤ä¸ªæœ‰ç”¨ä¿¡æ¯ï¼š</p>
<p>flag.txtï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SICTF&#123;79e1755e-08a8-4d</span><br></pre></td></tr></table></figure>
<p>keyï¼š</p>
<p><img src="/post/ccf22797/image-20230910154525684.png" alt="image-20230910154525684"></p>
<p>å¦‚æœåšå‡ºæ¥ä¸€èµ·ä¸Šå·ä¸é‚£é“é¢˜ï¼Œé‚£ä¹ˆå¯¹è¿™ä¸²æ•°æ®åº”è¯¥å¾ˆç†Ÿæ‚‰ï¼Œè¿™å°±æ˜¯<code>.cobaltstrike.beacon_keys</code>å½¢å¼çš„å¯†é’¥æ–‡ä»¶ï¼Œå°†è¿™æ®µå†…å®¹ä¿å­˜æˆæ–‡ä»¶key1.txtï¼Œåç»­çš„æ­¥éª¤å°±å’Œå‰é¢é‚£é“é¢˜å°±ä¸€æ¨¡ä¸€æ ·äº†ã€‚</p>
<p>ä¸‹é¢è¯¦ç»†è®°å½•ä¸€ä¸‹æ­¥éª¤(æ€•æˆ‘è‡ªå·±å¿˜)ï¼š</p>
<p>1ã€è§£ækey1.txtæ–‡ä»¶å¾—åˆ°private_key</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javaobj.v2 <span class="keyword">as</span> javaobj</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;key1.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> fd:</span><br><span class="line">    pobj = javaobj.load(fd)</span><br><span class="line">privateKey = pobj.array.value.privateKey.encoded.data</span><br><span class="line">publicKey = pobj.array.value.publicKey.encoded.data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">privateKey = (</span><br><span class="line">    <span class="string">b&quot;-----BEGIN PRIVATE KEY-----\n&quot;</span></span><br><span class="line">    + base64.encodebytes(<span class="built_in">bytes</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x: x &amp; <span class="number">0xFF</span>, privateKey)))</span><br><span class="line">    + <span class="string">b&quot;-----END PRIVATE KEY-----&quot;</span></span><br><span class="line">)</span><br><span class="line">publicKey = (</span><br><span class="line">    <span class="string">b&quot;-----BEGIN PUBLIC KEY-----\n&quot;</span></span><br><span class="line">    + base64.encodebytes(<span class="built_in">bytes</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x: x &amp; <span class="number">0xFF</span>, publicKey)))</span><br><span class="line">    + <span class="string">b&quot;-----END PUBLIC KEY-----&quot;</span></span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(privateKey.decode())</span><br><span class="line"><span class="built_in">print</span>(publicKey.decode())</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(</span></span><br><span class="line"><span class="comment">#     list(</span></span><br><span class="line"><span class="comment">#         map(</span></span><br><span class="line"><span class="comment">#             lambda x: list(map(lambda y: (y[0].name, y[1]), x.items())),</span></span><br><span class="line"><span class="comment">#             a.field_data.values(),</span></span><br><span class="line"><span class="comment">#         )</span></span><br><span class="line"><span class="comment">#     )</span></span><br><span class="line"><span class="comment"># )</span></span><br></pre></td></tr></table></figure>
<p>2ã€æ ¹æ®private_keyä»¥åŠæµé‡åŒ…ä¸­cookieè§£æå‡ºAES keyå’ŒHMAC keyï¼šï¼ˆå…¶ä»–ä¿¡æ¯æœ‰éœ€è¦ï¼Œè§£é™¤æ‰æ³¨é‡Šå³å¯ï¼Œè¿™é‡Œåªéœ€è¦AESä¸HMACçš„keyï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_v1_5</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hexdump</span><br><span class="line"> </span><br><span class="line">PRIVATE_KEY = <span class="string">&quot;&quot;&quot;-----BEGIN PRIVATE KEY-----</span></span><br><span class="line"><span class="string">MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBAL0M6FR0Cb9dW52Nd5NTA1JUNAs1</span></span><br><span class="line"><span class="string">thS8iXx6QB+UkN/vRJdfsKS8dnOfNuPuPDCtx26B2j8I1FuTJ1VrrfDkzN585sskmXYronFM98Dx</span></span><br><span class="line"><span class="string">50vHaadOcDcDdBBqi8gC5/D3iKflX6T9pSL/5PVLfN1EIaFsyAS9jpWX2wGNi3C/QPSrAgMBAAEC</span></span><br><span class="line"><span class="string">gYAdNhXeGtH4wkWqOhY8aurL+VvTUZjRanJ6C+/FkXCzUWbRVwVV5xMMeZEDNigRw4BZ2HGvJL+f</span></span><br><span class="line"><span class="string">aMT+o3VMkCYBhGbi2/3RPRgigMG7Aa3LWWtYWsdbw8Mw6aqqbTjDUHrQ1kulMf1JvXJL5LBd+pBA</span></span><br><span class="line"><span class="string">Q8kHaYJRMcmnLsT4NeXOFQJBAMNa2r+phrThTlagMB6bj6vl0IVbDy+TJT2VybCSJ76rPgVUQwtP</span></span><br><span class="line"><span class="string">yX3z7UAjt27mE8KK+k7Jidi0drCEPv5Wo60CQQD3vQbO64fko1dlatkNn095GO9KoCuanrsLs+vY   </span></span><br><span class="line"><span class="string">Ohc0ltk4EhHHmP5hEE6dSMZNASKaN0wSYJ14xjnA+dJWOES3AkEApzyYF4vhLefTUIVBrHIvxFCw   </span></span><br><span class="line"><span class="string">+fjCP1AQiXA5gVcdfzTJm3ZPDtf2/kRbzpTE68M7F0gykFAoGcQj92i/JKy24QJAdyVbA+M07Ro9   </span></span><br><span class="line"><span class="string">qxHzJ+EJmMUMOMjFj8xtStiSQeDWTj2KZLQUBvmmxcnQ9UYN0PUNzjtwA5qhwXccSZoctcjECwJA   </span></span><br><span class="line"><span class="string">Zc0TZgGq/OwgnIyj/1+Q9D0A2eg3aw1k+6Vzkf/DdkuF6+XTkYTlBGiETIK/vm1rCH4NcOCL7eK5   </span></span><br><span class="line"><span class="string">qpA1grg+gg==</span></span><br><span class="line"><span class="string">-----END PRIVATE KEY-----&quot;&quot;&quot;</span></span><br><span class="line"> </span><br><span class="line">encode_data = <span class="string">&quot;j+ojKDVPlCr7lT9yzNinkj1DgdkcRaLMT2kL4U+9TvdFBZqGKk7/4WF/W7JhEieC3DoRfngRppMAVHa3yfhp4HZm/ZeNY4bc8rlYL11Q0dXDzpR5JjhqN+hGe9RBqPznoukShgQLhxT/DO7djxE5ROzi6NC52yZAaGPCSeLDyjg=&quot;</span></span><br><span class="line">base64_key = <span class="string">&quot;&quot;&quot;&quot;&quot;&quot;</span></span><br><span class="line"> </span><br><span class="line">private_key = RSA.import_key(PRIVATE_KEY.<span class="built_in">format</span>(base64_key).encode())</span><br><span class="line">cipher = PKCS1_v1_5.new(private_key)</span><br><span class="line">ciphertext = cipher.decrypt(base64.b64decode(encode_data), <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isFlag</span>(<span class="params">var, flag</span>):</span><br><span class="line">	<span class="keyword">return</span> (var &amp; flag) == flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">toIP</span>(<span class="params">var</span>):</span><br><span class="line">	var2 = (var &amp; -<span class="number">16777216</span>) &gt;&gt; <span class="number">24</span></span><br><span class="line">	var4 = (var &amp; <span class="number">16711680</span>) &gt;&gt; <span class="number">16</span></span><br><span class="line">	var6 = (var &amp; <span class="number">65280</span>) &gt;&gt; <span class="number">8</span></span><br><span class="line">	var8 = var &amp; <span class="number">255</span></span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">str</span>(var2) + <span class="string">&quot;.&quot;</span> + <span class="built_in">str</span>(var4) + <span class="string">&quot;.&quot;</span> + <span class="built_in">str</span>(var6) + <span class="string">&quot;.&quot;</span> + <span class="built_in">str</span>(var8)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getName</span>(<span class="params">var0</span>):</span><br><span class="line">	<span class="keyword">if</span> var0 == <span class="number">37</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM037&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">437</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM437&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">500</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM500&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">708</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-6&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">709</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">710</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">720</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM437&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">737</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-IBM737&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">775</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM775&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">850</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM850&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">852</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM852&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">855</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM855&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">857</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM857&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">858</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM00858&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">860</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM860&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">861</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM861&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">862</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM862&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">863</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM863&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">864</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM864&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">865</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM865&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">866</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM866&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">869</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM869&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">870</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM870&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">874</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-windows-874&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">875</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM875&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">932</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Shift_JIS&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">936</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-mswin-936&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">949</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-windows-949&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">950</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Big5&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1026</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM1026&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1047</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM1047&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1140</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01140&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1141</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01141&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1142</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01142&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1143</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01143&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1144</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01144&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1145</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01145&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1146</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01146&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1147</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01147&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1148</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01148&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1149</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM01149&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1200</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;UTF-16LE&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1201</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;UTF-16BE&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1250</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1250&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1251</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1251&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1252</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1252&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1253</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1253&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1254</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1254&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1255</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1255&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1256</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1256&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1257</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1257&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1258</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;windows-1258&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">1361</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-Johab&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10000</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacRoman&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10001</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10002</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10003</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10004</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacArabic&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10005</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacHebrew&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10006</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacGreek&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10007</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacCyrillic&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10008</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10010</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacRomania&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10017</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacUkraine&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10021</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacThai&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10029</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacCentralEurope&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10079</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacIceland&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10081</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacTurkish&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">10082</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-MacCroatian&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">12000</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;UTF-32LE&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">12001</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;UTF-32BE&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20000</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISO-2022-CN-CNS&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20001</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20002</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20003</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20004</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20005</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20105</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20106</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20107</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20108</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20127</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;US-ASCII&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20261</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20269</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20273</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM273&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20277</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM277&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20278</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM278&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20280</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM280&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20284</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM284&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20285</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM285&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20290</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM290&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20297</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM297&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20420</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM420&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20423</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20424</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM424&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20833</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20838</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM-Thai&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20866</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;KOI8-R&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20871</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;IBM871&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20880</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20905</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20924</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20932</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;EUC-JP&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20936</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;GB2312&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">20949</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">21025</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-IBM1025&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">21027</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">21866</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;KOI8-U&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28591</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-1&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28592</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-2&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28593</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-3&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28594</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-4&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28595</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-5&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28596</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-6&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28597</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-7&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28598</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-8&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28599</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-9&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28603</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-13&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">28605</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-15&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">29001</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">38598</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-8859-8&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50220</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-2022-JP&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50221</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-2022-JP-2&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50222</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-2022-JP&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50225</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-2022-KR&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50227</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-2022-CN&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50229</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;ISO-2022-CN&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50930</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-IBM930&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50931</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50933</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-IBM933&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50935</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-IBM935&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50936</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50937</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-IBM937&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">50939</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-IBM939&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">51932</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;EUC-JP&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">51936</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;GB2312&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">51949</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;EUC-KR&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">51950</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">52936</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;GB2312&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">54936</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;GB18030&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57002</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57003</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57004</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57005</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57006</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57007</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57008</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57009</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57010</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">57011</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;x-ISCII91&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">65000</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> var0 == <span class="number">65001</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;UTF-8&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ciphertext[<span class="number">0</span>:<span class="number">4</span>] == <span class="string">b&#x27;\x00\x00\xBE\xEF&#x27;</span>:</span><br><span class="line"></span><br><span class="line">	<span class="comment"># 16</span></span><br><span class="line">	raw_aes_keys = ciphertext[<span class="number">8</span>:<span class="number">24</span>]</span><br><span class="line"></span><br><span class="line">	<span class="comment"># 2</span></span><br><span class="line">	var9 = ciphertext[<span class="number">24</span>:<span class="number">26</span>]</span><br><span class="line">	var9 = <span class="built_in">int</span>.from_bytes(var9, byteorder=<span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	var9 = getName(var9)</span><br><span class="line">	<span class="comment"># 2</span></span><br><span class="line">	var10 = ciphertext[<span class="number">26</span>:<span class="number">28</span>]</span><br><span class="line">	var10 = <span class="built_in">int</span>.from_bytes(var10, byteorder=<span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	var10 = getName(var10)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># 4</span></span><br><span class="line">	<span class="built_in">id</span> = ciphertext[<span class="number">28</span>:<span class="number">32</span>]</span><br><span class="line">	<span class="built_in">id</span> = <span class="built_in">int</span>.from_bytes(<span class="built_in">id</span>, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	<span class="comment">#print(&quot;Beacon id:&#123;&#125;&quot;.format(id))</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 4</span></span><br><span class="line">	pid = ciphertext[<span class="number">32</span>:<span class="number">36</span>]</span><br><span class="line">	pid = <span class="built_in">int</span>.from_bytes(pid, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	<span class="comment">#print(&quot;pid:&#123;&#125;&quot;.format(pid))</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 2</span></span><br><span class="line">	port = ciphertext[<span class="number">36</span>:<span class="number">38</span>]</span><br><span class="line">	port = <span class="built_in">int</span>.from_bytes(port, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	<span class="comment">#print(&quot;port:&#123;&#125;&quot;.format(port))</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 1</span></span><br><span class="line">	flag = ciphertext[<span class="number">38</span>:<span class="number">39</span>]</span><br><span class="line">	flag = <span class="built_in">int</span>.from_bytes(flag, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	<span class="comment"># print(flag)</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> isFlag(flag, <span class="number">1</span>):</span><br><span class="line">		barch = <span class="string">&quot;&quot;</span></span><br><span class="line">		pid = <span class="string">&quot;&quot;</span></span><br><span class="line">		is64 = <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> isFlag(flag, <span class="number">2</span>):</span><br><span class="line">		barch = <span class="string">&quot;x64&quot;</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		barch = <span class="string">&quot;x86&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> isFlag(flag, <span class="number">4</span>):</span><br><span class="line">		is64 = <span class="string">&quot;1&quot;</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		is64 = <span class="string">&quot;0&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> isFlag(flag, <span class="number">8</span>):</span><br><span class="line">		bypassuac = <span class="string">&quot;True&quot;</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		bypassuac = <span class="string">&quot;False&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">#print(&quot;barch:&quot; + barch)</span></span><br><span class="line">	<span class="comment">#print(&quot;is64:&quot; + is64)</span></span><br><span class="line">	<span class="comment">#print(&quot;bypass:&quot; + bypassuac)</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 2</span></span><br><span class="line">	var_1 = ciphertext[<span class="number">39</span>:<span class="number">40</span>]</span><br><span class="line">	var_2 = ciphertext[<span class="number">40</span>:<span class="number">41</span>]</span><br><span class="line">	var_1 = <span class="built_in">int</span>.from_bytes(var_1, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	var_2 = <span class="built_in">int</span>.from_bytes(var_2, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	windows_var = <span class="built_in">str</span>(var_1) + <span class="string">&quot;.&quot;</span> + <span class="built_in">str</span>(var_2)</span><br><span class="line">	<span class="comment">#print(&quot;windows var:&quot; + windows_var)</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 2</span></span><br><span class="line">	windows_build = ciphertext[<span class="number">41</span>:<span class="number">43</span>]</span><br><span class="line">	windows_build = <span class="built_in">int</span>.from_bytes(windows_build, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	<span class="comment">#print(&quot;windows build:&#123;&#125;&quot;.format(windows_build))</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 4</span></span><br><span class="line">	x64_P = ciphertext[<span class="number">43</span>:<span class="number">47</span>]</span><br><span class="line"></span><br><span class="line">	<span class="comment"># 4</span></span><br><span class="line">	ptr_gmh = ciphertext[<span class="number">47</span>:<span class="number">51</span>]</span><br><span class="line">	<span class="comment"># 4</span></span><br><span class="line">	ptr_gpa = ciphertext[<span class="number">51</span>:<span class="number">55</span>]</span><br><span class="line"></span><br><span class="line">	<span class="comment"># if (&quot;x64&quot;.equals(this.barch)) &#123;</span></span><br><span class="line">	<span class="comment"># this.ptr_gmh = CommonUtils.join(var10, this.ptr_gmh)</span></span><br><span class="line">	<span class="comment"># this.ptr_gpa = CommonUtils.join(var10, this.ptr_gpa)</span></span><br><span class="line">	<span class="comment"># &#125;</span></span><br><span class="line">	<span class="comment">#</span></span><br><span class="line">	<span class="comment"># this.ptr_gmh = CommonUtils.bswap(this.ptr_gmh)</span></span><br><span class="line">	<span class="comment"># this.ptr_gpa = CommonUtils.bswap(this.ptr_gpa)</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 4</span></span><br><span class="line">	intz = ciphertext[<span class="number">55</span>:<span class="number">59</span>]</span><br><span class="line">	intz = <span class="built_in">int</span>.from_bytes(intz, byteorder=<span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">	intz = toIP(intz)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> intz == <span class="string">&quot;0.0.0.0&quot;</span>:</span><br><span class="line">		intz = <span class="string">&quot;unknown&quot;</span></span><br><span class="line">	<span class="comment">#print(&quot;host:&quot; + intz)</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> var9 == <span class="literal">None</span>:</span><br><span class="line">		ddata = ciphertext[<span class="number">59</span>:<span class="built_in">len</span>(ciphertext)].decode(<span class="string">&quot;ISO8859-1&quot;</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="comment"># ??x-mswin-936</span></span><br><span class="line">		<span class="comment"># ddata = ciphertext[59:len(ciphertext)].decode(var9)</span></span><br><span class="line">		ddata = ciphertext[<span class="number">59</span>:<span class="built_in">len</span>(ciphertext)].decode(<span class="string">&quot;ISO8859-1&quot;</span>)</span><br><span class="line"></span><br><span class="line">	ddata = ddata.split(<span class="string">&quot;\t&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(ddata) &gt; <span class="number">0</span>:</span><br><span class="line">		computer = ddata[<span class="number">0</span>]</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(ddata) &gt; <span class="number">1</span>:</span><br><span class="line">		username = ddata[<span class="number">1</span>]</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(ddata) &gt; <span class="number">2</span>:</span><br><span class="line">		process = ddata[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">	<span class="comment">#print(&quot;PC name:&quot; + computer)</span></span><br><span class="line">	<span class="comment">#print(&quot;username:&quot; + username)</span></span><br><span class="line">	<span class="comment">#print(&quot;process name:&quot; + process)</span></span><br><span class="line"></span><br><span class="line">	raw_aes_hash256 = hashlib.sha256(raw_aes_keys)</span><br><span class="line">	digest = raw_aes_hash256.digest()</span><br><span class="line">	aes_key = digest[<span class="number">0</span>:<span class="number">16</span>]</span><br><span class="line">	hmac_key = digest[<span class="number">16</span>:]</span><br><span class="line"></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;AES key:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(aes_key.<span class="built_in">hex</span>()))</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;HMAC key:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(hmac_key.<span class="built_in">hex</span>()))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">#print(hexdump.hexdump(ciphertext))</span></span><br></pre></td></tr></table></figure>
<p>3ã€å°†æµé‡åŒ…ä¸­æ•°æ®å†™æˆbase64å½¢å¼ï¼šï¼ˆæ•°æ®æŒ‡çš„æ˜¯å›¾ä¸­è“è‰²éƒ¨åˆ†ï¼Œæ¯ä¸ªtcpæµä¸­çš„æµé‡å‡è¯•ä¸€ä¸‹å³å¯ï¼‰</p>
<p><img src="/post/ccf22797/image-20230910155301194.png" alt="image-20230910155301194"></p>
<p>è½¬æ¢ä¸ºåŸå§‹æ•°æ®ï¼š</p>
<p><img src="/post/ccf22797/image-20230910155542125.png" alt="image-20230910155542125"></p>
<p>å†™æˆbase64å½¢å¼ï¼š</p>
<p><img src="/post/ccf22797/image-20230910155529969.png" alt="image-20230910155529969"></p>
<p>4ã€æœ€ç»ˆè§£å¯†ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Beaconä»»åŠ¡æ‰§è¡Œç»“æœè§£å¯†</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> hexdump</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compare_mac</span>(<span class="params">mac, mac_verif</span>):</span><br><span class="line">	<span class="keyword">if</span> mac == mac_verif:</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(mac) != <span class="built_in">len</span>(mac_verif):</span><br><span class="line">		<span class="built_in">print</span></span><br><span class="line">		<span class="string">&quot;invalid MAC size&quot;</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">	result = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(mac, mac_verif):</span><br><span class="line">		result |= x ^ y</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> result == <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">encrypted_data, iv_bytes, signature, shared_key, hmac_key</span>):</span><br><span class="line">	<span class="keyword">if</span> <span class="keyword">not</span> compare_mac(hmac.new(hmac_key, encrypted_data, digestmod=<span class="string">&quot;sha256&quot;</span>).digest()[<span class="number">0</span>:<span class="number">16</span>], signature):</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&quot;message authentication failed&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">	cypher = AES.new(shared_key, AES.MODE_CBC, iv_bytes)</span><br><span class="line">	data = cypher.decrypt(encrypted_data)</span><br><span class="line">	<span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="comment">#keyæºè‡ªBeacon_metadata_RSA_Decrypt.py</span></span><br><span class="line">SHARED_KEY = binascii.unhexlify(<span class="string">&quot;2f793b0251bb6c09bda982cb159cd611&quot;</span>)</span><br><span class="line">HMAC_KEY = binascii.unhexlify(<span class="string">&quot;e5695e8bf533009cd4a3c950d447b032&quot;</span>)</span><br><span class="line"></span><br><span class="line">encrypt_data=<span class="string">&quot;AAAAwNR1s4ymDHA08b2cCeYKryK3UKJK0G2nKl/svxd3sD2WvktAWL1hS0gvdfXP7XmLpCd3CgYHRMvh9bWGrKW/2ANbWBQEYp1Lv+iIsuBpLdxanTNqAEOnre/71JK8hUKuJ32lY88IsDwgFFjvH0l3lwDOwgtXtOe6mhxvhuxUK8ourv/sii2KGiMOacqaRI2bOtOBcEal00/bBj85FcE+W6PmmGbF0Q9BvUvQmDT9C+J2H12SZqwwAbFGVJwntkDq7Q==&quot;</span></span><br><span class="line"></span><br><span class="line">encrypt_data=base64.b64decode(encrypt_data)</span><br><span class="line"></span><br><span class="line">encrypt_data_length=encrypt_data[<span class="number">0</span>:<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">encrypt_data_length=<span class="built_in">int</span>.from_bytes(encrypt_data_length, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">encrypt_data_l = encrypt_data[<span class="number">4</span>:<span class="built_in">len</span>(encrypt_data)]</span><br><span class="line"></span><br><span class="line">data1=encrypt_data_l[<span class="number">0</span>:encrypt_data_length-<span class="number">16</span>]</span><br><span class="line">signature=encrypt_data_l[encrypt_data_length-<span class="number">16</span>:encrypt_data_length]</span><br><span class="line">iv_bytes = <span class="built_in">bytes</span>(<span class="string">&quot;abcdefghijklmnop&quot;</span>,<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">dec=decrypt(data1,iv_bytes,signature,SHARED_KEY,HMAC_KEY)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">counter = dec[<span class="number">0</span>:<span class="number">4</span>]</span><br><span class="line">counter=<span class="built_in">int</span>.from_bytes(counter, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;counter:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(counter))</span><br><span class="line"></span><br><span class="line">dec_length = dec[<span class="number">4</span>:<span class="number">8</span>]</span><br><span class="line">dec_length=<span class="built_in">int</span>.from_bytes(dec_length, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ä»»åŠ¡è¿”å›é•¿åº¦:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(dec_length))</span><br><span class="line"></span><br><span class="line">de_data= dec[<span class="number">8</span>:<span class="built_in">len</span>(dec)]</span><br><span class="line">Task_type=de_data[<span class="number">0</span>:<span class="number">4</span>]</span><br><span class="line">Task_type=<span class="built_in">int</span>.from_bytes(Task_type, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ä»»åŠ¡è¾“å‡ºç±»å‹:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(Task_type))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(de_data)</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(hexdump.hexdump(dec))</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ä¸€ä¸²base32æ•°æ®ï¼š</p>
<p><img src="/post/ccf22797/image-20230910155718568.png" alt="image-20230910155718568"></p>
<p>è§£å¯†å³å¾—flagååŠæ®µï¼š</p>
<p><img src="/post/ccf22797/image-20230910155756436.png" alt="image-20230910155756436"></p>
<p>flagï¼š</p>
<p><strong>SICTF{79e1755e-08a8-4d3d-9385-4c0541549995}</strong></p>
<p><br></p>
<p><br></p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æœ‰äº›é¢˜çš„å…·ä½“åŸç†æˆ‘ç¡®å®ä¹Ÿæ‡‚çš„ä¸æ˜¯å¾ˆé€å½»ï¼Œæ¬¢è¿ä¸€èµ·äº¤æµè®¨è®ºï¼</p>
]]></content>
      <categories>
        <category>wp-misc</category>
      </categories>
  </entry>
  <entry>
    <title>miscè¶£é¢˜(äºŒ)</title>
    <url>/post/d8d20302.html</url>
    <content><![CDATA[<p>åˆåšåˆ°äº†ä¸€ä¸ªåŒ…å«miscä¸cryptoçš„ç»¼åˆé¢˜ï¼Œåœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹æˆ‘å¯¹è¿™ä¸ªé—®é¢˜çš„æ€è€ƒã€‚</p>
<span id="more"></span>
<h2 id="MISC-3"><a href="#MISC-3" class="headerlink" title="MISC.3"></a>MISC.3</h2><p>é¢˜ç›®æ¥æºï¼šCISG 2015</p>
<p>é¢˜ç›®æè¿°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ˜æ–‡ä¸­å«æœ‰flagè¿™ä¸ªå•è¯ã€‚flagæ ¼å¼ä¸ºflag&#123;å­—ç¬¦ä¸²&#125;ã€‚</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> unpack</span><br><span class="line"></span><br><span class="line">state = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rand</span>():</span><br><span class="line">    <span class="keyword">global</span> state</span><br><span class="line">    state = (state * <span class="number">1103515425</span> + <span class="number">54321</span>) &amp; <span class="number">0x3fffffff</span></span><br><span class="line">    <span class="keyword">return</span> state</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">srand</span>(<span class="params">seed</span>):</span><br><span class="line">    <span class="keyword">global</span> state</span><br><span class="line">    state = seed</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">data,key</span>):</span><br><span class="line">    srand(key)</span><br><span class="line">    cipher = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> data:</span><br><span class="line">        cipher += pack(<span class="string">&quot;i&quot;</span>,(<span class="built_in">ord</span>(c)&lt;&lt;<span class="number">22</span>) + rand())</span><br><span class="line">    <span class="keyword">return</span> cipher</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">data,key</span>):</span><br><span class="line">    srand(key)</span><br><span class="line">    plain = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(data),<span class="number">4</span>):</span><br><span class="line">        temp = unpack(<span class="string">&quot;i&quot;</span>,data[i:i+<span class="number">4</span>])[<span class="number">0</span>] - rand()</span><br><span class="line">        plain += <span class="built_in">chr</span>(temp &gt;&gt; <span class="number">22</span>)</span><br><span class="line">    <span class="keyword">return</span> plain</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    f1 = <span class="built_in">open</span>(<span class="string">&quot;plaintext&quot;</span>,<span class="string">&quot;rb&quot;</span>)</span><br><span class="line">    f2 = <span class="built_in">open</span>(<span class="string">&quot;ciphertext&quot;</span>,<span class="string">&quot;wb&quot;</span>)</span><br><span class="line">    data = f1.read()</span><br><span class="line">    <span class="keyword">from</span> secretfile <span class="keyword">import</span> secretkey</span><br><span class="line">    data = encrypt(data,secretkey)</span><br><span class="line">    f2.write(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()    </span><br></pre></td></tr></table></figure>
<p>ä»¥åŠä¸€ä¸ªåŠ å¯†æ–‡ä»¶ciphertextï¼Œç”±äºæ–‡ä»¶å†…å®¹è¾ƒå¤§å°±ä¸æ”¾åœ¨è¿™é‡Œäº†ã€‚</p>
<p>å…ˆæ¢³ç†ä¸€ä¸‹é¢˜ç›®çš„åŠ å¯†è¿‡ç¨‹ï¼š</p>
<ul>
<li>ä»secretfileé‡Œå–å‡ºsecretkeyï¼Œä½œä¸ºè‡ªå·±çš„ä¼ªéšæœºæ•°ç”Ÿæˆå™¨çš„ç§å­</li>
<li>å¯¹äºæ˜æ–‡æ–‡ä»¶çš„æ¯ä¸€ä¸ªå­—ç¬¦ï¼Œå°†ä»–ä»¬çš„ASCIIç å·¦ç§»22ä½ï¼Œå¹¶åŠ ä¸Šå½“å‰rand()ç”Ÿæˆçš„ä¼ªéšæœºæ•°ï¼Œå¾—åˆ°å¯†æ–‡</li>
<li>å°†å¯†æ–‡ç”¨packå‡½æ•°æ•´åˆï¼ŒæŒ‰é¡ºåºå†™å…¥ciphertexté‡Œã€‚</li>
</ul>
<p>æ‰€ä»¥ï¼Œæ±‚è§£é¢˜ç›®çš„çªç ´å£åœ¨äºæ±‚è§£å‡ºå¯†é’¥ã€‚è€Œæˆ‘æœç´¢åˆ°çš„ä¸€ç¯‡wpè®²äº†ä¸€ç§ä¸é”™çš„æ€è·¯ï¼š</p>
<p><a href="https://geekorz.com/post/cigs2015/">CISG2015 MISC.3è§£æ (geekorz.com)</a></p>
<p>ä½†æ˜¯ä»–å…¶ä¸­çš„ä¸€å¥è¯å¼•å‘äº†æˆ‘çš„æ€è€ƒï¼š</p>
<p><img src="/post/d8d20302/image-20230913142928566.png" alt="image-20230913142928566"></p>
<p>ä»–è¯´ï¼Œè¿™ä¸ªéšæœºæ•°ç”Ÿæˆç®—æ³•å¹¶ä¸åŒäºæ™®é€šçš„LCGï¼Œå› ä¸ºä»–æœ€åä¸€æ­¥æ˜¯æŒ‰ä½ä¸è¿ç®—ï¼Œè€Œä¸æ˜¯æ¨¡è¿ç®—ï¼Œæ‰€ä»¥å°±æ²¡æœ‰é‡‡ç”¨LCGçš„æ€è·¯å»æ±‚è§£æœ¬é¢˜ã€‚ä½†æ˜¯ä»”ç»†æ€è€ƒå°±ä¼šå‘ç°ï¼Œå…¶å®é“ç†æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼š</p>
<ul>
<li>x &amp; 0x3fffffffï¼Œè¡¨ç¤ºçš„æ˜¯å–xçš„ä½ä¸‰åä½</li>
<li>x mod (0x3fffffff + 1)ï¼Œè¡¨ç¤ºçš„ä¹Ÿæ˜¯å–xçš„ä½ä¸‰åä½</li>
</ul>
<p>æ‰€ä»¥ï¼ŒæŸäº›æŒ‰ä½ä¸è¿ç®—ä¸æ¨¡è¿ç®—å…¶å®æ˜¯ç­‰ä»·çš„ï¼å› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸‹åˆ—ä»£ç ï¼Œå¤§å¤§ç®€åŒ–æ±‚è§£å¯†é’¥keyçš„è¿‡ç¨‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> unpack</span><br><span class="line"></span><br><span class="line">state = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rand</span>():</span><br><span class="line">    <span class="keyword">global</span> state</span><br><span class="line">    state = (state * <span class="number">1103515425</span> + <span class="number">54321</span>) &amp; <span class="number">0x3fffffff</span></span><br><span class="line">    <span class="keyword">return</span> state</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">srand</span>(<span class="params">seed</span>):</span><br><span class="line">    <span class="keyword">global</span> state</span><br><span class="line">    state = seed</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">data,key</span>):</span><br><span class="line">    srand(key)</span><br><span class="line">    cipher = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> data:</span><br><span class="line">        cipher += pack(<span class="string">&quot;i&quot;</span>,(<span class="built_in">ord</span>(c)&lt;&lt;<span class="number">22</span>) + rand())</span><br><span class="line">    <span class="keyword">return</span> cipher</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">data</span>):</span><br><span class="line">    plain = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(data),<span class="number">4</span>):</span><br><span class="line">        temp = unpack(<span class="string">&quot;i&quot;</span>,data[i:i+<span class="number">4</span>])[<span class="number">0</span>]</span><br><span class="line">        plain.append(temp)</span><br><span class="line">    <span class="keyword">return</span> plain</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    f1 = <span class="built_in">open</span>(<span class="string">&quot;ciphertext&quot;</span>,<span class="string">&quot;rb&quot;</span>)</span><br><span class="line">    data = decrypt(f1.read())</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;j =&quot;</span>,j,<span class="string">&quot;:&quot;</span>,end = <span class="string">&quot; &quot;</span>)</span><br><span class="line">        key = ((data[<span class="number">0</span>] - (j&lt;&lt;<span class="number">22</span>)) - <span class="number">54321</span>) * inverse(<span class="number">1103515425</span>,(<span class="number">0x3fffffff</span> + <span class="number">1</span>))</span><br><span class="line">        <span class="built_in">print</span>(key,end = <span class="string">&quot;  &quot;</span>)</span><br><span class="line">        srand(key)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> data[<span class="number">0</span>:<span class="number">40</span>]:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">chr</span>((i - rand()) &gt;&gt; <span class="number">22</span>),end = <span class="string">&quot;&quot;</span>)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>,end = <span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()    </span><br></pre></td></tr></table></figure>
<p>ç•¥å¾®è§£é‡Šä¸€ä¸‹è¿™æ®µä»£ç ï¼š</p>
<ul>
<li>decryptå‡½æ•°ç›¸è¾ƒäºç»™çš„é™„ä»¶ä¸­çš„decryptå‡½æ•°ä½œäº†ç®€åŒ–ï¼Œä»…ä»…å®ç°äº†unpackçš„åŠŸèƒ½ï¼Œå°†å¯†æ–‡è½¬åŒ–ä¸ºä¸€ä¸ªæ•°å­—åˆ—è¡¨ã€‚</li>
<li>mainå‡½æ•°ç”¨äºçˆ†ç ´æ­£ç¡®å¯†é’¥ã€‚</li>
</ul>
<p>å¦‚ä½•çˆ†ç ´çš„å‘¢ï¼Ÿæˆ‘ä»¬è¯•æƒ³ä¸€ä¸‹ç¬¬ä¸€ä¸ªå¯†æ–‡æ•°å­—data[0]çš„ç”Ÿæˆè¿‡ç¨‹ï¼Œæ­¤å¤„å‡è®¾ç¬¬ä¸€ä¸ªæ˜æ–‡çš„ordå€¼ä¸ºjï¼š</p>
<script type="math/tex; mode=display">
data[0] = (j<<22)+rand()</script><p>è€Œå…¶ä¸­rand()ç”Ÿæˆçš„å€¼ä¸ºï¼š</p>
<script type="math/tex; mode=display">
rand() = (state * 1103515425 + 54321) \quad (mod\;0x3fffffff + 1)</script><p>è€Œjä»…æœ‰256ç§å–å€¼å¯èƒ½(æ›´è´´åˆ‡çš„è¯´ï¼Œå…¶å®ä»…éœ€è¦ä»å¯è§å­—ç¬¦èŒƒå›´å†…è€ƒè™‘)ï¼Œå› æ­¤æˆ‘ä»¬ç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„256ä¸ªå¯†é’¥ï¼Œå¹¶è§£å¯†å‰é¢å››åä¸ªå¯†æ–‡è§‚æµ‹æ•ˆæœï¼Œçœ‹çœ‹å“ªä¸ªæ˜¯çœŸæ­£çš„å¯†é’¥ï¼Œè§‚æµ‹å¯çŸ¥ï¼š</p>
<p><img src="/post/d8d20302/image-20230913145528744.png" alt="image-20230913145528744"></p>
<p>å¯ä»¥çœ‹å‡ºjä¸º105æ—¶ï¼Œè§£å‡ºçš„å¯†æ–‡çœ‹ä¸Šå»æ˜¯æ­£ç¡®çš„å½¢å¼ï¼Œå› æ­¤æˆ‘ä»¬å–è¯¥å¯†é’¥è§£å¯†å‡ºå…¨éƒ¨å†…å®¹ï¼Œå°±å¾—åˆ°äº†æ­£ç¡®çš„æ–‡æœ¬ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line">+0lpfzK92vRhs6zyLUYE20n65i9s9GHFfw04XTb2BqKed1d35nuQX1hD5JRsou3m7dEEKGBIJCxUeAjPDgeixlQrAoZzFAlt541yJoyXxuEMGwaAqTXQlF+7pB/5S4vnZ85Lap2siP8q/jFYp87z7PXHmJ20opxy8yxnBsRPoWEs8glONXf1H+h4kkdTcCg+HfwGXqYrf0jyFBgAAAABJRU5ErkJggg==|flag is hidden in the above data It is a picture and you should base64decode it.</span><br></pre></td></tr></table></figure>
<p>å‰é¢æ˜¯ä¸€ä¸ªå¾ˆé•¿çš„base64æ®µï¼Œè§£ç å¾—åˆ°ï¼š</p>
<p><img src="/post/d8d20302/image-20230913145804385.png" alt="image-20230913145804385"></p>
<p>å¤§åŠŸå‘Šæˆï¼</p>
<p>flagï¼š</p>
<p><strong>flag{tHis_1s_YOUR_flaaaaag}</strong></p>
<p>æ€»ç»“ä¸€ä¸‹ï¼Œæœ¬é¢˜æœ€é‡è¦çš„ä¸€ä¸ªç‚¹ï¼Œå°±æ˜¯å‘ç°æ¨¡è¿ç®—ä¸æŒ‰ä½ä¸è¿ç®—çš„ç­‰ä»·æ€§ï¼Œä»è€Œèƒ½å¤Ÿä½¿ç”¨LCGçš„è§£æ³•è§£å†³é¢˜ç›®ã€‚</p>
]]></content>
      <categories>
        <category>miscè¶£é¢˜</category>
      </categories>
  </entry>
</search>
